sequence analysis pinstripe: a suite of programs for integrating transcriptomic and proteomic datasets identifies novel proteins and improves differentiation of protein-coding and non-coding genes motivation: comparing transcriptomic data with proteomic data to identify protein-coding sequences is a long-standing challenge in molecular biology, one that is exacerbated by the increasing size of high-throughput datasets. to address this challenge, and thereby to improve the quality of genome annotation and understanding of genome biology, we have developed an integrated suite of programs, called pinstripe. we demonstrate its application, utility and discovery power using transcriptomic and proteomic data from publicly available datasets. results: to demonstrate the efficacy of pinstripe for large-scale analysis , we applied pinstripes reverse peptide mapping pipeline to a transcript library including de novo assembled transcriptomes from the human illumina body atlas (iba2) and gencode v10 gene annotations , and the ebi proteomics identifications database (pride) pep-tide database. this analysis identified 736 canonical open reading frames (orfs) supported by three or more pride peptide fragments that are positioned outside any known coding dna sequence (cds). because of the unfiltered nature of the pride database and high probability of false discovery, we further refined this list using independent evidence for translation, including the presence of a kozak sequence or functional domains, synonymous/non-synonymous substitution ratios and orf length. using this integrative approach, we observed evidence of translation from a previously unknown let7e primary transcript, the archetypical lncrna h19, and a homolog of rd3. reciprocally, by exclusion of transcripts with mapped peptides or significant orfs (480 codon), we identify 32 187 loci with rnas longer than 2000 nt that are unlikely to encode proteins. availability and implementation: pinstripe (pinstripe.matticklab.com) is freely available as source code or a mono binary. pinstripe is written in c and runs under the mono framework on linux or mac os x, and both under mono and .net under windows. contactalthough the annotation of the human genome has undergone considerable effort, with 420 000 protein-coding loci identified, the extent to which the genome is transcribed and subsequently translated remains unclear . as well as mrnas, long rnas with little or no protein-coding capacity (long non-coding rnas or lncrnas) are abundantly expressed from the human genome with410 000 non-coding loci currently in gencode (the most comprehensive annotation of the human genome). adding to the known catalog of rnas, transcriptomic sequencing experiments are identifying thousands of new transcripts on an ongoing basis . confidently determining which rnas encode proteins is difficult. traditional approaches classify the protein-coding potential of an rna based on the presence of long canonical open reading frames (orfs), phylogenomic evidence of codon conservation and/or recognized functional domains. the former approach is highly dependent on orf length, with $100 codons typically used as the threshold for the identification of mrnas . however, this approach results in an unknown false negative and positive rate, as shorter proteins are known to exist, and short orfs can occur by chance . phylogenomic comparisons also have limitations, notably their inability to detect orphan genes lacking homologs in other lineages , and the tendency for recently evolved genes to encode smaller proteins than older genes . moreover, data from which evidence of orf and codon conservation can be determined are limited, especially at short evolutionary distances. annotation of protein-coding genes is further confounded by factors such as rna editing, to whom correspondence should be addressed. y these authors wish it to be known that, in their opinion, the last two authors should be regarded as joint last authors. z present address: wellcome trust/cancer research uk gurdon institute, university of cambridge, cambridge cb2 1qn, uk. present address: garvan institute of medical research, darlinghurst, sydney, new south wales 2010, australia. genotypic variation, non-canonical start codons and ribosomal frameshifting. although many of the transcripts identified in de novo assembled transcriptomes can be annotated through comparison with known reference databases such as gencode or refseq , this approach does not provide a means for classifying novel transcripts and is entirely dependent on the accuracy of the reference database. even determining the protein-coding capacity of novel transcript isoforms of known genes is not straightforward, as the insertion, deletion and extension of exons may disrupt the existing orf or establish an alternative orf. identifying the consequences of such events to the encoded protein sequence on a genomic scale is challenging and not addressed by existing tools. although the comparison of transcriptomic datasets to identify overlapping/non-overlapping features is facilitated by applications such as bedtools , such applications do not consider the frame of the cds. the classification of novel transcripts with a putative orf can be discerned with greater confidence using proteomic data. mapping of proteomic sequences to transcriptomic data is typically performed using software such as blast or blat . use of these programs with high-throughput transcriptomic datasets requires considerable pre-and post-processing. custom nucleotide sequence dictionaries must be created from spliced genomic coordinates before blast comparisons, and resulting matches are reported with respect to mrna coordinates that require transformation into genomic coordinates. after mapping, each orf then needs to be analyzed to determine the extent of supporting proteomic data. currently, there is no software to facilitate this process, although high-throughput proteomicgenomic comparisons in arabidopsis and proteomictranscriptomic integration in mice have been undertaken. here, we present an integrated software suite, pinstripe, which overcomes many of the difficulties in such tasks, providing programs (supplementary) to analyze transcriptomes, specifically enabling: (i) orf-aware comparison with proteincoding gene annotations identifying cdss with in-frame overlap, (ii) mapping of proteomic data to the transcriptome (leveraging blastp and tblastn) and reporting results as genomic coordinates and (iii) annotation of orfs supported by peptides from proteomic datasets. in addition, pinstripe features a multitude of tools for analyzing transcriptomes, including intersection by feature name, identification of best representative transcripts for loci and extraction of dna sequence or predicted orfs from genomic coordinates. we demonstrate the utility of pinstripe by analyzing transcriptomes assembled de novo from high-throughput rna sequencing of 16 human tissues and mass spectrometry from the embl-ebi proteomics identifications database (pride) , finding previously unidentified protein-coding regions and providing high-confidence annotations for thousands of long ncrnas.differentiating between ncrna and mrna is far from trivial, with traditional strategies relying on characteristics or features of known mrnas such as codon conservation, orf length or homology. such strategies are effective at identifying mrna that are well conserved, contain large canonical orfs, are similar to known mrna or encode known protein domains, but less reliable for detecting small poorly conserved proteins with specific non-redundant function. as a supplement to such approaches, pinstripe provides a suite of tools designed to integrate and aggregate large sets of proteomic and transcriptomic experimental data, providing not only new tools for the identification of rna potentially encoding proteins but also foramino acid protein and is the primary transcript for mir-let7e, mir-125 a and mir-99b. it is conserved in mammals and contains a immunoglobulin-like and transmembrane domain. the start of transcription is supported by h3k4me3 modifications indicative of initiation. (d) hmgdc encodes a 638-amino acid testis-specific protein with helixloophelix dna binding and hmg-box domains. the protein is conserved in mammals and extends a predicted ensembl gene integrating data from in silico genomic comparisons by existing applications such as phylocsf, signalp and iprscan. there is growing evidence that large numbers of rnas without well-conserved long canonical orfs are actually translated. for example, the humanin genes encode short orfs (2430 amino acids) and are found only in humans ; translation of upstream orfs is a demonstrated regulatory mechanism , and non-canonical start sites are common in mouse embryonic stem cells . as a result, algorithms dependent on orf length, canonical start codons, conservation or synonymous/non-synonymous substitution rates will not always be sufficient to identify and differentiate between coding and non-coding genes. this is especially true in the case of short proteins, which are challenging to identify as orfs 5100 codons regularly occur by chance . as other methods including conservation analysis and dinucleotide content are only predictive and have shortcomings, the integration of experimental evidence supporting translation is often required for confident annotation of novel proteins. pinstripe is designed to allow users to integrate any available experimental data in the form of gene annotations, peptide identifications or external analyses using applications such as phylocsf or signalp . although pinstripe is entirely dependent on the integrity of the pepfrags, annotations and transcriptomes used for analysis, users can adjust the thresholds for identification to improve the probability of correct classification. the appropriate thresholds will largely depend on the quality of the data, notably the accuracy of pepfrag identifications. most commonly, the process of correctly identifying pepfrags from spectra relies on the statistically robust concordance of the queried peptide fragment with predicted spectra from a target database. although using pepfrags that have already been sequenced dramatically reduces the computational task, the fidelity of the original identification is lost. this can be addressed by pre-screening of spectra selecting only those with a set level of confidence, using peptides from quality-controlled sources such as the peptideatlas , or at the protein identification stage by requiring an increased number of coincident pepfrags, or other supporting information such as conservation or functional prediction to identify coding genes. our analysis of the iba2 data demonstrates that application of pinstripes programs accurately maps pepfrags and integrates them with transcripts to identify supported orfs and identifies rna with little or no protein-coding capacity. although not all orfs containing mapped pepfrags represent genuine protein-coding genes, additional lines of evidence including signal peptide potential, positive phylocsf scores and multiple pepfrags identify potential protein-coding genes, including the validated protein rd3lp, variants of gipc3 and aak1 and a protein translated from the putative ncrna h19. pinstripe allows researchers to identify transcripts with little or no protein-coding potential, and which have no pepfrags mapping to putative orfs, regardless of size. this is especially important, as knowledge of whether a given transcript is coding or non-coding will guide the design of any subsequent experimental work to characterize its function. pinstripe is freely available for download at pinstripe. matticklab.com.  
