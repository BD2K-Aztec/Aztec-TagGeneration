assessing the functional coherence of gene sets with metrics based on the gene ontology graph motivation: the results of initial analyses for many high-throughput technologies commonly take the form of gene or protein sets, and one of the ensuing tasks is to evaluate the functional coherence of these sets. the study of gene set function most commonly makes use of controlled vocabulary in the form of ontology annotations. for a given gene set, the statistical significance of observing these annotations or enrichment may be tested using a number of methods. instead of testing for significance of individual terms, this study is concerned with the task of assessing the global functional coherence of gene sets, for which novel metrics and statistical methods have been devised. results: the metrics of this study are based on the topological properties of graphs comprised of genes and their gene ontology annotations. a novel aspect of these methods is that both the enrichment of annotations and the relationships among annotations are considered when determining the significance of functional coherence. we applied our methods to perform analyses on an existing database and on microarray experimental results. here, we demonstrated that our approach is highly discriminative in terms of differentiating coherent gene sets from random ones and that it provides biologically sensible evaluations in microarray analysis. we further used examples to show the utility of graph visualization as a tool for studying the functional coherence of gene sets. availability: the implementation is provided as a freely accessiblefor a gene set, the functional coherence is a measure of the strength of the relatedness of the functions associated with the genes, which can be used to differentiate a set of genes performing coherently related functions from ones consisting of randomly grouped genes. it is commonly evaluated by analyzing the genes functional annotations, which are almost invariably in the form of the controlled vocabulary from the gene ontology (go;). the vocabulary terms are organized as a graph, with concepts ranging from very general to very specific. to whom correspondence should be addressed. they are used to annotate gene products by a variety of methods, including human curation, based on evidence from the literature. the annotations capture what is known about the biology. functional coherence can be reflected in two aspects. first, whether genes share similar functions or whether they participate in the same biological processes. for example, if a sufficient number of genes from a set are annotated with a common go term, the annotation is considered to be enriched and, therefore, the genes are deemed functionally coherent. second, whether the distinct functions are related. the relationship between functional annotations can be either semantic or biological in nature. for example, if a gene is annotated with the term regulation of apoptosis and another one is labeled with the term induction of apoptosis, their functions can be considered coherent because the terms are semantically alike. alternatively, annotations can be semantically distinct, e.g. apoptosis and electron transport chain, yet their co-occurrence in a gene set can be biologically meaningful if many genes in the set participate in both processes. ideally, a measure of functional coherence should take the above aspects into account during evaluation. to date, a method unifying the enrichment and relatedness aspects of functional coherence remains to be developed. the first aspect of functional coherence, evaluating go term enrichment, is usually performed by various count-based methods that evaluate the probability of observing a go term in a set by random chanceto determine if an individual term is overrepresented in a gene set. the widely used count-based methods are based on the hypergeometric distribution or other similar probabilistic models . the merits and limitations of this family of methods are well documented . since the objective of count-based methods is focused on individual terms, directly utilizing their results, e.g. p-values, to assess overall coherence encounters the following difficulties: (i) schemes (ad hoc or sophisticated) need to be devised in order to combine the results of individual tests into a unified measure; (ii) the relationships among the terms are ignored by treating each annotation independently; and (iii) multiple testing potentially leads to false positives results, thus a less reliable unified measure. the second aspect, evaluating the relatedness among distinct annotations, has been investigated in several studies that utilized the directed acyclic graph (dag) representation of the go. a number of studies have used the ontology graph structure in the context of functional analyses; however, the specific purpose or information used often differs from the methods proposed in this study, making a direct comparison between methods less meaningful. one theme is to find the representative summary term(s) utilizing the graphpage: i80 i79i87the main goal of this study was to introduce functional coherence metrics with high levels of discriminative power, based on the currently available go annotations. moreover, the method was intentionally developed independent of data types that are used to generate the gene set of interest (goi). two graph-based metrics, k s and l, were developed, where the former measures the enrichment of functional annotations, and the latter summarizes the relatedness of the annotations. furthermore, k rs was devised so that both aspects of functional coherence can be evaluated with a unified metric. in addition to quantitative evaluation, we have also provided tools to visualize go steiner trees as a means to further assess the results by inspecting how genes and annotations are organized, rather than solely relying on p-values. in the real world application, the metrics returned biologically sensible calls. the advantages of these metrics include but are not necessarily limited to the following: (i) by incorporating semantic and biological relationships in the evaluation, our methods treat genes annotated with semantically close go terms as functionally similar; (ii) providing an global evaluation method for proteins/gene sets, rather than treating each function annotation of genes as independent; and (iii) addressing the multiple testing problem by reducing the number of tests. however, like all go-based evaluation methods, the metrics are dependent on how well genes are annotated. therefore, the utilities of the metrics are limited when considering species that have less comprehensive annotations, and the metrics may reflect potential annotation biases from the databases. this is likely to hold true for localized areas of the gograph as well. the discriminative power of the graph-based metrics may be attributed to the following factors. first, the methods capture the key properties that differentiate coherent gene sets from random onesgo terms in a functionally coherent gene set are more likely to be enriched and their functions are more closely related semantically and biologically. in addition to the semantic relationships considered, our metrics further take into account the relationships among go terms that co-annotate genes, which leads to a better performance. second, through a sampling approach, our method accurately estimates the distribution of network statistics of the randomly grouped gene sets, which is directly relevant to the task at handdetermining if an arbitrary gene set consists of randomly grouped genes.  
