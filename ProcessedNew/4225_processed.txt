sequence analysis shimmer: detection of genetic alterations in tumors using next-generation sequence data motivation: extensive dna sequencing of tumor and matched normal samples using exome and whole-genome sequencing technologies has enabled the discovery of recurrent genetic alterations in cancer cells, but variability in stromal contamination and subclonal heterogen-eity still present a severe challenge to available detection algorithms. results: here, we describe publicly available software, shimmer, which accurately detects somatic single-nucleotide variants using statistical hypothesis testing with multiple testing correction. this program produces somatic single-nucleotide variant predictions with significantly higher sensitivity and accuracy than other available software when run on highly contaminated or heterogeneous samples, and it gives comparable sensitivity and accuracy when run on samples of high purity.the development of next-generation dna sequencing methods has led to a rapid increase in the availability of high-quality sequence data from large numbers of tumor samples, some with matched samples from the same individuals blood or unaffected tissue . these data have uncovered genes and pathways that are mutated in various forms of cancer , and the characterization of these alterations has led to a greater understanding of oncogenesis, as well as the potential for earlier diagnosis of cancers and more directed treatments . however, sensitive and accurate detection of somatic singlenucleotide variants (ssnvs) from next-generation sequencing data is still a challenging informatic problem because of differing levels of purity and numbers of subclonal populations represented in tumor samples. the depth of read coverage necessary to detect a mutation accurately is dependent on the prevalence of the mutation in that sample, which is in turn dependent on levels of copy number variation, levels of stromal contamination and prevalence of mutation among subclones within the sample . available software for detecting differences between samples often provides little guidance with regard to how deep coverage needs to be to attain the users required sensitivity and accuracy. a large number of algorithms have been developed to identify small mutations in aligned sequencing reads from pairs of samples. for ssnvs, several studies have used a navenave subtraction method in which variants are first called separately from both the tumor and normal samples reads, and then sites that have a confident call of a variant in the tumor, as well as a confident call of no variant in the normal, are assumed to be ssnvs. however, analyzing samples separately can lead to false positives when a germline variant is present in a low percentage of reads from the normal sample, as well as false negatives when mutation levels in the tumor are too low to allow an algorithm to confidently distinguish variant reads from sequencing error. analyzing reads from the two samples simultaneously enables better discrimination of germline alleles from sequencing error. other algorithms do this simultaneous analysis with hypothesis testing. varscan2 is a comprehensive sequence analysis tool that includes ssnv detection and analyzes pairs of samples simultaneously. it predicts ssnvs using a combination of heuristic filtering and a fishers exact test, but the tool reports p-values without any correction for multiple testing, and fails to report the number of tests performed or the expected underlying distribution of p-values, making it impossible to perform these corrections after running the program. similarly, deepsnv performs a likelihood ratio test on each site in a sequenced region, along with rigorous multiple testing correction, to report sites for which the frequency of a variant allele is significantly higher than that of modeled sequencing errors, but it gives the user only rough control over which sites are tested. jointsnvmix2 uses bayesian probability models to infer the genotypes of both tumor and normal samples simultaneously, allowing users to train the model on the data and then classify mutations as somatic or germline with a given posterior probability. the software also now includes the ability to filter predictions using parameters learned from the data . however, as it is based on a diploid model, this method is prone to errors in regions where the model does not to whom correspondence should be addressed. reflect reality, for example, copy number altered regions and misaligned repetitive sequences . similarly, somaticsniper uses a bayesian model to calculate posterior probabilities of somatic mutations, using a prior that incorporates the dependence of tumor and normal genotypes from a single individual and provides software for filtering using other indicators for potential false positives. others have used bayesian approaches as well . in this study, we describe a new simpler approach based on hypothesis testing with correction for multiple testing. implemented in a publicly available software tool, shimmer, the algorithm yields highly accurate and sensitive calls on matched tumor and normal sequence, even in the presence of large amounts of stromal contamination, heterogeneity and copy number alteration, and even without any post-filtering of ssnv calls.we compared the variants predicted by shimmer with those predicted by varscan2, somaticsniper, deepsnv and jointsnvmix2 on the simulated datasets described in the previous section. in addition, we ran shimmer, varscan2 and somaticsniper on the whole-genome colo-829 data. for each dataset, we defined sensitivity as the percentage of known true variants that are predicted correctly by each program, and assessed accuracy by tallying the number of false positive variants a program predicted.here, we present results from both real and simulated datasets supporting the use of simple statistical methods, without heuristics or filtering, for the determination of genetic differences between tumors and matched normal samples. it should be no surprise that the use of hypothesis testing with correction for multiple testing provides highly accurate determination of true positive variants while effectively controlling the fdr, as these statistical methods have already been successfully applied in so many fields of scientific research. we also show that these statistical methods, as implemented in the program shimmer, perform comparably with other currently available software, such as somaticsniper, at typical depths of sequencing for whole exome and whole-genome sequencing experiments. although there does not seem to be a significant advantage to using shimmer when analyzing samples with high purity, it can be expected to give far superior results on samples that are highly contaminated or contain subclonal heterogeneity. furthermore, although shimmers algorithm can be less sensitive at lower depths of sequencing, well-established statistical results allow the user to estimate the depth of coverage necessary to confidently detect somatic mutations present in any level in a tumor. these estimates can then guide decision-making regarding how much sequencing is cost effective in large tumor/normal sequencing studies. barring difficulties in obtaining independent sampling of molecules because of sparse samples or low library complexity, obtaining more reads is a viable strategy for increasing power to detect mutations present in small quantities in a sample. regardless of the depth of sequencing performed, the shimmer algorithm allows the user to decide what their maximum acceptable level of false discoveries will be.  
