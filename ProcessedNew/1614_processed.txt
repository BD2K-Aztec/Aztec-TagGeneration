error filtering, pair assembly and error correction for next-generation sequencing reads motivation: next-generation sequencing produces vast amounts of data with errors that are difficult to distinguish from true biological variation when coverage is low. results: we demonstrate large reductions in error frequencies, especially for high-error-rate reads, by three independent means: (i) filtering reads according to their expected number of errors, (ii) assembling overlapping read pairs and (iii) for amplicon reads, by exploiting unique sequence abundances to perform error correction. we also show that most published paired read assemblers calculate incorrect posterior quality scores. availability and implementation: these methods are implemented in the usearch package. binaries are freely available atnext-generation sequencing (ngs) machines produce reads of lengths tens to thousands of bases. in an ngs read, the base call at position i is assigned an estimated error probability p i represented as an integer-rounded phred (quality) score q i 10 log 10 p i. typical base call error rates for current machines range from 0.1 to 10 . when coverage is high, error detection and correction can be achieved by aligning reads to each other (de novo assembly) or to a closely related well-known sequence (reference-based assembly). when coverage is low or a complete set of reference sequences is not available, sequencing error is difficult to distinguish from true biological variation. errors can be reduced by quality filtering, i.e. by discarding or truncating reads with low-quality base calls, by merging overlapping paired-end reads and, in the case of amplicon reads, by clustering. quality filtering is often used in data analysis of next-generation reads but is rarely regarded as a method in its own right which should be designed and validated as a separate step. published methods for quality filtering typically use ad-hoc criteria such as imposing a maximum on the number of bases with less than a given q score . that article focuses on filtering but does not attempt to measure error rates. other articles describing analysis pipelines for amplicon reads (e.g.) report the mean error rate but do not consider the tail of the error distribution, which we believe to be important due to the spurious clusters and consequent inflated estimates of diversity (spurious rare biosphere) obtained when the tail is not adequately controlled . when paired-end reads overlap, an improved prediction of the sequence in the overlapping region can be obtained by aligning the forward and reverse read. previously published paired-read mergers include shera , flash , pandaseq , cope and pear . of these, only pandaseq included quality filtering in addition to merging. error correction methods for amplicon pyrosequencing reads include pyronoise , ampliconnoise and an unnamed method that uses a greedy algorithm based on an abundance sort. these methods all require flowgrams and therefore cannot be applied to other technologies such as illumina. single-linkage pre-clustering and the pre-clustering method of (2013) also use abundance differences between closely related sequences to correct errors. in this work, we use the expected number of errors in a read as a measure of quality for filtering and show that this method is effective at reducing error rates, especially in the tail of the distribution. we show how to calculate the posterior quality scores when read pairs are merged and demonstrate that most previous merging methods calculate incorrect scores. we also describe and validate unoise, a new amplicon error-correction method which can be applied to any type of ngs read.we introduced the expected number of errors as measure of read quality. we showed that imposing a maximum value on expected errors is an effective quality filter. we showed that most current paired read mergers do not correctly calculate the posterior quality scores and that pandaseq will align unrelated random pairs, potentially causing a high rate of false-positive merges in biological data. we suggest that measurements of q score accuracy and the correlation of e with the true error rate should be a standard step in anyfwd indicates forward reads only. method is one of raw reads (no processing), unoise, qiime/f (qiime quality filtering only), merged (merge by usearch only, no filtering), usearch/f (usearch filtering by e max 1), usearch/mf (usearch merge and filtering by e max 1), pandaseq (merging and filtering with default parameters) and qiime/mf (qiime quality filtering of reads merged by usearch). reads is the number of reads after any merging and/or filtering. err. rate is the number of measured errors divided by the total number of bases and 3 errs. gives the number of reads with at least 3 measured errors. unoise assumes amplicon data, so is not applicable to phix.reads that were predicted to be chimeric by uchime were discarded prior to this analysis (because chimera detection is a specialized task, and chimeras account for a large majority of the unique amplicon sequences, obscuring the underlying biological diversity). the reads contain 21 species, plus a few contaminants (edgar, 2013). ab. is minimum abundance (1 all reads, 2 singletons discarded), den. is n (no denoising) or y (unoise), reads is the number of reads after processing, uniques is number of unique read sequences after processing and otus is the number of clusters at 97 identity (made by running uclust on the unique sequences sorted by decreasing abundance). next-generation read analysis where q scores are used, especially when coverage is low. this will enable informed setting of parameters such as the e max threshold. with illumina amplicon sequencing, a control sample such as a mock community would be ideal, but the additional cost and effort may be prohibitive. however, a phix spike-in is often added to amplicon libraries before illumina sequencing , and our results here show that phix reads can function as an informative control sample for q score analysis. we suggest the default value e max 1 as a filtering threshold as the most probable number of errors is zero for the filtered reads. more or less stringent thresholds may be appropriate to correct for biases in the q scores or to make trade-offs between sensitivity and error rate in downstream analysis. we believe that these methods will enable improved accuracy of biological inferences in a broad range of ngs experiments. conflict of interest: none declared.  
