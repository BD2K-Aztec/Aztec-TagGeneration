gene expression single feature polymorphism detection using recombinant inbred line microarray expression data motivation: the affymetrix genechip microarray is currently providing a high-density and economical platform for discovery of genetic polymorphisms. microarray data for single feature polymorphism (sfp) detection in recombinant inbred lines (rils) can capitalize on the high level of replication available for each locus in the ril population. it was suggested that the binding affinities from all of the rils would form a multimodal distribution for a sfp. this motivated us to estimate the binding affinities from the robust multi-array analysis (rma) method and formulate the sfp detection problem as a hypothesis testing problem, i.e. testing whether the underlying distribution of the estimated binding affinity (eba) values of a probe is unimodal or multimodal. results: we developed a bootstrap-based hypothesis testing procedure using the dip statistic. our simulation studies show that the proposed procedure can reach satisfactory detection power with false discovery rate controlled at a desired level and is robust to the unimodal distribution assumption, which facilitates wide application of the proposed procedure. our analysis of the real data identified more than four times the sfps compared to the previous studies, covering 96 of their findings. the constructed genetic map using the sfp markers predicted from our procedure shows over 99 concordance of the genetic orders of these markers with their known physical locations on the genome sequence. availability: the r package dipsfp can be downloaded fromin the past decade, affymetrix genechip microarrays have provided an important and versatile tool for many genome studies. this technology uses hybridization probes which are comprised of hundreds of thousands of 25-mer oligonucelotides chemically synthesized on a solid substrate. typically, these probes (or features) are grouped into different probe sets for different target genes to whom correspondence should be addressed.(see affymetrix 2001 for more details). since its introduction by, affymetrix genechip microarrays have been used extensively for genome-wide gene expression analysis. recently, affymetrix genechip microarrays have also been used for identifying genetic polymorphisms on a variety of genomes in a highly parallel manner . such genetic polymorphisms, including single nucleotide polymorphisms (snps) and small insertion/deletions, are detected by single probes on the array and, therefore, are called single feature polymorphisms (sfps). the idea is that the sequence mismatch between a 25-mer perfect match (pm) probe on the array and its target sequence will significantly alter hybridization and attenuate that probes signal. therefore, the presence of sequence polymorphisms in some pm probes will lead to detectable differences in those probes hybridization signals between the two different accessions, one of which has similar sequences as the probe sequences on the array. since hundreds of thousands of probes can be analyzed at the same time, the affymetrix genechip microarrays are currently providing one of the most highly parallelized and economical platforms for genetic polymorphism discovery, facilitating the increasing need of highresolution genetic and physical maps for genetic studies . for relatively small genomes, such as yeast, arabidopsis and rice, microarray hybridization of genomic dna samples has been a successful route to detect sfps . for more complex genomes, such as barley and cowpea, crna samples have been successfully used as surrogates for dna samples to detect sfps . in most of the microarray-based sfp detection studies, usually only two or three biologically replicated dna or rna samples are extracted from each accession under comparison. with so few replicates, sfp detection suffers from either low detection power or high false positive rate. however, increasing biological replicates simply for the purpose of sfp detection is generally cost prohibitive. since ril expression microarrays are often available for expression quantitative trait locus analysis,proposed to use such data, without extra cost, for simultaneous sfp detection and ril genotyping. they developed a metric for the binding affinity called sfpdev, and assumed that the sfpdev values of a sfp frompageall of the rils would form a bimodal distribution, where each peak represents a parental genotype. then for each probe, they sorted the sfpdev values in an increasing order and performed an empirical brute force search for a gap value greater than two in the ratios of every two consecutive sfpdev values. if such a gap was found for a probe and all sfpdev values of one parent fall on one side of the gap and all sfpdev values of the other parent fall on the other side of the gap, then this probe is called a sfp. obviously, a simple ratio of two consecutive sfpdev values cannot fully characterize the distribution of sfpdev values from all of the rils, and the searching method also lacks the statistical justification of false positive control. moreover, it has been reported in the literature that most of sfps predicted from the sfpdev-based analysis are gene expression level polymorphisms rather than the genuine sequence polymorphisms, suggesting that the sfpdev is not independent of the gene expression level. in this article, we formulate the sfp detection problem as a hypothesis testing of unimodality versus multimodality, and propose a bootstrap testing procedure to predict sfps based on the estimated binding affinity (eba) values from the robust multi-array analysis (rma) method.our simulation studies show that our procedure can reach a satisfactory detection power with fdr controlled at the desired level when there are sufficiently strong signal intensities from the microarray hybridization. they also show that our procedure is robust to the unimodal distribution assumption, which allows the broader application of our procedure. our analysis of the ril datadetected more than four times as many sfps, covering 96 of that of. the constructed genetic map using the predicted sfps showed over 99 concordance of the genetic positions with their known physical locations on genome sequence. to account for the binding affinity from the pm intensity value, we proposed the eba, which is estimated by the tukeys median polish method from the rma model (1). however, in the real data analysis, we obtained the eba by dividing the pm value by the estimated expression level, since there were only two replicates for each ril and the estimate for the binding affinity might not be reliable. the performance of the eba was investigated in the real data analysis. compared to the low detection power of sfpdev and high fdrs of indexes proposed in, the eba showed the advantage of high detection power and competitive fdr control. because of the conservativeness of the fdr control procedure of, the actual fdr from our procedure is usually smaller than the nominal fdr. however, in the real data analysis, a seemingly larger fdr was obtained. this phenomenon has also been reported in the literature. in additional to the binding affinity and the gene expression level, many factors could affect the signals on the arrays and result in the sfp like probes that cannot be validated by the sequence polymorphisms . in our simulations where f i (x) is multimodal if and only if the probe i is a sfp, our algorithm works well and the fdr is controlled at the nominal level. note that the detection power highly depends on the separation of two modes in the bimodal distribution. the low detection power in our real data analysis are mainly due to the poor bindings of the target sequences that perfectly match to the probe sequences on the array, resulting in the modes not separatable. the on-going efforts on sfp technology , including complexity reduction and gene enrichment of the target dna, can potentially improve the detection power of sfp detection. this article is motivated by the sfp detection predominantly for homozygous ril populations, where there are only two genotypes at most loci. rejecting the null hypothesis directly implies the sequence difference between those two genotypes. in other settings, there might be more than two possible genotypes, resulting in bimodal, trimodal or multimodal distribution of the eba values for a sfp. the number of modes is of great interest for genotype identification, which can then be formulated as the following hypothesis testing:  
