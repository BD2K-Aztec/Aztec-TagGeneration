geiger v2.0: an expanded suite of methods for fitting macroevolutionary models to phylogenetic trees phylogenetic comparative methods are essential for addressing evolutionary hypotheses with interspecific data. the scale and scope of such data have increased dramatically in the past few years. many existing approaches are either computationally infeasible or inappropriate for data of this size. to address both of these problems , we present geiger v2.0, a complete overhaul of the popular r package geiger. we have reimplemented existing methods with more efficient algorithms and have developed several new approaches for accomodating heterogeneous models and data types. availability and implementation: this r package is available on the cran repository http://cran.r-project.org/web/packages/geiger/. all source code is also available on github http://github.com/mwpen-nell/geiger-v2. geiger v2.0 depends on the ape package. contact:in the past few decades, phylogenetic trees have become a key component of evolutionary research. this development has been fueled by the increased availability of robust time-calibrated phylogenies for many groups, in addition to an expanding number of statistical techniques for inferring patterns and processes from comparative data (reviewed in). among the many r packages developed for phylogenetic and comparative data (e.g.,), geiger has been a primary utility for making macroevolutionary inferences from phylogenetic trees. however, in the 6 years since the initial release of geiger, the data available for comparative biology have changed substantially. for some groups, we now have phylogenies and corresponding trait data with thousands (and even tens of thousands) of species (e.g.). geiger v2.0 is a complete overhaul of the previous release , designed to scale up comparative methods to large datasets. to do so, we have taken two complementary tacks. the first is to improve algorithms and implementations to increase computational efficiency of existing methods. the second is to expand the suite of statistical approaches to allow for heterogeneity in both models and data types across the phylogeny. in this applications note, we briefly describe the methods now in geiger, with a particular focus on novel implementations and algorithms. most of these methods have been previously published elsewhere in some form, and we refer readers to the relevant publications for full explanations (for an overview of the main features of the package, see appendix 1 in supplementary material). the function fitdiscrete. we have rewritten this function for geiger v2.0, again using an alternative, more efficient algorithm for calculating the likelihood of observing trait values under a model . in the new version of fitdiscrete, the computational time required for the likelihood calculation scales approximately linearly with the number of character states, whereas the previous version scaled superlinearly (see appendix 2 in supplementary material for details). this improvement allows for more complex models to be efficiently fit to large phylogenies.in this note we provide a broad overview of the methods now available in geiger. we have not discussed some methods implemented in geiger (e.g. congruification for time-scaling large trees;) and many of the nuances of the methods described here have been left out. we refer readers to associated publications and the package documentation for more information. it is an exciting time for macroevolutionary research. we now have access to datasets of unparalleled size and a wide variety of new statistical approaches with which to analyze them. we hope that the software presented here will help researchers address some fundamental and long-standing questions in macroevolution.  
