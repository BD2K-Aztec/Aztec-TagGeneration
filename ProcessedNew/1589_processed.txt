environment specific substitution tables improve membrane protein alignment motivation: membrane proteins are both abundant and important in cells, but the small number of solved structures restricts our understanding of them. here we consider whether membrane proteins undergo different substitutions from their soluble counterparts and whether these can be used to improve membrane protein alignments, and therefore improve prediction of their structure. results: we construct substitution tables for different environments within membrane proteins. as data is scarce, we develop a general metric to assess the quality of these asymmetric tables. membrane proteins show markedly different substitution preferences from soluble proteins. for example, substitution preferences in lipid tail-contacting parts of membrane proteins are found to be distinct from all environments in soluble proteins, including buried residues. a principal component analysis of the tables identifies the greatest variation in substitution preferences to be due to changes in hydrophobicity; the second largest variation relates to secondary structure. we demonstrate the use of our tables in pairwise sequence-to-structure alignments (also known as threading) of membrane proteins using the fugue alignment program. on average, in the 1025 sequence identity range, alignments are improved by 28 correctly aligned residues compared with alignments made using fugues default substitution tables. our alignments also lead to improved structural models. availability: substitution tables are available at: http://www.stats.ox .ac.uk/proteins/resources.membrane proteins constitute 30 of human proteins , and are important drug targets. unfortunately, the structures of these proteins are hard to determine. as of january 2011, there are 70000 structures in the protein data bank (pdb) , of which fewer than 1500 are recognized as membrane proteins by the pdb_tm database . even these available structures are highly redundant. thus, for most membrane proteins only a sequence is known: structural information must be inferred by modelling. structure modelling can broadly be divided into template-free and template based methods . template based modelling makes use of homologous proteins that are identified as having similar structures to that of the target sequence. proteins are to whom correspondence should be addressed. normally considered homologous if they share significant sequence similarity. once a homologous protein with a known structure (the template) has been identified, it is aligned to the target sequence. this alignment between two sequences can be improved by the use of structural information from the template. this sequence-tostructure alignment forms the blueprint which coordinate generation programs such as modeller for soluble proteins , or medeller for membrane proteins use to build a model. the accuracy of a model is primarily determined by the quality of the initial alignment . the membrane is a radically different environment from the aqueous environment of soluble proteins. most membrane bilayers are composed of phospholipids with hydrophobic tail groups and charged head groups. this suggests for example that substitutions from charged residues to hydrophobic ones are unlikely in head-contacting regions, and conversely that substitutions from hydrophobic residues to charged ones are unlikely in tail-contacting regions. thus, membrane proteins will have unique patterns of substitutions . however, due to lack of data, the alignment of membrane proteins is typically performed with substitution tables optimized for soluble proteins. identifying appropriate tables for membrane environments is expected to improve methods that depend on them, particularly for sequenceto-structure alignment . environment-specific substitution tables (essts) are one of the methods used to align target sequences with known structures. a substitution table tabulates the chances that an amino-acid in one protein is replaced by another in a second protein: for example that a glycine residue is replaced by an alanine. essts are a set of substitution tables, each of which is to be used in a different environment. environments are defined by features such as secondary structure and accessibility. essts are used in sequenceto-structure alignment as the environments for each residue can be determined from the structure. to create an esst, substitutions in each environment must be counted between a number of related proteins. in early studies tables were constructed by counting substitutions between homologous proteins of known structure . more recently, tables have been made by counting substitutions between one structure and many sequences . the latter method is used here. environment independent substitution tables have previously been made for transmembrane regions. the jtt table appears to be the earliest example, with the phat and slim tables following. these tables were intended to be used in conjunction with a nonmembrane table, such as blosum62 . this bipartitescheme requires a separate algorithm to decide where to use each table. sequence alignment has been attempted using phat, with both bad , and good results when compared with alignments using only blosum62. the slim table is optimized for homology detection: its authors explicitly caution against using it for alignment. two problems complicate the construction of essts for membrane proteins: firstly, it is difficult to determine the structural environment of residues even in known membrane structuresalthough secondary structure and accessible surface area can be determined as for soluble proteins, the location of a residue within the membrane bilayer cannot be inferred from the solved structure alone. here we use the annotation program imembrane to determine these contacts. secondly, once an esst is created, it is difficult to assess if it is representative of its environment across all membrane proteins. how can we tell if we have made a good table? we describe a metric of esst quality that is robust against perturbations in the observed frequencies of individual substitutions. we create good membrane essts and analogous soluble essts and make global comparisons between them. a dendrogram illustrates inter-table distances, and a principal component analysis is used to detect the dependence of substitution patterns on environment type. membrane environments are found to be far more diverse than soluble protein environments. for example, any pair of lipid tail layer environments are more dissimilar than the corresponding pair of soluble environments. fugue is a commonly used program to produce sequence-to-structure alignments with essts. we compare several methods for sequence-to-structure alignment generation: default fugue, our membrane-based fugue, a bipartite phat/blosum62 scheme, and the sequence-to-sequence alignment program muscle . our membranespecific essts consistently improve alignment quality, especially at low sequence identity. in the 1025 sequence identity range, compared with the next best method (the default fugue tables) 54 alignments are improved by at least 10 residues, whereas only 6 alignments are worsened by the same amount. in this range the average improvement per alignment is 28 more residues aligned correctly. these alignment improvements are found to lead to corresponding improvements in structure prediction.we have constructed substitution tables for membrane proteins by aligning single structures to multiple homologous sequences. this  
