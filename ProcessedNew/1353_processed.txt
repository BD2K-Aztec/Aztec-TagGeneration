gene expression detecting regulatory geneâ€“environment interactions with unmeasured environmental factors motivation: genomic studies have revealed a substantial heritable component of the transcriptional state of the cell. to fully understand the genetic regulation of gene expression variability, it is important to study the effect of genotype in the context of external factors such as alternative environmental conditions. in model systems, explicit environmental perturbations have been considered for this purpose, allowing to directly test for environment-specific genetic effects. however, such experiments are limited to species that can be profiled in controlled environments, hampering their use in important systems such as human. moreover, even in seemingly tightly regulated experimental conditions, subtle environmental perturbations cannot be ruled out, and hence unknown environmental influences are frequent. here, we propose a model-based approach to simultaneously infer unmeasured environmental factors from gene expression profiles and use them in genetic analyses, identifying environment-specific associations between polymorphic loci and individual gene expression traits. results: in extensive simulation studies, we show that our method is able to accurately reconstruct environmental factors and their interactions with genotype in a variety of settings. we further illustrate the use of our model in a real-world dataset in which one environmental factor has been explicitly experimentally controlled. our method is able to accurately reconstruct the true underlying environmental factor even if it is not given as an input, allowing to detect genuine genotypeenvironment interactions. in addition to the known environmental factor, we find unmeasured factors involved in novel genotype environment interactions. our results suggest that interactions with both known and unknown environmental factors significantly contribute to gene expression variability. availability: and implementation: software available at http://pmbio.large-scale genotyping and expression profiling initiatives have fostered expression quantitative trait loci (eqtl) analyses, investigating the genetic component of gene expression variability. eqtl studies in human , segregating yeast strains , mouse and arabidopsis thaliana have revealed an abundance of associations between genetic polymoprhisms and the expression levels of individual genes. while building this compendium of eqtls in different genetic systems and species, it has become clear that the cellular and environmental context needs to be taken into account to fully understand the genetic architecture of gene expression . one route toward investigating such context dependency is explicit experimental stratification. in human, expression profiling in different tissue types, both in unrelated individuals and families , has shown that eqtls frequently have tissue-specific effect sizes, and in some cases exhibit opposite effects. analogously, also different environmental backgrounds and cellular contexts may modulate the genetic control of molecular traits , suggesting that environment-specific genetic effects, also called genotypeenvironment interactions, are the rule rather than the exception. despite their relevance, molecular studies with explicit environmental perturbations are difficult to carry out in populationscale studies. precise control of the environmental state cannot be achieved for many important organisms. for example in human, the relevant environment could be of climatological or social nature, and hence is either completely unknown or can only be indirectly influenced via targeted sample selection . furthermore, the most relevant factors for molecular regulation may not be a global external condition but rather cellular factors, which are in turn driven by genetic or external factors . in all of these settings, the most relevant context and environment are not directly measurable; hence, statistical inference of these factors is needed to study their implications on the transcriptional state. to whom correspondence should be addressed.recently, several methods have been proposed to account for unknown confounding in eqtl studies, a substantial proportion of which can be attributed to subtle environmental effects . while these methods have been shown to substantially increase power in detecting true eqtls, the potential of using such recovered factors to identify genotypeenvironment interactions has largely been overlooked. here, we present an integrated probabilistic model, linear mixed model interaction (limmi), which allows for recovering unknown environmental or cellular factors from gene expression profiles and detecting genotypeenvironment interactions. limmi allows for a flexible class of environmental and genetic effects that act on gene expression, including direct effects and interactions between them . at the same time, the model enforces that the estimated factors are truly environmental and not themselves under genetic control. we evaluate limmi on synthetic data, where we assess the ability of limmi to (i) recover the true simulated environmental state, (ii) better detect direct genetic effects and, in particular, (iii) identify genotypeenvironment interactions with unmeasured environmental factors. we then revisit an eqtl study on yeast , where we compare the inference of limmi with a measured environmental variable. beyond accurately recovering this known environmental effect, limmi retrieves an additional 14 factors that are orthogonal to the genetic state. when using these factors to test for environment-specific genetic effects, we find hotspots of genotypeenvironment interactions, some of which are enriched for known response processes to environmental stimuli. finally, we demonstrate that including interactions between genotype and learnt factors in a mixed model improves both detection power as well as calibration of test statistics for direct genetic effects in an eqtl scan.we evaluated the ability of limmi to retrieve genuine genotypeenvironment interactions. in particular, we studied the relative performance of two approaches, limmi and limmi-sva, that share the same testing procedure but infer the unknown environment in different ways (section 2.4). we also considered a standard linear association test as a baseline method.here, we have presented a novel approach to detect genotype environment interactions with unmeasured environmental factors. limmi is able to recover the unmeasured environmental state solely from gene expression data. once learnt, these variables can be used in genetic analyses to investigate interactions between environmental factors and genotype with a regulatory effect on gene expression traits. approaches like limmi are relevant for virtually any genetic study of high-dimensional molecular traits, in particular if the environmental state is only partially measured or remains entirely unknown . here, we illustrated and assessed limmi in simulated examples and in retrospective analyses of data from yeast genetics. we compared genotypeenvironment interactions with learnt environments with interactions found when using explicit environmental measurements. first, limmi was able to accurately detect previously known interactions. second, we found novel genotypeenvironment interactions beyond what can be detected when relying on the measured environmental state. these additional effects were predominantly trans-acting, with some loci having widespread effects on large fractions of the expression traits. in the case of the largest hotspot, the interacting locus overlapped with a group of genes involved in temperature sensitivity, providing a plausible explanation of the mechanistic underpinning of this finding. finally, we have shown how the recovered interactions can be used to refine statistical testing procedures. accounting for the effect of genotypeenvironment interactions within a limmi eqtl scan resulted in increased power to detect true associations in simulations and yielded improved test statistics on real data. limmi is related to a range of existing factor models, in particular techniques that model hidden expression determinants to correct for their confounding effect. these methods can be broadly grouped in two classes: models that are aimed at retrieving a set of confounding factors explicitly and models that account for the variance introduced by confounding factors . in principle, any of the models that retrieve an explicit representation of factors can be used for interaction analyses like the one presented here. specifically, in this article, we implemented a version of our method that was using sva for this purpose. limmi is most closely related and builds on panama ; however, we propose a new route toward understanding the role of the environment in a genetic context rather than merely correcting it away. for this purpose, we extend panama in several ways. first, we introduce a systematic approach to use inferred environments to test for genotypeenvironment interactions while accounting for the effect of unknown environments. second, we show how the detected genotypeenvironment interactions can be used to further refine the statistical testing of eqtls. other methods like sva , peer and the method by listgarten et al. do not focus on recovering interactions per se, although we have created a modified variant of sva for the purpose of comparison. the main shortcoming of these techniques is the lack of an effective mechanism to ensure that the learnt factors are not driven by genotype, which leads to the inferior performance of limmi-sva in our experiments. in conclusion, limmi is a methodological advance that allows for refined inference of environmental factors from molecular profiling data. when used in genetic analyses, these learnt variables help to improve the mechanistic understanding of molecular traits, thereby increasing the fraction of phenotype variability that can be explained. approaches as the one presented here will become even more useful when dataset sizes increase further, providing sufficient power to estimate even more complex models and effect types between the genetic state, known and hidden environments and the transcriptional state of the cell.  
