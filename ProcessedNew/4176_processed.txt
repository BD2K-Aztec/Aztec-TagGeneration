selection of models for the analysis of risk-factor trees: leveraging biological knowledge to mine large sets of risk factors with application to microbiome data downloaded from motivation: establishment of a statistical association between microbiome features and clinical outcomes is of growing interest because of the potential for yielding insights into biological mechanisms and pathogenesis. extracting microbiome features that are relevant for a disease is challenging and existing variable selection methods are limited due to large number of risk factor variables from microbiome sequence data and their complex biological structure. results: we propose a tree-based scanning method, selection of models for the analysis of risk factor trees (referred to as smart-scan), for identifying taxonomic groups that are associated with a disease or trait. smart-scan is a model selection technique that uses a predefined tax-onomy to organize the large pool of possible predictors into optimized groups, and hierarchically searches and determines variable groups for association test. we investigate the statistical properties of smart-scan through simulations, in comparison to a regular single-variable analysis and three commonly-used variable selection methods, stepwise regression, least absolute shrinkage and selection operator (lasso) and classification and regression tree (cart). when there are taxo-nomic group effects in the data, smart-scan can significantly increase power by using bacterial taxonomic information to split large numbers of variables into groups. through an application to microbiome data from a vervet monkey diet experiment, we demonstrate that smart-scan can identify important phenotype-associated taxonomic features missed by single-variable analysis, stepwise regression, lasso and cart.in recent years, the problem inherent in characterizing microbiome communities is of rapidly growing interest in considering dna sequences extracted from samples of these communities. application of this method of interrogation to large samples of individuals in population-based studies has become possible due to advances of technology and the significant reduction in sequencing costs, and investigators are increasingly considering the role of microbial composition in human health and disease. microbiome research is an important, rapidly growing field. one of its goals is the identification of features (such as diversity or composition) of microbial communities and their association with host phenotypes. typically, the 16s rrna gene amplicons from samples are sequenced and classified into taxonomic trees, based on phylogenetic relationships, through reference alignment and/or unsupervised learning, and then the association between tree structures and host phenotypes is investigated. in such studies, the statistical analysis is challenging because of the large number of tree variables and hierarchical, nested tree structures. a variety of statistical methods have been proposed for detecting the association between microbiome features and host phenotypes. microbiome data commonly used for these analyses are sequence counts (usually standardized to relative abundances or dichotomized to presence or absence) of operational taxonomic units (otus). otus represent the lowest taxonomic level into which a sequence can be assigned, that is typically used in downstream analysis. an otu can be defined as a phylogenetic unit (such as bacterial species or genus) or a set of similar dna sequences learned by data clustering . for many analyses, a phylogeny relating the otus is needed. the process of determining otu counts, referred to as otu picking, can be reference-based, i.e. sequence reads are mapped to a reference database of known 16s rrna gene sequences, using, for instance, the ribosomal database project (rdp) classifier . in this case, the otus have a presumed known phylogeny and taxonomy established externally and documented in the reference database; for many of the common species, these relationships are well known. in de novo otu picking, reads are clustered based on sequence similarity and otus are defined based on a maximum dissimilarity threshold . here, phylogeny can be inferred either de novo (e.g. by constructing a neighbor-joining tree) or by mapping representative reads to a reference database . in either case, once a phylogenetic tree has been constructed, the information comprising the tree can be leveraged in downstream analyses. downstream statistical analysis methods can be categorized into several broad approaches: simple univariate methods, tests of diversity, multivariate methods, and model-selection methods. univariate approaches generally ignore the phylogenetic tree structure and multivariate and correlated nature of the otu count data; these include simple one-taxon-at-a-time tests of association between phenotype and otu abundance (or presence/absence), and are likely to be powerful when one or a few taxa have strong effects on host phenotype . another relatively simple approach is to associate microbiome diversity with host phenotype. numerous measures of diversity exist and provide different ways to quantify the richness or evenness of otus within a phenotype . multivariate methods that assess the association of an entire vector of multiple otus have been widely used. as otu abundances are nonnegative and not distributed as a multivariate normal, standard multivariate methods (e.g. hotelling t 2 test and multivariate analysis of variance (manova)) are generally inappropriate. methods have been developed to model the otu abundances as drawn from a dirichlet-multinomial, or mixture of dirichlet multinomials . nonparametric multivariate methods for hypothesis testing are commonly used as well. in general, these are defined based on a distance measure of dissimilarity between each pair of samples, with the samples characterized by a vector of otu counts. the distance measure can be tree unaware (e.g. euclidean distance or braycurtis dissimilarity) or tree aware. tree aware measures can take into account the structure of the phylogenetic or taxonomic tree. for example, unifrac is a tree-aware method that calculates distances between pairs of microbiome samples based on the fraction of the total branch length leading uniquely to one or the other community . based on pairwise distances, various nonparametric multivariate tests can be conducted, such as the mantel test and nonparametric manova . a final category of methods for analyzing association between otu abundances and host phenotypes comprises regression-based variable-selection methods. due to the large number of parameters (usually coupled with relatively small sample size) in microbiome data analysis, l1-regularized regression, in particular the least absolute shrinkage and selection operator (lasso), has been considered as an appropriate choice . in summary, these four categories of methods were developed to address two types of questions. while diversity tests and multivariate methods are usually used to determine whether the overall feature (diversity or composition) of an entire tree of otus is associated with a phenotype (i.e. overall association), univariate tests and model-selection methods identify which specific otus are associated (i.e. specific association). in practice, a specific association is particularly interesting and important, because it can provide biological insight into the mechanism of the disease and help define a potential target for modification. however, existing methods for detecting specific association (such as univariate or multivariate regression, lasso, etc.) have significant limitations. most of these methods do not take into account the taxonomic or phylogenetic relationship among otus. in these methods, individual otus are modeled as separate variables independent of each other, although shared evolutionary ancestry means that otus cannot be treated as statistically independent groups . another issue is that the microbiome data can be classified across multiple levels and an association can be driven by an enrichment of an entire group of otus at higher taxonomic levels such as bacterial families, orders or even phyla . in this case, only modeling individual otus at the lowest taxonomic level may significantly lose power because of weaker effects of individual otus. although existing univariate tests and variable selection methods (even treebased multivariate methods such as unifrac) can be applied to different levels or subsets of the data to identify specific association, conducting such analyses of all possible levels and subsets of a large taxonomic tree creates an intractable multiple comparison problem, therefore, strategies leveraging additional biological information to reduce the model space and optimize the search procedure are desirable. to overcome these issues, we have developed a novel tree-based method, selection of models for the analysis of risk-factor trees (smart-scan), which can leverage phylogenetic knowledge to mine large sets of tree risk factors and is particularly appropriate and powerful for detecting the otus associated with host phenotypes and grouped by similar effects. unlike those widely-used multivariate methods (e.g. unifrac) for overall association analysis using pairwise distances between subjects or hierarchical tree of subjects, smart-scan is designed for specific association analysis using the tree of risk factors (i.e. otus), not the tree of subjects. essentially, smart-scan is a variable grouping technique that incorporates the known structure of the variables into models. it adopts a tree scanning strategy that efficiently performs an iterative search for risk factors (or groups of factors) within a structured tree. this strategy was previously introduced and used for detecting phenotypic associations with haplotype trees at candidate loci . in this article, we present the theory and algorithm of smart-scan, and, in comparison to other four existing methods, we investigate its statistical properties using simulated data and demonstrate its application using microbiome data from vervet monkeys.we used a dataset characterizing the gut microbiome of vervet monkeys (chlorocebus pygerythrus) under two different diets to demonstrate the application of smart-scan. the production of this data has been described previously and details of dietary compositions are described elsewhere . the dataset contains the 16s rrna gene sequences of gut microbiomes sampled from 179 vervet monkey subjects, of which 68 animals were treated with a fatty diet and 111 with normal diet. rectal swabs were obtained from the animals and dna was extracted using the mobio powersoil kit, and the 16s rrna genes were amplified (16s rrna gene variable regions v3v5) and subjected to pyrosequencing using the 454 life sciences sequencing platform. sequences were compared with the rdp database after quality filtering and the taxa, and their abundances found in each sample were tallied. these procedures were those used in the human microbiome project (2012a, b). these sequences were assigned to a taxonomic tree of 287 bacterial genera, 156 families, 72 orders, 40 classes and 18 phyla via the rdp reference alignment, and then the sequence count of each taxon, divided by the total number of sequence reads (averagely 7078 reads per subject), was used as estimates of relative abundance. animals were designated as being on the normal diet (0) or on the fatty diet (1), analogous to a case-control design. the microbiome dataset we used has been submitted to the ncbi bioproject database with an accession id prjna259274.we applied smart-scan, sva, stepwise regression, lasso and cart to the vervet monkey data, to investigate the effects of a fatty diet on microbiome composition. out of 287 bacterial genera included in the analysis, sva identifiedall these together make regular variable selection methods suffer from low power. microbiome data, however, have a unique feature, i.e. the composition, assessed by sequence analysis, can be organized into a hierarchically structured phylogenetic tree. because such a tree provides the information on the similarity between taxonomic groups, it can be utilized to significantly improve model selection . based upon this idea, we have developed a tree-based model selection method, smart-scan, and demonstrated its advantages over other methods. in smart-scan, we leverage the phylogenetic information in a model selection approach to obtain a more powerful test of association. to realize the benefit of smart-scan, it is assumed that phylogenetically close taxa have more similar effects than those that are distant. this model appears to be supported by our analysis of the vervet monkey diet experiment, in which of a large group of 41 genera in a phylum was identified to be affected by diet. importantly, smart-scan is not only a useful tool for microbiome analysis, but also provides a strategy and framework for mining high-dimensional structured data, and therefore has applications in other situations. it can be easily extended to other model selection problems in any situation that variables are hierarchically structured and close variables share similar group effects. for example, it can be used to identify genes or gene groups that are associated with phenotypes, using sequence or expression data. in this type of analysis, genes can be treated as variables to be selected and organized into a hierarchical structure based on established pathway or gene set information. the key feature of smart-scan is variable grouping with the aid of known variable structure. this feature makes smart-scan differ from many other multivariate analysis techniques. unlike the variable selection in stepwise regression, lasso and cart through including and excluding variables in models, smart-scan reorganizes variables into groups. instead of selecting variables, it selects the way of grouping variables. an advantage of variable grouping is that different variables with similar or identical effects are summarized into a single group variable, therefore, the total numbers of variables in the final model could be substantially reduced. from this perspective, smart-scan can be viewed as a technique of data dimensionality reduction. compared with other dimensionality reduction methods, such as principal components analysis (pca) and multidimensional scaling (mds), smart-scan has clearer biological meaning and facilitates interpretation. for example, when it is difficult to biologically understand a pca from a linear combination of hundreds of otu variables with different loads, we may clearly define a group of 20 otus from the same bacterial family in smart-scan and then investigate the association between them and a clinical outcome. although smart-scan utilizes tree-like hierarchical structure, it is very different from hierarchical linear models (hlms) (also called multilevel models or nested models), because hlms are for modeling the structure of subjects, not of predictor variables. smart-scan is also different from classification and regression tree (cart) analysis. cart is a widely-used machine learning method which models the data through a decision tree. a decision tree used by cart is very different from the phylogenetic tree used by smart-scan in many aspects. it does not necessarily reflect biological phylogeny or taxonomy. unlike a phylogenetic tree describing the hierarchical structure of variables, a decision tree is a predictive model describing how to use predictors in a treelike ordered boolean way to predict an outcome. the phylogenetic tree is known and used by smart-scan as a prior to help grouping and summarizing variables, while a decision tree is unknown and needs to be learned by cart in a data-driven, predictive manner. these differences, however, do not mean that smart-scan has no connection with other methods, instead, smart-scan can be easily incorporated with other methods. for example, after a large number of variables are grouped and summarized by smart-scan into fewer variables, other methods (e.g. stepwise regression, pca or cart) can be applied to the new variables to refine the analysis. overall, smart-scan is flexible in terms of data modeling, because the aic goodness-of-fit makes it applicable to any data type for which likelihood-based models can be developed. it can be applied to quantitative, qualitative and survival phenotypes, with or without covariates, complex interactions and random effects. currently we have implemented smart-scan in r, which can handle both quantitative and binary phenotypes, more extensions will be developed and added. it should be noted that, when a p value cutoff is required to determine the significance in an application, directly calculated p values in the final model of smart-scan could be inflated, because the variable grouping and model selection procedure tends to produce results deviating from the null distribution. this is a common issue of all model selection methods, and usually can be adjusted by a permutation test, which can be implemented by users through a standard, random permutation of phenotype data (supplementary). another caveat to the application of smart-scan is that the result of an analysis and its interpretation rely on an estimated phylogenetic tree, and this estimated tree can be subject to ambiguity due to homoplasy because of parallel or convergent mutations and/or horizontal gene transfer. concerning tree ambiguity, earlier work with nested clade analysis and treescan, techniques that also use a phylogenetic tree to generate a statistical design and that motivated smart-scan, showed that the statistical design that emerges from using an estimated tree is actually robust to much potential ambiguity within that estimated tree and does not require a fully resolved tree . for example, most homoplasy occurs on long branches that separate phyla. however, smart-scan does not require that the phylogenetic relationships among phyla be fully resolved; rather, smartscan only requires that the basic topology be an accurate one and does not require accurate branch lengths, exact interconnections or rooting of the tree. we used the taxonomic classification as the basis of our tree in this paper, and a recent estimator of the bacteria phylogeny based on whole genomes revealed a general agreement between the taxonomic classification and phylogenetic distribution of these genomes . within phyla, homoplasy is less of a problem and the estimated trees are more accurate, so one great advantage of just using the tree to generate a statistical design is that it makes homoplasy much less of a problem in inference of trait associations as opposed to inference of phylogeny. however, one aspect of horizontal gene transfer could be important in our inference structure. in section 3.2, we used sequence data to estimate the bacterial abundance (down to the genus level) by counting the sequence reads that were mapped to a set of reference sequences with known, predefined taxonomy. when there are horizontal gene transfer events causing homoplasy between genera, the abundance estimation could be biased, because a transferred gene sequence in genus a could be aligned back to its original location (genus b) in the tree, causing it to be counted for the abundance of genus b and not genus a. accordingly, we may interpret the abundance in a slightly different way: it is not strictly generic abundance, but rather sequence-oriented abundance that complies with the reference sequences. therefore, the actual goal of section 3.2 can be understood as the identification of association between diet and sequences clustered based on their similarity, not association between diet and strictly biological abundances. alternatively, an unsupervised clustering tree based on only sequence similarity (not taxonomy reference alignment) can also be used for the smart-scan analysis. of course, when biological abundances are of interest, other analytical strategies may need to be adopted, such as using data at higher taxonomic levels or using subtrees with less homoplasy.  
