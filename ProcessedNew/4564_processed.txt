structural bioinformatics tfreg: calculating dna and rna melting temperatures and opening profiles with mesoscopic models the mesoscopic statistical physics models, known generically as peyrardbishop (pb) models, have found many applications for the study of oligonucleotide properties. unfortunately, pb models have not reached a wider non-specialized audience for the lack of freely available software implementations. here we present an exten-sible c implementation of four variants of the pb model, which allows the user to calculate melting temperatures from tested model parameters. even for a non-specialist, it should be straightforward to change these parameters to reflect different experimental environments or different types of oligonucleotides. for users with some proficiency in c programming, it should be feasible to extend the code to other pb models owing to the generic programming implementation adopted for tfreg. pre-calculated parameters are included that allow the immediate calculation of melting temperatures and thermal equivalence indexes for dna and rna. availability: c source code and compiled binaries for several linux distributions are available from https://sites.google.com/site/ geraldweberufmg/tfreg and from opensuse build service at http://the peyrardbishop (pb) model was introduced in 1989 ; it is a mesoscopic statistical method with two terms describing separately the hydrogen bond between the base pairs and the stacking interaction of the dna molecule. these two terms describe the dna physics well enough to make it a popular choice for the study of numerous physical properties . additionally, the method is simple enough to make it computationally feasible to calculate a large number of different sequences in short time, a common requirement for many bioinformatics applications. the model has been successful in numerous applications and is one of the leading approaches for modelling oligonucleotides at the mesoscale; for a discussion on this see the review by. being a computationally efficient method, it is unfortunate that as yet no software implementation was made available to a wider bioinformatics audience. here we are trying to bridge the gap by providing an implementation of the pb model that is accessible to a non-specialist, but which we hope may also be valuable to pb model specialists. the original code on which this application note is based was used to calculate the results of several of our publications on dna (, b) and more recently on rna . therefore, this application note has the added purpose of providing specialists in this type of model with the opportunity to verify our published results. currently, software applications for melting temperature analysis fall into two broad categories: free energy models such as the one pioneered byand those based on polandscheraga models such as umelt byand by. both approaches are nearest-neighbour (nn) methods, that is, they model the interaction between consecutive base pairs. pb models on the other hand also consider the hydrogen bonds of individual base pairs through a morse potential . our parametrization studies revealed that these morse potentials are remarkably consistent even when applied to completely different melting temperature datasets. for instance, the hydrogen morse potential of cg base pairs was found to be nearly identical for both dna and rna . therefore, the pb models offer the unique opportunity to study what would happen to melting temperatures and opening profiles under different strengths of hydrogen bonds.in essence, the main parameters of the pb model are the morse potential d, which represents the hydrogen bond, and the elastic constant k, which represents the stacking interaction. the potential d depends only on the base pair and, as a rule of thumb, is roughly proportional to the strength of the hydrogen bonds. if the user wishes, for instance, to experiment with a stronger hydrogen bond, all that is needed is to set a larger value for d. in this respect, the pb model offers a much more intuitive framework for setting its parameters than the nearest neighbour models based on gibbs free energy . for instance, in, we show an example for a dna sequence where we calculate all opening profiles for a range of temperatures. these opening profiles were calculated for open boundary conditions and therefore clearly show the end fraying of the dna sequence. in, we show the same sequence ofbut now calculated with periodic boundary conditions, which would be equivalent to a circular dna. the characteristic end-fraying is now absent and generally this structure appears much more stable at higher temperatures than for open-ended dna. opening profiles calculated for a range of temperatures can be combined into opening maps, such as exemplified in supplementary. in terms of the accuracy of predicting melting temperatures, tfreg is at least on par with nearest-neighbour free energy models. supplementaryshows the melting temperature average error when compared for the dna dataset bycompared with the methods implemented by dnamate by panjkovich and melo (2005) and the phenomenological model by khandelwal and bhyravabhotla (2010). one should be aware, however, that the accuracy of predictions is largely determined by the experimental data used to calibrate a given method. in supplementary section s1, we discuss these issues in more detail. one aspect of interest is that tfreg has no fundamental restriction on sequence length, as shown in supplementary, where we present the average accuracy as a function of sequence length. as the accuracy of any prediction method depends so strongly on the dataset used to generate the regression coefficients, it is worth mentioning that tfreg can generate new regression sets from user-provided melting temperatures. this means that users may use tfreg to predict new melting temperatures based on the calibration of their own data, instead of relying on pre-established regression sets.some bioinformatics applications of interest for tfreg would be the prospective studies of melting for situations where little melting experimental data are available for certain types of oligonucleotides, given that the parameters are intuitive. the opening profiles could also be used in addition to flexibility for studies of promoter sequence recognition (fagundes).we provide a complete c implementation of the pb model in the framework of the transfer matrix integral method. in addition to the calculation of the matrices that are essential to the method, the application tfreg also calculates melting temperatures for dna and rna, providing thus an alternative method to the nearest-neighbour gibbs free energy calculations . the application also provides the option of calculating the average helix opening profile. a comprehensive user manual with full explanation of the main aspects of the pb model is provided in the software package and also included as supplementary material.  
