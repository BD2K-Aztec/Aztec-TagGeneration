gene expression assign: context-specific genomic profiling of multiple heterogeneous biological pathways motivation: although gene-expression signature-based biomarkers are often developed for clinical diagnosis, many promising signatures fail to replicate during validation. one major challenge is that biological samples used to generate and validate the signature are often from heterogeneous biological contextscontrolled or in vitro samples may be used to generate the signature, but patient samples may be used for validation. in addition, systematic technical biases from multiple genome-profiling platforms often mask true biological variation. addressing such challenges will enable us to better elucidate disease mechanisms and provide improved guidance for personalized therapeutics. results: here, we present a pathway profiling toolkit, adaptive signature selection and integration (assign), which enables robust and context-specific pathway analyses by efficiently capturing pathway activity in heterogeneous sets of samples and across profiling technologies. the assign framework is based on a flexible bayesian factor analysis approach that allows for simultaneous profiling of multiple correlated pathways and for the adaptation of pathway signatures into specific disease. we demonstrate the robustness and versatility of assign in estimating pathway activity in simulated data, cell lines perturbed pathways and in primary tissues samples including the cancer genome atlas breast carcinoma samples and liver samples exposed to geno-toxic carcinogens. availability and implementation: software for our approach is available for download at:since the advent of high-throughput genomic profiling technologies such as gene expression microarrays and rna-seq, many computational and statistical methods have been developed to derive gene expression signatures for disease diagnosis, prognosis and treatment decisions . gene expression signatures are often used as surrogate representations of pathway activation or deactivation. the use of v c the author 2015. published by oxford university press. all rights reserved. for permissions, please email: journals.permissions@oup.com expression signatures to quantify pathway activation level has been particularly important for dissecting the complexity of diseases and providing guidelines of targeted therapeutics. to date, gene expression-based pathway analyses mainly face two sources of challenges:(i) limited pathway annotations in curated databases and (ii) ineffective analysis tools. in reference to the first limitation, many public databases provide manually curated pathways that associate genes lists with pathway activity. however, genes in those predefined pathways are not always associated with gene expression changes that differ between disease states. for example, some genes in an annotated pathway might be activated through changes in phosphorylation or protein interaction status. thus, pathway analysis approaches that use patient gene expression profiles without careful selection for expression-based signature genes with transcriptional change may lead to incorrect results. an alternative way to infer pathway activity is by experimentally perturbing the pathway of interest in controlled settings and projecting the associated molecular signature (e.g. changes in gene expression) onto patient or other target samples to estimate pathway activity levels . for example, previous efforts have generated gene expression signatures for growth factor signaling pathways in human primary cells and then used the signatures to predict disease prognosis and drug sensitivity in human cancer cohorts . although, these pathway-profiling approaches have been previously shown to generate empirical gene expression-based pathway response signatures, the assumption of homogeneity between in vitro (e.g. perturbation samples) and in vivo (e.g. patient) biological conditions does not always hold due to platform, tissue or disease deregulation status variations. in effort to address the second concern, factor analysis approaches have been used to identify latent factors (metagenes) associated with pathways and clinical outcome . however, it is often difficult to interpret the biological meaning of the latent factors identified by these unsupervised approaches or to estimate the absolute activation level for pathways of interest. supervised classification approaches often model pathways one at a time without accounting for pathway correlation or interaction between related pathways. moreover, supervised classification approaches require expression data from pathway perturbation experiments for building up models, thus often fail to work when only pathway gene lists are available. so far, none of these existing approaches adequately account for tissue, disease or context specificity in assessing gene expression signatures regulated via pathway activation or deactivation. furthermore, none of them are designed to profile genomic signatures across multiple genomic profiling platforms. to overcome these limitations, we propose a novel and flexible pathway profiling toolkit called adaptive signature selection and integration (assign). assign relies on a sparse bayesian factor analysis method to estimate the activation status of pathways under investigation, such as oncogenic pathways, immune response pathways or drug response pathways in individual samples of a genomic dataset for predicting optimal treatment prior to any medication on patients. here, we use multiple simulated and real datasets to demonstrate the validity and robustness of assign in estimating pathway activation. in simulated data, the model correctly adapts the pathway signature gene lists in specific biological contexts by excluding irrelevant genes or including relevant genes into signatures. we used five previously published oncogenic signaling pathway signatures to demonstrate the advantages of modeling multiple pathways in concert to account for crosstalk among the pathways. we also used the tumor samples from the cancer genome atlas (tcga) to show that assign can robustly combine in vitro signatures generated using one profiling platform with tumor samples profiled using a different platform. finally, we used profiling data generated from liver tissues exposed to genotoxic hepatocarcinogens to demonstrate the versatility of assign in identifying and adapting signatures from precurated pathway gene lists. overall, assign uses a semi-supervised approach that results in more biologically interpretable pathway activation profiles that are adapted to specific tissues or disease contexts, as opposed to more rigid and less interpretable profiles generated by previous approaches. although, assign was initially designed for pathway-based analysis from gene expression data, it can easily be extended to other profiling data types such as dna variation or methylation data.to overcome challenges from pathway cross-talk and heterogeneity from biological and technical sources, we developed the assign toolkit that allows for flexible profiling of multiple correlated signatures into specific disease, tissue and patient contexts. here, we demonstrate the features of assign using simulation, cross validation and several publicly available genomic datasets. in section 4.1, we use three simulated scenarios to evaluate the models abilities to estimate pathway-activation status and filter irrelevant genes. in sections 4.2 and 4.3, we illustrate assigns ability to account for context-specific background levels and to crosstalk among multiple pathways. in section 4.4, we evaluate the effectiveness of assign to overcome cross-tissue and cross-platform obstacles to estimates pathway activity in a large breast carcinoma dataset. in section 4.5, we adapt curated signatures of dna damage response pathways to estimate pathway signature strength in liver profiling samples. in these sections we compare assign in multiple contexts with existing methods such as gsea, ssgsea, bfrm and facpad and demonstrate a general advantage of assign over these existing approaches.  
