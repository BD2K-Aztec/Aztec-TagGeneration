genome analysis mlml: consistent simultaneous estimates of dna methylation and hydroxymethylation motivation: the two major epigenetic modifications of cytosines, 5-methylcytosine (5-mc) and 5-hydroxymethylcytosine (5-hmc), coexist with each other in a range of mammalian cell populations. increasing evidence points to important roles of 5-hmc in demethyla-tion of 5-mc and epigenomic regulation in development. recently developed experimental methods allow direct single-base profiling of either 5-hmc or 5-mc. meaningful analyses seem to require combining these experiments with bisulfite sequencing, but doing so naively produces inconsistent estimates of 5-mc or 5-hmc levels. results: we present a method to jointly model read counts from bisulfite sequencing, oxidative bisulfite sequencing and tet-assisted bisulfite sequencing, providing simultaneous estimates of 5-hmc and 5-mc levels that are consistent across experiment types.dna methylation is an important epigenetic mark in mammals. in addition to the extensively studied 5-methylcytosine (5-mc) modification, its oxidation product, 5-hydroxymethylcytosine (5-hmc), has been observed at substantial levels in both somatic and embryonic stem cells . recent studies of 5-hmc in mouse tet knock-out models , mouse zygotic development and multiple cell types suggest that 5-hmc is involved in epigenetic regulation. the current most comprehensive and accurate method for profiling cytosine methylation is bisulfite sequencing (bs-seq). treatment with sodium bisulfite converts unmethylated cytosines to uracils, but does not distinguish between 5-mc and 5-hmc , and consequently the yield of methylation from bs-seq is the sum of 5-mc and 5-hmc levels. two recently developed techniques, oxidative bisulfite sequencing (oxbs-seq) and tet-assisted bisulfite sequencing (tab-seq) , provide high-throughput singlebase resolution measurements of 5-mc and 5-hmc, respectively. any two of bs-seq, tab-seq or oxbs-seq can be combined to profile both the 5-mc and 5-hmc methylomes of a cell population, and especially when studying 5-hmc, proper interpretation of results depends on having some estimate of the 5-mc level. however, naive manipulation of read count frequencies from independent sequencing experiments often produces two kinds of overshoot problems in estimating 5-mc and 5-hmc levels. when combining bs-seq with tab-seq, the 5-mc level at a given cpg site can be estimated by subtracting the 5-hmc level (tab-seq) from the combined 5-mc 5-hmc level (bs-seq). the result can be negative, because of random sampling (or systematic error) in each experiment. similarly, combining tab-seq and oxbs-seq could lead to estimates of 5-mc and 5-hmc levels exceeding 100. these overshoot sites may constitute a substantial proportion. in one dataset based on oxbs-seq technology, 17 of cpg sites captured by reduced representation bisulfite sequencing (rrbs) and oxrrbs experiments exhibited overshoot . to fully leverage the information in these data requires some method for making consistent estimates of 5-mc and 5-hmc levels. we present maximum likelihood methylation levels (mlml)for simultaneous estimation of 5-mc and 5-hmc, combining data from any two of bs-seq, tab-seq or oxbs-seq, or all three when available. our estimates are consistent in that 5-mc and 5-hmc levels are non-negative, and never sum over 1. in an important subset of cases, our estimates are not only consistent but also show significantly greater accuracy at sites with lower coverage.to understand the properties of our estimators and the frequency method, we used simulations with fixed coverage and precisely set levels for 5-mc and 5-hmc, assuming the experiments were bs-seq and tab-seq. the case of bs-seq and oxbsseq is symmetric with the estimates for p h and p m exchanged. for each valid combination of 5-mc and 5-hmc levels from f0:1, 0:3, 0:5, 0:7g, we simulated from binomial distributions for both bs-seq and tab-seq. estimates for p h and p m were made using the maximum likelihood method and the frequency method, which estimate p h using h=h g and p m using max0, t=u t h=h g. the relative error (j p pj=p) for both estimation methods was computed and then averaged over 100 000 simulations for each parameter combination. the average estimation errors are presented in supplementary table s1. estimates of p h are more accurate using mlml, especially at lower values of p h and low coverage. for example, when the true values are p m 0:1, p h 0:1, the mlml reduces the average relative error by 423 at overshoot sites compared with frequency estimates when the coverage is 10, and this reduction in error increases to 57 for such sites covered only 5. the trend for errors of p h estimates is shown in, indicating the accuracy advantage for mlml as a function of coverage. the simulation also revealed substantial amounts of overshoot sites under different 5-mc and 5-hmc level combinations (, supplementary tables).  
