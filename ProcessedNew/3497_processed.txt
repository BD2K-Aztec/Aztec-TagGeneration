pep_scaffolder: using (homologous) proteins to scaffold genomes motivation: recovering the gene structures is one of the important goals of genome assembly. in low-quality assemblies, and even some high-quality assemblies, certain gene regions are still incomplete ; thus, novel scaffolding approaches are required to complete gene regions. results: we developed an efficient and fast genome scaffolding method called pep_scaffolder, using proteins to scaffold genomes. the pipeline aims to recover protein-coding gene structures. we tested the method on human contigs; using human uniprot proteins as guides, the improvement on n50 size was 17 increase with an accuracy of 97. pep_scaffolder improved the proportion of fully covered proteins among all proteins, which was close to the proportion in the finished genome. the method provided a high accuracy of 91 using orthologs of distant species. tested on simulated fly contigs, pep_scaffolder outperformed other scaffolders, with the shortest running time and the highest accuracy.identifying genes is a major goal of genome sequencing projects for downstream functional study and evolutionary analysis. although large-insert libraries or long single-molecule reads improve the genome n50 size, it remains difficult to complete all gene structures. thus, new scaffolding approaches are needed to recover the gene regions. many methods have been developed to increase the continuity of gene regions using transcripts or proteins as guides.utilized paired rna-seq data to scaffold caenorhabditis nematode contigs. nevertheless, the accuracy of this strategy and the improvement in the proportion of complete genes were not estimated. previously, we developed l_rna_scaffolder using long single-end rna-seq reads for genome scaffolding, which was highly accurate (93.6) . however, these strategies require rna-seq data, and genes that are not detected by rna-seq will not be re-built. different from using transcripts, esprit and swips used proteins to link contigs. based on the predicted genes using augustus , esprit identified split protein-coding regions and linked unassembled genomic segments. the accuracy of esprit depends on that of predicted genes. the time-consuming nature of de novo gene prediction also limits its application. swips determined coding contigs and exonic regions using tblastn and genewise , and then scaffolded contigs by optimization of the overall protein to contig mappings. swips integrated multiple steps to refine the precise protein-contig mapping; consequently, it has long running time. herein, we present a novel and fast method to scaffold contigs using (homologous) proteins. the pep_scaffolder has high scaffolding accuracy and is much faster than previous scaffolders. the improved proportion of fully covered genes is close to that of the finished genome.the performance of pep_scaffolder was measured using the n50 size. using human swiss-prot proteins as test guides, the n50 sizes were saturated when the mpi was 0.9, the mlc 0.9 and the mil 150 kb (supplementary figures s2, s3 and s4). using these optimal parameters, the final n50 sizes were 171,032 bp (a 15 increase) and 168,047 bp (a 13 increase) for human swiss-prot proteins and trembl proteins, respectively (supplementary tables s1 and s2). using human swiss-prot and trembl proteins as guides, the contig number was reduced from 36,437 to 30,550. the improvement on n50 size was 16.8 increase at an accuracy of 96. 7, which demonstrated the good performance of pep_scaffolder.in a revised assembly where the scaffolds were split at error points, the corrected n50 size had an improvement of 16.1 increase. the proportion of fully covered proteins in the pep_scaffolder assembly (96.8) was higher than the proportion in the contigs (82.8) and nearly equal to that for hg38 (99.8). in particular, the proportion of fully covered proteins over 500 amino acids showed a larger improvement (from 72.3 to 95.5, a 32 increase) than did shorter proteins, indicating that pep_scaffolder greatly improved the proportion of complete genes . pep_scaffolder was able to scaffold human contigs using orthologs of distant species. using rodent swiss-prot proteins, mammal swissprot proteins, rodent trembl proteins and mammal trembl proteins, we obtained improvements on n50 size of 6.84, 3.61, 10.84 and 20.84, respectively (supplementary tables s1 and s2). the accuracy was as high as 90.82, indicating that pep_scaffolder could utilize orthologs to scaffold a target genome with high accuracy. more genome regions covered by proteins would generate longer scaffolds. to examine the improvement on n50 size with increasing numbers of proteins, we constructed multiple sets of proteins by combining human proteins, mammal proteins and rodent proteins together. the n50 size and corrected n50 size were improved to 182 433 and 176 257 bp (a 22.7 increase and 18.5 increase), respectively, using all proteins as guides (supplementary), indicating that an enlarged proteome could increase the proportion of recovered genes. we scaffolded fly contigs using swips, esprit and pep_scaffolder, respectively. pep_scaffolder produced the most connections (4191) with the highest accuracy (99.6) and the shortest running time (27 minutes) (and supplementary), suggesting that pep_scaffolder is superior to the other scaffolders.we demonstrated that pep_scaffolder is an efficient and fast scaffolder that improves the proportion of complete genes. the performance of pep_scaffolder could be improved in several ways. protein variations between species might influence the accuracy of pep_scaffolder. we observed higher accuracy using proteins from the target species compared with proteins from close species (supplementary tables s1 and s2). the annotations of swiss-prot proteins are created by manual analysis, whereas trembl proteins are predicted automatically without manual annotation. therefore, swiss-prot proteins are more credible than trembl proteins. our results showed that, using swiss-prot proteins, the accuracy of pep_ scaffolder was higher than using trembl proteins (supplementary tables s1 and s2). to overcome the above limitations, werecommend that more supporting proteins are used to construct more accurate scaffolds (supplementary methods 6 and). as shown in supplementary, scaffolding performance is significantly correlated with genome coverage. therefore, increasing the number of (homologous) proteins would improve the performance. pep_scaffolder could be useful for the genome analysis of nonmodel species, which lack high-quality genome assemblies.  
