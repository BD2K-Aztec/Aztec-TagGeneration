sequence analysis bseqc: quality control of bisulfite sequencing experiments motivation: bisulfite sequencing (bs-seq) has emerged as the gold standard to study genome-wide dna methylation at single-nucleotide resolution. quality control (qc) is a critical step in the analysis pipeline to ensure that bs-seq data are of high quality and suitable for subsequent analysis. although several qc tools are available for next-generation sequencing data, most of them were not designed to handle qc issues specific to bs-seq protocols. therefore, there is a strong need for a dedicated qc tool to evaluate and remove potential technical biases in bs-seq experiments. results: we developed a package named bseqc to comprehensively evaluate the quality of bs-seq experiments and automatically trim nucleotides with potential technical biases that may result in inaccurate methylation estimation. bseqc takes standard sam/ bam files as input and generates bias-free sam/bam files for downstream analysis. evaluation based on real bs-seq data indicates that the use of the bias-free sam/bam file substantially improves the quantification of methylation level. availability and implementation: bseqc is freely available at: http:// code.google.comdna methylation, an epigenetic modification affecting the organization and function of the genome, plays an important role in several key biological processes, including transcriptional regulation, x-chromosome inactivation, genomic imprinting, silencing of repetitive elements and chromatin structure . bisulfite conversion followed by next-generation sequencing (bs-seq) has emerged as a powerful technique for detecting genome-wide dna methylation at single-nucleotide resolution . ideally, bs-seq experiment should be able to directly and exactly quantify the methylation level of every cytosine in the genome. however, current bs-seq protocols possess several intrinsic technical biases, which may impact methylation level estimation. these biases include overhang end-repair, 5 0 bisulfite conversion failure, sequencing into the adaptor and 3 0 low sequencing quality . although the last two biases are also present in other next-generation sequencing data, the first two biases, i.e. end-repair and 5 0 bisulfite conversion failure, are highly specific to bs-seq protocols. bs-seq reads with the first two biases can be perfectly mapped to the reference genome; however, they will result in biased methylation estimation. first, after sonication, the overhangs of dna fragments are normally end-repaired with unmethylated cytosines to restore the double stranded dna (illumina wgbs for methylation analysis guide). this may introduce artificially low methylation rates at both ends of the dna fragments. second, bisulfite conversion failure is known to be enriched at the 5 0 end of reads, most likely caused by the re-annealing of sequences adjacent to the methylated adapters in bisulfite conversion . this may bring in artificially high methylation rates at the 5 0 end of reads. most quality control (qc) tools, such as htseqtools and fastqc , only focus on the general sequence quality and adaptor trimming, or other next-generation sequencing applications such as rna-seq . to the best of our knowledge, bsmooth and bis-snp are the only two tools that support qc specific to bs-seq . however, their qc functions are highly limited. the qc model in bsmooth was designed to work with its own alignment and analysis pipeline, and thus cannot take standard bam/sam files as input. furthermore, bsmooth can detect but not correct the biases. bis-snp only supports the correction of 5 0 bisulfite conversion failure. because bs-seq experiments are widely used and the resulting data will continue to grow exponentially in the near future, there is a strong need for a dedicated qc tool to assess and improve the quality of bs-seq experiments. bseqc, the tool we developed, is focused on the technical biases specific to bs-seq experiments. bseqc can automatically evaluate and remove the biases based on a user defined statistical cutoff. evaluation based on real bs-seq data indicates that, after bias removal, the quantification of methylation level is significantly improved.we demonstrated the capabilities of bseqc using two publicly available datasets: (i) paired-end wgbs from mouse es-derived neuronal progenitor cells (mnpc) , and (ii) single-end wgbs from h1 human es cells . after reads mapping using bsmap , we observed the end-repair bias in the 5 0 of ae strand (supplementary) and the 5 0 bisulfite conversion failure in the strand in the m-bias plots of paired-end mnpc data . this observation indicates that different dna strands may exhibit different technical biases in bs-seq experiments (supplementary note s1). as expected, the 5 0 bisulfite conversion failure is more obvious in non-cpg cytosine m-bias plots (supplementary). in the single-end h1 data, we used bsmap to remove adaptor and low-quality nucleotides during mapping. however, there are still biases in the 3 0 of strands of both replicates, probably indicating residual adapters and low-quality nucleotides that cannot be fully removed by conventional qc approaches (supplementary). in addition, we observed different biases in different read length in h1 data (supplementary). because there is no ground truth for methylation estimation, we decided to use the concordance between two replicates to evaluate the performance of bseqc bias trimming. as expected, the agreement of methylation level distributions between two read mates derived from the same paired-end mnpc data is significantly increased after bseqc trimming, especially in high methylation levels . the kullbackleibler distance, a measurement of difference between two probability distributions , decreases from 0.207 to 0.129 after bseqc trimming. similar improvement can also be observed in single-end h1 data (supplementary), rrbs data (supplementary) and mouse npc data (supplementary). together, we conclude that the usage of bseqc can significantly improve the methylation estimation.  
