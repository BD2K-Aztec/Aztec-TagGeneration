gene expression siber: systematic identification of bimodally expressed genes using rnaseq data motivation: identification of bimodally expressed genes is an important task, as genes with bimodal expression play important roles in cell differentiation, signalling and disease progression. several useful algorithms have been developed to identify bimodal genes from microarray data. currently, no method can deal with data from next-generation sequencing, which is emerging as a replacement technology for microarrays. results: we present siber (systematic identification of bimodally expressed genes using rnaseq data) for effectively identifying bimodally expressed genes from next-generation rnaseq data. we evaluate several candidate methods for modelling rnaseq count data and compare their performance in identifying bimodal genes through both simulation and real data analysis. we show that the lognormal mixture model performs best in terms of power and robustness under various scenarios. we also compare our method with alternative approaches, including profile analysis using clustering and kurtosis (pack) and cancer outlier profile analysis (copa). our method is robust, powerful, invariant to shifting and scaling, has no blind spots and has a sample-size-free interpretation. availability: the r package siber is available at the websitegene expression at the messenger rna level frequently operates in two modes: baseline and underexpression or overexpression. although the underlying mechanisms driving these two modes of expression (bimodal expression hereafter) may be different, [e.g. cis/trans regulation, dna copy number change, microrna regulation, dna methylation, transcription factor activity and so on (, the impact of bimodal expression is critical to cell functioning. for instance, tissue-specific expression for certain genes is needed for cell differentiation; the maintenance and regulation of bimodal expression is essential to cell signalling; the change of expression mode, especially for oncogenes and tumour suppressors, can lead to uncontrolled cell proliferation and malignant cancer. because of its importance, systematic identification of bimodally expressed genes has received great attention, especially in cancer research. various methods have been proposed during the past decade. current methods can be put into two categories: non-parametric and normal mixture models. for example, cancer outlier profile analysis (copa) is a nonparametric method to search explicitly for genes with outlier expression patterns . specifically, the expression of each gene is standardized by its median and scaled with its median absolute deviation, and then ranked by a pre-specified quantile (i.e. 75, 90 or 95) of the transformed data. they applied copa to 132 datasets studying a variety of cancers and discovered that the fusion of erg and etv1 was overexpressed in 57 of prostate cancer patients . methods in the second category postulate a mixture of normal distributions for gene expression levels. for example, the profile analysis using clustering and kurtosis (pack) proposed byfirst filters unimodal genes with bic and then ranks bimodal genes using negative kurtosis. ranking with positive kurtosis is also possible but could be dominated by outliers. this method was later applied to identify bimodally expressed genes with expression status linked to breast cancer prognosis . another method, proposed by, is based on the likelihood ratio test (lrt) and uses a 2 distribution with six degrees of freedom as the null distribution to obtain p-values of lrt statistics. this method was applied to identify bimodal genes from diverse tissue types in mouse. more recently,proposed a new definition of a bimodality index (bi). this method calculates the bi for each gene from the estimated parameters of a two-component normal mixture model and then ranks the genes by bi. one attractive feature of this method is that bi has an intuitive interpretation, as it is derived from a sample size calculation. the bi method was later applied to show that melanoma antigen family a defined a subset of triple negative breast cancers that might benefit from immune augmentation . despite their success, all of these methods (with the exception of copa) are designed for microarray data under the assumption of normal distributions. with next-generation sequencing (ngs) emerging as a replacement technology for microarrays, to whom correspondence should be addressed. it is important to develop valid methods for identifying bimodally expressed genes from ngs data. rnaseq data, unlike microarray data, consists of read counts mapped to each gene. in practice, some investigators may treat the rnaseq data the same as microarray data after some transformation (e.g. log or boxcox), but the validity of such an approach has never been investigated. special attention may be required because of the discrete nature of rnaseq data. current methods for analysing rnaseq data for differential expression rely on generalized poisson or negative binomial distributions rather than normal distributions. in this article, we propose a class of generalized bimodality indices in the framework of mixture models, including mixtures of negative binomial, generalized poisson or log normal distributions. we also formally investigate the performance of navenave methods using copa and pack, which treat rnaseq data as equivalent to microarray data after some transformation. the remainder of this article is organized as follows: in section 2, we describe several discrete models for dealing with rnaseq data and define the generalized bi that can be used for various mixture modelling. we also discuss rnaseq library normalization in the context of mixture modelling. we present simulation results in section 3.1, where three different models are evaluated and compared with alternative approaches, including copa and pack. in section 3.2, we analyse data from the cancer genome atlas (tcga) that further confirms the effectiveness of the generalized bi in identifying bimodal genes from rnaseq data.in this article, we have proposed and compared three mixture models for systematic identification of bimodally expressed genes. all models are designed to deal explicitly with the discrete nature of rnaseq data. our method follows the ideas inby first modelling the data through a twocomponent mixture coupled with computing the bi from the mixture fit that prioritizes bimodally expressed genes, which have a large distance between the two modes and sufficient samples in each mode. we extended the previous definition of bi, so that it can be applied to a mixture of unequal variance and mixture of discrete distributions. our definition of bi was motivated by sample size calculations. the resulting formula is intuitive and easily interpretable: bi rewards balanced allocation of the samples into two components (as it is largest when 0:5) and large distance between the two modes as defined by. the derivation through sample size calculations paved the road for computing bi under other mixture distributions or a mixture with unequal variance. here, we proved that the generalized bi applies to mixture of discrete distributions, such as negative binomial and generalized poisson. in such cases, the bi formula is an approximation to the exact formula, which does not have a closed form. our simulation shows there is only minimum power loss in this approximation. for other mixtures, such as a mixture of t-distributions, the bi formula still applies. it is also possible to derive a nonparametric version of bi as done in . in all cases, the resulting bi formula is invariant under shifting and scaling, which is an appealing feature. among the three models proposed, the ln model performs best in both simulation and real data analysis. under the correctly specified model, all three models perform similarly. however, both the nb and gp models are highly sensitive to model misspecification. in comparison, the ln model is robust. our analysis of brca rnaseq data further demonstrated the superior performance of the ln model. applying the method of boxcox showed that a log transformation is optimal for the majority of genes. for manually curated unimodal genes, the optimal transformation was always log transformation. in terms of recovering unimodal and bimodal genes that had been manually selected based on available microarray data, the ln model provided much better performance (auc: 0.964 versus 0.686 and 0.666). at first, it may be a little surprising that such a simple transformation performs so well. in practice, however, all microarray data are already log transformed before any formal analysis. inherently, this might be because of the nature of mrna abundance level in the cell. it remains an open question whether the lognormal model also performs well in other tasks such as differential expression analysis for rnaseq data. comparisons with date of methods for differential expression in rnaseq have focused on the negative binomial and generalized poisson models . the nature of the two tasks  
