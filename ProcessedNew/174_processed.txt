a hidden ising model for chip-chip data analysis motivation: chromatin immunoprecipitation (chip) coupled with tiling microarray (chip) experiments have been used in a wide range of biological studies such as identification of transcription factor binding sites and investigation of dna methylation and histone modification. hidden markov models are widely used to model the spatial dependency of chip-chip data. however, parameter estimation for these models is typically either heuristic or suboptimal, leading to inconsistencies in their applications. to overcome this limitation and to develop an efficient software, we propose a hidden ferromagnetic ising model for chip-chip data analysis. results: we have developed a simple, but powerful bayesian hierarchical model for chip-chip data via a hidden ising model. metropolis within gibbs sampling algorithm is used to simulate from the posterior distribution of the model parameters. the proposed model naturally incorporates the spatial dependency of the data, and can be used to analyze data with various genomic resolutions and sample sizes. we illustrate the method using three publicly available datasets and various simulated datasets, and compare it with three closely related methods, namely tilemap hmm, tilehmm and bac. we find that our method performs as well as tilemap hmm and bac for the high-resolution data from affymetrix platform, but significantly outperforms the other three methods for the low-resolution data from agilent platform. compared with the bac method which also involves mcmc simulations, our method is computationally much more efficient. availability: a software called ichip is freely available atidentification of the sites of interactions between proteins and genomic dna is one of the most important topics in biological research. the emergence of high-density tiling microarrays has made it possible to create high-resolution global maps of the in vivo interactions between specific proteins and genomes. tiling arrays use millions of short oligonucleotide probes with various resolutions to interrogate genomic regions of interest. chromatin immunoprecipitation (chip)-chip analysis has become a powerful technique used to determine the binding sites of dna-binding to whom correspondence should be addressed.proteins at a genome-wide basis . it is a challenge to analyze chip-chip data, due to the huge amount of probes, the small number of replicates and various noises introduced in the experiments. the most important feature of chipchip data is the neighboring dependency of the probe intensities. quite a few of existing methods in the literature make efforts to incorporate the dependence structure of chip-chip data into various statistical models. sliding window methods may be the most straightforward ones. these methods are to test a hypothesis for each probe or region using the statistic that is built based on all the probes information within a sliding window of certain genomic distance. the test statistics used are varied. for example,used wilcoxons rank sum statistics,used the moving average of classical t-statistics, ji andused the moving average of empirical bayesian t-statistics andused the moving average of log2 ratios. since a huge number of tests are performed and the test statistics are not independent, these approaches leave with a difficult problem for multiple hypothesis testing adjustment. two significant variants of the sliding window methods are the joint binding deconvolution (jbd;) and the model-based deconvolution (with the software medichi) , which fit a local regression for each probe with the nearby probes within a sliding window used as explanatory variables, and the inference is made based on the fitted regression coefficients. hidden markov models (hmms;) are appealing approaches to model the dependency of chip-chip data. however, in most of the existing implementations of hmm methods, parameter estimation for the models is typically either ad hoc or suboptimal for chip-chip data. for example,estimated the model parameters using the results from a previous affymetrix snp array experiments.estimated the model parameters using the baumwelch algorithm .used the baumwelch algorithm plus viterbi training to estimate the model parameters. the major limitation of these algorithms, as pointed out by, is that the baumwelch algorithm tends to converge to a local maximum of the likelihood function and the viterbi training algorithm even fails to converge to a local maximum of the likelihood in some cases. therefore, the parameter estimates and followed inference are often suboptimal to the problem. markov random fields is a natural generation of markov processes in which a space index is used to replace the time index. markov random field models are appealing alternative approaches for chip-chip data because the spacial dependency can be naturally modeled.page: 778 777783in this article, we have presented a simple, but powerful bayesian hierarchical method to model chip-chip data through a hidden ferromagnetic ising model. this approach naturally takes into account the intrinsic dependency of chip-chip data, and can be used to analyze data with various genomic resolutions and sample sizes. we comparatively evaluated our method and three closely related methods using three real and various simulated datasets. the results showed that our method performed as well as tilemap hmm and bac in terms of sensitivity and specificity in detecting ipenriched regions for the high-resolution data. however, our method significantly outperformed the alternatives for the low-resolution data. the results showed that tilehmm did not work consistently. it essentially failed for the p53, nanog and oct4 data because it was not able to distinguish enriched and non-enriched probes (see, 3 and). the regions detected by tilehmm are obviously dominated by false positives. however, it worked as well as the three alternative methods on the simulated highresolution data (, c and e). for the simulated low-resolution data, tilehmm had extremely high false positive rates at various posterior probability cutoffs (, d and f). since all the four methods essentially make efforts to estimate the state (enriched or non-enriched) of each probe, ideally it is expected that probelevel posterior probabilities should be dichotomized, either close to 1 (for the enriched state) or 0 (for the non-enriched state), which can be used as a criterion for evaluating the performance of these methods. in terms of dichotomization, our method performed the best, followed by tilemap hmm and bac, and tilehmm performed the worst. the three alternative methods used for comparison in this article are closely related to the ising model we use. the markov model is essentially a 1d ising model (for details see). vice versa, the model we proposed can also be treated as a hmm in which the transition matrix is determined by the interaction parameter , and the emission probabilities are determined by the equation (9). in addition, the gaussian intrinsic auto-regression model used bycan also be viewed as a continuous extension of the ising model. since all the four methods basically use the same idea to model chip-chip data, why does our method outperform the others for the low-resolution data? this could be owed to the way we model the data and the algorithm used for parameter estimation. in our method, metropolis within gibbs sampling algorithm is used to estimate the model parameters, which is known to converge to their target distributions when the number of iterations becomes large.  
