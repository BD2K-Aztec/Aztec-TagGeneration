dudes: a top-down taxonomic profiler for metagenomics motivation: species identification and quantification are common tasks in metagenomics and pathogen detection studies. the most recent techniques are built on mapping the sequenced reads against a reference database (e.g. whole genomes, marker genes, proteins) followed by application dependent analysis steps. although these methods have been proven to be useful in many scenarios, there is still room for improvement in species and strain level detection, mainly for low abundant organisms. results: we propose a new method: dudes, a reference-based taxonomic profiler that introduces a novel top-down approach to analyze metagenomic next-generation sequencing (ngs) samples. rather than predicting an organism presence in the sample based only on relative abundances, dudes first identifies possible candidates by comparing the strength of the read mapping in each node of the taxonomic tree in an iterative manner. instead of using the lowest common ancestor we propose a new approach: the deepest uncommon descendent. we showed in experiments that dudes works for single and multiple organisms and can identify low abundant taxonomic groups with high precision.the fast increase of complete genome sequences available on public databases has allowed better predictions of the microbial content from sequenced environmental and clinical samples. in addition, the fast evolution and decreasing costs of high-throughput sequencing as well as the development of fast and precise bioinformatics tools to handle huge amounts of data (e.g. read mappers, assemblers) are enabling the integration of automated computational methods in clinical practice . taxonomic or community profiling are common terms to define the process of identification of organisms and their quantification given a targeted or whole shotgun metagenomic sequencing . characterizing the taxonomic diversity is an initial and fundamental step to understand complex biological processes, diversity and functions of a microbial community and it can be applied for pathogen detection studies. several tools have been recently developed for this characterization, with different approaches and applications . considering only the reference-based methods, that is, methods that use reference sequences to guide their analysis and classify sequences in the sample, community profiling is categorized in two sub-groups: composition and similarity-based. composition-based methods extract information from the composition of sequences from both sample and database (e.g. gc content, codon usage) and search for similarities between reads and references. similarity or homology-based techniques are built on mapping or aligning the sequenced reads against reference databases and performing further analysis. despite significant performance improvements in the last years, similarity analysis is still computationally challenging due to the extremely high throughput v c the author 2016. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.com of modern sequencing machines and the accelerated growth of available genomic sequences . some tools address this problem by reducing the database space, selecting only marker genes or a specific subset of sequences . this simplification can speed up analysis but at the same time reduces the complexity and diversification of the references, decreasing precision for more specific identifications. other methods use custom databases of partial or whole genome sequences . additionally, very efficient k-mer based read binning tools can also be used in some extension for profiling communities, by selecting the targets with more associated sequences. despite the remarkable recent advances in this area and a vast number of tools available, there is still a number of challenges from sequencing methods to bioinformatics tools to integrate computational and automated approaches into molecular and metagenomics diagnostics . specifically for community profiling, there is still room for improvement in species and strain level detection, which can have very similar genomic content and at the same time low abundances. the high discordant number of available sequenced genome sequences among several taxonomic groups (tgs) poses another common problem, where some organisms (e.g. pathogens, model organisms) are more studied and therefore overrepresented in the public sequence databases. aiming to solve those limitations, we propose a new method: dudes, a reference-based taxonomic profiler, which introduces a novel top-down approach to analyze metagenomics ngs samples. rather than predicting an organism presence in the sample based only on relative abundances, dudes first identifies possible candidates by comparing the strength of the read mapping in each node of the taxonomic tree in an iterative manner. instead of using the lowest common ancestor (lca) , a commonly used bottom-up approach to solve ambiguities in identifications, we propose a new approach: the deepest uncommon descendent (dud). while the lca method solves ambiguous identifications by going back in the taxonomic tree to the lca, the dud approach starts at the root node and tries to go for deeper taxonomic levels, even when ambiguities are found. that way it is possible to have less conservative identifications in higher taxonomic levels. besides, when the provided data does not allow a specific identification on higher levels, our method identifies a small set of probable candidates among dozens of possibilities (e.g. instead of stopping at species identification, dudes will provide 5 highly likely strains out of 150). permutation tests are performed to estimate p-values between tgs and to identify the presence of them on each level. we show in experiments and comparisons with state-of-the-art tools that dudes works well for single and multiple organism detection, can handle unequally represented references in the database and identifies low abundant tgs with high precision. dudes is open source and it is available at http://sf.net/p/dudeswe described here a new method for profiling metagenomics samples with a completely new approach to explore the taxonomic tree structure. in our experiments with mock communities, dudes achieved high accuracy even in lower taxonomic levels. in an extreme scenario, using only 1 of the data with very few reads for some organisms, dudes was the best tool overcoming gottcha and metaphlan2. surprisingly, kraken, a read binning tool, had an excellent performance in this set, but with the disadvantage of a high number of false positives, as expected in this sort of application. dudes achieved two times fewer false positives than kraken with the best auc and sensitivity value among all tested tools in the hmp experiment. with 10 of the dataset, dudes performed as well as with the full set of reads, showing that it can be very precise and stable with small sample sizes. in a broader synthetic community set with more than 100 million reads, dudes performed equally well even with high organism diversity. from those results we see two main advantages of our tool: first, the method can be applied to profile datasets with low abundant organisms, identifying tgs with very few matches. second, selecting only part of the dataset poses as a good approach to reduce sample size, allowing faster analysis. smaller samples and the application of digital normalization generated good results in the hmp datasets without information loss (supplementary). this strategy can be useful with the increasing amount of data generated by ngs technologies, decreasing mapping and execution time as well as memory usage. in the meantime, a thorough analysis is necessary to better estimate the effects of such techniques. digital normalization can skew abundancesknown pathogens were discovered from conventional microbiology and computational metagenomics analysis . all samples were generated with a single illumina miseq run (2 151 paired-end sequencing). downwards and should be carefully used when there is no ground truth available. dudes also performed well when applied to outbreak samples for pathogen detection. our methods results corroborated previous findings and could be used as a fast alternative or confirmation tool to the pathogen detection problem. dudes can also be a fine-tuning tool for posterior analysis of lca-based methods identifications when they cannot achieve high taxonomic levels. the candidate selection approach used in dudes is not unique to dud method and it could also be applied in lca tools. however dudes provides this functionality out-of-the-box. in addition the choice is not based only in a presence of a certain taxon (given by counting read matches) but also based on a comparison against the other taxons of the same taxonomic level, giving more significance to the candidate selection. by transforming the information from read mapping to bins of the same size, and subsequently selecting the same number of bins for comparisons we could ameliorate the fact that tgs are not evenly represented in the database. this technique provides a fair comparison among tgs regardless of their number of reference sequences. the dud method implemented in dudes provides a new way to analyze the taxonomic tree structure. we see several advantages in this method: first it provides a reliable way to identify the presence of tgs, making a comparison on each taxonomic level. it also can solve ambiguities in a less conservative manner, first by allowing concurrent identifications and second by selecting a set of candidates when a specific identification is not possible. in comparison with lca-based tools we can point out some methodological differences: kraken, like many lca-based methods, applies lca on a sequence level and set the presence of tgs after all sequences were classified in the lca system. dudes uses the taxonomic information to guide the analysis and it does not use the dud algorithm directly on a sequence level but on a taxonomic group level. it is important to notice that those two methods have opposite approaches and at the same time have been applied in a different way. dudes implementation of the dud method relies on permutations tests among bin scores of nodes of the tree with correction for multiple testing. that introduces statistical significance to our comparisons and decisions with a rigid control of type i errors values to avoid false identifications. dudes is a flexible tool that does not rely on a specific or custom-built databases or read mappers and it can run using any set of reference sequences (e.g. draft genomes, marker genes, proteins) not only whole genomes sequences as here presented. the creation of any other custom database is straightforward with dudesdb. our tool also provides a possibility to analyze sub-trees from the taxonomic tree structure by setting a start node and a final taxonomic level desired, giving a guided and fast identification. in conclusion, dudes propose a novel approach to the taxonomic profiling problem, with a top-down technique to analyze taxonomic tree structures. the dud can be less conservative than current methods for solving ambiguities in the identifications, and showed superior performance in our experiments compared with recent tools, being very precise at low coverages. additionally the tool provides a strain identification method that can propose one or more strains presents in a sample. we believe that dudes can be useful for several applications, from complete metagenomics profiling to pathogen detection studies.  
