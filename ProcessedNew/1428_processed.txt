dissco: direct imputation of summary statistics allowing covariates downloaded from background: imputation of individual level genotypes at untyped markers using an external reference panel of genotyped or sequenced individuals has become standard practice in genetic association studies. direct imputation of summary statistics can also be valuable, for example in meta-analyses where individual level genotype data are not available. two methods (dist and impg-summary/ld), that assume a multivariate gaussian distribution for the association summary statistics, have been proposed for imputing association summary statistics. however, both methods assume that the correlations between association summary statistics are the same as the correlations between the corresponding genotypes. this assumption can be violated in the presence of confounding covariates. methods: we analytically show that in the absence of covariates, correlation among association summary statistics is indeed the same as that among the corresponding genotypes, thus serving as a theoretical justification for the recently proposed methods. we continue to prove that in the presence of covariates, correlation among association summary statistics becomes the partial correlation of the corresponding genotypes controlling for covariates. we therefore develop direct im-putation of summary statistics allowing covariates (dissco). results: we consider two real-life scenarios where the correlation and partial correlation likely make practical difference: (i) association studies in admixed populations; (ii) association studies in presence of other confounding covariate(s). application of dissco to real datasets under both scenarios shows at least comparable, if not better, performance compared with existing correlation based methods, particularly for lower frequency variants. for example, dissco can reduce the absolute deviation from the truth by 3.915.2 for variants with minor allele frequency 5.recent large international efforts, including the international hapmap project and the 1000 genomes project , have provided comprehensive catalogs of genetic variants and linkage disequilibrium (ld) patterns in various populations around the world. using these publicly available data as reference panels, imputation of individual genotypes at untyped variants has facilitated recent genome-wide association studies (gwas) and meta-analysis . therefore, when individual level genotype data are available in study samples, it has become a standard practice to perform genotype imputation . unfortunately, individual level genotype data are not always available, particularly in multisite meta-analysis gwass that can include many individual study gwass. the process of gathering proper institutional human subjects research approval, including formal data-sharing agreements, can be very time consuming. association summary statistics, on the other hand, are routinely available and are not subject to the same human subjects research bottlenecks. two methods have been proposed recently to directly impute association summary statistics at untyped markers in the absence of individual level genotypes . both methods assume the summary statistics across typed and untyped markers follow a multivariate gaussian distribution. gaussian models have been routinely used in other related genetic applications . for both imputation methods using association summary statistics, the correlation structure between the summary statistics is estimated based on the ld structure between the corresponding markers in an external reference panel(s). both methods assume that the correlations between the association summary statistics are the same as the correlations between the genotypes at the corresponding markers. in this study, we provide a general analytical proof that in the absence of confounding covariates, estimating the covariance structure between summary statistics using marker ld information between the corresponding markers is reasonable. however, in practice, confounding covariates are often present. in particular, we consider two scenarios: association studies including genetically admixed individuals (scenario i) and association studies in the presence of general confounders (scenario ii). in scenario i, the underlying ld between markers among participants in the usually cosmopolitan reference panel, obtained from the public domain likely differs from the corresponding ld among subjects in the study sample. in scenario ii, we consider the presence of general confounder covariates or mediators, such as socialeconomic factors, environmental factors, etc., which are inevitable in real association studies; for example, the adjustment of body mass index (bmi) for association with risk with diabetes , smoking with lung cancer , duffy dose for white blood cell count (wbc) , just to name a few. for scenario i, we propose to use the top principal components (pcs) to adjust the correlation estimates. for scenario ii, we develop a unified framework for dissco to deal with general confounders and mediators.two recent studies have proposed methods for direct imputation of summary statistics that approach the quality of gold standard genotype-based imputation, at reduced computational costs. these methods are valuable particularly for meta-analysis studies when individual level genotypes are not readily available. both methods assume summary association statistics follow multivariate gaussian distributions, with the correlations between the summary statistics being the same as the correlations between the corresponding marker genotypes that are estimated from publicly available reference panels. in this study, we show analytically that, in the presence of confounders, the correlation matrix among the summary statistics is the partial correlation matrix among the corresponding markers, conditional on the confounders. with this theoretical underpinning, we propose dissco for direct imputation of summary statistics accommodating confounding covariates. we consider two scenarios where covariate adjustment can be helpful, if not necessary: in the study of admixed samples and in the presence of other known risk factors and mediators. the first scenario presents the challenge of estimating the correlation matrix appropriate for admixed samples using cosmopolitan reference panels commonly available in the public domain rather than a single wellmatched reference dataset. our solution of using pcs can be interpreted as sample-adjusted weighting of the reference individuals for the estimation of the correlation structure. our pc-based solution in this scenario of admixed samples also effectively transforms the issue into the need of controlling for the special covariates: pcs, thus enabling the unified dissco framework under both scenarios. for practical usage, scenario i entails the estimation of pcs for the reference individuals, which can be achieved either by performing pc analysis on the study and reference samples together, which is commonly conducted in studies involving admixed samples; or when pca is performed on study samples only, one could choose to project the top pcs in the same manner as general covariates (results presented in supplementary material s7). dissco leads to more noticeable gains for lower frequency variants. we believe this is largely due to the smaller number of ld tags (variants in high ld) for lower frequency variants compared with that for more common variants. for example, based on the 1000 genomes phase 1 datasets, we found on average 9.8 (7.6, 5.9) ld tags (at ld r2 threshold of 0.8) for low frequency variants (maf 5) and 23.2 (24.4, 8.9) ld tags on average for common variants (maf 5) among individuals with european (asian, african) ancestry. since not every marker is affected by confounding covariates when estimating partial correlations, with more ld tags, a common variant is less susceptible to the inaccurate estimation of. clhns dataset: accommodating general covariates. scatter plots comparing true z statistics to the corresponding imputed z statistics from dissco and three competing methods for markers passing post imputation quality filteringbest performing methods are highlighted as bold. the estimated accuracy of association summary statistics is compared across different methods using three metrics: d, d and r 2. smaller d, smaller d and larger r 2 reflect better estimation. the values in parentheses are the relative improvements of dissco over dist/impg-summary/impg-summaryld. partial correlation for a subset of its ld tags than is a low frequency variant. in supplementary material s8, we use simulations to illustrate that the performance of methods based on either the partial or marginal correlation increases with the number of ld tags and, more importantly, that additional information from covariates leads to relatively more gains when the number of ld tags is smaller. computationally, following impg-summary/ld, dissco also divides each chromosome into non-overlapping blocks with predetermined length (1 mb by default). assume there are p p t p ut markers, including p t typed and p ut untyped markers, n study individuals in the study sample, n refer individuals in reference sample, and s covariates. after obtaining z t , z statistics at typed markers, imputation of summary statistics involves some of the following steps (i) calculation of the reference correlation matrix r unadj, (ii) calculation of the sample correlation matrix between typed markers, (iii) generation of reference sample pseudo-covariates, (iv) calculation of reference sample partial correlations and (v) actual imputation via the following formula:where the subscript . differs across methods as detailed in section 2, and (vi) the normalization of imputed values. all methods need step (v). dist also needs (i); impg-summary also needs (i) and (vi); impg-summaryld also needs (i), (ii) and (iv); and dissco also needs (i), (iii) and (iv). computational complexity of (i)(vi) is, respectively (detailed in supplementary material s9). we report inthe computing time for each of the steps in the real data sets on a 2.53 ghz intel(r) xeon(r) processor. real-time using actual software implementation is also reported. the dist software takes the longest mainly for two reasons: (i) it re-calculates the reference correlation matrix within a window of 650 markers for every untyped marker; and (ii) it uses numerical integration to calculate p-values from z-scores. in contrast, impgsummary has an efficient implementation, at the cost heavy i/o burden: thousands of small intermediate files written to and read from hard disk. memory consumption was comparable across the different software, with 12 gb maximum ram for all the real data experiments. there are multiple other factors that affect performance. among them, the important ones are (i) window size, (ii) regularization and (iii) normalization. specifically, a larger window size tends to improve performance by providing more information. however, a larger window size also means increased computational cost. including a larger number of typed markers does not guarantee better results because the larger number of markers is more likely to make the correlation matrix singular. as noted by the impgsummary/ld development team, regularization alleviates this issue by adjusting for statistical noise in the estimation of the covariance matrix in the reference sample. following their work, dissco also uses 1 mb as default window size with regularization. the normalization procedure in impg-summary/ld improves performance in small samples. since our focus in this article is on the improvement of using partial-correlations instead of marginal correlations, we compare our method to existing methods using the default parameter values. we have primarily focused our performance comparisons between dissco and existing methods by comparing accuracies of summary z statistics to their true values. since dissco directly imputes association statistics, it is also critical to establish its validity. following, we generated real-data-based null datasets and found that dissco maintains the desired type-i error rate across a range of nominal values (10-110-5) with our default level of regularization (k 0.03) (supplementary materials s10 and tables s5ad).the corresponding method. software row reports the actual time by directly using dist (v0.1.4), impg-summary (v1.0) and dissco (v1.0) software implementation. na in the impgsummaryld column is because it does not allow missing values in the sample genotypes.unlike imputation for individual genotypes, the selection of a reference panel matching the study sample is much more crucial for the accurate imputation of association summary statistics because the correlation structure from the reference sample as a whole instead of individual haplotypes are used in the calculations. although, when the reference and study samples are similar, these methods for direct imputation of association statistics tend to work well , prudency is warranted as discussed in. as an illustration, our simulation studies using a mismatched reference panel (the eur haplotypes from the 1000 genomes project for the clhns dataset) resulted in inflated type-i error rates when using our default level of regularization (supplementary). finally, a key step in dissco is the projection of covariates into the reference based on genotypes of typed markers. as top pcs capture a large amount the variation in these genotypes, it is conceptually natural to anticipate that projection based on the top pcs (thus completely bypassing the need of individual level genotypes) might achieve similar performance gains. we indeed have observed comparable performance gains using the top pcs as compared with using general covariates in the admixed dataset. additional analysis in the clhns dataset using only the top five pcs also showed near identical results as in(identical up to the third digit after the decimal point using all three measures, i.e. d, d and r 2 ). although a certain degree of information loss is possible due to discarding information not captured by the top pcs, we recommend using the top pcs as a convenient substitute for actual covariate projection when individual level genotypes are not available. in summary, we provide analytical justifications for two methods recently proposed for the imputation of association summary statistics in the absence of confounding covariates. we further extend the analytical work in the presence of confounders and propose a method accordingly to accommodate confounding covariates. our proof-of-concept simulations and applications to two real datasets demonstrate the value of our method, dissco, particularly for lowfrequency variants. our method is implemented in java and freely available online http://www.unc.edu/$yunmli/dissco/.  
