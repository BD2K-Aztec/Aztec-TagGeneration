systems biology msprep—summarization, normalization and diagnostics for processing of mass spectrometry–based metabolomic data motivation: although r packages exist for the pre-processing of metabolomic data, they currently do not incorporate additional analysis steps of summarization, filtering and normalization of aligned data. we developed the msprep r package to complement other packages by providing these additional steps, implementing a selection of popular normalization algorithms and generating diagnostics to help guide investigators in their analyses. availability: http://www.sourceforge.net/projects/msprepthe primary goal of the msprep package is to prepare metabolomics data for advanced statistical analysis by automating the processing of datasets and generating diagnostic graphs. the initial processing of liquid chromatography coupled with mass spectrometry (lcms) data is covered by a variety of software packages provided by instrument manufacturers and a number of open source packages such as xmsanalyzer , xcms and mzmine . while these manage the initial data pre-processing steps of peak detection, chromatogram building, alignment and quantification, they often lack functions for further processing. we designed the msprep package to complement existing software by providing additional processing tools and statistical and graphical tools for evaluation of different methods. as there are no universally accepted procedures, the package provides implementation of a variety of novel and previously published methods. the primary functions of the msprep package are summarization of replicates, filtering, imputation of missing data, normalization and/or batch effect adjustment and dataset diagnostics.an operator difference dataset was generated by the reisdorph mass spectrometry laboratory at national jewish health. three technicians performed all steps of sample prep for profiling of a base human plasma sample containing six spiked in control compounds at concentrations of 1x, 2x and 4x and two negative controls at 1x in all samples. pre-processing was performed in agilents mass hunter software. for summarization, the cv cutoff was set at 0.50. there were 23 compounds (0.1 of compounds) that were present in all replicates but above this cutoff. of these, all but one fit the pattern of two consistent observations and one outlier. the data were filtered at 80 present in all subjects, which resulted in 891 compounds. the bpca imputation was used to maintain a gaussian distribution and allows application and evaluation of all normalization methods. owing to the design, we expect compounds to be consistently measured between subjects with the only detected differences occurring in the six compounds that were spiked into the datasets. thus, all other differences are due to the batch/operator effect. as shown in, the sva normalization method was the most effective at controlling false-positive rate while reducing the operator effect for this dataset, based on a linear model of the log2 abundances. while the operator effect is still apparent in the pca plot of the sva adjusted data in supplementary, the lower percentages and rmse inrepresents an improvement over the other methods.the msprep package is designed to help investigators prepare their datasets for analysis, while reducing the amount of manual processing of datasets and generating useful diagnostic aids. our package complements existing pre-processing methods such as xmsanalyzer , and the output is in a format ready for input to leading software such as metaboanalyst to perform clustering and other downstream analyses. the sva routine provided the best performance when applied to the dataset presented, but it is important to note the strengths and weaknesses of each routine, and, in our experience, no single method is best in all circumstances. we encourage users to examine the diagnostic plots generated by the package to compare different methods for their datasets.  
