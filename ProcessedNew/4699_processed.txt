toppic: a software tool for top-down mass spectrometry-based proteoform identification and characterization top-down mass spectrometry enables the observation of whole complex proteoforms in biological samples and provides crucial information complementary to bottom-up mass spec-trometry. because of the complexity of top-down mass spectra and proteoforms, it is a challenging problem to efficiently interpret top-down tandem mass spectra in high-throughput proteome-level proteomics studies. we present toppic, a tool that efficiently identifies and characterizes complex proteoforms with unknown primary structure alterations, such as amino acid mutations and post-translational modifications, by searching top-down tandem mass spectra against a protein database.in the past decade, top-down mass spectrometry (ms) has rapidly developed because of the advances in protein separation and mass spectrometry techniques. it has unique advantages in identifying and characterizing proteoforms with primary structure alterations, such as amino acid mutations and post-translational modifications (ptms), because top-down tandem mass spectra cover whole proteoform sequences . although several software tools, such as prosightpc and ptop , have been developed for top-down ms data analysis, efficient interpretation of high throughput top-down ms data is still a challenging computational problem because intact proteoforms often contain unknown primary structure alterations compared with the unmodified forms in the protein database . we developed toppic (top-down mass spectrometry-based proteoform identification and characterization), a software tool for high-throughput proteome-wide proteoform identification and characterization by top-down ms, which integrates algorithms for protein filtering, spectral alignment, e-value computation and bayesian models for characterization of unknown amino acid mutations and ptms. in addition, a user friendly web browser-based interface is provided. toppic focuses on the identification and characterization of unknown primary structure alterations and the discovery of novel proteoforms. the performances of toppic with various parameter settings were evaluated on a top-down tandem mass spectrometry (ms/ms) data set of escherichia coli k-12 mg1655.toppic was tested on a data set of e. coli (ec) k-12 mg1655 with 2027 collision-induced dissociation (cid) and 2027 electrontransfer dissociation (etd) top-down ms/ms spectra, which were generated by an ltq orbitrap velos mass spectrometer using the alternating fragmentation mode. the details of the ms experiment are given in the supplementary material. the tests were performed on a desktop computer with an intel(r) core i7-3770 3.40 ghz cpu and 16 gb memory. the maximum number of allowed unknown mass shifts in a proteoform is a main parameter that determines the search space and sensitivity of toppic. we compared the performances of toppic with three settings for the parameter: 0, 1 and 2. the target-decoy approach was used to filter out low quantity matches; all other parameters were set as the default values (in the supplementary material).in the supplementary material shows an example of the web pages for the visualization of prsms. the running times were 405, 1104 and 31 930 seconds and the numbers of identified prsms with a 1 spectrum-level false discovery rate (fdr) were 875 (21.6), 1860 (45.9) and 1914 (47.2) for at most 0, 1 and 2 unknown mass shifts, respectively (supplementary tables s1s3). the 1914 prsms were mapped to 301 proteins. the maximum number and the average number of matched spectra for a protein were 102 and 6.36, respectively. when four threads in the cpu were used, the running time was 15 835 s for at most two unknown mass shifts. the maximum memory usage was about 2.5 gb. toppic achieved a balance between the speed and the number of identifications when the maximum number of unknown mass shifts was set as 1. of the 1914 identified prsms (at most two unknown mass shifts were allowed), 997 contain one unknown mass shift and 31 contain two unknown mass shifts (supplementary). the miscore method identified and localized 25 modification sites with an miscore 45 from 74 mass shifts by using four common ptms: acetylation, methylation, oxidation, and phosphorylation (supplementary). the lookup table approach is faster, but less accurate, than the extended generating function approach for computing e values of prsms. the two approaches were compared in speed and the number of identifications on the ec data set using the same parameter settings as the previous test. the maximum number of unknown mass shifts was set as 2. the running times for e value computation were 133 and 86 283 s, and the numbers of identifications (with a 1 spectrum-level fdr) were 1914 and 1955 for the lookup table approach and the generating function approach, respectively (supplementary tables s3 and s5).the multiple spectra mode of toppic is capable of combining spectral pairs in proteoform identification. we compared the sequence coverage of prsms reported by single cid and etd spectra as well as combined spectral pairs using the default parameter settings except that at most two unknown mass shifts were allowed and the target-decoy approach was used (supplementary tables s6 s8). a total of 452 spectral pairs were identified by all three approaches with a 1 spectrum-level fdr. the average peptide bond coverage percentages were 40.4, 38.1, and 63.7 for the cid only, etd only, and combined approaches, respectively. the results demonstrated that the combined approach significantly increased the sequence coverage in identified proteoforms. ms-align was employed to analyze the same data set and compared with toppic. in the two tools, the target-decoy approach was used, at most two unknown mass shifts were allowed in a prsm, and all other parameters were set as the default values (tables 1 and 2 in the supplementary material). ms-align identified 1995 prsms with a 1 spectrum-level fdr. its running time was 89 750 s (about 25 h) and its memory usage was about 11.5 gb. compared with ms-align, toppic significantly reduced the memory usage and achieved about 81.3 and 5.7 times speedup for at most 1 and 2 unknown mass shifts, respectively. when at most two unknown mass shifts were allowed, toppic identified 104 prsms missed by msalign. the main reason is that the filtering algorithms inin the supplementary material) and missed only 34 prsms identified by ms-align (in the supplementary material), all of which are not highly confident identifications.toppic focuses on identifying proteoforms with unknown primary structure alterations and characterizing unknown modifications. it includes many useful features, such as proteoform identification by combining spectral pairs or triplets generated by the alternating fragmentation mode of mass spectrometers. it is much faster and more memory efficient compared with ms-align. in addition, a web server based graphical user interface is provided. toppic is capable of identifying proteoforms with primary structure alterations, but it still has limitations in the analysis of very complex proteoforms. first, the filtering algorithms in toppic are based on finding protein segments without alterations that match to a part of the query spectrum with a large number of matched fragment masses. when a proteoform has many alterations, toppic may fail to identify it because the filtering algorithms cannot find such a segment in the target protein. second, variable ptms are not incorporated into database search for proteoform identification. a proteoform with several variable ptms, such as oxidation, may not be identified by toppic. third, a simple mass counting score is used as the scoring function in toppic. a scoring function that takes into account peak intensities can further improve the sensitivity of proteoform identification and the accuracy of modification characterization.  
