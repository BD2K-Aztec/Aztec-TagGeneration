systems biology automated analysis of time-lapse fluorescence microscopy images: from live cell images to intracellular foci motivation: complete, accurate and reproducible analysis of intracellular foci from fluorescence microscopy image sequences of live cells requires full automation of all processing steps involved: cell segmentation and tracking followed by foci segmentation and pattern analysis. integrated systems for this purpose are lacking. results: extending our previous work in cell segmentation and tracking, we developed a new system for performing fully automated analysis of fluorescent foci in single cells. the system was validated by applying it to two common tasks: intracellular foci counting (in dna damage repair experiments) and cell-phase identification based on foci pattern analysis (in dna replication experiments). experimental results show that the system performs comparably to expert human observers. thus, it may replace tedious manual analyses for the considered tasks, and enables high-content screening. availability and implementation: the described system was implemented in matlab (the mathworks, inc., usa) and compiled to run within the matlab environment. the routines together with four sample datasets are available at http://celmia.bigr.nl/. the software is planned for public release, free of charge for non-commercial use, after publication of this article.the ability to perform analyses on individual cells presents evident advantages over the traditional averaging over the whole cell population . in many studies, such analyses are mainly performed manually, which is very tedious and often lacks accuracy, completeness and reproducibility. to improve this, automated methods are essential. in this article, we present a new system for performing intracellular analysis in time-lapse fluorescence microscopy image data of cell colonies. the system consists of two main modules: cell analysis and foci analysis. the first is more generic and can be applied to a large variety of biological data acquired for cell analysis. the second is naturally a to whom correspondence should be addressed. more application-dependent step and requires specialized methods depending on the structures of interest. a number of cell segmentation and tracking algorithms have been presented in the recent literature (and the references therein;). however, very few can potentially satisfy the requirements imposed by live cell imaging and analysis at the individual cell level. specifically, a candidate algorithm should have the capability to handle 3d timelapse image datasets, it should provide full segmentation (detection only is insufficient) and tracking, be able to handle cell divisions, and show good performance even in the presence of significant noise and inhomogeneous intensity distributions (whether in the background or within cells). to this end, we use our robust level-set-based cell segmentation and tracking algorithm as a starting point. here, we present an extension of the algorithm that allows registration of each cell to a common coordinate system by applying motion correction after segmentation and tracking. this is necessary to study the true relative dynamics of intracellular processes. as for the subsequent step of intracellular analysis, we focus here on fluorescent foci, which appear in many biological studies. representing high concentrations of the corresponding fluorescently labeled protein, foci are usually the main indicator of an underlying biological process occurring at these locations . consequently, this makes foci analysis the main tool for studying protein-related processes by means of fluorescence microscopy. examples of biological research based on foci analysis include fluorescent in situ hybridization (fish) experiments , analysis of dna replication and repair , and classification of cell-cycle phases . in this article, we present a novel foci segmentation algorithm, and evaluate its robustness in segmenting foci of different size and intensity, as well as clustered foci. in addition to presenting the algorithms used in different steps, we also validate the complete system by showing its ability to reproduce findings from two biological studies that were based on expert manual analyses. in the first experiment, we investigate the time course of nuclear foci formation and disappearance upon treatment with ionizing radiation of the 53bp1 dna repair protein.the sample images inillustrate that the cell colonies were densely clustered and that some of the nuclei showed very irregular shapes (as imaged). together with the relatively low and inhomogeneous contrast, and a considerable amount of noise, this makes automated segmentation challenging. nevertheless, in all the images our system was able to yield satisfactory segmentations for subsequent foci analysis. next, automatic foci counting was performed, and the results were compared to manual counts by an expert human observer. to make a fair comparison, for each image we selected the same number of segmented cells as considered by the human expert in the manual analysis, by applying a size threshold. in total, 858 cells were selected for automatic foci counting, 685 of which contained foci and 435 were identified as positive (5 foci). two measures were calculated for each time point: the percentage of positive cells and the average number of foci per cell. the results clearly show that the automatically obtained results are in good agreement with the results obtained by manual analysis, both qualitatively and quantitatively. in particular, for both measures, the calculated general trend is virtually the same.the plots inshow the differences in the phase transition times as found by our system versus both observers for each of the four possible phase transitions. the results clearly confirm, in agreement with, that it is much easier to distinguish the g1 and g2 phases from the s phase (figs 5 and 6a, d) than to distinguish between the different subphases of the s phase (figs 5 and 6b, c). for the transitions from g1 to early-s, and from late-s to g2, the absolute differences in the times detected by our system versus any of the two observers did not exceed 3 time points, which is the same as the maximum difference found between the two observers. for the transitions from early-s and middle-s, and from middle-s to late-s, the maximum absolute difference between our system and any of the observers was 16 time points, which again is equal to the maximum difference found between the two observers. in most cases, the differences with respect to the two observers showed opposite signs (meaning that the automatically detected transition time was in between the times indicated by the observers), or one of the differences was relatively small (indicating that the automatically detected time point was close to that found by one of the observers). however, there were also several cases where our algorithm showed considerable difference with both observers, while their results were in good agreement. an important observation following from these cases is that the results were much better (closer to those of the observers) for sequences where more transitions (ideally all four) were present. and vise versa, for sequences where only two or three out of four transitions were present, our algorithm encountered difficulties in correctly detecting the time moments of those transitions.of a single, motion-corrected cell nucleus, going from the g1 phase, through the early-s, middle-s, late-s, to the g2 phase (indicated by bars in different shades of gray below the images), as automatically recognized by our system based on characteristic foci patterns for each of these phases. the example also illustrates the observation that it is easier (also visually) to distinguish the g phases from the s phases than to distinguish between the different s phases.the four plots correspond to the four possible phase transitions: (a) g1 to early-s (21 cases); (b) early-s to middle-s (29 cases); (c) middle-s to late-s (26 cases); and (d) late-s to g2 (22 cases). in each case, the difference in detection times between the automated method and each of the two observers is plotted. a missing point on one of the curves in (c) means that the corresponding phase transition was not detected by the corresponding observer.  
