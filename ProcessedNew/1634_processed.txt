estimating the number and assignment of clock models in analyses of multigene datasets motivation: molecular-clock methods can be used to estimate evolutionary rates and timescales from dna sequence data. however, different genes can display different patterns of rate variation across lineages, calling for the employment of multiple clock models. selecting the optimal clock-partitioning scheme for a multigene dataset can be computationally demanding, but clustering methods provide a feasible alternative. we investigated the performance of different clustering methods using data from chloroplast genomes and data generated by simulation. results: our results show that mixture models provide a useful alternative to traditional partitioning algorithms. we found only a small number of distinct patterns of among-lineage rate variation among chloroplast genes, which were consistent across taxonomic scales. this suggests that the evolution of chloroplast genes has been governed by a small number of genomic pacemakers. our study also demonstrates that clustering methods provide an efficient means of identifying clock-partitioning schemes for genome-scale datasets. availability and implementation: the code and data sets used in this study are available online at https://github.com/sebastianduchene/pacemaker_clustering_methods.evolutionary rates and timescales can be estimated from nucleotide sequences using molecular-clock models, which describe the pattern of rate variation among lineages. the various clock models share a reliance on age calibrations, but they differ in their assumptions about the number and distribution of distinct evolutionary rates (reviewed by). for example, the strict molecular clock assumes a single rate across all lineages , whereas uncorrelated relaxed clocks allow branches to have distinct rates that are drawn from the same distribution . there are various model-selection methods for identifying the best-fitting clock model for a dataset of interest (e.g. using marginal likelihoods;). the choice of clock model can have substantial impacts on phylogenetic estimates, particularly those of evolutionary rates and timescales. rates of molecular evolution often vary among lineages, but this pattern of variation can differ across sites and across genes . therefore, when complex sequence data are being analyzed, the use of multiple clock models might provide a better fit (e.g. higher marginal likelihood) than a single clock model. for example, separate clock models might be applied to different genes or codon positions. in analyses of multigene datasets, there are usually many possible partitioning schemes. identifying the best-fitting schemes involves two components: determining the optimal number of clusters, and assigning the genes to these clusters. in bayesian analyses, this can be done using bayes factors to compare different clock-partitioning schemes . however, such an approach is impractical when there are many candidate schemes, as is often the case for multigene or genome-scale datasets, because the statistical fit of every possible scheme would need to be assessed.clustering methods provide a computationally feasible means of identifying appropriate clock-partitioning schemes, by grouping subsets of the data according to their pattern of among-lineage rate variation . similar approaches are available for selecting partitioning schemes for substitution models . the software clockstar, which was designed to identify the best-fitting clock-partitioning scheme for multigene datasets , employs a k-medoids clustering algorithm known as partitioning around medoids . however, other clustering methods, such as k-means and gaussian mixture modeling, have not been tested in the context of clock-model selection. one advantage of gaussian mixture models is that they can represent the shapes of clusters flexibly by using covariance matrices. for example, they can use a diagonal covariance matrix to identify clusters with ellipsoidal shapes, such that they might have higher accuracy than k-medoids. here we test the performance of three different clustering methods for identifying the clusters of patterns of among-lineage rate variation in multigene datasets: variational inference gaussian mixture model (vbgmm), dirichlet process gaussian mixture model (dpgmm), and partitioning around medoids (pam). we evaluate these three methods using simulated data and apply them to chloroplast genome sequences from angiosperms. we find that the optimal number of clusters for these datasets range from one to three. our results also reveal that mixture models, such as vbgmm and dpgmm, tend to detect a larger number of clusters than methods based on partitioning, such as pam. mixture models also appear to be more robust than pam in that they can detect the correct number of clusters in a broader range of simulation conditions.in our analyses of five chloroplast datasets, the vbgmm with a spherical covariance matrix had higher fit than the other mixture models . using this method, the optimal number of clusters ranged from one to three across the five datasets (; supplementary). the pam algorithm inferred one cluster for poaceae, rosids, and eudicots, and two clusters for asteraceae and angiosperms. although the number of clusters inferred by all of the methods was similar, vbgmm with a spherical covariance matrix tended to infer the largest number of clusters. the exception was the angiosperm dataset, for which vbgmm with a spherical covariance matrix only identified one cluster, whereas the other methods identified two clusters. importantly, for all datasets there were at least some discrepancies in the number of clusters inferred by the methods. the pam algorithm inferred the smallest number of clusters for almost all of the datasets. our analyses of data simulated under mixture models showed that the algorithms with mixture models correctly identified the model used to generate the data and the number of clusters for a majority of the simulations . in all cases, the vbgmm with a spherical covariance matrix presented the highest statistical fit for all 100 simulations. for the chloroplast data from angiosperms, poaceae and eudicots, the estimated value of k matched the true value in all 100 simulation replicates. for rosids, the correct value of k was recovered for 97 of the simulated datasets. the mixture model fitted to the asteraceae dataset performed the most poorly. in this case, the correct value of k was recovered for only 69 of the simulated datasets. the fact that the frequency of the optimal k is overall high for the mixture model also indicates that it is stable, yielding similar estimates for data simulated under the same conditions. for the simulations based on mixture models, the pam algorithm performed more poorly . it only recovered the true value of k for the simulations using the model fitted to the angiosperms. for the other simulations, it tended to estimate a larger number of clusters, from five in the simulations using the model fitted to poaceae to eight for the simulations under the model fitted to the rosids. the stability of this algorithm was also much lower than that of the mixture models for most datasets. for example, for the asteraceae data, the most frequent value of k was present in 20 of the 100 simulated datasets, with many different values of k being inferred for the remaining 80 simulated datasets. this probably occurred because this dataset contains a small number of points, such that there is greater variation among simulation replicates. the simulations using the model fitted to the angiosperm data had more stable results, with a frequency of 1.00 for k 1. in our analyses of data simulated under conditions consistent with the assumptions of the pam algorithm, we found that both mixture models and pam recovered the correct number of clusters with a frequency of 1.00. as with the data simulated using mixture models, the vgbmm with a spherical covariance matrix had the highest statistical fit among the mixture models. collectively, ourdatasets were analyzed with the variational inference gaussian mixture model (vbgmm), dirichlet process gaussian mixture model (dpgmm), and partitioning around medoids (pam). the bayesian information criterion (bic) was used to compare the fit of the mixture models to each dataset, with the best-fitting model shown in bold.. illustration of cluster assignment using the model with highest statistical fit for genes shared between the five chloroplast datasets. the rows correspond to the five datasets, and each column represents a gene. colours indicate the cluster assignments of the genes in each dataset analyses of simulated data show that mixture models and the pam algorithm perform well when the model used to generate the data matches that used to infer the number of clusters. however, mixture models performed well even when the data were simulated using a scenario based on pam, such that they provide more robust estimates.we investigated the performance of three different clustering methods for grouping genes according to their pattern among-lineage rate variation. we have found that the vbgmm with a spherical covariance matrix provides the best fit among the mixture models to a range of chloroplast datasets, and our simulation study confirms the stability of this method. the pam algorithm failed to recover the simulation conditions under vbgmm in most cases, probably because the shape of the clusters is difficult to capture using this method. in contrast, vbgmm frequently estimated the correct number of clusters irrespective of the simulation method. this differs from the results of previous studies of clustering methods for branch-length patterns, which found that the pam algorithm appeared to perform well . however, we reanalyzed a mammalian genome dataset from our previous study and found a similar number of clusters (supplementary material); the most stable mixture model (dpgmm) supported seven clusters, compared with 13 using pam in the original study. this suggests that, in empirical studies, it is important to compare the inferences from different clustering algorithms. in this study, for example, the estimated numbers of clusters for the empirical data are very similar among clustering algorithms. we find that mixture models provide a powerful alternative that can flexibly accommodate different cluster shapes. the results from these models also appear more stable under different simulation conditions, at least for the datasets analyzed here. another advantage of these methods is that their parametric nature offers a simple framework for conducting simulations, which should be done routinely to assess the robustness of the results. importantly, the shape of the clusters and choice of covariance structure do not necessarily have biological implications. rather, they provide a convenient mathematical description of the cluster shapes. the clusters identified in our analyses represent groups of genes that have similar patterns of among-lineage rate variation. all of the clustering algorithms suggest that the evolution of chloroplast genomes in angiosperms and nuclear genomes in mammals has been governed by a small number of pacemakers, each of which leads to a distinct pattern of rate variation among lineages . this is consistent with previous findings from prokaryotes , drosophila, and yeast . furthermore, comparing the gene clusters across our five angiosperm datasets reveals that there is some consistency in pacemakers across different taxonomic scales . however, additional work will be needed to understand the biological bases of these pacemakers. identifying genes with similar patterns of among-lineage rate variation has important applications in phylogenetic analyses. notably, in molecular dating studies, estimates of divergence times have been shown to be more accurate if a separate relaxed-clock model is assigned to each cluster of genes . our results indicate that multigene datasets might only exhibit a small number of distinct patterns of rate variation among lineages. this has notable implications for analyses of genome-scale datasets, for which only a small number of relaxed-clock models might be sufficient to capture the key components of evolutionary rate variation. to this end, clustering methods provide a feasible and reliable alternative to more computationally demanding approaches to selecting clock-partitioning schemes for molecular dating analyses. in particular, mixture models might have better performance than the k-medoids and k-means algorithms for genomic data because they can model clusters of different shapes. increasing the adoption of these methods will help to improve estimates of evolutionary rates and timescales from genome-scale datasets.results are based on analyses of 100 simulations under the model fitted to each of the five chloroplast datasets. in all cases, the most frequently chosen mixture model was the vgbmm with a spherical covariance matrix (frequency of 1.00). k mixture is the most frequent k for analyses of the data simulated using mixture models. k pam is the most frequent k for the analyses using the pam algorithm, with its corresponding frequency.  
