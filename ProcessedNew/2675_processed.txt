large-scale motif discovery using dna gray code and equiprobable oligomers motivation: how to find motifs from genome-scale functional sequences, such as all the promoters in a genome, is a challenging problem. word-based methods count the occurrences of oligomers to detect excessively represented ones. this approach is known to be fast and accurate compared with other methods. however, two problems have hampered the application of such methods to large-scale data. one is the computational cost necessary for clustering similar oligomers, and the other is the bias in the frequency of fixed-length oligomers, which complicates the detection of significant words. results: we introduce a method that uses a dna gray code and equiprobable oligomers, which solve the clustering problem and the oligomer bias, respectively. our method can analyze 18 000 sequences of 1 kbp long in 30 s. we also show that the accuracy of our method is superior to that of a leading method, especially for large-scale data and small fractions of motif-containing sequences. availability: the online and stand-alone versions of the application, named hegma, are available at our website:the technological development of next-generation sequencing has enabled us to obtain genome-scale promoter sequences . the first step toward unraveling the regulatory mechanisms from such large-scale data is to identify cis-regulatory motifs. existing computational algorithms used for motif finding may be categorized into three classes: (1) motif discovery from promoter sequences in a single genome ; (2) phylogenetic footprinting that uses promoter sequences from multiple species ; and (3) motif search relying on known motif models, such as jaspar and transfac . to predict the locations of motifs, each class adopts a distinct strategy: class (1) tries to find particular words or sets of similar words significantly enriched in promoters; class (2) aligns orthologous genomic sequences and extracts the sites that are well-conserved among species; and class (3) finds the sites that match a list of known motifs cataloged to whom correspondence should be addressed. in a library. although the latter two classes are applicable to genomescale promoter sequences in principle, the high computational cost prohibits application of the first class to large-scale data, despite the fact that motif discovery is the only way if we have no prior knowledge of other species or known motifs. of the several different approaches adopted in motif discovery, word-based methods are much more scalable than other approaches , such as expectation maximization or gibbs sampling . in principle, a word-based method exhaustively counts all the oligomers in a given set of sequences and detects the ones that are represented more abundantly than the background frequencies. however, there are two problems hindering the application of this method to largescale data. first, it is not trivial to cluster similar oligomers into fewer groups. fundamentally, a word-based method initially detects interesting oligomers without allowing any substitutions, whereas a motif is typically a set of similar oligomers that contain some variations among them. hence, we need to apply a clustering method to gather similar oligomers. however, the computational cost rapidly increases with the number of initial oligomers or the degree of allowed variations. second, the detection of significantly abundant oligomers is complicated by the variable background frequencies of different oligomers with a fixed length. for example, the background frequencies of at-rich and gc-rich oligomers can differ extensively in human promoter sequences. moreover, the difference becomes more remarkable for longer oligomers. thus, we have to carefully evaluate the statistical significance of over-representation of particular oligomers in large-scale data. here, we report a new motif discovery method that can analyze tens of thousands of dna sequences each 1 kbp long. we solve the first problem by using a dna gray code [originally proposed by, see also. the dna gray code is an ordering of oligomers in which adjacent oligomers differ from each other by only one nucleotide. since neighboring oligomers in the dna gray code are similar to one another, we can solve the first problem by searching only neighborhoods within the dna gray code. to solve the second problem, we use equiprobable oligomers, the lengths of which are variably adjusted so that every oligomer should have an approximately equal background probability. it is easily shown that the equiprobable oligomers can be naturally combined with the dna gray code. we implement our motif discovery method in c to produce the computer program named hegma and evaluate the performance of hegma by using a known database, cisred . the benchmark test indicates that in most situations hegmawe have developed a large-scale motif discovery tool, hegma, and shown that hegma is not only applicable to large-scale data, but also can stably detect motifs even if only a small fraction of the examined sequences contain the motifs. thus, hegma is applicable to situations where the fraction of motif-containing sequences is uncontrollable, such as the detection of splicing enhancers or silencers in exon and intron sequences, or the detection of microrna binding sites in utr sequences. a huge number of such sequences have already been collected in databases. however, as our knowledge of those motifs is yet far from complete, it is difficult to know in advance the percentage of sequences holding the motifs. we consider that the speed and precision of hegma would facilitate discovery of novel motifs from a heap of sequence data.  
