genome analysis covariate-modulated local false discovery rate for genome-wide association studies motivation: genome-wide association studies (gwas) have largely failed to identify most of the genetic basis of highly heritable diseases and complex traits. recent work has suggested this could be because many genetic variants, each with individually small effects, compose their genetic architecture, limiting the power of gwas, given currently obtainable sample sizes. in this scenario, bonferroni-derived thresholds are severely underpowered to detect the vast majority of associations. local false discovery rate (fdr) methods provide more power to detect non-null associations, but implicit assumptions about the ex-changeability of single nucleotide polymorphisms (snps) limit their ability to discover non-null loci. methods: we propose a novel covariate-modulated local false discovery rate (cmfdr) that incorporates prior information about gene elementbased functional annotations of snps, so that snps from categories enriched for non-null associations have a lower fdr for a given value of a test statistic than snps in unenriched categories. this readjustment of fdr based on functional annotations is achieved empirically by fitting a covariate-modulated parametric two-group mixture model. the proposed cmfdr methodology is applied to a large crohns disease gwas. results: use of cmfdr dramatically improves power, e.g. increasing the number of loci declared significant at the 0.05 fdr level by a factor of 5.4. we also demonstrate that snps were declared significant using cmfdr compared with usual fdr replicate in much higher numbers, while maintaining similar replication rates for a given fdr cutoff in de novo samples, using the eight crohns disease substudies as independent training and test datasets. availability an implementation: https://sites.google.com/site/covmo dfdr/large-scale hypothesis testing has emerged as a critical component of genetic analysis with the advent of high-throughput microarrays . for example, it is now possible to survey a large number of single nucleotide polymorphisms (snps) across the entire genome in an attempt to locate genetic variations associated with trait variability or disease risk. an advantage of large-scale genome-wide association studies (gwas) is the ability to discover the potential effect of any number of variants across the genome, without making strong a priori hypotheses about the subset of the genome to consider . a disadvantage is that a large number of false positives may occur when many hypothesis tests are conducted simultaneously . consequently, modern gwas have adopted a stringent bonferroni-derived multiple testing threshold of p 5 10 8 for declaring individual snp associations significant. unfortunately, these gwas have largely failed to identify substantial portions of the genetic basis of highly heritable diseases and complex traits . recent work has strongly suggested this could be because many genetic variants, each with individually small effects, compose their genetic architecture, limiting the power of gwas to detect true associations, given currently obtainable sample sizes . this scenario is especially damaging to power if all snps are treated as a priori exchangeable and hence equally likely to be related to the phenotype of interest, an implicit assumption of bonferroni thresholds and false discovery rate (fdr) control . other work has placed an emphasis on characterizing the biological function of genetic variants across the genome . typically, this work has focused on understanding how differences in the protein-coding region of genes may damage or alter the corresponding protein structure. however, recent efforts have attempted to characterize the potential effect of variants within non-coding elements, which may alter the timing, amount or location of gene expression . emerging from this research is a picture of widespread heterogeneity in the potential biological functionality of variants across the genome. a number of researchers have suggested that this heterogeneity of function to whom correspondence should be addressed translates to association studies, with certain genetic elements or categories of variants containing more or less trait-associated variants . given this, it is potentially of use to leverage functional annotations or other locus-specific covariates to improve gene discovery and replication of associations in de novo samples. classical multiple-comparison procedures, such as the bonferroni correction, control the family-wise error rate (fwer) or the probability of committing one or more type i errors in a family of hypothesis tests. these procedures tend to be underpowered in large-scale testing paradigms . in other words, fwer procedures can be excessively conservative when thousands or millions of cases are tested. benjamini andproposed an alternative approach to type i error control termed the fdr, defined as the expected proportion of errors among the rejected hypotheses. variants of their algorithm are applied to p-values of test statistics (null hypothesis tail probabilities) from many tests to control fdr to a specified level under various conditions. efron anddeveloped an extension of fdr called the local false discovery rate (fdr) from an empirical bayes point of view, defining fdr as the posterior probability that the null hypothesis is true, given the observed test statistic. the empirical bayes approach to fdr is closely related to thealgorithm for fdr control . these groundbreaking methodologies for controlling multiplicity under large-scale hypothesis testing have received widespread attention and development .proposed a mixture model of non-central 2 test statistics, where the probability of being associated with a phenotype (having a non-centrality parameter different from zero) depends on multiple covariates.proposed an estimator that allows for modulating the fdr of each null hypothesis based on external covariates. if fdr depends on levels of a measured covariate, then the exchangeability assumption implicit in the definition of fdr is not optimal, and sizeable gains in power can be realized by accounting for this dependence . the key technique to account for the dependence of fdr on the covariate x in the approach ofwas to bin the data into b sets according to ordered values of x. the assumption was that the influence of x on the posterior probability is nearly constant in each bin if bins are small enough (in practice, b 10 to 20). the fdr is then estimated in each bin, possibly with smoothing across the bins. this approach works best for one covariate and becomes impractical as the number of covariates increases. it has been applied to large-scale testing of neuroimaging data . in prior work, we have developed a scheme to assign gene elementbased functional annotations for snps genome-wide, which takes into account the locuslocus correlations [linkage disequilibrium (ld)] that gwas depend on for whole genome coverage . this ld-weighted annotation scheme provides multiple scores for each snp in several genic categories, including exon, intron, 5 0 untranslated regions (5 0 utr) and 3 0 untranslated region (3 0 utr). scores incorporate not only the category of a given variant but also the categories of all variants for which it is in ld (correlated with). intergenic snps are defined as having zero scores in all functional categories and being 4100 kb away from a protein-coding gene, providing a hypothesized null collection. using these functional annotations and summary statistics from 14 large gwas, we showed that test statistics resulting from snps that are in ld with the 5 0 utr of genes show the largest abundance of associations, while snps in ld with exons and the 3 0 utr are also enriched. snps in ld with introns are modestly enriched and intergenic snps show a depletion of associations, relative to the average snp . a more detailed description of how the ld-weighted genic annotations were produced is given in the supplementary materials. this situation is illustrated in, which displays qq plots of log 10 transformed p-values from a gwas of crohns disease (cd) of 51 109 subjects, obtained through a publicly accessible database . enrichment for true associations is expressed as a leftward deflection of the qq plots stratified by genic category, representing an overabundance of low p-values compared with that expected under the global null hypothesis of no associations. leftward deflections are directly related to decreased fdr for a given p-value threshold. the 5 0 utr snps are most enriched, followed by exons, 3 0 utr and introns. intergenic snps are impoverished for true effects. these results were consistent across all assessed phenotypes and strongly suggest that all snps should not be treated as a priori exchangeable for purposes of hypothesis testing but that certain categories are much more likely to show an association. the current article leverages the information available in genic annotation categories for large-scale gwas hypothesis testingby presenting a novel, fully bayesian approach for generalized covariate-modulated local false discovery rate (cmfdr) estimation, implemented using a markov chain monte carlo (mcmc) sampling algorithm. through this approach, we are able to model the influence of a vector of covariates on the distribution of the test statistics and hence on the fdr. section 2 gives a brief review of fdr and introduces cmfdr, constructed from a bayesian two-group mixture model that incorporates covariates. section 3 presents the mcmc algorithm for fitting the model and drawing inferences and applies cmfdr to examples involving both simulated and real data. the last section is devoted to a discussion of results and future work.methods for large-scale hypothesis testing that control type i error rates without being overly conservative are crucial in gwas . it has become increasingly evident that many complex phenotypes and diseases have many genetic determinants, each with small effect . hence, traditional fwer correction is too conservative and severely underpowered. fdr and fdr have come to be accepted broadly as routine techniques to control for the rate of false positive in large-scale hypothesis testing settings in a number of fields. however, even these methods do not account for the vast majority of phenotypic variance explained by common variants . a problem with these and other multiple testing methods is that all snps are treated as exchangeable. in particular, each snp is given the same a priori probability of being non-null. on the contrary, we and others have shown that the functional role of snps has a strong impact on the probability of association across a broad array of complex phenotypes and diseases. this work proposes a novel bayesian approach (cmfdr) to incorporate a set of important covariates into the fdr under a heteroscedastic model, where the probability of non-null status and the distribution of the test statistic under the non-null hypothesis are both modulated by covariates. the primary advantage of our methodology over traditional fdr methods is that two snps with the same z score can have different values of cmfdr if one is in a more enriched category than the other. hence, by using snp annotations to modulate fdr, more snps can be discovered for a given level of fdr control. in other words, methods such as cmfdr that break the exchangeability assumption are potentially more powerful than traditional fdr methods that assume exchangeability. in the cd example, we discovered 5.4 times as many snps (unpruned) using cmfdr compared with usual fdr for an identical 0.05 cutoff. the increase in number of replicated snps in de novo subsamples from fdr to cmfdr was even more dramatic. parameter estimates of covariates can also be biologically informative about the relative functionality of different biological classifications of variants. it is crucial to note that our ld-weighted snp annotations were computed independently of the phenotypes investigated. thus, modifying the fdr based on information from genic categories does not bias results toward rejecting more null hypotheses. moreover, the cmfdr methodology is capable of handling any relevant source of information, including, for example,the proposed methodology has some drawbacks. first, as currently formulated, it assumes all hypothesis tests are independent. this is not true for snps in ld, and our 95 credible intervals are probably too small. moreover, it remains unclear what impact ld has on fdp control because it may be the case that all or almost all tag snps are in partial ld with causal snps but are not themselves causal. correlation across snps can be handled, for example, by repeatedly and randomly pruning snps for independence before running the mcmc algorithm, by using a discrete markov random field formulation or by modeling snps simultaneously using, for example, a multivariate mixed-effects model framework . we have implemented a random pruning option available with the r code distribution. second, it may be the case for some applications that the gamma distribution does not fit the tail probabilities of the non-null distribution well. we have used other distributions (e.g. the skewed generalized normal) and are currently developing a non-parametric alternative that produces flexible fits to tail probabilities. although non-parametric estimates of the non-null density avoid bias from lack of model fit, parametric alternatives can be more powerful if the fit is adequate. finally, it appears from simulations that the cmfdr methodology can be overly liberal in scenarios where 1 is close to 0. care must therefore be taken when applying cmfdr in these circumstances.  
