ipknot: fast and accurate prediction of rna secondary structures with pseudoknots using integer programming motivation: pseudoknots found in secondary structures of a number of functional rnas play various roles in biological processes. recent methods for predicting rna secondary structures cover certain classes of pseudoknotted structures, but only a few of them achieve satisfying predictions in terms of both speed and accuracy. results: we propose ipknot, a novel computational method for predicting rna secondary structures with pseudoknots based on maximizing expected accuracy of a predicted structure. ipknot decomposes a pseudoknotted structure into a set of pseudoknot-free substructures and approximates a base-pairing probability distribution that considers pseudoknots, leading to the capability of modeling a wide class of pseudoknots and running quite fast. in addition, we propose a heuristic algorithm for refining base-paring probabilities to improve the prediction accuracy of ipknot. the problem of maximizing expected accuracy is solved by using integer programming with threshold cut. we also extend ipknot so that it can predict the consensus secondary structure with pseudoknots when a multiple sequence alignment is given. ipknot is validated through extensive experiments on various datasets, showing that ipknot achieves better prediction accuracy and faster running time as compared with several competitive prediction methods. availability: the program of ipknot is available at http://www.ncrna.org/software/ipknot/. ipknot is also available as a web server at http://rna.naist.jp/ipknot/.rnas play various roles in biological processes, ranging from the passive role as a messenger that carries genetic information to the active roles as a regulator for gene expression and as a catalyst in cellular processes. considerable attention has been paid to the functions of rnas, especially those of regulatory non-coding rnas . it is widely believed that there is a strong correlation between the 3d structure of an rna molecule and its function. a set of base pairs formed from hydrogen bonds is called a secondary structure, which shapes the substructure of the 3d structure. since experimental determination of rna 3d structures is difficult and their structures are hierarchical, secondary structure prediction provides a major key to elucidating the potential functions of rnas. a good number of computational studies have so far been presented on rna secondary structure prediction. they can be roughly classified into two groups, namely comparative sequence analysis and single sequence analysis. comparative methods based on alignment folding include rnaalifold and pfold . the comparative analysis has an advantage of a fair possibility of achieving high prediction accuracy since it can take evolutionary information into consideration. however, this approach is not always applicable since a set of homologous sequences is required in advance. as for single sequence analysis, a popular approach is to find the structure with the minimum free energy (mfe) of a single rna sequence. we can use programs that implement this strategy based on dynamic programming (dp) algorithms such as mfold and rnafold . notice that the free energy of a secondary structure is calculated by summing energy parameters of respective loop substructures, which can be experimentally determined and computationally estimated . furthermore, these dp-based methods are applied to the calculation of the partition function for rna secondary structures , which enables us to compute posterior base-pairing probabilities. recently, several sophisticated methods have been proposed for predicting the secondary structure with the maximum expected accuracy (mea) over a space of possible structures. contrafold and centroidfold that adopt this idea achieve better prediction accuracy as compared with the mfe-based methods. it is to be noted that all of the above methods aim to predict relatively simple rna structures with nested base-pairing interactions. pseudoknot is one of the important topologies in rna secondary structures. a pseudoknot is typically formed from the base pairings between the unpaired bases of a loop and those outside the loop, which is often called an h-type pseudoknot (see). in other words, a secondary structure includes a pseudoknot if at least two arcs drawn above the primary sequence that represent base pairs cross each other (see). pseudoknotted structures are observed in many rnas such as ribosomal rnas, transfer messenger rnas and viral rnas (van). pseudoknots are knownwe proposed a new computational method ipknot for predicting rna secondary structures with a wide class of pseudoknots, which can take either a single sequence or aligned sequences as input. we demonstrated using a variety of structural datasets that ipknot is sufficiently fast and accurate as a computational prediction tool for both single sequence analysis and comparative sequence analysis. prediction accuracy of ipknot depends mainly on its scoring functions even though the method uses the approximate probability distribution for pseudoknotted structures. in fact, experimental results revealed that ipknot with the base-pairing probabilities computed by heuristic refinement produces much better predictions than that without refinement. moreover, when we adopted the exact probabilities for pseudoknots, a significant improvement in accuracy was confirmed, though much computation time was spent on the predictions. considering these results, there is room for further investigation into refinement of the scoring functions that make prediction accuracy compatible with running time. another important fact to stress is that ipknot can run quite fast even on a relatively long sequence less than one thousand bases. this is attributed to use of both approximation of a probability distribution for pseudoknots and integer programming with threshold cut based on maximizing expected accuracy. as described in section 1, prediction methods with satisfying speed and accuracy are useful for finding functional non-coding rna genes from genome sequences. making skillful use of the speed and accuracy of our method, exhaustive search for genes of non-coding rnas that may form pseudoknots is a worthwhile task as another future work.  
