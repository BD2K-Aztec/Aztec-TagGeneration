genetics and population analysis scphaser: haplotype inference using single-cell rna-seq data determination of haplotypes is important for modelling the phenotypic consequences of genetic variation in diploid organisms, including cis-regulatory control and compound heterozygosity. we realized that single-cell rna-seq (scrna-seq) data are well suited for phasing genetic variants, since both transcriptional bursts and technical bottlenecks cause pronounced allelic fluctuations in individual single cells. here we present scphaser, an r package that phases alleles at heterozygous variants to reconstruct haplotypes within transcribed regions of the genome using scrna-seq data. the devised method efficiently and accurately reconstructed the known haplotype for !93 of phasable genes in both human and mouse. it also enables phasing of rare and de novo variants and variants far apart within genes, which is hard to attain with population-based computational inference. availability and implementation: scphaser is implemented as an r package. tutorial and code are available at https://the haplotype phase, the sequence of alleles present on the same nucleic acid molecule, such as the maternal or paternal copy of a chromosome, is of importance to reveal relationships between dna sequence and phenotype. major efforts have been made using expression-quantitative-trait-loci studies to identify cis-regulatory variants that affect gene expression. making use of allele-specific expression (ase) increases the power of such studies; however, to reach the full potential of ase-based approaches require or depend on phased alleles within genes . phase information is also important for associating clinical outcomes to genetic variation, e.g. to identify cases of compound heterozygosity where risk alleles at different loci do not co-occur on the same dna molecule but affect both homologous copies of a gene.we assessed the performance of scphaser on two full-length scrnaseq datasets, where the phase was known. the first dataset contained 336 cells from a mouse f1 cross of two inbred strains for which the genomes are known (cast/eij c57bl/6j, reciprocal cross) and the second dataset contained 28 single cells from the human individual na12878, where the phase was inferred via transmission between the sequenced genomes of the family-trio . all eight phasing approaches implemented in scphaser (methods) were assessed with respect to varying pre-filtering settings and genotype calling cutoffs for the two datasets (supplementary). a suitable trade-off between phasing accuracy and number of phasable genes (at least two heterozygous variants left in a gene) was obtained by pre-filtering for at least five cells with imbalanced ase for a variant, where imbalance should be at least 3-fold (fc 1/3 or fc ! 3, where fc alternative allele count/ reference allele count) and there are at least three reads for any of the alleles in such a cell. furthermore, we set the default phasing arguments to cluster exhaustive, input allele counts and weigh false, since that combination performed the best on average across the two datasets, with 95.1 and 97.5 correctly phased variants in the mouse and human dataset, respectively . at gene-level, 93.6 and 94.9 of phasable genes had all variants correctly phased. originally, there were 20 268 and 15 597 refseq genes with at least two heterozygous variants at the dna level and using the default pre-filtering values 8563 and 534 phasable genes remained in the mouse and human dataset, respectively (336 versus 28 sequenced cells). in a second human dataset, containing 163 single cells sequenced from a single individual , we found that 3155 refseq genes were phasable out of 15 556 refseq genes with at least two heterozygous variants. the dependency of number of phasable genes with respect to number of sequenced cells, degree of genome heterozygosity and sequencing depth is shown in supplementary. the run-time on the human 163-cell dataset using default settings was 61 seconds using 80 cores and the computational complexity with respect to the number of variants, genes and cells are shown in supplementary.we conclude that phasing by leveraging the imbalanced ase frequently observed in full-length scrna-seq data is both accurate and fast. using rna instead of dna enables phasing of variants located far apart from each other within a gene due to introns. as data from only a single individual is needed scphaser can also phase rare and de novo variants. the number of genes available for phasing depends on (i) the number of sequenced single cells, (ii) cell type, as the number of expressed genes vary considerably between cell types, (iii) the number of heterozygous variants in the individual, where genetically distant parents yield higher heterozygosity, (iv) sequencing depth and (v) the efficiency of the full-length scrna-seq protocol. the retrieved gene phase information has important applications in functional and clinical genomics, such as empowering cis-regulatory variation studies and in elucidating the impact of haplotype structures on phenotypic outcome and response.  
