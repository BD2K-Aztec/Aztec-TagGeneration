genome analysis wiggletools: parallel processing of large collections of genome-wide datasets for visualization and statistical analysis motivation: using high-throughput sequencing, researchers are now generating hundreds of whole-genome assays to measure various features such as transcription factor binding, histone marks, dna methylation or rna transcription. displaying so much data generally leads to a confusing accumulation of plots. we describe here a multi-threaded library that computes statistics on large numbers of datasets (wiggle, bigwig, bed, bigbed and bam), generating statistical summaries within minutes with limited memory requirements, whether on the whole genome or on selected regions.with the advent of high-throughput sequencing, research teams and consortia are generating large numbers of datasets that are projected onto the same reference genome . in particular, epigenomic assays quantify many continuous variables across the genome, e.g. transcription factor binding, histone marks, dna methylation, chromatin structure or rna transcription. although they differ in their protocols, all the above assays include a sequencing step that generates a huge number of sequencing reads. these reads, or tags, are then aligned against the human genome. this placement information is normally stored in the bam file format . because the bam files are generally large and information rich, they are often summarized into bigwig files that describe a numerical variable such as read depth across the genome . these bam and bigwig files can then readily be displayed on most genome browsers . in the current context, where researchers are testing many measurements across many samples, displaying all these data creates confusing graphics: either the plots are placed sideby-side and an observer is forced to continually shift their attention from one plot to another, or the plots are superimposed, blurring the information content.instead, one could summarize all these datasets for each position in the genome. similarly, one could display the difference between case and control datasets. fundamentally, all of these datasets are simply vectors of numbers, and statistics, such as mean, variance, median, etc., can be generated from any such collection, producing a meaningful summary of the data. common statistical tools such as r (r core) do not scale well to such large datasets, especially with respect to memory requirements. therefore, we developed a tool that can perform rigorous statistical tests across the whole genome and detect regions of interest without practical memory constraints. we drew inspiration from the popular bedtools package , which computes overlaps and derived statistics between sets of regions. converting numerical measurements into genomic regions (generally referred to as peak calling or segmentation, depending on the context) is a convenient and common approach to handling genome-wide data. however, it does imply an inevitable loss of information, as continuous variables are discretized and often binarized. therefore, we wanted a tool that natively reads the numerical data contained in genomic files and computes statistics on it.  
