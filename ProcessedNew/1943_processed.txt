gdfuzz3d: a method for protein 3d structure reconstruction from contact maps, based on a non-euclidean distance function motivation: to date, only a few distinct successful approaches have been introduced to reconstruct a protein 3d structure from a map of contacts between its amino acid residues (a 2d contact map). current algorithms can infer structures from information-rich contact maps that contain a limited fraction of erroneous predictions. however, it is difficult to reconstruct 3d structures from predicted contact maps that usually contain a high fraction of false contacts. results: we describe a new, multi-step protocol that predicts protein 3d structures from the predicted contact maps. the method is based on a novel distance function acting on a fuzzy residue proximity graph, which predicts a 2d distance map from a 2d predicted contact map. the application of a multi-dimensional scaling algorithm transforms that predicted 2d distance map into a coarse 3d model, which is further refined by typical modeling programs into an all-atom representation. we tested our approach on contact maps predicted de novo by multicom, the top contact map predictor according to casp10. we show that our method outperforms ft-comar, the state-of-the-art method for 3d structure reconstruction from 2d maps. for all predicted 2d contact maps of relatively low sensitivity (6084), gdfuzz3d generates more accurate 3d models, with the average improvement of 4.87 a in terms of rmsd. availability and implementation: gdfuzz3d server and standalone version are freely available atpredicting protein tertiary structure from amino acid sequence has been a major challenge in structural biology for over four decades. it was proposed by anfinsen that in the native environment, all proteins assume their tertiary structure spontaneously and this process is solely determined by the amino acid sequence . still, predicting the 3d structure accurately from its amino acid sequence remains a formidable challenge. contemporary protein structure prediction protocols are built upon two distinct approaches: comparative modeling (typically based on the evolutionary relationship between the target sequence and a sequence of another protein with known structure, which can be used as a template) and folding simulation (typically based on a search of the conformational space, with a scoring function that attempts to identify native-like conformations for the polypeptide chain). both approaches can benefit from the use of additional data encoded as v c the author 2015. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.com spatial restraints, which can be derived from experimental analyses or from independent predictions. one of the commonly considered types of additional data useful for protein 3d structure prediction are the spatial proximities between individual amino acid residues. information about the proximity of residue or atom pairs in the molecule can be represented as a square symmetric matrix . values stored in such a matrix may represent the euclidean distances between particular atoms and such a matrix is then called a (euclidean) distance map. if only binary information about residue-residue interactions is included (e.g. qualified by a euclidean distance below a given threshold), that matrix is called a contact map. the majority of the contact map processing approaches, especially those using contacts in protein 3d structure prediction, use euclidean metric functions based on the distances between the ca or cb atoms of the residues with the contact threshold set to 8 a . a protein 3d structure can be accurately predicted based on information about distances between its individual atoms, encoded as spatial restraints . it can be also modeled based on its binary contact map, with the reconstructed and original structures similar up to the resolution of the contact map representation . the pioneering method for protein 3d structure reconstruction from 2d contact maps developed by vendruscolo et al. was tested and proven to work with the native (100 accurate) contact maps, as well as with maps into which up to 4 of true contacts were replaced by erroneous ones. a more recent method ft-comar enabled 3d structure reconstruction from less accurate contact maps. it was shown that the quality of 3d reconstruction with ftcomar is unaffected by deleting up to an average 75 of the real contacts (if the remaining 25 contains no errors) while indeed only a small percentage of randomly generated (wrong) contacts in place of non-contacts are sufficient to hamper 3d reconstruction . a detailed error-rate comparison implies that 8 a rmsd model quality limit is upheld by vendruscolo method if the random error rate is about 6 or less, while in ft-comar an error rate of 16 or lower can be tolerated. it must be emphasized that information about chirality in 3d (handedness) is lost upon conversion of a protein structure from 3d to a 2d representation. the determination of the actual biological structure among the two mirror image models that are in agreement with the map is not trivial, but can be achieved. typically, if the protein contains a-helices, a model with biologically relevant righthanded helices can be selected. further, the need to instantiate biologically relevant stereoisomeric forms of individual residues may allow the discrimination of models with native-like versus mirrored topologies using scoring functions for protein model quality assessment at the stage of all-atom reconstruction of the 3d model . the conservation of 3d structures in globular protein domains imposes strong constraints on amino acid residues. in each protein, favorable interactions are formed between residues with appropriate side chains (e.g. disulfide bridges between cysteine residues, salt bridges between charged residues, hydrophobic interactions between aliphatic residues, etc.). favorable interactions tend to be preserved in evolution, resulting in correlations among amino acid compositions at different sequence positions when aligned sequences of homologous proteins are considered. both physico-chemical and evolutionary considerations can be exploited to infer spatial contacts for proteins with unknown structure. currently, the computational prediction of direct contacts is considered much easier than the prediction of distances between residues. there are many methods that predict contacts between amino acid residues from protein sequence; e.g. nncon , svmcon , possum , psicov , pconsc and multicom . typically, they generate a map with predicted contact probabilities for all possible pairs of residues, which can be used as a starting point for 3d structure reconstruction. for a typical structure of a protein of length l, the total number of unique contacts defined as distances between the ca atoms 8 a , is about 4.5 5.0 l (data not shown). a typical predicted map contains a much larger number of tentative contacts; however, a more realistic map (with a native-like number of contacts) may be inferred by taking 4.5 l contacts predicted with highest probability scores. over last 20 years, significant effort has been made to benchmark and assess methods for predicting protein structure from amino sequence, in particular in the framework of the biannual critical assessment of protein structure prediction (casp) experiment . methods for contact prediction were evaluated in the rr category of casp. a common evaluation metric for residue-residue contact predictions is the accuracy of only the top l/5, l/10 or 5 predictions scored best by a given method. accuracy is defined as the number of correctly predicted residueresidue contacts divided by the total number of contact predictions considered . unfortunately, the overall contact prediction quality is still at a disappointingly low level as compared with the required levels of 3d structure retrieval protocols. recently, novel quality measures were introduced to score predictors in casp10 . multicom was able to predict contacts with best quality levels, defined as a mutual score of sensitivity (recall): 31.4 and precision (accuracy) 6.9 when considering predictions for long-range contacts (i.e. residue pairs separated in the sequence by at least 24 other residues). however, these predictions of contact maps that may be considered state-of-the-art, are significantly worse than the minimal requirements by the state-of-the-art methods for 3d protein structure reconstruction from 2d contacts. here, we present a novel approach for predicting 3d structures from 2d maps. it is based on two components: first, a new method for predicting 2d distance maps from 2d contact maps and second, a modeling protocol that involves a combination of coarse-grained and all-atom modeling. our method was developed to use predicted contact maps that include probabilities of contacts for all residues and can be used in de novo 3d structure prediction, based on the output of various existing contact map prediction programs. we implemented this protocol as a publicly available web server gdfuzz3d that takes a contact map as an input and reports an allatom 3d model of the protein structure, as well as a predicted 2d distance map.we developed a method for predicting protein 3d structures from 2d contact maps, which is based on a novel approach for predicting distance maps from predicted 2d contact maps. the main novelty is in the concept of a non-euclidean 2d distance map, which can be derived directly (and unambiguously) from a protein contact map. the graph distance reflects a series of physical contacts between the residues, and thereby indicates the length of the path of the signal produced by a perturbation of a given residue (due to a substitution or due to any physical interaction with the environment) until it affects other residues in the protein. the graph distance matrix can be therefore treated as a map of perturbation propagation pathways, which describes in detail to which extent a single residue substitution may impact other residues in protein structure. most of existing methods for predicting protein 3d structures from 2d contact maps are very sensitive to errors. currently, the best methods for 2d contact map predictions perform rather poorly on average, and only a small fraction of their predictions have high accuracy. typical predicted contact maps contain a non-physical number of contacts and they include a large number of contacts that are erroneous. our intention was to develop a method that overcomes the problem of non-physicality of typical predicted contacts maps, and to handle input maps with probabilities of contacts for all residues. such maps contain a very high number of predicted contacts, of which many are erroneous, and which often contradict one another. our algorithm does not tackle cases where only a few highly relevant contacts are known, but this task can be handled by standard methods for protein 3d structure prediction by folding with restraints, such as rosetta or cabs . we tested our 3d structure prediction protocol on contact maps predicted with multicom (the best method for contact map prediction according to casp10) and found that it generates more accurate 3d models than those produced by ft-comar, on maps with a wide range of sensitivity values. we have also tested it on contact maps predicted by pconsc (with a restricted range of sensitivities) and demonstrated that models generated by gdfuzz3d are on the average almost as accurate as those generated by computationally demanding pconsfold protocol. our method is modular and elements of our protocol can be incorporated into other protocols for protein 3d structure prediction from contact maps. in particular, the 3d modeling methodology we used (combination of modeller and refiner) can be easily replaced any other method for structure prediction that uses distance restraints. in particular, the use of extensive conformational sampling (as in pconsfold with rosetta) and/or the use of alternative methods for model quality assessment (and identification of candidate structures from many decoys) may further improve the accuracy of predicted structures. in particular, we envisage that elements of our protocol could be combined with elements of the pconsfold protocol to generate even better predictions. on the other hand, the choice of a method with which to generate an input contact map can be a significant factor in the procedure. it would be interesting to evaluate various combinations of methods for contact map generation, conversion of distance maps to contact maps, and protein 3d folding with restraints. we envisage potential applications of graph distance maps beyond protein 3d structure prediction. one possible application is in protein contact map alignment, flexible superposition of protein structures, and structure-based sequence alignment. algorithms that use contact maps operate on sparse matrices, in which the majority of entries represent non-contacts. the use of graph distance maps, which can be obtained both from experimentally determined protein 3d structures and from predicted contact maps, would allow for the use of more efficient algorithms developed; e.g. for distance matrix comparison, as in dali . this approach could facilitate comparison of proteins with known structures with those with unknown structures, for which only theoretical predictions (including predicted contact maps) are available. another possible application of graph distance maps include rna 3d structure modeling. most methods for rna 3d structure prediction developed to date utilize similar strategies to those developed for protein 3d structure modeling . rna 3d structure prediction is usually guided by secondary structure prediction, which identifies canonical watson-crick base pairs. comparison of a full gdfuzz3d procedure (graph distance) with a simplified version (contacts-only), where only restraints on contacts are used with modellernote: rmsdthe smaller the better, tm-scorethe higher the better (details in supplementary tables s4 and s5). between ribonucleotide residues. however, there exist methods such as shevek , mc-fold or rnawolf (zu) that predict other types of contacts in rna structures, including non-canonical base pairs. thus, the approach delineated here for protein structure modeling could be used to improve rna 3d structure modeling by the inference of rna graph distance maps. last, but not least, some elements of the methodology described in this article could be adapted to help generation of coarse-grained 3d models of chromatin structure based on long-range contact information from experiments such as hi-c .  
