a gibbs sampling strategy applied to the mapping of ambiguous short-sequence tags motivation: chromatin immunoprecipitation followed by high-throughput sequencing (chip-seq) is widely used in biological research. chip-seq experiments yield many ambiguous tags that can be mapped with equal probability to multiple genomic sites. such ambiguous tags are typically eliminated from consideration resulting in a potential loss of important biological information. results: we have developed a gibbs sampling-based algorithm for the genomic mapping of ambiguous sequence tags. our algorithm relies on the local genomic tag context to guide the mapping of ambiguous tags. the gibbs sampling procedure we use simultaneously maps ambiguous tags and updates the probabilities used to infer correct tag map positions. we show that our algorithm is able to correctly map more ambiguous tags than existing mapping methods. our approach is also able to uncover mapped genomic sites from highly repetitive sequences that can not be detected based on unique tags alone, including transposable elements, segmental duplications and peri-centromeric regions. this mapping approach should prove to be useful for increasing biological knowledge on the too often neglected repetitive genomic regions.genome-wide chromatin immunoprecipitation followed by highthroughput sequencing (chip-seq) experiments are increasingly used in biological and medical research . chip-seq experiments produce a large amount of short sequence tags which need to be reliably mapped back to the genome and processed to reveal biologically relevant signal. a number of algorithms have been recently developed to process chip-seq data . these include algorithms for genomic mapping of sequence tags , smoothing of chip-seq tag distribution signals and detection of statistically significant tag peaks . one remaining challenge for the processing of chipseq data is the mapping of ambiguous tags. ambiguous tags are to whom correspondence should be addressed. those that can be mapped to multiple genomic sites, each of which has significant sequence similarity with the tag, and thus it is difficult to distinguish the real site from all the possible sites. usually, researchers simply disregard ambiguous tags and only make use of uniquely mapped tags. this often results in a substantial loss of information and may bias conclusions based on the analysis of unique tags alone. this is particularly true for mammalian genomes, such as the human genome, which have numerous interspersed repeat sequences. repeat sequences that are highly similar may produce a large amount of ambiguous tags, which if not mapped will be disregarded in subsequent analyses. research has shown that interspersed repeat sequences provide a wide variety of functional elements to eukaryotic genomes . therefore, disregarding ambiguous tags may lead to an underestimate of the biological significance and functional roles of interspersed repeated dna. two different approaches have been developed for the mapping of ambiguous sequence tags. the mapping software maq randomly selects a possible site and assigns it to the ambiguous tag . each possible site has the same probability of being selected. in other words, there is no way to know if this approach yields a correct mapping of ambiguous tags. the second approach takes advantage of the local context of mapped tags to more accurately assign genomic locations for ambiguous tags. this approach rests on the assumption that real ambiguous tag sites are expected to have more sequence tags in the local vicinity, whereas the incorrect sites for the same ambiguous tags are expected to have fewer numbers of co-located tags . to apply this method for any ambiguous tag, the number of overlapping mapped tags at each of the possible ambiguous tagmapped positions are counted and used to assign fractional weights to each possible position. the ambiguous tag is then fractionally mapped to each possible position with the fractions weighted by the local-mapped tag context. in other words, possible sites with more tags already mapped are deemed to deserve higher confidence and are accordingly assigned greater fractions of ambiguous tags. the fractional mapping method makes important contribution to the ambiguous tag mapping problem. but as the use of chip-seq in scientific research is increasing, it will be important to further refine the accuracy of mapping ambiguous tags. first, the fraction method is heuristic as the fractions assigned to the possible map sites are directly proportional to the number of tags mapped to each site. while this approach is consistent with biological intuition, it lacks statistical support. a more sensitive probabilistic method could be used to better represent and measure the confidence level of. scheme of our glibbs sampling algorithm. possible tag map sites along with their likelihood ratios are shown prior to stochastic mapping. gray boxes represent incorrect sites, and the black box represents the correct site. an arrow between a tag and a site means the tag could possibly be mapped to that site. one iterative cycle of joint stochastic mapping and parameter updating is shown. the black arrows point to selected sites for each tag after stochastic mapping. each possible site. second, the fraction method deterministically fractionates the ambiguous tags without guarantee that the result is optimal. in other words, it does not search the possible space of assignments of ambiguous tags and lacks information on the accuracy of the final results. third, the fraction method is not realistic enough since it splits tags by assigning fractions of ambiguous tags to each possible site. in reality, each sequence tag is only derived from a single genomic site. thus, fractioning sequence tags inevitably results in wasting signal on incorrect sites and weakening the signal level on real sites. to address the outstanding issues with ambiguous tag mapping, we have developed a probabilistic gibbs sampling-based algorithm to map more ambiguous tags with greater accuracy. our approach assigns ambiguous tags to single genomic sites, without fractionating tags, and iteratively samples within the space of the possible mappings of ambiguous tags. the gibbs sampling strategy guides the algorithm to achieve accurate unique mappings of ambiguous tags. the algorithm also provides statistical support for ambiguous tag mapping via the use of likelihood ratios that measure the confidence levels of possible genomic map sites. we evaluated the performance of our algorithm compared to existing approaches using sequence-tag data from the highly repetitive human genome. we demonstrate that our probabilistic approach to mapping ambiguous tags yields superior results as measured by (i) the fraction of correctly mapped ambiguous tags; (ii) the precision and recall of correctly recovered repetitive genomic sites; and (iii) the level of signal found at repetitive sites.  
