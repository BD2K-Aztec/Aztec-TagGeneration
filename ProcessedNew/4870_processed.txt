sequence analysis visualization and probability-based scoring of structural variants within repetitive sequences motivation: repetitive sequences account for approximately half of the human genome. accurately ascertaining sequences in these regions with next generation sequencers is challenging, and requires a different set of analytical techniques than for reads originating from unique sequences. complicating the matter are repetitive regions subject to programmed rearrangements, as is the case with the antigen-binding domains in the immunoglobulin (ig) and t-cell receptor (tcr) loci. results: we developed a probability-based score and visualization method to aid in distinguishing true structural variants from alignment artifacts. we demonstrate the usefulness of this method in its ability to separate real structural variants from false positives generated with existing upstream analysis tools. we validated our approach using both target-capture and whole-genome experiments. capture sequencing reads were generated from primary lymphoid tumors, cancer cell lines and an ebv-transformed lymphoblast cell line over the ig and tcr loci. whole-genome sequencing reads were from a lymphoblastoid cell-line. availability: we implement our method as an rstructural variants (svs), including deletions, insertions, inversions and translocations, are known to contribute to a wide range of human phenotypes . high-throughput technology has facilitated exciting findings, associating svs with multi-genic diseases like autism and schizophrenia , and revealing genomic rearrangements in cancer . thousands of genomic loci in humans are now known to vary structurally. next generation sequencing (ngs) is central to the field, evidenced by the high visibility of consortia that use ngs, like the 1000 genomes project . despite group efforts and recent advances, discovering and annotating the full landscape of svs in humans is incomplete. this is in part owed to the inaccuracy of ngs in defining repetitive dna. repetitive dna, stretches of nucleotides present in more than one copy in the haploid genome, accounts for about half of the human genome. these stretches may be sub-classified by length, copy number, base composition and linear organization, all of which are difficult to assay with ngs . paired-end mapping, the most widely used ngs method for detecting svs, has some ability to define svs in repetitive sequences. the idea is to find readpairs that map with an unexpected distance or orientation relative to one another, therefore implying an sv. when one or both ends of a readpair map to the reference genome in multiple locations they provide evidence for multiple, contradictory structural arrangements. this is particularly problematic with ngs because a standard approach, among the most widely used aligners, is to randomly pick and report only one location for reads that map to multiple locations. this can easily lead to paired-end alignments that appear to be svs when in fact the reads were from a contiguous piece of the reference genome. in this article we demonstrate how this is a substantial problem in practice and present a method that greatly helps ameliorate the problem. currently, a handful of tools, including hydra , gasvpro and variationhunter , attempt to resolve the inconsistencies generated from ambiguously mapped reads. hydra and variationhunter choose one alignment per read from a set of possibilities to designate as correct. gasvpro weighs multiple mappings per read in proportion to their probability. despite clever algorithms, the accuracy of these tools is limited when the ends map ambiguously (this point will be demonstrated to whom correspondence should be addressed. the author 2014. published by oxford university press. this is an open access article distributed under the terms of the creative commons attribution license (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. in section 3.2). as a result, one must either discard results in repetitive dna, or perform independent validation. one popular form of the latter involves visualizing alignments over candidates. several viewers are available but there is a lack of options tailored to discriminating false svs from true svs . we developed a probability-based score that can be used to prioritize candidate svs. our score weighs two contradictory hypotheses: readpairs either belong to both the junctions of an sv, one read per junction or they belong to just one of the junctions . because univariate scores are sometimes too simplistic we also developed a visualization tool for alignments for candidate svs. to avoid reinventing the wheel, the starting point of our method is the outputs of the existing sv discovery tools. we illustrate the usefulness of our method on two experiments both of which provided a way to validate findings (described in detail in section 2.2 and in the supplement). the first was a typical whole-genome sequencing experiment and the second was a target-capture sequencing on a region known to have a high prevelance of svs . for the whole-genome experiment we sequenced a diploid lymphobastoid cell-line from an anonymized female individual . for the capture experiment we targeted sequences in the ig and tcr loci in primary lymphoid cancer samples, cancer cell lines and an ebv transformed cell line. these loci, the building blocks of antigen binding domains in immunoglobulins and t-cell receptors, are characterized by consecutive homologous sequences. this repetitive, segmentally duplicated architecture makes these loci notoriously difficult to assay using ngs . these loci are an area of much interest because of their fundamental role in immunology and cancer . at the heart of our contribution to sv detection, our procedure filtered out false positives resulting from repetitive sequence in these data. for validation of our target-capture results we used pcr. our target sequence was enriched for segmental duplications about six times above the genome-wide level. they represented 37 of the target sequence while they are present in 5.7 of the human genome. of validated false positives in the targetcapture sequences, 75 (29/38) contained breakpoints overlapping a segmental duplication. importantly, we also identified true svs within segmental duplications in our target-capture data. of validated true positives in the target-capture, 50 (13/26) contained breakpoints that overlapped a segmental duplication. segmental duplications were also a significant source of spurious results in our whole-genome data. of validated false positives in the whole-genome data, 48 (73/151) contained breakpoints overlapping a segmental duplication while for true positives in the whole-genome data only 15 (6/39) did so. to validate these results we used readdepth-based cnv calls from three wholegenome sequencing runs of our lymphoblast sample. our results demonstrate that our method effectively distinguishes artifacts from true svs in repetitive loci.we used our method with four sv finders, hydra, gasv, gasvpro and variationhunter, to analyze sequences from whole-genome and targetcapture data. the final validation set from the whole-genome data included 190 distinct deletions, 39 (21) positives and 151 (79) negatives and 64 distinct svs, from the target-capture, 26 (41) positives and 39 (59) negatives. our sequencing library for the targetcapture experiment included fragments selectively captured from v(d)j loci on chromosomes 2, 7, 14 and 22 in a panel of neoplastic b and t lymphocytes and an ebv transformed cell line. each of the three sv callers we used for this dataset, hydra, gasv and variationhunter, returned many results. gasv and hydra returned a similar quantity (413 000 and 412 000, respectively) while variationhunter returned 843. the callers also returned many results for the whole genome sample. two callers, gasvpro and variationhunter, returned 48000 results, and the other two callers, gasv and hydra, returned 458 000 and 430 000, respectively. without accurate prioritization, a result list with thousands of calls is not particularly useful. based upon validation of 64 junctions in the targetcapture dataset, and 190 deletions in the whole-genome sample, a small fraction of all candidate svs, the callers did not appear to adequately provide this capability. caller performance individually (see section 3.1) and in combination, using agreement between callers, was wanting, especially for the targetcapture experiment. in our targetcapture dataset, agreement between callers was relatively low and did not serve to distinguish validated true positives from false positives. when considering the top 500 calls from each method, $74 were made by only one method, $20 were made by exactly two methods and $7 were made by all three . the existence of calls made by multiple methods raised the possibility of using consensus to circumvent the weaknesses of any individual caller. however, when considering the validated svs, this prospect did not translate to reality. in the call sets of top 500 candidates, there were nearly equal proportions of validated true positives and false positives called by multiple methods. in these sets, 24 false positives, 63 of those validated and 18 true positives, 69 of those validated, were reported by at least two callers. additionally, there was no apparent advantage to distinguishing between calls made by exactly two methods and calls made by all three methods. five out of the 18 true positive calls made by multiple methods (28) were made by all three methods. eight out of the 24 false positive calls made by multiple methods (25) were made by all three methods. we show results for agreement between hydra variationhunter, and gasvpro for the whole-genome sample because we were able to use gasvpro, a probabilistic version of gasv, in the whole-genome case. when considering the top 500 calls from each method, 55 were made by just one method, 20 were made by exactly two methods and 25 were made by all three . of validated deletions within this set, calls made by multiple methods were enriched for true positives much more than false positives. twenty true positives, 51 of those validated, were reported by at least two callers, while only seven false positives, 5 of those validated were reported by at least two callers. based on these results, using agreement between callers to prioritize candidates was a mixed bag. it was not useful for the targetcapture and somewhat useful for the whole-genome results. in the whole-genome sample, calls made by multiple methods were trustworthy compared with calls made by just one method, yet about half of validated positives were not multiple method calls. these data indicated that a different prioritization was needed.  
