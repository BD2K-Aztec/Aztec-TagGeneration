sequence analysis star: ultrafast universal rna-seq aligner motivation: accurate alignment of high-throughput rna-seq data is a challenging and yet unsolved problem because of the non-contiguous transcript structure, relatively short read lengths and constantly increasing throughput of the sequencing technologies. currently available rna-seq aligners suffer from high mapping error rates, low mapping speed, read length limitation and mapping biases. results: to align our large (480 billon reads) encode transcriptome rna-seq dataset, we developed the spliced transcripts alignment to a reference (star) software based on a previously undescribed rna-seq alignment algorithm that uses sequential maximum map-pable seed search in uncompressed suffix arrays followed by seed clustering and stitching procedure. star outperforms other aligners by a factor of 450 in mapping speed, aligning to the human genome 550 million 2 76 bp paired-end reads per hour on a modest 12-core server, while at the same time improving alignment sensitivity and precision. in addition to unbiased de novo detection of canonical junctions , star can discover non-canonical splices and chimeric (fusion) transcripts, and is also capable of mapping full-length rna sequences. using roche 454 sequencing of reverse transcription poly-merase chain reaction amplicons, we experimentally validated 1960 novel intergenic splice junctions with an 8090 success rate, corroborating the high precision of the star mapping strategy. availability and implementation: star is implemented as a standa-lone c code. star is free open source software distributed under gplv3 license and can be downloaded fromalthough genomes are composed of linearly ordered sequences of nucleic acids, eukaryotic cells generally reorganize the information in the transcriptome by splicing together non-contiguous exons to create mature transcripts . the detection and characterization of these spliced rnas have been a critical focus of functional analyses of genomes in both the normal and disease cell states. recent advances in sequencing technologies have made transcriptome analyses at the single nucleotide level almost routine. however, hundreds of millions of short (36 nt) to medium (200 nt) length sequences (reads) generated by such high-throughput sequencing experiments present unique challenges to detection and characterization of spliced transcripts. two key tasks make these analyses computationally intensive. the first task is an accurate alignment of reads that contain mismatches, insertions and deletions caused by genomic variations and sequencing errors. the second task involves mapping sequences derived from non-contiguous genomic regions comprising spliced sequence modules that are joined together to form spliced rnas. although the first task is shared with dna resequencing efforts, the second task is specific and crucial to the rna-seq, as it provides the connectivity information needed to reconstruct the full extent of spliced rna molecules. these alignment challenges are further compounded by the presence of multiple copies of identical or related genomic sequences that are themselves transcribed, making precise mapping difficult. various sequence alignment algorithms have been recently developed to tackle these challenges . however, application of these algorithms invokes compromises in the areas of mapping accuracy (sensitivity and precision) and computational resources (run time and disk space) . with current advances in sequencing technologies, the computational component is increasingly becoming a throughput bottleneck. high mapping speed is especially important for large consortia efforts, such as encode (http://www.genome. gov/encode/), which continuously generate large amounts of sequencing data. furthermore, most of the cited algorithms were designed to deal with relatively short reads (typically 200 bases), and are ill-suited for aligning long read sequences generated by the emerging third-generation sequencing technologies . the longer read sequences, ideally reaching full lengths of rna molecules, have a great potential for enhancing transcriptome studies by providing more complete rna connectivity information. this report describes an alignment algorithm entitled spliced transcripts alignment to a reference (star), which was designed to specifically address many of the challenges of rna-seq data mapping, and uses a novel strategy for spliced alignments. we performed high-throughput validation experiments that corroborated stars precision for detection of novel splice junctions. stars high mapping speed and accuracy were crucial for analyzing the large encode transcriptome dataset (480 billion illumina reads). we also demonstrated that star has a potential for accurately aligning long (several kilobases) reads that are emerging from the third-generation sequencing technologies. to whom correspondence should be addressed. the author 2012. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.comdespite several years of ongoing improvements, alignment of the non-contiguous rna-seq reads to a reference genome is not a solved problem yet, owing both to its intrinsic complexity and rapid transformations of the sequencing technologies. several critical problems have been found to afflict previously published approaches, such as high mapping error rate, alignment biases, low sensitivity for unannotated transcripts, poor scalability with the read length, restrictions in the number of junctions/mismatches/indels per read, inability to detect non-linear transcripts (such as chimeric rnas), and, crucially, low mapping throughput. in this work, we described star, a novel algorithm for aligning high-throughput long and short rna-seq data to a reference genome, developed to overcome the aforementioned issues. unlike many other rna-seq mappers, star is not an extension of a short-read dna mapper, but was developed as a stand-alone c code. star is capable of running parallel threads on multicore systems with close to linear scaling of productivity with the number of cores. star is fast: on a modern, but not overly expensive, 12-core server, it can align 550 million 2 76 nt reads per hour to the human genome, surpassing all other existing rna-seq aligners by a factor of 50. at the same time, star exhibits better alignment precision and sensitivity than other rna-seq aligners for both experimental and simulated data. one of the main inherent problems of all de novo rna-seq aligners is the inability to accurately detect splicing events that involve short (5510 nt) sequence overhangs on the donor or acceptor sides of a junction. this causes a significant underdetection of splicing events, and also increases significantly the misalignment rate, as such reads are likely to be mapped with a few mismatches to a similar contiguous genomic region. in addition, this effect also biases the alignments toward processed pseudogenes, which are abundant in the human genome. similarly to other rna-seq aligners, to mitigate this problem, star has an option to obtain information about possible splice junction loci from annotation databases (supplementary section 4). it is also possible to run a second mapping pass, supplying it with splice junction loci found in the first mapping pass. in this case, star will not discover any new junctions but will align spliced reads with short overhangs across the previously detected junctions. to demonstrate stars ability to align long reads, we have mapped the long (0.55 kb) human mrna sequences from genbank (see supplementary section 5 for details). the accuracy of star alignments is similar or higher than that of blat a popular est/mrna aligner. at the same time, star outperforms blat by more than two orders of magnitude in the alignment speed, which is important for high-throughput sequencing applications. the algorithm extensibility to long reads shows that star has a potential to serve as a universal alignment tool across a broad spectrum of emerging sequencing platforms. star can align reads in a continuous streaming mode, which makes it compatible with novel sequencing technologies such as the one recently announced by oxford nanopore technologies. as the sequencing technologies and protocols evolve, new mapping strategies will have to be developed, and star core algorithm can provide a flexible framework to address arising alignment challenges. data access geo: gse38886 (roche 454 sequencing) geo: gse30567 (illumina long rna-seq)  
