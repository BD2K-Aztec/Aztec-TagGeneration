an efficient algorithm for the blocked pattern matching problem motivation: tandem mass spectrometry (ms) has become the method of choice for protein identification and quantification. in the era of big data biology, tandem mass spectra are often searched against huge protein databases generated from genomes or rna-seq data for peptide identification. however, most existing tools for ms-based peptide identification compare a tandem mass spectrum against all peptides in a database whose molecular masses are similar to the precursor mass of the spectrum, making mass spectral data analysis slow for huge databases. tag-based methods extract peptide sequence tags from a tandem mass spectrum and use them as a filter to reduce the number of candidate peptides, thus speeding up the database search. recently, gapped tags have been introduced into mass spectral data analysis because they improve the sensitivity of peptide identification compared with sequence tags. however, the blocked pattern matching (bpm) problem, which is an essential step in gapped tag-based peptide identification, has not been fully solved. results: in this article, we propose a fast and memory-efficient algorithm for the bpm problem. experiments on both simulated and real datasets showed that the proposed algorithm achieved high speed and high sensitivity for peptide filtration in peptide identification by database search.with the developments of high-throughput genomics, transcriptomics and proteomics, combining multiple omics data provides a new way for studying complex biological systems. in multiple omics data analysis, tandem mass (ms/ms) spectra are searched against protein databases generated from genomes or rna-seq data for peptide identification. these protein databases are often huge. for example, in human microbiome studies, ms/ms spectra are searched against databases containing protein sequences generated from hundreds, even thousands, of genomes . most mass spectrometry (ms)-based peptide identification tools match an ms/ms spectrum against all peptides in a database whose molecular masses are similar to the precursor mass of the spectrum . these tools become slow when the database is large. an alternative approach is based on peptide sequence tags: peptide sequence tags are extracted from an ms/ms spectrum and searched against a database to identify a small number of candidate peptides that match at least one of the tags, then a rescoring function is applied to report the highest scoring candidate peptide . the trade-off between speed and sensitivity is an important problem in tagbased methods. to increase the sensitivity, it is essential that the set of sequence tags extracted from a spectrum contains a correct one that matches the target peptide. to increase the speed, long sequence tags (length ! 5) are preferred because they are efficient in filtering out incorrect peptides. as a result, correct long sequence tags are extremely useful in tag-based methods because they speed up database searches without losing sensitivity. however, correct long sequence tags may not be found in ms/ ms spectra because of missing and noise peaks . to utilize long sequence tags,proposed to generate a spectral dictionary containing full-length peptide constructions from an ms/ms spectrum for peptide identification. a drawback of this approach is that a spectral dictionary of an ms/ms spectrum with a large precursor mass may contain billions of peptides.introduced gapped peptides to solve this problem. since a gapped peptide represents many non-gapped peptides, the use of gapped peptides significantly reduces the sizes of spectral dictionaries and speeds up peptide identification without losing sensitivity. similar to the method proposed by, replacing sequence tags with gapped tags can achieve both high speed and high sensitivity in tag-based peptide identification. a gapped tag is represented by a sequence of mass values instead of amino acids. each mass value is the mass of one amino acid residue or the sum of the masses of several consecutive amino acid residues. many ms/ms spectra do not contain long sequence tags because of missing peaks, but contain long gapped tags. gapped tags and gapped peptides give rise to the blocked pattern matching (bpm) problem in which a blocked pattern generated from a gapped tag is searched against a text to find matched substrings.proposed an o(m) algorithm for querying a blocked pattern of length m against a text of length n. however, the time and space needed for the preprocessing step of the algorithm is o2 k , where k is the length of the longest substring to identify. when k = 30, the preprocessing step is slow and the space required by the algorithm is huge. to whom correspondence should be addressed.in this article, we present a fast and memory-efficient algorithm for the bpm problem. the time and space complexity of the preprocessing step of the algorithm is o(n). in the application of ms-based peptide identification, the time complexity for querying a blocked pattern is sublinear in n. experiments on both simulated and real ms/ms data sets showed that the proposed algorithm achieved high speed and high sensitivity for peptide filtration in peptide identification by database search.we implemented the bpm algorithm in java and tested it on both simulated and real datasets. all the tests were performed on a linux (64-bit) desktop pc with a 1.4 ghz cpu and 32 gb ram. we were not able to compare the bpm algorithm with that described inbecause it is not available.  
