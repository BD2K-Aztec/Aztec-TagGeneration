metaktsp: a meta-analytic top scoring pair method for robust cross-study validation of omics prediction analysis downloaded from motivation: supervised machine learning is widely applied to transcriptomic data to predict disease diagnosis, prognosis or survival. robust and interpretable classifiers with high accuracy are usually favored for their clinical and translational potential. the top scoring pair (tsp) algorithm is an example that applies a simple rank-based algorithm to identify rank-altered gene pairs for classi-fier construction. although many classification methods perform well in cross-validation of single expression profile, the performance usually greatly reduces in cross-study validation (i.e. the prediction model is established in the training study and applied to an independent test study) for all machine learning methods, including tsp. the failure of cross-study validation has largely diminished the potential translational and clinical values of the models. the purpose of this article is to develop a meta-analytic top scoring pair (metaktsp) framework that combines multiple transcrip-tomic studies and generates a robust prediction model applicable to independent test studies. results: we proposed two frameworks, by averaging tsp scores or by combining p-values from individual studies, to select the top gene pairs for model construction. we applied the proposed methods in simulated data sets and three large-scale real applications in breast cancer, idiopathic pulmonary fibrosis and pan-cancer methylation. the result showed superior performance of cross-study validation accuracy and biomarker selection for the new meta-analytic framework. in conclusion , combining multiple omics data sets in the public domain increases robustness and accuracy of the classification model that will ultimately improve disease understanding and clinical treatment decisions to benefit patients.high-throughput experimental techniques, including microarray and massively parallel sequencing, have been widely applied to discover underlying biological processes and to predict the multi-causes of complex diseases (e.g. cancer diagnosis,), prognosis (van de) and therapeutic outcomes,). the associated data analysis has brought new statistical and bioinformatic challenges and many new methods have been developed in the past 15 years. in particular, methods for classification and prediction analysis (a.k.a. supervised machine learning) are probably the most relevant tools towards translational and clinical applications. take breast cancer as an example, many expression-based biomarker panels have been developed [e.g. mammaprint (van t), oncotype dx , breast cancer index bci and pam50 (for classification/prediction of survival, recurrence, drug response and disease subtype. reproducibility analysis of these markers and classification models has been a major concern and has drawn significant attention to ensure clinical applicability of these panels . many articles have focused on normalization, reproducibility of marker detection, inter-lab or inter-platform correlation concordance. for direct clinical utilities, more attention have shifted towards cross-study validation or inter-study prediction (i.e. a prediction model is established in one study and validated independently in a test study . such an issue is critical for translating models from transcriptomic studies into a practical clinical tool. for example, the training cohort may have utilized an old affymetrix u133 platform. a biomarker panel and a model are constructed and a test study from a different medical center using an rna-seq platform is available. a successful machine learning model should retain high prediction accuracy in such inter-lab and inter-platform validation. we note that many normalization methods have been developed to adjust for systematic biases across studies, including distance weighted discrimination , cross-platform normalization and knorm correlation . but the normalization performance largely depends on whether the observed data structure fits the model assumptions. in most applications, researchers have applied meta-analysis methods and have avoided relying on effectiveness of normalization . to compare the metaanalysis methods with mega-analysis (i.e. normalize across studies and directly merge data for inference) in this article, we only perform simple quantile normalization within each study and then standardize each sample to mean zero and unit sd before we adopt mega-analysis. in addition to the issue of cross-study validation, its critical to select a robust and accurate machine learning method. in the literature, many supervised machine learning methods have been proposed and applied to high-throughput experimental data. for example, the cma package allows easy implementation of 21 popular classification methods such as linear or quadratic discriminant analysis, lasso, elastic net, support vector machines (svms), random forest, pam etc . in addition to these popular methods, the top scoring pair (tsp) method is a straightforward prediction rule utilizing building blocks of rank-altered gene pairs in case and control comparison (see section 2.1 for more details). the method is mostly rank-based without any model parameter. it is invariant to monotone data transformation and the feature selection and the model are more transparent for biological interpretation. although tsp and its variant are robust methods that do not require normalization in cross-study validation, we have found that some of the selected tsps from the training study may not reproduce in the test study possibly due to platform differences.illustrates the expression levels of a good tsp gene pair, itgax and xbp1, identified from the first ipf (idiopathic pulmonary fibrosis) training study emblom (see data descriptions in supplementary). xbp1 is over-expressed than itgax in control samples but under-expressed in cases. if we use this tsp to validate in the test study konishi, we find that xbp1 is over-expressed than itgax in both cases and controls and we obtain 0 sensitivity and 100 specificity (i.e. youden index sensitivity specificity 1 0). we found similar poor performance in two other studies tedrow b and pardo, showing that the tsp is likely a false positive. in, gpr160 is over-expressed than comp in controls and under-expressed in cases for all three studies emblom, tedrow b and pardo. it is a more reliable tsp across three studies and conceptually is less likely a false positive. indeed, the cross-study validation in konishi shows good performance with 80 youden index. the two real examples inargue the potential of a meta-analytic approach by combining multiple training transcritomic studies to identify reliable tsps so the resulting model has enhanced cross-study validation performance. in this article, we propose three meta-analytic approaches for tsp method (metatsp) by combining information across multiple training studies using (i) averaged tsp scores (ii) combining p-values via fishers method (iii) combining p-values via stouffers method . to decide the number of tsps used for model construction, a classical cross validation (cv) method and a variance optimization (vo) method are applied and compared. simulations and three real omics data sets (two gene expression data on breast cancer and ipf, and. two tsp examples from real data to show advantage of metatsp. xaxis and y-axis refer to sample indices and gene expression levels, respectively. (a) gene pair itgax/xbp1 has high tsp score (xbp1 itgax in controls but itgax xbp1 in cases) in the training emblom study but fail to replicate in the testing konishi study as well as the other two tedrow b and pardo studies. (b) gene pair gpr160/comp has high tsp scores (gpr160 comp in controls and comp gpr160 in cases) in all three training studies emblom, tedrow b and pardo. the gene pair is successfully validated in the testing konishi study one pan-cancer methylation data) are used to benchmark the crossstudy validation performance.  
