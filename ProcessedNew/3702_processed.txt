genome analysis prism: a primer selection and matching tool for amplification and sequencing of viral genomes prism is a set of algorithms designed to select and match degenerate primer pairs for the amplification of viral genomes. the design of panels of hundreds of primer pairs takes just hours using this program, compared with days using a manual approach. prism allows for rapid in silico optimization of primers for downstream applications such as sequencing. as a validation, prism was used to create an amplification primer panel for human immunodeficiency virus (hiv) clade b. availability: the program is freely available for use at: www.broadinstitute.org/perl/seq/specialprojects/viral populations are dynamic and the strains circulating in an infected population often vary geographically and temporally. rna viruses, especially those that cause chronic disease such as hepatitis c virus (hcv) and human immunodeficiency virus (hiv), exhibit tremendous sequence diversity . as such, primers designed from a single reference genome may limit the number of variants captured from within a single patient as well as variants isolated from different geographic regions and time periods. here, we report on a novel primer design method that: (i) leverages existing genome sequence information to design degenerate primers that account for the significant diversity observed in viral populations, and (ii) maximizes the ability to successfully amplify and sequence the genomes of viruses from different individuals that may differ significantly from a single viral reference genome. previous primer selection algorithms have been designed to amplify single target regions , or optimized for snp or gene-specific pcr , groupspecific pcr , or for phylogenetically related dna sequences . these methods do not, however, permit push button, full-genome length, primer pair design from very diverse organisms such as those represented by rna viruses. to whom correspondence should be addressed.a comparison of the features of prism to those of several other primer design programs is included in supplementary table 1. prism takes advantage of existing sequence information for a given viral strain to select the optimal primers, based on user-defined criteria. the algorithm then suggests pairs of primers to make up a panel that will generate amplicons of desired length and overlap. diversity capture is increased through the use of degenerate base codes.page: 267 266267we have used prism to design successful primers suitable for the full-genome sequencing of dengue virus (denv), west nile virus (wnv), hiv, hcv and lassa virus (data not shown). all of these viruses exist natively as single-stranded rna genomes with genome lengths in the 911 kb range. here, we report on performance results from hiv clade b as this demonstrates the stability of prism even when viral strain diversity is high. we downloaded 86 full-genome sequences for hiv clade b from the los alamos hiv database (www.hiv.lanl.gov/) and a multiple alignment was created using the muscle algorithm with standard settings. using default settings of prism, 1051 forward primers and 1047 reverse primers were deemed to be valid. from these, 352 amplicons between 500 and 900 bp were identified. to meet our coverage target and fit on our plate-based pcr format, a total of 96 of these were chosen to amplify the hiv genome (see supplementary material for a list of the primer pairs). the computational part of the process took 2 h 45 min between job submission and receipt of an email with the final results. in order to test the robustness of the prism-designed primers, hiv rna was extracted from 10 chronically infected patients and converted to cdna as previously described . a single large amplicon spanning nucleotides 6239639 of the hiv genome was generated from each cdna and nested pcr reactions were set up using the prism-designed panel. eight out of ten samples had amplification success rates (as calculated by number of successful products out of 82 possible) of 90, with another sample yielding 85 positive bands. only one sample had three or more overlapping products fail (see supplementary material for more details). these results compare very favorably with our observed hiv pcr performance historically (data not shown).  
