sequence analysis spolpred: rapid and accurate prediction of mycobacterium tuberculosis spoligotypes from short genomic sequences spoligotyping is a well-established genotyping technique based on the presence of unique dna sequences in mycobacterium tuberculosis (mtb), the causal agent of tuberculosis disease (tb). although advances in sequencing technologies are leading to whole-genome bacterial characterization, tens of thousands of isolates have been spoligotyped, giving a global view of mtb strain diversity. to bridge the gap, we have developed spolpred, a software to predict the spoligotype from raw sequence reads. our approach is compared with experimentally and de novo assembly determined strain types in a set of 44 mtb isolates. in silico and experimental results are identical for almost all isolates (39/44). however, spolpred detected five experimentally false spoligotypes and was more accurate and faster than the assembling strategy. application of spolpred to an additional seven isolates with no laboratory data led to types that clustered with identical experimental types in a phylogenetic analysis using single-nucleotide polymorphisms. our results demonstrate the usefulness of the tool and its role in revealing experimental limitations. availability and implementation: spolpred is written in c and is available from www.pathogenseq.org/spolpred.tuberculosis is an infectious disease caused by bacterium of the mycobacterium tuberculosis (mtb) complex. genotyping techniques based on the presence of repetitive elements, conserved sequences, or loci with variable numbers of tandem repeats have been standardized , allowing the comparison of isolates between laboratories and regions worldwide. the popular spoligotyping approach exploits the polymorphism at the direct repeat (dr) locus of mtb. it is based on the polymerase chain reaction (pcr) amplification of 43 short unique sequences (termed spacers) found between well-conserved 36-bp drs and the subsequent hybridization of the products onto a membrane with oligonucleotides complementary to each spacer. since strains vary in the occurrence of particular spacers, each sample produces a distinctive spot pattern, which is then translated into a numerical code of 15 digits known as octal code . the web-based database sitvitweb contains 2740 shared types or spoligotype international types (sits) found among 58 180 clinical isolates, subsequently grouped into a list of 62 lineages/sublineages which normally show a geographic distribution . in silico genotyping approaches are required to bridge the gap between experimental and high-throughput sequencing, leading to the development of spolpred, a software to predict the spoligotype from raw sequence reads. coverage. nevertheless, processed reads per unit of time remained constant (500 000 reads per minute). spolpred-inferred sit numbers matched the experimental ones for 39 samples (88.6). the resulting octal codes from both in silico approaches were identical for 42 (95.5) of the 44 samples with experimental results (see supplementary table s1 for detailed results). in the remaining two isolates, de novo assembly failed to detect spacer 25, which happens to fall between contiguous assembled contigs. the overall five non-matched in silico and experiment results were due to the increased in silico sensitivity of the detection of spacer 15 in the five samples and, additionally, spacer 26 in one sample. when the original hybridization blots were checked, an irregular signal distribution for spacer 15 across all samples was noted. some signals were either too faint or just not detectable to be manually assigned as being present. although predicted spoligotypes remained unchanged for samples 26 and 48, the other three (25, 40 and 49), which had octal codes not previously reported in the sitvitweb database, were re-assigned to different spoligotypes. interestingly, these three isolates are consistently clustered in the snp-based dendogram, i.e. within a clade of samples having the same experimental type. similarly, all samples with no laboratory data were clustered with isolates of the same predicted spoligotype .although snps and other genetic variation derived from sequencing projects are likely to become the markers of choice due to their discriminatory power, pcr genotyping techniques are still widely employed. in this regard, spolpred will enable the complementary comparison of computationally inferred spoligotypes with laboratory results. currently, the tedious parameter optimization and computational requirements for de novo assembly are important constraints. only 42 (95.5) spoligotypes could be accurately inferred using the de novo strategy implemented. the region in the dr locus harbouring spacer 25 does not seem to be reconstructed in two genomes, resulting in an incorrect type classification. importantly, in those five samples for which spolpred and experimental patterns differ, predicted octal codes were exactly the same when using both computational approaches. furthermore, the newly assigned spoligotypes (namely, isolates 25, 40 and 49 in) are clustered with other isolates having coincident experimental and in silico predicted lineages. the absent sequence responsible for the discrepancies observed, namely, spacer 15, was the same across all five problematic isolates. the ambiguous distinction of this spacer has been reported and explained in terms of the presence of a 4-nt deletion adjacent to the amplified sequence (van), which would not allow a proper primer hybridization. other ambiguities caused by the insertion of is6110 copies in the dr region have also been reported . as demonstrated, the software can be employed to accurately and quickly confirm experimentally determined spoligotypes, infer them from sequenced isolates with no laboratory data and reveal unexpected cases of wrongly assigned types. other causes of tb misclassification such as laboratory cross contamination, pcr contamination or ambiguous hybridization patterns could also be clarified. with the amount of sequence data increasingly growing, software like spolpred will be useful additions to pipelines used to infer tb (e.g. miru-vntr) and other bacterial strain types (e.g. mlst typing) and ultimately assist with disease control.  
