sequence analysis mtr: taxonomic annotation of short metagenomic reads using clustering at multiple taxonomic ranks motivation: metagenomics is a recent field of biology that studies microbial communities by analyzing their genomic content directly sequenced from the environment. a metagenomic dataset consists of many short dna or rna fragments called reads. one interesting problem in metagenomic data analysis is the discovery of the taxonomic composition of a given dataset. a simple method for this task, called the lowest common ancestor (lca), is employed in state-of-the-art computational tools for metagenomic data analysis of very short reads (about 100 bp). however lca has two main drawbacks: it possibly assigns many reads to high taxonomic ranks and it discards a high number of reads. results: we present mtr, a new method for tackling these drawbacks using clustering at multiple taxonomic ranks. unlike lca, which processes the reads one-by-one, mtr exploits information shared by reads. specifically, mtr consists of two main phases. first, for each taxonomic rank, a collection of potential clusters of reads is generated, and each potential cluster is associated to a taxon at that rank. next, a small number of clusters is selected at each rank using a combinatorial optimization algorithm. the effectiveness of the resulting method is tested on a large number of simulated and real-life metagenomes. results of experiments show that mtr improves on lca by discarding a significantly smaller number of reads and by assigning much more reads at lower taxonomic ranks. moreover, mtr provides a more faithful taxonomic characterization of the metagenome population distribution. availability: matlab and c++ source codes of the method available atnew-sequencing technologies and the dramatic reduction in the cost of sequencing have boosted the development of metagenomics, a new discipline that studies dna and rna sequences sampled from genomic material present in a microbial community . metagenomics has gained popularity because it allows to whom correspondence should be addressed. researchers to study (the large amount of) microbes that cannot be cultured and their role in the environment, for instance in term of interaction with other organisms. sequencing a sample produces a collection of dna or rna fragments, called reads, belonging to the different genomes present in the sample. a metagenomic dataset is a collection of these sampled reads. until recently shotgun sanger sequencing was the main technology used in metagenomics , producing reads of length ranging between 800 and 1000 bp). nowadays, other less expensive technologies like roche 454 and illumina platforms 1 generate reads of 100400 bp and 75100 bp, respectively. such new-sequencing technologies produce very large datasets containing short reads. computational analysis techniques are indispensable to extract knowledge from these datasets . in this article, we focus on the taxonomic assignment of very short reads (about 100 bp) to putative taxa. taxonomic assignment is a way to assess species diversity and to understand what the different populations are doing. it is also used for improving reads assembly . computational approaches for taxonomic assignment can be divided into two main groups: composition based and similarity based. composition-based annotation methods cluster the reads according to their gc content, codon usage and other oligonucleotide frequencies. these methods cannot be directly applied to short reads because of the local variation of nucleotides distribution across a genome . moreover, external environmental factors seem to influence the gc nucleotide composition of a community, suggesting that it may be even harder to distinguish the reads of different organisms relying on gc content . similarity-based taxonomic annotation methods assign reads to organisms or taxa using similarities of reads to reference sequences of a given database. similarity is usually measured by means of sequence alignment tools, like blast . this approach is useful when most reads in the sample have significant similarities to reference sequences from known operational taxonomic units . the incompleteness of the information contained in reference databases and the bias toward cultivable species constitute inherent limitations of the similarity-based approach. nevertheless, similarity-based techniques have beenfor all datasets, a small percentage of reads had at least one highquality hit (supplementary), an expected phenomenon related to the incompleteness of the information contained in the database of reference . these reads were selected for taxonomic assignment. we assessed comparatively the performance of lca and mtr with respect to the number of reads assigned and the taxa detected. moreover, we compared mtr and lca in term of their characterization of the taxonomic population distribution at ranks order and genus. for real-life datasets, the characterizations were performed also at ranks phylum and class. finally, on simulated datasets, where the true taxonomic assignment is known by construction, we compared the quality of the assignments given by mtr and lca using taxon accuracy (i.e. the percentage of taxa correctly detected), taxon sensitivity (i.e. the number of taxa correctly detected by the algorithm divided by the total number of true taxa) and accuracy (i.e. the percentage of reads correctly assigned).results of our study on simulated and real-life datasets indicate that mtr is better than lca with respect to the number of assigned reads. the total number of reads assigned increases, as well as the number of reads assigned at lower ranks. with respect to correctness of the assignment, results indicate higher accuracy of lca. however, these results are computed on sets of different size, where much greater sets of reads are used for computing accuracy of mtr. therefore, accuracy results should be interpreted with care. for instance, on the simulated metagenome m3, mtr assigns on the average 43.36 more reads than lca at rank genus, with a small loss of accuracy (2.77 on the average). accuracy reduction of mtr on m1 at rank genus is 6.44 but the method assigns 63.25 more reads than lca. on m2 at rank genus, mtr assigns 77.64 more reads than lca with an accuracy  
