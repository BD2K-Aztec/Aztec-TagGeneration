structural bioinformatics topology and prediction of rna pseudoknots motivation: several dynamic programming algorithms for predicting rna structures with pseudoknots have been proposed that differ dramatically from one another in the classes of structures considered. results: here, we use the natural topological classification of rna structures in terms of irreducible components that are embeddable in the surfaces of fixed genus. we add to the conventional secondary structures four building blocks of genus one in order to construct certain structures of arbitrarily high genus. a corresponding unambiguous multiple context-free grammar provides an efficient dynamic programming approach for energy minimization, partition function and stochastic sampling. it admits a topology-dependent parametrization of pseudoknot penalties that increases the sensitivity and positive predictive value of predicted base pairs by 1020 compared with earlier approaches. more general models based on building blocks of higher genus are also discussed. availability: the source code of gfold is freely available atthe global conformation of rna molecules is to a large extent determined by topological constraints encoded at the level of secondary structure, i.e. by the mutual arrangements of the base paired helices . in this context, secondary structure is understood in a wider sense that includes pseudoknots. although the vast majority of rnas has simple, to whom correspondence should be addressed. i.e. pseudoknot-free, secondary structure, pseudobase lists more than 250 records of pseudoknots determined by a variety of experimental and computational techniques including crystallography, nuclear magnetic resonance, mutational experiments and comparative sequence analysis. in many cases, they are crucial for molecular function. examples include the catalytic cores of several ribozymes , programmed frameshifting and telomerase activity , reviewed in; staple and butcher (2005). secondary structures can been interpreted as matchings in a graph of permissible base pairs . the energy of rna folding is dominated by the stacking of adjacent base pairs, not by the hydrogen bonds of the individual base pairs . in contrast to maximum weighted matching, the general rna folding problem with a stacking-based energy function is npcomplete . the most commonly used rna secondary structure prediction tools, including mfold and the vienna rna package , therefore exclude pseudoknots. polynomial-time dynamic programming (dp) algorithms can be devised, however, for certain restricted classes of pseudoknots. in contrast to the o(n 2 ) space and o(n 3 ) time solution for simple secondary structures , however, most of these approaches are computationally much more demanding. the design of pseudoknot folding algorithms thus has been governed more by the need to limit computational cost and achieve a manageable complexity of the recursion than the conscious choice of a particularly natural search space of rna structures. as a case in point, the class of structures underlying the algorithm by rivas and eddy (1999) (r&estructures, pknot-r&e) was characterized only in a subsequent publication . the following references provide a certainly incomplete list of dp approaches to rna structure prediction using different structure classes characterized in terms of recursion equations and/or stochastic grammars: akutsupage: 1077 10761085combinatorial models of pseudoknotted rna structures are limited in two ways: on the one hand, exact algorithmic folding can be constructed only for certain types of structures; on the other hand, the larger the structure sets are, the more base pairing patterns are contained in them that cannot be realized in nature due to steric constraints. algorithm design so far has been mostly driven by the desire to reduce computational complexity. the idea behind gfold, in contrast, is to define a more suitable class of structures that can be generated by nesting and concatenating a small number of elementary building blocks. this recursive structure is captured by a fairly simple unambiguous multiple context-free grammar that translates in a canonical way to dp algorithms for computing the minimum energy structure and the partition function in o(n 6 ) time and o(n 4 ) space. in addition to mfe folding, we have implemented the computation of base pairing probabilities and a stochastic backtracing recursion, thus providing the major functionalities of rna secondary structure prediction software for a very natural class of pseudoknotted structures. the 1-structures considered here strike a balance between the generality necessary to cover almost all known pseudoknotted structures and the restriction to topologically elementary structures that have a good chance to actually correspond to a feasible spatial structure. from a mathematical point of view, the characterization of structures in terms of irreducible components with given topological genus appears particularly natural and promises to reflect closely the ease with which a structure can be embedded in three dimensions. in addition, the grammar underlying gfold naturally distinguishes different types of pseudoknots and admits different energy parameters for them. we observe that this additional freedom of the parametrization leads to a substantial increase of sensitivity of type (k) pseudoknots, (0.63 0.889) and ppv (0.73 0.899) compared wit the usage of a common penalty for each crossing of gap matrices. in terms of prediction accuracy, gfold thus compares favorably also with the leading alternative dp approaches to pseudoknotted structures.  
