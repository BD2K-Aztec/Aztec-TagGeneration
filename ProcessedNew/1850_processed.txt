data and text mining flowai: automatic and interactive anomaly discerning tools for flow cytometry data motivation: flow cytometry (fcm) is widely used in both clinical and basic research to characterize cell phenotypes and functions. the latest fcm instruments analyze up to 20 markers of individual cells, producing high-dimensional data. this requires the use of the latest clustering and dimen-sionality reduction techniques to automatically segregate cell sub-populations in an unbiased manner. however, automated analyses may lead to false discoveries due to inter-sample differences in quality and properties. results: we present an r package, flowai, containing two methods to clean fcm files from un-wanted events: (i) an automatic method that adopts algorithms for the detection of anomalies and (ii) an interactive method with a graphical user interface implemented into an r shiny application. the general approach behind the two methods consists of three key steps to check and remove suspected anomalies that derive from (i) abrupt changes in the flow rate, (ii) instability of signal acquisition and (iii) outliers in the lower limit and margin events in the upper limit of the dynamic range. for each file analyzed our software generates a summary of the quality assessment from the aforementioned steps. the software presented is an intuitive solution seeking to improve the results not only of manual but also and in particular of automatic analysis on fcm data. availability and implementation: r source code available through bioconductor: http://bioconduc tor.org/packages/flowai/ contacts:flow cytometry (fcm) is a laser-based methodology designed to capture the physical and biochemical characteristics of a cell or a particle in a stream of fluid. fluorescence-conjugated antibodies are used to target antigens expressed inside or at the surface of the cells of interest. as cells pass through the laser (excitation), the fluorochrome will change its state of energy and emit a light (emission) that is captured by a series of detectors. fcm applications have been developed mainly for both research and clinical settings in medicine but also for other non-biomedical domains such as marine and plant biology. the most common application is the immune-phenotyping of blood samples and thus the quantification of the number and frequency of various immune cell populations. in hematology, fcm is the technology of choice, as, for example, it requires only few drops of blood to diagnose leukemia through the detection of the perturbation of normal cell frequencies . moreover, fcm helped increase our understanding of cellular functions of the immune system and is widely used in cell cycle analysis, pre-transplant crossmatching, cell sorting, apoptosis, vaccine development and other applications that scrutinize cellular properties. the data are stored in flow cytometry standard (fcs) files that include the fluorescence and scattered light levels for each cell that passed through the laser beams. nowadays it is possible to analyze up to 20 markers at a time in a single staining panel by using an equal number of different fluorochromes detected in separate channels. the common approach used to analyze the data produced by fcm is to visually select cells of interest through 1 or 2 markers known to be highly specific. however, to delineate the high heterogeneity of immune cell populations, it is necessary to look simultaneously at the whole staining panel. principal component analysis has been used to detect the complexity in cd8 t cell populations characterized by intermediate phenotypes that show a continuum of expression of different combinations of cytokines and surface markers . another dimensionality reduction technique called t-distributed stochastic neighbor embedding (t-sne) was successfully applied to identify ambiguous cell populations, including monocytemacrophage intermediates and granulocyte variants in a mass cytometry experiment based on a 38-antibody panel . several computational tools that aim to automatically characterize cell populations without losing multi-dimensional information are constantly developed and periodically benchmarked by the flowcap consortium . undoubtedly, the widest range of tools has been distributed by the bioconductor platform based on the r programming language. the root package for fcm data is flowcore, since it defines the container class and it enables to perform essential manipulations such as compensation and transformation . in addition, a series of complementary packages has been developed for further operations, such as visualization, quality assessment, statistical analysis and automated gating . to accompany and support the large development of automatic methods to define populations, it is crucial to use high quality fcm data as input in order to optimize the robustness of the results. this is especially true since research is looking deeper into the complexity of cell distribution. for instance, target cell sub-populations may represent as low as 0.05 of the total cell population suggesting that minute variation in the quality of the data may lead to false positive results or loss of signal. standardization, calibration and quality control guidelines using beads have been defined to ensure that the signal acquired is the most accurate and with the least variation . nonetheless, these procedures are not always carefully monitored and even having the fcm instrument at optimal conditions before sample processing does not exclude electronic drifts or fluidic instability issues at the time of data recording. an r package, flowq , creates concise reports of quality checks on single and multi-panel experiments to highlight issues that can be encountered in data acquisition. the reports indicate the number of cells, percentage of boundary events and anomalies on the fluidics and signal acquisition over time. another package, flowclean , determines and marks low quality cells using compositional data analysis. in brief, it splits the time in equally sized bins and flags the events that are within time frames containing unusual ratios of cell populations. however, flowq does not actively detect and remove the anomalies and flowclean is poorly intuitive and thus it does not allow to infer the source of the anomalies. we present our package called flowai that provides two solutions, one automatic and one interactive, to discard cells from fcm data that do not reach appropriate quality standards. our workflow adapts and expands previous ideas with methods never implemented before to provide a more objective, efficient and intuitive solution for the quality control of fcm data.over the last few years, we have seen increasing efforts in automatizing pipelines of biomedical data analysis through computational algorithms. fcm is still one technique that hardly abandons the concept of manual analysis since usually the data produced has high variability that requires human interpretation. often, the analysis demands high expertise and the results are still conditioned by a subjective evaluation. our idea was born from the intention of removing the technical variability of fcm data in an objective way, thus reducing subjectiveness in interpretations and improving the performance of downstream computational analyses. this is especially the case when a high number of files is analyzed and when anomalies are generated by multiple sources. we defined an approach and created an r package, flowai, to automatically or interactively detect anomalies in fcm data. first, anomalous patterns and peaks are removed from the flow rate automatically by a method built upon time series decomposition and the1 0 5 0 1 0 0 1 5 0 2 0 0 3 1 5 3 0 4 5 6 0. running time of a quality control analysis with the automatic method of flowai. the graphics creation for the full report, that is fundamental for an accurate examination, takes a considerable amount of time. alternatively, a mini-report containing only the percentages of anomalies is produced without significant running time increase flowaigeneralized esd test. second, the tool checks the stability of the signal over time for each channel; here the automatic method uses a changepoint algorithm to detect durable shifts in the mean or variance of the acquisition values. lastly, the dynamic range of the values acquired for each channel is refined. the upper limit is cleared of the margin events and the lower limit is cleared of the negative outliers. from the use of the flowai package, we expect a general improvement in the quality of research that employs fcm instruments. removing events with erratic intensity values will facilitate different aspects of fcm analysis such as: (i) more effective compensation since the overlap signal is subtracted only from real values; (ii) more accurate detection of rare cells due to the removal of background noise; (iii) easier characterization of the nature of an ambiguous cell population (either as undefined cell type or as technical issue). when using the automatic method for the quality control of a dataset of fcs files, it is preferable to infer the optimal settings for a dataset using a sample of few fcs files. in fact, because of the intuitiveness of the flowai report, it is easy to infer the source of recurrent anomalies in a fcm experiment. subsequently, the automatic method of flowai can be run on the entire dataset with customized settings. lastly, because the automatic quality control might still not meet the expectations for certain fcs files, the checking of the full reports reveals where it is necessary to intervene manually with the interactive method of flowai or with another method. this last point is a limitation of flowai that could be overcome by the dynamic adjustment of the settings of the automatic method, but for now it remains an open question that warrants further investigation. an additional consideration is that flowai is designed to detect anomalies within a single fcs file, hence, other tools are necessary to check for anomalies between batches of fcs files. also, another challenging task is the designing of a complete automatic pre-processing pipeline. in conclusion, our quality control approach produces a comprehensive check of the fcm data implementing algorithms never employed before. we recommend the usage of flowai as a first preprocessing step of the data right after they are obtained from the fcm instrument so that all the downstream analyses, from compensation to detection or rare cells, will benefit from it.  
