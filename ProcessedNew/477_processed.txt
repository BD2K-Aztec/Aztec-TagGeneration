data and text mining args-oap: online analysis pipeline for antibiotic resistance genes detection from metagenomic data using an integrated structured arg-database motivation: environmental dissemination of antibiotic resistance genes (args) has become an increasing concern for public health. metagenomics approaches can effectively detect broad profiles of args in environmental samples; however, the detection and subsequent classification of arg-like sequences are time consuming and have been severe obstacles in employing metagenomic methods. we sought to accelerate quantification of args in metagenomic data from environmental samples. results: a structured arg reference database (sarg) was constructed by integrating ardb and card, the two most commonly used databases. sarg was curated to remove redundant sequences and optimized to facilitate query sequence identification by similarity. a database with a hierarchical structure (type-subtype-reference sequence) was then constructed to facilitate classification (assigning arg-like sequence to type, subtype and reference sequence) of sequences identified through similarity search. utilizing sarg and a previously proposed hybrid functional gene annotation pipeline, we developed an online pipeline called args-oap for fast annotation and classification of arg-like sequences from metagenomic data. we also evaluated and proposed a set of criteria important for efficiently conducting metagenomic analysis of args using args-oap. availability and implementation: perl script for args-oap can be downloaded from https://github. com/biofuture/ublastx_stageone. args-oap can be accessed through http://smile.hku.hk/sargs.the prevalence of antibiotic resistance genes (args) and the escalating threats they pose to public health have attracted worldwide concern . a growing number of organizations and governments have enhanced their monitoring of antibiotic resistant bacteria and args. the world health organization (2014) initiated a global surveillance of antibiotic resistance in 114 countries, with their first surveillance report released in april 2014; the public health agency of canada also provided a 4-year surveillance report on antibiotic resistant organisms inreleased a note titled antibiotic resistance in the environment (2013) and the u.s. white house issued an executive order on national strategy (2014) for combating antibiotic resistance. along with concerns about antibiotic resistance in clinical settings, there has been increased interest in args in the environment. args have been detected in soil , natural waters and sediments , where they are potentially transferable from host bacteria to pathogens by horizontal gene transfer . args are now regarded as emerging pollutants and their dissemination in the environment has attracted much media attention. recently, metagenomic approaches have been applied to the investigation of args in environmental samples.studied the occurrence and abundance of args in 71 environmental samples. their results revealed the diversity and abundance of args in different environments and suggested these genes were not randomly distributed. a study byshowed the influence of anthropogenic activities on the distribution of args in 50 samples from 10 different environments. through network analysis, they proposed tetm and genes coding aminoglycoside resistance as indicators that can be used to quantify other co-occurring args. a more comprehensive investigation of the diversity and abundance of args in various environments would provide insight into the distribution pattern of args, the influence of human activity and the effectiveness of intervention or stewardship programs. any large-scale environmental analysis for args by metagenomic sequencing of environmental samples requires an appropriate analysis method as well as a reference database. several databases and analysis pipelines have been constructed specifically for arg analysis, such as the antibiotic resistance genes database (ardb) , the comprehensive antibiotic resistance database (card) , resfinder , antibiotic resistance gene online (argo) and arg-annot . argo focuses on vancomycin and beta-lactam resistance genes while arg-annot was designed to detect args in bacterial genomes instead of environmental samples. resfinder offers arg detection functions but needs longer query reads. for a sequence to be detected as an arg in resfinder, it must cover at least two-fifths of the length of the matching arg in the database with no less than 50 identity . ardb and card together provide most of the publicly available arg sequences. they are the two most commonly used reference databases in the investigation of args in environmental samples . nevertheless, ardb and card provide only limited online analysis capabilities for metagenomic data. moreover, neither database can provide detailed arg profiles for environmental samples, i.e. classifications of the identified args-like sequences and abundance information for each detected arg type/subtype, which makes it difficult for users to interpret the search results from the huge metagenomic data. here we describe our efforts in developing a structured arg database (sarg) by integrating sequences from ardb and card in a hierarchical structure (type-subtype-reference sequence). using sarg, arg-like sequences obtained from similarity searches can be automatically assigned into different types and subtypes, avoiding tedious manual classification. furthermore, an online analysis pipeline (args-oap) is available using sarg. this pipeline allows users to determine arg profiles from large numbers of environmental samples in a single run. the pipeline aims to exploit the power of metagenomic analysis for better understanding the distribution and dissemination of args in different environments.the time required for the similarity search and the post-alignment analysis has become the limiting factor in metagenomic studies as sequencing costs decrease and data sizes grow . the major goal of the present study was to provide an online platform to shorten the time required for the detection of args and to improve the classification and enumeration of arg-like sequences by constructing a structured database. first, after removing redundant sequences, the ardb and card databases were integrated to provide more comprehensive detection of arg-like sequences in metagenomic data, which will increase the accuracy and completeness of arg profiles from environmental samples with diverse microbial communities. since the search time is dependent on the size of reference database, removing redundant sequences in the two reference databases was an obvious way to reduce the search time without compromising the completeness of the reference database. second, a structured database was established for the integrated database following our previous idea of a structured ardb . this structured database made automatic classification of different arg types and subtypes possible, therefore manual classification is no longer needed. third, the online analysis platform, args-oap, was developed for arg detection applying our previous proposed hybrid approach using ublast and blastx for arg annotation of metagenomic sequence data . the pre-screening of potential arg sequences could filter out most (for args, more than 99.3) irrelevant sequences and significantly shorten the required time for the blastx process on the online platform. moreover, the classification of the identified arg-like sequences was conducted automatically using sarg, which will greatly reduce the required time for post-alignment processing, and automatic generation of pcoa from args-oap may help users with a rapid assessment of differences between the arg profiles in their samples and in other reference environmental samples. given the less-biased nature of metagenomic datasets, utilizing the args-oap, different research groups may compare their datasets in a way that is more consistent than other current approaches, and that can help reveal the distribution of args in different environments. args-oap also supports analysis under different criteria (i.e. evalue, hit length and identity). if the user wishes, these criteria can be adjusted according to their specific requirements via a platform interface instead of using the default setting, i.e. e-value of 1e-7, hit length of 75 of read length (i.e. 25 aa for reads of 100 bp) and identity of 80. our evaluation indicates that the completeness of the database is critical for the comprehensive annotation of args in metagenomic data by similarity search. it is likely that inclusion of additional novel arg sequences would improve performance. the current database of sarg was constructed from the two most widely applied databases, i.e. ardb and card (version on 15 april 2014). it is clear that our integrated structured database does not cover all arg sequences, although it already contains most arg sequences available in public database. thus, as for other gene types, updates with new sequences will be important, as they become available. moreover, annotation evaluation should be repeated when new args sequences are added in the database to achieve accurate annotation for the args profiles in metagenomic data. we believe this pipeline is a powerful method for more comprehensive arg profiles assessment from metagenomic data, and hence lead to methods to reduce arg dissemination to the environment and its dissemination to pathogens.  
