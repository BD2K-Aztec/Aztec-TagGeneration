systems biology optimal metabolic route search based on atom mappings motivation: a key computational problem in metabolic engineering is finding efficient metabolic routes from a source to a target compound in genome-scale reaction networks, potentially considering the addition of new reactions. efficiency can be based on many factors, such as route lengths, atoms conserved and the number of new reactions, and the new enzymes to catalyze them, added to the route. fast algorithms are needed to systematically search these large genome-scale reaction networks. results: we present the algorithm used in the new routesearch tool within the pathway tools software. this algorithm is based on a general branch-and-bound search and involves constructing a network of atom mappings to facilitate efficient searching. as far as we know, it is the first published algorithm that finds guaranteed optimal routes where atom conservation is part of the optimality criteria. routesearch includes a graphical user interface that speeds user understanding of its search results. we evaluated the algorithm on five example metabolic-engineering problems from the literature; for one problem the published solution was equivalent to the optimal route found by routesearch; for the remaining four problems, routesearch found the published solution as one of its best-scored solutions. these problems were each solved in less than 5 s of computational time. availability and implementation: routesearch is accessible at biocyc.org by using the menu command metabolism ! metabolic routesearch and by downloading pathway tools. pathway tools software is freely available to academic users, and for a fee to commercial users. download from: http://biocyc.org/metabolic engineers seek to modify the metabolic network of an organism to efficiently produce novel chemical products, with applications including the production of biofuels and specialized chemicals. the space of potential modifications is a large one given that metabolic databases such as metacyc and kegg contain thousands of enzyme-catalyzed reactions that could be engineered into an organism. how do we balance the cost of engineering the organism against the efficiency of the resulting pathways?the methods we present assume that the users begin with a source (feedstock) compound and a target (product) compound and that they aim to find the optimal metabolic routes that connect those compounds within a genome-scale metabolic reaction network. the methods further assume that the reaction network is annotated with atom mappings, which describe the path of each atom in a metabolic reaction from a reactant compound to a product compound. the methods allow the starting reaction network of the organism to be supplemented with additional reactions from an external reaction library, which for our routesearch program is the metacyc database. routesearch searches for multiple optimal routes where optimality is essentially based on minimizing the number of native reactions of the route, the number of non-native reactions introduced in the route from the external library and the number of atoms lost from the start compound to the target compound according to the atom mappings of the reactions. we believe that these optimality criteria, in particular reducing the loss of atoms from the start compound to the target compound, are likely to provide good route candidates for metabolic engineering. routesearch can also aid scientists in solving a simpler problem than the engineering of new metabolic routes, namely, the understanding of metabolic routes in existing metabolic networks. scientists want to explore alternative routes within an organisms natural metabolic network for transforming a given starting compound into a product compound. we present the algorithm used by the web-based interactive tool routesearch to find optimal metabolic routes. optimality is based on the number of reactions used, the provenance of the reactions (natural or engineered) and the atoms conserved by the route from the source compound to the target compound. as far as we know, it is the first published exact algorithm that guarantees optimality of the routes found based, in part, on the number of atoms conserved from the source to the target compound. routesearch is implemented in common lisp and is available at the biocyc.org web site for any of the 3000 organism-specific metabolic networks within biocyc by using the menu bar command metabolism ! metabolic routesearch, but without use of an external reaction library. metacyc can be used as the reaction library by downloading pathway tools and running it as a local web server. sections 2.1 and 2.2 present the routesearch search algorithm, which is based on the branch-and-bound algorithm applied to a precompiled metabolic network graph that we call a mapped network. the efficiency of the algorithm is discussed, as is its method of using atom mappings to trace atoms conserved in metabolic routes. the atom-mapping data used were to whom correspondence should be addressed. computed by a technique presented inand applied to the metacyc multi-organism database (version 17.5) to produce atom mappings for 410 300 biochemical reactions. these atom mappings are used for all other databases available at the biocyc.org web site. section 3 describes the routesearch graphical interface, which allows users to specify and control routesearch searches and speeds user understanding of the paths found by routesearch, including the atoms that are conserved from source to target compound. section 4 presents an empirical validation of routesearch on five example metabolic-engineering problems from the literature. for three problems the published solution was equivalent to the optimal route found by routesearch; for the remaining two problems the published solution was found by routesearch, but was not the optimal solution. section 4.2 compares routesearch with previous work on metabolic route-searching algorithms. for efficiency, the metabolic route searches are done on mapped networks that are constructed using compounds, reactions and atom mappings. their construction is explained in the following section.  
