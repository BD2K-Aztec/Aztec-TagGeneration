genome analysis sim4db and leaff: utilities for fast batch spliced alignment and sequence indexing the large number of genomes that will be sequenced will need to be annotated with genes and other functional features. aligning gene sequences from a related species to the target genome is an economical and highly reliable method to identify genes; unfortunately, existing tools have been lacking in sensitivity and speed. a program we reported, sim4cc, was shown to be highly accurate but is limited to comparing one cdna with one genomic sequence. we present here an optimization of the tool, implemented in the packages sim4db and leaff. the new tool performs batch alignments of cdna and genomic sequences in a fraction of the time required by its predecessor, and thus is very well suited for genome-wide analyses. availability: sim4db and leaff are written in c, c++ and perl for linux and other unix platforms. source code is distributed free of charge from http://sourceforge.net/projects/kmer/.the number and variety of sequenced genomes will continue to grow spectacularly. the 10 000 genomes project (g10kcos, 2009) alone will catalog and sequence more than 10 000 species from across the spectrum of verterbate evolution, and there are numerous ongoing projects to sequence plants and animals of agricultural importance, or of more specialized scientific interest (plant and animal genome conference; http://www.intl-pag.org/). as sequencing becomes increasingly accessible, one can expect many more groups and even individual investigators to sequence the genome of their studied organism. these genomes will need to be annotated with genes and other functional features. a key resource of gene information are the cdna (mrna, est) sequences already in the databases, which can be readily aligned to a target genome to produce gene models. to further facilitate this comparative annotation approach, an increasing number of projects are producing mixed collections of resources from several related species, which are then used to analyze each of those genomes (the fagaceae genomics project, http://www.fagaceae.org; the genome database for rosaceae, http://www.rosaceae.org).sim4db can be used to align a small or a very large number of pairs of sequences, sequentially (option -pairwise) or as prescribed by a script, or to perform an all-against-all comparison. while the genomic sequences can be chromosomes, a time-saving strategy for genome-wide applications is to use sim4db to refine alignments in regions detected by a less accurate but fast high-throughput mapper, such as gmap or blat.shows a typical user scenario where 92 142 zebrafinch genbank ests were aligned to the recently assembled 1 gb turkey genome (turkey genome). first, sequences were mapped to the genome using gmap in cross-species mode ( x option); then, sim4db realigned each cdna to its matching region extended on both sides by 50 kb (supplementary material s1). asillustrates, adding sim4db produces longer alignments, and leads to more mapped sequences for any coverage cutoff than using gmap alone. overall, sim4db extends gmaps alignments by more than 10 on average, a significant gain in sensitivity. (a more detailed analysis of accuracy, and comparison to other tools, is included in supplementary material s2). we also compared the run time of sim4db versus a standard pipelined invocation of multiple sim4ccs. for this purpose, pairings in the script were sorted by genomic sequence index to minimize computationally expensive accesses to the genome file. thus, each genomic sequence was read the first time its index was encountered, and then reused on subsequent calls involving that index. two tests were performed. in the first test, a perl script read pairs of sequences directly from the multi-fasta files, invoking sim4cc for each pair. in the second test, the leaff utility waswe described a utility, sim4db, for performing batch spliced alignment of cdna and genomic sequences from the same or related species. the tool has the high accuracy of its predecessors, sim4 and sim4cc, but is two orders of magnitude faster, owing to its multithreaded design and fast sequence indexing. sim4db can be invoked from the command line or can be combined with a fast sequence search engine for automated use. compact, fast and accurate, and delivering provenly more accurate alignments than existing tools, we believe sim4db is a much needed addition to every genome annotators repertoire of tools.  
