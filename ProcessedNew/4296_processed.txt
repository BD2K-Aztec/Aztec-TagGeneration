smarts: reconstructing disease response networks from multiple individuals using time series gene expression data motivation: current methods for reconstructing dynamic regulatory networks are focused on mod-eling a single response network using model organisms or cell lines. unlike these models or cell lines, humans differ in their background expression profiles due to age, genetics and life factors. in addition, there are often differences in start and end times for time series human data and in the rate of progress based on the specific individual. thus, new methods are required to integrate time series data from multiple individuals when modeling and constructing disease response networks. results: we developed scalable models for the analysis of regulation from time series (smarts), a method integrating static and time series data from multiple individuals to reconstruct condition-specific response networks in an unsupervised way. using probabilistic graphical models, smarts iterates between reconstructing different regulatory networks and assigning individuals to these networks, taking into account varying individual start times and response rates. these models can be used to group different sets of patients and to identify transcription factors that differentiate the observed responses between these groups. we applied smarts to analyze human response to influenza and mouse brain development. in both cases, it was able to greatly improve baseline groupings while identifying key relevant tfs that differ between the groups. several of these groupings and tfs are known to regulate the relevant processes while others represent novel hypotheses regarding immune response and development. availability and implementation: software and supplementary information are available atseveral methods have been developed for modeling regulatory networks . while most of these methods focus on static networks, recent methods have also been developed for reconstructing dynamic regulatory networks . these methods, which usually integrate time series gene expression data with other types of (often static) genomic data, are specifically appropriate for modeling response and developmental processes that involve several factors that interact with their targets at different time points. to date, such methods have been focused on modeling-specific responses or developmental processes, usually in a model organism v c the author 2014. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.com or a cell line. examples include modeling mouse stem cell development , yeast response to stress , plant hormone response and human t-cell development . in theory, modeling may also be beneficial for studying human development and disease response using time series data collected from individuals. dynamic models provide important information regarding tfs that differentiate good from bad responders for a specific treatment (which may suggest new directions for clinical interventions), identify pathways that are differentially regulated and suggest groupings of patients for further treatment and/or analysis based not only on the observed expression changes but also on the underlying networks that lead to these expression profiles. while modeling dynamic human response networks is an important goal, current methods for reconstructing regulatory networks are not appropriate for this task. unlike model organisms or cell lines, humans differ in their background expression profiles due to age, genetics and life factors. thus, while repeat data from animal studies are usually very helpful, time series data from different human subjects are usually not easy to integrate. in addition, there are often differences in start and end times for time series human data (e.g. the first time a patient sees a doctor for a specific infection may be very different between individuals when considering the actual time an individual has been infected). there are also differences in the rate of progress so that one day for one individual may represent a longer or shorter period for another . finally, there are also several differences in regulatory relationships between individuals which often result from small differences in their genomes . thus, obtaining dynamic, condition and response-specific models from human data is still a major challenge. in this article, we present a new method for inferring dynamic, discriminatory, regulatory networks using static data and time series from multiple individuals. in contrast to previous techniques, our method, scalable models for the analysis of regulation from time series (smarts), uses multiple time series expression experiments (tsees) to identify the underlying regulatory dynamics. smarts aligns the different datasets, determines appropriate modeling time and resolution and uses an iterative procedure to learn groupings and models in an unsupervised manner. following the assignment and modeling phases, smarts proposes new hypotheses (in the form of transcription factor activity) that aim to explain the differences between the groupings it identifies. we applied smarts to human influenza infection and mouse brain development data. in both cases, by relying on regulatory information, smarts was able to greatly improve the assignment of datasets to models compared with a baseline method that only used gene expression data. in addition, smarts identified several tfs as discriminatory between the different groups, some of which are known to be related to the conditions studied and others which represent novel hypotheses.while the major goal of smarts is to learn unsupervised models of gene regulation for groups of individuals or datasets, we initially tested it on a human flu supervised dataset for which we know the correct groupings so that results can be compared with the ground truth. next, we used it to analyze time series data from mouse brain development for which much less is known about the correct groupings.we have presented smarts, a novel algorithm for classifying and modeling tsees. smarts is able to build regulatory models from sets of tsees, and to classify time series into these models. the smarts framework integrates data from many individual gene expression time series with tfgene interaction data, allowing for novel forms of analysis, such as analyzing and classifying human disease time series or modeling the differentiation of tissues during embryonic development. we applied smarts to flu response data and have shown how the modeling framework greatly improves upon baseline clustering. smarts can also point to outlier datasets. in the flu data smarts identified one of the tsees as an outlier indicating that neither of the models is better at explaining this time series when compared with a null model (all genes assumed to have mean 0 and a single standard deviation).presents the model for just the outlier dataset. it appears that the first time point of the dataset is wildly divergent from the later time points. though labeled asymptomatic by, it is clear looking at this individual model that the patient does not resemble either the symptomatic or asymptomatic models in. thus, it appears that our outlier labeling is correct.presents a drem model for the only tsee that smarts misclassified in the flu analysis (smarts labeled it as asymptomatic whereas it is really a symptomatic dataset). this patient, labeled inas patient 15, is the mildest case labeled as symptomatic (as can be seen in their). furthermore, as can be seen in, the patient developed symptoms much later in the time course than the consensussymptomatic model . it seems that a combination of borderline class membership and difficult alignment is the most likely cause of this misclassification. smarts allows the analysis of sets of data at differing levels of granularity. we were able to recover the major fore/hind grouping of brain development when looking at a two-class analysis of developing brain regions. when we performed four-class analysis, we retained this general grouping, but with increasing specificity: two forebrain groups, encompassing different regions of the forebrain, a posterior hindbrain group and an anterior hindbrain/midbrain group. beyond merely building models, our technique allows for the identification of regulatory factors that differ between models. this could allow the discovery of transcription factors that are not just active during a disease, but differentially active in different disease states. this advance will allow for the increasingly granular analysis of regulatory activity in disease progression. smarts is designed to scale, and is multithreaded at its core. though both of the datasets analyzed here contain around 20 individual time series, smarts is capable on running on substantially larger experimentsthe bottleneck is the availability of data. while currently only a few patient datasets exist for our application, we expect the amount of clinical data to increase and such data are often temporal in nature. that said, as we showed in section 3, the method can be applied to non-clinical data (animal models) as well, leading to important insights regarding the grouping of different conditions or tissues based on their regulatory program. one difficulty in methods involving the grouping or clustering of data is the selection of the number of groups to use (in our case, the parameter k). in both of the examples we present, we choose the number of groups a priori: in the case of the human flu data, the number of groups is known (2); in the case of the mouse brain data, we believe we have showed that looking at the data at multiple granularities is valuable. in the scenario where the number of groups is unknown, since we use a likelihood-based algorithm, penalized likelihood techniques such as the akaike information criterion can be used. future work will involve the application of smarts to patient data in a clinical setting, a setting which requires a more sophisticated look at time series alignment. in the clinical setting, the disease onset date is unknown, only known is the date the patient firstrhombomere 10: medullary hindbrain (medulla) collicular (rostral) midbrain tectum: mesomere 1peduncular (caudal) hypothalamus: secondary prosencephalon preoptic telencephalon: secondary prosencephalonrhombomere 11: medullary hindbrain (medulla) isthmus: prepontine hindbrain pretectal tegmentum: diencephalon roof plate of evaginated telencephalic vesicle: secondary prosencephalonrhombomere 2: prepontine hindbrain preisthmic midbrain tectum: mesomere 2 (preisthmus or caudal midbrain)prethalamic tegmentum: diencephalonsubpallium: secondary prosencephalonrhombomere 3: pontine hindbrain preisthmic tegmentum: mesomere 2 (preisthmus or caudal midbrain) prethalamus: diencephalonrhombomere 4: pontine hindbrain pretectum: diencephalon thalamic tegmentum: diencephalonrhombomere 5: pontomedullary hindbrain rhombomere 1: prepontine hindbrain thalamus: diencephalonrhombomere 6: pontomedullary hindbrain rhombomere 7: medullary hindbrain (medulla)rhombomere 8: medullary hindbrain (medulla)rhombomere 9: medullary hindbrain (medulla)each brain region is listed, followed by its ontological categorypresents to the doctor. thus, new techniques must be developed to better align time series with ambiguous start times.  
