sequence analysis funframe: functional gene ecological analysis pipeline pyrosequencing of 16s rdna is widely used to study microbial communities, and a rich set of software tools support this analysis. pyrosequencing of protein-coding genes, which can help elucidate functional differences among microbial communities, significantly lags behind 16s rdna in availability of sequence analysis software. in both settings, frequent homopolymer read errors inflate the estimation of microbial diversity, and de-noising is required to reduce that bias. here we describe funframe, an r-based data-analysis pipeline that uses recently described algorithms to de-noise functional gene pyrosequences and performs ecological analysis on de-noised sequence data. the novelty of this pipeline is that it provides users a unified set of tools, adapted from disparate sources and designed for different applications, that can be used to examine a particular protein coding gene of interest. we evaluated funframe on functional genes from four pcr-amplified clones with sequence depths ranging from 9084 to 14 494 sequences. funframe produced from one to nine operational taxanomic units for each clone, resulting in an error rate ranging from 0 to 0.18. importantly, funframe reduced spurious diversity while retaining more sequences than a commonly used de-noising method that discards sequences with frameshift errors. availability: software, documentation and a complete set of sample data files are available atpyrosequencing of 16s rdna is commonly used to study microbial community structure, and existing bioinformatics pipelines are primarily designed for the analysis of 16s rdna . noise from dna sequencing errors upwardly biases the estimates of microbial diversity . substantial progress has been made to remove noise artifacts from 16s rdna sequence datasets . targeted metagenomics of protein-coding genes offers the possibility of focusing on the diversity, abundance and expression of specific genes, particularly those genes that encode enzymes critical to biogeochemical cycling. protein-coding sequences fundamentally differ from non-coding 16s rdna in that the genetic code implicitly constrains the sequences to the 61 amino-coding triplets. this distinction is particularly relevant with pyrosequencing, as the technology is prone to misread the lengths of long homopolymers, thereby creating the appearance of frameshift mutations. to reduce the inflated diversity bias with proteincoding genes, a commonly used approach discards sequences containing unexpected stop codons . a more nuanced error detection algorithm, hmm-frame, was recently introduced . in hmm-frame, a hidden markov model (hmm) of the target protein, combined with a probabilistic model of homopolymer errors, detects and corrects the frameshifts caused by homopolymer read errors. in addition, the algorithm reports hmm alignment scores, which can be used in downstream quality filtering. to facilitate targeted metagenomics using pcr-amplified protein-coding genes, we produced funframe, a complete bioinformatics pipeline that uses hmm-frame followed by chimera detection, operational taxanomic unit (otu) clustering, rarefaction and diversity estimation (supplementary). additionally, funframe performs clustering and ordination using unifrac and braycurtis metrics (supplementary figs s2 and s3). contrasting with the 16s rdna pipelines qiime and mothur , funframe centers around the r project for statistical computing (r core), which facilitates analysis with a rich set of ecological, statistical and visualization tools .  
