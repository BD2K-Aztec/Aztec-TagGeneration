structural bioinformatics in silico identification software (isis): a machine learning approach to tandem mass spectral identification of lipids motivation: liquid chromatographymass spectrometry-based metabolomics has gained importance in the life sciences, yet it is not supported by software tools for high throughput identification of metabolites based on their fragmentation spectra. an algorithm (isis: in silico identification software) and its implementation are presented and show great promise in generating in silico spectra of lipids for the purpose of structural identification. instead of using chemical reaction rate equations or rules-based fragmentation libraries, the algorithm uses machine learning to find accurate bond cleavage rates in a mass spectrometer employing collision-induced dissociation tandem mass spectrometry. results: a preliminary test of the algorithm with 45 lipids from a subset of lipid classes shows both high sensitivity and specificity.the field of proteomics has enjoyed considerable success in part due to software tools like sequest and mascot , which enable highthroughput identifications of detected peptides (and their corresponding proteins) based on their fragmentation spectra generated by collision-induced dissociation (cid) mass spectrometry. these tools have benefited from the close link between dna and protein sequences and the fact that the polymeric structure of amino acid residues in proteolytic peptides provides a convenient basis for interpreting peptide tandem mass spectra. however, small molecules other than peptides have to be considered as 2d or 3d structures of atoms or functional groups of atoms. these differences require novel algorithms. to date, the main approaches to predict in silico tandem mass spectra are based on either chemical reaction equations, libraries of fragmentation spectra/pathways, or bond cleavage probabilities based upon bond strengths. none of these approaches (briefly discussed below) have shown sufficient accuracy in generating in silico spectra to enable automated and correct identifications of non-peptide small molecules. to whom correspondence should be addressed.chemical reactions involving unimolecular dissociation are commonly studied using the riceramspergerkasselmarcus (rrkm) and quasiequilibrium theories (qet) . chemical reaction time evolutions are described in systems of differential equations as in a master equation approach. these theories are invaluable to understanding chemical reaction mechanisms and energies required for state transitions. yet, while quantum calculations like rrkm and qet explain the dissociation of activated ions, they are insufficient in explaining the activations of ions in inelastic collisions for molecules larger than a few atoms . predicting or identifying fragment ions in tandem mass spectra is difficult for large molecules; indeed, little is known regarding the rates at which ions gain internal energy in activation methods and at which bonds dissociate. a few small peptides such as leucine enkephalin and bradykinin have been empirically studied as to their fragmentation behaviors; however, these results cannot be translated to the fragmentation of non-peptide small molecules . hence, it remains difficult to explain many ions and their intensities in fragmentation spectra or to generate accurate in silico spectra knowing only the molecular compositions. tools such as mass frontier from thermo scientific (highchem, http://www.highchem.com/) and acd/ms fragmenter, (acdlabs, http://www.acdlabs.com/products/adh/ms/ms_frag/) generate fragments using a large library of rules describing fragmentation pathways. this can become unmanageable in that rules are not necessarily exclusiveone rule can affect another rule. sometimes the correct rules are not available entirely or are not available with sufficient specificity. mass frontier generates bar code spectra where all ions have the same intensity because bond cleavage rates are not considered. bar code spectra are not sufficient when many molecules generate the same fragment ions. in these instances, only the relative ion intensities will aid the correct identification.. it may be surmised that many bdes are either not available or sufficiently accurate. thus, defining an accurate algorithm that identifies non-peptide small molecules from cid tandem mass spectra is still an open problem. in a proof-of-principle demonstration, the algorithm presented here shows promise in generating accurate in silico cid tandem mass spectra for identification of lipids, knowing only the molecular structures. that is, the algorithm uses no chemical reaction equations (in which parameters have to be estimated), no fragmentation rules from observed pathways, and no bond cleavage rates provided by bond strengths. instead, the algorithm simulates the fragmentation process in an ion trap mass spectrometer model using a machine learning approach to overcome the difficulties that result from unknown quantities and simplifying assumptions in the cid process. importantly, the algorithm uses a model of the cid process in a linear ion trap mass spectrometer. we believe the model is qualitatively accurate and do not claim that the algorithm describes the actual physical quantities in the variables discussed. the results from a first test using 45 lipids are presented. as a class of non-peptide small molecule, lipids have been extensively studied, providing relatively well-understood fragmentation pathways. as such, they provide a good set for both initial development and testing of the algorithm.a rank test was performed with 45 lipids not included in the training set but which were selected from the same lipid classes/subclasses as those in the training set. the test of each lipid proceeded by first finding the subset of lipids in the in silico spectral library that matched the experimental mass of the precursor ion within 500 ppm. next, the in silico spectra for these subset lipids were compared to the experimental test spectrum and pearson r 2 scores were generated. the subset lipids were sorted in descending order based on these scores.shows the results from screening the spectral library with test lipid ps (18:0/18:1) observed at m/z 790.5 (shows that the first four hits, true positives, have high r 2 s, 0.993 0.996. starting with the fifth hit, the r 2 s fall rapidly, 0.1170.000, and corresponds to false positives. the 45 test lipids within 500 ppm resulted in a total of 808 candidates against the in silico spectral library (a candidate is a hit against one molecule in the database that has a mass within a mass margin of the observed precursor mass).shows the distributions of the true and the false positive r 2 scores for these hits. clearly, most true positives have high scores and false positive have low scores. observe that hits were counted as true positives if they only varied in chirality, locations of double bonds in the fatty acids, or by the distribution of the correct total number of carbons over two fatty acidsinformation that cannot be determined by simple cid ms/ms analyses in positive mode. the test ranked 40 of the 45 test lipids at the top position and five at the second position. these five test lipids were ester lipids which each had one ether lipid from the same class ranked above it. for example, the ester test lipid pc (18:0/0:0), mass 523.3638 da, ranked second after a false positive identification of ether pc (o-19:0/0:0), mass 523.4002 da. these two masses differ by 70 ppm, which is below the mass resolving power of the linear ion trap. the confusion between ester and ether lipids is a result of the training set not having ether lipids. examining the experimental spectra of lpc and pc ester and ether lipids, it appears that the algorithm should learn to separate these subclasses by the relative intensities of the 184-da ion from the head group (discussed in the supplementary data). incorporating the five new ether lipids into the training required the vector lengths to increase from 627 to 738 observed indicesa significant increase. this means that, having only used the 627 indices when the ether lipid in silico spectra were generated for the library, many of the atom types and bond orders did not contribute to predict correct ion intensities. the results presented were from direct injected lipid standards that were identified against a relatively small database. in studies of biological samples using a large database, isis will encounter similar issues as, for example, sequest applied in proteomics, i.e. the fraction of ambiguous identifications is large, multiple species in one spectrum occur frequently, and only a small fraction of the ions are actually recognized as peptides.producing a rank list of candidates consists of comparing the observed mass of the unknown species against the masses of the molecules in the lipidmaps database. the in silico spectra of those molecules with a mass within a specified mass margin are compared to the observed spectrum and squared pearson coefficients are computed between the pairs. each rank list is sorted and written to a file. the preliminary test results presented covers a subset of lipid classes that isis has been trained to recognize. this subset includes most glycerophospholipid classes that are of interest to many in lipid research. in the future, we will extend isis to identify other lipid/metabolite classes. our test only searched a lipid database as would be expected in lipidomics research of biological samples where the lipids have been extracted by the method developed by folch, et al. or a variation thereof .  
