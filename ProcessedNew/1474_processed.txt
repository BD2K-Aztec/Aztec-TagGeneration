gene expression dreme: motif discovery in transcription factor chip-seq data motivation: transcription factor (tf) chip-seq datasets have particular characteristics that provide unique challenges and opportunities for motif discovery. most existing motif discovery algorithms do not scale well to such large datasets, or fail to report many motifs associated with cofactors of the chip-ed tf. results: we present dreme, a motif discovery algorithm specifically designed to find the short, core dna-binding motifs of eukaryotic tfs, and optimized to analyze very large chip-seq datasets in minutes. using dreme, we discover the binding motifs of the the chip-ed tf and many cofactors in mouse es cell (mesc), mouse erythrocyte and human cell line chip-seq datasets. for example, in mesc chip-seq data for the tf esrrb, we discover the binding motifs for eight cofactor tfs important in the maintenance of pluripotency. several other commonly used algorithms find at most two cofactor motifs in this same dataset. dreme can also perform discriminative motif discovery, and we use this feature to provide evidence that sox2 and oct4 do not bind in mes cells as an obligate heterodimer. dreme is much faster than many commonly used algorithms, scales linearly in dataset size, finds multiple, non-redundant motifs and reports a reliable measure of statistical significance for each motif found. dreme is available as part of the meme suite of motif-based sequence analysis tools (http://meme.nbcr.net).it is estimated that the human genome contains 1500 transcription factors (tfs) that play a key role in regulating transcription by binding to the genome alone or in protein complexes . chromatin immunoprecipitation (chip) followed by high-throughput sequencing (chip-seq) is the current method of choice for determining the genomic binding locations of a tf. the resolution of chip-seq location data is such that the actual binding location is typically within 50 bp of the predicted location . a tf chip-seq experiment generally yields hundreds to tens of thousands of predicted locations (often called chip-seq peaks). in addition to providing evidence of direct regulation by the tf proximity to individual genes, the chip-seq data provide a rich resource for exploring the in vivo dnabinding affinity of the chip-ed tf and cofactor tfs that bind dna in complex or nearby, and for discovering the identities of these cofactors. ab initio motif discovery algorithms applied to chip-seq peak regions can usually discover the dna-binding motif of the chip-ed tf. however, most existing algorithms have limitations that make them less than ideal for discovering all the cofactor motifs in a chip-seq dataset. one limitation of many popular algorithms is that they do not scale well to inputs containing thousands of sequences. as a result, many studies to date have used only a fraction (say 500 sequences) of the available chip-seq peak regions for motif discovery, greatly decreasing the chances of discovering motifs for infrequent cofactors. a second limitation is that many algorithms do not provide reliable motif statistics to enable the biologist to discern functional motifs from statistical artifacts. this limitation can cause valid motifs to be ignored, or time to be wasted investigating random motifs. a third limitation is that most algorithms do not allow two chip-seq datasets to be directly compared, finding motifs that are relatively enriched. this limitation makes it difficult to determine whether two tfs always bind as a heterodimer or even if the motif for the chip-ed tf has been found at all. other limitations possessed by some algorithms that make them unsatisfactory for chip-seq data analysis include only finding a single motif or being hard-wired to use a particular type of sequence (e.g. promoters). here, we describe a novel motif discovery algorithm lacking the above limitations, and demonstrate how to use it to mine chipseq datasets for primary and cofactor motifs and for insights into cooperative or indirect binding by tfs. we show that the new algorithm is significantly faster than several algorithms that are commonly used for analyzing chip-seq datasets, yet is able to discover substantially more cofactor motifs. the algorithm searches for motifs expressed as simplified regular expressions (consensus sequences allowing wildcards but not variable length gaps). it achieves speed partly by limiting its search to short motifs (up to 8 bp wide), which turns out to be ideal for identifying and studying the dna-binding motifs of monomeric eukaryotic tfs, but may cause it to miss some wider motifs due to binding by large tf complexes. our new algorithm has some similarities with a few existing, word-based algorithms such as trawler and amadeus ), but our approach is simpler and we demonstrate that it finds substantially more cofactor motifs. consequently, our algorithm complements rather than replaces existing motif discovery tools for the analysis of chip-seq data.focusing on short, core motifs in tf chip-seq datasets appears to be a very profitable approach to understanding patterns of dna binding by tfs. additional insight can also be gained by searching for motifs that are relatively enriched in one chip-seq dataset compared with another. the ab initio discovered motifs can often be associated with the probable tf that binds them by comparison to existing compendia of tf motifs, using expression in the chip-ed tissue and prior knowledge as a filter. the large numbers of motifs discovered by dreme that can be reliably assigned to tfs suggests that unassigned motifs may represent binding by other tfs whose motifs are not yet known. of course, because it is only designed to find short, core motifs, dreme is intended only to complement existing motif finders (such as those tested here). a complete analysis of a tf chip-seq dataset should also include a search for longer, more complex motifs. our motif discovery algorithm incorporates ideas from several existing algorithms (; sinha and tompa, 2003).uses the fishers exact test to measure the significance of enrichment of motifs in two sets of sequences. their motifs are not regular expressions but -balls: the set of words that are within a set hamming distance from a given word. this motif definition treats variations from the consensus word the same, regardless of position within the motif. real tf motifs are less tolerant of variation in certain positions , and this is better captured by regular expressions, which explicitly list all the allowed variations (if any) at each motif position. several algorithms including ymf use regular expressions at some stage in the search for motifs, but differ from our algorithm in other respects. for example, ymf only allows a subset of the iupac wildcards and scores motifs using a different statistical test (z-score). counting the number of sequences (not occurrences) is equivalent to the zero or one occurrence per sequence (zoops) model used by numerous motif discovery algorithms, and finding multiple motifs by erasing is reminiscent of meme . cisfinder also uses the idea of counting words and computing relative enrichment in two sets of sequences, is extremely fast, and can find many cofactor motifs in chip-seq datasets. unlike dreme, however, it requires a motif clustering step to (partially) remove redundant motifs, and cannot be restricted to finding short, core motifs. also, in contrast with dreme, cisfinder reports a p-value for each motif that is not a measure of the significance of the motif, but only of a single word (without wildcards) matching the motif.  
