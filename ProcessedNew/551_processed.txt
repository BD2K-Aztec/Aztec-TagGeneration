gene expression a stochastic expectation and maximization algorithm for detecting quantitative trait-associated genes motivation: most biological traits may be correlated with the underlying gene expression patterns that are partially determined by dna sequence variation. the correlations between gene expressions and quantitative traits are essential for understanding the functions of genes and dissecting gene regulatory networks. results: in the present study, we adopted a novel statistical method, called the stochastic expectation and maximization (sem) algorithm, to analyze the associations between gene expression levels and quantitative trait values and identify genetic loci controlling the gene expression variations. in the first step, gene expression levels measured from microarray experiments were assigned to two different clusters based on the strengths of their association with the phenotypes of a quantitative trait under investigation. in the second step, genes associated with the trait were mapped to genetic loci of the genome. because gene expressions are quantitative, the genetic loci controlling the expression traits are called expression quantitative trait loci. we applied the same sem algorithm to a real dataset collected from a barley genetic experiment with both quantitative traits and gene expression traits. for the first time, we identified genes associated with eight agronomy traits of barley. these genes were then mapped to seven chromosomes of the barley genome. the sem algorithm and the result of the barley data analysis are useful to scientists in the areas of bioinformatics and plant breeding. availability and implementation: the r program for the sem algorithm can be downloaded from our website: http://www.statgen.differential expression analysis often applies to discrete phenotypes (primarily dichotomous phenotypes). the phenotype is often defined as normal or affected. if a phenotype is measured quantitatively, it is often converted into two or a few discrete ordered phenotype so that a differential expression analysis or an analysis of variances (anova) method can be applied . it is obvious that such to whom correspondence should be addressed. discretization is subject to information loss. the current microarray data analysis technique has not been able to efficiently analyze the association of gene expression with a continuous phenotype . pearson correlation between gene expression and a quantitative trait has been proposed .ranked genes according to the correlation coefficients of gene expression with mmse, a quantitative measurement of the severity of alzheimers disease (ad), and detected many genes that are associated with ad.used a within family correlation analysis to remove the effect of family stratification. pearson correlation is intuitive and easy to calculate. however, it may not be optimal because (i) the correlation coefficient may not be the best indicator of the association; (ii) higher order association cannot be detected; (iii) data are analyzed individually with one gene at a time; and (iv) the method cannot be extended to association of gene expression with multiple continuous phenotypes.investigated the association of gene expression with six malting quality phenotypes (quantitative traits) of 10 barley cultivars. they compared the distance matrix of each gene expression among the 10 cultivars with the distance matrix calculated from the phenotypes of all six traits using the g-test statistic. the g-test statistic was designed to measure the similarity between two matrices. for each gene, there is a distance matrix (based on the expression levels). for the phenotypes of six traits, there is another distance matrix. the two matrices are compared for the similarity. if the similarity is high, the gene is associated with all the six phenotypes. eventually, the associations of the phenotypes with all the genes are evaluated. the distance matrix comparison approach may have the same flaws as the correlation analysis. recently, we proposed to use the regression coefficient of the expression on a continuous phenotype as the indicator of the strength of association . instead of analyzing one gene at a time, we took a model-based clustering approach to studying all genes simultaneously.extended the model-based clustering algorithm to capture genes having higher order association with the phenotype. the model-based clustering analysis classifies genes into several clusters and all clusters share the same variancecovariance structure. the analysis is implemented via the expectationmaximization (em) algorithm . several problems have been encountered for this method. one is the identifiability problem where the cluster labels can be exchanged among different clusters. the other problem occurs when two or more clusters often have the same cluster mean. these two problems can be avoided by introducingpage: 64 6369we adopted a new statistical method (sem) for quantitative trait associated microarray data analysis. we used the method to analyze 22 840 microarrayed genes associated with eight quantitative traits in barley. many genes have been identified to be associated with these traits. the actual functions of these genes in barley are not known prior to this study. these genes are provided in supplementary table s2 (sheet1sheet8) and supplementary. for example, among the 22 840 genes, 888 are related to grain protein content. this dataset provides much information for barley biologists to further study these genes. the functions of some genes are known in rice. for example, according to blastx results, transcript 22 767 (rbah35f01_s_at) is the code for the cyclopropane-fatty-acyl-phospholipid synthase in rice. this gene is strongly associated to the grain protein in barley, with an f-test statistic of 1436.718 and a p-value of zero. the same sem algorithm for phenotype associated microarray data analysis has been applied to eqtl mapping with virtually no modification. the eqtl mapping conducted was still an interval mapping approach where one marker is analyzed at a time. however, all the transcripts were analyzed simultaneously. this is already a significant improvement over the traditional interval mapping for qtl where one transcript was analyzed at a time . results of the eqtl analysis are provided in supplementary table s4 (sheet1sheet8) and supplementary(sheet1sheet8). this dataset will help barley biologists to infer gene networks for these quantitative traits. transcripts simultaneously associated with one marker belong to the same network (or pathway) because they are all controlled by the segregation of the same locus. for example, marker abc152d (83.1 cm) on chromosome 2 controls the expression of about 50 of the transcripts associated with the grain protein. these transcripts are allegedly to be in the same pathway for the development of grain protein. theoretically, the method can analyze all markers simultaneously using a single model. this is the all-transcript-and-all-marker model. practically, however, it is difficult to handle the large matrix with a dimensionality repeatedly in the sem algorithm. the theory is identical to the joint analysis of all the eight traits (a matrix). further study on this simultaneous analysis is needed for the sem algorithm. the mcmc implemented bayesian eqtl mapping can be adopted here, but it is a sampling based method and is time consuming in terms of computing time. this study focused on the sem algorithm for phenotype associated microarray analysis with the eqtl mapping as an example of extension to other problems. finally, the data were analyzed using an r program, which can be downloaded from our laboratory website (www.statgen.ucr.edu) under the phenotype associated microarray section. a sample dataset (subset of the barley data) is also provided in the website for interested users to test the method. users may customize the code to analyze their own data using the sem algorithm.  
