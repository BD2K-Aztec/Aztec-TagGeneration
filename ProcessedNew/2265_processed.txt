genetics and population analysis icall: a genotype-calling algorithm for rare, low-frequency and common variants on the illumina exome array motivation: next-generation genotyping microarrays have been designed with insights from 1000 genomes project and whole-exome sequencing studies. these arrays additionally include variants that are typically present at lower frequencies. determining the genotypes of these variants from hybridization intensities is challenging because there is less support to locate the presence of the minor alleles when the allele counts are low. existing algorithms are mainly designed for calling common variants and are notorious for failing to generate accurate calls for low-frequency and rare variants. here, we introduce a new calling algorithm, icall, to call genotypes for variants across the whole spectrum of allele frequencies. results: we benchmarked icall against four of the most commonly used algorithms, gencall, opticall, illuminus and genosnp, as well as a post-processing caller zcall that adopted a two-stage calling design. normalized hybridization intensities for 12 370 individuals genotyped on the illumina humanexome beadchip were considered, of which 81 individuals were also whole-genome sequenced. the sequence calls were used to benchmark the accuracy of the genotype calling, and our comparisons indicated that icall outperforms all four single-stage calling algorithms in terms of call rates and concordance, particularly in the calling accuracy of minor alleles, which is the principal concern for rare and low-frequency variants. the application of zcall to post-process the output from icall also produced marginally improved performance to the combination of zcall and gencall. availability and implementation: icall is implemented in c for use on linux operating systems and is available for download atstatistical algorithms have automated the process of calling the genotypes in large-scale microarray genotyping where up to 5 million variants can be assayed simultaneously. this process has been predominantly applied to probes that query two possible allelic outcomes at a genomic variant (generically defined as allele a and allele b), and the degree of hybridization to each of the two alleles is reflected by the fluorescence intensity. translating both sets of allelic hybridization intensities thus allow discrete decisions to be made with respect to whether the genotype of a sample at a particular single nucleotide polymorphism (snp) should be aa, ab or bb. occasionally, when the hybridization intensities do not offer sufficient support for one of the discrete calls, a null call can be made, which is subsequently treated as missing. numerous algorithms have been developed to call genotypes for earlier generations of microarrays on both the affymetrix and illumina platforms. they can be broadly classified into five categories: (i) single-sample single-snp calling such as the dynamic model , where only the intensity measurements at each snp are considered, disregarding whether there were other samples genotyped at the same time; (ii) multi-sample single-snp calling such as the gencall (in the proprietary software beadstudio and genomestudio) and illuminus , where the intensity measurements at each snp across multiple samples are jointly considered in a cluster analysis framework to learn about genotype cluster characteristics before making the calls; (iii) single-sample multi-snp calling such as genosnp , which does not rely on parameters derived from multiple samples; (iv) hybrid calling such as opticall , where a prior distribution is generated using multi-sample and multi-snp data even though the actual calling is performed within each snp; and (v) linkage disequilibrium-aware calling such as mams and the approach by browning and colleagues , where the signal intensities from multiple snps are jointly evaluated using the correlation structure between snps to improve the accuracy of the calls. early generations of genotyping microarrays prioritized tagging snps identified from the international hapmap project that are selected on their ability to provide adequate coverage of the human genome in the hapmap populations, and are typically common snps with minor allele frequency (maf) that exceeded 5. the design of nextgeneration genotyping microarrays has been guided by the data from the 1000 genomes project and other whole-exome sequencing studies to increase genome coverage and to include low-frequency and rare variants (defined as snps with maf to whom correspondence should be addressed. between 1 and 5, and snps with maf51, respectively) that are often ancestry-specific . although genotype calling for these next-generation arrays similarly relied on translating the hybridization intensities (and b), the lower allele frequency spectrum of the majority of these snps presents a significantly different challenge, where only a small fraction of the samples is heterozygous and there is usually no homozygous cluster for the alternate allele (and d). this can thwart algorithms that perform multi-sample calling, as these algorithms, regardless of whether they are maximum likelihood-based or rely on bayesian models, often set out to locate three genotype clusters. shifts in the positions of the genotype clusters due to intrinsic hybridization chemistry for a fraction of the snps can compound the problem of multi-sample genotype calling (and f). in recognition of the challenges associated with calling the genotypes for rare snps, a novel 2-stage calling strategy (zcall) was introduced to post-process the genotype calls from a default calling algorithm such as gencall . this relied on calibrating the positions of the other two genotype clusters on the basis of the dominant homozygous cluster to improve the accuracy and call rate. in practice, the genotypes for bulk of the snps can be accurately determined with straightforward rules in partitioning the distinctively different hybridization intensities. however, snps with lower maf or with shifted intensities will not conform to these simple rules and instead require more sophisticated statistical strategies to accurately call genotypes. here, we introduce a new genotype calling strategy for illumina arrays, icall, which performs multi-sample calling at a single snp to improve accuracy across the full allele frequency spectrum. this algorithm adopts the classical three-component students t-mixture model framework that illuminus adopts, but focuses on deriving appropriate penalties to find the best seeding parameters to initialize the expectationmaximization (em) procedure to recognize the variety of situations where calling becomes difficult, such as when (i) the maf is low; (ii) the total number of samples for joint calling is small; or (iii) the hybridization intensities deviate substantially from usual. our method icall is benchmarked against four of the most commonly used single-stage algorithms (opticall, illuminus, genosnp and gencall) as well as different iterations of two-stage calling with zcall, with a large dataset of 12 370 samples that have been genotyped on the illumina exome chip, where 81 samples have been additionally whole-genome sequenced on illumina hiseq 2000 at a deep coverage of 30-fold. the sequencing calls for these samples were used to derive a set of gold standard calls for calculating calling accuracy. our algorithm has been implemented in a c program that is available for public access.the performance of icall was compared against four single-stage genotype calling algorithms: gencall, opticall, illuminus and genosnp. intensity data were available for 12 370 samples that have been genotyped on the illumina exome chip, of which 348 samples came from the singapore integrative omics project (iomics) and 12 022 samples came from multiple complex disease studies that are being carried out at the genome institute of singapore. to compare the performance of different genotype calling algorithms, we need to derive a set of gold standard calls that we subsequently assumed to be perfect for benchmarking the genotype calls made by different algorithms. of the 348 iomics samples, 81 samples have been additionally whole-genome sequenced to a target coverage of 30-fold as part of the singapore sequencing studies (http://www.statgen.nus.edu.sg/), and the sequence calls after quality checks for these samples were regarded as the gold standard calls that were subsequently used to benchmark the performance of the different methods. a total of 16 428 snps were present on the exome chip that overlapped with the polymorphic variants identified from the high-coverage sequencing. these snps were classified as common (maf ! 5, 13 542 snps), low frequency (1 maf55, 1356 snps) and rare (maf51, 1530 snps) according to the gencall genotypes for all 12 370 samples. to evaluate how the number of samples available for joint calling impacts the algorithms, we thinned the dataset into four smaller sets with 500, 1000, 3000 and 5000 samples, which always included the 81 samples with gold standard calls. note that gencall genotypes were available for the 348 iomics samples and 12 022 samples independently, and genosnp is a singlesample caller where the performance is not affected by the size of the available samples. the performance of icall, gencall, opticall, illuminus and genosnp is evaluated using five metrics: (i) call rate, defined as the percentage of valid genotype calls that are not assigned as null; (ii) concordance, defined as the percentage of valid genotype calls that are identical to the gold standard calls; (iii) overall concordance, defined as the percentage of genotype calls out of all possible calls that are identical to the gold standard calls, and is calculated as the product of the call rate and the concordance; (iv) minor allele concordance for rare and low-frequency snps, defined as the percentage of the heterozygous and minor allelehomozygous calls that are identical to the gold standard calls out of the total number of such calls made for these snps; and (v) missed minor allele call rate, defined as the percentage of the heterozygous and minor-allele homozygous calls that are not identified out of the total number of available minor allele calls in the gold standard. the last two metrics effectively evaluate the true-positive and false-negative rates for making a genotype call involving at least one minor allele at a rare or low-frequency snp. the calculations of all five metrics are made using only the 81 samples for which there are gold standard calls available. on the basis of call rates and concordance with the gold standard calls, icall yielded the highest overall concordance rate and call rate regardless of the sample size . we observed that gencall yielded the highest concordance rate but tend to be more conservative at making calls, but still managed to deliver an overall concordance rate that was consistently higher than the performance by opticall. the performance of illuminus and genosnp were comparatively less satisfactory, with genosnp yielding an overall concordance rate that was below 97. when evaluating the ability to correctly call genotypes carrying at least one copy of the minor allele that is present in the dataset at a frequency 55, icall consistently yields the highest accuracy and the lowest missed allele calls compared with gencall, opticall, illuminus and genosnp at low-frequency snps . for example, icall achieved a minor allele concordance rate of 97.140 and 97.168 at the sample sizes of 500 and 12 370, respectively, compared with opticall at 96.932 and 97.033, respectively, and the next-best performing algorithm (gencall) at 97.083 on the basis of 348 samples. at rare snps, icall similarly delivered the highest minor allele concordance rates across all sample sizes considered (at least 97.435, with all other methods delivering concordance 597). this suggests that whenever icall made a call involving a minor allele, it was more likely to be correct than existing algorithms. however, a high minor allele concordance can be achieved by a conservative algorithm that only calls the easy-to-call minor allele genotypes but misses out on most of the genuine minor allele calls. we additionally evaluated the extent that each caller is missing genuine minor allele calls. for low-frequency snps, icall consistently exhibited the lowest missed minor allele call rate (with a maximum of 2.915), compared with 2.958 for gencall and 3.029 for opticall with 12 370 samples. however, for rare snps, icall was more conservative and made less minor allele genotype calls than opticall, especially when the sample size is large (missed minor allele call rate of 3.280 and 2.967 for icall and opticall, respectively) although the genotype calls by icall are much more likely to be correct (concordance of 97.546 by icall versus 94.166 by opticall). as the number of samples available for joint calling increases, opticall appears to be more liberal at making minor allele calls, whereas icall appears to be stable. gencall, illuminus and genosnp consistently performed poorly when measured with these two minor allele metrics. zcall is a post-processing caller that uses intensities and genotypes generated from a stand-alone caller as input data. we also compared the performance of gencallzcall, opticallzcall and icallzcall . the results indicated that zcall always improved the genotype calls generated from all the three callers, with the greatest degree of improvement observed for gencall genotypes. across all snps, gencallzcall yielded marginally higher overall concordance rates (97.684 and 97.683 at sample sizes of 500 and 12 370, respectively) compared with those by icallzcall (97.681 and 97.683, respectively). however, at low-frequency and rare snps, icallzcall outperformed gencallzcall, delivering higher concordance rates and lower missed call rates for minor allele genotypes. opticallzcall exhibited the same characteristics as opticall, where it is more aggressive in calling minor allele genotypes but at the expense of making more erroneous calls.we have introduced icall, a method for calling genotypes that yields comparatively better performance than existing genotype calling algorithms, particularly in accurately calling the genotypes involving minor alleles at low-frequency or rare snps. one important aspect of genotype calling is that determining the genotypes accurately is straightforward for the majority of the snps, but there are snps where the maf are considerably lower or when the hybridization profiles differ from the usual that require more robust considerations to accurately determine the genotypes. our method improves on the framework of illuminus by using a series of penalty functions to identify the optimum parameters to seed the em model. the availability of a large dataset that has been genotyped on the exome chip meant that we can evaluate the performance of existing algorithms across different sample sizes. we have benchmarked the genotype calls obtained from different methods against a set of gold standard calls that was derived from deep sequencing. as a stand-alone caller, icall performs the best in terms of delivering the most accurate genotype calls while minimizing the number of missed calls, particularly for genotypes involving minor alleles at low-frequency and rare snps. the better performance at low-frequency and rare snpswas similarly observed when icall was incorporated as part of a two-stage calling process with zcall. we have compared icall against existing methods using two additional metrics that specifically focused on the ability to call the genotypes that involved at least one minor allele at rare and low-frequency snps. this is in line with the intended purpose of the exome microarray for finding low-frequency or rare snps that are associated with phenotypes. measuring how accurately and sensitively a calling algorithm can call a heterozygous or minor allele-homozygous genotype is thus more important. after all, an algorithm that erroneously calls a rare snp as major-allele monomorphic will have attained a concordance of at least 98. in quantifying the association evidence at rare or low-frequency snps, it is common to pool allele counts across similar snps in a genomic region to assess allelic burden . erroneously calling the presence of a minor allele genotype, or the failure to call a minor allele genotype when it exists can thus directly impact the power and false-positive rate of the association analyses. automated algorithms for calling genotypes have contributed to the success of large-scale genomic studies, and this is likely to continue with the continuous introduction of next-generation genotyping microarrays designed with knowledge gained from large-scale sequencing studies, querying up to 5 million snps across the genome or variants found specifically in the exons. although these technologies provide the opportunity to investigate new hypotheses on the evolution of the human genome and the genetic etiology of diseases and traits, this can only happen if the content in the human genome can be accurately determined. we have introduced a calling algorithm that provides a better ability at accurately calling genotypes for rare and low-frequency snps, and consistently performs well at common snps.  
