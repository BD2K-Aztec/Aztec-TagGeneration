sequence analysis reference-independent comparative metagenomics using cross-assembly: crass motivation: metagenomes are often characterized by high levels of unknown sequences. reads derived from known microorganisms can easily be identified and analyzed using fast homology search algorithms and a suitable reference database, but the unknown sequences are often ignored in further analyses, biasing conclusions. nevertheless, it is possible to use more data in a comparative meta-genomic analysis by creating a cross-assembly of all reads, i.e. a single assembly of reads from different samples. comparative meta-genomics studies the interrelationships between metagenomes from different samples. using an assembly algorithm is a fast and intuitive way to link (partially) homologous reads without requiring a database of reference sequences. results: here, we introduce crass, a novel bioinformatic tool that enables fast simple analysis of cross-assembly files, yielding distances between all metagenomic sample pairs and an insightful image displaying the similarities. availability and implementation: crass is available as a web server at http://edwards.sdsu.edu/crass/, and the perl source code can be downloaded to run as a stand-alone command line tool.the sequencing of environmental samples has disclosed a universe of novel microbial organisms. microbiologists and virologists are sequencing dna and rna from environments ranging from coral reefs to the human gut and are discovering previously unknown microorganisms in all these samples . the fraction of unknown sequences can be particularly high in viral metagenomes because (i) viruses exhibit relatively high mutation rates resulting in distant unrecognizable homology , and (ii) this superkingdom has remained poorly explored, with relatively few sequences present in the databases. these properties hinder the comparison of metagenomic samples with high percentages (up to 6099) of unknowns by traditional methods that map sequencing reads to known annotated references . in addition, the abundance and diversity of viruses in natural systems impede comparisons between metagenomic datasets, especially when comparing relatively short reads generated by some second-generation sequencing platforms. a promising solution is to initially combine the different metagenomes and perform a de novo assembly of all sequence reads. if applied conservatively to avoid chimerization, metagenome assembly can reliably link reads that are completely unknown to reads that have similarity to annotated sequences. the tool phage communities from contig spectra (phaccs) assesses the biodiversity of uncultured viral communities by mathematically modeling the community structure using the contig spectrum of metagenome assemblies . phage communities from contig spectra was extended to assess cross-assemblies in a tool called maxi . because they do not rely on a database with reference sequences, these tools provide an approach for comparing complete metagenomes, even if they contain a high fraction of unknown sequences. here, we present crass, a novel more direct approach based on the same concept, i.e. using cross-assembly of reads from different metagenomes to assess the degree of similarity between the sampled communities. thus, cross-metagenome assembly enables a sensitive comparison of entities that are shared between samples, including viruses with no homology to known sequences. unlike previous methods, crass calculates a pairwise distance score between metagenomes and creates an insightful image to display these distances graphically. moreover, a crossassembly combines short sequencing reads into longer contigs that may be more suitable for annotation. for example, downstream analyses could include sensitive homology searches , rna structure detection and prediction of alternative genetic codes . to whom correspondence should be addressed. the author(s) 2012. published by oxford university press. this is an open access article distributed under the terms of the creative commons attribution license (http://creativecommons.org/licenses/by/3.0), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.it is expected that metagenomes from a similar environment share a larger fraction of microbial or viral species than metagenomes from different origins. these shared metagenomic entities can be reconstructed by cross-assembly of the metagenomes and analyzed and visualized using crass. the contigs that link two samples (cross-contigs) directly represent the similarity between those samples. if most contigs are composed of a mix of reads from different samples, then it may be concluded that there are many shared entities among those samples. conversely, if contigs are predominantly composed of reads from either one of the samples, but there are few cross-contigs, these samples are highly dissimilar in composition.determining the interrelationships between metagenomes from different biomes or different time points is important to understand the microbial world around us. mapping metagenomic sequences to a reference database of known genes is a feasible approach to transfer taxonomical and functional annotations to sequence reads. however, it can limit the amount of data that can be analyzed because the majority of the sequencing reads in difficult-to-annotate datasets, such as viral metagenomes from biomes other than the human microbiome, lack known homologs . a promising alternative is referenceindependent comparative metagenomics. we present crass, an intuitive approach for comparative metagenomics that calculates a similarity signal using shared entities, which are identified by cross-assembly. the tool does. in cladograms of nine simulated metagenomes, those containing actinobacteria (n 3) mostly form a separate cluster from those containing firmicutes (n 6; supplementary). the length of the separating internal branch is plotted with increasing proteobacteria contamination, until the actinobacteria and firmicutes metagenomes no longer form separate clusters, and there is no internal branch. see text for details. the cladograms created by crass are available in supplementary3229comparative metagenomics using cross-assembly: crass not depend on homology of the sequenced reads to any known sequence in a reference database, or even on full-length homology of the reads to one another. assembly algorithms, such as those used to create the ace files required for crass analysis, identify shared subsequences (long or signature k-mers) between reads to assemble them . because it relies on a different similarity signal, this long k-mer approach is complementary to the use of short k-mer profiles . we expect that equations (1) and(2) can be applied for qualitative comparisons between environments because they only take the degree of shared entities (cross-contigs) into account. conversely, equations (3) and (4) will be more suited for quantitative comparisons because they consider the read counts as a measure of abundance. although limited in scope, our current results based on analyses of simulated metagenomic samples suggest that the distance formula wootters] may outperform the other formulas for detecting both qualitative and quantitative signals, with similar performance as the comparisons based on dinucleotide odds ratios . nevertheless, it is difficult to predict which of the distance formulas presented in this article will be the most suitable for which biological application. that is why we have created a user forum at seqanswers , available through the crass web site, where we hope that users will share their experiences and any publications that use crass. an additional advantage of using cross-assembly is that the sequences of biological entities, which are shared between specific samples, are simultaneously assembled. based on the results obtained using simulated data (supplementary file 2), we expect that fragment assemblers developed for ests, such as mira, or specialized metagenome assemblers will be more suitable for cross-metagenome assembly than assemblers like newbler, which are optimized for single-genome assembly. if the parameters of the assembly program are set to strict values to avoid chimerization, tentative taxonomic annotations may be transferred between reads that are linked within one contig. we recommend using parameter settings that the user is comfortable with for metagenomic assembly, but it should be noted that the resulting crass cladogram is based on a similarity score between entire metagenomes, which limits the effect of possibly rare chimerical sequences. moreover, chimerization may be problematic between closely related species, but less severe for more distant organisms. thus, although they will add some noise to the similarity signal, chimeras are more likely to link reads from biomes that are already similar, alleviating errors in the final cladogram. to address the issue of potential chimerization, we recommend creating separate cross-assemblies and crass cladograms with stringent and permissive assembly parameters, which will lead to fewer and more chimerical contigs, respectively. the resulting cladograms can then be compared to evaluate the effect of chimerization on the cross-assembly analysis. in general, we have seen that the cladogram rarely changes with altered assembly parameters, indicating that crass is a robust approach for comparative metagenomics.antarcti c lake summe r h u m a n n a s a l f 1 h u m a n fe c a l n 4 huma n fecal n2 h u m a n fe c a l n 5hum an fecal n3 h u m a n fe c a l n 1 h u m a n n a s a l f 2hum an nasa l f3. cladogram representing the distance between metagenomes based on the fraction of cross-assembled contigs between all sample pairs. crass creates this cladogram from a distance matrix using bionj and visualizes it using drawtree . this cladogram was based on equation (1). the complete output for this dataset, including distance matrices and cladograms based on the other distance formulas, can be retrieved  
