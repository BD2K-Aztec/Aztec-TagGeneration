how networks change with time motivation: biological networks change in response to genetic and environmental cues. changes are reflected in the abundances of biomolecules, the composition of protein complexes and other descriptors of the biological state. methods to infer the dynamic state of a cell would have great value for understanding how cells change over time to accomplish biological goals. results: a new method predicts the dynamic state of protein complexes in a cell, with protein expression inferred from transcription profile time courses and protein complexes inferred by joint analysis of protein co-expression and proteinprotein interaction maps. two algorithmic advances are presented: a new method, dhac (dynamical hierarchical agglomerative clustering), for clustering time-evolving networks; and a companion method, match-em, for matching corresponding clusters across time points. with link prediction as an objective assessment metric, dhac provides a substantial advance over existing clustering methods. an application to the yeast metabolic cycle demonstrates how waves of gene expression correspond to individual protein complexes. our results suggest regulatory mechanisms for assembling the mitochondrial ribosome and illustrate dynamic changes in the components of the nuclear pore.current views of biological networks and pathways are primarily static, comprising databases of curated pathways or of pairwise interactions, primarily between proteins. many methods have been developed to cluster, partition or segment an interaction network into putative complexes. recent comparisons suggest that hierarchical stochastic block models provide the most accurate reconstruction of real protein complexes from interaction data . these static views, however, fail to capture the rich dynamic structure of a cell. accounting for dynamic changes in protein complexes is crucial to building accurate models of cellular state. high-throughput measurements of protein abundance are possible through label-free quantitative mass spectrometry , but may be limited to the most highly abundant proteins. in contrast, transcript abundance is more readily available and is often used as a proxy for protein abundance. previous methods combined transcript dynamics with interaction databases to create a moving picture of the cell state to whom correspondence should be addressed. under the crude assumption of a fixed number of protein complexes and with ad hoc criteria to match protein complex membership across time points . the problem considered here is also distinct from evolutionary dynamics, where algorithms have been developed to estimate ancestral networks and infer the most likely evolutionary mechanisms . this work, in contrast, uses a rigorous probabilistic framework to translate a hierarchical stochastic block model to the dynamic domain. the number of protein complexes can increase or decrease at each time point, and individual complexes can grow, shrink, or swap components with other complexes. the resulting network dynamics reveals the temporal regulation of cell protein state. the starting point is our previous static clustering method, hierarchical agglomerative clustering, or hac . the hac method maximizes the likelihood of a hierarchical stochastic block model, also known as the likelihood modularity . hac has the appealing features of automatic selection of model size and multi-scale networks views. furthermore, it out-performs leading methods in the task of link prediction, an objective performance metric when true group assignments are unknown. extending hac to dynamic networks requires a solution to the identifiability problem: how complexes inferred at one time point correspond to complexes inferred at other time points. furthermore, transitions of a protein from one complex to another must be permitted by the model, requiring dynamical coupling between network snapshots. in this work we address these points. first, we convert likelihood modularity from maximum likelihood to fully bayesian statistics, which automatically accounts for model complexity and provides well-founded criteria for selecting the correct number of clusters. second, we kernelize the likelihood modularity with an adaptive bandwidth to couple network clusters at nearby time points, similar to methods for regulatory network inference . we term this the dynamical hierarchical agglomerative clustering (dhac) method. finally, we solve the general problem of matching clusters across time points with a new belief propagation method, match-em, that extends expectation-maximization and belief propagation for bipartite matching to consistently match multiple time-evolving clusters. we apply these methods to real biological data to discover the dynamical structure of protein complexes.dynamic network clustering is an increasingly important problem across diverse disciplines. our algorithm optimizes the likelihood modularity, which is asymptotically consistent . other machine learning and physics approaches are based on probabilistic graphical models such as latent dirichlet allocation (lda,). dynamic extensions have been proposed , but prior to our work have been impractical except for very small networks with around 100 vertices and under 10 latent classes. even efficient variational methods such as vbm have scaling that is far worse than a near linear or at least quadratic run time in the number of nodes and edges. our dhac algorithm scales as o(ej lnv ), the same as hac , with a constant prefactor for the number of time points. this provides an excellent trade-off for genome-scale problems. networks considered here with 2000 vertices required about 5 min on a single 2 ghz processor. a full-genome network with 10 000 to 100 000 vertices could be analyzed in a day to a week on single processor, but in practice would be much faster because each time point could be run in parallel. the cluster matching algorithm match-em is a second contribution that provides a solution to the general problem of tracing the evolution of a set of groups or clusters over time. it generalizes a previous belief propagation method for bipartite matching . the bipartite max-product algorithm is exact with a worst-case run-time of o(k 3 ) for k classes. our generalization has an additional linear factor of the number of time points. while it is no longer guaranteed to converge to the exact solution, for biological networks here it converges rapidly with good results. our methods applied to real biological data provide new insight. many transcription time course experiments reveal waves of correlated gene expression, with no standard methods to parse a large set of correlated genes into well-defined protein complexes. the dhac method is a general solution to this problem and provides a multi-resolution view of dynamic expression and organization of the proteome. focusing on specific predicted complexes reveals possible mechanisms of regulation and control. our analysis of the yeast metabolic cycle identifies protein complexes with asynchronous gene expression, which suggests rsm22 as an rna methyltransferase whose early expression may be required to assemble and stabilize the mitochondrial ribosome. our methods permit proteins to switch between complexes over time, which we see in the dynamics of the nuclear pore. hierarchical methods like dhac also provide a natural multi-scale description of complexes, subcomplexes and proteins. a separate challenge is introducing mixed membership, with the same protein serving as a subunit in two distinct protein complexes . several improvements to dhac are possible. previous work showed that the hierarchical structure inferred from static networks corresponds to levels of biological organization, pathway to complex to subcomplex and the fine structure underneath a collapsed complex can also be used to improve link prediction . in the current work, however, we lacked a method to match the dynamically evolving hierarchical structure across snapshots. consequently the focus here is on the bottom-level clusters rather than the hierarchical structure. this work assumes that the population average transcription data is a good representation for the transcriptional state of each cell. in reality, individual cells may differ from the mean. in the yeast metabolic cycle, for example, about half of the cells undergo cell division per metabolic cycle, potentially yielding two distinct cell populations. more advanced methods have been proposed to increase resolution and drive toward single-cell models . direct measurements of protein abundance through quantitative mass spectrometry could improve the analysis and would be intriguing to combine with expression data. for transcription data, protein abundance may be better estimated by a transcriptiontranslation model, p(t) = r(t)p(t), where r(t) is the measured transcriptional abundance, p(t) is the abundance of the corresponding protein and and are production and degradation rates. this model generates exponentially weighted smoothing of protein abundance, similar to the exponential kernel we used for smoothing. since the exponential smoothing kernel already works well, we anticipate that results should be robust to choices of and , with the possibility of using consensus values for most proteins.  
