genetics and population analysis forqs: forward-in-time simulation of recombination, quantitative traits and selection forqs is a forward-in-time simulation of recombination, quantitative traits and selection. it was designed to investigate haplo-type patterns resulting from scenarios where substantial evolutionary change has taken place in a small number of generations due to recombination and/or selection on polygenic quantitative traits. availability and implementation: forqs is implemented as a command line c program. source code and binary executables for linux, osx and windows are freely available under a permissive bsd license: https://bitbucket.org/dkessner/forqs.simulations have a long history in population genetics, both for verifying analytical results and for exploring population models that are mathematically intractable. population genetics simulations can be broadly classified as forward-in-time (e.g. wrightfisher) or backward-in-time (e.g. coalescent). coalescent simulations [e.g. ms , macs , fastsimcoal ] are efficient for simulating neutral sequence data because they only need to track lineages that are ancestral to the sample. although it is possible to simulate certain selection scenarios within the coalescent framework , one must turn to forward-in-time simulations to model selection in a flexible way. many forward-in-time simulators are currently available. most of these simulators use a mutation-centric approach, implemented by storing the mutations carried by individuals in an array. to handle selection, the majority of these simulators assign selection coefficients to individual mutations [e.g. forwsim , fregene , genomepop (carvajal), sfs_code , treesimj (o), slim (, although a few also include support for quantitative traits [e.g. forsim , quantinemo , simupop (.are recent reviews providing a comprehensive comparison of these and other simulators. in many scenarios of biological interest, substantial evolutionary change has taken place in a small number of generations due to recombination and/or selection on standing variation, rather than mutational input. for example, one may be interested in the genome-wide haplotype patterns that emerge from admixture between historically isolated populations or from artificial selection on a quantitative trait. studying these haplotype patterns can be difficult with existing forward-in-time simulators because detailed information about the mosaic haplotype structure of individuals is not readily available, and must be inferred from the output sequences of the simulation and/or stored recombination event data. in addition, forward-in-time simulators that store entire sequences incur a severe trade-off between the size of the genomic regions and the size of the populations simulated. motivated by such examples, we have implemented a new forward-in-time simulation approach that, instead of tracking single-site variants, tracks individual haplotype chunks as they recombine over multiple generations. further, we have designed the simulator for fast simulation of quantitative traits under selection. we have labeled this software forqs (forward-in-time simulation of recombination, quantitative traits and selection). similar approaches have been implemented recently byand byfor the simple selection models with per-mutation fitness effects. the haplotype-based design allows for fast simulation of whole genomes, with efficient memory usage. for example, forqs can easily simulate two populations (size 10 000 each) selected for different optimal trait values, where individuals have human-sized genomes (23 chromosome pairs, 100 mb each), taking 2 s/generation. for comparison, existing forward simulators are limited by the amount of sequence that can be stored in arrays in memory: for the aforementioned 20 000 individuals, 16 gb of memory would permit the storage of only 3.2 million base pairs of sequence per individual, which is an order of magnitude smaller than the smallest human chromosome. the forqs design also preserves information about the haplotype structure of individuals, which allows for immediate identification of genomic regions where individuals share identical-by-descent haplotype tracts. our simulator uses a modular architecture to allow the user to flexibly specify recombination maps, mutation rates, demographic models, quantitative traits and fitness functions. this modular approach facilitates simulation of complicated scenarios and investigation of the resulting haplotype patterns. forqs is currently under active development to support ongoing projects. to whom correspondence should be addressed. the author 2013. published by oxford university press. this is an open access article distributed under the terms of the creative commons attribution license (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.  
