hierarchical block matrices as efficient representations of chromosome topologies and their application for 3c data integration motivation: recent advancements in molecular methods have made it possible to capture physical contacts between multiple chromatin fragments. the resulting association matrices provide a noisy estimate for average spatial proximity that can be used to gain insights into the genome organization inside the nucleus. however, extracting topological information from these data is challenging and their integration across resolutions is still poorly addressed. recent findings suggest that a hierarchical approach could be advantageous for addressing these challenges. results: we present an algorithmic framework, which is based on hierarchical block matrices (hbms), for topological analysis and integration of chromosome conformation capture (3c) data. we first describe chromohbm, an algorithm that compresses high-throughput 3c (hit-3c) data into topological features that are efficiently summarized with an hbm representation. we suggest that instead of directly combining hit-3c datasets across resolutions, which is a difficult task, we can integrate their hbm representations, and describe chromohbm-3c, an algorithm which merges hbms. since three-dimensional (3d) reconstruction can also benefit from topological information , we further present chromohbm-3d, an algorithm which exploits the hbm representation in order to gradually introduce topological constraints to the reconstruction process. we evaluate our approach in light of previous image microscopy findings and epigenetic data, and show that it can relate multiple spatial scales and provide a more complete view of the 3d genome architecture. availability and implementation: the presented algorithms are available from: https://github.com/hit-3c techniques provide a means for studying the genome architecture at a range of resolutions. as oppose to light microscopy, 3c gives a population-based measure that relies on spatial proximity but does not directly convey a spatial context . all 3c derivatives consist of cross-linking nuclei, followed by chromatin digestion and re-ligation. quantifying the number of ligation events between two chromatin fragments gives their contact frequency in the examined population of nuclei, providing a pairwise estimator for their distance. hit-3c methods (most notably, the hi-c method) detect contacts between groups of loci, per chromosome or genome-wide, which are typically summarized in a non-negative matrix called a contact map. analyzing contact maps can reveal different scales of topological organization. at a 1 megabase (mb) resolution, chromatin compartments and sub-compartments were identified with principal component analysis (pca) and clustering further suggested that at shorter length scales (40100 kilobases (kb)), a genomic bin can be assigned with a state which represents its preference to interact with other bins along the sequence (directionality index): upstream, downstream or none. using hidden markov models (hmm) the researchers have shown that the genome can be segmented into regions of bins with the same state, leading to the definition of topologically associated domains (tads, upstream or downstream regions) and their boundaries (none regions). dynamic programming and change point detection were also employed for identifying transitions in contact frequency enrichment which induce a topological genome segmentation. owing to the definition of tads, their position and boundaries can change considerably depending on the sequencing depth and the bin size used . for example, studying hit-3c contact maps at different resolutions revealed that previously identified large tads can be divided into subtads . this hierarchical organization suggests the need for methods that could go beyond the tad-based segmentation and capture topologies at different length scales. hierarchical topologies derived from contact maps can further provide a spatial context for studying point-wise and relational properties (e.g., histone modifications and gene coexpression, respectively). this can in turn uncover associations between spatial organization (structure) and genomic features (function) that could not have been discovered when considering only the proximity of the sequence. such evidence synthesis requires an approach which can relate datasets at different resolutions and link genetic and epigenetic features to the spatial scale at which they work. physics and statistical mechanics have provided valuable lessons about the genome organization. by modelling the chromatin fibre as a polymeric chain of beads, researchers have applied polymer physics to study the expected genome topology and dynamics. in particular, the distance and probability of contact of between beads (loci), given their distance on the sequence, were a subject for much research . measurements obtained with fluorescence in-situ hybridization (fish) and hit-3c experiments were used to motivate and validate hypotheses concerning these properties, respectively, and, together with general characteristics of polymer chain behaviour were used to propose different models of chromatin organization . the increasing volume of hit-3c data calls for the development of algorithms and data structures that can summarize, compress and integrate datasets while considering issues of time and space complexity. such a computational approach can complement physics simulations and provide the necessary framework for large scale studies of the 3d genome architecture and its function. in this paper, we present a hbm-based algorithmic framework for topological analysis and integration of hit-3c data. we first introduce the hbm representation for contact maps and give the necessary definitions (section 2.1). next, we describe chromohbm, an algorithm which compresses a contact map into a hbm by iteratively detecting dense modules (communities) of interacting chromatin segments (section 2.2). we then focus on the application of hbms for 3c data integration. we explain the difficulties involved in directly combining hit-3c datasets and propose to merge their hbm representations instead, using the chromohbm3c algorithm (section 2.3). we also note that spatial inference can benefit from incorporating topological knowledge and describe chromohbm-3d, an algorithm which takes a 3d reconstruction method and iteratively guides it by means of hbm traversal (section 2.4). in order to evaluate our approach, we study hi-c datasets and show that hbms highlight key topologies and that the merged hbm representation can capture multiple scales of spatial organization that could not have been detected by separately analyzing each dataset. for the sake of space, robustness and running time evaluation is given in the supplementary (suppl.) information . additional results of related or exploratory analysis are also available on request.let a and b be two contact maps, h a and h b their hbms, respectively, and h a;b the merged hbm of h a and h b , we would like to test: @bullet is h a;b consistent? if h a;b is consistent then its topology should be in agreement with the separate topologies of h a and h b as well as with previous findings. @bullet is h a;b powerful? if h a;b is powerful then it should add new information, which is not available when independently analyzing h a and h b. also, there should be a clear motivation for not directly comparing a and b (for example, large variation in contact frequency distribution and range). further evaluation of the robustness, consistency and performance (running time) of chromohbm, chromohbm-3c and chromohbm3d is described in the suppl. information (see). in order to evaluate how consistent and powerful separate and merged hbms are, we study two contact maps and their hbms, which considerably differ in their binning: a 500 and a 25 kb contact maps generated from human fibroblasts nuclei for chromosome 1 . we first compare the corrected (de-noised) contact maps. we find that the 25 kb contact map is sparser and that the distributions of the two contact maps are significantly different (onesided t-test (significant differences are observed also when considering non-parametric tests such as the kolmogorov-smirnov test), p-value we assume that n is a natural number 5: h a matrixk; k expand h a 6: for i 1 to k do 7: p i n 8: for j i to k do 9: q j n 10:). the 500 kb contact frequencies range between 0 and 101 500 with a mean of 427.10 and a median of 31.57, while the distribution of the 25 kb contact frequencies is more (rightly) skewed; the 25 kb contact frequencies range between 0 and 6221 and have a mean of 1.074 and a zero median. in order to allow for a more direct comparison, we standardize the two contact maps and compute the expanded version of the 500 kb contact map, using equation 5. testing for agreement between the two standardized contact maps (which now match in their dimensions) yields a low pearson correlation value (r 0.15). put together, the notable variations between the 500 and 25 kb contact maps, make it difficult to integrate them and motivate the use of their hbm representation for this purpose. we next apply chromohbm in order to generate the hbm for each of the contact maps, using the infomap algorithm for detecting communities. this algorithm, which is recognized as a leading approach for community detection in undirected weighted graphs , aims at finding an optimal compression of the information flow in a graph, using random walks as a proxy for the amount of information transferred between nodes. its key idea, inspired by information theory, is that finding a compression that can closely recover the information flow in a graph is equivalent to detecting its topological modules or communities (which dictate the dynamics of the system). in the suppl. information we further show that chromohbm recovers similar hbms, independently of the detection method used (robustness evaluation, see). given their hbms, we apply chromohbm-3c to compute the merged hbm representation of the two contact maps. for description purposes, we use h 500 , h 25 and h merged to denote the 500 kb, 25 kb and the merged hbms, respectively.shows h 500 (enlarged for visual clarity), h 25 and h merged. we notice that some topological patterns that appear in h 500 are missing from h 25 and vice versa. small communities that are detected at the first level of h 25 , are missing or merged in h 500. at the second level, the two hbms detect mega communities that roughly correspond or overlap. these communities are further combined into two large clusters (in blue) at the third level of h 500. this level of hierarchical organization is completely absent from h 25. at the last level (level 5 and level 4 for h 500 and h 25 , respectively), bins which correspond to regions with a poor mappability (and thus poorly covered) are merged with the others to form the global community. from a signal processing point of view (according to the heisenberg uncertainty principle), the observed trade-off, between h 500 and h 25 , is expected. smaller bins can better detect small scale topologies but miss large scale features (good knowledge of frequency but poor knowledge of position). in contrast, larger bins capture large scale organization on the expense of finer details (good knowledge of position but poor knowledge of frequency). h merged accommodates for the distinct scales that are captured by h 25 and h 500 , and provides a multi-scale view of the organization of chromosome 1. its first level matches the first level of h 25 (a small scale topology) while its fifth level roughly corresponds to the third level of h 500 (a large scale topology). at intermediate levels, overlapping features detected by both hbms are combined together, forming a unified view of the separate hierarchies. in order to further evaluate the consistency of h merged , we study active and repressed domains in chromosome 1. these domains belong to a group of regions which appear throughout the genome, termed ridges and anti-ridges, which show distinct functional and structural characteristics. ridge domains are rich with genes and active regulatory elements, and are highly transcribed and expressed (active) . they possess an open chromatin topology which further correlates with their high expression level. in contrast, anti-ridge domains are gene poor, lowly transcribed and expressed and present a close and packed topology (repressed).shows the hbms of chromosome 1, at positions 1.50 10 8 to 1.54 10 8 (green frame, upper panel) and 1.73 10 8 to 1.76 10 8 (red frame, lower panel), which correspond to a ridge and an anti-ridge domain, respectively. for these specific regions, differences in density were also confirmed with fish (distances within the ridge domain shown to be larger than distances within the antiridge domain) . in line with the trend observed when analyzing the entire chromosome, h 25 captures finer topological details compared to h 500. at the first level, the ridge domain of h 25 consists of four communities, which roughly correspond to two communities in h 500. in a similar way, the two communities detected in the anti-ridge domain in h 25 form a single community in h 500. when considering h merged , we find that the anti-ridge domain presents a flatter hierarchy compared to the ridge domain (two levels versus three levels, respectively) with a smaller number of larger communities. this is in agreement with the characteristics of anti-ridge domains, which are more dense than ridgethe merged hbm of the hbms in (a) and (b), generated with chromohbm-3c. this track was retrieved from the ucsc genome browser website (domains. for the ridge domain, the first and third level of h merged closely correspond to the first and second level of h 25 , respectively. the second level of h merged , reveals, however, an additional scale that is missing from h 25 and h 500 ; the last and first two communities (along the diagonal), which are detected at the first level, form one mega community while the other two communities are merged into a second mega community. this topology recapitulates the picks of a regulatory mark (shown as a vertical track next to h merged in), which is associated with a high transcription activity (the h3k27ac histone mark). the first mega community corresponds to h3k27ac picks while the second matches a flat profile. this partition, which is missing from the separate hbms, further illustrates the advantage of a merged view of multiple scales.  
