sequence analysis mipgen: optimized modeling and design of molecular inversion probes for targeted resequencing molecular inversion probes (mips) enable cost-effective multiplex targeted gene resequencing in large cohorts. however, the design of individual mips is a critical parameter governing the performance of this technology with respect to capture uniformity and speci-ficity. mipgen is a user-friendly package that simplifies the process of designing custom mip assays to arbitrary targets. new logistic and svm-derived models enable in silico predictions of assay success, and assay redesign exhibits improved coverage uniformity relative to previous methods, which in turn improves the utility of mips for cost-effective targeted sequencing for candidate gene validation and for diagnostic sequencing in a clinical setting. availability and implementation: mipgen is implemented in c++. source code and accompanying python scripts are available atwhile rare variants and de novo mutations contribute to the genetic basis of complex diseases including intellectual disability , autism spectrum disorders (o), epilepsy and congenital heart disease , the implication of individual genes in these phenotypes typically requires sequencing of large numbers of cases and controls. molecular inversion probes [mips, also known as padlock probes (have proven successful in a broad range of applications, including targeted genotyping , dna sequencing (o), assessing copy number and content , methylation patterns , rna allelotyping and detection of bacteria in clinical samples . mips boast low amortized cost per sample and high scalability (o)characteristics that may allow it to replace sanger sequencing for clinical genetic testing . we recently built upon the mip assay with the introduction of single-molecule mips or smmips: mips with molecular tags to track independent capture events . however, while genotyping accuracy and sensitivity for detecting low-frequency alleles have been enhanced, smmips do not address a key limitation: non-uniformity of capture efficiencies within probe sets. early large-scale experiments that attempted to optimize targeting arm melting temperatures demonstrated substantial non-uniformity across target sites, with longer exons and gc extremes frequently failing capture. dosing mips to compensate for dropout, known as repooling, enables significantly enhanced coverage , but collecting the empirical data for repooling lowers assay turnaround time and expends sequencing resources. previous studies with mip and long padlock probe (lpp) assays were limited in their exploration of possible design remedies, including choosing only high-performing nucleotides at the mip ligation junction, preferring low copy targeting arm sequences and prioritization based on oligonucleotide melting temperatures. work byincorporated dna folding metrics into the neural network-driven framework ppdesigner, and suggests that further modifications to mip design and capture protocols could yield additional gains in coverage uniformity. here we describe an empirically trained design algorithm for mip design that attains our goal of optimizing performance and reducing reliance on empirical testing for developing successful smmip assays.a set of eight genes that had previously been extensively characterized via mip sequencing data (chd8, tbl1xr1, tbr1, dyrk1a, adnp, grin2b, pten and ctnnb1) plus an additional high gc target (shank3) were selected to test the models predictions of mip performance, both on previously designed mips for these genes (o) as well as for a newly designed mipgen set. the new design consisted of 402 smmips with complete tiling of the targeted sites, which were tested alongside the original mip assay on control dna. predictions for the performance of the previous mip designs were correlated with total read counts for both logistic scoring ( = 0.536) and svr scoring ( = 0.540). for smmips, tagged read depth was slightly, but not significantly, more correlated with mipgen scores than total read depth ( = 0.569, p40.05); unsurprisingly given this information, tagged and untagged read depths were highly correlated with each other ( = 0.900). special attention was given to mips with 510 of the average coverage per mip, as these are largely responsible for gaps in coverage. the scores were successful at detecting these low-performing mips, for both logistic (area under the receiver operating characteristic curve of 0.827) and svr (support vector regression); (auc = 0.864) models (supplementary). logistic and svr scores were only slightly more correlated with each other than with total read depth (supplementary). we next analyzed the performance of the new mip assay relative to that of the original set to ascertain the success of the new design algorithm. average coverage per mip in the new set increased 18 over the original set; however, the proportion of the 19 349 targeted bases510 of the median per-base coverage (2668) of the replicates remained unchanged: 23.7 for the original set and 23.8 for the redesigned set. still, uniformity of coverage improved , with the relative standard deviation prior design methodologies were relatively modest, mipgen scores enable stratification of mip targets a priori and in silico with reasonable discriminatory power. in the future, mip scoring may be calibrated with new training sets that can account for advances in mip protocols or match more specialized conditions that entail dna of variable concentration or quality. curated mip/smmip designs per gene may be indicated to facilitate comparison across studies and improve access to validated mip/ smmip assays, and surveying mipgen scores prior to committing to a mip target may serve to maximize the economy of a mip target enrichment approach. more generally, we anticipate that the user-friendly package for mip and smmip design provided in the mipgen package will facilitate its broader use in both research and clinical applications.  
