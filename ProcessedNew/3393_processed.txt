osa: a fast and accurate alignment tool for rna-seq accurately mapping rna-seq reads to the reference genome is a critical step for performing downstream analysis such as transcript assembly, isoform detection and quantification. many tools have been developed; however, given the huge size of the next generation sequencing datasets and the complexity of the transcriptome, rna-seq read mapping remains a challenge with the ever-increasing amount of data. we develop omicsoft sequence aligner (osa), a fast and accurate alignment tool for rna-seq data. benchmarked with existing methods, osa improves mapping speed 410-fold with better sensitivity and less false positives. availability: osa can be downloaded from http://omicsoft.com/osa. it is free to academic users. osa has been tested extensively on linux, mac os x and windows platforms. contact:rna-seq, a high-throughput sequencing technology used to sequence complementary dna, has been widely thought of as a revolutionary tool for transcriptomics study . compared with microarray technology, conventional expressed sequence tag (est) or other tag-based sequencing, it has less sampling bias, higher resolution and much broader expression range coverage . for human, mouse and other mammalian organisms with a relatively well-annotated genome, mapping short reads from next generation sequencing (ngs) to reference transcriptome/genome is usually the first and essential step for rna-seq data analysis. this reference-based approach tends to be more sensitive and computationally efficient than a de novo assembly approach . many tools have been developed in recent years . tophat maps the reads to reference genome using bowtie . the consensus islands are first clustered; the splice junctions are then generated by enumerating the canonical donor and acceptor sites between the neighboring islands for putative introns. rna-seq unified mapper (rum) and rnaseqr align the reads against both to whom correspondence should be addressed. transcriptome and genome using bowtie. the results are merged and the un-mapped reads are further aligned to genome with blat . soapsplice first maps reads to reference genome indexed with burrows wheeler transformation (bwt), and then unmapped reads are aligned again using two segment strategies. mapsplice and splicemap also use similar break and assemble approach for longer reads. we introduce omicsoft sequence aligner (osa), an ultra-fast rna-seq aligner/mapper, different from the majority of existing methods relying on bowtie or bwa, which use a bwt-based index. osa uses a k-mer indexed genome hash table and avoids breaking down longer reads into sub-reads and merging steps, which becomes increasingly computationally expensive with the longer reads from the newer sequencing machines. osa is 410 times faster than popular rna-seq aligners developed and used so far. it works well for both short and long reads and its performance does not deteriorate for high-sequencing error data. osa also significantly improves the ability to detect both short and long indels as well as exon junctions.osa implements various optimization strategies at different stages of mapping pipeline to improve alignment speed and accuracy. all the reference and read sequence matching are achieved through super-fast bitwise operations. for each read, where quality values are available, osa will first scan the reads from 3-end until the first acceptable quality nucleotide is found. this trimming process removes the ambiguous reads at the end and significantly improves the alignments speed . during alignment stage, a seed and extend strategy is used to test each potential matching position. a similar strategy has been used in gsnap and blat . in addition, osa takes advantage of the properties of paired-end reads to filter the alignment results and limit alignment space.we simulated 12 sets of 10 million pairs of paired-end rna-seq reads with three independent simulations at each of four error rates (0, 0.5, 1 and 2) using the beer pipeline . we compare osa with tophat (v1.3.3 and v1.4.0), rum (v1.10) and soapsplice (v1.8) on a four-core 3 ghz amd phenom(tm) ii x4 945 processor desktop with 16 gb ram running opensuse linux (see supplementary methods for details). the speed, the alignment accuracy and the percentage of indels and exon junctions correctly identified are evaluated for different tools either with a gene model or without gene model. osa has superior speed; it is about 410 times faster compared with other tools on linux platform . for all the tools, the alignment speed decreases with error rates; this is expected as the aligner has to try more scenarios for non-perfect matching. osas speed improvement is more dramatic at high error rates . the benchmark results also show that using a gene model slightly improves the alignment speed (except tophat1.3.3) and accuracy (supplementary). when a gene model is provided, osa matches most reads to the correct location of the transcriptome/genome; tophat 1.3.3 is the close second. both algorithms perform well even without a gene model. rum and tophat1.4.0 work much better with a gene model at low error rates and their performances deteriorate when error rate increases to 2 (supplementary). all tools detect 85 of exon junctions. osa, soapsplice and rum have higher sensitivity than tophat. however, osa has much fewer false positives than rum and soapsplice (supplementary). rum has the best sensitivity detecting indels. however, it also increases the percentage of the false positives and decreases the positive prediction value (ppv). tophat detects a much smaller number of indels, this might be improved after integration with the latest bowtie 2.0, which supports indel detection at the alignment stage. osa achieves good sensitivity at detecting indels while controlling the false positives (supplementary). due to sequencing errors (or random error introduced during simulation), one read can match to a different location on the genome with a better or equal matching score. a large portion of these false positives could be attributed to these sequencing/random errors. we tested the junction and indel detecting again after adjusting the metrics for these reads and we can see that the ppv of all tools improves, especially soapsplice and rum. however, the overall detection pattern is still the same (supplementary tables s2b and s3b). we also tested osa against tophat 1.3.3, which performs better than other tools we benchmarked against, with eight randomly selected ngs datasets from ncbi sra. these datasets include both single-and paired-end reads, reads with different length, and from both human and mouse species with various sequencing depths. similar to the simulation outcomes, we find that osa is several times faster than tophat and maps 34 more reads. moreover, it also identifies much more known and novel exon junctions (supplementary).  
