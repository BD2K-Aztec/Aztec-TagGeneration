tax4fun: predicting functional profiles from metagenomic 16s rrna data motivation: the characterization of phylogenetic and functional diversity is a key element in the analysis of microbial communities. amplicon-based sequencing of marker genes, such as 16s rrna, is a powerful tool for assessing and comparing the structure of microbial communities at a high phylogenetic resolution. because 16s rrna sequencing is more cost-effective than whole metagenome shotgun sequencing, marker gene analysis is frequently used for broad studies that involve a large number of different samples. however, in comparison to shotgun sequencing approaches, insights into the functional capabilities of the community get lost when restricting the analysis to taxonomic assignment of 16s rrna data. results: tax4fun is a software package that predicts the functional capabilities of microbial communities based on 16s rrna datasets. we evaluated tax4fun on a range of paired metagenome/ 16s rrna datasets to assess its performance. our results indicate that tax4fun provides a good approximation to functional profiles obtained from metagenomic shotgun sequencing approaches. availability and implementation: tax4fun is an open-source r package and applicable to output as obtained from the silvangs web server or the application of qiime with a silva database extension. tax4fun is freely available for download at http://tax4fun.amplicon-based sequencing of marker genes is widely used for large-scale studies that involve many different sampling sites or time series. the common 16s rrna gene-based analysis is a powerful tool for assessing the phylogenetic distribution of a metagenome but does not provide insights into the communities metabolic potential. therefore, the prediction of the functional capabilities of a microbial community based on marker gene data would be highly beneficial. as a particular difficulty of such a predictive approach for most organisms in marker gene databases the genome and therefore the functional repertoire is not known. for instance, the silva ssu rrna database (silva 115 full release) contains 3 808 884 rrna sequences whereas kegg (release 71.1) only comprises 2982 complete prokaryotic genomes. in a previous study , we introduced a statistical method for predicting the metabolic profiles of a metagenome from its taxonomic composition using a linear combination of precomputed genomic reference profiles. a similar method has been proposed for inference of the community structure from remote sensing satellite image models . in this approach, the average ec number counts of all annotated genomes from a given taxonomic group, e.g. at order level, are used as reference for the linear combination of the community structure at this v c the author 2015. published by oxford university press.we applied tax4fun and picrust to a collection of paired metagenome/16s rrna datasets that have also been used in the original picrust study (see supplementary material section 1.1). before applying tax4fun, the silva-based 16s rrna profiles were computed using the qiime tool or the silvangs web server , respectively (see supplementary material section 2.2 and 2.3). for each paired dataset, the spearman correlation of the whole metagenome and the 16s rrna-predicted relative ko abundance profile was calculated. for the computation of the correlation, we excluded for each dataset all ko profile dimensions that did not contribute any non-zero count in the functional profiles. the resulting correlation coefficients are shown infor the uproc-based functional profiles. using tax4fun, the median of the correlation coefficient varies between 0.8706 (soils) and 0.6427 (guerrero negro hypersaline microbial mat). in comparison with picrust the correlation of tax4fun is significantly higher for all four datasets according to a nonparametric sign test (p-value 0.001). similar results are obtained using the pauda tool for estimation of the functional profiles (see supplementary material section 4.2). further, we compared the coverage of the analysis pipelines in terms of the fraction of reads that were classified by qiime/ silvangs and the percentage of otus that were mapped to kegg organisms using tax4fun. especially for the soil samples, we observed rather low fractions of 16s rrna sequences that were finally used to predict the functional profiles (silvangs: 0.02, tax4fun: 4.78; qiime: 95.21, tax4fun: 55.36). contrary, the coverage for the human microbiome and mammalian guts datasets is rather high for both qiime/silvangs and tax4fun (silvangs: 95, tax4fun 95). in our study, the soil samples are probably the most complex communities under investigation. further, our results revealed that members of the soil communities are poorly represented in the kegg database. however, even when applying silvangs tax4fun, the median of the correlation coefficients was rather high using merely a fraction of the reads to predict the functional profiles. thus, a high correlation coefficient does not necessarily indicate the completeness of the estimated functional repertoire but rather provides a measure of correspondence between the whole metagenome and the 16s rrna-predicted ko abundances. therefore, the prediction accuracy is not a function of sample diversity but rather depends on a good correspondence between organisms in genome and 16s rrna databases. even though a sample is very diverse good predictions can be obtained in case that many of the detected organisms or close relatives are available in both databases. in contrast, the predicted functional profile of samples with large fractions of unknown organisms can be expected to be incomplete due to the low coverage of database reference profiles. thus, the coverage of the taxonomic assignments should always be inspected to check the reliability of the predictions, in particular whentax4fun predicts the functional profile of a microbial community just from 16s rrna sequence data. our approach cannot replace whole metagenome profiling but is useful to supplement 16s rrna analyses in metagenome pre-studies or in situations where shotgun sequencing is prohibitively expensive, e.g. for broad surveys in microbial ecology applications. we evaluated our method on four paired data collections from different habitats and compared it to the picrust tool. the results indicate a high correlation of the predicted tax4fun profiles with the corresponding functional profiles obtained from whole metagenome sequence data. moreover, the results show that tax4fun outperforms picrust on all test datasets. additionally, our results revealed for all datasets a higher correlation between the metagenomic and 16s-predicted functional profiles when using uproc in comparison to the pauda tool (see supplementary material section 3s3). although we provide functional reference profiles from both tools for tax4fun, we recommend the usage of tax4fun in combination with the uproc-based reference profiles for prediction because of the higher sensitivity of uproc. tax4fun allows easy processing of the output from silvangs, qiime or any other analysis pipeline using the silva database as reference. the implementation in r facilitates further statistical analyses of the tax4fun predictions, which can be processed within the same r environment.  
