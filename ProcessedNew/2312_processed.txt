identifying associations between amino acid changes and meta information in alignments motivation: we present a method that identifies associations between amino acid changes in potentially significant sites in an alignment (taking into account several amino acid properties) with phenotypic data, through the phylogenetic mixed model. the latter accounts for the dependency of the observations (organisms). it is known from previous studies that the pathogenic aspect of many organisms may be associated with a single or just few changes in amino acids, which have a strong structural and/or functional impact on the protein. discovering these sites is a big step toward understanding pathogenicity. our method is able to discover such sites in proteins responsible for the pathogenic character of a group of bacteria. results: we use our method to predict potentially significant sites in the rpos protein from a set of 209 bacteria. several sites with significant differences in biological relevant regions were found. availability: our tool is publicly available on the cran network at http://cran.r-project.org/next-generation sequencing has dramatically increased the amount of biological data available. this technology has made sequencing cheaper and faster, while stimulating the development of several methodologies. the number of sequenced genomes has increased dramatically over the past few years, reaching 1815 sequenced genomes at the time of writing (genome project database at the ncbi). in bacteria, several strains are sequenced from different organisms with the number of available genomes steadily increasing. at this time, 3800 strains corresponding to 400 species are being sequenced (http://www.ncbi.nlm.nih.gov/genomes/lproks.cgi, last accessed date april 25, 2011). the multitude of genomes gives the possibility to identify orthologous groups of proteins among many closely related strains. for very similar strains, thousands of these orthologous groups may exist, implying a dimension expansion of problems involving alignments. indeed, aligning thousands of proteins from hundreds to whom correspondence should be addressed. of strains, exploring the alignments and identifying interesting sites is a daunting task. when dealing with very large alignments, the overview is easily lost. this leads to the idea of establishing a more automated way of finding significant positions in the alignments, that are sites in the protein in which amino acid changes could alter the function. in general, multiple sequence alignments identify regions of similarity that may result from functional, structural or evolutionary relationships between the sequences and frequently a mixture of them. if two sequences in an alignment share a common ancestor, mismatches can be interpreted as point mutations and gaps as insertions or deletions introduced in one or both lineages since they diverged from that ancestor. hence, behind a multiple sequence alignment of orthologs lies a phylogeny. when analyzing alignments in order to perform association studies with some metainformation, such as specific phenotypic data, one should therefore consider the phylogenetic relationship between the organisms. the method presented here identifies associations between amino acid changes in interesting positions in an alignment (taking into account several amino acid properties) with some metainformation (e.g. phenotypic data). the proposed method has general applicability to other organisms, different amino acid properties, different metadata. as a motivating example, we applied it to a set of 209 bacterial strains belonging to several genera (72 genera, 117 species) with the aim of finding amino acid changes that might be correlated with the pathogenicity of the bacteria. the pathogenicity character is mainly determined by the presence of specific genes, such as toxins, often referred to as virulence genes. however, several studies have shown that the pathogenicity character of different bacterial strains is determined by changes in amino acids causing changes in protein structure, and hence function . thus, the pathogenicity character can also be conferred by specific genetic variations having an effect on protein function and not solely by the presence or absence of virulence factor genes as previously assumed . we have assembled a screening method that identifies significant sites in an alignment (which might confer the pathogenicity character to some bacteria) through the application of linear mixed models on different amino acid properties in each of those columns. amino acid properties can be grouped according to many different characteristics, such as size, polarity, alpha helix or beta sheet propensity. substitutions severely changing the value of some key properties (e.g. from polar to non-polar) tend to have a stronger effect on the tertiary structure, and probably on the function of the protein.page: 2783 27822789in a first step, we explored the ability of the three fast scanning methods with two aims: (i) as fast alternatives to the pmm, and (ii) as fast initial filtering of columns to further apply the pmm. we defined s t j as the gold standard. for this reason, our method was applied to the 275 columns in the alignment of rpos that remained after removing columns that were totally conserved or that contained 5 gaps. subsequently, we calculated the s t score for each column. unexpectedly, anova and cer performed extremely bad. the rank correlation between s t j and cer was 0.204 (p 10 3 ) while between anova (median) and s t it was 0.221 (p 10 3 ). on the other hand, the simple entropy approach displayed a rank correlation of 0.617 (p 10 15 ). however, despite the reasonable correlation value, only 25 of the columns can be safely ignored based on the entropy value. in the light of these results, it is clear that none of the previous fast methods reasonably predict the pmm results and therefore cannot be used in the initial screening procedure. given this situation, we continued the analysis with the 275 columns in the alignment. however, as these methods are based on completely different assumptions and even theoretical foundations, it could be interesting to keep them at hand to compare predictions. a cutoff corresponding to the 95 percentile of s t was chosen in order to keep the most significant columns for further analysis, which led to 14 remaining columns.shows those significant positions and the respective scores for each property as well as thes t score. furthermore, we predicted the secondary structure of rpos using the psipred server applied to the rpos protein from escherichia coli as model. for each of the significant columns in, we denoted whether it lies within an alpha helix or coil region. in addition, the amino acids enriched (5 difference in the general frequency) at each position in pathogens and nonpathogens are shown. in order to assess the significance of the s t scores, bootstrapping was performed, permuting the properties in each bootstrap. it can easily be appreciated that the distribution of bootstraps for intermediate or high scores are similar . a different approach to find interesting sites come from the effect sizes.shows the l 2 values per position, smoothed considering the neighbor positions with a dema function (double exponential moving average). that is, for each position we consider the whole region (n = 3, the adjacent neighbors at each side) and average the l 2 values weighted by a double exponential according to the distance. we permuted the positions and calculated the dema for each position, taking only the maximum into account before permuting positions again. three different peaks were observed over the 97.5 percentile of the bootstrap, corresponding to sites 9698, 374376 and 510514 .shows, for each of these peaks, the difference of the effect size (pathogennon-pathogen) of each property, in order to investigate the contribution of each of (see supplementary material for a complete list of effect sizes). cumulative effect sizes were calculated in order to observe overall tendencies along the alignment.shows the cumulative sum of the effect size in each of the five properties along the positions in the alignment. the cumulative effect sizes were calculated based only on the significant positions. were the distribution of the effect sizes random, meaning that no tendency in pathogens or nonpathogens would be detectable, a line oscillating around zero should be observed (similar to the dotted one). finally, in our example, an alignment with 209 species, 275 relevant columns and 5 properties took 8 h for running 10 5 iterations in a macbook pro with intel core i7 processor (2.66 ghz) and 8 gb of ram. while the three approaches we assayed for quick page: 2786 27822789), and three arbitrarily chosen positions with insignificant scores (to the right of the dashed line). the triangles and rhomboids are the actual s t scores. while triangles (significant scores) lie above the bootstrap distribution, rhomboids (insignificant scores) are falling into the distribution range. this is in agreement with our assessment of significance based on s t. the empirical distribution of s t is plotted as a rotated density plot on the right, i.e. the the y-axis represents the scores values while the x-axis represents their abundance. selection of significant columns failed to select good candidates (which precludes their usage in the filtering step), a two stages approach of the pmm can be used with straightforward results. the rank correlation between the final s t and estimates obtained at 1000, 5000 and 10000 iterations was always 0.960 (data not shown). the number of columns to include from a first quick run to retain the final 1 to 5 top values was below the double for 5000 and 10 000 iterations. this suggest a first run with 10 000 iterations, selecting a number of top-ranking columns that double the desired final proportion of sites of interest and doing the final run only for this set.in the present work, we have shown how linear mixed models may serve to pinpoint interesting residues in protein alignments, associated with meta-information labels. our method is closely connected to the pmm , albeit cast within a bayesian framework, as previous work has put forward . linear mixed models are extremely flexible, being particularly well suited to account for non-independence of observations, especially when dealing with closely related taxa. we applied the pmm, using five amino acid descriptors of our own choice. it is worth mentioning that while arbitrary, our selection is based on sensible physicochemical assumptions, under which their mutation is expected to impact a functional protein. the pmm was performed over the whole set of relevant columns. as a first step, we created a summary statistic (s t ) that allows assessing a sites significance,the right, we show the distribution of the maximum values obtained by each bootstrap in a violin plot (basically a box plot that also shows the probability density: the white circle indicates the median, the central black box and lines extending from it indicate the interquartile range (iqr) and the 1.5-iqr, respectively; a kernel estimate of the probability density is plotted as a blue area to the left and right of the box plot). the marked peaks are all well above the 97.5 percentile and two of them even greater than the bootstrap maximum.with all properties being jointly considered. several studies divided the sigma factors (and the rpos protein) into four regions with different roles . the highest s t score observed inwas 0.978, which corresponds to a residue in region 3 ofin the reference e.coli rpos protein). this region is involved in recognition of the 10 promoter elements (subregions 2.3, 2.4 and 3). other interesting residues in region 3 are 465 and 427 with scores of 0.942 and 0.924, respectively. while columns 376 and 465 are predicted to lie in alpha-helix secondary structures, column 427 belongs to a coil region. following the s t scores, region 3 harbors most residue changes associated with pathogenicity. it is noteworthy that leucine is among the residues enriched at these positions in non-pathogenic organisms. in pathogenic, valine is enriched for columns 337, 427 and 465. while both residues, valine and leucine, are aliphatic, they show strong differences in frequencies at alpha-helix and betasheet structures. additionally, position 514 in the alignment (with score 0.868), corresponding to subregion 4.2, is very interesting. recognition of the 35 promoter element is mediated by a helixturn-helix unit in this subregion, and amino acids from this region may also provide a contact point for some activator proteins. s t scores near 1 are good, even though no statistical significance value is attached to them. moreover, by ordering the scores increasingly one can rank the columns, from less to more interesting, analyzing only the most interesting of them.in our example, the 2 values calculated were almost all significant, even using the correction for the effective number of samples in mcmc runs and correcting for multiple testing (data not shown). this problem, probably associated with the very relaxed null hypothesis tested, makes this statistical approach impractical. however, techniques such as bootstrapping can be used as a proxy for the significance score. when we performed 100 bootstraps for the sites with highest s t values, the distributions of values obtained in the bootstrapping process were well below the real scores . on the other hand, when we performed the bootstrap for columns with low to intermediate scores the real values fell inside the bootstrap distribution, pointing to the expected non-significance. furthermore, for medium to very high s t values the bootstrap distributions were strikingly similar, which in principle allows a significant reduction in the number of columns to consider for the bootstrap process. statistical significance of the observed fixed effects is fundamental to avoid spurious correlations. however, the real biological significance of the observed changes is probably more associated to the effect size, that is, the relative difference in each of the considered properties. while correlation between s t and effect sizes were reasonably high and significant for all considered properties (ras: 0.651, mut: 0.610, kd: 0.710, alpha: 0.631 and beta: 0.641), an alternative view could emerge if candidate selection is based on effect sizes. for this reason, we calculated the l 2-norm for each column in the alignment using the (standardized) effect sizes. three peaks were significant as shown in, corresponding to positions 9698, 374376 and 510514. the change in ras in region 374376 is noteworthy, and the change in all properties for column 376 is of particular interest . residues at position 510 in the alignment showed an increase in ras together with a decrease of hydropathy in pathogenic organisms. while the effect sizes of known reported cases are bigger than that observed in our case (e.g.), it is worth mentioning that we are detecting weaker signals present in a large number of organisms spread across very distant phylogenetic groups, hence smaller effect sizes are, in fact, expected. the ras and mutability are consistently larger in pathogenic organisms as compared with their non-pathogenic counterpart. furthermore, given the observed pattern we analyzed the mean ras per organism with a linear mixed model and found a significant difference between pathogens and non-pathogens (mean difference 0.364, 95 confidence interval 0.1610.568; data not shown). additionally, for pathogens high mutability may constitute a selective advantage, e.g. to cope with a changing host environment. the behavior of other properties is more erratic, with increases and decreases alternating across the protein sequence. several points in our approach are worthy of discussion. first, the amino acid properties are usually limited to 20 possible values. in general, they are measured in a continuous scale, but the limited set of values (few amino acids are in each site in the alignment) suggests that a categorical representation is an interesting alternative. however, even with discrete data, the simple linear mixed model performs almost equivalent to more complex models based on generalized mixed model theory, with the enormous advantage of the simplicity for interpretation . second, while we focused our analysis on the fixed effects, essentially the difference in the properties between pathogens and non-pathogens, the random effects and particularly additive effects carry very important information regarding tendencies along the phylogenetic structure. third, phylogenetic heritability (h 2 ) is a key component in the pmm. heritability, usually defined as the proportion of phenotypic variance attributable to additive effects, indicates the importance of the phylogenetic information with regard to the estimation process. values of h 2 near 1 indicate that characteristics are highly dependent on the phylogenetic structure, while values near 0 indicate independence of the phylogeny. in our case, the first quartile of h 2 was 0.75 for all properties, pointing toward the general importance of taking into account phylogenies in the linear model. fourth, the computational performance of our method is adequate for medium size problems and a two-stage approach of the pmm can be used to reduce the computational burden. moreover, our approach is trivially parallelizable, both in properties page: 2788 27822789we present a method based on pmm and amino acid characteristics that helps finding interesting columns in a protein sequence alignment, which might be responsible for a structural change in a protein, possibly affecting its function. we presented an example of this method through an alignment of bacterial rpos sequences, using five amino acid properties in order to distinguish which columns could be associated with the pathogenic character of some strains. our method is extremely flexible and can be applied to all kinds of labels, univariate or multivariate, and even taking account of several effects together. although we mainly explored the fixed effects, a lot of additional possibilities can be exploited from random effects. in the present work, we presented one variant of all these possibilities and implemented it as an r package.  
