genome analysis a classification approach for dna methylation profiling with bisulfite next-generation sequencing data motivation: with the advent of high-throughput sequencing technology , bisulfitesequencing-based dna methylation profiling methods have emerged as the most promising approaches due to their single-base resolution and genome-wide coverage. however, statistical analysis methods for analyzing this type of methylation data are not well developed. although the most widely used proportion-based estimation method is simple and intuitive, it is not statistically adequate in dealing with the various sources of noise in bisulfite-sequen-cing data. furthermore, it is not biologically satisfactory in applications that require binary methylation status calls. results: in this article, we use a mixture of binomial model to characterize bisulfite-sequencing data, and based on the model, we propose to use a classification-based procedure, called the methylation status calling (msc) procedure, to make binary methylation status calls. the msc procedure is optimal in terms of maximizing the overall correct allocation rate, and the false discovery rate (fdr) and false non-discovery rate (fndr) of msc can be estimated. to control fdr at any given level, we further develop an fdr-controlled msc procedure , which combines a local fdr-based adaptive procedure with the msc procedure. both simulation study and real data application are carried out to examine the performance of the proposed procedures. it is shown in our simulation study that the estimates of fdr and fndr of the msc procedure are appropriate. simulation study also demonstrates that the fdr-controlled msc procedure is valid in controlling fdr at a prespecified level and is more powerful than the individual binomial testing procedure. in the real data application, the msc procedure exhibits an estimated fdr of 0.1426 and an estimated fndr of 0.0067. the overall correct allocation rate is 40.97. these results suggest the effectiveness of our proposed procedures. availability and implementation: the proposed procedures are implemented in r and are available atdna methylation is an epigenetic modification to the genomic dnas by adding the methyl group to some c-5 positions of dna sequences. it plays a crucial role in a variety of biological processes including cell development, imprinting and x-chromosome inactivation. it is prevalent at cpg positions with 6090 of all cpgs being methylated in mammals, whereas it is much less frequent at non-cpg sites with only 53 of non-cpgs being found to be methylated. unmethylated cpgs tend to cluster in small regions of dna sequences called cpg islands, most of which coincide with promoter regions of many genes. the link between abnormal dna methylation pattern and cancer is 2-fold . first, a global hypomethylation is associated with genomic instability and is a common characteristic of cancer cells. second, hypermethylation of cpg islands located at gene promoters results in suppression of gene expression and is conventionally observed in cancer cells. therefore, it is desirable to reveal both genome-wide and promoter-specific dna methylation patterns of a cell. various methods for genome-wide dna methylation detection have been developed in the past 20 years. they can be classified into three categories, which are methylation-sensitive enzymebased methods, enrichment-based methods and bisulfite conversion-based methods . in the past, array-based techniques, such as microarray technology, were the leading platforms to be combined with methods from all those three categories to survey methylation status. although the application of these platforms enables comprehensive dna methylation profiling at economical cost, they can only interrogate c sites of given regions at moderate resolution. recently, next-generation sequencing (ngs) technology has been incorporated into all three categories of methods for genome-wide methylation profiling. despite the fact that ngs-equipped methods have relative advantages over array-based methods, those methods from the first two categories are still subject to the same weaknesses they had when coupled with array-based techniques. more specifically, methylation-sensitive enzyme-based methods equipped with ngs technology remain restricted to the recognition sites of the particular enzymes used, and enrichment-based methods equipped with ngs technology do not overcome the disadvantage of moderate resolution. on the other hand, bisulfite conversion-based methods coupled with ngs technology, designated as bisulfite-sequencing methods, have emerged as the most promising methods, as they generate whole-genome dna methylation profiles at single-base resolution. among all bisulfite-sequencing methods, methylcseq and reduced representation bisulfite sequencing (rrbs) are the two most popularly used methods. in methylc-seq, genomic dnas are first sonicated into smaller fragments. after going through end-repair and adapter ligation, these fragments are treated with bisulfite. the bisulfite treatment converts unmethylated cytosines into uracils and to whom correspondence should be addressed. leaves methylated cytosines unchanged. subsequent pcr amplification process further replaces uracils with thymines. these pcr-amplified fragments are then subject to standard sequencing technology to produce short sequencing reads, which are mapped back to the reference genome. thus the unmethylated cytosines are distinguishable from methylated cytosines by examining sequencing reads (the workflow for methylc-seq experiment is given in supplementary material section 1.) rrbs uses the same mechanism as methylc-seq. the major difference between rrbs and methylc-seq occurs in the first step, i.e. the way genomic dnas are fragmented. in rrbs, genomic dnas are digested with mspi, an enzyme which cuts all ccgg sites. these two methods have their relative advantages and disadvantages, which make them suitable for different research purposes. by the way genomic dnas are digested in rrbs, cpg regions are substantially enriched in dna fragments after size selection. thus rrbs is more preferable than methylc-seq when the research is targeting regions with high density of cpg sites, such as cpg islands. on the other hand, because of its theoretical capacity of capturing methylation information from each c position in the whole genome, methylc-seq has become the golden standard for genome-wide dna methylation analysis. as reported in, when these two methods are applied to biological replicates of human embryonic stem cells, methylc-seq covers 95 of all cpgs, whereas rrbs shows a genome-wide cpg coverage of only 12. in the data generated by methylc-seq or rrbs, ideally there are only c reads or t reads for each covered c position of interest, depending on the methylation status. in other words, if a c position is methylated, then there should be only c reads at that site in the data; whereas if a c position is unmethylated, then there should be only t reads. however, owing to various sources of noise, in the real data generated by these two methods, there are both c reads and t reads for most of the target c sites. for instance, the process of bisulfite conversion needs to be carried out under specific experimental conditions . failure to meet any of those conditions would lead to incomplete conversion, which further results in c reads at unmethylated c positions. moreover, as a typical and inevitable result of applying ngs technology, there will be sequencing errors in the data, which means a small proportion of c reads will be miscalled to be t reads and vice versa. because there are both c reads and t reads in the data, it is not straightforward to infer the true methylation status. the aim is then to make methylation call for each target c position based on the number of c reads and the number of t reads it receives, which becomes an interesting statistical problem. in some studies concerning dna methylation analysis, researchers use the ratio of c count to the total number of reads received at a site to quantify the methylation level at that site . the total number of reads received at a site is referred to as coverage or sequencing depth. although this quantification approach has the virtue of being simple and straightforward, it does not use proper inference to deal with the noise in the data, and thus it is not statistically satisfactory. in other studies, researchers aim to make binary methylation calls for c positions of interest. there exist a few such approaches in the literature. in, the proportion of c count at each cpg site was calculated and binary methylation call was made for each site with various choices of cutoff for the proportion. however, those choices were not statistically justified. a more sophisticated method was used in, which applied a multiple testing procedure to identify methylated cytosines. in the methylc-seq experiment conducted by, an unmethylated lambda dna was spiked with the target genomic dnas before sonication and was used to estimate the error rate at which a c count occurs at an unmethylated c position. as will be shown in section 3 and supplementary material section 5, the procedure used byis conservative in detecting unmethylated cytosines due to the underestimation of error rate and their choice of null hypothesis. in this article, we propose to use a classification procedure based on a mixture of binomial model to make binary calls for methylation status. as a by-product, the memberships generated in this procedure can be used for quantifying the methylation levels. the performance of the proposed procedure can be assessed by correct allocation rates as well as false discovery rate (fdr) and false non-discovery rate (fndr). motivated by the concern of controlling fdr at any given level, we view our classification problem from a multiple testing perspective. then a component based on local false discovery rate (lfdr) is incorporated into the proposed classification procedure to provide an approach that is capable of controlling fdr at any prespecified level. on the basis of the bayes rule, the proposed classification procedure is optimal in terms of maximizing the overall correct allocation rate. simulation results demonstrate that the proposed classification procedure outperforms the conventional individual binomial testing procedure and is more accurate in detecting the true methylation status. simulation results also show the validity of the proposed fdr-controlled procedure with various choices of fdr level. owing to the fact that most non-cpg sites are unmethylated, when evaluating our method with real data, we focus exclusively on cpg sites. however, it is worth pointing out that our model can be applied to c positions of any context. the real dataset we use is from, which was generated from a methylc-seq experiment. however, our method is not restricted to methylc-seq data, and it can also be applied to other bisulfite-sequencing data. the rest of the article is organized as follows. section 2 first gives the details of the mixture of binomial model and describes the proposed classification procedure, and then it presents several performance assessment methods of the proposed procedure. in the last part of section 2, the fdr-controlled procedure is introduced. section 3 reports the simulation results as well as the results from the real data application.in this article, we develop a classification-based procedure and an adaptive fdr-controlled procedure to make binary dna methylation status calls for bisulfite-based data. based on our simulation study and real data evaluation, we believe the proposed classification procedure is the procedure of choice if an fdr level between 0.05 and 0.15 is satisfactory. thus for analyzing bisulfite-based data, it is recommended to apply the classification procedure and estimate the resulting fdr first. if an fdr level other than the estimated fdr is of concern, the adaptive procedure at the desired fdr level can be used. both the classification-based procedure and the adaptive fdrcontrolled procedure are implemented in r and are available free online at http://www.stat.purdue.edu/cheng70/code.html. this work also points to several future research directions. first, in this work, the proposed procedures are applied either genome wide or chromosome wise. a more sophisticated choice of regions needs to be further explored, as it is assumed that all the cpg sites in the same region share the same error rates. second, for adjacent cpg sites, their methylation statuses can be correlated. hidden markov models can be used to accommodate this type of correlation and may potentially lead to more accurate methylation status calls . third, bowtie was used to align the read sequences by. this may lead to a bias toward the reference allele. how to correct this bias is worth exploring. possible solutions include the methods proposed by. finally, the ultimate goal of methylation analysis is to detect differentially methylated sites or regions. how to accomplish this goal with our proposed model will be investigated in the future.  
