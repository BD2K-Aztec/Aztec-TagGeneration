gene expression rseqnp: a non-parametric approach for detecting differential expression and splicing from rna-seq data high-throughput sequencing of transcriptomes (rna-seq) has become a powerful tool to study gene expression. here we present an r package, rseqnp, which implements a non-parametric approach to test for differential expression and splicing from rna-seq data. rseqnp uses permutation tests to access statistical significance and can be applied to a variety of experimental designs. by combining information across isoforms, rseqnp is able to detect more differentially expressed or spliced genes from rna-seq data. availability and implementation: the r package with its source code and documentation are freely available athigh-throughput sequencing of transcriptomes (rna-seq) is a widely used approach to study gene expression . many statistical approaches have been developed to characterize gene expression variation across rna-seq experiments, and many of them are designed for testing differential expression (de) of genes without considering their alternative spliced isoforms. for a comprehensive review, see. several recent studies have shown that directly applying the de approach for detecting differential splicing (ds) may lead to erroneous results, because those approaches do not incorporate the complexity induced by isoform expression estimation for genes with multiple isoforms . to this end, several approaches were recently developed to detect de at isoform level . however, there are two remaining issues: (i) many existing approaches only compare between two biological conditions (such as normal versus diseased) and their usages for complex experimental designs are thus limited, and (ii) most existing approaches assume parametric distributions (poisson or negative binomial) for observed read counts which, although can achieve good performance when the distributional assumptions hold, may have severely deteriorated performance should the distributional assumptions be violated, and that is often the case especially for large sample size rna-seq data where outliers usually exist . here we present rseqnp, a non-parametric approach for testing de and ds from rna-seq data. rseqnp extends a non-parametric approach for detecting de and aims at detecting both de and ds. rseqnp can be used with a variety of rna-seq experimental designs, including those with two (unpaired or paired) or multiple biological conditions, and those with quantitative or survival outcomes.using simulation studies, we find that our proposed approach has well controlled type i error rate, and achieves good statistical power for moderate sample sizes and effect sizes. see supplementary section s3 for details. here we apply rseqnp to a real rna-seq dataset and compare it with ebseq and cuffdiff , which are two existing approaches for detecting de of genes and isoforms from rna-seq data. the dataset was generated from paired-end rna-seq experiments performed on prostate cancer samples and matched benign samples from 14 chinese prostate cancer patients . since neither ebseq nor cuffdiff can handle paired two-group comparison, we run all three programs on the dataset under the setting of unpaired two-group comparison, i.e. treat cancer and benign samples as two distinct groups, as well as run rseqnp under the setting of paired two-group comparison. for preprocessing, we use the programs suggested by each of the three approaches to quantify expression values for all the genes and isoforms: rsem for ebseq, rseq for rseqnp and the integrated quantification program for cuffdiff. nevertheless, the three programs for quantification show very similar results (see supplementary section s4).summarizes the numbers of differentially expressed and spliced genes identified by each program. see supplementary section s4 for detailed steps and additional results of the analysis. we use fdr 0.05 for rseqnp and cuffdiff, and posterior probability of being differentially expressed (ppde) 0.95 for ebseq to call a differential event. ppde is the metric reported by ebseq and ppde 0.95 corresponds to controlling fdr at 5. as expected, when treating the data as two distinct groups, rseqnp detects fewer differentially expressed genes and isoforms, but by applying the gds, more differentially expressed or spliced genes are detected. furthermore, when accounting for the paired two group nature of the data, rseqnp detects even more differential events. we find that cuffdiff detects a much smaller number of differentially expressed or spliced genes, which is consistent with report from another study .  
