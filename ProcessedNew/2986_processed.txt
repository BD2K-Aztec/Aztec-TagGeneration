mira: mutual information-based reporter algorithm for metabolic networks motivation: discovering the transcriptional regulatory architecture of the metabolism has been an important topic to understand the implications of transcriptional fluctuations on metabolism. the reporter algorithm (ra) was proposed to determine the hot spots in metabolic networks, around which transcriptional regulation is focused owing to a disease or a genetic perturbation. using a z-score-based scoring scheme, ra calculates the average statistical change in the expression levels of genes that are neighbors to a target metabolite in the metabolic network. the ra approach has been used in numerous studies to analyze cellular responses to the downstream genetic changes. in this article, we propose a mutual information-based multi-variate reporter algorithm (mira) with the goal of eliminating the following problems in detecting reporter metabolites: (i) conventional statistical methods suffer from small sample sizes, (ii) as z-score ranges from minus to plus infinity, calculating average scores can lead to canceling out opposite effects and (iii) analyzing genes one by one, then aggregating results can lead to information loss. mira is a multivariate and combinatorial algorithm that calculates the aggregate transcriptional response around a metabolite using mutual information. we show that miras results are biologically sound, empirically significant and more reliable than ra. results: we apply mira to gene expression analysis of six knockout strains of escherichia coli and show that mira captures the underlying metabolic dynamics of the switch from aerobic to anaerobic respiration. we also apply mira to an autism spectrum disorder gene expression dataset. results indicate that mira reports metabolites that highly overlap with recently found metabolic biomarkers in the autism literature. overall, mira is a promising algorithm for detecting metabolic drug targets and understanding the relation between gene expression and metabolic activity. availability and implementation: the code is implemented in c language using .net framework. project is available upon request.changes with respect to environmental or genetic modifications lead to complex cellular responses. standing on the top of the omics hierarchy, metabolomics reflects changes taking place in the transcriptome and in the genome. these responses are analyzed by researchers to discover regulatory mechanisms and dynamics of cells. transcriptional responses of the cells, along with the corresponding metabolic alterations, have been investigated in various contexts. some examples are plant research , diabetes , insulin resistance and cancer . functional class-based and proteinprotein interaction network-based analysis of gene expression data have been well established. metabolic network-and metabolic pathway-driven analysis of transcriptional data have been receiving attention lately. efforts have centered on discovering transcriptional regulation architecture of metabolic networks of organisms using genome-wide association studies . various methods with different goals have been developed to use transcriptomic and metabolic data together in the context of a metabolic network such as (i) mining for new metabolitegene/transcription factor relationships , (ii) flux balance analysis and constraint-based modeling of organisms and (iii) using metabolic network topology to identify significant changes in related groups of genes . network topology-based analysis of biological data is a broad research area . in the context of metabolic networks and transcriptomics, the literature so far can be divided into two subcategories. the first type of analysis uses predefined metabolic pathways as targets for transcriptional regulation and analyzes the changes in the pathways. gene set enrichment analysis (gsea) is the first and most established analysis in this subcategory . improvements have been proposed in the literature to eliminate the shortcomings of the gsea approach . the second type of analysis considers the metabolic network as a whole, and aims to find signatures or hot spots in the metabolic network that are subject to transcriptional regulation . the most established method in this group is the reporter algorithm (ra;). using the z-score-based method introduced before , the algorithm aims to find metabolites around which transcriptional regulation is centered and link the complex transcriptional motives to metabolome. various to whom correspondence should be addressed. the author 2014. published by oxford university press. this is an open access article distributed under the terms of the creative commons attribution non-commercial license (http://creativecommons.org/licenses/ by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. for commercial re-use, please contact journals.permissions@oup.com extensions and modifications to the algorithm have been published in the literature. for instance, same idea has been used to discover reporter reactions . a similar z-scorebased approach has also been used analyze the rate-limiting steps of pathways . in this article, we focus on the original ra and its scoring mechanism . our observations, discussed next, also apply to the extensions of the ra method. ra first maps the differential data onto the enzymes (reactions) in the metabolic network, and then calculates the p-values for each gene, using students t-test. p-values are then converted to z-scores using the inverse normal cumulative distribution ( 1 ). equation (1) shows how each p i is converted to the corresponding z-score z i. given all samples, z-score measures how many standard deviations away a p-value is. it ranges from negative to positive infinity, where negative infinity corresponds to no significance at all.the z-score z m for a metabolite m is the aggregation of z-scores of the k enzymes that are neighbors of m in the metabolic network (through metabolic reactions), and calculated as shown inequation (2). the null hypothesis is that the genes adjacent to a metabolite display their normalized average response by chance. should the significance of a metabolite need to be determined, z-score is normalized and converted back into the corresponding p-value.that enzyme i is a neighbor of metabolite m 2although ra has been shown to be effective in several different contexts such as analysis of type 2 diabetes , genome scale analysis of organisms , genome scale analysis of cell lines , gene knockout analysis , targeted pathway analysis , there are some shortcomings that may affect the accuracy of the algorithm. first, the z-score method uses students t-test to measure the amount of change between two variables. however, the resulting p-value is highly dependent on the degrees of freedom. it has been shown that, owing to the small number of samples in cohorts, p-values may not work as intended . second, ra uses a univariate approach. that is, it determines the changes per gene, and does not take dependencies among genes into account. for a reaction associated with multiple genes, the gene with the highest z-score is used, and the rest are discarded . in, we illustrate the problem via an example. the figure shows an example from the application of the ra algorithm to compare arcafnr and wild-type (wt) strains of escherichia coli (aerobic) in the gene expression dataset (please see section 2 for details). genes (pentagons) are assigned z-scores first, and then the maximum z-score is selected and assigned as the z-score of the reaction (rectangles). for the reaction copragon transport via ton system, the maximum z-score belongs to the gene fhue (0.88). this scoring ignores the contribution of the gene tonb, as any z-score value for tonb in the range [infinity, 0.88) would yield the same z-score for the reaction. finally, the method is additive in aggregating z-scores of each neighboring reaction to determine the z-score of a metabolite [as shown in. however, z-score ranges from negative to positive infinity, negative infinity representing the most insignificant case. therefore, averaging individual results introduces the problem of opposite signs cancelling each other out. in, copragon is assigned a z-score: 1 ffiffi 2 p 0:1+0:88=0:54. negative z-score (0.1) assigned to the reaction copragon transport via abc system partially cancels out the z-score of the reaction copragon transport via ton system (0.88). the problem would have been resolved if the scoring mechanism used, assigned zero to the most insignificant case (p = 1). in this article, we present a new algorithm, called mutual information-based reporter algorithm (mira) that addresses the shortcomings of the original ra. mira is a multivariate and combinatorial algorithm that calculates the aggregate transcriptional response around a metabolite using mutual a binformation. mutual information is an information theoretic method that measures how much knowing one variable reduces the uncertainty about the other. in gene expression analysis, it has been used frequently . chowdhury et al. show that combinatorially dysregulated subnetworks found through mutual information is predictive for cancer. in metabolomics analysis, using the combinations of metabolites and their levels, adema (the algorithm for determining expected metabolite alterations) predicts expected changes of metabolite levels in a given metabolic network using mutual information . in the context of mira, the two variables are (i) the genotype (e.g., case and control) and (ii) the combinations of the genes associated with a reaction and their expression levels. more specifically, mira performs the following tasks: (i) discretize gene expression levels using b-spline functions, (ii) calculate the mutual information between the genotype, as well as combinations of genes associated in a reaction and their discretized expression levels, and (iii) calculate the average mutual information for each metabolite using the mutual information of each neighboring reaction.shows the overall flow of the algorithm. the advantages of mira over ra are as follows:(1) combinatorial mutual information works well when the sample sizes are small, and performs better than univariate significance testing.(2) unlike the ra, mira uses a multivariate method, analyzing multiple genes at a time. therefore, it does not discard less insignificant changes unlike ra. mira uses measurements of individual samples instead of comparing sample means and is able to capture linear and non-linear dependencies among variables.(3) mutual information is bounded by zero and the minimum of the entropies of the two random variables. the most insignificant case is assigned the score zero; therefore, insignificant changes do not cancel out significant changes.(4) mira has no bias toward highly connected metabolites, as it normalizes the sum of changes around a metabolite using the number of reactions instead of the square root of number of reactions as ra does [see equations (2)and(8)].shows the results obtained by mira for the introductory example shown in. unlike the ra, which assigns a low score to the reaction copragon transport via abc system indicating that there is no significant change on this enzyme, mira predicts relatively high mutual information indicating that when considered together genes fhub, fhuc and fhud are expressed differently. mira predicts similar results for both reactions and the average is found as 0.8 (max 0.98 in this test), whereas the ra assigns 0.54 to copragon (max $13 in this test). the difference between the two algorithms stems from the fact that (i) mira performs a multivariate analysis compared withmetabolic networks have received significant attention in the past decade. this advancement has led to the investigation of various genetic diseases and their metabolism with the use of the reconstructed genome scale metabolic networks. one application is to find the regulatory architecture of the metabolic network using the underlying transcriptome. the ra finds the metabolic hot spots around which transcriptional regulation is centered. in this article, we developed a novel method, called mira, that uses a combinatorial approach and mutual information to find reporter metabolites. our approach addresses the shortcomings of the existing ra algorithm. more specifically, it is robust against small sample sizes, uses a multivariate approach instead of a univariate one and does not cancel out significant changes in expression levels with non-significant ones. our results show that (i) mira has no bias on picking hub metabolites as reporter metabolites, (ii) reporter metabolites found by mira are biologically sound and are supported by literature even for a complex disease like autism, (iii) mira captures the effects of a knockout of the fnr gene in e.coli successfully and (iv) mira provides empirically significant results, which supports the fact that it captures the underlying biological phenomenon.  
