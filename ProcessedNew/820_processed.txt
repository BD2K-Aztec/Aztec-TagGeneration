sequence analysis brat-bw: efficient and accurate mapping of bisulfite-treated reads we introduce brat-bw, a fast, accurate and memory-efficient tool that maps bisulfite-treated short reads (bs-seq) to a reference genome using the fm-index (burrowswheeler transform). brat-bw is significantly more memory efficient and faster on longer reads than current state-of-the-art tools for bs-seq data, without compromising on accuracy. brat-bw is a part of a software suite for genome-wide single base-resolution methylation data analysis that supports single and paired-end reads and includes a tool for estimation of methylation level at each cytosine.bisulfite sequencing (bs-seq) combined with next-generation sequencing (ngs) instruments enables genome-wide methylation analysis at a single base-resolution. bisulfite treatment of dna followed by pcr converts unmethylated cytocines to thymines and leaves methylated cytocines unchanged . bisulfite-treated sequenced reads have to be aligned to the reference genome, but the treatment introduces the computational challenge of mapping both cs and ts in a read to cs in the genome. the most successful methods for mapping short reads either use hashing or data structures based on the burrowswheeler transform (where the latter approach is considered to yield more time efficient solutions than the former. although several tools are available for bs-seq data, most of them still use hashing (including rmap-bs, soap, maq and brat). the fastest tools for mapping bs-seq reads are bismark and bs-seeker . both employ the mapping tool bowtie that internally uses the fm-index based on the burrows wheeler transform. as a consequence, both tools are required to post-process the output of bowtie to remove ambiguous reads or reads with too many mismatches. bismark synchronizes instances of fm-indexes run in parallel, which takes a toll on time-efficiency. bs-seeker outputs the results of distinct instances into separate files to whom correspondence should be addressed. during mapping and then post-processes mapping results, which demands extra storage for intermediate results. bismark and bsseeker can therefore require large amount of primary memory to complete the processing. both tools support two distinct types of bisulfite libraries: the first type yields sequenced reads that are bisulfite-converted versions of two original genomic strands ; the second type produces reads that correspond to four possible strands, as a byproduct of pcr step . to support the second type of libraries, bismark and bsseeker align reads to four distinct fm-indexes. even though a type-1 bisulfite library would require only two fm-indexes, bismark builds four fm-indexes in parallel requiring 16 gb of memory for human genome (bowtie-2 with offrate 4). on the other hand, bs-seekers memory footprint depends directly on the size of the input file: it may require up to 15 gb of memory for 30 m 32 bp-long reads (the typical number of reads/lane for the illumina genome analyzer). additionally, bs-seeker currently does not support paired-end reads and allows a limited number of mismatches per read, which makes it unsuitable for longer reads.in the supplementary material summarizes the features of all the available tools for bs-seq data. in this article we introduce brat-bw, a fast and accurate mapping tool that uses a very memory-efficient implementation of the fm-index. brat-bw is an evolution of brat , which uses about half as much memory compared with bsseeker and bismark. additionally, its memory footprint does not depend on the size of the input sequenced reads, likely to continue to increase with future sequencing technologies advances. brat-bw supports both types of bisulfite libraries and handles single-end and paired-end reads. it has no limitation on the maximum length of the read or the number of allowed mismatches. brat-bw guarantees to find all matches as long as they have at most one mismatch in a prefix of length 3264 bp (user defined) of the read. there are several advantages of designing a tool for bs-seq data based on the fm-index from the ground-up instead of relying on a general-purpose tool such as bowtie. brat-bw processes both fm-indexes on a single processor, so no synchronization cost is required. in addition, the selection of correctly mapped unique reads is performed on the fly during mapping, so no storage for intermediate results is necessary.  
