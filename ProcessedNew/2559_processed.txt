investigating microbial co-occurrence patterns based on metagenomic compositional data motivation: the high-throughput sequencing technologies have provided a powerful tool to study the microbial organisms living in various environments. characterizing microbial interactions can give us insights into how they live and work together as a community. metagonomic data are usually summarized in a compositional fashion due to varying sampling/sequencing depths from one sample to another. we study the co-occurrence patterns of microbial organisms using their relative abundance information. analyzing compositional data using conventional correlation methods has been shown prone to bias that leads to artifactual correlations. results: we propose a novel method, regularized estimation of the basis covariance based on com-positional data (rebacca), to identify significant co-occurrence patterns by finding sparse solutions to a system with a deficient rank. to be specific, we construct the system using log ratios of count or proportion data and solve the system using the l 1-norm shrinkage method. our comprehensive simulation studies show that rebacca (i) achieves higher accuracy in general than the existing methods when a sparse condition is satisfied; (ii) controls the false positives at a pre-specified level, while other methods fail in various cases and (iii) runs considerably faster than the existing comparable method. rebacca is also applied to several real metagenomic datasets.microorganisms coexist with highly diverse patterns in different environments. studying the microbial inter-organism relationships may provide us important insights to the underlying properties of the ecosystem. it has been shown that symbiosis of microbes is responsible for important metabolic processes such as pesticide degradation , biogeochemical cycling in seawater and dental plague development . with recent development of high-throughput sequencing technologies, metagenomic studies based on uncultivated microbial samples have allowed us to survey the compositions of microbial communities. although numerous microbes have been identified, our understandings of the relationships among microbes have been much less fruitful. one of the reasons is that we lack of tools to analyze the correlation structure in metagenomic data due to its high dimensions and complex distributions. after annotating/binning of metagenomic sequencing data, the outputs are usually recorded as counts for downstream analysis. because metagenomic samples usually cannot be collected at the same scale, after identifying the taxa or operational taxonomic units (otus) in a sample, the count of each otu is usually then converted into relative abundance such as proportion or percentage bydividing its count by the total. this implies that the metagenomic relative abundance data follow a compositional fashion . it is well known that applying conventional correlation coefficient methods on compositional data may lead to biased results , although the compositional effect may be weaker on datasets with larger number of components , such as the metagenomic compositional data. to take advantage of the existing statistical methods and also avoid producing spurious correlations, various types of data transformations have been applied in many compositional data studies. these transformations include the additive and centered log ratio transformation , isometric log ratio transformation . chen and li (2013) modeled the metagenomic data directly using dirichlet-multinomial distribution. recently,studied the microbial ecological networks using the concept of conditional independence. these studies provide us tools to handle compositionality, however, using these tools to infer pair-wise correlations has been a challenge. some computational techniques have been developed to mitigate the compositional effect. to evaluate the significance of pearson correlation coefficient calculated based on compositional data,used a permutation-renormalization bootstrap method (reboot) to mitigate the compositional bias. using simulation studies, we find that while reboot shows some improvement over the conventional method, its performance is not consistent and depends on data structure. by assuming unobserved basis abundance, sparcc was proposed to infer the pair-wise correlations of basis abundance rather than their proportions . basis abundance is defined as a positive unconstrained quantity which forms the composition. although basis abundance is conceptual, it does not involve any relative information as opposed to relative abundance, and thus analysis based on it is free of the compositional bias. sparcc estimates correlations based on basis abundance but is not efficient due to its high computational complexity. therefore, these methods have their limitations and have not been investigated thoroughly against compositional data with various types of structures. we propose a method, regularized estimation of the basis covariance based on compositional data (rebacca), which estimates the correlations between pairs of basis abundance using the log ratio transformation of metagenomic count or proportion data. estimating the basis covariance structure from compositional data is equivalent to solving a linear system with a deficient rank. difference between rebacca and sparcc can be summarized as: (i) we construct a linear system that is exactly equivalent to the log ratio transformations and (ii) we use the popular l 1-norm shrinkage method to solve the system under a sparsity assumption. our simulation studies show that rebacca achieves higher accuracy in general and has better asymptotic performance with large sample size as compared with other methods. its performance is more consistent on datasets of various structures. it is also computationally efficient and can be used to analyze large-scale metagenomic data.we propose a method to study pair-wise microbial relationships for metagenomic data. applying conventional measures directly on proportion data can lead to incorrect inference on the pair-wise relationship due to spurious correlation. by assuming the underlying basis abundance, rebacca infers pair-wise relationships of basis abundance and thus is free of compositional bias. in general, it provides higher power on identifying correlated pairs than other existing methods while controlling false positives. another major advantage of rebacca as compared with sparcc is the computational efficiency. sparcc solves the system (2) relying on recursively refining its solution by identifying strong correlations, and its computing time and accuracy depends on the number of strongly correlated pairs. the computing time for rebacca does not depend on the complexity of the data and is nearly independent of the size of samples. for the mouse skincontrol dataset, running sparcc with 1000 bootstraps on a cluster of 20 cores of intel westmere x5650 processors (2.66 ghz, 4 gb memory per core) requires more than 10.5 h, whereas running rebacca with b 500 (equivalent to 1000 bootstraps) on the same cluster takes only about 30 min. a fast implementation of sparcc reduces the computing time . nevertheless, both the original and improved version of sparcc require setting a maximum number of recursions (the default is 10), which can reduce their computing time but also lower their accuracy when there are quite a few strong correlations between otus such as the clustered cases (and supplementary). we show that the rank-deficient system (9) is identifiable or can be solved exactly, provided a sparse condition that each taxon correlates with less than a quarter of the total number of taxa (supplementary file). in the case where a component is positively correlated with all other components with the same magnitude, none of these correlations can be identified no matter how large the sample size is. however, based on our experiments, if some correlations are positive and some are negative, rebacca can find the exact solution despite that the sparse condition is violated. above all, the sparse condition is derived from an ideal, noise-free case, and thus in reality, even if the sparse condition is satisfied, there still can be an issue of identifiability for the system in (9). this is because that given small sample size, correlation can be substantially influenced by uncertainties. the noise and identifiability issues may be the main reason that we obtain lower auc for rebacca in case 2 than other two cases . nevertheless, it should be noted that the sparse condition applies to the model in (9), which is equivalent to (2) and thus the condition should also apply to sparcc. in the high-dimensional setting of a real metagenomic dataset, the sparse condition should usually hold, because bacterial interaction network is highly sparse . although it is possible to solve the system (2) with some regularization such as constraining the diagonal elements of to be positive, the error distribution in the linear system is unlikely to be normal and thus further transformation may be required. thethere are significantly more correlated pairs consistent between the immunized groups than other comparisons construction of the linear system in (9) is not unique; however, the system constructed by equation (7) is optimal because the right hand side of (7) contains information of all variables, and the homogeneity assumption of error variance is satisfied if the distributions for upper diagonal variables in are exchangeable. calculation of p-values in high-dimensional variable selection methods is an open problem. stability selection offers a way to control for fwer using a sample-splitting resampling method (meinshausen and b hlmann, 2010), however, based on our experiments we find that this method is too conservative for the mouse skin data. instead, we use the modified stability selection method proposed by shah and samworth (2013). this method has much better power while also controlling for fwer. change of bacteria abundance in mouse skin microbiota is linked to the cause of skin disease . we show that the microbial correlation patterns in immunized samples are different from the non-immunized ones. the difference highlights the response of a group of bacteroidetes and clostridia to immunization . these species have been reported associated with anaerobic infections. further analysis of the difference of bacterial correlations between the healthy and diseased groups may reveal the link between microbial factors and disease susceptibility.  
