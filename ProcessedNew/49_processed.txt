accurate estimation of heritability in genome wide studies using random effects models motivation: random effects models have recently been introduced as an approach for analyzing genome wide association studies (gwass), which allows estimation of overall heritability of traits without explicitly identifying the genetic loci responsible. using this approach, yang et al. (2010) have demonstrated that the heritability of height is much higher than the 10 associated with identified genetic factors. however, yang et al. (2010) relied on a heuristic for performing estimation in this model. results: we adopt the model framework of yang et al. (2010) and develop a method for maximum-likelihood (ml) estimation in this framework. our method is based on monte-carlo expectation-maximization (mcem; wei et al., 1990), an expectation-maximization algorithm wherein a markov chain monte carlo approach is used in the e-step. we demonstrate that this method leads to more stable and accurate heritability estimation compared to the approach of yang et al. (2010), and it also allows us to find ml estimates of the portion of markers which are causal, indicating whether the heritability stems from a small number of powerful genetic factors or a large number of less powerful ones.many complex traits display a remarkable gap between the overall genetic variance estimated by population studies (such as twin studies) and the variance explained by specific genetic variants identified by genome wide association studies (gwass). this gap has been coined the dark matter of heritability . suggested explanations for this gap include genegene and gene-environment interactions , unidentified by the univariate gwas scheme, though some of these explanations have been refuted by studies . height, being a trait that is easy to measure but genetically complex, has attracted special attention. heritability of height, defined as the portion of height variability due to genetic factors, was estimated at around 80 while the tens of specific single nucleotide polymorphisms (snps) identified by large-scale gwass account for only 10 of the heritability . extrapolating from these data, under specific statistical assumptions,estimated the number of causal snps affecting height at 93 000, which is at the high end of reasonable values.recently suggested the use of random effects models as a multivariate approach for estimating the heritability of to whom correspondence should be addressed. height directly from gwas data. in their model, each individuals height is affected by a genetic random effect, which is correlated across individuals by virtue of sharing some of the genetic variants affecting height, and an environmental random effect, which is uncorrelated across individuals. consistent with the common definition, they define heritability as the ratio of the variance of the genetic random effect to the total variance. using a straightforward maximum-likelihood approach for estimating heritability in this model requires knowledge of the identity of the causal snps, and hence the covariance matrix. this is of course not available, soapproximate the genetic correlation between every pair of individuals across the set of causal snps by the genetic correlation across the set of all genotyped snps. using this approximation they estimate the heritability of height at 45. by adding some further assumptions about the nature and distribution of the causative snps they obtain heritability estimates of 56 and 80. while the random effects approach proposed byis innovative and appropriate, the concept of using an estimated correlation matrix instead of the actual correlation matrix is a questionable heuristic. the very large number of snps used for estimating the genetic correlationsmost of them likely not causativemight mask out the correlations on the set of causal snps. as we show below, this indeed leads to inaccurate and suboptimal estimation of heritability. instead, we propose here to treat the identity of the causal snps as missing data, and find true maximum-likelihood estimates of our parameters of interest in this setting. towards this end, we develop an expectation-maximization (em) algorithm for this problem. because of the exponentially large data space, we employ markov chain monte carlo (mcmc) methods for the estimation of the e-step. this approach is known as markov-chain expectationmaximization (mcem;). we also develop an efficient optimization approach for the m-step, based on spectral decomposition of the estimated covariance matrix. the resulting algorithm is computationally intensive, yet tractable for reasonably sized problems, as we demonstrate. as a by-product of our approach, we also get maximum-likelihood estimates of the portion of genotyped snps that are causative in the random effect model. this represents independently useful information, as it indicates whether the estimated heritability is likely due to a small number of large genetic effects, or a large number of smaller effects. for example, this knowledge may be useful in planning further studies to identify these specific factors. we empirically demonstrate using simulations that our method, in addition to being theoretically sound, does indeed lead to significantly more accurate estimation of heritability than the heuristic approach ofwe first study the convergence properties of the mcem algorithm. as can be seen in, convergence is achieved after a relatively small number of iterations, after which the estimators are almost identical, independent of their starting points. clearly, some level of variance is expected due to the stochastic nature of the mcmc approximation of the e-step, and could therefore be reduced by either taking more samples or averaging over several consecutive mcem iterations. the number of em iterations required for convergence did not vary greatly even when the proportion of the causal snps was low (data not shown). we have also found that the lengths of burn-in periods, as determined by the geweke (1992) algorithm varied greatly between simulations and between consecutive iterations of the mcem algorithm. in general, we have found that burn-in periods were longer when the proportion of causal snps was high, and shorter when the estimators were closer to their true value.the estimators of the proportion of causal snps converged much slower, but did display convergence, as can be seen in. starting from the 10 starting points that spread uniformly in the range (0.1,1), all 10 estimators were in the range (0.4,0.7) within 7 iterations. we noticed that the in-sample variances, and hence the in-sample heritability, varied greatly between simulations, especially when the number of causal snps was small. thus, to compare the methods we first calculated the difference between the in-sample heritability (as estimated using the actual genetic correlation matrix g generated in  
