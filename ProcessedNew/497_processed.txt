sequence analysis a sensitive and accurate protein domain classification tool (salt) for short reads motivation: protein domain classification is an important step in functional annotation for next-generation sequencing data. for rna-seq data of non-model organisms that lack quality or complete reference genomes, existing protein domain analysis pipelines are applied to short reads directly or to contigs that are generated using de novo sequence assembly tools. however, these strategies do not provide satisfactory performance in classifying short reads into their native domain families. results: we introduce salt, a protein domain classification tool based on profile hidden markov models and graph algorithms. salt carefully incorporates the characteristics of reads that are sequenced from the domain regions and assembles them into contigs based on a supervised graph construction algorithm. we applied salt to two rna-seq datasets of different read lengths and quantified its performance using the available protein domain annotations and the reference genomes. compared with existing strategies, salt showed better sensitivity and accuracy. in the third experiment, we applied salt to a non-model organism. the experimental results demonstrated that it identified more transcribed protein domain families than other tested classifiers. availability: the source code and supplementary data are available at https://sourceforge.net/projects/salt1/inferring functions from sequences remains important in analyzing different types of sequencing data including those generated by the next-generation sequencing (ngs) technologies. one basic step during the functional analysis is to assign sequences into different functional categories, such as families of protein domains (or domains for short), which are independent folding and functional units in a majority of annotated protein sequences. protein domain analysis has been widely used for functional annotations of rna-seq data . in particular, quantifying the expression levels of protein domains helps us understand how transcriptional changes of domains are associated with sequencing conditions, sampling tissues or experimental treatments in rna-seq data. for example, computational domain analysis was applied to identify domains that play a role in vernalization and efflux transporters in the gibberellin response in sugar beets . domain analysis is also frequently used to evaluate and compare gene annotation quality of different gene-finding tools or to compare domain composition of data sampled using different techniques . the state-of-the-art method for protein domain analysis is still based on comparative sequence analysis, where query sequences are annotated via comparison with characterized sequence databases. depending on the alignment algorithms and the target databases, domain analysis methods can be divided into two groups. the first one is to compare the sequences against publicly available reference protein sequence databases using pairwise alignment tools such as blast . the second method is a profile-based similarity search, which classifies queries into characterized protein domain or family databases such as pfam , tigrfam , figfams and so forth. there also exist comprehensive protein domain search tools such as interproscan , which combines different sequence and profile-based domain recognition methods from the interpro consortium member databases into one resource. compared with the first method, the profile-based method has two advantages. first, its running time mainly depends on the growth of the data to be analyzed because the number of families/domains grows slowly and is much smaller than the sequence databases such as ncbi-nr. second, previous work has shown that using position-specific conservation information can improve the sensitivity of a remote protein homology search, which is especially important for identifying new homologs in ngs data. one of the most widely used profile-based domain classification tool is hmmer (http:// hmmer.janelia.org/), which relies on profile hidden markov models (profile hmms) to deliver sensitive domain classification for remote homologs. existing domain classification tools are mainly designed for complete or near-complete domain member sequences rather than fragmentary and short reads in ngs data. blast-based and profile-based domain classification tools rely on alignment scores to distinguish true homologous sequences from false ones. short reads incur marginal alignment scores and thus can be easily missed by these tools. in particular, blast-based tools to whom correspondence should be addressed. have low sensitivity for short reads of remote homologs . although hmmer can achieve high sensitivity in recognizing remote homologs of a domain family, it shows low sensitivity in classifying partial sequences of remote homologs . when the reference genomes are available, genome-wide gene and domain annotations and read mapping positions can be combined to determine the membership of reads. however, many ngs datasets lack complete or quality reference genomes, such as complicated metagenomic datasets and transcriptomic data of some non-model organisms. for these data, protein domain analysis is applied to the short reads directly or to the contigs that are generated by de novo sequence assembly tools. contigs produced by de novo sequence assembly tools enable ngs data analysis to take advantage of conventional bioinformatics tools designed for longer sequences. however, using sequence assembly tools as the first step is not ideal for protein domain classification. first, the quality of read assembly deteriorates significantly in complicated ngs datasets . different sequence assembly tools generate different sets of contigs. there is no consensus on the best assembly tool. second, successful de novo assembly requires high sequencing depth, which is difficult to achieve for all domain regions. it is often observed that some domain regions are highly transcribed, whereas others are transcribed much less. third, different protein-coding genes can share the same domain. as a result, similar domain regions can contribute to the nodes forming crossing points between different paths in a de bruijn graph. those repeat-like sequences add difficulty to de novo sequence assembly. thus, there is a need for an alternative and better domain classification tool for ngs data lacking reference genomes. in this work, we designed a sensitive and accurate protein domain classification tool (salt), which uses profile hmms and family-specific contig generation algorithms to classify short reads into domains. salt is mainly designed for domain classification in transcriptomic data of non-model organisms that lack complete or high-quality reference genomes and for metagenomic datasets. in this work, we focus on rna-seq of nonmodel organisms. to evaluate the performance of salt, we applied salt to rna-seq data of species with quality reference genomes. read mapping and genome-wide domain annotations are combined as the ground truth for evaluating the read classification sensitivity and specificity. salt was benchmarked with several popular domain classification strategies. the comparison shows that salt can correctly classify significantly more reads into their native domains while keeping the same or better specificity. finally, we demonstrated the utility of salt on an rna-seq dataset of a non-model organism. although we will use protein domains when describing the methods and results, salt can be applied to both domain families and protein families. in this work, we used the families in pfam , which include both domain families and protein families.to show the utility of salt, we applied it to three rnaseq datasets and compared its performance with hmmer, hhblits and a pipeline that uses de novo sequence assembly tools and hmmer. for brevity of description, we use assemblyhmmer to refer to the complete pipeline, where assembly can be replaced by the name of a specific sequence assembly tool. this pipeline was used to classify query reads into input families based on the following steps: (i) use de novo sequence assembly tools to generate contigs from query reads, (ii) use hmmer to align translated contigs against input families and (iii) classify reads in the aligned regions of the contigs into the corresponding families. the inputs to hmmer and hhblits are always the translated peptides from the reads or contigs. for simplicity, when we say we classify reads into protein domain families using hmmer or hhblits, the translated peptides are actually used. for the first two experiments, annotated reference genomes were available. we first determined the true membership of query reads based on protein domain annotations and read mapping positions in the genome. we then classified query reads into input families using four different types of classifiers: hmmer, hhblits, assemblyhmmer and salt. performance of the classifiers was determined by comparing the true membership of reads and predicted membership by the classifiers. we used four metrics to evaluate the performance of classifiers: sensitivity, false positive rate (fp rate), positive predicted value (ppv) and f-score. let d represent an input family. let a and b be the set of positive and negative reads of d, respectively. let c be the set of reads classified to d by a classifier. the sensitivity of a classifier is defined by jacj jaj. the fp rate is defined by jcaj jbj. the ppv is defined by jacj jcj. the f-score considers both sensitivity and ppv and can be used as a single metric to evaluate the performance of a classifier. it is defined by f score 2 sensitivity ppv sensitivity ppv :to compare the performance of the classifiers on all input families, we first calculate a metric for each input family and report the average of the values of the metric over all input families. in the last experiment, we conducted protein domain classification on an rna-seq dataset sequenced from a non-model organism. although we did not have the annotations of the reference genome, we were able to show that salt identified more transcribed protein domain families that were related to this species.most existing domain analyses in rna-seq data still rely on traditional domain classification tools. in this work, we analyzed why a commonly used tool hmmer can incur low sensitivity for analyzing ngs data. we conducted a correlation study between the sensitivity of hmmer and other features based on the dataset in the second experiment. these features included the following: (i) the alignment score between the domain region and the input family (the correlation coefficients between the sensitivity and these features were 0.0214, 0.0788 and 0.8415, respectively. the normalized alignment score of the domain region in the transcript had a strong positive linear relationship with the sensitivity of hmmer. this implies that reads sequenced from close homologs of a domain family can be better classified using profile hmm-based methods. on the other hand, reads sequenced from remote homologs of a domain family are harder to classify. we further found that the correlation coefficient between the sensitivity and average pairwise sequence identity in a domain was 0.5728. this indicates that the performance of profile hmm-based methods is related to the sequence conservation level of a domain. the choice of parameters is important for salt to provide good overall performance. here, we give some analysis of the parameter k, the number of generated candidate contigs. the default value of k is the number of sinks in the hit graph. when the graph size is small, this k value works well. however, when the graph size is large, such as the hit graphs constructed from metagenomic datasets, the efficiency of salt will decrease significantly. theoretically, the number of sequenced contigs of a domain is the product of the average number of contigs in a domain and the number of copies of the domain in the genome. the former one can be estimated by the sequencing depth, and the latter can be inferred from existing domain organizations in pfam. this approximation provides a better trade-off between classification performance and efficiency. however, if the users do not have good estimates for these values, the default k value is recommended. the filtration stage of salt dominates the time complexity of salt. as alternatives to ppst used in this stage, we could use hmmer or hhblits to align query reads against the input families. however, as shown in our experiments, both hmmer and hhblits have low sensitivity for short reads. therefore, psst is an important strategy that increases the sensitivity of salt. for long query reads, we could use hmmer or hhblits in the filtration stage to obtain a better trade-off between sensitivity and running time. families allows us to use parallelization techniques such as mpi. finally, we will provide users with a systematical way to better estimate k based on the sequencing data and domain information.  
