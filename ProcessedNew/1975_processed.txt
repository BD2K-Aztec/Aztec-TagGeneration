gene expression generalized random set framework for functional enrichment analysis using primary genomics datasets motivation: functional enrichment analysis using primary genomics datasets is an emerging approach to complement established methods for functional enrichment based on predefined lists of functionally related genes. currently used methods depend on creating lists of significant and non-significant genes based on ad hoc significance cutoffs. this can lead to loss of statistical power and can introduce biases affecting the interpretation of experimental results. results: we developed and validated a new statistical framework, generalized random set (grs) analysis, for comparing the genomic signatures in two datasets without the need for gene categorization. in our tests, grs produced correct measures of statistical significance, and it showed dramatic improvement in the statistical power over other methods currently used in this setting. we also developed a procedure for identifying genes driving the concordance of the genomics profiles and demonstrated a dramatic improvement in functional coherence of genes identified in such analysis. availability: grs can be downloaded as part of the r package clean from http://clusteranalysis.org/. an online implementation is available at http://genomicsportals.org/. contact:elucidating the functional significance of differences in gene expression, or of patterns of different gene expression regulatory events in the context of existing knowledge about gene function has not only become the most challenging, but also the most rewarding aspect of the genomics data analysis . the most commonly used strategy relies on sets of reference lists containing functionally related genes, such as gene ontologies and kegg pathways , to identify functional categories enriched by the differentially regulated genes. statistical methods and computational procedures for identifying functionally related sets of genes that are associated with new to whom correspondence should be addressed. experimental data have been studied in detail . two basic approaches are used to establish statistical significance of such enrichment. the first approach relies on counting the number of genes in a given functional category that are also differentially expressed, and using the fishers exact or chi-squared tests to establish the statistical significance of such overlaps. the inherent limitation of this type of analysis is the requirement to choose statistical significance cutoff levels for differential expression. this can reduce the statistical power of the analysis , and different threshold choices may in some situations lead to different enriched categories . the second approach uses the complete distribution of differential expressions of all genes to identify enriched gene lists, without categorizing them into differentially and non-differentially expressed. statistically, these methods use either rank-based kolmogorovsmirnov-like tests , or the traditional location shift tests to identify lists of functionally related genes that are more differentially expressed than a randomly drawn list of genes of the same length. systematic performance assessments established that, in general, location shift methods using all data outperform chisquared-and kolmogorovsmirnov-like methods . in a further refinement of this approach, the probcd methodology accommodates the use of the complete distribution of differential expression as well as the probabilistic rather than binary assignment of genes to functional categories such as go by using a probabilistic categorical data analysis approach. comparing a new, experimentally derived gene list to other, predefined lists of functionally related genes, while widely used, has its limitations. despite the large number of such gene lists, they are often not adequate for precisely characterizing functional consequences of experimentally derived genomics profiles. first, functional relationship does not necessarily imply co-expression or co-regulation. for example, only a fraction of genes associated with the same go term also exhibit coordinated gene expression . consequently, a potentially large portion of genes belonging to a functional category or pathway will never be informative about the association between a genomics profile and the pathway. second, gene lists associated with a biological concept or process are often incomplete .page: 71 7077we implemented our new approach and the other methods listed inand performed a comparison study using expression data from primary human breast cancers and the connectivity map . we then evaluated each method based on their ability to correctly identify a target signature concordant with a query signature among a number of unrelated decoy signatures. this approach allows us to estimate the specificity and sensitivity of each method, while mimicking the functional analysis by primary genomics data where the researcher compares a new dataset (query) to a diverse collection of existing genomics datasets (references) in order to identify gene signatures that are similar to the query.we have developed a new method to assess the concordance of gene signatures. the new method was compared with other existing methods evaluating their ability to identify genomics datasets similar to a query dataset based on their respective gene signatures. the ultimate goal of such analysis is to use the phenotypic characteristics of the identified reference sets to elucidate underlying molecular functions of the genomic profile in the new dataset. comparisons were made with methods specifically used in this context, as well as alternative statistical methods that are applicable in this setting. all of the currently used methods (epsa, exalt, cs and lrpath) use a significance cutoff to designate which genes are differentially expressed in the query dataset. however, the a priori choice of the optimal cutoff is a difficult problem. a too restrictive cutoff leads to a low number of genes in the signature, particularly in experiments with small sample sizes. choosing less restrictive) to compute the epsa score for two sets of query and corresponding reference signatures as described (n = 5) and compute the respective roc curves. query set 1 is a set of compound-vehicle comparisons with a relatively large number of genes with low p-values. set 2 is a more difficult set of comparisons where the number of differentially expressed genes for each signature and cutoff is lower. for set 1, the fdr cutoff results in a better roc curve than for p-value cutoff (upper two curves) while for set 2, the less conservative p-value cutoff produces a better roc curve than the fdr cutoff (lower two curves). cutoffs, on the other hand, often leads to high numbers of genes in the signature which then results in reduced specificity when computing the concordance measures. to illustrate the impact of the cutoff choice on subsequent concordance analyses, we used the connectivity map data to first calculate the epsa score for two sets of query and corresponding reference signatures as described (n = 5) each time using (i) a stringent significance cutoff (fdr 0.1) and (ii) a less conservative one (p 0.01). we then computed the respective roc curves . query set 1 is a set of compound-vehicle comparisons with a relatively large number of genes with low p-values. set 2 is a more difficult set of comparisons where the overall number of significant p-values is lower for each signature and cutoff choice (supplementary). in the former case, the fdr cutoff was the better choice (i.e. the roc curve for the fdr cutoff is above the curve for the p-value cutoff) as it resulted in query signatures that were more informative for the concordance assessment compared with a larger signature based on a less-conservative cutoff containing many uninformative genes. in the latter case, however, fdr proved to be too restrictive not producing a sufficiently large gene signature and the p-valuebased cutoff was the better alternative still producing signatures with informative genes. that is, roc curves for set 2 overall are worse than for the less difficult set 1 but the curve for the p-value cutoff is above the non-informative roc curve for the fdr cutoff in this case . in an elegant theoretical analysis within their unifying rs framework,showed that in certain situations (small number of very significant genes), methods based on categorizing genes can outperform methods that rely on the complete expression profiles in the traditional enrichment analysis by gene lists. while it is possible that this result holds in the context of enrichment by primary data, our procedure indicates that it is probably impossible to a priori define optimal significance cutoffs for assessing the concordance of gene signatures. consequently, one may always be better off using methods that do not rely on defining such cutoffs. alternative simple statistical methods that do not require specifying statistical significance cutoffs (correlation coefficients, wilcoxon test) showed surprisingly strong performance in the breast cancer datasets analysis, but performed worse than other methods based on selecting differentially expressed genes (epsa, exalt, cs and lrpath) in the more difficult connectivity map data. our analysis in which we progressively remove the signal by random re-labeling of genes indicates that simple methods perform well when most genes are differentially expressed, but their performance deteriorates when only a fraction of genes are concordant. this could be explained by the fact that if most genes are differentially expressed and concordant, using all genes is better than losing many informative ones due to imperfect statistical power of the differential expression analysis. the fact that our grs method performs as well as, or better than, any other method in all settings implies that it is capable of correctly weighing the contribution of different genes based on the statistical significance of their differential expression. our results indicate that simple methods utilizing complete gene expression profiles (correlation, wilcoxon) and methods that rely on preselecting differentially expressed genes (epsa, exalt, cs and lrpath) both have domains of superiority. however, our procedure performs optimally in all settings and in difficult situations (such as the connectivity map data) clearly outperforms all tested alternatives. our method provides additional means to functionally annotate newly generated genomics data exploiting the vast number of datasets publicly available through repositories such as geo . it is readily available as part of the add-on r package clean and through our web interface genomics portals . the online version (http://genomicsportals.org) facilitates the use of datasets uploaded by the user as well as using any one of the 2000 primary genomics datasets currently deposited in the genomics portals as query and reference datasets.  
