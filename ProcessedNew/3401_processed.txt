oxbs-mle: an efficient method to estimate 5-methylcytosine and 5-hydroxymethylcytosine in paired bisulfite and oxidative bisulfite treated dna motivation: 5-methylcytosine (5mc) and 5-hydroxymethylcytosine (5hmc) are important epigen-etic regulators of gene expression. 5mc and 5hmc levels can be computationally inferred at single base resolution using sequencing or array data from paired dna samples that have undergone bisulfite and oxidative bisulfite conversion. current estimation methods have been shown to produce irregular estimates of 5hmc level or are extremely computation intensive. results: we developed an efficient method oxbs-mle based on binomial modeling of paired bisul-fite and oxidative bisulfite data from sequencing or array analysis. evaluation in several datasets showed that it outperformed alternative methods in estimate accuracy and computation speed. availability and implementation: oxbs-mle is implemented in bioconductor package enmix. contact:5-methylcytosine (5mc) is an essential epigenetic mark that regulates cell differentiation and gene expression. 5mc can be oxidized to 5-hydroxymethylcytosine (5hmc) by activity of the ten-eleven translocation (tet) enzyme . 5hmc can function differently from 5mc in transcriptional control and is prevalent in embryonic stems cells . thus, it is desirable to separately quantify 5mc and 5hmc levels at single base resolution. traditional bisulfite (bs) treatment commonly used in genomewide methylation studies cannot distinguish 5mc from 5hmc: both are protected from conversion while unmodified cytosines are converted to uracil (u). selective oxidation of 5hmc to 5-formylcytosine (5fc) can be achieved by treatment with potassium perruthenate (kruo4), and 5fc converts to u following bisulfite treatment . 5hmc level can be estimated using paired experiments on a dna sample: bisulfite converted dna can be used to estimate the proportion of 5mc 5hmc and oxidative bisulfite (oxbs) converted dna can be used to estimate the proportion of 5mc. measurement can be done in a genome-wide manner using sequencing techniques, e.g. oxbs-seq ; or for specific loci using array techniques, e.g. oxbs-450k and oxbs-array .be non-negative. to overcome the limitation, a statistical approach, oxybs was proposed to estimate 5hmc and 5mc levels by assuming beta distributions for the two measurements. a limitation of this approach is that it is too computationally intensive for large studies. here we propose a computationally efficient method oxbs-mle (mle stands for maximum likelihood estimate) to jointly estimate 5mc and 5hmc levels from the paired experimental data. evaluations in real datasets show that it outperforms oxybs and the navenave method. oxbs-mle has been implemented in the bioconductor package enmix .to evaluate oxbs-mle and compare it with alternative methods, we applied the oxbs-mle, oxybs and the navenave subtraction method to the methylation 450k array data (geo accession number gse63179) from , which have undergone the correction for infinium i and ii probe design bias using subset-quantile with array normalization (swan) by. the data consist of eight arrays for four replicates of a single cerebellum sample (two arrays, bs or oxbs treated, for each replicate). the qpcr measurements of 5hmc level for 27 cpg sites on the array were also available and thus can be used as gold standard to evaluate the accuracy of the 5hmc estimates from array data with different methods. evaluations showed that methods oxbs-mle and oxybs provided almost identical 5hmc estimates with maximum absolute difference of 0.005 across all cpg sites and all four replicates, while the navenave method produced a significant portion of negative 5hmc estimates (1238.4 in each replicate). to evaluate the accuracy of 5hmc estimates, we first averaged the four replicate estimates with each method at the 27 cpg sites and then calculated the absolute difference between the averages and the corresponding qpcr measurements. the results showed that oxbs-mle and oxybs estimates are almost identical and both outperformed the navenave method (student paired t-test p 0.025 for either comparisons). method oxbs-mle and oxybs also produced similar estimates of 5mc at majority of the cpg sites with only 0.039 of the estimates having absolute difference greater than 0.01 between the two methods. however, when the beta value from bs experiment is smaller than that from the corresponding oxbs experiment, oxbsmle and oxybs tend to produce different 5mc estimates with maximum difference of 0.28 in the evaluation. especially when bs measurement is very small, oxybs method can result in irrational estimates of 0 no matter what the oxbs measurement is (supplementary). we observed the similar phenomenon in other datasets (data not shown). we also noticed that for most cpg sites (71.4, 286 752 out of 401 866) the oxbs-mle estimates of 5mc are closer to the measurements from oxbs experiment (oxidative bisulfite experiments aim to measure 5mc level) than the oxybs estimates; the percentage of such cpg sites in infinium i probes (69.9) is similar to that in infinium ii probes (72.0). we note that oxbs-mle is $5000 times faster than oxybs when both methods were applied to the above geo data (0.7 second versus 62 minutes for eight arrays on a machine with 2.6ghz cpu). this is because that oxybs uses an iterative method to find mle while oxbs-mle calculates mle using an explicit analytical form. the computation in the method oxybs is done sample by sample, and thus the computing time will increase linearly with sample size. the computing time for 1000 samples (2000 arrays) is expected to be $257 h for oxybs while oxbs-mle takes only 3 minutes. it is easy to see that the oxbs-mle method assumption is even more suitable for sequencing data. however, we were not able to find oxbs sequencing data with additional qpcr/pyrosequencing validation. in summary, oxbs-mle is an efficient and accurate method to jointly estimate 5mc and 5hmc levels in paired bs-and oxbstreated experiments.  
