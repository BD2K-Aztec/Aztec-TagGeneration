gene expression applying stability selection to consistently estimate sparse principal components in high-dimensional molecular data motivation: principal component analysis (pca) is a basic tool often used in bioinformatics for visualization and dimension reduction. however, it is known that pca may not consistently estimate the true direction of maximal variability in high-dimensional, low sample size settings, which are typical for molecular data. assuming that the underlying signal is sparse, i.e. that only a fraction of features contribute to a principal component (pc), this estimation consistency can be retained. most existing sparse pca methods use l1-penalization, i.e. the lasso, to perform feature selection. but, the lasso is known to lack variable selection consistency in high dimensions and therefore a subsequent interpretation of selected features can give misleading results. results: we present s4vdpca, a sparse pca method that incorporates a subsampling approach, namely stability selection. s4vdpca can consistently select the truly relevant variables contributing to a sparse pc while also consistently estimate the direction of maximal variability. the performance of the s4vdpca is assessed in a simulation study and compared to other pca approaches, as well as to a hypothetical oracle pca that knows the truly relevant features in advance and thus finds optimal, unbiased sparse pcs. s4vdpca is computationally efficient and performs best in simulations regarding parameter estimation consistency and feature selection consistency. furthermore, s4vdpca is applied to a publicly available gene expression data set of medulloblastoma brain tumors. features contributing to the first two estimated sparse pcs represent genes significantly over-represented in pathways typically deregulated between molecular subgroups of medulloblastoma. availability and implementation: software is available at https://github.com/mwsill/s4vdpca. contactprincipal component analysis (pca) is the most popular method for dimension reduction and visualization that is widely used for the analysis of high-dimensional molecular data. in bioinformatics typical applications range from outlier detection as part of quality control to exploratory data analysis for revealing new molecular subgroups , as well as pathway and network analysis . common biological data sets for such applications are continuous molecular data typically generated by high-throughput profiling techniques, e.g. gene expression, copy number variation, methylation and micro rna expression data. in general, pca aims to project a high-dimensional data matrix into a lower dimensional space by seeking linear combinations of the original variables, called principal components (pcs). by construction, these pcs capture maximal variance and are orthogonal v c the author 2015. published by oxford university press.the results of the simulation study comparing the s4vdpca to rspca using different penalization functions, conventional pca and oracle pca are shown inand 2.displays the median angles between the estimated and the true loadings vectors on a heat color scale. simulation scenario were defined by all possible combinations of the spike index a and the sparsity index b, themedian was calculated over 100 simulation runs. furthermore, the 10 and 45 median angles are indicated by contour lines. in addition, true positive rates (tpr) and simulation results for other tuning parameters are shown in the supplementary material., i.e. rspca using the adaptive lasso with c 0:5 and c 2 and s4vdpca with weakness parameter j 0:5 and j 0:8. as already shown in theory by jung and marron (2009), conventional pca is strongly inconsistent as long as the strength of the underlying signal is weak, i.e. for spike indices a [ 0:45. with increasing a the pca estimates get closer to the true eigenvector, thereby achieving marginal consistency for a z 0:45 (as indicated by the 45 degree contour line) and consistency for a z 1. the behaviour of the consistency is independent of the sparsity of the underlying signal, e.g. the sparsity index b . however, if the underlying signal is sparse and b a, all considered sparse pca methods can consistently estimate the first loadings vector and become marginally consistent for b a (e). the oracle pca, which knows the true non-zero coefficients, gives unbiased estimates of the non-zero coefficients and therefore the best possible sparse solutions that are closest to the underlying first eigenvector of the population covariance matrix. the sparse loadings vectors estimated by the s4vdpca are in all situations slightly closer to the unbiased, oracle estimates than rspca estimates using any considered penalty function. for b 0:2 the 10 degree contour line of the s4vdpca is always closest to the marginal consistency boundary (b a). furthermore, the 45 degree contour line lies in most situations further to the left hand side of the marginal consistency boundary. if the true eigenvector is very sparse and the signal is weak, i.e. b 0:3 and a 0:3, both the rspca and the s4vdpca become marginally inconsistent in estimating the true eigenvector, even if a b.displays the median fdr for the different rspca methods (, c and d) and the s4vdpca . the median fdr was calculated over 100 simulation runs and for all combinations of a and b, as described in the simulation design above. the fdr is shown on a heat color scale and median levels of 0.05 and 0.5 are indicated by contour lines. for relatively weak signals, starting at a 0:4, the rspca methods and s4vdpca tend to falsely select coefficients resulting in fdrs around 0.05, especially in situations where the true signal is less sparse b 0:5. when a 0:25 and b 0:9 the fdr increases dramatically to 0.5. in situations where sparse pca methods are expected to consistently estimate the direction of the true eigenvector, i.e. a b and b 0:2, the fdr for the rspca with the lasso is around 0.05 . this expected behaviour reflects the known variables selection inconsistency of the lasso in high dimensions . in these simulation settings the unbiased coefficients are relatively large (a b), so that the penalization chosen by the gic is not sufficient to screen out irrelevant variables that are correlated with truly relevant variables. both the adaptive lasso and scad penalty are known to possess the oracle property and are thus expected to select only truly relevant variables and achieve approximately unbiased estimates. nevertheless, the simulation results show that both penalties tend to select additional irrelevant variables in simulation settings where the signal intensity a and sparsity b are nearly equal (depicted by the orange tail along the diagonal in, c and d), i.e. around the marginal consistency boundary (b a). this behaviour is more pronounced for the scad penalty compared to the adaptive lasso. in contrast, in almost all simulation settings where a b the s4vdpca identifies the true non-zero coefficients without adding any irrelevant features. therefore, we can conclude, that particularly in the challenging settings where b a, the selection probabilities estimated by the s4vdpca can successfully be used to filter the truly relevant features withouth selecting as many false positves as the rspca methods.to demonstrate practicability to find sparse and interpretable pcs in high-dimensional molecular data sets, the proposed s4vdpca method was applied to a gene expression data set of medulloblastoma brain tumors . medulloblastoma is the most common malignant pediatric brain tumor and comprises four distinct molecular variants. these subgroups are known as wnt, shh, group c and group d. wnt tumours show activated wnt signaling pathway and carry a favourable prognosis. shh medulloblastoma show hedgehog signaling pathway activation and are known to have an intermediate to good prognosis. while both wnt and ssh variants are molecularly already well characterized, the genetic programs driving the pathogenesis of group c and group d medulloblastoma remain largely unknown. here we applied the proposed s4vdpca method to gene expression data of 8 group c, 20 group d, 20 shh and 16 wnt tumors. gene expression has been measured by the 4x44k agilent whole human genome oligo microarray. after normalization and quality control the data set comprised gene expression values of 18406 annotated genes. the data set is publicly available at the national center for biotechnology information (ncbi) gene expression omnibus (geo) database, accession no. gse28245. the first two sparse pcs have been extracted by applying the s4vdpca and the results are visualized as biplot representation in. the loadings vector of the first sparse pc comprises 2035 non-zero coefficients and the second pc involves 1532 non-zero coefficients. the biplot displays the projection of the tumor samples onto the two sparse pcs while also visualizing the covariance structure of the selected genes within this rank two approximation by grey arrows. each arrow represents a gene and the length of the arrow reflects the size of the corresponding coefficient in the two loadings vectors. arrows that point in similar directions represent positive correlated genes. arrows parallel to a pc axis are genes with a non zero loadings coefficient only in one of the two loadings vectors of the two pcs. the four molecular subgroups can clearly be separated by projecting the samples in the space spanned by the first two sparse pcs. while most wnt and shh medulloblastomas form clusters far away from samples of other subgroups, group d and group c tumors are closer to each other. a set of 2035 genes is still too large for a reasonable interpretation, but the most dominating genes, i.e. those showing the highest absolute coefficients can be highlighted. in, 15 prominent oncogenes with a high absolute coefficient have been highlighted, including sfrp1 and its transcription factor gli1. both arrows point away from the wnt samples into the direction of shh medulloblastoma. this means that the sfrp1 expression is up-regulated in shh tumors and down-regulated in wnt sample and matches the current knowledge that sfrp1 is a tumor suppressor gene responsible for hedgehog signaling mediated regulation of the wnt signaling pathway. moreover, the arrows of dkk1 and wif1, which are known target genes of the wnt signaling pathway, both point in direction of the wnt medulloblastoma. fstl5, a known marker for poor prognosis in non-wnt/non-shh medulloblastoma , points into a direction of group c and group d tumors. since the loadings coefficient of fstl5 is zero in the second pc the arrow for fstl5 is parallel to the first pc.however, individual interpretation of all non-zero coefficients is still too complex. an alternative way to try to understand the importance of the genes selected by sparse pca methods is to perform a pathway analysis. here we performed hypergeometric testing of the genes selected in the first and second pc to evaluate whether these genes are overrepresented in kegg pathways (kyoto encyclopedia of genes and genomes;). to perform this analysis the r/bioconductor package htsanalyzer was used . the top six pathways most significantly overrepresented by genes selected in the first and second pc are shown as graphs above and to the right of the biplot. each node or circle of the graph represents a pathway and the size of each node is proportional to the number of genes assigned to that pathway. pathways are connected by edges and the width of each edge is proportional to the number of genes shared by two pathways. the white-red coloring of the nodes corresponds to fdr adjusted p-values that are also shown in the supplementary material. among the top six pathways overrepresented by genes selected in the first sparse pc are the wnt signaling pathway and neuroactive ligandreceptor interaction. even though these pathways include a wide range of genes, both pathways are expected to be deregulated in medulloblastoma. interestingly, genes selected in the second, sparse pc are also significantly overrepresented in the wnt signaling pathway and the hedgehog signaling pathway. this result directly reflects the known interaction between these two pathways and is in agreement with the biplot where the largest distances between wnt and shh samples are along the axis of the second pc. similar results calculated by applying conventional pca, the rspca with lasso, rspca adaptive lasso and the rspca with scad penalty are shown in the supplementary material.  
