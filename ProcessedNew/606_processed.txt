automated profiling of individual cellâ€“cell interactions from high-throughput time-lapse imaging microscopy in nanowell grids (timing) motivation: there is a need for effective automated methods for profiling dynamic cellcell interactions with single-cell resolution from high-throughput time-lapse imaging data, especially, the interactions between immune effector cells and tumor cells in adoptive immunotherapy. results: fluorescently labeled human t cells, natural killer cells (nk), and various target cells (nalm6, k562, el4) were co-incubated on polydimethylsiloxane arrays of sub-nanoliter wells (nanowells), and imaged using multi-channel time-lapse microscopy. the proposed cell segmenta-tion and tracking algorithms account for cell variability and exploit the nanowell confinement property to increase the yield of correctly analyzed nanowells from 45 (existing algorithms) to 98 for wells containing one effector and a single target, enabling automated quantification of cell locations , morphologies, movements, interactions, and deaths without the need for manual proofreading. automated analysis of recordings from 12 different experiments demonstrated automated nanowell delineation accuracy 99, automated cell segmentation accuracy 95, and automated cell tracking accuracy of 90, with default parameters, despite variations in illumination, staining, imaging noise, cell morphology, and cell clustering. an example analysis revealed that nk cells efficiently discriminate between live and dead targets by altering the duration of conjugation. the data also demonstrated that cytotoxic cells display higher motility than non-killers, bothdynamic cell behaviors, especially cellcell interactions, are of vital interest in immunology , cancer biology and stem cell engineering . automated time-lapse microscopy of live cells in vitro is a well-established method for spatiotemporal recording of cells and biomolecules, and tracking multi-cellular interactions. unfortunately, most conventional methods assess limited numbers (10100) of manuallysampled representative cell pairs, leading to subjective bias and therefore lack the ability to quantify the behaviors of statistically under-represented cells reliably. this is significant since many biologically significant cellular subpopulations like tumor stem cells, multi-killer immune cells and biotechnologically relevant protein secreting cells, are rare. there is a need for methods to sample cellcell interaction events on a larger scale to investigate such cellular phenomena. recent advances have enabled the fabrication of large arrays of sub-nanoliter wells (nanowells) cast onto transparent biocompatible polydimethylsiloxane substrates (;). small groups of living cells from clinical samples, and laboratory-engineered cells can be confined to nanowells, and imaged over extended durations by multi-channel time-lapse microscopy, allowing thousands of controlled cellular events to be recorded as an array of multi-channel movies . we refer to this method as time-lapse imaging microscopy in nanowell grids (timing). the spatial confinement can enable a rich sampling of localized cellular phenomena, including cell movements, cellular alterations, and cellcell interaction patterns, along with the relevant intra-cellular event markers . timing is thus ideally suited for tracking cell migration and interactions at short distances but if cell migratory patterns over larger distances are of interest, arrays with larger wells can be fabricated. similarly, if unconfined migratory behavior of cells is desired, other methods have been described . the promise and challenge of nanowell arrays, is high throughput, eliminating the need for user selection of events of interest, and the ability to repeatedly follow the same cell(s) over time.illustrates a timing dataset consisting of 11 000 nanowells containing fluorescently tagged human car t-cells (red) and nalm-6 tumor cells (green) that were imaged by time-lapse microscopy over 80 time points at 5-min intervals to yield an array of 4-channel movies, one per nanowell. the border nanowells from each block are discarded, yielding 25 usable nanowells/block. timing datasets vary in size between 200 gb and 1.5 tb depending upon the array size, and the number of time points. a sample timing dataset corresponding to one block is provided as supplementary material a. production datasets are often of lower quality than the example in, for example, see (4) and exhibit natural cellular variability, variations in signal to noise ratio (snr), staining variations, focus drift, spectral overlap between fluorochromes and photobleaching. our goal is to develop highly automated pipeline of algorithms that can reliably segment and track the cells in timing datasets with minimal parameter tuning, and yield a sufficiently rich set of cellularscale measurements for statistical profiling, without the need for manual proofreading (supplementary material b). a direct application of general-purpose segmentation and tracking algorithms is not a viable strategy since their yield (the number of correctly analyzed nanowells) is surprisingly low, and their parameter tuning needs are high. for example, a direct application of alsegmentation algorithm with a reported accuracy 95 that is the core of the opensource farsight toolkit (farsight-toolkit.org) to the dataset inproduces an error-free yield of only 43 of the nanowells for the basic case when a nanowell contains one effector and one target . the situation with tracking algorithms is similar. for example, in analyzing one sample block containing 36 nanowells, out of which 21 contained at least one cell, a state-of-the art algorithm accurately tracked only six nanowells withan array of 168 70 nanowells arranged in blocks of 7 7 (with 5 5 usable inner nanowells/block). (b) enlarged views of five blocks highlighted by the red box in panel a. (c) timeseries data at 5-min intervals for the nanowell highlighted by the red box in panel b. (d) enlargement of a single frame of the time-lapse series for the nanowell shown in panel c, showing 3 nalm-6 target cells (green), one cd19-specific car t-cell (red, lower right) in contact with a target cell (contact region appears yellow) and a red fluorescent debris particle that is rejected in the analysis (left edge) (color version of this figure is available at bioinformatics online.). illustrating automated image analysis challenges. (ah) sample image frames. the red arrows indicate unclear boundaries between adjacent cells. the yellow arrows highlight low-intensity cells that are difficult to detect. the green arrows highlight cells that are difficult to segment due to non-uniform fluorescence. panels a, b, d, e and f exemplify frames with low contrast and snr. (i) mean and standard deviation (error bars) of the background intensity (dark gray) and the foreground intensity (light gray) for the panels ah. (j) variation in fluorescence distribution both across the pixels associated with one cell, and across cells. the red and blue histograms correspond to the cell indicated by the red and blue dots, respectively, in panel h (color version of this figure is available at bioinformatics online.) zero errors (yield of 28) (supplementary material c). when the yield falls below 90, manual proofreading is essential to identify the nanowells that were tracked accurately. if on the other hand, when the automated accuracy exceeds 90, the user can simply accept the automated results, and the modest error that they entail. general-purpose segmentation and tracking algorithms are inadequate because they do not exploit the powerful constraints that are germane to timing datasets, specifically, the spatial confinement of cells and rarity of cell divisions. they also lack mechanisms to cope with the higher morphological variability and non-uniform fluorescence of cell bodies compared with cell nuclei that were heavily studied in the prior literature . in this article, we present algorithms that exploit the confinement and cell-cycle constraints, and utilize novel segmentation approaches to increase the yield to 98 for the basic case noted above (results section, compareversus), and deliver high tracking accuracies . at this level of performance, the quantitative measurements derived from automated segmentation and tracking can be directly utilized for statistical studies without the need for manual proofreading. the following sections describe our methodology.  
