scaffoldscaffolder: solving contig orientation via bidirected to directed graph reduction motivation: the contig orientation problem, which we formally define as the max-dir problem, has at times been addressed cursorily and at times using various heuristics. in setting forth a linear-time reduction from the max-cut problem to the max-dir problem, we prove the latter is np-complete. we compare the relative performance of a novel greedy approach with several other heuristic solutions. results: our results suggest that our greedy heuristic algorithm not only works well but also out-performs the other algorithms due to the nature of scaffold graphs. our results also demonstrate a novel method for identifying inverted repeats and inversion variants, both of which contradict the basic single-orientation assumption. such inversions have previously been noted as being difficult to detect and are directly involved in the genetic mechanisms of several diseases. availability and implementation: http://bioresearch.accurate and efficient genome assembly algorithms are essential to unlocking solutions to challenges posed by genetic disease. insufficient molecular sampling and repetitive regions in the dna prevent full chromosomal assembly from next-generation sequencing reads, causing assembly algorithms to produce a large set of partially reconstructed chromosomes termed contigs. contigs must be oriented and positioned to reconstruct full chromosomes using paired-read data to infer positional and orientational relationships between contigs. we define a scaffolding of two contigs as the relative positioning and orientation of contigs weighted by the multiplicity of supporting paired reads. the problem of scaffolding is often modeled as a graph where vertices are contigs and weighted edges indicate scaffoldings of contigs. the goal in scaffolding is to find a hamiltonian path that incorporates each non-repeat contig sequence once. as a subtask of scaffolding, the contig orientation problem describes the challenge of assigning each contig a single orientation (as per the singleorientation assumption) so as to minimize conflicting orientation evidence. more specifically, the goal is to remove the minimum number of edges from the scaffold graph, so that the remaining subgraph suggests a single consistent orientation of all vertices . solving the contig orientation problem is one step to reducing erroneous linking evidence in the scaffold data. the contig orientation problem has been equated to the weighted max-cut problem , the bipartite graph problem and the odd cycle transferal problem . solutions have included energy cost minimization , a fixed-parameter algorithm , mixed integer programming , depth-first search and greedy bipartite graph coloring . several solutions to the more general problem of scaffolding do not explicitly solve the contig orientation problem but provide implicit contig orientationsolutions as a result of completing walks through the scaffold graph . formal bidirected graph notation [as first laid out by edmonds and] has a long history in both computer science and bioinformatics research but has rarely been employed to represent scaffold graphs . commonly used is a notation in which directed nodes are depicted using some sort of biterminal distinction: one node terminal represents the biological 5 0-end of the contig sequence and the other terminal represents the 3 0end . edges are then connected between the terminals or ends of a node. in this notation, a valid reconstruction or walk through a node requires entering and exiting the node via opposite terminals. the bidirected graph paradigm when applied to scaffold graphs enables new approaches to scaffolding problems, as will be shown. research on the max-cut problem has yielded a number of effective approximation algorithms including a min-max cut algorithm , a randomized linear-time 1/2approximation and branch-and-bound methods . goemans and williamson (1994) present what is commonly accepted as the best max-cut approximation algorithm (a 0.878-approximation) by randomly rounding the solution to a nonlinear-programming relaxation.demonstrate that if the unique games conjecture is true, the goemanswilliamson algorithm is the best possible approximation algorithm for max-cut. the np-completeness of the contig orientation problem has not hitherto been formally proven. we provide such a proof, demonstrating the many-one polynomial-time equivalence of the contig orientation and weighted max-cut problems. we present a novel greedy solution and demonstrate its effectiveness compared with several max-cut solutions.we noted a peculiarity in the subgraph produced using our greedy heuristic on the synthetic genome without errorsthe two excluded edges were both adjacent to contig 591. we also noted that contig 591 has an average sequence depth (a value indicative of the number of nucleotides contributing to the assembly at a given locus) of roughly twice the normal diploid depth, making it a likely candidate for being a two-copy repeat. we used blast to find where contig 591 aligned to the known reference. we discovered that it aligned perfectly at two locations and that the two matching sequences were inversions (see supplementary material). this case illustrates that if repeats are not screened, they can present exceptions to the contig-orientation problem and more specifically to the single-orientation assumption. the single-orientation assumption will hold only if the contig represents a sequence which repeats in the same orientation in a scaffold (e.g. tandem repeats). inverted repeats, like contig 591, represent identical sequences with opposite orientations from two distinct places in a scaffold . among their several biological roles, inverted repeats are used to detect the boundaries of transposons and are instrumental in transcriptional regulation . assigning a single orientation to such a contig prevents a viable scaffold reconstruction from occurring, prematurely fragmenting the assembly. this scenario can be resolved prior to assigning contigorientations by special handling or screening of repeat contigs . this example shows that in addition to removing erroneous linkages from a scaffold graph, the contig orientation assignment will remove any viable biological scenario that is an exception to the single-orientation assumption. thus, if the erroneous linkages can be filtered via other means (e.g. minimum support threshold and next-generation error correction), the contig orientation assignment can be used to identify (via exclusion) biologically viable exceptions to the single-orientation assumption. one other such exception is the case of inverted haplotypes. many genomes exist as diploid or polyploid organisms, meaning there are two or more versions (termed haplotypes) of the genome in each cell. an inverted haplotype is a sequence, which is identical but oppositely oriented at corresponding locations on analogous chromosomes . such inversions are often biologically significant and have been specifically shown to be associated at times with mental retardation, microdeletion syndrome, renal cysts and diabetes syndrome, epilepsy, schizophrenia and autism . most assembly algorithms have not been specifically designed for diploid genome assembly and assume that where multiple haplotypes do exist, they can be readily merged to form a single reference sequence. in doing so, inverted haplotype differences are metaphorically swept under the rug, which is perhaps why biologists have lamented that unlike other types of structural variation, little is known about inversion variants within normal individuals because such events are typically balanced and are difficult to detect and analyze by standard molecular approaches . just as a contig orientation solution is able to identify inverted repeats, it is also able to identify inverted haplotypes. we developed a module in scaffoldscaffolder to automatically generate a detailed report of potential inverted repeats and inverted haplotypes. in the module, candidates are internally identified as any contig (i) having at least two connecting edges from at least one end and (ii) which is connected to two or more excluded edges. the candidates can be classified as inverted repeats or inverted haplotypes based on the location of each candidate contig in a probability density function of contig coverage. a special case is a monocontig inversion candidate, which requires that each of two adjacent contigs be linked via edges from both ends of the candidate. we tested our new predictive module on both synthetic and real data. we first synthesized a diploid genome (heterozygosity rate 0.2) containing an inverted haplotype from the zebra finch chromosome 25. we generated error-free reads for assembly with newbler, and a graph was created using scaffoldscaffolder. using our greedy heuristic algorithm, we assigned orientations to the contigs which resulted in a subgraph which excluded 12 edges. the. average weight of included/excluded edges. although the average weights of included/excluded edges vary as a function of the overall average edge weight, the weight of edges excluded by the greedy algorithm remains close to 0. this suggests that the greedy algorithm is excluding primarily erroneous edges. violations of the single-orientation assumption. (a) in an inverted repeat, a sequence (contig a) is included in the reconstruction twice in opposite orientations. (b) in a polyploid genome, an inverted haplotype is a sequence (contig b) included in opposite orientations on different haplotypes potential inversion report listed three inversions (two with sequencing depth to suggest inverted repeats). we verified that all three inversions were accurate using blast and verified that the (nonrepeat) inverted haplotype aligned at the expected location in the reference haplotype sequences (see supplementary material). to confirm our ability to predict inverted haplotypes in real data, we identified a 18.7 kb inverted haplotype (hsinv0393) from the human polymorphic inversion database (martnez) that has been found to be heterozygous in human hapmap individual na19240 . from this individual, we assembled paired illumina reads mapping to a 64 kb segment of chromosome x in the region of hsinv0393. we created a small graph of the assembled region with scaffoldscaffolder using the same paired reads. the greedy heuristic algorithm assigned contig orientations, excluding two well-supported edges. the algorithm identified a 9.4 kb inversion, contig 3, that when mapped to the hg19 reference aligned in the region defined for hsinv0393. in addition, the two 4.65 kb contigs scaffolded on either side of this inversion (contigs 2 and 4) were also identified as inverted repeats. this arrangement in the scaffold graph (summarized in) suggests not only that contig 3 is inverted but that possibly some or all of contigs 2 and 4 are also part of the inversion (hence why many inversion breakpoints are reported as ranges). we observe that distinguishing between an inverted haplotype and a non-inverted sequence flanked by inverted repeats is impossible by this approach without pairs that span beyond the inverted repeats (which in the case of na19240 were unavailable). ongoing development and testing will help to assess the efficacy of this inversion detection method on a larger scale. however, both the theory and our small tests confirm that edges which are excluded in solving the contig orientation problem are suggestive of inverted repeats and inverted haplotypes in de novo assemblies, particularly when such sequences are adjacent to multiple or heavily supported excluded edges. the contig orientation problem, which we have formally framed as the max-dir problem, has at times been addressed (somewhat apologetically) only cursorily and at times using various heuristics. in setting forth a linear-time reduction from the max-cut problem to the max-dir problem, we have proven that the latter is npcomplete. we have compared the relative performance of our novel greedy approach with several other heuristic solutions. our results suggest that the greedy heuristic algorithm not only works well, but outperforms the other algorithms due to the nature of scaffold graphs. in such graphs, heavier-weighted edges are more likely to be valid and therefore included in the optimal solution. a greedy algorithm, which maximally favors such edges, approximates an ideal solution. one unanticipated outcome of this study has been the discovery of a novel method for identifying inverted repeats and inversion variants, both of which contradict the basic single-orientation assumption. such inversions have previously been noted as being difficult to detect and are directly involved in the genetic mechanisms of several diseases.thus, this method, which we have implemented as a module of scaffoldscaffolder, has the potential to assist in the automated discovery of biologically significant features in de novo genome assembly.  
