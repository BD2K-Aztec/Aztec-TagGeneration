gene expression length bias correction for rna-seq data in gene set analyses motivation: next-generation sequencing technologies are being rapidly applied to quantifying transcripts (rna-seq). however, due to the unique properties of the rna-seq data, the differential expression of longer transcripts is more likely to be identified than that of shorter transcripts with the same effect size. this bias complicates the downstream gene set analysis (gsa) because the methods for gsa previously developed for microarray data are based on the assumption that genes with same effect size have equal probability (power) to be identified as significantly differentially expressed. since transcript length is not related to gene expression, adjusting for such length dependency in gsa becomes necessary. results: in this article, we proposed two approaches for transcript-length adjustment for analyses based on poisson models: (i) at individual gene level, we adjusted each genes test statistic using the square root of transcript length followed by testing for gene set using the wilcoxon rank-sum test. (ii) at gene set level, we adjusted the null distribution for the fishers exact test by weighting the identification probability of each gene using the square root of its transcript length. we evaluated these two approaches using simulations and a real dataset, and showed that these methods can effectively reduce the transcript-length biases. the top-ranked go terms obtained from the proposed adjustments show more overlaps with the microarray results. availability: r scripts are atnext-generation sequencing has been rapidly applied to measure gene expression levels . the power of this application (rna-seq) in quantifying and annotating transcriptomes is striking. by obtaining tens of millions of short sequence reads from the transcript population of interest and to whom correspondence should be addressed. the authors wish it to be known that, in their opinion, the first two authors should be regarded as joint first authors. by mapping these reads to the reference genome, rna-seq produces digital signals (counts) rather than analog signals (intensities) in microarrays, and thus leads to highly reproducible results with relatively little technical variation . when enough reads are collected from a sample, it should be possible to detect and quantify rnas from all biologically relevant classes including low and moderate abundance . several methods have been proposed in the literature to calculate gene expression levels based on rna-seq data.adjusted the gene read count data by the length of the transcript.used the reads (or counts) per kilobase (kb) per million reads (rpkm) as the gene expression level, which adjusted the read counts by the sequencing depth (in units of million reads) in addition to the transcript length (in units of kb). the rpkm index facilitates comparison of expression measurements across different genes and different samples. based on a poisson model,proposed a more sophisticated method to measure the expression levels of a gene by taking into account all known isoforms of all genes. all above methods represent gene expression levels using normalized count data, which can be further processed and analyzed in a way similar to microarray data, such as empirical bayes method one of the unique features of rna-seq data is that the number of reads obtained from a gene depends on the transcript length. therefore, we have more power detecting differential expression for longer transcripts. it has been shown that, in rna-seq data, the proportion of significantly differentially expressed genes increases with the transcript length, while such bias is not present in microarray data . this length dependency can have major impact on gene set analysis (gsa), which tests sets of predefined genes based on existing knowledge for enrichment in a list of differentially expressed genes or for the treatment/condition effect on the gene set as a whole. gsa is commonly used in gene expression analysis for identifying pathways and gene ontology (go) terms. the significant go terms identified from the rna-seq data using existing procedures established for the microarray data tend to be enriched for longer genes. one purpose of conducting gsa is to rank predefined gene sets, such as pathways and go terms, according to their relevance to the biological question under study. gsa typically is a two-step process. the first step is to summarize the data using a gene-level statistic describing the degree of differential expression of individual genes, and possibly obtaining a list of significantly differentiallypage: 663 662669rna-seq is a rapidly growing technology that has the potential to replace microarray in profiling gene expression. however, when previously established methods for gsa were directly used on rna-seq data, gene sets that consist of longer genes tended to be identified as significantly enriched. in this article, we proposed two strategies to reduce such length dependency. the first strategy is to adjust the gene-level statistics by removing transcript-length dependency before applying a standard wilcoxon rank-sum test at the gene-set level. the second strategy is to adjust the gene set enrichment test by replacing the central hypergeometric distribution with wallenius non-central hypergeometric distribution in fishers exact test based on significant gene lists . our results showed that both strategies are effective in reducing length dependence in gsa analysis for rna-seq data. however, the wilcoxon rank-sum based strategy shows a substantial higher level of overlap with microarray results. the rna-seq technology is more sensitive to longer transcripts because it generates more reads from longer transcripts. therefore, we have more statistical power to detect longer transcripts for differential expression. however, in this situation, the statistical power not only reflects the standardized effect size and sample size but also reflects the transcript length. to our knowledge, transcript length has not been found to be relevant to biological processes. the detection bias for longer transcripts is arguably a candidate to be corrected in identifying differentially expressed genes from rnaseq data. our adjustments of gene-level statistics modify the length effect substantially at gene-level tests. however, the two methods, z 2 and z 3 , perform differently. z 2 reduces the positive length effect substantially but not completely removing it, while z 3 over adjusts the relationship to negative. further, fine-tuning these formulas is necessary to achieve ideal effect. transcript length bias in rna-seq is just one obvious bias to be corrected.found that the percentage of differentially expressed genes also depends on gene expression levels (number of reads). they proposed to remove this dependency using the same method as for the length bias if the investigator desires. we also saw similar bias along the number of reads from the marioni data. however, it is not clear to us that completely removing the expression intensity bias is biologically correct because there has been evidence showing that the level of stochastic expression of genes is associated with the level of gene expression . therefore, we decided not to pursue the adjustment for expression levels in the gsa analysis of rna-seq data here. if the adjustment is desired, a similar strategy as described here can potentially be applied to remove the expression level bias. in gsa, the transcript length dependency is also obvious. since one of our goals of conducting gsa analysis is to rank the gene sets based on pathways and go terms according to their relevance to the biological question under study for follow-up studies, the rank of gene sets identified from the gsa should only depend on biological relevant parameters, such as the fold change of the gene expression and/or the variation of the expression across samples. therefore, we believe that some adjustment for the transcript length bias is beneficial. the fishers exact test is a simple procedure for identifying over represented gene sets based on comparing a set of significantly differentially expressed genes against all genes under study. when a set of significantly differentially expressed genes is generated from the rna-seq data, this method is a natural and common choice for the gsa . however, it has been demonstrated that the go terms identified using this method tend to be the ones with longer transcripts if no adjustment is applied to the gene-level statistics. one solution for this problem is adjusting the null distribution used in the fishers exact test for obtaining p-values. to take into account of the transcript length in the null distribution, we used a non-central hypergeometric distribution with a noncentral parameter determined by the transcript length. the non-central parameter represents the average detection power difference between the genes in the go  
