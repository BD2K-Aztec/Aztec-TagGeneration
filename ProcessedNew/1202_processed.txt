crisprstrand: predicting repeat orientations to determine the crrna-encoding strand at crispr loci motivation: the discovery of crispr-cas systems almost 20 years ago rapidly changed our perception of the bacterial and archaeal immune systems. crispr loci consist of several repetitive dna sequences called repeats, inter-spaced by stretches of variable length sequences called spacers. this crispr array is transcribed and processed into multiple mature rna species (crrnas). a single crrna is integrated into an interference complex, together with crispr-associated (cas) proteins, to bind and degrade invading nucleic acids. although existing bioinformatics tools can recognize crispr loci by their characteristic repeat-spacer architecture, they generally output crispr arrays of ambiguous orientation and thus do not determine the strand from which crrnas are processed. knowledge of the correct orientation is crucial for many tasks, including the classification of crispr conservation, the detection of leader regions, the identification of target sites (protospacers) on invading genetic elements and the characterization of protospacer-adjacent motifs. results: we present a fast and accurate tool to determine the crrna-encoding strand at crispr loci by predicting the correct orientation of repeats based on an advanced machine learning approach. both the repeat sequence and mutation information were encoded and processed by an efficient graph kernel to learn higher-order correlations. the model was trained and tested on curated data comprising 44500 crisprs and yielded a remarkable performance of 0.95 auc roc (area under the curve of the receiver operator characteristic). in addition, we show that accurate orientation information greatly improved detection of conserved repeat sequence families and structure motifs. we integrated crisprstrand predictions into our crisprmap web server of crispr conservation and updated the latter to version 2.0. availability: crisprmap and crisprstrand are available at http://crispr-cas immune systems of bacteria and archaea provide adaptive defence against a variety of invading genetic elements. they have been classified into three major classes: types i, ii and iii, where type ii systems are confined to bacteria . the adaptive immune response of all types is divided into three major phases: (i) adaptation, the uptake of dna fragments from genetic elements and their insertion between consecutive repeats of a crispr array, generally adjacent to a leader sequence; (ii) processing of the crispr array transcripts within the repeats to generate small crrnas that derive from part or all of each spacer region and (iii) interference involving targeting and cleavage of an invading genetic element, or its transcripts, by cas proteincrrna complexes (barrangou and van der oost, 2013, and). whereas the adaptation phase is relatively conserved in the different crispr-cas systems, significant differences occur in the processing and interference mechanisms. thus, where type i and iii systems employ a cas6 processing endonuclease to cleave within the repeats, the bacterial type ii system uses the hostencoded rnase iii, together with a crispr-associated, transencoded tracrrna . furthermore, the various interference complexes exhibit considerable diversity . we developed an efficient tool for determining the strand from which mature crrnas are derived by focussing on the repeats at crispr loci. the repeats are unique within the crispr-cas system because they are the only element to play a vital role in all phases of immunity . thus, despite their relatively short lengths, each repeat carries essential structural parameters or sequence motifs that are recognized by enzymes or structural proteins involved in adaptation, crrna biogenesis and interference. paradoxically, however, the repeats are very heterogeneous, occurring in a range of lengths, 1948 nt, and display considerable sequence diversity. an early comparative study of crispr diversity yielded 12 main clusters with specific sequence characteristics; only a subset folded into characteristic hairpin structure motifs . more recently, a major reevaluation of crispr conservation was executed by, on a much larger data set of 3527 crisprs, where 40 conserved repeat sequence families were identified together with a total of 33 potential structural motifs. the repeat clusters were further classified into six superclasses, some of which showed strong biases to specific crispr subtypes and to certain bacterial or archaeal phyla . crispr loci are generally identified by their characteristic repeat-spacer architecture. for example crt and crisprfinder provide sensitive predictions of crispr arrays, but do not provide unambiguous orientation information. in the literature, orientation is derived to whom correspondence should be addressed. mainly by characteristic sequence motifs in the repeat, the detection of a conserved leader region in closely related crispr loci or by transcriptome experiments where the dominantly transcribed strand is determined. however, to date very few systems have been studied experimentally, and many large-scale studies require accurate orientation information for all available crispr arrays. recently,has presented the first tool to predict the orientation of crispr arrays. their model is essentially a linear predictor based on a number of features which comprise the presence of the attgaaan motif in repeats, a higher a or t content in the flanking regions of crispr arrays, nucleotide composition within the crispr array, the presence of mutations in specific parts of the array and the tendency to fold into a secondary structure. each feature is considered as an independent predictor and is given a weight proportional to its estimated precision. the final prediction is computed as the weighted combination of each predictor. knowledge of the correct repeat orientation is crucial for accurate characterization of crispr conservation and for subsequently studying mechanisms of adaptation, crispr rna processing and interference. in particular, it can help to (i) detect leader regions, currently poorly described in the literature; (ii) identify signals of transcription initiation and termination; (iii) determine the orientation of protospacers on invading genetic elements; and finally, (iv) characterize cognate protospacer-adjacent motifs (pams). thus, we consider that the repeat orientation tool presented here will be of critical importance for future crispr-based experimental studies.we presented a highly flexible approach to accurately predict the transcribed strand of crispr loci. the method is motivated by recent findings and encodes the most relevant information in the form of a graph structure that can be efficiently processed with graph kernel methods. our tool compares favourably against a recent approach proposed inin terms of accuracy (0.95 compared to 0.88 auc roc), runtimes (59 s rather than 37 min on a 1k sequences dataset) and coverage (we achieve 0.89 auc roc on the 10 sequences that the biswas tool fails to classify). our approach was integrated in crisprmap to improve the accuracy of the previously published classification of crisprs, and resulted in: (i) a comprehensive dataset with 44500 consensus repeats; (ii) the most recent classification of cas subtypes based on cas-protein occurrences for archaea ; and (iii) an improved annotation of makarova cas subtypes for bacteria respecting the rules published in. the orientation prediction approach that we have presented is fast, accurate and can be easily integrated in existing pipelines. in future work, we will employ it to ease the identification of novel targets (protospacers), pam motifs and the investigation of regulatory motifs in the leader sequences of crispr arrays.  
