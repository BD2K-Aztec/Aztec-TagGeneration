aligngraph: algorithm for secondary de novo genome assembly guided by closely related references motivation: de novo assemblies of genomes remain one of the most challenging applications in next-generation sequencing. usually, their results are incomplete and fragmented into hundreds of contigs. repeats in genomes and sequencing errors are the main reasons for these complications. with the rapidly growing number of sequenced genomes, it is now feasible to improve assemblies by guiding them with genomes from related species. results: here we introduce aligngraph, an algorithm for extending and joining de novo-assembled contigs or scaffolds guided by closely related reference genomes. it aligns paired-end (pe) reads and pre-assembled contigs or scaffolds to a close reference. from the obtained alignments, it builds a novel data structure, called the pe multipositional de bruijn graph. the incorporated positional information from the alignments and pe reads allows us to extend the initial assemblies, while avoiding incorrect extensions and early terminations. in our performance tests, aligngraph was able to substantially improve the contigs and scaffolds from several assemblers. for instance , 28.762.3 of the contigs of arabidopsis thaliana and human could be extended, resulting in improvements of common assembly metrics, such as an increase of the n50 of the extendable contigs by 89.994.5 and 80.3165.8, respectively. in another test, aligngraph was able to improve the assembly of a published genome (arabidopsis strain landsberg) by increasing the n50 of its extendable scaffolds by 86.6. these results demonstrate aligngraphs efficiency in improving genome assemblies by taking advantage of closely related references. availability and implementation: the aligngraph software can be downloaded for free from this site: https://github.com/baoe/ aligngraph.recent advances in next-generation sequencing (ngs) have made it possible to sequence new genomes at a fraction of the time and cost required only a few years ago. these improvements now allow experimental scientists to integrate genome sequencing approaches into their daily research. in the absence of a close reference genome, whole-genome shotgun ngs sequencing is the most common approach where a de novo assembly algorithm is used to join reads into longer continuous contigs and scaffolds. most ngs de novo assemblers create a string or de bruijn graph representing the connections among the reads and output the paths in the graph as assembled contigs. examples of these algorithms include edena , velvet , abyss , allpaths-lg , soapdenovo , masurca , cabog , euler-usr and idba . this de novo assembly approach fundamentally differs from alignment-based resequencing approaches, where the ngs reads are not assembled but aligned against a similar reference genome using a variant tolerant short read aligner and structural variant detection algorithms . large parts of the sequence of the target genome can then be reconstructed from the mismatches, indels and rearrangements observed in the alignment results. de novo assemblies tend to be computationally more challenging than alignment-based approaches. additional limitations include (i) the assembly results are often fragmented into large numbers of contigs, (ii) the genome covered by the assembled contigs/scaffolds is commonly incomplete and (iii) the frequency of falsely assembled contigs can be high because of chimeric joins. the most important reasons for these complications are usually sequencing errors, repeat sequences in the target genome, non-uniform sequencing depth and limited read length of ngs data. these error sources result in false-positive, incomplete and branched paths in the assembly graph, and thus greatly limit the lengths and completeness of the final contigs . combining both de novo assembly and alignment-based approaches presents a powerful alternative when a closely related reference genome sequence is available, but its genetic differences relative to the target genome are too pronounced to resolve them with an alignment approach alone . in this case, one can first assemble the reads into contigs and then align them together with the reads to the reference. the much longer contigs facilitate the identification of complex rearrangements, whereas the read alignments are useful for detecting smaller variations in regions that are not covered by contigs. because of the rapidly increasing number of reference genomes becoming available for most organism groups, this referenceassisted assembly approach will soon become the default option for many genome sequencing projects. compared with de novo assemblies, reference-assisted assemblies have many advantages. first, the alignments of the contigs and reads against the close reference provide valuable proximity information that can be used to extend contigs with additional reads and to join contigs even if they overlap only by a few nucleotides. second, the proximity information in the alignment can also be used to orient and order contigs along the reference to build a scaffold map of the entire assembly. third, the alignment map can be used to evaluate the quality of contigs and pinpoint potential misassemblies. to whom correspondence should be addressed. the author 2014. published by oxford university press. this is an open access article distributed under the terms of the creative commons attribution non-commercial license (http://creativecommons.org/licenses/by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. for commercial re-use, please contact journals.permissions@oup.comprevious studies on reference-assisted assemblies include the amoscmp software , an add-on tool for the arachne assembler and custom workflows largely based on existing assembly software (e.g.). the first two were designed primarily for sanger reads, whereas the latter has been used for ngs genome assembly. downstream of the primary assembly, scaffolding algorithms, such as raca , can be used to order and orient preassembled contigs to a connection map by incorporating additional sequence information from mate pair or pe reads and/or from closely related genomes . the resulting scaffolds often contain gaps, which are unresolved sequence areas between the original contigs. dedicated gapfilling algorithms can be used to partially fill these gaps . more recently, components of reference-based strategies have also been incorporated into some of the de novo assembly suites themselves such as the cheat mode option of allpathslg and idba-hybrid (unpublished). this study proposes a novel algorithm, called aligngraph, for improving the lengths and completeness of contigs or scaffolds by reassembling them with help provided by a reference genome of a closely related organism. in contrast to existing referenceassisted methods, aligngraph is a secondary assembly algorithm that loads the alignment information of pe reads and preassembled contigs/scaffolds against the reference into a novel assembly graph, called the pe multipositional de bruijn graph, that we specifically designed for facilitating secondary assemblies. by traversing this graph, the contigs or scaffolds of the primary assembly can be extended and joined. aligngraph differs from most scaffolding algorithms by extending contigs exclusively with resolved rather than unresolved bases (ns) and by acting either upstream and/or downstream of them. aligngraphs functionalities are unique by solving several challenges in improving assembly results. as a de bruijn graph-based method, it solves limitations typical for many heuristic extension methods that are often used in the de novo assembly area . for instance, if there are multiple solutions for how to extend a contig, then finding the correct one can be challenging with most heuristic methods. those ambiguous solutions, which correspond to branched paths in the de bruijn graph, are usually caused by repetitive sequences in genomes and frequently lead to early terminations of the contig extension process. the de bruijn graph method is often more efficient than heuristic methods in finding the correct solution here because the contextual information, required for resolving these ambiguities, is maintained in the graph . this issue is not as pronounced in assemblies with much longer sanger reads, as those are more likely to span non-repetitive regions with repetitive regions in between . thus, it is particularly important to address this problem in assemblies with short reads. in comparison with the conventional de bruijn graph, our pe multipositional de bruijn graph has several additional advantages. first, many branched paths can be eliminated directly in the graph with the help of the additional pe read and alignment information. this simplifies the identification of correct paths. second, many false-positive paths, caused by sequencing errors, can be eliminated by correcting erroneous reads with correct reads that align to the same position in the reference genome. third, guided by the alignment information to the reference genome, the pe multipositional de bruijn graph is less affected by regionally low read coverage that often gives rise to incomplete paths in the conventional de bruijn graph. as a result, many incorrect extensions and early terminations can be avoided.  
