genome analysis fishical: an r package for iterative fish-based calibration of hi-c data the fluorescence in situ hybridization (fish) method has been providing valuable information on physical distances between loci (via image analysis) for several decades. recently, high-throughput data on nearby chemical contacts between and within chromosomes became available with the hi-c method. here, we present fishical, an r package for an iterative fish-based hi-c calibration that exploits in full the information coming from these methods. we describe here our calibration model and present 3d inference methods that we have developed for increasing its usability, namely, 3d reconstruction through local stress minimization and detection of spatial inconsistencies. we next confirm our calibration across three human cell lines and explain how the output of our methods could inform our model, defining an iterative calibration pipeline, with applications for quality assessment and meta-analysis. availability and implementation: fishical v1.1 is available from http://cran.r-project.org/.with molecular biologists getting a closer look at the spatial organization of the nucleus, important methodologies currently used enlist hi-c, fish and electron microscopy (em). in many ways, these methods offer complementary information. hi-c data provide a genome-wide capture of chromatin contacts, with the advantages of high-throughput and scale; however, their spatial interpretation is complicated. fish data, on the other hand, are usually limited in scale but offer a direct measure for physical distance (through image analysis). they can be obtained regardless of range or physical obstacles that affect the chemical capture of contacts (in hi-c) between far away or inaccessible loci, and with a distinction between homologs, which is absent in hi-c data.previously suggested an exponential model to convert yeast hi-c frequencies to fish distance approximations and used them to reconstruct a 3d model for the yeast genome. however, it was not clear whether the same model could be used for higher-order organisms with larger genomes, where hi-c limitations are likely to be more prominent, and given that previous studies have suggested a power law model to relate physical distances and contact frequencies . whether the same parameters are appropriate across short, medium and long ranges, or for different chromosomes and cell types, also remained an open question. more recently, trieu and cheng (2014) used fish data for parameterizing an objective function that will reconstruct the 3d configuration from human hi-c data. although innovative, this approach did not exploit in full the relationship between hi-c and fish data and lacked a model to study their discrepancies. here we present fishical, an r package for integrating hi-c and fish data, which offers a modular and easy-to-use tool for chromosomal spatial analysis. with fishical, researchers can prepare and apply fish-based hi-c calibration, which converts contact frequencies into distances while taking into consideration range limitations in hi-c data. to make our calibration especially useful, fishical also includes 3d inference methods that we have developed, that can in turn iteratively refine the calibration model. we confirm our calibration across three human cell lines and show that our methods can provide valuable information for hi-c/fish calibration refinement, meta-analysis and quality assessment. to the best of our knowledge, fishical is the only tool available for performing these tasks. the following function, usually termed stress in a multidimensional scaling setting : p i5j w i;j i;j d i;j y 2 , where w i,j are the weights we assign according to the reliability of i,j. as we mostly rely on local information, we can use here a local stress function , where missing i,j are replaced with a constant d inf (d inf 4 4 known i,j ) and w i,j take the value of 1/d inf for missing distances and 1 otherwise (for d inf 1, weights of missing distances should be set to a small constant 5 51). as w i,j define an irreducible matrix, the stress minimization could be performed through scaling by majorizing a complicated function (smacof) , a well-established strategy for this task, which guarantees convergence. the calibrated hi-c distances i,j further define a weighted undirected graph gv, e, where v is the set of loci and e is the set of edges: (v i ,v j )j i,j 40, i!= j with weights i,j. here we distinguish between immediate neighbors from the same chromosome (cis) and from different chromosomes (trans) and detect a spatial inconsistency for a node v in g, if the subgraph g of all (immediate) trans neighbors of v is not connected. further identifying the connected components in g can highlight the cause of inconsistency and the underlying spatial division. an inconsistency represents an event where several loci that are in an accessible range from another locus (in trans), are not in an accessible range themselves, which may occur, for example, owing to homology or noise. the iterative calibration process starts with measuring the discrepancies between hi-c and fish data, which could aid in reproducibility assessment and point to functionally meaningful events (supplementary information, section 5). the output of the calibration is then used for 3d inference applications, as described above (and for other applications, section 4). finally, studying the resulting spatial models, for example, across chromosomes or different tissues, provides the input for the next iteration to further refine the calibration model.  
