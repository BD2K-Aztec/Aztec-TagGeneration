genome analysis metarank: a rank conversion scheme for comparative analysis of microbial community compositions motivation: metagenomics involves sampling and studying the genetic materials in microbial communities. several statistical methods have been proposed for comparative analysis of microbial community compositions. most of the methods are based on the estimated abundances of taxonomic units or functional groups from metagenomic samples. however, such estimated abundances might deviate from the true abundances in habitats due to sampling biases and other systematic artifacts in metagenomic data processing. results: we developed the metarank scheme to convert abundances into ranks. metarank employs a series of statistical hypothesis tests to compare abundances within a microbial community and determine their ranks. we applied metarank to synthetic samples and real metagenomes. the results confirm that metarank can reduce the effects of sampling biases and clarify the characteristics of metagenomes in comparative studies of microbial communities. therefore, metarank provides a useful rank-based approach to analyzing microbiomes.metagenomics is a field that involves sampling, sequencing and analyzing the genetic material of uncultured microorganisms in microbial communities. in metagenomic experiments, the nucleic acids of microorganisms are directly isolated from natural environments. this direct approach is not hampered by the limitation that most microorganisms are uncultured in the laboratory, and provides a more complete picture of a microbial community . recent advances in sequencing technologies have fueled an increase in both the number and scope of metagenomic projects, and large amounts of data are being accumulated for analyzing microbiomes . a key question in metagenomics is whether and how changes in the microbial abundances of taxonomic to whom correspondence should be addressed. the authors wish it to be known that, in their opinion, the first two authors should be regarded as joint first authors. units or functional groups relate to alterations of the habitats . to characterize the relationship, it is important to compare microbial community compositions in different environments . several statistical methods developed for comparative metagenomics try to identify differentially abundant features between microbial communities. most of these methods are designed to compare two communities, e.g. xipe-totec , img/m , megan , rammcap , galaxy and stamp . however, a few methods, like metastats , are developed specifically for comparing two sets of multiple communities, while other methods, such as shotgunfunctionalizer , are capable of performing both kinds of comparative analysis. all of the above methods employ statistical hypothesis tests to determine whether member (taxonomic unit or functional group) abundances are equal in distinct communities, and focus on the quantitative differences between microbial community compositions. the drawback of the above methods is that they are highly dependent on the precision of estimated values (e.g. proportions) in member abundances. the estimated values might be noisy due to sampling biases and other systematic artifacts in metagenomic data processing, e.g. 16s rrna chimeras and copy number variation, artificial replicates and inaccurate binning . although systematic artifacts can be corrected through improvements in data-processing techniques, sampling biases will remain unavoidable unless exhaustive inventories of different organisms in microbial communities become available . according to the recent study of, an exhaustive sample for per liter of seawater requires 10 trillions 454 flx pyrosequencing reads. currently, only a fraction of genetic materials in habitats are collected as non-exhaustive samples in metagenomic experiments, and no dataset comprises trillions of reads. therefore, in comparative analysis of metagenomes, sampling biases inevitably have impact on the analyzing accuracy of the above methods. to mitigate the effects of sampling biases, we propose the metarank scheme, which performs a series of rank conversions for analysis of microbial communities based on the relative order of member abundances, rather than their estimated values. the rationale behind metarank is that, since the relative order of largemost current statistical methods for comparative analysis of microbial community compositions rely on estimated abundances. however, when processing metagenomic data, sampling biases and systematic artifacts cause noisy deviations such that estimated abundances differ from true abundances . in this study, we propose a rank conversion scheme, metarank, which converts highly abundant members into larger ranks. since the ranks of highly abundant members are robust to small deviations, the ranks converted by metarank in samples are less affected by sampling biases. empirical tests on synthetic samples and two real metagenomes confirmed that using metarank is able to reduce the variability between samples resulting from sampling biases, facilitates the comparative analysis of metagenomes, and  
