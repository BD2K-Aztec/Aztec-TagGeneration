bioimage informatics graph-based peak alignment algorithms for multiple liquid chromatography-mass spectrometry datasets liquid chromatography coupled to mass spectrometry (lc-ms) is the dominant technological platform for proteomics. an lc-ms analysis of a complex biological sample can be visualized as a map of which the positional coordinates are the mass-to-charge ratio (m/z) and chroma-tographic retention time (rt) of the chemical species profiled. label-free quantitative proteomics requires the alignment and comparison of multiple lc-ms maps to ascertain the reproducibility of experiments or reveal proteome changes under different conditions. the main challenge in this task lies in correcting inevitable rt shifts. similar, but not identical, lc instruments and settings can cause pep-tides to elute at very different times and sometimes in a different order, violating the assumptions of many state-of-the-art alignment tools. to meet this challenge, we developed lwbmatch, a new algorithm based on weighted bipartite matching. unlike existing tools, which search for accurate warping functions to correct rt shifts, we directly seek a peak-to-peak mapping by maximizing a global similarity function between two lc-ms maps. for alignment tasks with large rt shifts (4500 s), an approximate warping function is determined by locally weighted scatterplot smoothing of potential matched features, detected using a novel voting scheme based on co-elution. for validation , we defined the ground truth for alignment success based on tandem mass spectrometry identifications from sequence searching. we showed that our method outperforms several existing tools in terms of precision and recall, and is capable of aligning maps from different instruments and settings. availability: available at https://sourceforge.net/projects/rt-alignment/.liquid chromatography-mass spectrometry (lc-ms) is the dominant technological platform in proteomics, capable of profiling thousands of proteins in the biological sample in a high-throughput and sensitive manner. in the most popular workflow of shotgun proteomics, proteins in a complex mixture are first digested into small peptides, which are then separated by high-performance liquid chromatography, and eluted through an electrospray ion source into the mass spectrometer. in the mass spectrometer, the peptide ions are separated by their massto-charge ratios (m/z) and converted to an electrical signal, the intensity of which is a measure of abundance of the peptide ion. taken together, lc-ms data are three-dimensional, with each peptide ion represented by three coordinates: its chromatographic retention time (rt), its m/z and its signal intensity. in some instruments, an additional step of tandem mass spectrometry (ms/ms or ms2) can be taken to fragment each peptide, yielding fragment ion (ms2) spectra from which the peptide can be identified by computational methods. an lc-ms map can therefore be viewed as a comprehensive and quantitative profile of the proteome being analyzed. many proteomics experiments rely on comparisons of lc-ms maps of different samples . for these experiments, it is necessary to match the peak originating from the same peptide in different lc-ms maps. this task can be easily accomplished if the m/z and the rt coordinates of the same peptide stay constant in many lc-ms runs. the m/z values usually vary within a limited and predictable range, which depends on the mass resolution of the mass spectrometer. however, the rt of a specific peptide heavily depends on the instrument conditions and the composition of the mixtures. for many technical reasons, even the same sample analyzed by the same instrument with the same settings can generate different lc-ms maps with shifts and distortions in the rt dimension. this fact makes the association of the same peptides across lc-ms maps difficult because the shift of any two lc-ms maps cannot be known in advance. to find the corresponding peptides in the different lc-ms maps, time alignment must be conducted. the ultimate goal of time alignment is to match peaks that belong to the same peptides across different lc-ms maps. based on the type of input data on which the alignment algorithm operates, lc-ms alignment methods can be categorized into profile-based methods and feature-based methods. profilebased methods directly process the raw data obtained in the lc-ms experiment, aiming to avoid errors introduced by a feature-finding algorithm. the early profile-based methods compare only the difference in total ion chromatograms (tic), which is the sequence of the sum of all signals at each time point. typical methods used in aligning tic include dynamic time warping (dtw) , correction optimized warping (cow) , parametric time warping (ptw) and continuous hidden markov models (hmm) . tic-based methods make little use of to whom correspondence should be addressed. the whole lc-ms map, disregarding most of the useful information at the m/z dimension that can help alignment. therefore, recent approaches tried to use more information available in the lc-ms maps by applying these time warping methods to many isolated ion chromatograms at different m/z values or by defining the spectral similarity of corresponding mass spectra as the objective function to be maximized . in general, profile-based methods can produce more accurate alignment results, but they are computationally expensive and may require more resources in terms of computer cycles and memory, especially for multiple alignments . another limitation of the aforementioned methods is that they only allow shifting, stretching or shrinking of the time axis, and cannot deal with the reversal of elution order. a recent publication suggested that elution order reversals are not rare, especially at fine timescales , and when the lc-ms maps are acquired in slightly different settings. feature-based approaches operate on features in the lc-ms map detected by a feature-finding algorithm, which tries to distinguish between peptide features and irrelevant noise in the lc-ms experiment. the resulting feature list, which condenses the raw data into (m/z, rt) coordinates of interest, are used in the subsequent alignment. many feature-based alignment algorithms have been developed, either implemented as stand-alone tools or as a part of software platforms for label-free quantitative proteomics. examples are mzmine (katajamaa and oresic,oresicoresic, 2005), mapaligner in openms , superhirn , xcms , specarray and xalign . except mzmine, which simply attempts to find peak matches within a tolerance window, all of these methods attempt to estimate a linear (mapaligner, xalign) or nonlinear warping function (others) to correct the rt axis. more recently, zhang (2012) has proposed a divide-and-conquer algorithm that can handle both low-resolution and high-resolution lc-ms maps.propose a novel feature-matching algorithm using a robust nonparametric kernel-type regression model to detect a nonlinear alignment, and a wavelet-based method to incorporate peak shape information for resolving ambiguous matches. in contrast to profile-based methods, feature-based approaches typically rely on high-resolution data for effective feature finding, whereas profile-based methods are generally able to work well on low-resolution lc-ms data. time alignment methods for lc-ms data are reviewed in a berg et al.). in amt methods, the objective is to associate each peptide with the m/z and rt coordinates at which it is expected to be found, such that peaks detected in future lc-ms can be identified to the originating peptides without the help of ms/ms. to correct for potential rt shifts caused by instrument noise or changes in experimental conditions, amt methods also need to perform time alignment, but in a different manner. given the peptide identifications, amt methods typically attempt to associate the raw rt with a predicted hydrophobicity measure of the peptide, and store these in an amt database, usually specialized to each biological sample. then, subsequent lc-ms maps from the same sample are analyzed by first converting raw rt into a hydrophobicity measure, usually using information of the elution gradient program, and then searching the coordinates in the amt database to find the closest matched peptide. amt methods are therefore theoretically capable of aligning lc-ms maps across vastly different conditions, as time alignment is assisted by the knowledge of the peptide identification and the elution gradient. potentially large rt shifts caused by differences in elution conditions can be corrected. however, amt methods depend on the availability of peptide identifications and the accuracy of hydrophobicity predictions, and may not be generally applicable to all types of lc-ms data. in this article, we propose a feature-based lc-ms alignment method called lwbmatch, based on maximum weighted bipartite matching. lwbmatch is a multiple alignment method that is capable of aligning maps with large systematic and nonlinear rt shifts. similar to other feature-based methods, an optional preliminary step first extracts likely matching features in the lc-ms maps to detect potential large rt shifts. a warping function is then fitted by locally weighted scatterplot smoothing (lowess). however, unlike existing methods that try to determine the warping function accurately on a fine timescale, our warping function needs only to be approximate and mainly serves to bring matching features into proximity. the key innovation of our method is the subsequent step that relies on a global maximization algorithm based on weighted bipartite matching to match features exhaustively, producing an optimal feature-to-feature mapping that maximizes the similarity between two lc-ms maps. as a result, small elution order changes of the peptides and other rt variations caused by instrument noise will have minor effects on the performance. we demonstrate that our method can align lcms maps generated from the same conditions even without the warping step, and can also handle maps generated from different instruments and settings after approximate warping. we also show that our method outperforms three existing feature-based alignment methods.  
