sequence analysis mpbind: a meta-motif-based statistical framework and pipeline to predict binding potential of selex-derived aptamers aptamers are synthetic antibodies that can bind to target molecules with high affinity and specificity. aptamers are chemically synthesized and their discovery can be performed completely in vitro, rather than relying on in vivo biological processes, making them well-suited for high-throughput discovery. however, a large fraction of the most enriched aptamers in systematic evolution of ligands by exponential enrichment (selex) rounds display poor binding activity. here, we present mpbind, a meta-motif-based statistical framework and pipeline to predict the binding potential of selex-derived apta-mers. using human embryonic stem cell selex-seq data, mpbind achieved high prediction accuracy for binding potential. further analysis showed that mpbind is robust to both polymerase chain reaction amplification bias and incomplete sequencing of aptamer pools. these two biases usually confound aptamer analysis. availability and implementation: mpbind software and documents are available at http://www.morgridge.net/mpbind.html. the human embryonic stem cells whole-cell selex-seq data are available ataptamers are short, single-stranted dna or rna, which have the ability to specifically bind to a variety of targets including proteins and the surface of cells . aptamers have gained significant interest as a promising alternative to antibodies because they are chemically synthesized, thermostable and can be readily produced using standard laboratory techniques. importantly, aptamers can be distributed as sequence information rather than as a physical entity. the generation of high-affinity aptamers typically starts with a random oligonucleotide pool. these oligonucleotides are then subjected to multiple rounds of in vitro target-based selection with polymerase chain reaction (pcr) amplification. this procedure is termed selex (systematic evolution of ligands by exponential enrichment). several studies observed that the number of unique sequences decreases after target selection, suggesting that the decrease of sequence complexity is caused by the increase of sequence enrichment . also, trueselected sequences were more likely to appear in multiple rounds if compared with non-selected sequences . thus, enrichment ratio-related methods are the most common approach to initially identify high-affinity aptamers. however, those methods suffer from a relatively high false-positive rate, where sequences are enriched but do not exhibit binding . this is likely because of pcr amplification bias. to design aptamers that can bind to human embryonic stem cells (hescs), we generated five rounds of hesc whole-cell selex sequencing data. we found that the validation rate is low (550) if we used the enrichment ratio-based method (data not shown). prior work showed that pcr bias is a substantial confounding factor in aptamer analysis . therefore, there is a pressing need to have a computational approach that can accurately predict the binding potential of selex-derived aptamers without relying on aptamer read counts. to this end, we developed mpbind, a novel statistical framework and pipeline to predict the binding potential of selexderived aptamers. our approach is based on the assumption that the binding potential of an aptamer can be broken down to the combination of binding of all n-mers (e.g. 6-mer) within a sequence. mpbind assesses all possible n-mers for metrics such as the relative frequency change and the relative abundance in the final round. based on those observations, each n-mer is assigned a combined score. the binding potential of an aptamer is further inferred from the combination of all n-mers within the sequence. this approach integrates multiple moderately informative sources of data to generate high-confidence predictions, which is particularly important for cell-selex where non-specific binding is prevalent.we generated five rounds of whole-cell selex sequencing data using hescs . the initial library (r0) contains 21 m reads with 99 unique reads. pcr amplification by its nature generates redundant sequences. therefore, if the sequencing depth is deep enough to cover all copies of reads in a pool, we should observe a drop in read complexity even without any selection or pcr bias. the read complexity in this scenario indicates the overall redundancy in a pool [supplementary(a)]. however, if read depth is far less than all reads in a pool, as is typically the case for selex experiments, then the pcr cycles will not affect read complexity [supplementary(b)]. this is because if there is no target selection and no pcr bias, pcr cycles will not change the relative abundance of each read species, and also because the sequencing depth is low compared with the number of available species; most species are sampled just once or not at all. low read complexity then is likely indicative of some species being preferentially sampled. if a pool contains a fraction of favored sequences (by target selection or via pcr bias), with limited sampling depth, those favored sequences are repeatedly sampled and make the read complexity lower [supplementary(c)]. to investigate the extent of incomplete sequencing in our pool, we compared the reads that overlap between sequencing runs in initial pool (r0) and control-seq (r1). the overlapping is minimal and only six reads are present in both sequencing runs [supplementary(d)]. it indicates that our sequencing read depth is far from enough to cover all the reads in a pool. incomplete sequencing of oligonucleotide pools is common in selex-seq. this is because for a typical selex-seq, the initial library pool requires at least 10 10 to 10 11 complexity to achieve the necessary diversity . our hescs selex aptamers are 29 nt in length, and thus, the number of all possible sequences in the initial library pool is 4 29 (10 17 ) in theory. although the real number of sequences in the pool is likely to be much less than that, it is still far beyond the sequencing depth. after one round of selection, the percentage of unique reads dropped to 51. to investigate whether this drop in read complexity is a result of enrichment through true binding or pcr bias, we sequenced pools without target selection but with the same number of pcr cycles (control-seq). our sequencing depth for our libraries was typically 10 7 sequences (supplementary). as shown in supplementary table s1, the percentage of non-redundant reads in control-seq (r1) dropped to 47. this drop in read complexity in the controlseq is likely due to pcr bias and likely indicates pcr bias in the selex-seq as well. for example, as shown in supplementary table s2, the top three enriched reads in the control-seq are ranked number 24 in terms of enrichment in the selex-seq. it indicates that those enriched reads in selex-seq are more likely due to being selected by pcr. pcr bias in selex-seq has been previously observed . to avoid pcr bias, we removed redundant reads from each round to train mpbind with parameter (n-mer = 6). the training set includes initial library (r0), selex-seq (r1, r2, r3, r4 and r5) and controlseq (r5). to evaluate the performance of mpbind, we selected 19 aptamers with a large dynamic range in their meta-z-score (45 to +47). we further defined binding as a notable shift of fluorescence intensity of cells bound by fluorescently labeled aptamer compared with controls (see supplementaryfor details). the area under curve (auc) of the receiver operating characteristic (roc) curve of mpbind is 0.97. as expected, if we included redundant reads from each round to train mpbind, the auc drops to 0.74, as shown in. the spearmans rank correlation (rho) between the predicted meta-z-score (mpbind) and the binding potential (binding assay) is 0.79 [supplementary(b)]. aptamer 002 (supplementary) is ranked as the top enriched aptamer in the final selex round (583 447 reads). the binding assay showed that this aptamer did not bind to hescs. mpbind successfully predicts this to be a non-binding aptamer (meta-z-score = 9.37). it is likely that the enrichment of aptamer 002 is caused by pcr bias. this aptamer is also enriched in control-seq (r5) with 122 copies. however, the enrichment of this aptamer in control-seq is not as high as in selex-seq, indicating that the extent of pcr bias can also be stochastic. this type of bias was also suggested by, with the evidence that increasing copy number in selex-seq did not necessarily display increasing binding affinity. aptamer 019 does not have sufficient read counts to support it as a high-affinity aptamer (no reads from r0 to r4 and only four reads in r5). however, mpbind predicted this to be) outperformed than that trained on redundant reads (auc = 0.74). the motif length is set to 6 nt a high-affinity aptamer (meta-z-score = 9.01). the binding assay confirmed that this aptamer strongly binds to h1 cells [supplementary(a) and supplementary. interestingly, this indicates that mpbind can correctly predict aptamer affinity, even in the lack of read counts information (e.g. incomplete sequencing of oligonucleotide pools). in other words, mpbind is capable of achieving de novo predictions after sufficient training. to examine how each individual statistic contributes to the prediction performance, we used z1, z2, z3 and z4 separately to predict aptamer binding potential. as shown in supplementary table s4, the aucs of z1, z2, z3 and z4 ranged from 0.93 to 0.95, lower than when four z scores are combined (auc = 0.97). thus, integrating multiple sources of information generates more confident predictions. to further investigate the impact of motif length on the prediction performance, we varied the motif length from 5 to 8 nt. as shown in supplementary, 6-mers achieved the best prediction performance. to further evaluate the performance of mpbind, we tested it on another selex-seq dataset (esrp1) . dittmar et al. generated five rounds of selex-seq (esrp1) data (r0, r2, r3, r6 and r7). for each round, we merged reads to unique reads (removed redundant reads) and trained mpbind with parameter n-mer = 6.). this indicates that mpbind can correctly predict aptamers that bind to esrp1. in summary, we show that mpbind is a useful tool for predicting binding aptamers from selex-seq data and is robust to biases caused by pcr or by incomplete sequencing of aptamer pools. however, we should also note that the premise of mpbind is that the binding potential of an aptamer is dictated by the combination of n-mers. this assumption is valid for the two datasets we tested (hescs whole-cell selex-seq and esrp1 protein selex-seq). however, this might not be true for all selex-seq data. in the future, we will further evaluate mpbind and continue to update it to be effective with a variety of selex-seq datasets.  
