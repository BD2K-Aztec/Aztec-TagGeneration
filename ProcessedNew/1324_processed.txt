density-based hierarchical clustering of pyro-sequences on a large scaleâ€”the case of fungal its1 motivation: analysis of millions of pyro-sequences is currently playing a crucial role in the advance of environmental microbiology. taxonomy-independent, i.e. unsupervised, clustering of these sequences is essential for the definition of operational taxonomic units. for this application, reproducibility and robustness should be the most sought after qualities, but have thus far largely been overlooked. results: more than 1 million hyper-variable internal transcribed spacer 1 (its1) sequences of fungal origin have been analyzed. the its1 sequences were first properly extracted from 454 reads using generalized profiles. then, otupipe, cd-hit-454, esprit-tree and dbc454, a new algorithm presented here, were used to analyze the sequences. a numerical assay was developed to measure the reproducibility and robustness of these algorithms. dbc454 was the most robust, closely followed by esprit-tree. dbc454 features density-based hierarchical clustering, which complements the other methods by providing insights into the structure of the data.environmental microbiology has advanced greatly in the past few years with the advent of next-generation sequencing technologies. a microbial community can now be sampled by the exhaustive sequencing of the pcr products obtained from a carefully chosen pair of primers. currently, the roche 454 pyrosequencing is the favored technology because it produces relatively long and sufficiently numerous reads at an acceptable cost. however, pyro-sequences suffer from a non-negligible rate of error , which often affects the sequence regions in which a given nucleotide is repeated several times. in this study, we have used a dataset of the fungal internal transcribed spacer 1 (its1) coming from soil samples obtained from 198 different locations in the western swiss alps. each location represented a 4 m 2 of grassland. the locations were selected by following a random-stratified design and, thus, are distributed over a great variety of soil types and altitudes. overall, more than a million pyro-sequences have been obtained, with the aim of identifying how biotic and abiotic factors influence the fungal diversity at different scales. ecological results of this study will be reported elsewhere, the focus of this article being to introduce a novel classification method capable of robustly analyzing this large-scale dataset. there are currently three taxonomy-independent, i.e. unsupervised, clustering algorithms that can determine operational taxonomic units (otus) on a large scale, say in the range of a million of pyro-sequences. these algorithms are cd-hit-454 , otupipe and esprit-tree . they have been recently reviewed and numerically benchmarked in an article that constitutes an excellent introduction to the field of taxonomy-independent microbial community analysis and that summarizes what is the state of art in the field. here, we introduce dbc454, a density-based hierarchical clustering algorithm that departs on several points from the previously mentioned ones. it was designed with the following requirements in mind: it should (i) determine the optimal number of clusters, (ii) properly separate arbitrarily shaped distributions, (iii) not be affected by the order in which the data are presented, (iv) be robust and resistant to noise (e.g. not assign outliers to clusters), (v) use intuitive-free parameters, (vi) be capable of clustering millions of observations in thousands of clusters and (vii) return a solution in a reasonable amount of time. we also introduce a new numerical benchmark for unsupervised clustering algorithms, which measures their robustness with respect to the errors that are likely to affect the input sequences.the use of generalized profiles for defining the hyper-variable its1 by its highly conserved flanking regions alleviates most of the sensitivity problems encountered with pattern-based search methods , including sequencing errors, such as indels. in addition, this permits the recovery of all the its1 from the embl, irrespective of the particular primers that have been used by the original authors. dbc454 relies on an arbitrarily defined encoding of every sequence as a point in a 48-dimensional space. when this encoding is used for hierarchical density-based clustering, an especially robust partition of the input sequences is obtained, which a posteriori corroborates its relevance. dbc454 uses density-based clustering to identify groups of related sequences that are naturally dense in the input dataset. as a density-based method, dbc454 places no constraints on the cluster shape and radius, and has no concept of a cluster center. in contrast to all the other algorithms considered here, which remove the redundancy among the sequences as an initial step, dbc454 explicitly uses this information for the clustering (see the note on esprit-tree below). one of the unintuitive aspects of density-based clustering is that its performance tends to improve with the size of the input dataset, contrary to many other clustering approaches. our results show that this approach leads to especially robust partitions without being detrimental to the overall accuracy. this study demonstrates that dbc454 and esprit-tree (at a carefully chosen level) are currently the two most robust methods for the definition of otus in the dataset we have studied. the partitions produced by these two methods are only slightly different and essentially compatible. the key observation here is that dbc454 and esprit-tree rely on completely different algorithmic approaches. this indicates that both methods are actually capable of recognizing the same structure in the input dataset, which is an encouraging result regarding the future reproducibility of the experiments in the field of metagenomics. it must be noted that the esprit-tree algorithm also includes a density-sensitive computation step, i.e. the weighting scheme that is used to update the probabilistic sequences at level greater than 0 . this might help to explain the convergent results obtained for dbc454 and esprit-tree. recently, much attention has been placed on the benefits of denoising, i.e. correct the suspected sequencing errors of the pyro-sequences before performing the taxonomy-independent analysis itself . considering their particular sensitivity to the sequencing errors demonstrated here, this recommendation obviously makes sense when cd-hit-454, otupipe or esprit-tree (at the lowest level) is used for the clustering analysis. however, the introduction of an additional pre-processing step implies the optimization of additional parameters and has a cost in terms of cpu, which is currently prohibitive for large datasets. instead of requiring two successive steps (denoising followed by clustering), we have shown here that the clustering process itself can be used at the same time to produce a robust partition (insensitive to sequencing errors) and to identify the outlier sequences, i.e. those that were pooled as noise in this article.  
