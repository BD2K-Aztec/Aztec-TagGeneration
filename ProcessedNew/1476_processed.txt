genome analysis drimm-synteny: decomposing genomes into evolutionary conserved segments motivation: the rapidly increasing set of sequenced genomes highlights the importance of identifying the synteny blocks in multiple and/or highly duplicated genomes. most synteny block reconstruction algorithms use genes shared over all genomes to construct the synteny blocks for multiple genomes. however, the number of genes shared among all genomes quickly decreases with the increase in the number of genomes. results: we propose the duplications and rearrangements in multiple mammals (drimm)-synteny algorithm to address this bottleneck and apply it to analyzing genomic architectures of yeast, plant and mammalian genomes. we further combine synteny block generation with rearrangement analysis to reconstruct the ancestral preduplicated yeast genome. contact:the evidence in favor of the whole-genome duplication (wgd) in saccharomyces cerevisiae was discovered by wolfe and shields (1997) but was heavily contested (e.g. seeused preduplicated genomes of kluyveromyces waltii and ashbya gossypii to settle this controversy (see, for a recent study contesting the wgd in yeast). starting from wolfe and shields (1997) andall wgd studies essentially amounted to constructing synteny blocks of certain type [e.g. sister blocks in seoighe and wolfe, 1999 or doubly conserved synteny (dcs) blocks inand demonstrating that these blocks cover a large portion of the genome. remarkably, there is still no general purpose tool that would automate such analysis and reduce various wgd studies to simply computing a duplicativity coverage of the genome. for example, software fromis not applicable to finding the synteny blocks from seoighe and wolfe (1999) and vice versa. indeed, most wgd studies developed new software for wgd analysis instead of using some previously developed tools! to whom correspondence should be addressed.we argue that the lack of tools for automated wgd analysis is the result of the lack of tools for synteny block identification in highly duplicated genomes. many genomes have undergone extensive duplications followed by gene losses and rearrangements, making decoding of genomic architecture (synteny block reconstruction) in such genomes difficult. for example, duplications account for 70 of the arabidopsis thaliana genome making synteny block reconstruction in this and other plant genomes challenging.shows a highly duplicated genome g along with its decomposition into overlapping (left) and non-overlapping (right) synteny blocks. the nonoverlapping decompositions are more desirable since they are required for the follow-up rearrangement and duplication studies (e.g. the existing genome rearrangement algorithms are unable to analyze overlapping decompositions). however, constructing nonoverlapping decompositions is more difficult than constructing overlapping decompositions. while it may appear that one can simply subpartition the overlapping blocks into the non-overlapping ones,explained that this partitioning does not work for complex genomes.proposed the first algorithm for synteny block generation, which was aimed at comparative mapping data and did not take into account micro-rearrangements. the first algorithms for synteny block reconstruction in sequenced genomes [grimm-synteny and chains-and-nets (were developed in 2003 when thousands of micro-rearrangements in mammalian genomes were discovered. these and many other synteny block generation algorithms proved to be adequate for small sets of genomes but did not address issues that stem from extensive duplications and deletions. most previous efforts to generate synteny blocks for highly duplicated genomes generated overlapping rather than non-overlapping blocks. in contrast, some recently developed tools [e.g. enredo tool used in ensembl (] aim to generate non-overlapping synteny blocks. the non-overlapping representation has advantages over the traditional pairwise (and overlapping) representation of duplications. indeed, the pairwise representation (that dominated previous studies of human segmental duplications) left the question of finding ancestral duplicons in the human genome unanswered , while the non-overlapping representation constructed in[a human-chimpanzee-macaque-rat-mouse-opossum-cow synteny block (in human chromosome 1) contains 29 genes with only 2 of them shared between all 7 species. while 17 of these 29 genes appear to be present only in a single genome (like gene 27 in macaque), most of these 17 genes have orthologs in other species (these orthologs are not shown since they are located within other synteny blocks in other species). resolved it. also, an overlapping representation can be easily obtained from a non-overlapping representation but not vice versa.shows an humanchimpanzeemacaqueratmouse opossumcow synteny block and illustrates the challenge of constructing synteny blocks in multiple genomes. as the number of analyzed genomes increases, the number of shared genes may substantially decrease. while this block contains 29 genes, only 2 of them are shared between all 7 species. the existing synteny block generation algorithms (such as grimm-synteny) are likely to miss such a block with only two shared genes or discard it as statistically insignificant.noticed that the problem of constructing non-overlapping synteny blocks is similar to the difficult problem of de novo repeat classification .introduced the a-bruijn graph approach to repeat classification, representing all repeats as a mosaic of nonoverlapping subrepeats. later, the a-bruijn graphs were found to be useful in diverse applications such as multiple alignment , de novo protein sequencing , analysis of segmental duplications and next generation dna sequencing . while diverse applications of a-bruijn graphs use the same algorithmic idea, each application has unique features that need to be addressed for a new research domain. the original a-bruijn graph approach involves some heuristics that may or may not work for a particular application. for example, the bulge removal heuristic was originally designed for fragment assembly of sanger reads but turned out to work well in various tools for next-generation dna sequencing , mass spectrometry and synteny block reconstruction . another important heuristic that is application specific is the threading procedure fromthat reconstructs how the genome traverses the transformed a-bruijn graph. while threading was never problematic in sequencing applications,came to the conclusion that it is a major bottleneck in synteny block reconstruction and wrote: optimizing the a-bruijn graph approach for synteny block generation represents the next challenge in analyzing the genomic architectures. our article addresses this problem by devising the first a-bruijn graph approach that does not require a threading step and substitutes it with an alternative genome modification step implemented in the duplications and rearrangements in multiple mammals (drimm)-synteny software ( http://bix.ucsd.edu/projects/drimm/). we illustrate applications of drimm-synteny to analyzing yeast, plant and mammalian genomes and further combine it with rearrangement analysis to reconstruct the ancestral preduplicated yeast genome (see section 5 of the supplementary material).datasets 1 and parameters: the yeast gene orders were extracted from. the mammalian gene orders were generated using msoar program . the gene order of a.thaliana was extracted from. although every synteny block reconstruction algorithm is parameters independent, we are not aware of tools for automatic derivation of the optimal parameters. the parameters choice for these tools (and drimm-synteny) relies on an expert analysis (see supplementary section 3 for parameter choice in drimmsynteny). in this article, we use the default parameters (girth = 20,pathlength = 3,thornlength = 3) for all datasets. synteny blocks in seven mammalian genomes: to benchmark drimm-synteny on multiple (but not highly duplicated) genomes, we analyzed seven mammalian genomes: human (h), chimpanzee(c), macaque (q), rat (r), mouse (m), opossum (o) and cow (w). as the number of genomes increases, the number of genes that are shared between all genomes decreases and methods relying on the genes shared by all genomes (e.g. grimm-synteny) deteriorate.shows a seven-way synteny block that would most likely be missed by such tools. the concatenation of seven mammalian genomes results in a virtual genome with 144 149 genes (53 245 unique genes). the simplified a-bruijn graph of this concatenation (with the default parameters) has 31 282 vertices and 35 773 edges. substituting non-branching paths in this graph by single edges results in a graph on 2212 vertices and 3514 edges. drimm-synteny still finds many synteny blocks with good coverage (70) in this highly duplicated virtual genome (supplementary table s1a and supplementary files). enredo , an advanced synteny block generation tool used in ensembl , generated seven-way blocks with a significantly lower coverage (32, supplementary). to further compare enredo and drimmsynteny, we ran both program on the dataset initially containing only human and chimpanzee genomes where these tools generated nearly identical results. then at each step, we added one more genome to the dataset, generated k-way synteny blocks (k is the number of genomes), computed the genome coverage by these blocks and repeated the process for k = 3,...,7.shows that, as more genomes are added to the dataset, drimm-synteny continues generating synteny blocks with high coverage (70 for seven-way blocks), while the seven-way synteny blocks generated by enredo cover only 32 of the genome. synteny blocks in k.waltii and s.cerevisiae: the concatenation of s.cerevisiae (s) and k.waltii (k) results in a genome with 10686 genes (6240 unique genes). the simplified a-bruijn graph of this concatenation has 5844 vertices and 6221 edges. substituting nonbranching paths in this graph by single edges results in a graph on 653 vertices and 997 edges. drimm-synteny finds nearly all dcs blocks identified inas well as 231 singly conserved synteny blocks . since most studies of genomic architectures ignore very short synteny blocks, we delete all short synteny blocks (with fewer than genes in each species) in an iterative fashion as described in. supplementarypresents s.cerevisiae and k.waltii genomes in the alphabet of 151 large dcs synteny blocks (for = 6).) and drimm-synteny produce blocks with similar coverage for small k, the k-way synteny blocks generated by enredo have lower coverage for larger k.. k-s blocks represent blocks of multiplicity 2 that have one instance in k.waltii and one instances in s.cerevisiae. the average size of the k-s-s and k-s blocks is 18 and 8 genes, respectively (before removing short blocks).and b shows the position of dcs blocks (on s.cerevisiae genome) generated by drimm-synteny and inand illustrates that they produced nearly identical results. the statistics of synteny blocks generated by drimm-synteny is given in. enredo , on the other hand, missed many synteny blocks found in(see section 3 of the supplementary material). this raises a question why a rather sophisticated enredo algorithm failed to reveal synteny blocks constructed using a simple approach from. we emphasize that enredo is a general synteny block generation tool, while the approach inhas many limitations: it is only applicable to pairs of pre-wgd and after-wgd genomes with small number of additional segmental duplications. we also ran drimm-synteny on the s.cerevisiae genome alone with the default parameters. 2 drimm-synteny generated 87 synteny blocks , which cover about 51 the genome and reveal a pattern similar to the one shown inand b. this result is consistent with the analysis in seoighe and wolfe (1999) (84 blocks with 50 coverage). while seoighe and wolfe (1999) indeed revealed sister blocks in s.cerevisiae, we are not aware of any (general purpose) synteny block generation tool that can automatically construct synteny blocks in highly duplicated genomes. asillustrates, if such a tool was available in 2004 when the paperwas published, it would provide a solid evidence for wgd in s.cerevisiae even without additional analysis inwould be largely reduced to merely running drimm-synteny.the rapidly increasing set of sequenced genomes highlights the importance of identifying the synteny blocks in multiple and/or highly duplicated genomes. as the number of analyzed genomes increases, the number of shared genes may decrease substantially. the synteny block generation algorithms based on pairwise comparisons are often limited, since in some cases, the synteny blocks can only be reconstructed by multi-way comparison. we proposed the drimm-synteny algorithm for identifying the nonoverlapping synteny blocks and bypassed the difficult threading problem [a bottleneck in] by developing a new a-bruijn graph approach for solving the smp.analyzing enredos results. we also thank max alekseyev, rustem aydagulov and vladimir dobrynin for their helpful comments. we are grateful to max alekseyev, kevin byrne, tao jiang and qian peng for help with generating gene orders of yeast, plant and mammalian genomes.  
