pbap: a pipeline for file processing and quality control of pedigree data with dense genetic markers motivation: huge genetic datasets with dense marker panels are now common. with the availability of sequence data and recognition of importance of rare variants, smaller studies based on pedigrees are again also common. pedigree-based samples often start with a dense marker panel, a subset of which may be used for linkage analysis to reduce computational burden and to limit linkage disequilibrium between single-nucleotide polymorphisms (snps). programs attempting to select markers for linkage panels exist but lack flexibility. results: we developed a pedigree-based analysis pipeline (pbap) suite of programs geared towards snps and sequence data. pbap performs quality control, marker selection and file preparation. pbap sets up files for morgan, which can handle analyses for small and large pedigrees, typically human, and results can be used with other programs and for downstream analyses. we evaluate and illustrate its features with two real datasets. availability and implementation: pbap scripts may be downloaded from http://faculty.washington. edu/wijsman/software.shtml.technical advances have allowed the acquisition and use of tremendous amounts of marker data for both population-and pedigreebased genetic studies . for human population-based studies, multiple computational tools and workflows already exist for file manipulation, quality control (qc) and basic analysis of genotype data . for pedigree-based studies, preparation and manipulation of files is similarly crucial for downstream analyses. some tools used to format files and perform qc in population-based studies can also be used in pedigree studies, but additional pedigreespecific preparations are also necessary in the search for rare, high risk sequence variants. pedigree-based designs are again being used in the search for rare disease-causing variants. pedigree-based datasets are a useful resource , and diverse analysis programs exist that can handle smaller pedigrees (e.g. merlin) and large pedigrees (e.g. simwalk2, morgan) with extensive marker data. for computational reasons, smaller pedigrees are typically less than 27 bits,) with followup on sequence data in the linkage regions from the same families. considerable software exists for carrying out computations on pedigrees to extract maximal information on identity-by-descent (ibd) (;; tong and). smaller pedigrees can be analyzed with exact computation, while larger pedigrees require markov chain monte carlo (mcmc) sampling . it is important to note that full pedigree analysis based on ibd probability estimation can be substantially more powerful than approaches that split the pedigrees followed by exact ibd computation, thus emphasizing the need for use of mcmc sampling methods in the context of large pedigrees . careful sub-selection of markers is necessary for some analyses when dense markers are available on pedigrees . in a multipoint analysis, it is important to minimize linkage disequilibrium (ld) between markers to avoid inflated type i error rates and to comply with intrinsic assumptions in the computational algorithm used by most programs that carry out multipoint analyses. it is also important to minimize the number of markers used to reduce computational time, while retaining enough markers to achieve high information concerning inheritance patterns. it is not necessary to use all markers . the block-based approach, which was developed for smaller pedigrees to circumvent the ld problem, is no longer as effective as it originally was due to the density of current marker panels coupled with the constraints on the block size . all three goals can be achieved by judicious selection of a subset of markers from a dense panel of markers. most modern linkage analysis programs make use of inheritance vectors (ivs), which represent the flow of chromosome positions through pedigrees . ivs are typically used internally for linkage analysis using the langesobel estimator . mcmc estimation is employed by several linkage analysis programs [e.g. morgan, simwalk2 and superlink-online single-nucleotide polymorphism (snp)] for large pedigrees (; tong and). iv probabilities can also be used to estimate ibd sharing between pairs of individuals . these probabilities may be stored for later reuse, providing significant computational advantages in downstream analyses. ivs may also be used to augment sequence data by genotype imputation and subsequently evaluated by family-based single-snp or snp-set association analyses . despite the availability of various computational tools for pedigree analyses, we still lack a unified comprehensive system that eases the crucial steps needed to work with dense markers. older file manipulation and qc tools exist that were developed for use with sparse microsatellite or snp panels but are not always suitable or accurate for use with current, dense genotyping. file manipulation tools for dense data are available , but preparing files can be challenging especially when studies involve data for large pedigrees or when they entail combining data from multiple file sources. at least two programs exist that begin to address selection of a subset of markers for linkage analysis: marker selection for linkage (masel) and linkdatagen . masel selects snps based on a user-specified ld threshold and weights for several parameters but does not impose a minimum intermarker distance (mid) and requires prior steps to filter snps. linkdatagen performs error checks, removes all mendelian inconsistent errors and selects snps based on user-specified bin size, minimum distance between markers and hapmap populationspecific allele frequencies but does not specifically use ld to select snps. neither programs have options to force inclusion nor exclusion of specific markers. it is therefore possible to perform file manipulation, marker selection and qc checks by using multiple existing tools, but a unified system that performs all desired functions would be useful. we have developed a pedigree-based analysis pipeline (pbap) suite of programs that carry out file manipulations and qc checks prior to downstream analyses, with a focus on human data. pbap prepares data files in a morgan-compatible format, carries out marker and pedigree qc analyses and automates marker selection for a good linkage panel while allowing the user considerable flexibility for inclusion or exclusion of markers. results obtained after running programs of the morgan package on the formatted files can be used for various downstream analyses.the use of dense markers in pedigree-based data analyses is challenging and requires nontrivial file manipulation. selection of subsets of markers, i.e. marker subpanels, from a dense panel can be a complex process based on joint optimization across several parameters. here, we introduce pbap, a pipeline of programs that automatically selects ideal subpanel(s) of markers from the complete available panel and performs basic qc steps. one advantage of pbap is its flexibility, unlike some other existing programs that allow file preparation and analysis of pedigrees but have constraints in how they select marker subpanels from dense panels. finally, pbap prepares files in a format suitable for pedigree-based analyses (i.e. morgan file format) and accesses software (i.e. gl_auto) to generate information suitable for pedigree-based analyses involving ibd information. this is particularly useful when samples include large pedigrees where estimation through mcmc is necessary, adding additional constraints to selection of marker subpanels. it is important to select an informative marker subpanel from a dense panel of snps to perform pedigree-based analyses involving ibd. pbap automatically selects a subpanel with adequate flexibility for the user so that differences in dense panels and evolving genotyping technologies should not dramatically affect the results. in particular, pbap includes specification of constraints needed to use methods that allow analysis of extended, as well as smaller, pedigrees. one of the main goals in selecting marker subpanels is to minimize significant ld between snps. the strategy used by pbap avoids the need for considerable data and computing resources imposed by trying to model ld during the analysis and also scales easily to use of much denser data, such as is present in high throughput sequencing. a second goal was to facilitate use of computational methods that allow intact large pedigrees. as this currently requires mcmc, pbap controls the mid and maf chosen. moreover, pbap internally pre-filters snps based on user-specified mid, dataset marker completion and maf range. with minute intermarker distances, mcmc-based methods suffer . similar results were observed from linkage analysis using both masel and pbap marker subpanels. a difference was the amount of  
