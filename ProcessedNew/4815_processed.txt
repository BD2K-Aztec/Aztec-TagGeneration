using de novo protein structure predictions to measure the quality of very large multiple sequence alignments motivation: multiple sequence alignments (msas) with large numbers of sequences are now commonplace. however, current multiple alignment benchmarks are ill-suited for testing these types of alignments, as test cases either contain a very small number of sequences or are based purely on simulation rather than empirical data. results: we take advantage of recent developments in protein structure prediction methods to create a benchmark (conttest) for protein msas containing many thousands of sequences in each test case and which is based on empirical biological data. we rank popular msa methods using this benchmark and verify a recent result showing that chained guide trees increase the accuracy of progressive alignment packages on datasets with thousands of proteins.making a multiple sequence alignment (msa) of nucleotide or amino acid sequences is a crucial step needed in a wide variety of bioinformatics studies. to overcome the extreme computational demands of exact algorithms, msa software uses heuristics to find near-optimal alignments in a reasonable time. different software packages, however, use different heuristics and objective functions and explicitly focus on different aspects of the msa process such as accurate placement of gaps for phylogenetic reconstruction of small numbers of sequences (l ytynoja and) or sheer speed for making very large alignments e.g. mafft parttree . accurate benchmarks are therefore important to allow users of msa software to choose the most appropriate tools and to guide developers in improving algorithms and heuristics . as computational resources and sequence databases grow, and methods for creating msas are improved, the practical upper limit for the size of msas increases. currently, alignments of tens of thousands of sequences can be made routinely on a desktop computer. it is therefore important that benchmarks can reflect alignment problems on this scale. current protein msa benchmarks can be divided into structure-, phylogeny-, simulation-and consistency-based benchmarks . structure-and phylogeny-based benchmarks, in which scores are based on structural superpositions and accurate inference of phylogenetic trees, respectively, are strongly grounded in empirical biological data, but they focus on alignments of small numbers of sequences and are difficult to scale to larger datasets. meanwhile, simulation-and consistency-based benchmarks are based on simulations of protein evolution and simple agreement between different msa methods, respectively, and can involve alignments of arbitrary size. it is unclear, however, how well simulated sequences model actual biological sequences, while consistency measures only how similar the results of one heuristic method are to the results of other heuristic methods.we developed conttest, a benchmark for large protein msas based on the accuracy of de novo contact map prediction. conttest contains 136 test cases with between 1467 and 43 910 sequences (median 7098) and an average length of between 31.9 and 370 residues (median 113.6) (see supplementary table s1 and). we used the benchmark to score alignments made by clustal omega , kalign 2 , mafft (katoh and), muscle , clustal w2 , kalign 1 and hmmt . additionally, the pfam database contains msas of all sequences in each protein family, and we used the benchmark to score the full alignments from pfam 27. clustal omega, kalign 2, mafft and hmmt were all run with default parameters. to make alignments in a reasonable time, kalign 1 was run with the fast heuristic-f option, muscle was limited to two iterations and clustal w2 reused the guide tree generated by clustal omega. benchmark scores for these alignment methods are listed in. at the top of the rankings are the hmmt, kalign 1 and pfam alignments. these results are striking and unexpected. since the method by which the pfam alignments are created is not directly applicable to general msa problems, the quality of pfam alignments has not previously been assessed in msa benchmark studies. similarly, neither kalign 1 nor hmmt have, to our knowledge, been considered in any recent benchmarking studies, as kalign 1 is superseded by kalign 2 and hmmt is not included in recent versions of hmmer. the pfam alignments are created in two steps. first, a manually curated seed alignment is created from a small set of sequences representative of the sequence family. this seed alignment is used to train an hmm which is then used to search a sequence database and align matching sequences to the seed alignment. we note that this processaligning sequence matches from a database oneby-one to a small seed alignmentis effectively performing progressive alignment with an almost perfectly chained guide tree. kalign 1 uses a traditional progressive msa strategy, with pairwise sequence distances estimated by approximate k-tuple matching. however, we found that kalign 1 with the fast -f option skips pairwise distance calculations and performs alignment with a fully chained guide tree, although this is an undocumented feature. meanwhile, hmmt produces an msa as a side effect of training an hmm on the input sequences and does not use a guide tree as part of this process. thus, the sequence-clustering step which is characteristic of progressive msa is not performed by any of these alignment methods. the next highest scoring method is kalign 2 . kalign version 2, like version 1, is a progressive aligner but lacks the option of its predecessor to use a fully chained guide tree. however, it uses the muth-manber algorithm to perform approximate k-tuple matching to estimate pairwise sequence similarities before constructing the guide tree. the pairwise distance metric used tends to produce highly chained guide trees . we find that this is true for our test cases, with kalign 2 guide trees having high measures of imbalance when compared with clustal omega , mafft or muscle (supplementary figs s2 and s3). this appears to be related to the length of the sequences aligned, with shorter average sequence lengths resulting in more chained guide trees (supplementary).conttest is the first protein msa benchmark to realistically test alignments of large numbers of sequences and base scores on empirical biological data. although structure-based benchmarks may contain alignments with many sequences, e.g. homfam , scores are always based on reference alignment of a small subset of sequences contained in the msa. this could allow large errors in non-reference sequences to go unpunished. in addition, the structure-based reference alignment must itself be created, and this alignment depends on heuristic structure comparison algorithms. meanwhile, the phylogeny-based speciesdiscordance benchmark of dessimoz and gil (2010)in which phylogenetic trees are inferred from msas and compared with a known reference treeis restricted to testing alignments of six sequences. simulation-based benchmarks allow for arbitrary numbers of sequences in test alignments but depend on simplified models of evolution and may not realistically model gap placement in real proteins. our benchmark method uses information from all sequences in the input alignments. test cases must contain a minimum of about 1000 sequences, so there is sufficient information in the alignment to make contact predictions, but there is no practical upper limit on the number of sequences. our benchmark scores confirm the utility of completely chained guide trees, as described by. that result has been controversial but, at least for alignments of many sequences from structurally conserved regions, the results appear clear and robust. alignments made with fully or even largely chained guide trees consistently outscore alignments made with more traditional guide trees. each of the alignment packages that accepts user-specified guide trees benefitted from using chained guide trees, and the increase in score due to chained guide trees was greater than the increase due to extra iterations of clustal omega or muscle or using a high quality external hmm with clustal omega. our scores also demonstrate the quality of the alignments in the pfam database, which may have previously been neglected, as well as suggesting that both kalign 1 and hmmt bemeasuring the quality of large multiple sequence alignmentsrevisited as useful methods for creating alignments of large numbers of sequences. we have shown that the conttest benchmark is in general agreement with structure-based benchmarks for large numbers of sequences. however, we observe that the methods that produce the most accurate alignments for large numbers of sequence do not necessarily perform well for small number of sequences, as measured by the prefab benchmark (supplementary). conttest is likely to be most sensitive to alignment errors in regions which are structurally conserved but without very high levels of sequence conservation. that is, regions of the protein in which amino acid substitutions are accepted but must be compensated for at co-evolving sites. a limitation of this benchmark is that all alignments inherently involve only sequences of a single protein domain, without any large insertions. it is likely that certain methods might perform poorly on more general alignment problems involving multiple domains. in particular, for hmmt alignments, it is necessary that a sensible hmm can be trained on the input sequences, which may not be possible in the general case. however, these are problems that may be addressed by future benchmarks, and alignments of single protein domains are common and important in many applications. finally, these results give some clear pointers toward the best methods for making msas intended for use with de novo structure prediction methods and show that choice of alignment method can have a large influence on the quality of contact predictions, even when using the same software package with different parameters.  
