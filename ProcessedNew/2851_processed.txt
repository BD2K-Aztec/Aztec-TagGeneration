sequence analysis mega-cc: computing core of molecular evolutionary genetics analysis program for automated and iterative data analysis there is a growing need in the research community to apply the molecular evolutionary genetics analysis (mega) software tool for batch processing a large number of datasets and to integrate it into analysis workflows. therefore, we now make available the computing core of the mega software as a stand-alone executable (mega-cc), along with an analysis prototyper (mega-proto). mega-cc provides users with access to all the computational analyses available through megas graphical user interface version. this includes methods for multiple sequence alignment, substitution model selection, evolutionary distance estimation, phylogeny inference, substitution rate and pattern estimation, tests of natural selection and ancestral sequence inference. additionally, we have upgraded the source code for phylo-genetic analysis using the maximum likelihood methods for parallel execution on multiple processors and cores. here, we describe mega-cc and outline the steps for using mega-cc in tandem with mega-proto for iterative and automated data analysis.the molecular evolutionary genetics analysis (mega) software is an integrated suite of tools for statistics-based comparative analysis of molecular sequence data based on evolutionary principles . mega is being used by biologists in a large number of laboratories for reconstructing the evolutionary histories of species and inferring the extent and nature of selective forces shaping the evolution of genes and species (see www.megasoftware.net). additionally, mega is used in many classrooms as a tool for teaching the methods used in evolutionary bioinformatics. one of megas key features is its graphical user interface (gui), which facilitates detailed visualization and interactive exploration of sequence data, phylogenetic trees and analysis results. however, over time the needs of mega users have expanded due to increasing availability of multi-gene and genome-scale data, which necessitate iterative, high-throughput analysis. in order to address this need, we have re-engineered the mega source code so that the computational core, which implements the computation algorithms for all analyses in mega, can be used as a stand-alone application and executed through command-line, other applications or scripting languages. we now make available mega-cc (computing core) that implements all the computational analyses available in the latest guibased edition; for a list of analysis, seein tamura et al. 2011. mega-cc comes with mega-proto, which provides an easy way to generate a configuration file specifying analysis options for the desired analysis . the use of mega-proto ensures that the analysis selections are fully validated and that they mirror those in the gui-based edition of mega. this leads to a consistent usage experience across different releases of mega and enables the user to test drive their analysis in the gui-based edition of mega 5.0. it also makes it possible for the programming team to more easily keep all versions of mega completely synchronized. we illustrate the use of mega-cc and mega-proto together in an example case where one wishes to infer maximum likelihood (ml) phylogenetic trees for many genes in series and the user has obtained multiple sequence alignments comprised of coding sequence data for each gene. using the mega-proto application, the user first generates an analysis options file that specifies the chosen settings for the substitution model, genetic code table, gaps/missing data treatment, distribution of rates, topology search approach, source for the initial tree, size of the execution thread pool and to whom correspondence should be addressed.optionally the number of replications for carrying out the bootstrap test of phylogeny . once the analysis options file has been saved to disk, the user is now ready to execute mega-cc to generate an ml phylogeny for each sequence alignment. in this scenario, the user has multiple options for processing the alignment files. the simplest method is to use the file iterator system in mega-cc which will search in a user-specified directory for all input data files that are compatible with the active analysis and process them iteratively. in our example, mega-cc would process all fasta and mega formatted sequence data files found in the specified directory. alternatively, the file iterator system can operate from a list of files that the user provides in a text file. to use this feature, the user can launch the mega-cc executable from a command prompt along with the appropriate parameter flag, and pass it a directory name or the name of a text file which lists all target input files. alternatively, the user can generate their own script that iterates over the names of the alignment files and launches the mega-cc executable for each file. supported input data files for mega-cc are fasta and mega files for sequence data, newick files for phylogenies and mega files for distance matrices. during execution, the progress of the analysis is displayed in the shell window and upon completion, the results files are written to the specified path. the format of the output files depends on the analysis done. for example, in the case of ml phylogeny reconstruction, the resulting phylogeny is written to a newick formatted text file. additionally, an optional analysis summary file, which includes information regarding the analysis such as log likelihood and estimated parameter values, is saved alongside the newick file. in addition to batch processing of single analyses, mega-cc gives users the ability to construct automated workflows that chain together multiple analyses. for instance, starting with a fasta file of dna sequence data, a multiple sequence alignment can be generated using either megas native implementation of clustalw or the integrated muscle alignment program. next, this alignment can serve as input data for a number of phylogenetic inference methods (e.g. ml, maximum parsimony and neighbor joining), all of which can be statistically tested by the bootstrap method. using the sequence alignment and phylogenetic tree that have been created, a user may perform further analyses such as inference of ancestral sequences, tests of natural selection, molecular clock test and estimation of evolutionary rates. alternatively, mega-cc can be easily integrated into pipelines constructed with other bioinformatics applications, as virtually all programming languages facilitate execution of external processes.we have also re-programmed ml analyses to efficiently utilize multiple processors and cores on the same machine for increased performance, which will greatly reduce the run time for computationally demanding ml inferences. for example, mega-cc reduces the time taken to complete ml tree search by almost half (49) when using two threads (speed-up 1.97) for an alignment containing 500 sequences, each having 2000 base pairs . addition of the third thread reduces the time further (speed up 2.73), a similar performance was achieved by raxml version 7.3.2 for two and three threads. (more detailed comparison of algorithms and speed-ups will be published elsewhere.) because virtually all new desktop workstations are equipped with at least a few cores (or processors), many will see significant performance increases when opting to use multiple threads and cores. in summary, mega-cc will address the needs of biologists interested in iterative and automated analyses. currently, mega-cc and mega-proto are available for the windows 32-bit computing platform. we plan to release the 64-bit version of mega-cc in the near future that will be natively compiled for all major operating systems and come with a web-based version of mega-proto.  
