genome analysis deconvolving tumor purity and ploidy by integrating copy number alterations and loss of heterozygosity motivation: next-generation sequencing (ngs) has revolutionized the study of cancer genomes. however, the reads obtained from ngs of tumor samples often consist of a mixture of normal and tumor cells, which themselves can be of multiple clonal types. a prominent problem in the analysis of cancer genome sequencing data is deconvolving the mixture to identify the reads associated with tumor cells or a particular subclone of tumor cells. solving the problem is, however, challenging because of the so-called identifiability problem, where different combinations of tumor purity and ploidy often explain the sequencing data equally well. results: we propose a new model to resolve the identifiability problem by integrating two types of sequencing informationsomatic copy number alterations and loss of heterozygositywithin a unified probabilistic framework. we derive algorithms to solve our model, and implement them in a software package called pyloh. we benchmark the performance of pyloh using both simulated data and 12 breast cancer sequencing datasets and show that pyloh outperforms existing methods in disambiguating the identifiability problem and estimating tumor purity. availability and implementation: the pyloh package is written in python and is publicly available at https://github.com/uci-cbcl/pyloh.the advent of next-generation sequencing (ngs) and launch of comprehensive cancer genome sequencing projects have yielded an unprecedented view on the complex landscape of cancer genomes, leading to the discovery of new cancer-causing genes and pathways, and novel therapeutic targets for treating cancers. analyzing the data from cancer genome sequencing remains, however, computationally challenging because of the shear size of the sequencing data and the complexity of the tumor genomes and samples. cancer genomes are often characterized by wide-spread somatic copy number alterations (cnas), where genomic segments are deleted or duplicated one or more times. identifying somatic cnas associated with specific tumor genomes is of longstanding interest in the study of cancer genomes and is one of the focal points of the cancer genome analysis. many computational methods have been proposed to discover copy number changes directly from dna microarrays or sequencing data . however, most of these methods aim at identifying the relative copy numbers of segments of the same tumor genome. discovering copy numbers in an absolute scale is biologically more relevant but more challenging. this is because of the fact that the absolute copy number changes can be affected by two confounding factors: (i) tumor purity, the fraction of all cancerous cells within a heterogeneous tumor sample, and (ii) tumor ploidy, the baseline copy number of genomic segments or entire chromosomes , both of which are unknown and themselves need to be estimated to infer absolute copy number changes. it is possible to estimate tumor purity and ploidy using experimental techniques such as quantitative image analysis and single-cell sequencing ; however, these techniques are still too expensive or time-consuming to support large-scale studies. hence, it is of great interest to use computational approaches to estimate tumor purity and ploidy, and consequently absolute copy number changes, directly from the ngs data. tumor purity and ploidy affect not only copy number changes in different segments of genomes but also the distribution of allele frequencies in these segments. in the ngs data, these two types of information can be summarized in terms of the total number of reads mapped to each segment (total read count) and the frequencies of reads matching b-alleles (b-allele frequencies) at different sites. computational methods have been proposed to estimate tumor purity alone or jointly with tumor ploidy based on these two types of information extracted from ngs data. depending on how copy number changes and b-allele frequency information are used, the existing methods can be roughly grouped into two categories: one category of methods use b-allele frequencies (bafs) at somatic mutation sites to estimate tumor purity, including purityest and purbayes . these methods leverage the fact that the bafs at somatic mutation sites are expected to be $0.5 if the tumor purity is 100, and any addition of normal cells will lead to a reduction in the observed bafs at these sites. the second category of methods relies on copy number changes to whom correspondence should be addressed. to estimate tumor purity and/or ploidy, including cnanorm , theta and absolute . it has been shown that the methods in the second category are often more accurate and robust than those in the first category because of the fact that (i) the total read counts are large in ngs data, and thus, methods relying on copy number changes are statistically more stable than methods relying on bafs at somatic mutation sites, the number of which is often small, and (ii) the determination of somatic mutations is not perfect and the inclusion of false-positive findings can significantly bias the estimation . however, the utility of the methods relying on copy number changes to estimate tumor purity and ploidy is severely hindered by the so-called identifiability problem, where different combinations of tumor purity and ploidy can explain the observed data equally well . this is because tumor purity and ploidy are often intertwinedchanges in one can be offset by compensations from the other, allowing the same copy number to be explained by multiple combinations of tumor purity and ploidy. for example, a homozygous deletion combined with 30 tumor purity can also be explained as a heterozygous deletion combined with 60 tumor purity. resolving this ambiguity is key to accurate estimation of tumor purity and ploidy. existing methods try to solve this identifiability problem by using heuristics, e.g. favoring solutions that have the smallest deviations from diploid (e.g. cnanorm;), seeking additional experiential data (e.g. absolute;) or simply outputting all possible solutions (e.g.). here we provide a more principled way to solve the identifiability problem by combining the information revealed from copy number changes and b-allele frequencies. instead of using ballele frequencies extracted from somatic mutation sites as in the previous cases, we use b-allele frequencies calculated at sites that are heterozygous with respect to the normal genomes, and most of which are common single nucleotide polymorphisms (snps). these heterozygous sites are much more abundant and easier to identify, leading to more statistically stable results. copy number changes in the cancer genome often result in loss of heterozygosity (loh) at these heterozygous sites, and the extent of loh is closely related to absolute instead of relative copy number changes. we will use bafs to gauge the extent of loh, and provide information on the absolute copy number changes by examining the patterns of bafs at the heterozygous sites within the same genomic segment. for example, although a homozygous deletion with 30 tumor purity results in the same copy number as a heterozygous deletion with 60 tumor purity in a tumor sample, b-allele frequencies at heterozygous sites of the tumor sample cluster at different values in the two combinations and therefore are able to distinguish these two cases. based on this insight, we propose a full probabilistic model implemented as a software package called pyloh to integrate the information gathered from cnas and loh. estimations of tumor purity and absolute copy numbers are then formulated as an optimization problem in which we choose those values that maximally explain both total read counts and b-allele frequency information. our method is similar in spirit to some of the earlier methods proposed for snp array analysis, where both the signal intensity and baf of each snp are used in estimating copy number changes. the combination of these two signals has been shown to improve the estimation accuracy of tumor ploidy , or both tumor purity and ploidy . recently, some of these methods have been extended to sequencing data, including oncosnp-seq by yau (2013) and patchwork by. however, the oncosnp-seq algorithm uses only the reads mapped to the snp sites, although our algorithm uses all reads, and thus should be able to yield a more accurate estimation of copy number changes. similar to our work, the patchwork algorithm also uses all reads, but it requires manual interpretation through data visualization to determine the initial copy numbers of clusters of genomic segments, which could be useful when the tumor genome is too complex for the algorithms to resolve different solutions by themselves. here we seek an alterative approach that is based on a generative model and requires no manual intervention. in addition, the patchwork algorithm requires the existence of copy-neutral loss of heterozygosity within the tumor genome to run the algorithm, whereas our algorithm has no such constraints. the outline of this article is as follows: in section 2, we describe the full probabilistic model of pyloh. in section 3, we first present cluster patterns of bafs in ngs data of paired tumor-normal samples, then introduce a visualization tool called baf heat map to characterize such patterns. finally, we compare tumor purity estimates of pyloh and other methods on both simulated datasets and 12 breast cancer sequencing datasets. our results show that explicitly incorporating both cnas and loh information can resolve the identifiability problem and significantly improve the accuracy of tumor purity estimation. finally, we discuss the limitations of pyloh and propose future directions in section 4.next we demonstrate the utility of combining loss of heterozygosity with cnas to infer tumor purity and ploidy. for this purpose, we first present a clustering pattern of b-allele frequencies derived from ngs data in paired tumor-normal samples. then we show that this clustering pattern can be used to resolve the ambiguous combinations of tumor purity and copy number changes, using both a toy example and real data. afterward, we apply our method pyloh, developed to infer tumor purity and absolute copy numbers by integrating the information from total read counts and b-allele frequencies, to simulated data and compare its performance with exiting state-of-the-art methods, cnanorm-1.4.0 , theta-0.0.3 and purbayes-1.3 . finally, we test the performance of our methods and other methods on real data, consisting of 12 whole genome sequencing datasets from breast cancer samples .in this article, we examined the problem of estimating tumor purity and absolute copy number changes from ngs data,. the tumor purity estimates of the first three simulated datasets given by theta, cnanorm, purbayes and pyloh. the x-axis is the estimated tumor purity and the y-axis is the ground truth tumor purityand here we only show the solutions with the smallest deviation from the diploid. b for tumor purities reported by theta with multiple solutions, we used the average of the solutions with the smallest deviation from the diploid to calculate the mae. and, in particular, focused on solving the identifiability problem that has not been properly solved by the existing methods. we demonstrated that the distribution of b-allele frequencies at sites that are heterozygous with respect to the normal genome provides key, but under used, information to solve the identifiability problem. we further developed a full probabilistic model to integrate the copy number change and baf information, and derived a principled way to estimate tumor purity and absolute cnas. we benchmarked the performance of our method, pyloh, on both simulated data and real whole genome sequencing data, showing that our method outperforms existing methods in both cases. pyloh requires a segmentation of the genome into segments with different cnas as input. many algorithms have been developed to segment genomes based on copy number changes and bafs of snp array data with varying levels of accuracy . a few of these array-based methods have recently been translated to the sequencing domain . a future direction of pyloh would be to integrate these existing methodologies and combine them with the probabilistic model of pyloh to carry out both genome segmentation and absolute copy number estimation. another important future direction is to use our model to study tumor heterogeneity. so far, we have focused on separating genetic changes from a mixture of normal and tumor cells. it is well known that multiple tumor clonal types may coexist in the tumor sample, each with an associated mutation landscape . to further model intra-tumor heterogeneity on top of the current probabilistic framework, we can assume there are multiple populations of tumor cells. thus, the model likelihood given by equation (9) can be extended to account for subclonal tumor populations (details in supplementary material). we plan to further extend pyloh in this direction to tackle the more challenging problem of deconvolving tumor heterogeneity by combining copy number change and allele frequency information.  
