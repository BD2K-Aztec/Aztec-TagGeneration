genetics and population analysis abacus: an entropy-based cumulative bivariate statistic robust to rare variants and different direction of genotype effect motivation: in the past years, both sequencing and microarray have been widely used to search for relations between genetic variations and predisposition to complex pathologies such as diabetes or neuro-logical disorders. these studies, however, have been able to explain only a small fraction of disease heritability, possibly because complex pathologies cannot be referred to few dysfunctional genes, but are rather heterogeneous and multicausal, as a result of a combination of rare and common variants possibly impairing multiple regulatory pathways. rare variants, though, are difficult to detect, especially when the effects of causal variants are in different directions, i.e. with protective and detrimental effects. results: here, we propose abacus, an algorithm based on a bivariate cumulative statistic to identify single nucleotide polymorph-isms (snps) significantly associated with a disease within predefined sets of snps such as pathways or genomic regions. abacus is robust to the concurrent presence of snps with protective and detrimental effects and of common and rare variants; moreover, it is powerful even when few snps in the snp-set are associated with the phenotype. we assessed abacus performance on simulated and real data and compared it with three state-of-the-art methods. when abacus was applied to type 1 and 2 diabetes data, besides observing a wide overlap with already known associations, we found a number of biologically sound pathways, which might shed light on diabetes mechanism and etiology. availability and implementation: abacus is available atin the past few years, the hereditary component of complex multifactorial diseases has started to be explored through the novel paradigm of genome-wide association studies (gwass). a gwas searches for patterns of genetic variation, in the form of single nucleotide polymorphisms (snps), between a population of affected individuals (cases) and a healthy (control) population. although these studies have successfully identified a number of significant snpdisease associations, they were able to explain only a small fraction of disease heritability . one of the reasons for this lack of success, as already faced in microarray data analysis , is that complex pathologies, such as cancer, diabetes or neurological disorders, are heterogeneous and multicausal, as a result of the alteration of multiple regulatory pathways and of the interplay between different genes and the environment, rather than imputable to a single dysfunctional gene like monogenic diseases . another important reason is that a combination of rare and common variants is likely to contribute to the disease . rare variants, though, are more difficult to detect than common variants ; in fact, single-marker tests are not powerful enough when applied in a context of low evidence of association (relatively low number of subjects carrying the rare allele) together with the need of correction for multiple testing . several alternatives to single marker tests have been proposed in the literature to detect rare variants. multiple marker methods test the association of a group of variants, e.g. snps within the same gene or pathway, to the disease. in this context, a widely applied approach is to test for the significance of accumulation of rare alleles within a phenotype, across a group of snps. briefly, for each subject, snps in the same group are collapsed to an indicator variable summarizing either the proportion of rare variants that carry at least one minor allele or the presence/absence of at least one rare variant . these approaches, known as collapsing methods or burden tests, loose power when a portion of snps increases the risk of disease and the remaining portion is protective. multi-marker approaches alternative to burden tests include the hotelling two samples t 2 test , the zglobal statistic and the weighted score test proposed by. the hotelling two samples t 2 test is a generalization of the students t-test, whose degrees of freedom increase with the number of snps being simultaneously tested, thus losing power with the snp-set size. the zglobal statistic and the weighted score test have only one degree of freedom; however, using these methods implies to know the risk allele at each variant and, as for burden tests, power is affected by the relative proportions of snps increasing and decreasing the risk of disease. alternatives, whose power does not depend on the snp-set size and that do not make any assumption on the direction of the snp effect (i.e. on the protective or detrimental effect of the variants on the phenotype), are the methods based on genotype similarity between individual in the same group, such as to whom correspondence should be addressed. multivariate distance matrix regression and kernel-based association tests (kbat) . in particular, multivariate distance matrix regression has been shown to be more powerful for sets of correlated snps, whereas kbat well handles both correlated and uncorrelated snps . in general, these latter methods based on genotype similarity between individuals are robust to the direction of genotype risk. however, they have been reported to lose power when higher minor allele frequency (maf) snps are included in the snp-set or when many snps are jointly analyzed and only few of them are associated with the disease, probably due to the relative low number of subjects compared with the number of possible combinations of rare variants . recently, an optimal unified approach for rare variant association testing has been proposed by; the method, called skat-o, combines burden tests with a sequence kernel association test. because in general, a combination of rare and common variants influencing the genotype with a protective or detrimental effect is likely to contribute to the disease, an ideal method should be robust to different maf, to different direction of genotype effects and to the number of associated snps within the snp-set being analyzed. moreover, it is desirable to gain some knowledge on the specific snps associated with the disease. in fact, multi-marker and cumulative test methods assess the association of a group of markers, but do not distinguish between associated and not associated markers within the group. here, we propose abacus, an algorithm based on a bivariate cumulative statistic designed to analyze snps with different maf in the same group, independently on the protective or causative effect of the minor frequency allele. being based on a bivariate statistic, abacus, differently from other methods, performs multiple tests on each snp, namely, equal to the number of snps in the snp-set minus 1. this provides multiple evidence of associations and allows increasing the sensitivity with respect to other methods, such as methods based on genotype similarity between individuals in the same group and sequence kernel association tests, which instead calculate a cumulative snp-set statistic to associate snp-sets to phenotype. moreover, the bivariate statistic used by abacus is independent on the minor allele being protective or causative to the disease, which makes abacus advantageous with respect to burden tests. relying just on a bivariate statistic, though, would be type 1 error prone because of the number of performed tests. thus, to control type i error, abacus implements a bonferroni correction within each snp-set together with a graph-theoretic approach to identify groups of significant snps. applied to a whole snp dataset, abacus gives as output a list of snp-sets associated with the disease and, for each snpset, the list of significant snps. abacus, like other methods, first requires the definition of the snp-sets, such as pathways, genes or genomic regions encoding a priori information on the potential point effects of the snps in each subset. we consider biological pathways as the preferred definition of snp-sets, as studying the cumulative variation of snps mapping on genes in the same pathway (interacting genes) might fill in part the missing heritability and guide mechanistic studies helping uncovering the underlying disease pathways . moreover, abacus is particularly suited for pathway analysis, given its ability of simultaneously considering common and rare variants and different direction of genotype effects. in the following, we introduce abacus and assess its performance in comparison with other methods on a number of simulated datasets with known genotypephenotype associations. to better appreciate the various facets of the method and assess it also on real data, we illustrate abacus application to the wellcome trust case control study on type 1 and 2 diabetes (the wellcome trust case control consortium, 2007). results show how abacus is able to select a number of snps and genes associated to diabetes, previously identified either by the wtccc consortium or in different t1d and t2d gwas, showing high sensitivity in detecting both common and rare variants. moreover, abacus identifies new biologically sound associations with diabetes, involving genes associated with focal adhesion, platelet homeostasis, inositol phosphate metabolism and glutathione metabolism for type 1 diabetes and tryptophan metabolism and lipid homeostasis for type 2 diabetes.  
