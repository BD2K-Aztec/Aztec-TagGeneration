genome analysis cnv-guided multi-read allocation for chip-seq motivation: in chromatin immunoprecipitation followed by high-throughput sequencing (chip-seq) and other short-read sequencing experiments, a considerable fraction of the short reads align to multiple locations on the reference genome (multi-reads). inferring the origin of multi-reads is critical for accurately mapping reads to repetitive regions. current state-of-the-art multi-read allocation algorithms rely on the read counts in the local neighborhood of the alignment locations and ignore the variation in the copy numbers of these regions. copy-number variation (cnv) can directly affect the read densities and, therefore, bias allocation of multi-reads. results: we propose cnvcsem (cnv-guided chip-seq by expectation -maximization algorithm), a flexible framework that incorporates cnv in multi-read allocation. cnvcsem eliminates the cnv bias in multi-read allocation by initializing the read allocation algorithm with cnv-aware initial values. our data-driven simulations illustrate that cnvcsem leads to higher read coverage with satisfactory accuracy and lower loss in read-depth recovery (estimation). we evaluate the biological relevance of the cnvcsem-allocated reads and the resultant peaks with the analysis of several encode chip-seq datasets.chromatin immunoprecipitation followed by sequencing (chipseq) is currently the dominant high-throughput assay in functional genomics and epigenomic research, especially for mapping transcription factordna (tf-dna) interactions and histone modifications. in a typical chip-seq experiment, tens of millions of dna fragments (usually 1001000 bp) are sequenced directly from one or both ends, and short reads (usually 25100 bp) are recorded. the analysis of chip-seq data starts with the mapping of the short reads to a reference genome with a short-read aligner, e.g. bowtie and bwa . because of repetitiveness of the genomes, errors in reads and the short-read lengths, 1030 of the reads can map to multiple locations . common practice in chip-seq analysis is to use only uniquely mapping reads (unireads) and discard the reads that map to multiple locations (multi-reads) . although using uni-reads alone is adequate in many cases, it makes any inference about the repetitive regions challenging, if not impossible. in addition, recently developed multi-read allocation methods have successfully argued that use of such reads leads to identification of many novel proteindna interactions in chip-seq experiments . furthermore, they illustrated that the effective increase in the coverage of the highly repetitive regions owing to multireads can not be simply achieved by adjusting for low mappability during peak calling . although there are some specific modeling differences among different chip-seq aligners, they predominantly operate by allocating multi-reads to their mapping locations based on the read counts of the local neighborhoods of the mapping locations, which largely relies on the uni-read counts. regions of high sequence similarity tend to have low uni-read counts, making it challenging for the algorithms to distinguish between different mapping locations. furthermore, none of them take into account copy-number variations (cnvs), which are structural variations of a genome that reflect the differences between the sample genome and the reference genome in the number of copies of dna segments. cnv has a direct effect on read depths of the sequencing samples. in the literature, this effect has been appreciated in peak calling and in differential epigenome (chip-seq and rna-seq) analyses . as of today, none of the multi-read mapping methods has considered the potential effect of cnv on multi-read allocation and the power it might provide for discriminating the mapping locations of multi-reads. the former methods estimate cnv from the mapped chip or control samples and incorporate this information during peak identification. however, if the reads are allocated without taking into account the cnv, cnv estimated from such mapped reads will be biased, especially in the repetitive regions (e.g.). furthermore, even if the reads are mapped correctly, their genome-wide coverage is not uniform , and the high copy-number regions identified from such data may be confounded with the open chromatin regions. this motivates us to correct the cnv bias at the stage of read allocation by using external cnv data instead of estimating it from the chip or control samples. we refer tofor a similar discussion in a different setting. to investigate the impact cnvs might have on multi-read allocation, we extracted all the reads that align to exactly two locations of the reference genome in a ctcf chip-seq sample from gm12878 cells (such two locations are referred to as an alignment pair from hereon). we found that for 15.2 of reads that map two locations, the copy numbers of the alignment pairs differed by at least one (supplementaryand supplementary); and therefore, we expect the cnvs to inform the multi-read allocation for such reads. even for the alignment pairs with the same copy number, cnvs may still have an indirect impact by affecting the allocation of other reads in the neighborhoods of these alignment locations. for multi-reads with more than two alignments, the copy numbers are more likely to vary among the alignment locations, and a larger impact of cnv is expected. in this article, we develop cnvcsem (cnv-guided chip-seq by expectation-maximization algorithm), a flexible framework that guides multi-read allocation by cnvs. the cnvcsem takes advantage of the state-of-the-art multi-read allocation algorithms and incorporates cnv information parsimoniously. we use the fact that various array-and sequence-based cnv detection algorithms have been developed , and large consortia such as 1000 genomes have produced high-throughput sequencing data for cnv detection. combining these efforts, detecting cnv and estimating copy number with a reasonable accuracy is possible. our data-driven simulation results show that (i) cnvcsem increases multi-read allocation coverage and significantly reduces allocation ambiguity in the segmental duplication regions (sdr) with only a marginal loss in accuracy, and (ii) cnvcsem also improves the accuracy of the read-depth recovery, especially in the highly repetitive regions with low copy numbers. our study of several encode tf chip-seq experiments demonstrate the biological relevance of the cnvcsem-allocated reads and the chip-seq peaks identified in the downstream analysis.in this section, we compare the following three read allocation strategies using data-driven simulations and actual chip-seq experiments.uni: only uni-reads are kept, and all the multi-reads are discarded. csem: in addition to the uni-reads, all the alignments of multi-reads with a csem posterior probability ! 0:5 are kept. cnvcsem: in addition to the uni-reads, all the alignments of multi-reads with a cnvcsem posterior probability ! 0:5 are kept. although keeping multi-read allocations with a posterior probability !0.5 reduces the number of multi-reads used, it facilitates downstream analysis with commonly adapted encode chipseq uniform analysis pipeline, which requires each read to map to a single location on the reference genome . throughout this article, we used bowtie aligner . specifically, multi-read allocation with csem and cnvcsem used reads with at most two mismatches and a maximum of 99 alignment locations. reads with only one reported alignment location are referred to as uni-reads.in chip-seq experiments and other short-read sequencing experiments, a significant fraction of the reads map to multiple locations. processing of multi-reads can impact the downstream analysis of peak calling significantly. none of the currently available multi-read allocation methods take into account cnvs in the sample genomes. we showed in this article that using cnv provides additional information for discriminating mapping locations of a multi-read with similar uni-read counts. our datadriven simulations revealed significant improvements in multiread allocation accuracy and better read-depth recovery when using cnv information. analysis of multiple encode datasets indicated that peaks identifiable only when using copy-number information in multi-read allocation have biologically meaningful characteristics. in our framework, we incorporated cnv in the initialization of the ems algorithm instead of explicitly including it in the model because of the nature of the cnv information. intuitively, copy numbers should influence the elements of the read density as multipliers. if the copy numbers are already encoded in 0 during the initialization step, their influence will be preserved in the updates of the iterations, except at the locations around the break points of the cnv regions. however, the typical numbers of break points are small. for gm12878 and gm12891 experiments, cnvnator detects 55000 cnv regions, and consequently 510000 break points. the array-based cnv annotation of hepg2 includes 5600 break points. compared with the length of the whole genome, this additional effect ofthe deletion regions include both heterozygous and homozygous deletions. in all, 96.5 of the uni-only peaks are captured in both the extended lists of csem and cnvcsem; however, only 44.1 of the multi-common are identified in the extended peak list of uni-reads.notes: (1)and(2) in the first column denote gm12878 and gm12891 cells, respectively  
