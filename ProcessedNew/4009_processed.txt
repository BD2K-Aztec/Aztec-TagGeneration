ridgerace: ridge regression for continuous ancestral character estimation on phylogenetic trees motivation: ancestral character state reconstruction describes a set of techniques for estimating phenotypic or genetic features of species or related individuals that are the predecessors of those present today. such reconstructions can reach into the distant past and can provide insights into the history of a population or a set of species when fossil data are not available, or they can be used to test evolutionary hypotheses , e.g. on the co-evolution of traits. typical methods for ancestral character state reconstruction of continuous characters consider the phylogeny of the underlying data and estimate the ancestral process along the branches of the tree. they usually assume a brownian motion model of character evolution or extensions thereof, requiring specific assumptions on the rate of phenotypic evolution. results: we suggest using ridge regression to infer rates for each branch of the tree and the ancestral values at each inner node. we performed extensive simulations to evaluate the performance of this method and have shown that the accuracy of its reconstructed ancestral values is competitive to reconstructions using other state-of-the-art software. using a hierarchical clustering of gene mutation profiles from an ovarian cancer dataset, we demonstrate the use of the method as a feature selection tool. availability and implementation: the algorithm described here is implemented in c++ as a stand-alone program, and the source code is freely available atmany biological studies investigate the ancestral states of one or several discrete and continuous characters on a phylogenetic tree . comparative methods correlate the evolution of alleles at different loci with each other or with a trait and thus often require the reconstruction of ancestral values. typical examples for discrete characters are the reconstruction of the absence, presence or state of genes or traits for the internal nodes of the tree (i.e. for the ancestral organisms), while typical examples for continuous characters are environmental preferences of different species, measures of morphology or physiology or behavioral or metabolic properties . such reconstructions are also of interest when fossil records cannot be retrieved, when the phenotype of interest cannot be determined from the fossil tissue or when studying the evolution of a gene family across different environmental conditions. statistical approaches such as regression or correlation can fail to estimate correlations between traits correctly when they assume that closely related species are statistically independent . comparative methods account for such dependencies by including estimates of the phylogeny underlying the data into their predictions. in the case of continuous characters, most of these techniques are based on a simple model assuming neutral evolution of the respective character. the brownian motion (bm) model assumes that the trait of a leaf node in a phylogeny develops as a random walk starting from the ancestral root. the duration of that walkand therefore the change and variance in the traitis assumed to be proportional to the change in branch length covered between those two nodes. at each inner node, the random walk bifurcates, creating two dependent processes and thus defining a stochastic distribution for all leaves. several methods that apply the bm model are available to reconstruct continuous ancestral characters, and implemented in widely used software packages, such as ape , geiger , phytools , mesquite , bayestrait/continuous , paup and contml . one of the simplest ways to reconstruct a continuous ancestral character state was established with felsensteins algorithm for phylogenetic independent contrasts . in the phylogenetic independent contrasts algorithm, ancestral values are computed recursively as the weighted average of their child values, with the weights set according to the distance (i.e. the branch length) of these children. in addition, branch lengths leading to reconstructed internal nodes are rescaled to account for the uncertainty of the reconstruction. this leads to a maximum likelihood estimation of the ancestral value for the root node alone. other algorithms estimate the values for the whole tree by re-rooting or by a squared change maximum parsimony approach . linear regression allows another framework to formulate the reconstruction of ancestral character states, and generalized least squares has been suggested as a technique to reconstruct ancestral values as a weighted average of the values of all extant species, while taking the correlation structure described by the phylogenetic tree into account . this approach is particularly flexible, as it allows detailed assumptions of the evolutionary process by inclusion of an appropriate covariance matrix. several possible extensions and modifications of the bm process have been suggested and can be considered for ancestral character state reconstruction. for example, the ornsteinuhlenbeck (ou) process models adaptation explicitly by defining a single global optimum or several local optima of to whom correspondence should be addressed. the author 2014. published by oxford university press. this is an open access article distributed under the terms of the creative commons attribution non-commercial license (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. for commercial re-use, please contact journals.permissions@oup.com directional selection. a major restriction of the bm and the ou models, noted in, for example,, is the assumption of a constant rate of trait variation throughout the underlying phylogeny. the early burst model offers an alternative that decreases the rate of evolution exponentially through time, and describes a process of adaptive radiationprovide a detailed comparison]. the acdc model describes a process of accelerating versus decelerating rates of character evolution toward an optimum, i.e. a combination of ou and early burst. several methods allow us to estimate bm rates , to test for variations in that rate or use different rates in different parts of the tree or to suggest global branch length transformations in the phylogeny to account for variable rates . however, most of the phylogenetic methods aforementioned do not explicitly aim to reconstruct ancestral character states. they are originally concerned with correlations between two or more traits [phylogenetic regression, grafen (1989);] or with tests for deviation from the assumption of a globally constant rate, and they do not suggest how to infer ancestral character states for more complex scenarios. in addition, critical studies note that deciding on the correct model might be difficult and warn of over-interpreting the phylogenetic patterns .we here describe a new method for the inference of ancestral character states for continuous characters by performing a ridge regression between the total branch length reaching from theridgerace: ridge regression for ancestral character estimation root to a leaf node and the phenotypic value of that leaf. the inference is made by minimizing the prediction error at extant nodes as well as an additional l2-norm regularization factor. the regularization forces the phenotypic rate to be distributed more equally across the whole tree and to branches shared by several nodes, circumventing the trivial case that explains the phenotype by a gain at the terminal branches owing to the overparameterization. our evaluation showed that ridgerace achieved a good congruence between inferred and simulated ancestral character states, and that it performed similarly to or better than two other state-of-the-art methods in terms of the mean squared error. ridgerace does not assume any underlying model of evolution, and thus, the method allows large flexibility when no definite assumptions can be made about the type of evolutionary process. the formulation of the optimization problem] allows the straightforward inclusion of measurements at ancestral nodes (e.g. from fossil records). in a similar fashion, multiple measurements at a node can be easily included to lend further support to the inference. such measurements might originate from multiple observations of the same trait for the same species, or they might represent several traits fitted together. finally, visualization of the inferred branch weights along the tree allows a detailed interpretation of the specific phenotypic rates and can indicate short periods of strong directional selection or of increasingly). branches are colored according to the phenotypic rate parameter ; the thickness of branches is proportional to the number of nodes below them. branches leading directly to leaf nodes were colored gray for improved visibility. labels m1 to m5 indicate branches with strong changes in patient survival time. changes in the absence or presence of mutations in the selected genes are indicated on all branches with four or more childrennote: ridgerace running time is provided as the running time required for full inference plus time required for acr.  
