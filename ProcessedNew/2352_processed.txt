imbalanced multi-label learning for identifying antimicrobial peptides and their functional types motivation: with the rapid increase of infection resistance to antibiotics, it is urgent to find novel infection therapeutics. in recent years, antimicrobial peptides (amps) have been utilized as potential alternatives for infection therapeutics. amps are key components of the innate immune system and can protect the host from various pathogenic bacteria. identifying amps and their functional types has led to many studies, and various predictors using machine learning have been developed. however, there is room for improvement; in particular, no predictor takes into account the lack of balance among different functional amps. results: in this paper, a new synthetic minority over-sampling technique on imbalanced and multi-label data sets, referred to as ml-smote, was designed for processing and identifying amps functional families. a novel multi-label classifier, mlamp, was also developed using ml-smote and grey pseudo amino acid composition. the classifier obtained 0.4846 subset accuracy and 0.16 hamming loss. availability: a user-friendly web-server for mlamp was established at http://www.jci-bioinfo.cn/mlamp.with rapid increase in the infection resistance of antibiotics, it is urgent to find novel infection therapeutics. over the past decade antimicrobial peptides (amps) have been utilized as potential alternatives for fighting infectious diseases. amps are key components of the innate immune system and can protect the host from various pathogenic bacteria. in invertebrates and vertebrates, amps have dual roles: rapid microbial killing and subsequent immune modulation . these effects result from amp inducing multiple damages in bacteria by disrupting bacteria membranes , by inhibiting proteins, dna and rna synthesis, or by interacting with certain intracellular targets . therefore, amps were developed increasingly for new drugs. some examples of using amps in therapeutics have been reported. popovic et al. found that peptides with antimicrobial and antiinflammatory activities had therapeutic potential for treatment of acne vulgaris . yancheva et al. synthesized a novel didepsipeptide with antimicrobial activity against four of five tested bacterial strains of escherichia coli . conlon et al. demonstrated that peptides with antimicrobial activity from frog skin could stimulate insulin release, and hence had potential as an incretinbased therapy for type 2 diabetes mellitus . in addition, amps have been used as anticancer peptides in cancer therapy . a surge in research on amps has promoted the development of various databases and prediction tools. apd2 is a system dedicated to establishing a glossary, nomenclature, classification, information search, prediction, design, and statistics of amps. it gathered 2,544 amps from the literature. camp holds 6,756 antimicrobial sequences and 682 3d structures of amps, together with prediction and sequence analysis tools.) tested all subsequences ranging from 5 to 100 amino acids of the plant proteins in associate editor: dr. john hancock uniprokb/swiss-prot and constructed an amp database for plant species, named c-pamp. zhao et al. developed lamp, a database used to aid the discovery and design of amps as new antimicrobial agents. the database contains 3,904 natural amps and 1,643 synthetic peptides . dbaasp was a manually curated database built by gogoladze et al., and it collected those peptides for which antimicrobial activities against particular targets have been evaluated experimentally . generally, amps are short peptides with 1050 amino acids and have very low sequence homology to one another. so it is challenging to identify amps and its activities by automatic tools. researchers made considerable efforts in this regard. in these studies, the support vector machine (svm) was usually used as prediction engine . besides, nearest neighbor or k-nearest neighbor algorithm , random forests (rfs) , decision tree model , and hidden markov models (hmms) were also applied as classifiers. some predictors were only used to identify whether novel peptides are amps . in addition to these simple binary classifiers, there were some multi-class classifiers.) created a decision tree model to classify the antimicrobial activities of synthetic peptides into four classes: none, low, medium, and high. joseph developed classamp to predict the propensity of a peptide sequence to have antibacterial, antifungal, or antiviral activity . khamis et al., studied 14 amp families and sub-families. they selected a specific description of amp amino acid sequence, and identified compositional and physicochemical properties of amino acids to distinguish each amp family . furthermore, xiao et al. proposed a two-level multi-label classifier, iamp-2l, which identifies not only whether a peptide is an amp, but also its functional activities . although these methods have their own advantages and did play an important role in the research, they have following problems. firstly, most models only identified whether a new sequence is amp, but not its type. secondly, it is hard to search short peptides in the database because amps usually have only 550 amino acids. methods based on blast search and gene ontology are often ineffective. last but not least, classifying amps functions is a multi-label classification (mlc), especially when the number of amps with different activities does not distribute evenly. from apd2 , it is seen that antibacterial peptides occupy more than 90 of all amps, which is a highly unbalanced mlc. none of aforementioned automatic models considered the unbalanced amounts among various activities. in the past two decades, the topic of learning from multi-label data sets (mlds) has drawn significant attention from researchers. moreover, mlc methods are increasingly applied in various fields, such as semantic annotation of images , categorization , and bioinformatics . the existing mlc methods can be grouped into two categories: (1) problem transformation methods, which transform mlc either into one or more single-label classification or regression problem, and (2) algorithm adaptation methods, which extend specific learning algorithms in order to handle mlds directly . numerous mlc algorithms were proposed, such as adaboost.mh and adaboost.mr , ml-knn , classifier chains , and multi-label nave bayes . mlc often has serious issues of unbalanced data sets, in which the numbers of samples from minority classes are substantially fewer than from majority classes. for example, in subcellular localization prediction , the number of the cytoplasm proteins is 44 times the number of the melanosome proteins. a similar situation occurs in many studies . standard machine learning algorithms often cannot achieve ideal performance when trained on unbalanced data set. one approach to address this issue is to adapt existing classifier learning algorithms to strengthen learning with regard to the minority class. another approach is to artificially sample the class distribution . combining both approaches can also achieve strong classifiers . unquestionably, the sampling approach continues to be popular . various over-and under-sampling methods have been proposed . among them, smote (synthetic minority oversampling techinque) is a state-of-art over-sampling methods. chawla argued that smote creates effective regions for learning the minority class rather than being subsumed by the majority class samples around them. in bioinformatics, some studies have applied smote to balance the skewing benchmark datasets . in addition, similar approaches have been recently introduced to handle the unbalanced datasets, such as monte carlo sampling and fusion ensemble approach . although the aforementioned methods have some success in addressing unbalanced data sets, they have not achieved a satisfactory result in processing multi-labeled and imbalanced datasets simultaneously. few works address the imbalance problem in mlc.) took into account the imbalance in predicting subcellular localization of human proteins.) built an undersampling and oversampling algorithm on mlds. those studies improved the multi-label classification performance; however, they have some drawbacks in how to address the multi-label character of the new synthetic instance. in this paper, we tackle the imbalanced problem by a novel oversampling model referred to as ml-smote, which is a synthetic minority oversampling on mlds. we developed a new tool as a two-level amp predictor based on ml-smote. for a peptides sequence, we first identify whether it is an amp. if yes, we then predict what potential activities it has. the first-level is a binary predictor, and the second-level predictor is an unbalanced and multi-labeled multiclasses predictor. the result shows ml-smote can adjust the label set distribution to improve the performance of the predictor.after the sequence feature retrieval and ml-smote preprocessing as described above, a two-level amp predictor named mlamp was constructed, in which the ensemble of classifier chains (ecc) algorithm was adopted as the prediction method . we used the canonical implementation of ecc provided by the mulan multi-label learning in the) library and for ecc, the binary and multiclass learners are implemented on the weka platform using the random forest (rf) algorithm (breiman, 2001).mlamp is a two-level prediction engine (see). the first level of mlamp predicts a query peptide as amp or non-amp by using the rf algorithm. it belongs to the case of single-label classification. the following four measures were used for examining the performance of a single-label predictor, they are: (1) overall accuracy or acc; (2) mathews correlation coefficient or mcc; (3) sensitivity or sn; and (4) specificity or sp.where tp represents the true positive; tn, the true negative; fp, the false positive; fn, the false negative. although eq. 20 was often used in the literature to measure the prediction quality of a method, they often lack intuitiveness, especially to biologists, particularly the mcc. according to chous formulation, these four measures can be expressed as (where n stands for the total number of amp samples investigated, whereas n for the number of amp samples incorrectly predicted to be of non-amp; n for the total number of non-amp samples investigated, whereas n for the number of non-amp samples incorrectly predicted to be of amp. with such a formulation as given in eq. 21, the meanings of sensitivity, specificity, overall accuracy, and mathews correlation coefficient and their scopes would become more intuitive and easier-tounderstand, particularly for the mathews correlation coefficient, as concurred by a series of studies published very recently if a query peptide is predicted as amp, the second level of mlamp will start to classify its functional families. this process belongs to the case of multi-label classification. hamming loss, subset accuracy, accuracy, precision and recall are the mostly used evaluation metrics for the performance of a multi-label classifier . suppose is the subset that contains all the labels for the kth sample p ; is the subset that contains all the predicted labels for the kth sample p ; n is the total number of samples; and m is the total number of labels. in this study, n=879 and m=5. the five metrics have been clearly defined as follows :where is the operator acting on the set therein to count the number of its elements, andwhen assessing a predictor, the following three cross-validation methods are often used in the literature: independent data set test, subsampling (k-fold cross-validation) test, and jackknife test. however, as elaborated in , among the three cross-validation methods, the jackknife test is deemed the least arbitrary and most objective because it can always yield a unique result for a given benchmark data set. hence, the jackknife test was adopted in this study to examine the anticipated success rates of the current predictor. the process of jackknife test can be explained as follows: input: multi-label dataset t=pi 1 i n. output: predicted label set. for i: 0n t is divided into testing dataset ts=pi, and training dataset tr=t-ts. generate new training dataset tr by using ml-somte on tr. train model on tr by using ecc algorithm. predict the label set of pi by the model trained above. end forcompares the performance of mlamp with an existing method iamp-2l in the first-level result on the benchmark (eq. 1), where overall accuracy acc and mcc achieved by mlamp are higher than those achieved by iamp-2l. to further demonstrate the power of the mlamp predictor, we compared it with other classical predictors on an independent dataset containing 920 amps and 920 non-amps. this comparison was used for independent testing in . the results listed inwere obtained by mlamp, iamp-2l and camp on. as shown in, the performances achieved by mlamp is remarkably higher than the performances reported by iamp-2l and camp in all metrics (sn, sp, acc and mcc). furthermore, in the second level prediction, mlamp also obtained better performance than iamp-2l. some different metrics were used from single-label classification, in particular-hamming loss, accuracy, precision, recall and subset accuracy were commonly applied in mlc.gives the detailed jackknife test results on the amp dataset (eq. 2). especially mlamp gained a 0.4846 success rate in the strict assessment of subset accuracy and this performance was 5 higher than that by iamp-2l.why can these metrics be improved so remarkably by using mlamp? there are two key reasons. the first reason is probably the new peptide feature coding model (see eq. 13).sorts the 30 features in decreasing order after analyzing the benchmark data set by the feature selection tool minimal-redundancy-maximalrelevance (mrmr) . as shown in, those features generated by the grey model include more information than amino acids frequency, especially their biochemical properties. and one can draw a conclusion that some physicochemical properties of amino acids may play an important role in amp, such as molecular weight, pi and pk2. the second reason points to the new ml-smote model. the amp dataset is an imbalance mld, and previous studies did not take it into account. after processing the training dataset by the mlsmote model, the balance property of the new synthetic training data set was improved, which can help the machine learning obtained a better performance.due to increasing antibiotic resistance, amps, which are key components of innate immune system, are becoming more and more important in drug development. efficiently and effectively identifying amps and their functional types has become an urgent research topic. the results reported in this study indicate that the novel predictor, mlamp, provides an accurate and useful tool for researchers to find new infection therapeutics. mlamp obtained a better prediction performance than that of a previous method. the primary reason for our good performance is our formulation models peptide extraction features. since amps usually have 550 amino acids, our model (eq.13) is good for formulating short peptides. it includes the internal relationship of amino acids sequence in various physical-chemical properties. the second reason is the mlsmote model, which does a good job of handling the lack of balance problem in multi-label data sets. compared with other methods, the sample synthetized by using ml-smote retains the multi label distributions. it not only accumulates minority samples but also keeps the label density of mld. in the future, the mlsmote model can be extended to assist with imbalance and multi-label data sets for other problems. for practical applications, a user-friendly web-server for mlamp has been established at http://www.jci-bioinfo.cn/mlamp, which allows users to easily obtain their desired results without the need to follow the complicated mathematical equations involved in developing the predictor. users can submit a peptide sequence to the webserver and subsequently the webserver will return the predicted result in real time. alternatively, users can choose the batch prediction by entering their e-mail address and their batch input file of many peptide sequences. they will quickly receive an email showing the predicted results from seconds to hours depending on the number of sequences.  
