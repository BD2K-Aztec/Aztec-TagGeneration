a robust and accurate binning algorithm for metagenomic sequences with arbitrary species abundance ratio motivation: with the rapid development of next-generation sequencing techniques, metagenomics, also known as environmental genomics, has emerged as an exciting research area that enables us to analyze the microbial environment in which we live. an important step for metagenomic data analysis is the identification and taxonomic characterization of dna fragments (reads or contigs) resulting from sequencing a sample of mixed species. this step is referred to as binning. binning algorithms that are based on sequence similarity and sequence composition markers rely heavily on the reference genomes of known microorganisms or phylogenetic markers. due to the limited availability of reference genomes and the bias and low availability of markers, these algorithms may not be applicable in all cases. unsupervised binning algorithms which can handle fragments from unknown species provide an alternative approach. however, existing unsupervised binning algorithms only work on datasets either with balanced species abundance ratios or rather different abundance ratios, but not both. results: in this article, we present metacluster 3.0, an integrated binning method based on the unsupervised topdown separation and bottomup merging strategy, which can bin metagenomic fragments of species with very balanced abundance ratios (say 1:1) to very different abundance ratios (e.g. 1:24) with consistently higher accuracy than existing methods. availability: metacluster 3.0 can be downloaded attraditional microbial genomic studies usually focus on one single individual bacterial strain due to experimental limitations. in fact, all microorganisms in a habitat have various functional effects on one another and their hosts. for example, the diversity of microbes in humans is shown to be associated with common diseases such as inflammatory bowel disease (ibd) and gastrointestinal disturbance . genomic analysis on the collective genomes of all microorganisms from to whom correspondence should be addressed. an environmental sample (known as metagenomics, environmental genomics or community genomics) becomes essential. one major difficulty of metagenomics lies in the fact that most bacteria (up to 99) found in environmental samples are unknown and cannot be cultivated and isolated under laboratory conditions . with high-throughput sequencing technology, one possible solution is to directly sequence dna fragments of multiple species obtained from the mixed environmental dna sample . some well-known metagenomics projects, including the acid mine drainage biofilm (amd) project that analyzes dozens of species and the human gut microbiome (hgm) project that involves thousands of species , study fragments obtained from this sequencing approach. dna fragments of a metagenomics project are usually from multiple genomes and most of the genome sequences are unknown. an important step in metagenomic analysis is to group dna fragments from similar species together (referred to as binning) to obtain the microbe distribution of the sample and identify species (including unknown species) within the sample. depending on different research needs, the binning process could be performed on different taxonomic levels from kingdom (the highest level) to species (the lowest level). traditional binning methods can be roughly classified as similarity based and composition based. similarity-based methods align each dna fragment to known reference genomes. based on the alignment results [e.g. blast hits or selected phylogenetic specific marker genes (, each fragment is assigned to the taxonomic class of the similar reference genomes. similarity-based methods are usually limited by the availability of known microorganism genomes given that 1 of microorganisms have been cultured and sequenced. on the other hand, composition-based methods group dna fragments in a supervised or semi-supervised manner using generic features such as genome structure or composition. structural features, such as composition features of reference genomes or taxonomic marker regions [e.g. 16s rrna , reca and rpob are commonly accepted fingerprint genes], are extracted and used to construct classifiers for determining dna fragments from different species or constraints for semi-supervised clustering. these composition-based methods usually suffer from the low availability and reliability of taxonomic markers. for example, studies on the enhanced biological phosphorus removing (ebpr) sludge , sargasso sea and the minnesota soil samples indicate that only 0.17, 0.06 and 0.017 of the dna fragments, respectively, are known to carry 16s rrna markers, and the figures are still 1 even if more markers such as reca and rpob are included. moreover, the reliability of taxonomic markers has also been challenged as some species may share multiple markers with other species or multiple kinds of 16s rrna molecules exist in a single bacterium due to the high mutation and gene exchange ratio of microbes, which might lead to incorrect classifications. a more promising direction is to use unsupervised binning algorithms based on the occurrence frequencies of l-mers (short dna substrings of length l) of the dna fragments . in these approaches, each fragment can be regarded as a vector containing the occurrence frequencies of all possible l-mers in the fragment. the rationale behind these approaches is based on the observation that the l-mer distributions of the fragments in the same genome are more similar than those l-mer distributions of two unrelated species . based on this feature, many algorithms [e.g. tetra , metacluster , metacluster 2.0 and likelybin (have applied different unsupervised clustering methods on fragments based on the l-mer distributions with great success when the abundance ratios of the species in the sample are almost the same. these algorithms tend to cluster fragments into clusters with similar size, and the binning performance of these algorithms will significantly be degraded when the abundance ratios of species are very different, e.g. 1:8 or 1:10. to tackle this problem, another unsupervised clustering method called abundancebin has been introduced recently, which models the distribution of fragments from each species by different poisson distributions. fragments from species with high abundance ratios are usually sampled more while fragments from species with low abundance ratios are usually sampled less. thus, fragments from species with different abundance ratios can be separated by their sampling rates. however, when the species have similar abundance ratios, say 1:1 or 1:2, the sampling rates of fragments from different species are similar and abundancebin fails to separate the fragments from these species. abundancebin also considers the case when the number of species k is unknown and determines k automatically. the estimation method seems not very effective and cannot predict the correct value when k 3 in our experiments. none of the above algorithms can handle datasets from balanced species abundance ratios to very different species abundance ratios. in real situations, the abundance ratios are usually unknown and it is desirable to have an algorithm handles datasets with arbitrary abundance ratios. abundancebin takes advantage of the differences in abundance ratio of the species to separate the fragments and it is not obvious how to extend abundancebin to handle datasets with very balanced abundance ratio. on the other hand, approaches that handle datasets with balanced abundance ratio usually try to cluster fragments into k equal-sized clusters by assuming the number of species in the dataset is k. thus, species with low abundance ratio are forced to group wrongly with other species. in this article, we present metacluster 3.0, an integrated binning algorithm with two phases: topdown clustering (phase 1) and bottomup merging (phase 2). in phase 1, we separate fragments into small groups (clusters) with similar sizes and try to guarantee that the majority of the fragments belong to the same species. after phase 1, it is possible that fragments from the same species are grouped into different clusters, so in phase 2, we try to combine these clusters together.outlines the two phases of metacluster 3.0. this two-phase strategy relies on the following key observations. first, the difference (we capture this difference using the spearman distance measure) between two l-mer distributions of fragments from the same species follows a normal distributions. the same is true for the two l-mer distributions of fragments from species of different families. this observation is supported by an empirical study (section 2.2). second, the differences in the two normal distributions allow us to derive a probabilistic model to determine how many clusters (k ) we should use in order to guarantee that most of the fragments in the same cluster belong to the same species in phase 1 and when to merge the clusters to make sure that there will not be too many fragments from other species being merged together. based on our probabilistic model, if the abundance ratios of the species are more or less the same, the value of k will be similar to the number of species. if the species have very different abundance ratios, k tends to be large and the clusters will be small so that fragments from minority species could be assigned to separate clusters without mixing with fragments from other species. although fragments of majority species may then be put in different clusters, phase 2 will try to merge them back. thus, the issue of varying species abundance ratio is handled. to summarize, metacluster 3.0 can (i) determine automatically the number of different species in the sample, which is required aspage: 1491 14891495in this section, we analyze the performance of the binning algorithm, metacluster 3.0, based on the simulated metagenomic datasets. we compare the performance of metacluster 3.0 with abundancebin and our previous version metacluster 2.0 . we have not compared other unsupervised binning algorithms because metacluster 2.0 outperforms these algorithms in similar experimental setting . we use the default parameters for abundancebin and metacluster 2.0. we have conducted three sets of experiments. (i) we fix the number of species to be 2 and vary the abundance ratio from the balanced situation 1:1 to the unbalanced situation of 1:24. we assume that the number of species in the dataset is known. the performance of metacluster 3.0 is consistently more accurate for all datasets with different abundance ratios. (ii) we also compare the performance of metacluster 3.0 with abundancebin based on datasets with more species with different abundance ratios. in this set of experiments, we also assume that the number of species is known. the results show that metacluster 3.0 outperforms abundancebin. in particular, the accuracy of metacluster 3.0 is three times better than that of abundancebin when the species abundance ratio is balanced.(iii) lastly, we demonstrate that metacluster 3.0 works better than abundancebin if the number of species in the dataset is unknown. in all the experiments, we use the parameters t = 5 and = 0.8. we have varied the parameters and the results are similar.  
