sufficient statistics and expectation maximization algorithms in phylogenetic tree models motivation: measuring evolutionary conservation is a routine step in the identification of functional elements in genome sequences. although a number of studies have proposed methods that use the continuous time markov models (ctmms) to find evolutionarily constrained elements, their probabilistic structures have been less frequently investigated. results: in this article, we investigate a sufficient statistic for ctmms. the statistic is composed of the fractional duration of nucleotide characters over evolutionary time, f d , and the number of substitutions occurring in phylogenetic trees, n s. we first derive basic properties of the sufficient statistic. then, we derive an expectation maximization (em) algorithm for estimating the parameters of a phylogenetic model, which iteratively computes the expectation values of the sufficient statistic. we show that the em algorithm exhibits much faster convergence than other optimization methods that use numerical gradient descent algorithms. finally, we investigate the genome-wide distribution of fractional duration time f d which, unlike the number of substitutions n s , has rarely been investigated. we show that f d has evolutionary information that is distinct from that in n s , which may be useful for detecting novel types of evolutionary constraints existing in the human genome. availability: the c++ source code of the fdur software is available at http://www.ncrna.org/software/fdur/although the number of sequenced genomes is increasing rapidly, the technologies that extract biological information from them are still in their infancy. finding evolutionarily constrained elements in a target genome sequence is among the most successful uses of those massive genomic sequences . in those studies, the researchers estimated the level of the substitution rate for each genomic region and tested whether it was significantly lower or higher than an estimated rate of neutral evolution. the substitution rates were computed from a given species tree and genome-wide alignments by using variants of continuous time markov models (ctmms), which have been used in the maximum likelihood (ml) method of phylogenetic tree construction . while the relations between the likelihoods of ctmms and possible topologies of the phylogenetic trees have been extensively studied for many years, their probabilistic structures for a fixed tree topology, which are very important for the genome-wide studies mentioned above, have been less frequently studied. in this article, we investigate a sufficient statistic for ctmms that is composed of the fractional duration of each nucleotide over evolutionary time, f d , and the number of substitutions that have occurred in a phylogenetic tree, n s. the sufficient statistic naturally appears in expectation maximization (em) algorithms for finding the local maximum of the likelihood function . however, previous studies treated them only as intermediate variables for parameter optimization and did not investigate their properties or their genome-wide distributions.developed a dynamic programming algorithm for computing the null distribution of n s , corresponding to neutral evolution which was then used for computing p-values for constrained elements. however, no investigation of the distribution of f d has appeared in the literature. in the following sections, we first derive basic properties of the sufficient statistic, such as its behaviors in the limiting cases at the time where the parameter is close to zero or infinity. we derive an em algorithm for estimating the substitution matrix and the branch lengths, which iteratively computes the expectation values of the sufficient statistic, then we explain how the branch lengths used in parsimony methods are related to those in the ml method. many previous studies of the em algorithm optimized only some of the phylogenetic model parameters, which means that some of the expectation values required for a full parameter optimization are lacking.;derived an em algorithm for substitution matrices, but did not optimize branch lengths. consequently, the expected durations defined by them are not appropriate expected values when the branch lengths are optimized.did not optimize the stationary distribution of the general time reversible model and thus missed the expectation n (i) defined in our article.derived a partial em algorithm for phylogenetic models but the hidden variables of their em algorithm only included the nucleotide states on ancestral nodes, instead of considering all the possible substitution histories along tree branches, which are the random processes described by the models.we have investigated the sufficient statistic, composed of the fractional duration time f d and the number of substitutions n s , for continuous time markov models. we have derived em algorithms for the general unrestricted (unrest) model and the general time reversible (gtr) model. in the case of the gtr model, we have derived a stationary equation method for solving the m step optimization problem. both the em algorithm and the stationary equation method have a property which is not shared by the gradient descent methods: the objective functions monotonically approach to their optimal values . we have also shown that the em algorithm converges faster than the gradient descent methods. although we did not describe em algorithms for other phylogeny models with discrete gamma rate variations and invariance sites , the application of our method to such models is straightforward. there is a natural definition of local posterior trees which are derived from the stationary equations, and we have discussed the relationships between the branch lengths in the maximal likelihood method and those in the parsimony method. finally, we have investigated the genome-wide distributions of the sufficient statistic. we have shown that the fractional duration f d has evolutionary information that is not contained in the expected number of substitutions n s0. in our experiments on the f d distributions, we have focused on only the point that the fractional duration f d contains information different from those contained in the expected substitution count n s0 , which is not obvious from the outset since conserved regions (n s0 0) naturally have biased distributions (larger d f ) and thus they are strongly anti-correlated. in order to establish a novel method for finding novel constrained elements based on statistics (n s0 , d f ), several additional factors should be considered and investigated. first, we need to explore at least 2d space (n s0 , d f ) of statistics. it means that we have to determine a threshold curve rather than a single threshold value to determine the constrained sites. also, more precise characterization of the correlations between (n s0 , d f ) and the patterns of aligned species (i.e. the 01 patterns representing whether each species have an aligned nucleotide or not in an alignment column). we have touched on this issue in the codon sites experiment, but discarding most of the information from the 44 species alignments and keeping only four species for computing statistics is not a satisfactory method. it requires the genome-wide distribution of 2 44 possible patterns of alignment column types. to make any statistical statement on the level of constraint, computation of the theoretical distribution will be useful. we have only analyzed the empirical distributions of the sufficient statistic and have not analyzed the distribution determined by the phylogenetic model. there is a dynamic programming algorithm for computing the distribution of n s0 . although it seems difficult to compute the theoretical distribution of f d with similar methods, it can be computed by a sampling method as shown in the supplementary material. furthermore, we must investigate other nuisance parameters such as the length scales of the constrained elements in order to decide if a consecutive segment is constrained or not. lastly, we assumed that the genomescale alignments provided at the ucsc site are completely reliable. however, there are studies that suggest that the errors contained in the multiz alignments may be considerable . it will be interesting to investigate to what extent the computed statistics are sensitive to the errors of the alignments.  
