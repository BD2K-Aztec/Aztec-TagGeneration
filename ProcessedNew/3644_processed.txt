gene expression predicting in vitro drug sensitivity using random forests motivation: panels of cell lines such as the nci-60 have long been used to test drug candidates for their ability to inhibit proliferation. predictive models of in vitro drug sensitivity have previously been constructed using gene expression signatures generated from gene expression microarrays. these statistical models allow the prediction of drug response for cell lines not in the original nci-60. we improve on existing techniques by developing a novel multistep algorithm that builds regression models of drug response using random forest, an ensemble approach based on classification and regression trees (cart). results: this method proved successful in predicting drug response for both a panel of 19 breast cancer and 7 glioma cell lines, outperformed other methods based on differential gene expression, and has general utility for any application that seeks to relate gene expression data to a continuous output variable. implementation: software was written in the r language and will be available together with associated gene expression and drug response data as the package ivdrug at http://r-forge.r-project.org. contact:advances in high-throughput drug screening technologies in the past 20 years have enabled the testing of hundreds of thousands of drug candidates on panels of cancer cell lines. an important goal is applying this information to predict drug response in different cell lines specific to certain cancer types and ultimately clinical tumor samples. the enormous diversity of tumor biology, even within cancers from the same tissue, makes this aim especially challenging. several attempts to create predictive models of drug response have made use of the nci-60, a panel of human cell lines originally derived from human cancers spanning nine different tissues of origin . the developmental therapeutics program (dtp) at the national cancer institute has screened nearly 400 000 compounds against these cell lines since the origin of the nci-60 program in the late 1980s. cell lines from a particular tissue of origin were eventually shown not to be highly predictive of human tumors of the same tissue type. nevertheless, the to whom correspondence should be addressed. overall pattern of inhibitory responses from a particular drug across all 60 cell lines proved highly useful as a drug response fingerprint that could help pinpoint drug mechanism and efficacy . the nci-60 has been extensively molecularly characterized using a variety of high-throughput assays, including five independent gene expression microarray experiments utilizing a number of different platforms.first applied nci-60 basal (resting) gene expression data, produced without application of a drug, to create predictive models of drug activity . gene signatures of 232 drugs from 6817 genes were created using a weighted voting algorithm, which predicted a binary response (sensitive or resistant) based on an association between gene expression and drug response. the contribution of each gene expression level in the training set to the model was weighted by the statistical correlation between the expression level for that gene across all cell lines and the experimentally determined drug sensitivity across all cell lines. using this approach, one-third of the original 232 drugs could predict drug sensitivity at significant levels (p 0.05) when tested on cell lines from the nci-60 that had been held out from the original training set.used differential gene expression between sensitive and resistant cell lines to define a drug signature . they showed that signatures produced from the top 12 and bottom 12 responding cell lines for each drug could be used to create a categorical model for cisplatin and paclitaxel in a panel of 40 bladder cancer cell lines. then by screening 45 545 compounds in the dtp database against the same cell line panel, the authors identified 139 compounds predicted to be effective at inhibiting growth in 35 of cell lines. the top compound hit proved to be a potent inhibitor of growth in bladder cancer cell lines, although the rest of the predictions were not systematically tested. recently,developed a phenotype-based screen based on the nci-60 . signatures developed from ras activation, pi3k activation, as well as tumor samples from basaldefined breast cancer were first compared with expression states in cell lines from the nci-60. cell lines were ranked by statistically defined similarity to signatures. the pearsons correlation between signature similarity and drug response in the database was then used to identify drugs with similar response patterns. although the results were not systematically experimentally tested, one drug (simvastatin) showed the ability to inhibit tumor growth of basal-type breast tumors in a mouse model. in an attempt to build on these promising approaches, we asked whether the existing methods could be improved in three specific ways: (i) creation of drug gene expression signatures based onwe tested the method on two external datasets: (i) 19 breast cancer cell lines tested with the two drugs simvastatin and pepleomycin (ii) seven glioma cell lines tested with 40 fda-approved oncology drugs.we have created a novel algorithm for predicting in vitro drug response from a signature of basal gene expression. unlike previous methods, this approach incorporates multivariate interaction of input variables (gene expression levels), automatically indentifies core cell lines associated with each drug, and models drug response as a continuous variable. as demonstrated, this approach outperforms a comparable method based on univariate differential gene expression. although statistical tests of differential gene expression have been an important tool for the analysis of microarray data, interactions between the biological pathways that drive gene expression levels provide another layer of information that can be mined using multivariate approaches such as random forest. since regression trees incorporate variable interactions as a natural consequence of data partitioning, they provide an ideal algorithmic approach for incorporating variable interactions in the creation of a gene expression signature. techniques for explicitly encoding gene gene interactions, such a multifactor dimensionality reduction (mdr), may also be worthwhile to investigate in future work. although single trees do not generally provide the statistical power of other multivariate techniques, ensemble methods such as random forest that randomly sample from both cases and input variables have shown to be competitive with class-leading techniques such as support vector machines and stochastic gradient boosting (diaz-uriarte and alvarez). in addition, random forest requires little or no parameter tuning and is therefore suitable for machine-learning tasks such an in silico screen that require the creation of a large number of statistical models. the heterogeneity of cell line panels such as the nci-60 presents a challenge to the creation of drug gene expression signatures. previous workers have created models using only cell lines from the nci-60 showing extreme values of ic50 response to any particular drug. however, defining resistant and sensitive cell lines becomes problematic when many drugs show ic50 distributions across the nci-60 that are not normally or uniformly distributed. using a ranked-based definition of drug sensitivity may also produce nonoptimal training sets for drugs in which the ic50 distribution is skewed. to overcome these obstacles, we created a novel approach to identify core cell lines for each drug using the case proximity metric in random forest. we note that another group has recently published a method for associating drugs with sets of core cell lines . however, this approach was based on a fully linear method, does not incorporate variable interactions and was not used to develop predictive models of drug response. functional screens that combine basal gene expression and drug response from panels of cell lines such as the nci-60 may prove to be an important tool for the discovery of compound leadsespecially for complex and heterogeneous diseases such as cancer. by experimentally testing the inhibitory profiles of 40 fdaapproved cancer drugs in seven glioma cell lines, we have provided one of the most complete validation tests to date of this approach. the predictive algorithm that we have developed can be generalized to other problems in machine learning that require the generation of predictive signatures from large numbers of input variables that may exhibit a high degree of noise and self-correlation.  
