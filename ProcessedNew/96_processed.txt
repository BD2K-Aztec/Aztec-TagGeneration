a conditional neural fields model for protein threading motivation: alignment errors are still the main bottleneck for current template-based protein modeling (tm) methods, including protein threading and homology modeling, especially when the sequence identity between two proteins under consideration is low (30). results: we present a novel protein threading method, cnfpred, which achieves much more accurate sequencetemplate alignment by employing a probabilistic graphical model called a conditional neural field (cnf), which aligns one protein sequence to its remote template using a non-linear scoring function. this scoring function accounts for correlation among a variety of protein sequence and structure features, makes use of information in the neighborhood of two residues to be aligned, and is thus much more sensitive than the widely used linear or profile-based scoring function. to train this cnf threading model, we employ a novel quality-sensitive method, instead of the standard maximum-likelihood method, to maximize directly the expected quality of the training set. experimental results show that cnfpred generates significantly better alignments than the best profile-based and threading methods on several public (but small) benchmarks as well as our own large dataset. cnfpred outperforms others regardless of the lengths or classes of proteins, and works particularly well for proteins with sparse sequence profiles due to the effective utilization of structure information. our methodology can also be adapted to protein sequence alignment.template-based modeling (tm) methods, including homology modeling and protein threading have been extensively studied for protein 3d structure modeling. the quality of a tm model depends on the accuracy of sequencetemplate alignment ; this alignment usually contains errors when only distantly related templates are available for a protein sequence under prediction. current tm methods for protein alignment suffer from two limitations. the first limitation is that these methods use linear scoring functions to guide the sequencetemplate alignment . the choice of a scoring function impacts alignment accuracy . a linear function cannot deal well with correlation among protein features, although many features are indeed correlated (such as secondary structure and solvent accessibility). the second limitation is that these methods heavily depend on sequence profiles the authors wish it to be known that, in their opinion, the first two authors should be regarded as joint first authors. to whom correspondence should be addressed.. although sequence profiles are very powerful, as demonstrated by hhpred and many others , they fail when a protein has a very sparse sequence profile . the sparseness of a sequence profile can be quantified using the number of effective sequence homologs (neff). neff can also be interpreted as the average shannon sequence entropy for the profile or the average number of amino acid substitutions across all residues of a protein. the neff at one residue is calculated by exp( k p k ln p k ) where p k is the probability for the k-th amino acid type, and the neff for the whole protein is the average across all residues. therefore, neff ranges from 1 to 20 (i.e. the number of amino acid types). a smaller neff corresponds to a sparser sequence profile and less homologous information content. to go beyond the limitations of current alignment methods, this article presents a novel conditional neural field (cnf) method for protein threading, called cnfpred, which can align a sequence to a distantly related template much more accurately. cnfpred combines sequence information (a sequence profile) and structure information using a probabilistic non-linear scoring function and is superior to current methods in several respects. first, it explicitly accounts for correlations among protein features, reducing both overcounting and undercounting. second, it can align different regions of proteins using different criteria. in particular, for disordered regions, only sequence information is used, as structure information is unreliable, while for other regions, structure information is also used. third, cnfpred dynamically determines the relative importance of homologous and structural information. when a protein under consideration has a sparse sequence profile, cnfpred relies more heavily on structural information; otherwise it relies more heavily on sequence information (such as sequence profile similarity). finally, cnfpred varies gap probability based on both context-specific and positionspecific features. if the protein sequence profile is sparse, it will rely more on context-specific information, including structure information; otherwise it relies more heavily on the position-specific information derived from the alignment of sequence homologs. cnfpred integrates as much information as possible in order to estimate the alignment probability of two residues. in particular, to estimate more accurately the probability that two residues should be aligned, it uses neighborhood informationboth sequence and structure. neighborhood information is also helpful in determining gap opening positions. neighborhood sequence information has been used by many programs [such as psipred (for protein local structure prediction and by a few for protein sequence alignment and homology search , but such information has not been applied to protein threading, especially to determine gap opening. it is much more challenging to make use of neighborhood information inwe have presented cnfpred, a novel cnf model for threading of proteins with sparse sequence profiles. cnfpred takes advantage of as many correlated sequence and structure features as possible to improve alignment accuracy. we have also presented a qualitysensitive training method to improve alignment accuracy, as opposed to the standard ml method. despite using many features and a i64  
