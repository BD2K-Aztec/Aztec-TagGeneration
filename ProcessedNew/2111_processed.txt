gene expression grape rna-seq analysis pipeline environment motivation: the avalanche of data arriving since the development of ngs technologies have prompted the need for developing fast, accurate and easily automated bioinformatic tools capable of dealing with massive datasets. among the most productive applications of ngs technologies is the sequencing of cellular rna, known as rna-seq. although rna-seq provides similar or superior dynamic range than microarrays at similar or lower cost, the lack of standard and user-friendly pipelines is a bottleneck preventing rna-seq from becoming the standard for transcriptome analysis. results: in this work we present a pipeline for processing and analyzing rna-seq data, that we have named grape (grape rna-seq analysis pipeline environment). grape supports raw sequencing reads produced by a variety of technologies, either in fasta or fastq format, or as prealigned reads in sam/bam format. a minimal grape configuration consists of the file location of the raw sequencing reads, the genome of the species and the corresponding gene and transcript annotation. grape first runs a set of quality control steps, and then aligns the reads to the genome, a step that is omitted for prealigned read formats. grape next estimates gene and transcript expression levels, calculates exon inclusion levels and identifies novel transcripts. grape can be run on a single computer or in parallel on a computer cluster. it is distributed with specific mapping and quantification tools, but given its modular design, any tool supporting popular data interchange formats can be integrated. availability: grape can be obtained from the bioinformatics and genomics website at: http://big.crg.cat/services/grape.the development of ultrasequencing technologies during the recent years has started a major revolution in biology. the ability to directly survey the cells rna content by applying ngs technologies to cdna sequencing (rna-seq) has provided insights of unprecedented depth on the transcription landscape of many species such as homo sapiens , mus musculus , arabidopsis thaliana , saccharomyces cerevisiae and schizosaccharomyces pombe . rna-seq has proven particularly powerful on tasks such as identifying novel genes and novel splice forms, detecting low abundance transcripts and finding sequence variations, such as snps . it is gradually substituting microarrays as the technology of choice for transcriptome analyses, providing access to a greater dynamic range of rna expression levels . the throughput of ngs technologies is continuously accelerating, and the cost per sequenced nucleotide is rapidly falling. as a consequence, an unprecedented amount of data are being produced, pressing for the development of fast and efficient methods of analysis, as the bottleneck for scientific discovery is gradually shifting from data production to data analysis. in the analysis of ngs data, processing efficiency is governed predominantly by two factors: first, the sheer size of the individual datasets, and second, the vast number of datasets to be analyzed. the current generation of sequencing machines, for example, illumina highseq, can produce the equivalent of 20 the coverage of the human genome in a single run, delivering $600 million reads with a length of4100 nt. this has spawned a new generation of aligners optimized for aligning short sequences to the genome, for example, bowtie , bwa , bfast and gem , which are much faster than previous tools such as basic local alignment search tool, fasta or ssearch (see, for a short review). additionally, an increasing number of projects involve large sample sizes to be analyzed, often under complex experimental designs. in the specific case of rna-seq, mapping of reads is only the first step of a complex data processing schema, the final goal of which is to produce accurate gene and transcript quantifications, and to delineate novel transcript structures. the lack of easy-touse pipelines to perform such a processing out of the box in a transparent and streamlined fashion is actually a bottleneck that prevents the expansion of rna-seq, and prompts users with little access to sophisticated bioinformatic resources to prefer microarrays, for which standard ready-to-use processing pipelines and user-friendly bioinformatic analysis tools exist. to address this need, specific pipelines have recently been developed for analyzing rna-seq data, such as the pipeline developed by), an analysis pipeline developed in r within the context of the arrayexpress database. these and other tools facilitate the analysis of rna-seq data, but still require the user to have a significant bioinformatics background, specifically when complex experiments with a large number of datasets need to be analyzed. to whom correspondence should be addressed. the author 2013. published by oxford university press. this is an open access article distributed under the terms of the creative commons attribution license (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.here we describe grape, a workflow for the analysis of rna-seq data that automates all the steps from rna-seq reads to transcript quantification and discovery. its user-friendly interface provides the necessary overview of all the data, and is therefore particularly suited for processing numerous files, produced in complex experimental setups. the results, both intermediate and final, are stored in an mysql database, allowing for access through the database interface, but can also be visualized through raisin, a user-friendly web application. the same html interface that is used for standalone local analysis is easily deployed on a web server for remote access in collaborative projects, or data dissemination. grape takes three types of input files. first, the read files, which may be aligned or not, the reference genome sequence file and the corresponding gene annotation file. alternatively, grape can also take read alignment files as input, rather than raw read files. grape produces a number of output files in tabular format, so they can be easily loaded into most statistical packages. while this is the case for quantifications, which are made available individually at the gene, transcript and exon level, the bam format is used as an output format for alignments. more specifically, processing of rna-seq reads by grape involves the following steps: (i) sequence read evaluation, and trimming if required; (ii) mapping to the genome, and the transcriptome; (iii) assembly of reads in absence of a reference genome, or before genome mapping; (iv) identification of novel exons, and splice junctions and modeling of transcript structures and (v) gene and transcript quantification. grape pays special attention to quality controls (qcs), which trace quality scores and uncalled bases along the reads, look for biased nucleotide composition and inspect the distribution of reads along transcripts. these can be used for qc, although grape leaves any decision to modify the data, such as trimming and filtering, to the user. grape is based on the pip pipeline management system . the current grape distribution uses samtools , the gem mapper , the flux capacitor and cufflinks , but any tool compliant with popular data interchange formats like gff, bam/sam and bed can be used. grape can be run locally or on a computer cluster. speed-up of the analyses is achieved by parallelizing certain steps and taking advantage of multithreading where possible. the grape implementation conserves a copy of the exact software and configuration used for a given set of analyses, guaranteeing forward reproducibility.here we presented and discussed grape, an architecture for a computational pipeline for the analysis of millions or billions of short reads obtained from (potentially many) high-throughput rna-seq experiments. this is a general and flexible pipeline that combines contributions of previous studies with our own experience dealing with rna-seq data. grape attempts to address the challenges both from the processing and management standpoints associated to the analysis of sheer amounts of data. it automates the processing and analysis steps, while at the same  
