structural bioinformatics fingerprinting protein structures effectively and efficiently motivation: one common task in structural biology is to assess the similarities and differences among protein structures. a variety of structure alignment algorithms and programs has been designed and implemented for this purpose. a major drawback with existing structure alignment programs is that they require a large amount of computational time, rendering them infeasible for pairwise alignments on large collections of structures. to overcome this drawback, a fragment alphabet learned from known structures has been introduced. the method, however, considers local similarity only, and therefore occasionally assigns high scores to structures that are similar only in local fragments. method: we propose a novel approach that eliminates false posi-tives, through the comparison of both local and remote similarity, with little compromise in speed. two kinds of contact libraries (contactlib) are introduced to fingerprint protein structures effectively and efficiently. each contact group of the contact library consists of one local or two remote fragments and is represented by a concise vector. these vectors are then indexed and used to calculate a new combined hit-rate score to identify similar protein structures effectively and efficiently. results: we tested our method on the high-quality protein structure subset of scop30 containing 3297 protein structures. for each protein structure of the subset, we retrieved its neighbor protein structures from the rest of the subset. the best area under the receiver-operating characteristic curve, archived by contactlib, is as high as 0.960. this is a significant improvement compared with 0.747, the best result achieved by fragbag. we also demonstrated that incorporating remote contact information is critical to consistently retrieve accurate neighbor protein structures for all-query protein structures. availability and implementation:although assessing the similarities and differences between protein structures is a common practice in structural biology, efficiently performing this comparison is critical in some applications. for example, once a new protein structure is determined, researchers often need to infer its function or evolution by studying proteins of similar structures. a few databases, such as scop and cath , maintain hierarchical classifications of known protein structures. the need to obtain structures similar to the new protein from these databases motivates the neighbor protein structure retrieval problem: given a query protein structure and a database of protein structures, retrieve all the structures in the database that are similar to the query structure. one intuitive solution to the neighbor protein structure retrieval problem is to align the query protein structure and every protein structure of the database using a pairwise protein structure alignment tool. one successful approach of pairwise protein structure alignment is to represent protein structures as 3d coordinates and to find the optimal residue mapping and orientation (rotation and translation) together, as stralign , combinatorial extension (ce) , local-global alignment (lga) , secondary-structure matching (ssm) , tmalign and spalign (proposed. an orientation-free approach is possible by encoding each structure as a 2d matrix of residueresidue interaction distances; comparison between two structures can be performed by an alignment of their respective matrices as proposed in dali . one drawback of adopting these approaches is inefficiency, especially when the protein structure database is large. either using 3d coordinates or using distance matrices, solving the pairwise protein structure alignment problem is np-hard . thus, all the aforementioned pairwise protein structure alignment tools adopt heuristic approaches without global optimality guarantee. unfortunately, such heuristic approaches are still time-consuming . the concern for efficiency has prompted the use of 1d protein structure profiles, which often perform well. in particular, the current state-of-the-art method called fragbag has been shown experimentally to be fast and accurate on average. specifically, fragbag represents a protein structure as a profile that contains counts of structure fragments in a fragment alphabet learned from known structures. then, neighbor protein structures can be retrieved by comparing the profiles efficiently. one drawback, however, is that although fragbag is capable of delivering good average accuracy, its accuracy is sometimes significantly worse than the average accuracy, as shown in section 3.1. this accuracy drop occurs when two structures are similar in many local fragments but differ significantly in their overall structure; because fragbag compares only local contacts, it fails to identify the large non-local discrepancy in these structures. to whom correspondence should be addressed.in this article, we present contactlib, a complete contact group library defined in section 2, which is to be used as fingerprints of protein structures. fragbag and local feature frequency profile (lffp) are two promising tools that are closely related. our contactlib is different from fragbag and lffp in following ways: (i) fragbag and lffp are developed on general structure fragments, whereas contactlib introduces both local and remote contact groups eliminating potentially weak contact groups; (ii) fragbag and lffp use 3d coordinates or 2d distance matrices, whereas contactlib introduces 1d distance vectors that can be efficiently indexed; (iii) fragbag and lffp require a predefined word alphabet, whereas contactlib avoids such word alphabet and introduces some freedom of specifying similarity thresholds at runtime; and (iv) fragbag and lffp use word frequency profiles and distance functions from the text information retrieval problem, whereas contactlib introduces a combined hit-rate scoring function for the neighbor protein structure retrieval problem. because the word alphabet of lffp is not publicly available, we focus on comparing contactlib and fragbag in this article. as an initial study, we built two contactlibs: contactlib-9l, which models local contacts, and contactlib-3r, which models remote contacts. using one or both of contactlib-9l and contactlib-3r, we tested our method on the high-quality protein structure subset of scop30 containing 3297 protein structures. for each protein structure, we retrieved its neighbor protein structures from the rest. according to the receiver-operating characteristic (roc) curve analysis in section 3.1, the best area under the roc curve (auroc), archived by contactlib, is as high as 0.960. this is a significant improvement compared with 0.747, the best result achieved by fragbag . specifically, when contactlib-3r is used, 75 of the aurocs is 40.936 and the lowest auroc is 0.504. when contactlib-9l is used, 75 of the aurocs are40.823 and 3 of the aurocs are50.5. however, when fragbag is used, 75 of the aurocs are 40.657 and 10 of the aurocs are 50.5. therefore, the worst-case auroc is significantly improved by using contactlib, and contactlib-3r is even able to guarantee an auroc higher than a random method, which has an auroc equals to 0.5. we also demonstrated that incorporating remote contact information is critical to consistently retrieve accurate neighbor protein structures for all-query protein structures, which is more challenging than that for all-query protein structures, in section 3.2. moreover, we demonstrated that if two contact groups have similar structures with low root mean square deviation (rmsd) values, they tend to have similar distance vectors, which are used to index contact groups, in section 3.3. finally, we discussed several future extensions and applications of contactlib in section 4.in conclusion, we have shown that contactlib is an effective and efficient neighbor protein structure retrieval method. most importantly, contactlib was able to maintain a consistent level of accuracy in our tests. the key to consistently retrieve accurate neighbor protein structures for all-query protein structures is incorporating remote contact information in contactlib. this is(b). correlation analysis among rmsd, dm and dv of local contact groups, where rmsd is 52.0 a , d is the euclidean distance function, m is the distance matrix used by dali and v is our distance vector: (a) the correlation coefficient is 0.98 between dv and dm; (b) the correlation coefficient is 0.92 between dv and rmsd. roc curve analysis of all-and all-query protein structures: the aurocs of all-query protein structures tend to be higher than those of all-query protein structures; the impact on the type of query protein structures is significantly smaller when contactlib-3r is used than when contactlib-9l is used unmatched by existing neighbor protein structure retrieval method, fragbag . however, our method can be improved in several ways. one possibility is to discover and study new types of contact groups. we will look for new definitions of distance vectors representing remote contact groups based on free energies . another promising extension of contactlib would be to use contact groups to improve pairwise protein structure alignment tools, such as tmalign . one such case is provided in, which shows two alignments between scop proteins d2cufa1 and d3k2aa_, drawn by the pymol molecular graphics system (schrodingerschrodinger, 2010). the alignment shown inwas found by tmalign, and the alignment shown inwas found by our neighbor protein structure retrieval method with two extra steps. first, we clustered the rotation and transition matrices that yield the rmsd of similar contact groups between scop proteins d2cufa1 and d3k2aa_, found by our neighbor protein structure retrieval method. second, we used the representative rotation and transition matrix of the largest cluster to generate the alignment. we will also look for new applications for contactlib. one promising application for contactlib is the structural blast approach of preppi , whose performance depends mainly on the accuracy and on the speed of its neighbor protein structure retrieval. moreover, contactlib is also capable of finding neighbor protein structures if the query protein structure is only partially known in the process of protein structure prediction or determination . then, contactlib may use the incomplete c c pairwise distance matrix to find template candidates to enable it to predict or to determine the query protein structure. funding: grf/ecs grant no. 9041805of hong kong (7002731), an nserc grant (ogp0046506), the canada research chair program, an nserc collaborative grant, ocrit, the premiers discovery award, the killam prize and sharcnet. conflict of interest: none declared.. pairwise protein structure alignment between scop proteins d2cufa1 (red) and d3k2aa_ (blue): (a) our alignment with a tm score of 0.81797, an rmsd of 1.03 and an alignment length of 50; (b) tmalign alignment with a tm score of 0.52190, an rmsd of 2.49 and an alignment length of 49  
