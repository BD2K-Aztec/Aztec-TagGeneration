gene expression switchbox: an r package for kâ€“top scoring pairs classifier development ktop scoring pairs (ktsp) is a classification method for prediction from high-throughput data based on a set of the paired measurements. each of the two possible orderings of a pair of measurements (e.g. a reversal in the expression of two genes) is associated with one of two classes. the ktsp prediction rule is the aggregation of voting among such individual two-feature decision rules based on order switching. ktsp, like its predecessor, top scoring pair (tsp), is a parameter-free classifier relying only on ranking of a small subset of features, rendering it robust to noise and potentially easy to interpret in biological terms. in contrast to tsp, ktsp has comparable accuracy to standard genomics classification techniques, including support vector machines and prediction analysis for microarrays. here, we describe switchbox, an r package for ktsp-based prediction. availability: the switchbox package is freely available from bioconductor: http://www.bioconductor.org.finding omics-based biomarkers for clinical use has been extensively studied in numerous diseases. however, mature clinical applications of these biomarkers are scarce due to technological, mathematical and translational barriers . basing the prediction solely on the ordering of a small number of features (e.g. gene expression ranks within profiles) may overcome such barriers to clinical translation . rank-based classifiers are robust to data normalization and yield transparent decision rules . the first and simplest of these rank-based methods, the top scoring pair (tsp) classifier, in which the decision rule is entirely determined by the ordering of two features (i.e. the relative expression of two genes), was introduced in. multiple extensions to tsp were proposed [e.g.;and some have been successfully applied to human cancer such as simplifying clinical biomarkers . a theoretical analysis, r implementation and description of the tsp algorithm can be found inhttp://hal.archives-ouvertes.fr/docs/00/78/48/69/pdf/article.pdf), leek (2009) and leek (2014), respectively. one powerful successor of tsp is ktop scoring pairs (ktsp;), which applies majority voting among multiple pairs of features. ktsp has outperformed support vector machines in an open challenge for cancer classification and yielded comparable accuracy to the mammaprint breast cancer assay . here, we introduce an r package, switchbox, for ktsp. this package selects the gene pairs for the ktsp decision rule. the package also implements a new approach to choose the number of pairs, k, based on the analysis of variance introduced in, which is less computationally intensive and less prone to overfitting than the original method introduced inand implemented in the r ktspair package . in addition, switchbox provides more flexibility in the selection of candidate ranges of k, as well as alternative strategies for pair votes aggregation compared with the previous r implementation . finally, switchbox has a method for calculating sample-specific scores based on the pairs (see methods), which can be extended beyond classification to class discovery problems.where i is the logical indicator function. the ktsp classification decision is based on thresholding , i.e. y=if4g provided the labels y 2 f0; 1g. the standard threshold is = k 2 , equivalent to majority voting. the only parameters required for calculating are the number and choice of feature pairs. in the introductory paper to tsp , the authors proposed a score for each pair of features, which measures the discriminative power of a two-feature comparison. the score assigned to genes i and j was defined as s ij =jp x i 5x j jy=1 p x i 5x j jy=0j:we introduced switchbox, an r package for ktsp classifier with a robust procedure for pair selection as previously described in, the procedure requires less computation and is less prone to overfitting than the one described inand implemented in ktspair package . moreover, we provide functions for calculating auxiliary statistics as well as any user-defined combination of the comparisons.. the comparisons votes (y-axis) versus samples (x-axis). the samples are labeled either good prognosis or bad prognosis for breast cancer. truth and falsehood of the comparisons are indicated by blue (lighter shade) and red (darker shade), respectively. the combination of the votes can be used to classify, illustrated by requiring at least three votes for declaring bad prognosis. more explanation and code for this figure can be found in the supplementary document  
