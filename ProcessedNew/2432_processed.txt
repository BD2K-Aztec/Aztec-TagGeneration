inference of historical migration rates via haplotype sharing pairs of individuals from a study cohort will often share long-range haplotypes identical-by-descent. such haplotypes are transmitted from common ancestors that lived tens to hundreds of generations in the past, and they can now be efficiently detected in high-resolution genomic datasets, providing a novel source of information in several domains of genetic analysis. recently, haplotype sharing distributions were studied in the context of demographic inference , and they were used to reconstruct recent demographic events in several populations. we here extend the framework to handle demographic models that contain multiple demes interacting through migration. we extensively test our formulation in several demographic scenarios, compare our approach with methods based on ancestry deconvolution and use this method to analyze masai samples from the hapmap 3 dataset. availability: doris, a java implementation of the proposed method, and its source code are freely available atrecent advances in high-throughput genomic technologies enable population-wide surveys of genetic variation. although exacerbating challenges associated with data handling, this increase in volume and resolution had the effect of exposing new genomic features, creating the need for new models and computational tools. among these new genomic features, identical-bydescent (ibd) haplotypes have recently emerged as a new source of information in several genetic applications, ranging from genotypephenotype association studies to the reconstruction of recent familial relationships , the inference of recent demographic events or the study of natural selection . ibd segments are co-inherited from recent common ancestors by pairs of individuals and are delimited by historical recombination events. such recombination events can now be detected in cohorts that have been densely genotyped (although not requiring the availability of full sequences), and several methods have now been developed for efficient ibd detection in large datasets . although shared haplotypes are found to be common even across populations that diverged hundreds of generations ago , the average detectable ibd segment is transmitted from shared ancestors that lived tens to a few hundreds of generations before present. haplotype sharing analysis is, therefore, suitable to reveal the signature of the relatively recent demographic events that followed the agricultural revolution, where most classical methods provide limited insight. leveraging this property of ibd, several recent surveys relied on shared haplotypes to analyze population demographics . in a recent work , we studied several theoretical quantities of ibd haplotypes, as a function of the demographic history of a population. we used the derived framework to infer the demographic history of two populations with different characteristics: (i) a population that underwent substantial recent isolation (ashkenazi jews) and (ii) a cohort that deviates from a single population model, with migration across small demes likely playing an important role in shaping recent genomic diversity (kenian masai). the analytical models we previously described are limited by the assumption that all the analyzed samples belong to a single population. although such models can be used to provide insights in cases of extreme historical isolation, fine-scale interactions across populations were frequent in recent history, and the reconstruction of these events is of great interest for genetic-driven investigation of historical events and genetic analysis at large. in this article, we propose an extension of the analytical framework described in, allowing to explicitly model the presence of multiple populations that interact through migration rates. we test our approach on several synthetic populations with known population size changes and migration rates, finding that our model accurately matches the empirical distributions and provides a novel tool for the inference of recent demographic events that involve multiple interacting demes. we compare our method with existing approaches based on the distribution of migrant tracts obtained through ancestry deconvolution, and we revisit the analysis of the masai population using the presented formulation.in this article, we have extended our previous work on the relationship between long-range haplotypes that are shared ibd across individuals from a study cohort and the demographic history of the individuals populations of origin. specifically, the described framework removes the limiting requirement that all sampled individuals belong to a single population and allows for explicitly modeling and inferring demographic interactions across multiple demes. the evaluation we performed on $ 700 synthetic populations confirms the accuracy of the derived ibd model and suggests that haplotype sharing can be used to gain insight into fine-scale demographic dynamics for the past tens to few hundreds of generations, provided enough samples are collected. our analysis of the hapmap 3 masai samples, as well as our previously reported analysis of an askenazi cohort, suggests that this method can be applied to currently available datasets, provided that the quality of haplotype phasing and ibd detection is carefully considered. among available methods for demographic inference, another approach that explicitly models the effects of recombination (the pairwise sequentially markovian coalescent model, psmc) was recently proposed in li and durbin (2011). this model relies on a markovian approximation of the coalescent with recombination and is able to simultaneously consider the effects of mutation and recombination. the psmc, however, differs from the proposed ibd-based model for its applicability, as it requires full sequence information and is currently focused on the analysis of remote demographic events using single individuals, or pairs of phased chromosomes. because of the scarcity of coalescent events in the recent history, the simultaneous analysis of multiple samples is needed to infer recent demographics. an extension of the psmc to handle the analysis of multiple samples, however, is computationally challenging, and efficient approximations are being developed . in addition to these whole-sequencebased methods, independent current work infers historical demographic changes from length distributions of ibd segments, taking a complementary, less parametric approach, thereby allowing increased flexibility during inference of plausible coalescent time distributions, but without providing explicit modeling of migration and population size changes. among other methods aimed at inferring migration, our approach is conceptually related to those that rely on the frequency and length of migrant tracts. these methods, however, do not model population size fluctuations and are dependent on the possibility of reliably performing ancestry deconvolution to assign chromosomal tracts to a set of reference populations. these populations may not be available and, more importantly, need to be substantially divergent to attain high-quality deconvolution, as shown in our analysis. although whole-sequence datasets and methodological developments may improve the performance of deconvolution methods, this limitation may prevent methods based on migrant tracts from being effectively used in the reconstruction of fine-scale migration patterns of the recent millennia. methods based on ancestry deconvolution, however, may in some scenarios be used in concert with methods based on ibd sharing. knowing whether an ibd tract was co-inherited from a specific population, in fact, may provide information on the directionality of migration, and also offer further insight into deeper time scales, as shown in. this direction may be further explored in light of the recently developed analytical model for migrant tracts and the presented model for ibd.the proposed ibd framework will further be enhanced by accurate whole-genome sequence information, as the presence of mutations on ibd segments will improve the timing of common ancestors and ibd detection of shorter segments. finally, our model still relies on the assumption of selective neutrality. natural selection has been shown to have an impact on long-range haplotype sharing . although selective forces are mostly visible at local scales, demography affects the entire genome. this framework could, therefore, be used to test local deviations from neutrality, and the presented extension, which handles the case of multiple population models, may further assist the analysis of cross-population ibd sharing in this context.  
