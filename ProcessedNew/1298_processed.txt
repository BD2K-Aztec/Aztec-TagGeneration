sequence analysis deepblockalign: a tool for aligning rna-seq profiles of read block patterns motivation: high-throughput sequencing methods allow whole transcriptomes to be sequenced fast and cost-effectively. short rna sequencing provides not only quantitative expression data but also an opportunity to identify novel coding and non-coding rnas. many long transcripts undergo post-transcriptional processing that generates short rna sequence fragments. mapped back to a reference genome, they form distinctive patterns that convey information on both the structure of the parent transcript and the modalities of its processing. the mir-mir pattern from microrna precursors is the best-known, but by no means singular, example. results: deepblockalign introduces a two-step approach to align rna-seq read patterns with the aim of quickly identifying rnas that share similar processing footprints. overlapping mapped reads are first merged to blocks and then closely spaced blocks are combined to block groups, each representing a locus of expression. in order to compare block groups, the constituent blocks are first compared using a modified sequence alignment algorithm to determine similarity scores for pairs of blocks. in the second stage, block patterns are compared by means of a modified sankoff algorithm that takes both block similarities and similarities of pattern of distances within the block groups into account. hierarchical clustering of block groups clearly separates most mirna and trna, and also identifies about a dozen trnas clustering together with mirna. most of these putative dicer-processed trnas, including eight cases reported to generate products with mirna-like features in literature, exhibit read blocks distinguished by precise start position of reads. availability: the program deepblockalign is available as source code from http://rth.dk/resources/dba/.recent development in high-throughput sequencing (hts) technologies have made the demand for efficient algorithms for data processing more urgent than ever. ironically, while the sequencing costs decrease, the analysis costs increase and consume the bigger part of sequencing projects. contributing to the demand is the novel possibilities which emerge with these data. questions that need to be addressed range from expression analysis to the reconstruction of transcript structures and the recognition of particular classes of coding and non-coding transcripts. in most settings, a reference genome is available and analysis protocols start with mapping the sequencing reads to that template genome . here, we focus in particular on the type of rna sequencing data that is commonly produced in studies focusing on micrornas. a series of publications reported that microrna-sized small rnas are commonly produced not only from microrna precursors, but also from most other classes of structured rnas . these small rnas are often, but not always, produced by dicer . several alternative, dicer-independent pathways that lead to similar small rnas with microrna-like functions have been characterized, seefor a recent review. the apparent diversity of processing pathways bears the question to what extent the read patterns in rna-seq datasets contain information on the processing of particular rnas. well-understood examples include the characteristic mutual positioning with a 3-overhang of mir and mir products that is characteristicpage: 18 1724we presented an approach, deepblockalign, and showed that it can be used for a meaningful clustering of ncrnas based solely on read processing patterns. in particular, we find that the mapping profiles are well conserved between human and macaque. most micrornas as well as the majority of the trnas fall into well-separated clusters . within the microrna cluster, a subcluster contains the majority of microrna-offset rnas, indicating that deepblockalign is able to precisely distinguish between block groups that share a common core pattern. consistent with observation that some snornas are processed by dicer, we find the examples clustered together with micrornas. several previously unannotated clusters were identified as potential antisense micrornas and as trna-derived pseudogenes, respectively, showing that deepblockalign can be used for annotating unknown read mapping patterns through unsupervised clustering. the application of deepblockalign for annotation of unknown processing patterns on a routine basis, however, will require the development of appropriate measures of statistical significance, such as p-or e-values. this will require further research as it remains unclear at this point how appropriate background distributions could be constructed. future updates of the algorithm also includes a more detailed tuning with respect to match versus mismatch scores. we found that this approach is fairly robust against parameter variation. for instance, we tested the robustness of the deepblockalign algorithm by analyzing the benchmark dataset using various values of the distance weight parameter dist observing consistent results (supplementary). the clustering approach can in principle be used for constructing multiple alignments. this could in turn be useful in identifying subtle differences in processing patterns and assist the investigation of evolution of processing patterns. qualitatively, the read-based clusters closely resemble the results of clustering known and predicted ncrnas based on their secondary structure . we suspect that this is not a coincidence, since small rnas are preferentially produced from base paired regions . this suggests that read mapping patterns are likely to be influenced, or even determined, by the secondary structure of the parental rna. this signal appears to be stronger than variations depending on sequencing protocol and gc-content that have previously been reported e.g. by. in the case of trnas, chemical modifications are the second major contribution shaping the read mapping patterns . interestingly, there is a single cluster comprising trnas with several different anticodons and isoacceptors that share an almost perfect read processing pattern. this observation requires deeper analysis for further explanation. the read processing patterns of loci with low expression levels may be biased by random fluctuations, thus we have only included patterns with a minimum expression of 50 reads. rna-seq data with deeper coverage will thus not only improve the clustering results but also increase the number of block groups and thereby facilitate the detection of novel ncrnas.  
