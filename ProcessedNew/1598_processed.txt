epigpu: exhaustive pairwise epistasis scans parallelized on consumer level graphics cards motivation: hundreds of genome-wide association studies have been performed over the last decade, but as single nucleotide polymorphism (snp) chip density has increased so has the computational burden to search for epistasis [for n snps the computational time resource is o(n(n-1)/2)]. while the theoretical contribution of epistasis toward phenotypes of medical and economic importance is widely discussed, empirical evidence is conspicuously absent because its analysis is often computationally prohibitive. to facilitate resolution in this field, tools must be made available that can render the search for epistasis universally viable in terms of hardware availability, cost and computational time. results: by partitioning the 2d search grid across the multicore architecture of a modern consumer graphics processing unit (gpu), we report a 92 increase in the speed of an exhaustive pairwise epistasis scan for a quantitative phenotype, and we expect the speed to increase as graphics cards continue to improve. to achieve a comparable computational improvement without a graphics card would require a large compute-cluster, an option that is often financially non-viable. the implementation presented uses openclan open-source library designed to run on any commercially available gpu and on any operating system. availability: the software is free, open-source, platform-independent and gpu-vendor independent. it can be downloaded from http://sourceforge.net/projects/epigpu/.the importance of epistasis (genegene interactions) in complex trait analysis is largely unknown, and computational difficulties have rendered this topic difficult to explore. yet, efforts to identify the genetic factors that underlie traits of economic or medical importance have accelerated over the last decade. indeed, in the first half of 2010 alone genome-wide association studies (gwass) for 165 traits were published (http://www.genome.gov/gwastudies/, last accessed date october 12, 2010). despite the scale of these studies, the proportion of genetic variance explained has been disappointing, and so has emerged the enigma of the missing heritability . but even with the availability of these data, the search to whom correspondence should be addressed.for epistasis has been largely neglected . phenotypic variance can be partitioned into several components:however, in the context of linkage mapping or gwas, heritability estimates are generally limited to the narrow-sense, thus reducing the search to only independent additive genetic effects . in human and animal genetics in particular, estimation of genetic variance beyond the scope of purely additive effects (i.e. broad-sense heritability) is intractable in most cases, and so the overall contribution of epistasis remains unknown. there has been a lively debate for several years concerning the importance of the broad-sense heritability in complex traits, and in particular the contribution of epistasis , but there is still an absence of empirical results. epistasis is a recurring candidate for explaining the missing heritability, but in fact most epistatic patterns are unlikely to be detectable through marginal effects alone . on the contrary, if epistasis was found to be prevalent in complex traits the major implication would be that significant genetic control exists beyond the extant estimates of narrow-sense heritability. should it be the case that the phenotypic effect of one locus depends on the genotype at another locus, the impact upon such endeavours as personalized medicine, disease risk prediction, animal breeding and evolutionary genetics could be significant. several obstacles exist that make epistatic searches difficult. when searching for independent additive effects, each snp is tested for association with the phenotype; but in order to most powerfully identify epistatic effects, the search must be increased to two dimensions , testing each snp against all other snps. for example, a 300k snp chip would require 300 000299 999/2 4.510 10 independent tests, which is a massive computational undertaking. currently, the cheapest way to run this type of analysis, using a desktop computer, could take weeks. however, the parallel decomposition of this problem is relatively straightforward, and the mainstream availability of multicore gpus has paved the way for an efficient and inexpensive alternative. we provide software that dramatically reduces the computational time of an exhaustive search for two-locus epistasis on large-scale snp data for continuous traits. we evaluate the performance of the software running on several types of gpus against optimized software that runs serially on desktop computers, and against parallelized versions for multicore cpus and large compute clusters.we produced software that geometrically parallelizes exhaustive searches for pairwise epistatic associations with quantitative traits. we performed large-scale analyses, typical of those that would be expected based on gwass already published, on several different software and hardware systems. our tests show that against the baseline system (serial code running on a modern cpu) graphics cards can perform the same analysis almost two orders of magnitude faster and at minimal expense , such that an analysis that would take over 4 days could be performed in just over an hour by using software utilizing a graphics card. it is demonstrable that to achieve comparable speeds using cpu cores would require a large compute cluster, for which the cost to acquire and administer could be prohibitively expensive.the use of graphics cards as a tool for scientific research is a rapidly emerging industry that has manifested staggering improvements in performance over the last few years. however it is still in its infancy, and as reflected in, the level of manual optimization required by developers to harness this power is considerable. furthermore, while a very heterogeneous array of devices can be used for opencl applications, differences in their architectures inevitably results in different responses to optimization strategies.shows that without careful optimization, even the most recent gpus will appear to offer little to no advantage over cpu implementations.quantitative genetics has long been occupied with the theoretical contribution of genetic variants to complex traits. the last decade has seen a global effort to start investigating this empirically on a large scale, yet epistasis remains largely unexplored. computing exhaustive pairwise epistatic scans is an important step in making tractable the understanding of non-additive genetic effects in complex traits. we show that this can be achieved efficiently by using consumer level graphics cards, an established technology that is cheap and widely available. in its current implementation, epigpu is limited to performing linear regression on quantitative traits, but the parallel decomposition framework is sufficiently generic to allow its extension to other pairwise statistical analyses relatively easily, such as chi-square testing for casecontrol data. another central problem with epistasis scans is the heavy multiple testing penalty incurred by stringent significance thresholds. computationally straightforward methods such as the bonferroni correction are likely to penalize for an overestimated number of independent tests, and this is particularly problematic with epistasis where the dimensionality of the search is increased. however, with the growing availability of gpu clusters , it is now becoming feasible to perform 2d genome-wide permutation analyses to generate more accurate estimates of family-wise false discovery rates , a potentially critical step toward understanding the contribution of epistasis toward complex traits.  
