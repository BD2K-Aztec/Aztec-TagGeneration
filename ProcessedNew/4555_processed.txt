systems biology testing multiple biological mediators simultaneously motivation: modern biomedical and epidemiological studies often measure hundreds or thousands of biomarkers, such as gene expression or metabolite levels. although there is an extensive statistical literature on adjusting for multiple comparisons when testing whether these biomarkers are directly associated with a disease, testing whether they are biological mediators between a known risk factor and a disease requires a more complex null hypothesis, thus offering additional methodological challenges. results: we propose a permutation approach that tests multiple putative mediators and controls the family wise error rate. we demonstrate that, unlike when testing direct associations, replacing the bonferroni correction with a permutation approach that focuses on the maximum of the test statistics can significantly improve the power to detect mediators even when all biomarkers are independent. through simulations, we show the power of our method is 25 larger than the power achieved by bonferroni correction. finally, we apply our permutation test to a case-control study of dietary risk factors and colorectal adenoma to show that, of 149 test metabolites, docosahex-aenoate is a possible mediator between fish consumption and decreased colorectal adenoma risk. availability and implementation: r-package included in online supplementary material.mediation analysis or causal inference offers numerous methods for testing if a single variable mediates the relationship between a known exposure and an outcome . these methods assume that a known exposure, e, affects an outcome, y, and aim to test whether this effect is at least partially transmitted through a mediator, m. for example, in biology, these methods have suggested that the negative impact of lead exposure on cognition is mediated by a decrease in the volumes of specific brain regions , and that the association between certain variants in the fto gene and increased body weight is mediated by a lowered response to satiety cues . with new technologies, such as microarrays , next-generation sequencing and highthroughput metabolomics , it is possible to simultaneously test whether 100 or 1000s of biomarkers mediate a known relationship. in our motivating study, investigators aim to identify metabolites that mediate the association between increased fish consumption and a reduced risk of colorectal adenoma . our current objective is to define a testing procedure that accounts for multiple comparisons and maintains a desired family wise error rate (fwer). guided by the methods developed for testing direct associations, we develop a permutation approach for testing multiple mediators. specifically, we design a permutation method that tests whether any biomarker meets a common definition of a mediator . we say that m is a mediator if it is both associated with the exposure, e, and, conditional on e, associated with the outcome, y. our first step is to define a permutation method for testing a single mediator. our defined method uses the freedman andapproach for testing the conditional association between m and y, in contrast to previous methods that use the manly (1997) approach, and will therefore be more robust to outliers . unfortunately, as has already been noted , there can be no exact permutation method for testing a conditional association. in addition to having its own value, our presentation of the single mediator test aims to illustrate the inherent difficulty in designing a permutation test for a composite null hypothesis. when testing mediation, the null hypothesis allows for either an association between e and m or a conditional association between m and y. approaches designed for testing direct associations, which permute only the exposure or outcome, cannot simulate such a composite null hypothesis. this article is structured so that methods for testing mediators can be described by comparing and contrasting them with methods for testing associations. we begin by describing permutation tests for a single association and the extensions needed for testing multiple associations. then, we introduce permutation methods for testing a single mediator and the extensions for testing multiple mediators. the following simulations demonstrate that the potential increase in power from replacing the bonferroni correction with a joint correction is greater when testing for mediation than when testing for direct association. finally, we apply our method to our motivating example and offer a brief discussion. to whom correspondence should be addressed.we developed permutation methods for testing multiple putative mediators. although such methods can be applied in a variety of settings, we considered the specific application of a modern epidemiological study that measures 100 or 1000s of similar biomarkers (e.g. gene expression, protein or metabolite levels). we show, via simulations, that testing putative mediators by using the joint correction has substantially higher power over bonferroni correction even when all biomarkers are conditionally independent. we apply our approach to the navy colorectal adenoma study and find evidence suggesting that dha may mediate the protective effect of fish consumption on adenoma risk, which would not have been found using bonferroni. we first defined a permutation method for testing a single mediator. this method was used to lay the groundwork for describing our tests of multiple mediators, but is also novel in the single mediator literature. whereas prior permutation methods used the manly (1997) approach for testing the conditional association between m and y, we used theapproach which, in general, appears to be a more robust approach . we then extended this method to testing multiple mediators, using either the bonferroni correction or a joint correction. the key component of our methods, required to handle the composite null hypothesis in both the single and multiple mediator scenarios, is to use two sets of permutations. a simpler, but incorrect, alternative to our approach would be to repeatedly permute y to obtain one null distribution of s joint. then, repeatedly permute e to obtain another null distribution, and let p s be the maximum of the two p-values. however, if atest 2b (limiting case). the solid lines illustrate the power for test 2b (light) and test 2j (dark) as a function of (within block correlation) when there are 100 null mediators and 1 true mediator. mediators in different blocks are uncorrelated. the dashed lines show the limiting power, when the 100 null mediators are replaced with 5 independent null mediators subset of metabolites was associated with the exposure and a different subset was associated with the outcome, then the observed s joint would appear extreme as measured by either simple null distribution. as with any approach for testing mediation, our method presumes that the causal paths considered inare correct. thus, we assumed that the only causal paths that may exist are from the exposure to the biomarkers, from the biomarkers to the outcome and from the exposure directly to the outcome. unmeasured confounders might also lead to incorrect inferences. such a confounder might, for example, induce a relationship between m and y, causing to appear to be non-zero. if this same metabolite were associated with e, the result would be a false positive. despite this limitation, causal analysis still offers one of the best methods for testing putative mediators. given the popularity of high-throughput technologies, investigators will soon require methods for testing multiple putative mediators. this manuscript is one of the first to introduce possible options. funding: support was from the intramural research program of the division of cancer epidemiology and genetics, national cancer institute, national institutes of health (nih). computation was performed using the biowulf linux cluster at the national institutes of health, bethesda, maryland (http://biowulf.nih.gov). conflict of interest: none declared.note: for each dietary intake of interest, we list the most likely mediator, as suggested by tests 2b and 2j. for the top mediator, we report p s for test 2b (i.e. compare with 0.05 divided by 149 tests) and p j for test 2j (i.e. compare directly with 0.05). 1-sgpa (1-stearoylyglycerophosphoethanolamine) and dha (docosahexaenoate).  
