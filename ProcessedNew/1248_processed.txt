sequence analysis dafs: simultaneous aligning and folding of rna sequences via dual decomposition motivation: it is well known that the accuracy of rna secondary structure prediction from a single sequence is limited, and thus a comparative approach that predicts a common secondary structure from aligned sequences is a better choice if homologous sequences with reliable alignments are available. however, correct secondary structure information is needed to produce reliable alignments of rna sequences. to tackle this dilemma, we require a fast and accurate aligner that takes structural information into consideration to yield reliable structural alignments, which are suitable for common secondary structure prediction. results: we develop dafs, a novel algorithm that simultaneously aligns and folds rna sequences based on maximizing expected accuracy of a predicted common secondary structure and its alignment. dafs decomposes the pairwise structural alignment problem into two independent secondary structure prediction problems and one pairwise (non-structural) alignment problem by the dual decomposition technique, and maintains the consistency of a pairwise structural alignment by imposing penalties on inconsistent base pairs and alignment columns that are iteratively updated. furthermore, we extend dafs to consider pseudoknots in rna structural alignments by integrating ipknot for predicting a pseudoknotted structure. the experiments on publicly available datasets showed that dafs can produce reliable structural alignments from unaligned sequences in terms of accuracy of common secondary structure prediction. availability: the program of dafs and the datasets are available atmany functional rnas form secondary structures that are related to their functions such as gene regulation and maturation of mrnas, rrnas and trnas. therefore, analysis of rna secondary structures can lead to unraveling their potential functions. since experimental determination of rna secondary structures is expensive and time consuming, computational prediction of rna secondary structures has been frequently used. the most successful methods for predicting rna secondary structures from a single sequence are based on minimizing free energy, such as mfold and rnafold . alternative methods are based on probabilistic frameworks including stochastic context-free grammars that can model rna secondary structures without pseudoknots (crossing base pairs on primary sequences). several computational methods based on stochastic context-free grammars have been developed for modeling and analyzing non-coding rnas . nonetheless, the accuracy of rna secondary structure prediction from a single sequence is known to be limited, and thus, a comparative approach that predicts a common secondary structure from aligned sequences is a better choice if homologous sequences with reliable alignments are available. comparative methods based on alignment folding include rnaalifold , pfold , petfold and centroidalifold . however, we require correct secondary structure information to produce reliable alignments of rna sequences in turn, which is a chicken-and-egg problem. to tackle this dilemma, sankoff (1985) has proposed a dynamic programing (dp) algorithm for simultaneously aligning and folding rna sequences whose computational complexity is ol 3n time and ol 2n space for n sequences of length l. since a navenave implementation of the sankoff algorithm is impractical because of unrealistic computational complexity, various algorithms have been developed to reduce the computational complexity of the sankoff algorithm. several pioneering studies including the first versions of foldalign and dynalign have implemented restricted sankoff algorithms; foldalign disallows bifurcated structures, and dynalign assumes the maximum distance of aligned nucleotides (note that later versions of both methods do not have such restrictions). several succeeding methods have reduced the search space of the sankoff algorithm by to whom correspondence should be addressed. using precomputed posterior probabilities of base pairs and/or aligned columns . sampling-based approaches, instead of reducing the search space, have also been developed . zivhave proposed a sparsification technique for the sankoff algorithm that speeds up computation by a linear factor. although various techniques for reducing the computation time have been developed, the sankoff-style algorithms are still computationally expensive. alternatively, several heuristic-based algorithms that do not strictly perform simultaneous aligning and folding of rna sequences have been proposed such as sequence alignment with a structural scoring function and stem-based alignment . lara proposed byformulates the problem of rna structural alignment as a graph theoretical model for sequence alignment with additional simple structure information. lagrangian relaxation is applied to relax the constraints for the structure information, then the problem is solved as sequence alignment with iterative updates of penalty scores. note that lara was not designed to predict common secondary structures since no folding model is explicitly considered. in this article, we present a novel algorithm dafs that performs dual decomposition for aligning and folding rna sequences simultaneously. first, on the basis of the maximizing expected accuracy (mea) principle, we design an objective function for a pairwise structural alignment as the expectation of the sum of the numbers of correctly predicted base pairs in a common secondary structure and those of correctly aligned columns in its pairwise alignment. then, to maximize the objective function under several constraints for consistent pairwise structural alignment, we use the dual decomposition technique, which decomposes the pairwise structural alignment problem into two independent secondary structure prediction problems and one pairwise (non-structural) alignment problem. the algorithm maintains the consistency of a pairwise structural alignment by imposing penalties on inconsistent base pairs and alignment columns, and updates them iteratively by performing the nussinov-style secondary structure prediction and the needlemanwunsch-style pairwise alignment with the penalized scoring function. we easily extend the algorithm to perform multiple alignment by applying a standard progressive alignment technique. furthermore, we integrate the ipknot model instead of the nussinov model so that dafs can simultaneously align and fold rna sequences with pseudoknots. major advantages of dafs are summarized as follows: (i) dafs is a fast and accurate implementation that simultaneously aligns and folds rna sequences. compared with the other sankoff-style algorithms, dafs achieves comparable accuracy, and even more importantly, runs much faster. compared with the heuristic-based approaches such as sequence alignment with structural scores, dafs is more accurate, especially in terms of common secondary structure prediction; (ii) dafs is flexible and extensible because of the dual decomposition, which enables us to integrate state-of-the-art folding models such as the ipknot model for pseudoknotted secondary structures.we developed a fast and accurate rna structural aligner called dafs that simultaneously aligns and folds rna sequences by dual decomposition. specifically, our method decomposes the rna structural alignment problem into three subproblems, then respective problems are solved by simple and efficient algorithms such as the nussinov-style dp and the needleman wunsch-style dp. this means that dafs can explicitly take the folding model into account, whereas lara that has also used lagrangian relaxation cannot. in fact, we showed that the dual decomposition technique enables us to integrate state-of-the-art folding models such as the ipknot model for pseudoknotted structures. this flexibility to adapt the folding models to our algorithm would lead us to further improvement by using an extended secondary structure model such as rnawolf (zu), where base-pairing probabilities for extended secondary structures are used. one of the other differences between dafs and lara is the scoring system in the objective function. the scoring system of dafs is based on the mea principle, which has been successfully applied to various problems in bioinformatics (,time means the total computation time in seconds measured on a linux workstation with intel xeon e5450 (3.0 ghz). the bold values indicate the best score in each evaluation measure. for all the methods except dafs, sen, ppv and mcc, are calculated using common secondary structures predicted by centroidalifold with default parameters from produced alignments. see section s4 in supplementary material for the results using rnaalifold and intrinsic predictions.). the mea-based scoring function not only improves accuracy in prediction but also makes dafs run fast by the threshold cut technique, which is derived from the ip formulation based on the mea-based scoring function described in section 2.3. the threshold cut technique has also been applied to ractip and ipknot , and has contributed to their accuracy and efficiency. prediction accuracy of dafs depends mainly on its scoring functions even though the method uses the approximate probability distribution for rna structural alignments that assumes independence of alignment and structure. in fact, experimental results shown in section s5 in supplementary material revealed that when we adopted the exact posterior probabilities for rna structural alignments, a significant improvement was confirmed, though much computation time was spent on the predictions. considering these results, there is room for further investigation into refinement of the scoring functions that make prediction accuracy compatible with practical running time.  
