genome analysis probabilistic alignments with quality scores: an application to short-read mapping toward accurate snp/indel detection motivation: recent studies have revealed the importance of considering quality scores of reads generated by next-generation sequence (ngs) platforms in various downstream analyses. it is also known that probabilistic alignments based on marginal probabilities (e.g. aligned-column and/or gap probabilities) provide more accurate alignment than conventional maximum score-based alignment. there exists, however, no study about probabilistic alignment that considers quality scores explicitly, although the method is expected to be useful in snp/indel callers and bisulfite mapping, because accurate estimation of aligned columns or gaps is important in those analyses. results: in this study, we propose methods of probabilistic alignment that consider quality scores of (one of) the sequences as well as a usual score matrix. the method is based on posterior decoding techniques in which various marginal probabilities are computed from a probabilistic model of alignments with quality scores, and can arbitrarily trade-off sensitivity and positive predictive value (ppv) of prediction (aligned columns and gaps). the method is directly applicable to read mapping (alignment) toward accurate detection of snps and indels. several computational experiments indicated that probabilistic alignments can estimate aligned columns and gaps accurately, compared with other mapping algorithms e.g. shrimp2, stampy, bwa and novoalign. the study also suggested that our approach yields favorable precision for snp/indel calling.a number of recent studies have revealed the importance of considering quality scores of (short) reads [produced by nextgeneration sequencing (ngs) platforms e.g. illumina ga, roche 454 flx and abiin various fundamental analyses on ngs data: mapping (alignment) of reads to reference genomes (; lunter and goodson, to whom correspondence should be addressed. 2011;), error correction of reads , insertion and deletion (indel) detection from mapped reads and gene prediction from reads derived from metagenomic data . this is because error rates of current ngs platforms are relatively high and the errors cannot be ignored in those analyses. several recent studies also suggest that probabilistic alignment techniques estimate more accurate alignment in terms of aligned columns or gaps than conventional maximum score-based alignments. for example, -centroid alignment is theoretically suitable for accuracy measures such as the sensitivity and positive predictive value (ppv) with respect to aligned bases (we call it aligned column accuracy, formally defined later). in -centroid alignment, the marginal probability of aligned bases is employed. on the other hand,proposed probabilistic alignments, which use the marginal probabilities of gaps as well as the marginal probabilities of aligned columns. those probabilistic alignments are, therefore, appropriate for accuracy measures in terms of prediction of gaps (we call it gap accuracy). when quality scores are given to both (or one of) the sequences to be aligned, probabilistic alignments that consider the quality scores are useful for estimating accurate alignments. there do not exist, however, any studies about this.utilized (conventional) maximum score-based alignment, not probabilistic alignments, while considering quality scores; employed a probabilistic (-centroid) alignment without considering quality scores.in this article, we therefore propose two probabilistic alignment methods that consider quality scores explicitly. the methods are based on posterior decoding techniques, which use marginal probabilities that incorporate all the possible alignments, with quality scores. to demonstrate the effectiveness of the proposed methods, we apply them to short read mapping (alignment) to reference genomes. mapping short reads is one of the most fundamental information analyses of ngs data , and a number of mapping algorithms have been proposed including bowtie , shrimp2 , bwa , stampy , novoalign, maq , perm and others . those mapping tools mainly focus on accurate prediction of the genomic location of mapped reads, and in the evaluation, a mapped read is considered to be correct if it overlapswe proposed two probabilistic alignment methods (-centroid alignment and lama alignment) in which quality scores are naturally considered from a bayesian viewpoint. to the best of our knowledge, this is the first article that combines probabilistic alignments and quality scores. we implemented the methods in last (http://last.cbrc.jp/) and applied them to read mapping and variant calling. compared with the original last, probabilistic alignment slightly improves both aligned-column accuracy and gap accuracy in read alignment. (the probabilistic alignment also outperformed existing algorithms.) moreover, by utilizing a parameter , probabilistic alignments can trade-off sensitivity and ppv with respect to aligned columns and/or gaps. this property is useful for various downstream analysis (e.g. variant calling or detection of (un)methylated nucleotides) after read mapping.  
