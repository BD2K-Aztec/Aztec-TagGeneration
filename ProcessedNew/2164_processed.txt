haplotype assembly in polyploid genomes and identical by descent shared tracts motivation: genome-wide haplotype reconstruction from sequence data, or haplotype assembly, is at the center of major challenges in molecular biology and life sciences. for complex eukaryotic organisms like humans, the genome is vast and the population samples are growing so rapidly that algorithms processing high-throughput sequencing data must scale favorably in terms of both accuracy and computational efficiency. furthermore, current models and methodol-ogies for haplotype assembly (i) do not consider individuals sharing haplotypes jointly, which reduces the size and accuracy of assembled haplotypes, and (ii) are unable to model genomes having more than two sets of homologous chromosomes (polyploidy). polyploid organisms are increasingly becoming the target of many research groups interested in the genomics of disease, phylogenetics, botany and evolution but there is an absence of theory and methods for polyploid haplotype reconstruction. results: in this work, we present a number of results, extensions and generalizations of compass graphs and our hapcompass framework. we prove the theoretical complexity of two haplotype assembly optimizations , thereby motivating the use of heuristics. furthermore, we present graph theorybased algorithms for the problem of haplotype assembly using our previously developed hapcompass framework for (i) novel implementations of haplotype assembly optimizations (min-imum error correction), (ii) assembly of a pair of individuals sharing a haplotype tract identical by descent and (iii) assembly of polyploid genomes. we evaluate our methods on 1000 genomes project, pacific biosciences and simulated sequence data.the genome sequence of a human individual can be modeled as 23 pairs of sequences of four nucleotide bases, a, c, g and t, representing the 22 pairs of autosomes and the sex chromosomes. however, $99.5 of any two individuals genome sequences is shared within a population. the $0.5 of the nucleotide bases varying within a population range from single-nucleotide polymorphisms (snps) to more complex structural changes, for example, deletions or insertions of genomic material. a sequence of genomic variants, typically snps, with the non-varying dna removed is referred to as a haplotype.standard genome sequencing workflows produce contiguous dna segments of an unknown chromosomal origin. de novo assemblies for genomes with two sets of chromosomes (diploid) or more (polyploid) produce consensus sequences in which the relative haplotype phase between variants is undetermined. the set of sequencing reads can be mapped to the phase-ambiguous reference genome and the diploid chromosome origin can be determined but, without knowledge of the haplotype sequences, reads cannot be mapped to the particular haploid chromosome sequence. as a result, reference-based genome assembly algorithms also produce unphased assemblies. however, sequence reads are derived from a single haploid fragment and thus provide valuable phase information when they contain two or more variants. the haplotype assembly problem aims to compute the haplotype sequences for each chromosome given a set of aligned sequence reads to the genome and variant information. the haplotype phase of variants is inferred from assembling overlapping sequence reads [; halldorsson. the input to the haplotype assembly problem is a matrix m whose rows correspond to aligned read fragments and columns correspond to snps . the quality of ms construction depends on the parameters of the sequencing workflow and the accuracy of the read alignment algorithms. misaligned read fragments can introduce erroneous base calls or sampling biases so the careful alignment of sequence reads is necessary for highquality haplotype assemblies. without read alignment or sequencing errors, the haplotype assembly problem can be solved in time linear in the size of m by partitioning the fragments in two sets whereby no fragments internal to a set share an snp and differ in the allele called. to address erroneous base calls or misplaced alignments, three primary haplotype assembly optimizations have been developed: minimum error correction (mec), minimum snp removal (msr) and minimum fragment removal (mfr). the goal is to convert m into a state such that the fragments (rows of m) can be distributed into two sets corresponding to the two haplotypes. all fragments in a set must agree on the allele at each snp site and this is accomplished using the minimum number of snp allele flips (0 to 1 or vice versa-mec), snp (columns of m) removals (msr) or fragment (rows of m) removals (mfr).provide a theoretical foundation for the mfr and msr optimizations and describe the fundamental snp and fragment conflict graph structures. the first widely available haplotype assembly software package was presented inin which the authors describe the fast hare algorithm, which optimizes the min element removal problem., which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. for commercial re-use, please contact journals.permissions@oup.com a set of likely haplotypes under the mec optimization. in a follow-up, the authors present a much faster algorithm on a related graph model that relates maximum cuts to snp allele flips (in the mec model) [. still other authors have suggested reductions to the well-known maximum satisfiability problem;the levy et al. (2007) algorithm is a well-known heuristic that was used to haplotype assemble the huref genome; it assigns fragments to haplotypes in a greedy fashion and iteratively refines the solution by comparing the set of fragments to the assembled haplotypes using majority rule phasings. in a recent survey, geraci (2010) describes thealgorithm as, arguably, the best performing algorithm tested. the first extension of the haplotype assembly problem that addressed the simultaneous assembly of multiple diploid chromosomes was presented in; however, the benefits of multi-haplotype assembly are not clear for a set of unrelated individuals.continued development of this theory by describing methods for assembling individuals who share a haplotype identical by descent (ibd) using relationships among the reads. aguiar and istrail (2012) introduced a new graph data structure, algorithmic framework and the minimum weighted edge removal (mwer) optimization, which together have several advantages over existing methods. recall that the rows of m correspond to sequence read fragments with the non-polymorphic bases removed such that only snps remain. the hapcompass model defined inis composed of the compass graph g c core data structure, which summarizes the rows of m using edges weights and the mwer optimization that aims to remove a minimum weighted set of edges from g c such that a unique phasing may be constructed. the algorithm operates on the spanning-tree cycle basis of g c to iteratively remove errors that are manifested through a particular type of simple cycle; mac. in this work, we prove a number of theoretical results for the previously described mwer optimization on compass graphs. the main result proves mwer is np-hard and motivates the use of our heuristic algorithms. further, we demonstrate how extensions to the generalized diploid hapcompass model can enable (i) usage of different optimizations, for example, mec and mwer, to be used in the local optimization step, (ii) simultaneous assembly of two individuals sharing a haplotype tract ibd and (iii) haplotype assembly of a single polyploid organism. finally, we evaluate our methods on 1000 genomes project, pacific biosciences and simulated data.diploid haplotype inference is still a difficult task, in part due to the exponentially many solutions given the input genotype or sequence reads. hapcompass is a proven framework for haplotype assembly but there are a number of extensions that may improve results. for instance, we did not mention the usage of base call or read mapping quality scores in our computations. hapcompass can filter based on user-defined thresholds but a more elegant solution would be to convert the base call quality score for a particular allele call into a probability the base was called correctly. this probability can then define the contribution of weight to the edges of g c rather than the current weight contribution of 1 for each snp allele called. also we demonstrated in the pacific biosciences experiments that the choice of assembly method should be informed by the sequencing technology and desired result. the levy et al. (2007) method mappedmore fragments error free than hapcompass but contained many more single base changes in fragments required to reproduce the inferred haplotypes. considering the pacific biosciences data has high error rates and generating an error-free read is unlikely, a solution with the minimum number of corrected errors is likely preferred over a solution that successfully maps more fragments without errors. the size of the haplotype blocks produced and, ultimately, the quality of the assembled haplotypes is a function of several factors. the primary difficulty for obtaining large haplotype blocks is the small nature and lack of diversity of insert lengths. we demonstrated a novel modeling and computational method that begins to address this difficulty by exploiting shared ibd haplotype structure. in general, assembling the haplotypes of related individuals has considerable benefits, which help overcome undesirable properties of the sequencing data. the first benefit comes from the extra coverage on the shared haplotype, which helps in differentiating actual phasings from sequencing errors. however, the most notable advantage is being able to include more snps into the haplotype assembly, which helps extend the assembly (past regions of low read coverage for example). but, the major advances in block sizes will likely be the result of novel experimental procedures and technologies; for instance, not only do the single molecule sequencers promise larger read lengths, they also enable the inclusion of multiple and large insert lengths. organisms having more than two sets of homologous chromosomes are becoming the target of many research groups interested in studying the genomics of disease, phylogenetics and evolution;. polyploidy occurs in human disease usually due to the duplication of a particular chromosome, for example, in edwards, patau and down syndrome. while far fewer mammalian organisms are polyploid, specific mammalian cells may undergo polyploidization, for example, in human liver hepatocytes. in addition, polyploid organisms are ubiquitous in the plant and fungi clades, present in crops that we ingest, convert into bioenergy and feed to livestock. understanding the genomics of both the desirablee.g. increased crop yieldand undesirablee.g. susceptibility to diseaseproperties of plants may lead to critical advances in many research areas but requires untangling the polyploid genome and its variation. as more polyploid data becomes available, our approach may be used to infer haplotypes and begin to understand what effects haplotype variation may influence.  
