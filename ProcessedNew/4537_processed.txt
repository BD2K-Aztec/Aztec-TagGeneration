taxator-tk: precise taxonomic assignment of metagenomes by fast approximation of evolutionary neighborhoods motivation: metagenomics characterizes microbial communities by random shotgun sequencing of dna isolated directly from an environment of interest. an essential step in computational meta-genome analysis is taxonomic sequence assignment, which allows identifying the sequenced community members and reconstructing taxonomic bins with sequence data for the individual taxa. for the massive datasets generated by next-generation sequencing technologies, this cannot be performed with de-novo phylogenetic inference methods. we describe an algorithm and the accompanying software, taxator-tk, which performs taxonomic sequence assignment by fast approximate determination of evolutionary neighbors from sequence similarities. results: taxator-tk was precise in its taxonomic assignment across all ranks and taxa for a range of evolutionary distances and for short as well as for long sequences. in addition to the taxonomic binning of metagenomes, it is well suited for profiling microbial communities from metagenome samples because it identifies bacterial, archaeal and eukaryotic community members without being affected by varying primer binding strengths, as in marker gene amplification, or copy number variations of marker genes across different taxa. taxator-tk has an efficient, parallelized implementation that allows the assignment of 6 gb of sequence data per day on a standard multi-processor system with 10 cpu cores and microbial refseq as the genomic reference data. availability and implementation: taxator-tk source and binary program files are publicly available atmetagenomics allows us to study microbial communities from natural environments without the need to obtain pure cultures of the individual member species . the shotgun sequencing of microbial community dna with current techniques generates reads that range from less than 100 to several thousand nucleotides (dr ge and). by computational analyses of metagenome sequence samples, we can estimate the abundances of different taxa for the sampled communities, known as taxonomic profiling, characterize their functional and metabolic potential based on the predicted proteins and resolve the contributions of individual taxa to the latter by reconstructing bins of unassembled or assembled sequences that originate from the same taxon.taxator-tk is a taxonomic assignment software package which generates very precise taxonomic assignments with few errors for metagenome shotgun sequences. to provide a fair comparison, we invested extensive effort into ensuring that we evaluated all methods under identical conditions with the same reference sequences, test datasets and background taxonomies, using their recommended settings. we evaluated taxator-tk on 16s gene sequences, on simulated short reads, with simulated assembled contigs and with 2 kb contig fragments from a real cow rumen metagenome. for each simulated sample, we evaluated a wide range of evolutionary distances between the query and reference sequences using leave-one-taxon-out cross-validation. taxator-tk was the most precise of all tested methods with the most realistic number of identified taxa overall. this property was very pronounced for lower taxonomic ranks from species-to-family level. however, taxator-tk assigned fewer data overall than other methods from species to family. for the small assembled simmc dataset, it assigned fewer data, particularly in comparison to the composition-based classifier phylopythias, when 100 kb of data were provided for individual community members to train species-level models. for the real cow rumen dataset, taxator-tk was the most consistent in terms of classifying multiple pieces of one contig. our results consistently indicate that taxator-tks strength is its high precision of assignments, which allows us to confidently assign a core of sample sequences and thereby to infer the taxonomic composition of the community. in comparison to assignments based on marker genes, it has the advantages that it makes assignments across all domains of life and that corresponding abundance estimates from shotgun sequences are less affected by copy number variations of individual genes. such shotgun estimates are also unaffected by pcr primer amplification biases, unlike marker gene sequencing techniques, and do not require high-quality reference gene phylogenies for marker genes. we confirmed this by in depth analysis of six 15 gb shotgun samples from the barley rhizosphere, where we applied taxator-tk to characterize the taxonomic composition of bacteria, archaea and eukaryotes, which correlated with results from 16s rrna profiling and showed the most notable deviations for taxa known to be affected by primer biases or having multiple copies of the 16s rrna gene (bulgarelli et al., unpublished data). to target draft genome reconstructions, the data assigned to individual taxonomic bins by taxator-tk can be used as training data for complementary approaches, such as composition-based methods, or as independent information in combination with recently proposed clustering methods using the abundance of genes or contigs across multiple samples. from a methodological point of view, we have introduced a method for the fast approximation of the evolutionary neighborhood of a query sequence with a run-time that increases linearly with the number of homologs. in de-novo phylogenetic inference methods, the run-time increases at least log-linearly with the number of homologs or they rely on time-consuming optimizations of parameter-rich phylogenetic models, which generates excessive computational requirements for the analysis of gb-sized ngs samples. our software provides an easy to use and scalable alternative to taxonomic classification of marker genes that is applicable to any nucleotide fragment. unlike other similarity-based taxonomic classifiers for shotgun data, our algorithm handles different degrees of sequence conservation without preset or user-specified parameters such as alignment scores (overall or per gene family) and without being restricted to the analysis of a number of high-quality homologs with a minimal length. at the same time, the inferred evolutionary neighborhood is extended by the identification of an outgroup, leading to more precise taxonomic assignments, while regions without detectable taxonomic signal are instantly discarded. we postprocess independent taxonomic assignments of query segments to infer an assignment for the entire query and do this using a majority vote algorithm with a few robust default parameters. this computationally lightweight step can be quickly repeated with other values for the majority and minimum support parameters, if required. in addition to the algorithmic considerations and other run-time optimizations, we implemented query sequence segmentation and program parallelization, which allow large-scale data analysis with a taxator-tkthroughput of several gbs per day on a standard multiprocessor system. the programs scope is also not limited to the taxonomic assignment of metagenomes: it can be applied to any dna or rna sequence. for instance, another successful in-house application is the detection of contaminations in isolate sequencing data. furthermore, the program taxator within taxator-tk provides taxonomic information for individual query segments (supplementary figs s2 and s25), which could be used to identify assembly errors or regions acquired by lateral gene transfer.  
