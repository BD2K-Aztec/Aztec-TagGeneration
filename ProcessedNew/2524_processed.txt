integrative gene set analysis of multi-platform data with sample heterogeneity motivation: gene set analysis is a popular method for large-scale genomic studies. because genes that have common biological features are analyzed jointly, gene set analysis often achieves better power and generates more biologically informative results. with the advancement of technologies, genomic studies with multi-platform data have become increasingly common. several strategies have been proposed that integrate genomic data from multiple platforms to perform gene set analysis. to evaluate the performances of existing integrative gene set methods under various scenarios, we conduct a comparative simulation analysis based on the cancer genome atlas breast cancer dataset. results: we find that existing methods for gene set analysis are less effective when sample heterogeneity exists. to address this issue, we develop three methods for multi-platform genomic data with hetero-geneity: two non-parametric methods, multi-platform mannwhitney statistics and multi-platform outlier robust t-statistics, and a paramet-ric method, multi-platform likelihood ratio statistics. using simulations, we show that the proposed multi-platform mannwhitney statistics method has higher power for heterogeneous samples and comparable performance for homogeneous samples when compared with the existing methods. our real data applications to two datasets of the cancer genome atlas also suggest that the proposed methods are able to identify novel pathways that are missed by other strategies. availability and implementation: http://www4.stat.ncsu.edu/ jytzeng/software/multiplatform_gene_set_analysis/high-throughput genome-wide assays, such as microarray and next-generation sequencing, have become more reliable and affordable. with the ever-increasing throughput and the scale of omics studies, more and more projects choose to measure multiple genomic features (e.g. gene expression, methylation, gene mutation, copy number, promoter binding and protein expression) on the same samples. evaluating multiple genome features can lead to a better examination of functional responses and provide a comprehensive understanding of the underlying biological mechanisms. in recent years, well-known large-scale projects, such as the cancer genome atlas (tcga) (2012), the cancer cell line encyclopedia and the encyclopedia of dna elements, have generated genomic profiles across multiple platforms. in addition, more and more recent projects in the gene expression omnibus contain multi-platform data. with diverse data types from different platforms, it becomes challenging to properly integrate, analyze and interpret the results to obtain biological insights. gene set analysis is a powerful strategy developed to analyze large-scale profiling data. instead of studying one gene at a time, gene set analysis focuses on a set of related genes, such as genes in one kyoto encyclopedia of genes and genomes pathway or those related to the same gene ontology term. joint analysis of genes in a set often improves power, especially when the signals of individual genes are moderate. because the set itself often has biological meanings, gene set analysis also facilitates the interpretation of experiment results and helps to identify important biological findings . many methods have been developed to perform gene set analysis in a single platform, for example, gene set enrichment analysis (gsea) , gsa and globaltest . several review articles have been published that discuss the performances of different gene set methods . gene set analysis on multi-platform genomic data is gaining momentum. approaches can be roughly classified into three different categories, characterized by how the multi-platform information is integrated. the first type performs a gene set analysis on each platform and then combines the single platform information, such as p-values (e.g.). such a strategy is commonly used when the multi-platform data are from similar, but not identical, samples. the second strategy, such as that used in the sumz approach of, first sums the gene-specific association score of each platform to compute a multi-platform score for each gene and then uses the gene scores to perform gene set analysis. the third strategy is similar to the second except that it directly derives the multi-platform gene scores using data from all platforms simultaneously. one representative approach is the integrative (int) approach proposed by, to whom correspondence should be addressed. which uses a logistic regression with all multi-platform values of a gene as predictors and takes the model deviances as the gene scores for downstream gene set analysis . bayesian methods have also been developed to analyze multi-platform genomic data, e.g. ibag and paradigm . compared with traditional gene set methods, bayesian methods often use extensive knowledge of the biological relationships among different data platforms and/or the interactions between studied genes. sample heterogeneity refers to molecular and cellular differences among biological samples. such differences are commonly encountered in complex diseases like cancer, where cases with different genotypes, genomic copy numbers or expression patterns often lead to different disease progressions and treatment strategies . several methods have been developed to address sample heterogeneity, e.g. cancer outlier profile analysis , outlier sum , outlier robust t-statistics (ort) , cancer likelihood ratio statistics (lrs) and non-parametric change-point statistics . although the superiority of these methods over ordinary analysis has been demonstrated with heterogeneous data in a single platform, to the best of our knowledge, there are no corresponding gene set approaches for multi-platform heterogeneous data. the impact of sample heterogeneity on multi-platform analyses can be more substantial than on single platform analyses. first, the level of heterogeneity can be different from platform to platform, e.g. platforms such as somatic mutations and dna methylation have much higher diversity (heterogeneity) among individuals and samples than dna copy number . in addition, the heterogeneous subsets can be different from one platform to another, e.g. some samples might have changes on platform a but no changes on platform b, whereas different subsets of samples have changes on platform b but not on platform a. such a scenario may lead to power loss due to the attenuation of signals when the association is evaluated across platforms. in contrast, a multi-platform method that can tackle platform-specific heterogeneous data would be able to identify the signals when integrating information across platforms. in this study, we perform simulation studies to systematically evaluate different integrative methods under a range of scenarios. we observe that the true-positive rates (tpr) and the truenegative rates of existing multi-platform gene set methods decrease dramatically when heterogeneity exists. these results motivated us to construct three methods to account for sample heterogeneity in multi-platform gene set analysis: multi-platform mannwhitney statistics (mpmws), multi-platform outlier robust t-statistics (mport) and multi-platform likelihood ratio statistics (mplrs). we use simulations and real data analyses to demonstrate the utility of these methods under various conditions.in the presented work, we compared different multi-platform methods for gene set analysis using extensive simulated studies. first, when there is no sample heterogeneity, we found that int and hotellings t2 method had the best performances compared with other methods. int might have wider applicability compared with hotellings t2 because it can accommodate covariates. second, to account for sample heterogeneity, we proposed and tested three different strategies, mpmws, mport and mplrs, for multi-platform gene set analysis. we found that the non-parametric mpmws method had satisfactory tprs and robust performance regardless of the degree of heterogeneity. finally, based on the results of the simulations and the real data applications, we recommend using both mpmws and int: the significant gene sets identified by both methods are more likely to be true positives, while each approach is able to identify orthogonal, yet relevant, biological gene sets. it might be worth following up with these orthogonal findings combining with additional biological information so to minimize the false positives. we performed the tests assuming that genes are uncorrelated within and across platforms. this assumption may not be valid in real practice, especially for genes within the same gene sets. inter-gene correlation is known to inflate the fdr of singleplatform gene set analysis, and several methods have been proposed to address this issue . in addition, the genomic variables of a gene from different platforms can also be highly correlated with each other. for example, copy number change can lead to a change of transcript level, and a high methylation level of the gene promoter region often leads to downregulation of transcription. it is worth future studies to evaluate how inter-gene and inter-platform correlations will affect multi-platform gene set analysis. in our analysis, we ignored the issues of missing values by focusing on genes with complete observations in all platforms. in reality, missing data are commonly observed in large-scale studies because of the experimental conditions, individual sample differences or platform constraints. when a considerable amount of data are missing, removing all the samples or genes with missing data could lead to substantial loss of information.ten of 207 gene sets were selected as causal, and the results were averaged over 300 repeats.to address this issue, imputing can be used to fill in the missing values. performing self-contained gene set analysis tests is another strategy . further research is needed to characterize the patterns of missing data on different platforms, understand their impact on the gene set analysis and develop the proper statistical methods for missing data. the r code for all of the methods and test datasets are available on the web site: http://www4.stat.ncsu.edu/jytzeng/ software/multiplatform_gene_set_analysis/  
