fast-snp: a fast matrix pre-processing algo-rithm for efficient loopless flux optimization of metabolic models motivation: computation of steady-state flux solutions in large metabolic models is routinely performed using flux balance analysis based on a simple lp formulation. a minimal requirement for thermodynamic feasibility of the flux solution is the absence of internal loops, which are enforced using loopless constraints. the resulting loopless flux problem is a substantially harder milp problem, which is computationally expensive for large metabolic models. results: we developed a pre-processing algorithm that significantly reduces the size of the original loopless problem into an easier and equivalent milp problem. the pre-processing step employs a fast matrix sparsification algorithm fast-snp inspired by recent results on sparse null-space pursuit (snp). by finding a reduced feasible loop-law matrix subject to known directionalities, fast-snp considerably improves the computational efficiency in several metabolic models running different loopless optimization problems. furthermore, analysis of the topology encoded in the reduced loop matrix enabled identification of key directional constraints for the potential permanent elimination of infeasible loops in the underlying model. overall, fast-snp is an effective and simple algorithm for efficient formulation of loop-law constraints, making loopless flux optimization feasible and numerically tractable at large scale. availability: source code for matlab including examples are freely available for download atconstrained-based methods are the most popular methods for exploring the capabilities of genome-scale metabolic models (gems) . gems have been reconstructed for many model organisms , enabling comprehensive study of the genotypephenotype relationship, cellular physiology, metabolic capabilities, among others . more recently, these reconstructions have included larger and more complex networks, describing different cellular interactions , microbial communities , and multi-tissue organisms . the increased complexity of current metabolic models demands efficient constrained-based methods to compute possible network states, especially thermodynamically feasible ones. computation of thermodynamically feasible states is computationally hard , severely limiting its application to large-scale models. efficient computational methods are thus needed to interrogate the consequences of thermodynamic feasibility on these models.the computational performance of our strategy was compared to the traditional approach in different metabolic models covering a range of sizes. the models considered include the toy model shown in, an e. coli core model , and six gems, namely: iaf692 , ijn661 , iyl1228 , stm , ijo1366 and yeast 6 . we have assumed growth in minimal medium and growth rate maximization as the objective function for each model. in the case of the toy model, the upper bound of b1 was set to 1 and reaction b3 was maximized (see). the characteristics of each model after removal of blocked reactions are shown in. the models used in this study can be downloaded from the bigg models database at http://bigg.ucsd.edu .computation of loopless steady-state flux solutions is an np-hard milp problem . recent approaches such as fasttfva and cyclefreeflux have exploited particular features of the problem and used lp formulations following alternative approaches to solve different loopless flux optimization problems. although these approaches enabled fast computation of feasible fluxes (acceleration up to two orders of magnitude), they rely on post-processing methods for blocking unfeasible cycles after steady-state flux computation. in the current study, we developed a preprocessing strategy where the conventional milp problem is reformulated using a minimal set of loop-law constraints, enabling efficient computation of loopless flux solutions as well as topological analysis of infeasible cycles in large metabolic models. all modern milp solvers use preprocessing to recast milp formulations into easier-to-solve, yet equivalent representations . it is often possible to develop superior preprocessing strategies using insights into the specific milp problem. we have developed a fast preprocessing algorithm, fast-snp, which finds a minimal set of feasible loop laws taking into consideration the directionalities of the model. once the reduced loop-law matrix is found, a smaller loopless milp problem can be formulated and solved efficiently. speedups up to 50fold were achieved with preprocessing across diverse types of loopless flux optimization problems (tables 2+3, figs. 2-4). although the computational improvement of fast-snp is more modest than previous approaches (supplementary tables s2-s3), it is the only strategy capable of efficiently solving loopless related problems (i.e., ll-fba, ll-fva, ld and lr) using a single optimization problem based on suitable lp, milp or miqp formulations subject to the loopless constraints (eq. 5). importantly, such constraints have recently been algebraically proven to always yield thermodynamically feasible flux solutions (noor, et al., 2012).finally, we highlight additional and distinctive features of fast-snp for the analysis of metabolic models. as shown in the previous section, this approach enables a priori assessment of model complexity in the loop law sense, as it explicitly computes a minimal basis describing all the potentially infeasible cycles in the studied model. formally, these loop laws represent elementary flux modes that do not exchange mass with the surroundings . these internal cycles have previously been studied in the context of oriented matroid theory and more recently, infeasible cycles have been enumerated in gems using sampling approaches . however, efficient assessment of the impact of directionality constraints as well as topological analysis of these loop laws for their potential removal, has been lacking in the literature. fast-snp aids comprehensive assessment, unravelling simple strategies for removing infeasible loops based on thermodynamic or practical considerations (see). additionally, we note that the proposed matrix sparsification algorithm in fast-snp can also be employed for other useful analyses. for example, this algorithm can readily be modified to explore alternative solutions by incorporating suitable additional constraints (e.g., vi z ) using an appropriate objective (e.g., l1-norm minimization). the resulting greedy algorithm would generate a set of linearly independent solutions or pathways (i.e., a basis) consistent with the previous constraints by solving only lp problems. this avoids the need of computing expensive milp formulations. in conclusion, fast-snp complements existing methods in the constrained-based modelling toolbox for exploration and topological analysis of infeasible cycles and metabolic pathways.  
