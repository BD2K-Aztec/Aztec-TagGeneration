uproc: tools for ultra-fast protein domain classification motivation: with rapidly increasing volumes of biological sequence data the functional analysis of new sequences in terms of similarities to known protein families challenges classical bioinformatics. results: the ultrafast protein classification (uproc) toolbox implements a novel algorithm (mosaic matching) for large-scale sequence analysis. uproc is by three orders of magnitude faster than profile-based methods and in a metagenome simulation study achieved up to 80 higher sensitivity on unassembled 100 bp reads. availability and implementation: uproc is available as an open-source software at https://github. com/gobics/uproc. precompiled databases (pfam) are linked on the uproc homepage: http://uproc. gobics.de/.next-generation sequencing (ngs) has stimulated the development of many new sequence analysis methods. in particular, metagenomic studies of microbial and viral assemblages require innovative algorithms to analyse the vast amount of anonymous and fragmented sequence data that is obtained from environmental or clinical samples. in a typical bioinformatics pipeline, the assignment of genomic or metagenomic sequences to known protein families is an essential step towards a characterization of the functional repertoire of a particular organism or community. the pfam database of protein families in combination with the hmmer profile hidden markov models is widely used for functional annotation of genomic and metagenomic sequences. before the advent of hmmer 3.0, protein domain detection on large sequence collections had been computationally expensive, and several prefiltering methods were suggested to speed up the analysis. although such a prefilter approach has been included in hmmer 3.0, the processing of large metagenomic sequence files generated by ngs technologies can still be demanding.in metagenomics and other ngs applications, not only the amount of sequence but also the limited length of sequencing reads can be challenging for a functional analysis . now that illumina sequencing platforms are increasingly used in metagenomics, we are facing huge collections of short reads often not longer than 100 bp. here, the question arises what quality of the functional assignments can be expected for sequences that merely cover $10 of a typical microbial gene. in a recent study on transcriptomic data,showed that profile hidden markov models substantially lose sensitivity on short reads. we have developed a toolbox for ultrafast protein classification (uproc) that is available in terms of an open-source software. although uproc can in principle be applied to any protein sequence classification problem, the toolbox is predestined for functional analysis of metagenomes. first of all, the classification speed allows researchers to analyse large metagenomic datasets on a desktop computer without the requirement of large computer clusters or special purpose hardware. in addition, it also provides the necessary functionality to select open reading frames (orfs) from dna sequences. besides the computational speed, our results on simulated v c the author 2014. published by oxford university press.to evaluate the classification performance of uproc, we implemented a simulation of metagenomic short read data following the approach ofwho sampled short fragments from longer sequences to study the read length dependency of similarity-based protein family assignments. we utilized two different types of sequences from which we extracted the simulated short reads. in close correspondence to the approach of, we also used longer metagenomic sanger reads which were subject to gene prediction and pfam analysis to obtain a valid labelling of the subsequently extracted fragments. in addition, we also utilized a collection of microbial genomes where we used the available gene annotation to obtain the labelling. this gives rise to two kinds of test datasets with different characteristics: the test data from metagenomic reads contains sequencing errors and the detection of coding regions has to cope with incomplete genes. this provides a realistic read simulation but some errors in the labelling are highly probable. on the other hand, the test data from microbial genomes can be expected to be almost free of sequencing errors and the full-length gene annotation should provide a more reliable labelling. however, the microbial genomes can also be expected totools for ultra-fast protein domain classificationbe closer to the known sequences that have been used to create the pfam database. for that reason, we used an older version of the pfam database to slightly increase the sequence novelty for the pfam analysis on the test data. nevertheless, the genome-based test data, in principle, provides an easier trial while the metagenomebased data is more challenging.the results on simulated short reads encourage the use of uproc for large-scale metagenome analysis. for 100 bp reads the usual speedaccuracy trade-off seems to be obsolete since uproc is both faster and more sensitive. the computationally more expensive profile methods that provide state-of-the-art classification performance on full-length protein sequences might not be optimal for this kind of short read data. this finding agrees well with a recent study on transcriptomic data where hmmer and other profile-based methods showed inherent difficulties in classifying protein domains on short reads from weakly conserved regions. in our case, this is even more remarkable, because the hmmer program was also used for preparing all test examples on the basis of its predictions on full-length sequences. the sensitivity rates clearly show that on 100 bp short reads hmmer does not recognize a considerable fraction of the protein domains that have been predicted in longer sequences before. for increasingly longer reads hmmer successively outperforms uproc in terms of sensitivity, while in terms of speed it remains $500 times slower. it is important to note that uproc requires a large protein database that well represents the sequence variation within different families. in particular, smaller databases that are based on full-length protein sequences might require a homology extension before being used with uproc. this shows an important advantage of profile-based methods that can even be used to represent tiny families with just a few sequences. furthermore, it can also be expected that profile methods can better cope with the increasing overlap between families in full-length databases. in turn, uproc is not restricted to protein families that are well representable by. sensitivity (tpr) of protein domain detection on simulated short reads with best value in bold face multiple alignments. at the uproc homepage, we offer a precompiled database for a recent version of the kegg orthologs which are widely used for metabolic profiling in metagenomics and metatranscriptomics. beyond functional analysis, uproc can also be used for fast taxonomic profiling of metagenomes forwarding the protein domain hit counts to the taxy-pro mixture model toolbox .  
