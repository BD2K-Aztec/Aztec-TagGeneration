robust clinical outcome prediction based on bayesian analysis of transcriptional profiles and prior causal networks motivation: understanding and predicting an individuals response in a clinical trial is the key to better treatments and cost-effective medicine. over the coming years, more and more large-scale omics data-sets will become available to characterize patients with complex and heterogeneous diseases at a molecular level. unfortunately, genetic, phenotypical and environmental variation is much higher in a human trial population than currently modeled or measured in most animal studies. in our experience, this high variability can lead to failure of trained predictors in independent studies and undermines the credibility and utility of promising high-dimensional datasets. methods: we propose a method that utilizes patient-level genome-wide expression data in conjunction with causal networks based on prior knowledge. our approach determines a differential expression profile for each patient and uses a bayesian approach to infer corresponding upstream regulators. these regulators and their corresponding posterior probabilities of activity are used in a regularized regression framework to predict response. results: we validated our approach using two clinically relevant phenotypes, namely acute rejection in kidney transplantation and response to infliximab in ulcerative colitis. to demonstrate pitfalls in translating trained predictors across independent trials, we analyze performance characteristics of our approach as well as alternative feature sets in the regression on two independent datasets for each phenotype. we show that the proposed approach is able to successfully incorporate causal prior knowledge to give robust performance estimates.with our increasing understanding of the etiology and heterogeneity of complex diseases comes the realization that therapeutic drugs might need to be tailored to specific subpopulations of patients. our current inability to predict such subpopulations has contributed to the rising cost of drug development and overall health-care expenditure. one aspect of this problem is the identification of patient populations that respond to an experimental drug in a clinical trial. it currently becomes feasible to generate multi-omics (e.g. transcriptomics, genetics and metabolomics) datasets for all patients in a clinical trial of hundreds of people for a cost that is only a small percentage of the overall cost of the trial. research on precision medicine has been particularly strong in oncology as many cancers have a strong genetic basis to leverage for this purpose. for instance, the national cancer institutes of health (nci) in the usa recently outlined their criteria for the use of omics-based predictors in nci-funded clinical trials. they point out the pitfalls of defining omics-based predictors that do not translate well to patient population outside the initial trial, i.e. the problem of overfitting the available data. as a striking example of the care that has to be taken when defining signatures,compare 47 published gene-expression signatures for breast cancer. the sobering result is that the majority of signatures do not perform better than any randomly picked set of genes of similar size. in our experience, the aspect of replicability in independent datasets has not received enough attention in the current literature on novel methods. it is relatively easy to demonstrate the benefits of a method within one well-controlled study but much harder to show translatability to independent studies. this problem is especially pronounced in human populations in which genetic and environmental diversity is much higher than in animal studies. as this problem has impacted method adoption for our internal research in several cases, we tried to explicitly validate findings in at least two independent cohorts in each response prediction scenario. in this article, we focus on human clinical trials with patientlevel genome-wide gene-expression data. responders to therapy are identified at the end of the study using disease-specific measures. the question of interest is whether the baseline or early treatment gene-expression data can predict response to treatment. there has been substantial prior work on establishing predictive gene-expression signatures based on data-driven methods alone as well as by leveraging other types of biological information. for instance,proposed the use of regularization techniques to improve gene selection for predictive signatures early on. since then, many authors have proposed approaches using different machine-learning techniques including regularized regression, svms and random forests. cun and fr ohlich (2012) give a recent review. one recent example that utilizes prior knowledge is the paradigm approach which uses probabilistic models to integrate genetics, epigenetics and transcriptional data with curated pathway information to determine active pathways in cancer patients, but does not directly attempt a prediction of response and non-response status in trial data.this is an open access article distributed under the terms of the creative commons attribution non-commercial license (http://creativecommons.org/licenses/by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. for commercial re-use, please contact journals.permissions@oup.comas a common consensus, most methods employ some form of regularization to overcome the problem of many variables but few samples. furthermore, methods vary in the amount of prior knowledge they employfrom no prior knowledge at all to a mixture of different omics technologies as in the case of paradigm. however, most novel methods have not been developed in the setting of human data with high intrinsic levels of phenotypic and genetic heterogeneity and are not evaluated in a truly independent dataset, e.g. a trial conducted at a different clinic, but exclusively rely on cross-validation approaches. in contrast, we present a method that attempts to define biologically interpretable, yet predictive signatures of diseases progression or response to drug treatment that translate well to new studies. in conjunction with a well-accepted learning algorithm, l 1-regularized logistic regression , we base our method on a large collection of causal relationships manually curated from the literature. the causal graph consists of $450 000 causal relationships, of which 4250 000 are unique, between $37 000 entities, representing $65 000 full-text articles indexed by pubmed. each causal relationship describes an experimentally observed perturbation experiment leading to a defined transcriptional change. we previously published a bayesian inference method on this causal graph that given a set of differentially expressed genes, is able to identify potential upstream regulators and their biological context . the method is called bayesian causal reasoning engine (bayes-cre) and will serve as a building block in this work. we briefly outline it in section 2. a prerequisite for the method to work is that relevant biology is captured in the underlying knowledgebase of causal relationships. we found that bayes-cre is able to capture the relevant upstream regulators in numerous test cases, indicating that the collection of pairwise causal relations in our network has sufficient level of complexity to be useful. more large-scale dataset with more complex notion of causality can also be incorporated into our methodology as they become available in the future. the search for suitable experimental datasets has been surprisingly difficult. our criteria for inclusion were (i) a dataset of at least 20 human subjects with a defined clinical binary outcome, i.e. responders and non-responders, (ii) at least some detectable difference in gene expression at baseline between the two groups and (iii) the availability of a similar but entirely independent trial for testing purposes. for the purposes of this work, we settled on two appropriate datasets: the studies ofon acute rejection in kidney transplantation and the work ofon infliximab treatment in ulcerative colitis. in the following, we will define the details of our proposed method, compare its performance against alternative feature sets and demonstrate that its application can lead to biologically interpretable predictors that are robust to resampling and, most crucially, seem to translate well to independent patient populations.we applied our pipeline using all feature sets to two relevant phenotypes (acute rejection in kidney transplantation andresponse to infliximab therapy in ulcerative colitis), each containing two independent datasets.patient populations exhibit high genetic, environmental and phenotypic heterogeneity. this makes the search for robust predictors in clinical trials a difficult endeavor. if we rely on classical (low-dimensional) biomarkers, prediction performance might not be sufficient. using high dimensional datasets, e.g. transcriptomics datasets, can easily lead to predictors that have stellar performance in the training trial, but poor performance in an independent study . this seems to be the case even when all proper considerations of cross-validation or a test/training split within one clinical trial are observedat least given current sample sizes. many methods have been developed to avoid overfitting of the data, but as we demonstrate in this work, even a well-accepted regularized classifier will not always be able to pick out the biologically robust features based on expression data alone. we found that any of the defined feature sets is able to predict with high accuracy under a certain set of circumstances. for instance, the z-score profiles perform best when trained on gse50058, but very poorly in all other cases . in contrast, picking the top10 genes does not work at all when training on gse50058, but well in the other cases. the bayes-cre feature set retained performance across all scenarios tested and was among the top predictors in independent test sets. it should be noted that the performance of this method is strongly dependent on the prior knowledge encoded in the underlying knowledgebase. if no relevant upstream regulators are available in the knowledgebase that can aggregate the downstream transcriptional signal, performance will be poor as no useful features can be generated. at the same time, the number of generated features can easily be checked. if there are a number of differentially expressed genes present in a dataset, but regulator nodes receive only weak posterior probabilities, the knowledgebase is likely to contain no relevant biology and other approaches should be pursued. as demonstrated by our results, generalization to independent datasets in the presence of high levels of confounding factors (such as clinical site, exact composition of trial population, etc.) is very difficult and research should be invested to not only find better mathematical approaches to exploit the dataset at hand, but incorporate other prior knowledge in an optimal way. the knowledgebase that we utilize in this work may contain noise as well, however, this noise should be independent of a particular trial population as it tries to describe general biological facts. another potential criticism of the bayes-cre method is the focus on ifng, lps and tnf as key regulators in the assessed datasets. clearly, these nodes are well-known regulators of immune system and inflammatory processes and would have been picked as relevant by experts in the fields. we evaluated the performance of only using ifng downstream genes as defined by our knowledgebase. the results are slightly inferior to bayes-cre features, but roughly comparable (supplementary). in contrast to the manual trial and error approach of defining potential downstream genes based on expert opinion per dataset, the bayes-cre approaches provides a comprehensive assessment of relevance of all encoded knowledge in the knowledgebase. in our cases, it correctly identified many relevant potential regulators of involved processes facilitating acceptance of the derived classifiers. this points to a need for public, readily available repositories of causal biological knowledge to derive better classifiers and interpret biological datasets more quickly. proteinprotein-interaction databases like intact are in the process of adopting their curation process to include causal relationships (s. orchard, personal communication). the use of other (non-causal) prior knowledge sources is certainly promising as well. however, we feel that the causal relationships used in this study are well-suited to summarize downstream transcriptional activity into fewer features that are biologically relevant. this might be harder to achieve based on proteinprotein-interaction data as no directionality exists in the network and the relationships are not directly related to transcriptional activity. in future work we plan to add large-scale datasets with more complex notion of causality into our methodology as they become available. it was surprisingly hard to collect public data for this study as we required trials of at least 20 human subjects with a definedclinical binary outcome, i.e. (i) responders and non-responders, (ii) at least some detectable difference in gene expression at baseline between the two groups and (iii) the availability of a similar but entirely independent trial for testing purposes. we expect this situation to change over the coming years as more and more trials generate relevant molecular data and are made available for public research. however, the size of the trials will remain limited as the generation of molecular data is only a small fraction of the cost and overall costs of large clinical trials remain astronomical. this situation will make approaches using prior knowledge even more relevant. in future work, we plan to test the methods on more datasets as they become available, extend the method to allow for continuous phenotypes and take placebo response for drug trials into account. the latter should be possible by integrating placebo arms of clinical trials into the regularized regression framework. however, we were not able to find suitable publicly available datasets to test such extensions at this point. this will be important to distinguish diagnostic signatures that are predictive of disease progression from signatures that are predictive of drug response itself. in summary, we have presented a method for prediction of clinical phenotypes based on genome-wide expression data that makes use of a large collection of causal relationships defined from the literature. features selected by the l 1-regularized regression method correspond to upstream molecular entities that can readily be interpreted biologically and subsume sets of transcriptional changes in a useful manner. the method performs well in the analyzed datasets and, importantly, gives stable performance estimates across cross-validation as well as independent test set runs. given that more and more clinical trials involving heterogeneous populations will become available, methods such as the one presented here can help to make the vision of precision medicine a reality.  
