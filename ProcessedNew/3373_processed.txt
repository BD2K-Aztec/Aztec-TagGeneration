gene expression optimization of gene set annotations via entropy minimization over variable clusters (emvc) motivation: gene set enrichment has become a critical tool for interpreting the results of high-throughput genomic experiments. inconsistent annotation quality and lack of annotation specificity, however , limit the statistical power of enrichment methods and make it difficult to replicate enrichment results across biologically similar datasets. results: we propose a novel algorithm for optimizing gene set annotations to best match the structure of specific empirical data sources. our proposed method, entropy minimization over variable clusters (emvc), filters the annotations for each gene set to minimize a measure of entropy across disjoint gene clusters computed for a range of cluster sizes over multiple bootstrap resampled datasets. as shown using simulated gene sets with simulated data and molecular signatures database collections with microarray gene expression data, the emvc algorithm accurately filters annotations unrelated to the experimental outcome resulting in increased gene set enrichment power and better replication of enrichment results. availability and implementation: http://cran.r-project.org/web/pack ages/emvc/index.html.gene set enrichment is widely used for the analysis and interpretation of the large molecular datasets generated by modern biomedical science . despite the development of robust statistical enrichment methods and extensive functional ontologies such as the gene ontology (go) , the kyoto encyclopedia of genes and genomes (kegg) and the molecular signatures database (msigdb) with annotations for many biological molecules across numerous species, the results of enrichment analysis are too often overly general, inaccurate or non-reproducible across experiments . although changes to statistical methods or refinements of functional ontologies can improve enrichment performance, annotation completeness and quality is often a dominant factor driving enrichment accuracy and reproducibility. the annotation of most genes and gene products is incomplete with only a sparse set of annotations to generic high-level categories available . for those annotations that do exist, the overwhelming majority are automatically generated on the basis of sequence or structural similarity without any curatorial review (du). such automatically generated annotations have known quality issues relative to manually curated annotations, especially those based on published experimental findings . electronic annotations are slowly being replaced with higher-quality annotations backed by experimental evidence; however, given the slow pace of experimental validation and manual curation, the preponderance of unreviewed computational annotations and continual generation of new automated annotations, annotation quality will remain a challenge into the foreseeable future. current approaches to annotation quality fall into one of several groups: those that create a filtered version of existing annotations, those that subset and/or restructure existing functional ontologies and those that define new, customized, gene sets. in the context of go, automatic annotation filtering includes methods that use evidence codes, e.g. the msigdb c5 collection , as well as approaches that use the ontology hierarchy to identify and remove redundant annotations . methods that subset or restructure ontologies include tools for the manual or automatic generation of go slims as well as techniques for the information theoretic optimization of the entire go taxonomy . the process used to generate the msigdb c4 cancer modules combines both automatic gene set generation with gene set refinement. in the cancer module process, modules are generated by merging and then refining existing gene sets with gene clusters computed from a large collection of tumor gene expression microarrays. although manually customized annotation collections can achieve high specificity, they require domain expertise to create and suffer from ad hoc methods that limit the relevance of any subsequent analysis results. while automatic methods for annotation filtering and ontology sub-setting do not suffer from individual researcher bias, their general purpose nature can prevent them from aligning with the narrow scientific to whom correspondence should be addressed. this is an open access article distributed under the terms of the creative commons attribution non-commercial license (http://creativecommons.org/licenses/by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. for commercial re-use, please contact journals.permissions@oup.com domain under investigation. an important limitation of many current automatic annotation filtering and ontology subsetting methods is the fact that analysis is only based on the structure of the ontology and the content of the underlying annotation databases. the experimentally observed abundance of the annotated genes and gene products is not used to help identify low-quality annotations or guide ontology restructuring. by focusing on just ontological and annotation data, these methods provide information about the general quality of the annotations and ontology structure, information that is equally relevant to any dataset measuring the annotated genes. given the large number of proteins with incomplete and therefore coarse-grained functional annotations, a general measure of annotation quality may be a poor predictor of how well annotations will perform within a narrow domain. even for those approaches that use experimental data, like the process used to create the msigdb c4 cancer modules, the focus is usually on a broad collection of experimental data (e.g. microarray data for 22 tumor types in the case of the c4 cancer modules), and the output typically combines synthesis of new gene sets with gene set refinement rather than focusing solely on refinement of existing gene sets for a specific experimental context. development of high-quality annotations that are specialized to a research domain, yet free from researcher bias, requires techniques that automatically refine annotations using machine learning methods based on representative experimental data. while statistical learning methods are commonly used to predict new annotations from biological data, effective tools are not currently available that apply these techniques for the refinement of existing gene set annotations. to address this gap and enable more accurate and reproducible gene set enrichment analysis, we have developed a novel bioinformatics method, entropy minimization over variable clusters (emvc), that automatically customizes existing functional annotations for specific sets of biological data. as we demonstrate using simulated gene sets with simulated data and msigdb collections with microarray gene expression data, the emvc method accurately filters annotations unrelated to the experimental outcome, resulting in increased gene set enrichment power and better replication of enrichment results.gene clusters and gene set enrichment. the emvc algorithm performs annotation optimization on variable clusters computed using an unsupervised view of experimental data. by minimizing the entropy for each variable group relative to disjoint variable clusters, the annotations for variables that tend to cluster with other variable group members are kept and annotations for variables that cluster apart are filtered. a key advantage of this unsupervised approach is that emvc-optimized annotations can be used for subsequent variable group enrichment without biasing the computed enrichment statistics. however, the unsupervised emvc approach can only successfully filter inconsistent annotations, improve gene set enrichment power and improve enrichment replication if the structure of genomic data, as represented by gene clusters, can be used to identify the genomic variables most likely to contribute to gene set enrichment. in other words, the genes that contribute strongly to the enrichment signal for significantly enriched gene sets must be more likely to cluster together than the genes whose expression is not consistent with gene set enrichment.). open circles represent the fdr values computed using the unoptimized cancer module annotations, and solid squares represent the fdr values computed using optimized cancer modules. if the optimized fdr value is less than the unoptimized value, a solid line is used, otherwise, a dotted line is used. an aml prefix is used for gene sets enriched using the unoptimized annotations for the acute myeloid leukemia, and an all prefix is used for gene sets enriched for the acute lymphoblastic leukemia phenotype. the ratio of optimized to unoptimized annotations for each of the top 15 cancer modules is displayed after each module name along with the symbols for the filtered genes (cropped at 7). an asterisk follows the symbol for filtered annotations that were designated as core genes by the gsea algorithm. for the displayed contingency table, filtered annotations were removed by emvc in more 85 of the cluster results in 50 bootstrap resampled data sets resulting in an odds ratio of 41.1 (95 ci: 21.886). when all filtering thresholds are considered, the area under the roc curve is 0.92 h.r.frost and j.gene set enrichment has become a central element in the analysis and interpretation of genomic data. although significant progress has been made building gene set collections and developing statistical enrichment methods, annotation quality remains a critical challenge. because of the broad scope of many gene set collections and the large number of lowquality annotations, enrichment analysis results are frequently inaccurate and non-reproducible. current approaches to annotation quality are mainly general purpose, largely driven by just the structure and content of the gene set ontology and, when experimental data are considered, focus on gene set synthesis over refinement. to address the annotation quality issue and limitations of current approaches, we have developed a novel annotation optimization method, emvc, which is available as an r package from cran. on both simulated gene sets with simulated data and msigdb gene sets with real gene expression data, the emvc algorithm has been shown to effectively filter inconsistent annotations, improve enrichment power and improve enrichment replication.  
