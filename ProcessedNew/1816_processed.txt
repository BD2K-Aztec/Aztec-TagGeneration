sequence analysis filtering duplicate reads from 454 pyrosequencing data motivation: throughout the recent years, 454 pyrosequencing has emerged as an efficient alternative to traditional sanger sequencing and is widely used in both de novo whole-genome sequencing and metagenomics. especially the latter application is extremely sensitive to sequencing errors and artificially duplicated reads. both are common in 454 pyrosequencing and can create a strong bias in the estimation of diversity and composition of a sample. to date, there are several tools that aim to remove both sequencing noise and duplicates. nevertheless, duplicate removal is often based on nucleotide sequences rather than on the underlying flow values, which contain additional information. results: with the novel tool jatac, we present an approach towards a more accurate duplicate removal by analysing flow values directly. making use of previous findings on 454 flow data characteristics, we combine read clustering with bayesian distance measures. finally, we provide a benchmark with an existing algorithm.when 454 life sciences (now roche diagnostics) released the gs20 sequencing platform in 2005 , it was the start of a revolution in sequencing technology. it has since been followed by other platforms, both subsequent generations from 454 and competing technologies like illumina/solexa and abi/solid. the increased throughput and decreasing per base cost of these second-generation sequencing technologies have made high-throughput sequencing an affordable tool for many new organisms and applications. the traditional sanger sequencing is now 30 years old , and the error characteristics and artifacts intrinsic to the method are well characterized. consequently, there are established methods for describing sequence quality . standard methods and tools for detecting and dealing with common contamination like vector sequences or genomic contamination exist, some of them applicable to one or several second-generation sequencing technologies . experienced researchers will also be aware of the risk of artifacts like chimeric sequences arising through different mechanisms . there are numerous approaches to the removal or correction of erroneous sequences or parts of sequences for different applications. these are especially tailored to metagenomics, but also to snp detection, small rna discovery and so forth, some of them using 454 pyrosequencing flow data instead of nucleotide sequences, with good results .in this article, we have quantified the room for improvements when filtering 454 pyrosequencing shotgun data for artificial duplicates. we have successfully shown that, by the use of 454 flow data, a higher rate of artificial duplicates can be identified than by using sequence data only. artificially duplicated reads canapart from a generally higher processing and memory requirementlead for example to incorrect conclusions about metagenomic dataset composition or to biased quantification in digital karyotyping experiments . another likely problem could be false positive single nucleotide polymorphism calls in the presence of duplicated erroneous sequences. however, too stringent filtering might lead to an underestimation of abundance . both jatac and cd-hit-454 cannot distinguish natural from artificial duplicates, but the percentage of natural duplicates can be estimated from sequencing coverage by calculating the probability of multiple reads randomly starting at the same position . although cd-hit-454s estimated duplicate rates were comparable with jatacs estimations, the calculated cluster composition at similar duplication rates was of lower quality, manifested in a lower jaccard index. this is likely the result of jatac being better at handling homopolymer discrepancies and taking flow order into account, whereas cd-hit-454 is operating mostly on global similarity scores. the distance calculation in jatac is a more robust way of finding duplicates, as it first identifies read pairs with different homopolymer lengths at low distances. only with higher distance thresholds, reads with substitutions are taken into account. this behaviour closely models the 454 sequencing chemistry where substitution errors are less common than indels. interestingly, the jaccard index calculated from running cd-hit-454 on the d.labrax dataset degraded much faster around the true duplicate rate when compared with jatac. this degradation could not be observed in the bacterial datasets and is likely due to a higher probability of matching unrelated sequences from a complex background. this phenomenon could also be relevant to metagenomic experiments of highly diverse communities, where tools such as cd-hit-454 and jatac are most useful. a comprehensive overview of. comparison of jatac and cd-hit-454 duplicate clustering at different stringency settings and estimated duplicate rates surrounding the true duplicate rate (vertical grey line). the range of parametrization lies between 0.02 and 0.10 (distance threshold) for jatac and between 99 and 92 for cd-hit-454 (identity threshold). left: e.coli (run 1). centre: e.coli (run 2). right: d.labrax. for explanation of a, b and c pairs, see the text 835applications and effects of duplicate filtering, e.g. on genome assembly, can be found in. jatacs improved duplicate identification comes at a computational price, and its speed depends on the number of reads and the degree of duplication. jatac takes up to several hours to filter an sff file for duplicates, $1.5 h for a typical gs junior run. we have also evaluated jatac on iontorrent flow data, as both platforms share the same data format (sff). although it is in principle possible to analyse ionograms using jatac, the underlying flow data model has been optimized for pyrosequencing data, which is why we do not recommend jatac for iontorrent data in its present version.  
