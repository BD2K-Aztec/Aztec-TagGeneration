structural bioinformatics fragsion: ultra-fast protein fragment library generation by iohmm sampling motivation: speed, accuracy and robustness of building protein fragment library have important implications in de novo protein structure prediction since fragment-based methods are one of the most successful approaches in template-free modeling (fm). majority of the existing fragment detection methods rely on database-driven search strategies to identify candidate fragments, which are inherently time-consuming and often hinder the possibility to locate longer fragments due to the limited sizes of databases. also, it is difficult to alleviate the effect of noisy sequence-based predicted features such as secondary structures on the quality of fragment. results: here, we present fragsion, a database-free method to efficiently generate protein fragment library by sampling from an inputoutput hidden markov model. fragsion offers some unique features compared to existing approaches in that it (i) is lightning-fast, consuming only few seconds of cpu time to generate fragment library for a protein of typical length (300 residues); (ii) can generate dynamic-size fragments of any length (even for the whole protein sequence) and (iii) offers ways to handle noise in predicted secondary structure during fragment sampling. on a fm dataset from the most recent critical assessment of structure prediction, we demonstrate that fgragsion provides advantages over the state-of-the-art fragment picking protocol of rosetta suite by speeding up computation by several orders of magnitude while achieving comparable performance in fragment quality. availability and implementation: source code and executable versions of fragsion for linux and macos is freely available to non-commercial users at http://sysbio.rnet.missouri.edu/ fragsion/. it is bundled with a manual and example data.fragment library is one of the key components of widely used fragment-based protein structure prediction methods , where complete models of the target structures are generated by combining fragments from the library. therefore, improving speed, accuracy and robustness of fragment library generation have direct impact on the performance of these methods. several approaches have been introduced over the last decade for fragment detection ranging from exhaustive search to more sophisticated profile hidden markov models (hmm) based comparison . these methods require a template database against which segment of the target sequence is matched in order to identify suitable fragments. due to large size of the template database that includes all representative structures from the protein data bank (pdb) , the search is oftenslow. moreover, the incomplete coverage of pdb makes it difficult to map a reasonably large fragment for the target protein. recent developments in fragment selection using probabilistic models have shown promising directions to overcome the size and diversity restriction of database-driven approaches by sampling local structure from a generative model. here, we extend their scope by (i) sampling fragments of protein backbone in full-atomic detail rather than using a coarse-grained representation or assuming ideality in backbone planarity and (ii) allowing robustness against noise in sequence-based predicted information like secondary structure. the resulting application, fragsion, has been compared to the popular database-driven fragment assignment protocol of rosetta on template-free modeling (fm) targets from 11th edition of critical assessment of structure prediction (casp11) experiment. the results show that fragsion (i) provides slightly better coverage than rosetta at the expense of minor loss in precision and (ii) computationally much more efficient than rosetta.we assessed the performance of fragsion using 30 casp11 fm domains (supplementary information) by simulating in a blind de novo protein structure prediction scenario. first, we obtained sequences of the target proteins from casp11 and executed psipred to predict secondary structure using a non-redundant (nr) protein sequence database curated before casp11. the sequence and predicted secondary structures were then used to generate 200 fragments for each sequence position with variable fragment lengths ranging from 3-mer to 20-mer. the experimental structures of target domains were then downloaded from casp11 and the residues that were not present in experimental structures were discarded from fragment libraries. finally, we assessed the quality of fragment library by superimposing each fragment in the library on to the experimental structure. we used two commonly used metrics to measure accuracy of fragment library: (i) precision (the proportion of good fragments in the libraries): number of good fragments divided by total number of fragments in a library and (ii) coverage (the proportion of protein residues represented by a good fragment): number of residues represented by at least one good fragment divided by number of residues of the target. we also executed rosettas fragment picker application (version 3.5) with the same input to generate fragment libraries using a template database created before casp11 and after excluding all homologues fragments during rosettas fragment picking. the results show that there is only some minor difference between the performance of fragsion and rosetta over the entire dataset at various rmsd cutoffs between 0.1 and 4.0 a . fragsion provides slight advantage in coverage (64 versus 63) while rosetta is slightly better in terms of precision (26 versus 24). average rmsd of fragments for different fragment lengths are also comparable (3.8 a for fragsion and 3.7 a for rosetta). to investigate the effect of fragment quality on the performance of de novo protein modeling, we executed abinitiorelax application of rosetta to generate two model pools (each pool has 100 models) for each target using 9mer and 3mer fragments from fragsion and rosetta. the average accuracy of models generated using rosettas fragments is better than fragsions in terms of rmsd (19.980 a for fragsion and 17.995 a for rosetta). the most accurate models in terms of tm-score using rosettas fragments outperforms that of fragsions for all targets. accuracy of fragsions best prediction in terms of rmsd, however, is better than rosettas for six targets. the models having the lowest rosetta energy generated using fragsions fragment library outperforms that of rosettas for ten targets in terms of rmsd and only for three targets in terms of tm-score. in general, the accuracy of models generated using rosettas fragments is better than fragsions. the most significant advantage of fragsion is, therefore, speed. average computation time for fragsion takes only 24 s, more than 75 times faster than rosetta with average computation time exceeding 30 min. a target-by-target comparison between fragsion and rosetta is presented in the supplementary document along with analysis on the qualities of the model pools produced using fragments generated by fragsion and rosetta.we developed an easy-to-use software tool (fragsion) based on an input-output hidden markov model (iohmm) to sample structural fragments for proteins. the model-based tool without carrying a large fragment database is light-weighted and very fast and has the performance comparable to some widely used fragment generation tool, which makes it a useful tool for template-free protein structure modeling.  
