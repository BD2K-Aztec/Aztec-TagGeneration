short read alignment with populations of genomes the increasing availability of highadvancements in next-generation low-cost, high-throughput dna sequencing technologies have made it possible to sequence a large number of human and other species genomes . several large-scale sequencing efforts are under way, including the 1000 genomes project (the 1000) and the international cancer genome project . more than 2000 individuals have already been sequenced by the 1000 genomes project. although the next-generation sequencing technologies provide a vast amount of data samples for advancing genomic research, the everincreasing volume of genomic data has become a tremendous challenge on multiple fronts . one challenge is the alignment of the short dna sequences (short reads) produced by these technologies to reference genomes, to discover the variation of a newly sequenced genome with respect to the previously sequenced human genomes. short read alignment is a common first step during genomic data analysis and plays a critical role in medical and population genetics. several efficient short-read alignment programs, such as bwa, soap2 and bowtie , have been developed in the past years . these methods use the burrows wheeler transform (bwt) , which facilitates linear-time alignment to a large reference string , such as a genome, and requires only a limited amount of memory . these aligners typically precalculate the bwt (and some associated auxiliary structures) of a single reference genome and then map the newly sequenced reads to it using a variant of the bwt backwards search procedure. any observed differences from the chosen reference genome are treated as novel genomic variants or sequencing errors (e.g.). in light of the increasing availability of thousands of sequenced human genomes and databases of human genome variation, the requirement of these methods to use a single human reference genome leads to inherent biases towards the arbitrarily chosen reference. biased alignment output can be a hindrance to the in-depth and comprehensive understanding of the cancer genome , evolutionary history , mendelian diseases and numerous other domain applications. beyond human, to date, millions of genomic variants have been observed in a wide variety of species and can serve as a valuable resource for alignment. for example, many inbred mouse strains have been sequenced to characterize their genomic variation . two such mouse strains can have up to 20 million differences between them. as a result, when they are crossed, their f1 offspring are heterozygous at all loci that differ between the parents. aligning reads from the f1 offspring to either parents genome using current alignment techniques will ignore this known heterozygosity and result in alignment bias towards the chosen reference strain. this can make it difficult to perform an experiment like rna-seq, which relies on high quality mappings. the limitations of using conventional references and aligners are even more pronounced when sequencing organisms with a large amount of genomic variation among individuals. for example, the sea squirt, ciona savignyi, has a polymorphism rate of $4.5 . with such a high polymorphism rate, the genome of any newly sequenced individual of this species will be very different from a single conventional reference sequence. current short-read aligners operating on a single reference genome are simply not designed to handle this scenario and will result in poor alignment accuracy. although humans have a lower polymorphism rate, the reference bias remains an important problem. even though individual alignment results may be only slightly biased when aligning with conventional techniques, in a large study involving thousands of individuals, this effect can add up to distort the studys conclusion. a vast number of genomic variants in human populations have already been discovered and are maintained in publicly accessible databases, such as dbsnp and snpedia. the majority of variations between a newly sequenced genome and the reference are likely to already exist in these databases. moreover, structural variants, such as transpositions, large insertions and to whom correspondence should be addressed.in this article, we proposed a compact representation for a collection of genomes (the reference multi-genome) that captures the genomic variations in the collection and presented bwbble, a bwt-based short-read aligner that operates on this compiled reference. we demonstrated the performance of bwbble on a human reference multi-genome incorporating variants from 1090 individuals. a limitation of our reference multi-genome representation is its use of read length dependent padding to capture structural variants, which to achieve best results necessitates multiple reference indices to be built for each particular read length. in addition, padding can also cause a significant increase in the length of the reference for highly variable species. although aligning to the reference multi-genome is much slower than to a single genome, it is considerably more efficient than aligning to each genome in a large collection separately. as the number of sequenced genomes grows, aligning with bwbble should become much more time and space efficient. moreover, because bwbble can align reads that span long (known) indels, its utility will increase once large databases of structural variants are available. bwbble can also be useful in functional genomics assays of parent/offspring trios, where unbiased peak calling is desired . finally, bwbble can output important information about the snps and structural variations that a given read was mapped to (e.g. the number of genomes in the collection that contain this particular variation), which should simplify and improve the current post-alignment processing pipeline.  
