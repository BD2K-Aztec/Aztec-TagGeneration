systems biology efficient sampling for bayesian inference of conjunctive bayesian networks motivation: cancer development is driven by the accumulation of advantageous mutations and subsequent clonal expansion of cells harbouring these mutations, but the order in which mutations occur remains poorly understood. advances in genome sequencing and the soon-arriving flood of cancer genome data produced by large cancer sequencing consortia hold the promise to elucidate cancer progression. however, new computational methods are needed to analyse these large datasets. results: we present a bayesian inference scheme for conjunctive bayesian networks, a probabilistic graphical model in which mutations accumulate according to partial order constraints and cancer genotypes are observed subject to measurement noise. we develop an efficient mcmc sampling scheme specifically designed to overcome local optima induced by dependency structures. we demonstrate the performance advantage of our sampler over traditional approaches on simulated data and show the advantages of adopting a bayesian perspective when reanalyzing cancer datasets and comparing our results to previous maximum-likelihood-based approaches. availability: an r package including the sampler and examples is available atcancer progression is an evolutionary process characterized by the accumulation of somatic mutations, including singlenucleotide variants, copy number alterations and changes of dna methylation. cells with advantageous mutations that confer a proliferative fitness advantage will eventually dominate the cancerous tissue due to clonal expansion. mutations in a number of genes are recurrent and it is therefore believed that they are essential for the development of specific cancer types. mutations of those genes and the functional changes they induce are often referred to as the hallmarks of cancer . the development and fixation of certain mutations in the tumour cell population seem to depend on the presence of other mutations , but, in general, the order of occurrence of mutations is poorly understood. recent advances in genome sequencing enable large-scale consortia such as the cancer genome atlas (tcga) or the international cancer genome consortium (icgc) to produce genomic and epigenomic profiles of cancer samples for a medium number of patients on the order of hundreds. for example, the cancer genome atlas research network (2011) recently published exome sequencing, copy number variation, gene expression and dna methylation data for over 300 ovarian cancer patients. over the course of the last decade, researchers have applied probabilistic modelling in order to identify the dependency structure of driver mutations for various cancer types. the models include oncogenetic trees , mixtures of oncogenetic trees , probabilistic network models and conjunctive bayesian networks (cbn) . all these models are based on cross-sectional data where genotyping has been performed once on a cancer tissue sample per patient after diagnosis. cbns jointly model a partial temporal order for the mutation accumulation process and the probabilities of acquiring these mutations based on this cross-sectional data. in contrast to ordinary bayesian networks, cbns assign probabilities of zero to genotypes that are not compatible with the partial temporal order modelled by the cbn. inference of cbns is usually done by maximum-likelihood (ml) estimation. learning the structure of a cbn from observed data is difficult in the presence of observation error and simulated annealing has been used for this task, but assessing the confidence of the estimates is problematic. it has been proposed to derive confidence values from the change in likelihood when removing edges or from bootstrapping the data and refitting the model. however, these approaches have several caveats. (i) there is no a priori optimal strategy for parametrization of the simulated annealing scheme; (ii) proper convergence analysis (i.e. stopping) of the simulated annealing algorithm is difficult and (iii) confidence assessment of discrete structure estimates based on bootstrapping is difficult to interpret. assessing the confidence of the graph component of probabilistic cancer progression models is particularly important, because the structure of the graph is interpreted as the set of possible mutational pathways. the concern about stability has been reinforced by ml-based simulation studies of mixture models of oncogeentic trees that have shown that the structure of these models can be to whom correspondence should be addressed. estimated reliably only for fairly simple structures . adopting a bayesian perspective, one can get access to the full posterior distribution over all cbn models and hence the uncertainty of their inference and their intrinsic variability. however, application of standard structure sampling schemes is impractical for bayesian networks as they suffer from very slow mixing and convergence . introduction of more sophisticated versions of the basic structure space move types, including a reverse edge move, has been demonstrated to improve mixing and convergence . however, the reverse edge move cannot be expected to result in the same improvements for cbns, because cbns are specialized bayesian networks with the property that each directed acyclic graph (dag) defines a unique set of distributions, i.e. a unique equivalence class. for example, unlike for general bayesian networks, the graphs a ! b and b ! a do not define equivalent cbns. reversing an edge is therefore a much more severe alteration in a cbn. in section 2, we derive the model and describe an mcmc algorithm designed to overcome local optima induced by dependency structures. we validate the sampler on simulated data, compare our proposed algorithm to a more basic standard structure move-based sampler and finally reanalyze real-world cancer datasets in section 3.first, we demonstrate the behaviour of our sampling scheme on simulated data. we then show the performance increase of our sampler over a standard structure move sampler. finally, we reanalyze real-world cancer datasets in order to demonstrate the increase of interpretability.in this work, we have presented a novel bayesian inference scheme for cbns, a probabilistic-graphical model of cancer progression that can be estimated from cross-sectional noisy genotype observations. we have developed an efficient mcmc sampling algorithm using a set of moves specifically designed to overcome local optima of dependency structures. the priors we used in our bayesian approach are either non-informative or flat. alternative priors can be used if one wants to introduce more prior biological knowledge, for example, about mutation probabilities, genotype calling errorsfor specific experimental setups or certain order relations that have been found independently. for practical purposes, our method is currently capable of handling up to $ 15 loci on a standard pc, where the actual run time depends critically on the number of compatible genotypes which are marginalized out equation (3). thus, the more closely the partial order dependency structure resembles a linear order, the smaller is the set of compatible genotypes and the faster can the marginal probability of the observed data be computed. in order to reduce the potentially large number of cancer driver mutations, one may apply filtering techniques based, for example, on marginal frequencies, on pairwise correlations or on more sophisticated methods for separating driver from passenger mutations. there is increasing evidence that rather than genewise, cancer progression may be more appropriately described on the level of functional pathways. the exact definition of these pathways is ongoing research, but initial studies suggest a small number of cancer-specific pathways on the order of a dozen . the new move types introduced here can be applied to variations of the cbn model, including the continuous time cbn , which models waiting times of mutations and the isotonic cbn (i-cbn) , which models monotonic progression along a continuous phenotype. we expect that the new move types we added for dealing with local optima of cbns, especially the moves operating on the transitive closure, may also be useful for other types of bayesian networks where the directions of all edges can be unambiguously assigned. bayesian cbns are more appropriate for predictive usage than their ml counterparts, since one can reliably assess the confidence of the inferred dependencies as well as the associated mutation probabilities. drug development and treatment strategies that aim at blocking or hindering cancer progression by targeting certain mutation dependencies may benefit from increased interpretability of confidence assessments. for example, cancer genotypes are used for survival prediction and cbns have been shown to significantly boost the performance of these predictions . the reasonfor this improvement is that in predictions for individual patients, strength is borrowed from common features of cancer progression (such as order constraints) that can be learned by cbns. using the bayesian cbn approach introduced here, one can account for model uncertainty in such predictions, for example, using bayesian estimation of the cox model. with international consortia such as tcga or icgc producing more and more whole cancer genome screens as well as next-generation sequencing moving into clinical diagnostics, the need for reliable and predictive modelling of genetic progression is growing. we anticipate that our sampling scheme will help to further advance the understanding of cancer progression.  
