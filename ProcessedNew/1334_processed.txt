designing robust watermark barcodes for multiplex long-read sequencing motivation: to attain acceptable sample misassignment rates, current approaches to multiplex single-molecule real-time sequencing require upstream quality improvement, which is obtained from multiple passes over the sequenced insert and significantly reduces the effective read length. in order to fully exploit the raw read length on multiplex applications, robust barcodes capable of dealing with the full single-pass error rates are needed. results: we present a method for designing sequencing barcodes that can withstand a large number of insertion, deletion and substitution errors and are suitable for use in multiplex single-molecule real-time sequencing. the manuscript focuses on the design of barcodes for full-length single-pass reads, impaired by challenging error rates in the order of 11. the proposed barcodes can multiplex hundreds or thousands of samples while achieving sample misassignment probabilities as low as 10 7 under the above conditions, and are designed to be compatible with chemical constraints imposed by the sequencing process. availability and implementation: software tools for constructing watermark barcode sets and demultiplexing barcoded reads, together with example sets of barcodes and synthetic barcoded reads, are freely available at www.cifasis-conicet.gov.ar/ezpeleta/ns-watermark.single-molecule real-time (smrt) sequencing, with average read lengths of $10 kbp , is poised to remarkably simplify genome assembly and targeted sequencing in many applications . in this new era, dna reads are considerably longer, but unfortunately corrupted by unusually high rates of sequencing errors. for smrt sequencing, error rates of $11 , with a predominance of insertions/deletions (indels) and only $1 substitution errors , must be considered. fortunately, in any information transmission process affected by noisein this case smrt sequencingerrors can be corrected by adding enough redundancy to transmitted informationin this case dna sequences. the simplest way to add redundancy is to transmit multiple copies of the information in the hope that it will be possible to recover the original data through some form of consensus. this is, for example, the rationale behind genome oversampling or coverage, which is used across sequencing technologies to obtain virtually error-free sequences from noisy reads. we will see, however, that this approach cannot be directly applied to parallel multiplex smrt sequencing without sacrificing the much desirable read length. multiplex sequencing relies on the use of short oligonucleotides, known as barcodes, to tag dna fragments belonging to different samples, which provides a means for translating the massive throughput of next-generation sequencing (ngs) technologies into reduced sequencing costs. barcodes are sequenced and identified to assign each read to a sample, which is known as demultiplexing. a variant of smrt sequencing called circular consensus sequencing (ccs), which provides more accurate reads, is generally advised for smrt multiplex applications . in this variant, smrt reads of improved quality are generated from intramolecular consensus over subreads obtained from multiple (! 2) polymerase passes along a circularized sequencing template, which follows the repetition approach described above. with ccs, however, the length of native reads is reduced by a factor equal to the number of polymerase passes. to attain illumina-level quality values, about five passes are needed and the effective read length drops to a few kilobases . for the longer read length afforded by smrt sequencing to be fully leveraged, multiplexing would need to work directly with single-pass reads, known as continuous long reads (clrs). in this scenario, all error correction would depend on redundancy embedded in the barcodes themselves. however, it has been noted that current barcodes for smrt-ccs reads, with lengths below 20 nt, are not sufficiently robust and that longer barcodes would be needed for this purpose . this comes as no surprise, since most existing smrt-ccs barcodes are obtained by imposing a minimum edit distance constraint to sets of random sequences , a design method known to scale poorly with increasing barcode length . to overcome the limitations of random barcodes in general multiplex smrt sequencing applications, systematic barcodes can be alternatively explored. recently, watermark barcodes, a class of systematic barcodes able to deal with sequencing indels and substitutions, have been proposed by. these are inspired in the design of watermark error correcting codes , originally developed to deal with synchronization and substitution errors in digital communications. in these applications, synchronization errors are modeled as the random insertion and deletion of symbols , and are thus assimilable to sequencing indels. briefly, watermark codes consist of an information-containing carrier sequence imprinted with an arbitrary but fixed sequence of equal length, known as watermark. in the original formulation of watermark codes, the carrier sequence is sparse, meaning it contains a majority of null or zero symbols (i.e. symbols which, when imprinted withor added toanother, will not modify it, much like zero in regular arithmetic). to obtain this carrier sequence, an information message is protected by a tandem of two error correcting codes, known as outer and inner code. both of these embed redundancy in the form of additional symbols, so that the resulting sequence is considerably longer than the original message. for example, one of a set of 48 dna samples, which in principle requires only three bases (4 3 64 ! 48), might be represented by a carrier of, say, 16 symbols, most of the null type. when the watermark is imprinted over the carrier, the sparse constraint implies that the resulting sequence will match the watermark at most positions. since the watermark is known to the decoder, this similarity provides a means to maintain synchronization in the presence of random insertions and deletions. substitution errors which remain after achieving synchronization are dealt with through regular error correction, making use of available redundancy. although watermark barcodes appear promising, their practical design for sequencing applications remains an open problem: for smrt-clr sequencing error rates, even the best barcodes reported byyield sample misassignment rates in the vicinity of 5. in this paper, we revisit the design of dna barcodes around the watermark concept. as opposed to, we consider short low-density parity check (ldpc) codes as outer codes, which offer the interesting possibility of discarding very noisy reads rather than risk erroneous decoding. in addition, as our main contribution, the key watermarkcarrier imprinting that conveys resilience to challenging insertion and deletion errors is modified so that non-sparse carriers are now allowed. this is accomplished by introducing a non-sparse inner code and an appropriate decoding algorithm adapted from, and is shown to significantly improve multiplexing performance. further, we propose an algorithm that leverages knowledge about the chemical context where the barcodes are embedded to detect their boundaries. finally, we show that the number of barcodes which are chemically suitable for use on the sequencing platform can be increased by exploiting the arbitrariness of the watermark. together, these design enhancements define the flexible class of non-sparse watermark (ns-watermark) barcodes, which offer high multiplexing capacity and are sufficiently robust for use in smrt-clr sequencing applications.  
