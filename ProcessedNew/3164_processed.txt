data and text mining multi-profile bayesian alignment model for lc-ms data analysis with integration of internal standards motivation: liquid chromatography-mass spectrometry (lc-ms) has been widely used for profiling expression levels of biomolecules in various -omic studies including proteomics, metabolomics and gly-comics. appropriate lc-ms data preprocessing steps are needed to detect true differences between biological groups. retention time (rt) alignment, which is required to ensure that ion intensity measurements among multiple lc-ms runs are comparable, is one of the most important yet challenging preprocessing steps. current alignment approaches estimate rt variability using either single chromatograms or detected peaks, but do not simultaneously take into account the complementary information embedded in the entire lc-ms data. results: we propose a bayesian alignment model for lc-ms data analysis. the alignment model provides estimates of the rt variability along with uncertainty measures. the model enables integration of multiple sources of information including internal standards and clustered chromatograms in a mathematically rigorous framework. we apply the model to lc-ms metabolomic, proteomic and glycomic data. the performance of the model is evaluated based on ground-truth data, by measuring correlation of variation, rt difference across runs and peak-matching performance. we demonstrate that bayesian alignment model improves significantly the rt alignment performance through appropriate integration of relevant information. availability and implementation: matlab code, raw and prepro-cessed lc-ms data are available atliquid chromatography-mass spectrometry (lc-ms) has been an indispensable tool in various -omic studies including proteomics, metabolomics and glycomics . each lc-ms run generates data consisting of thousands of ion intensities characterized by their specific retention time (rt) and mass-to-charge ratio (m/z) values, thus enabling comprehensive profiling of a variety of biomolecules. this high-throughput technique is widely applied to identify candidate markers whose expression levels change between groups of distinct biological conditions . to ensure an unbiased comparison of the ion intensities, several preprocessing steps including peak detection, rt alignment, peak matching and normalization need to be appropriately handled . typically, these preprocessing steps generate a list of detected peaks with their rts, m/z values and intensities, which are subsequently analyzed using statistical tests to identify significant differences in ion intensities. one crucial step is the correct matching of unique peaks across multiple lc-ms runs. with the advances in mass spectrometry technology, it is now possible to achieve highly precise and accurate mass measurement . however, controlling the chromatographic variability is still a challenging task. this often results in substantial variation in rt across multiple lc-ms runs, raising significant challenges in the preprocessing pipeline. without appropriate correction of rt, the peak-matching step is error-prone, and the subsequent analysis may yield misleading results. alignment methods can be categorized as (i) feature-based approaches and (ii) profile-based approaches . most current approaches perform rt alignment and peak matching based on a set of peaks identified upfront. the two steps are either carried out sequentially or combined into a unified module . the feature-based approaches rely on the correct identification of a set of consensus peaks across lc-ms runs. however, this consensus list cannot be adequately determined based on unaligned data. this, in turn, will affect the alignment results due to erroneously matched peaks. in addition, the results are highly dependent on the method used for peak detection, the prioritization of the detected peaks based on their quality and the handling of missing peaks . moreover, estimation of rt variation is limited to only a subset of time points, which is usually not as accurate as considering the whole chromatograms, as done in the to whom correspondence should be addressed. profile-based approaches . profile-based approaches accomplish this by considering a prototype function that represents the underlying pattern across the observed chromatograms, and estimating a set of mapping functions that characterize the relationship between the prototype function and the chromatograms. appropriate utilization of the whole chromatogram allows improved estimation of the rt variation characterized by the mapping functions. however, this requires that a representative prototype function be reliably selected or estimated, which is still a challenging task for the majority of profile-based approaches using pairwise time-warping techniques. we previously proposed a profile-based method that uses single ion chromatogram (e.g. base peak chromatogram) to estimate both prototype and mapping functions for rt alignment . the method has been shown to have better performance than other profilebased methods. however, there were unresolved issues including the following: (i) lack of integration of informative prior knowledge, e.g. internal standards, and (ii) implicit assumption of the existence of an underlying pattern based on a single ion chromatogram. in the present work, we propose a bayesian alignment model (bam) to address the aforementioned issues. bam combines the strength of both feature-based and profile-based approaches by incorporating comprehensive information such as multiple representative chromatograms and internal standards. the use of multiple chromatograms is considered in a few studies, by either binning the lc-ms data or using all the extracted ion chromatograms with acceptable quality . however, a suitable procedure to use multiple representative chromatograms while retaining computational feasibility is currently not available. we propose a clustering approach to identify multiple representative chromatograms from each lc-ms run. the chromatograms are simultaneously considered in the profile-based alignment to facilitate the estimation of the prototype and mapping functions. moreover, we incorporate gaussian process (gp) regression to estimate the rt variation, based on the peaks of internal standards. the use of internal standards enables a high-confidence estimation of rt variations, which avoids the ambiguity in identifying consensus peaks encountered in the feature-based approaches. the inferred information is used as the prior of the mapping function for profile-based alignment. the integration of internal standards proceeds through weighing uncertainty measures of the regression estimate. information on internal standards affects the posterior estimation via the gp prior, rather than just providing an initial estimate of the mapping function. this is in contrast to existing methods that rely on internal standards merely as landmarks and do not use them for further adjustment . we apply bam to lc-ms metabolomic, proteomic and glycomic data. a consensus list of the ground-truth data is used to evaluate the rt difference across runs, the coefficient of variation (cv) of extracted ion chromatograms and the peakmatching performance in terms of precision and recall. the simultaneous multiple alignment (sima) model , which has shown outstanding performance for the benchmark datasets in, is used to perform the peakmatching step. the remainder of this article is organized as follows. section 2 introduces the proposed profile-based bam, including the specification of a gp prior that uses information from internal standards, and the chromatographic clustering approach to perform multi-profile alignment. section 3 describes lc-ms datasets from metabolomic, proteomic and glycomic studies. section 4 demonstrates the application of bam on these datasets. finally, section 5 concludes the article with a summary and possible extensions in future work.we evaluate the alignment results based on the consensus list of the ground-truth data. specifically, we compare the rt difference across lc-ms runs, the cv of extracted ion chromatograms and the peak-matching performance. the rt difference measures the difference between the largest and smallest rts for a consensus peak. the cv evaluates the variability across chromatograms. the peak-matching performance is evaluated through precision and recall of the peak-matching results against the ground-truth data, as defined inand provided in the supplementary material. the sima model is used for the peak-matching step. internal standards are not included in the evaluation, as they are directly used in the alignment process. for confirmation purpose, we provide the alignment result in the supplementary material. as there is no information about internal standards in the metabolomic dataset, the gp prior was not applied in this dataset, and only sp alignment was performed. the prior of the mapping function coefficients i in this case is specified via a slope value, and it is assumed to follow a normal distribution with mean ! i, j1 and variance 2 ! truncated below by 0. means (standard deviations) of the rt difference and cv values are compared based on the 1169 ground-truth peaks, where the rt values are in seconds. rt differences before and after alignment are 5.87 (3.16) and 3.86 (3.33), respectively, and cv values before and after alignment are 0.544 (0.120) and 0.474 (0.126), respectively. although the rt alignment leads to a reduction of both rt difference and cv values, the peakmatching performance evaluated by (precision, recall) is barely improved, i.e. (0.826, 0.970) before alignment and (0.826, 0.971) after alignment. this is partly owing to the fact that rt variation is relatively small in this dataset. in addition, as the ground-truth data were generated based on ion annotation, further examination of the data is needed. more details and discussion are provided in the supplementary material.summarizes the results in the lc-ms proteomic and glycomic datasets, for the following procedures: no alignment performed to adjust the peak lists (raw), alignment performed using a gp regression as defined in equation (2), sp alignment performed with no information about internal standards, sp alignment performed with a gp prior (gpsp) and multi-profile alignment performed (four chromatograms identified by the clustering procedure of section 2.3) with a gp prior (gpmp). each procedure was followed by a peak-matching step using sima. most current lc-ms preprocessing pipelines do not adjust the peak lists detected upfront (raw) and directly apply a peakmatching procedure. sp alignment represents the current profile-based models including our earlier study , where a single chromatogram is considered without using any information about internal standards. when chromatographic patterns are well captured by the base peak chromatogram, as in the proteomic dataset, the sp approach yields reasonable alignment result. integration of internal standards (gpsp) and(a) (in this article, we propose a bam for lc-ms data analysis. bam improves on existing alignment methods by (i) using gp prior derived from internal standards and (ii) considering multiprofile modeling with representative chromatograms identified by a clustering approach. application of the method to various lc-ms datasets shows that the proposed alignment approach greatly facilitates the subsequent peak-matching process by appropriate utilization of available information, which is often overlooked by current methods. although this article focuses on using internal standards to derive the gp prior, it is also possible to specify the gp prior for the mapping relationship based on the identification of ms/ms spectra or targeted compounds.the alignment model proposed here considers underlying patterns for lc-ms runs in samples drawn from the same biological group. when samples arise from different biological subgroups, the model needs to be extended to account for the heterogeneity across these subgroups. future work will focus on developing a unified approach that allows the simultaneous alignment of samples from multiple biological groups to ensure coherence in the processing step and data comparability. the lc-ms raw data, the preprocessed peak lists and the ground-truth data used in this article have all been made publicly available to serve as a benchmark for the evaluation of new preprocessing methods.note: precision and recall are compared between cases where g chromatograms (g 2,. .. , 5) are derived either by binning along m/z or using the chromatographic clustering procedure.  
