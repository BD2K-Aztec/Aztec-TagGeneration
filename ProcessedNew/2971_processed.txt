minfi: a flexible and comprehensive bioconductor package for the analysis of infinium dna methylation microarrays motivation: the recently released infinium humanmethylation450 array (the 450k array) provides a high-throughput assay to quantify dna methylation (dnam) at 450 000 loci across a range of genomic features. although less comprehensive than high-throughput sequen-cing-based techniques, this product is more cost-effective and promises to be the most widely used dnam high-throughput measurement technology over the next several years. results: here we describe a suite of computational tools that incorporate state-of-the-art statistical techniques for the analysis of dnam data. the software is structured to easily adapt to future versions of the technology. we include methods for preprocessing, quality assessment and detection of differentially methylated regions from the kilobase to the megabase scale. we show how our software provides a powerful and flexible development platform for future methods. we also illustrate how our methods empower the technology to make discoveries previously thought to be possible only with sequencing-based methods. availability and implementation:dna methylation (dnam) is a chemical modification of dna that plays a key role in regulating gene expression. epigenetic mechanisms, including dnam, allow a single genome to give rise to hundreds of phenotypically diverse cell types. in addition to its importance in normal development, dnam is thought to play an important role in diseases when dysregulated. chemically, dnam involves the addition of a methyl group to a cytosine base (c), forming methylcytosine. in adult mammalian cells, this modification occurs almost exclusively at cs immediately followed by a g in the 5 0 3 0 direction, denoted by cpg. cpgs are depleted in mammalian genomes and those that remain tend to cluster in regions termed cpg islands (gardiner) that are enriched near gene promoters. the health implications of deciphering the dnam code have recently received much attention . dnam is best understood in the context of cancer biology, where it is clear that aberrant gains and losses of dnam almost universally accompany the initiation and progression of tumors . much of the excitement surrounding epigenetics relates to the promise of therapies that reverse disease-associated epigenetic alterations, thereby activating or silencing aberrantly expressed diseaserelated genes. as a result of dnams role in developmental and disease biology, there is great interest in measuring dnam at a comprehensive genomic scale. although next-generation sequencing technologies offer several promising new approaches , currently, illumina infinium arrays are the most widely used technology for this purpose. for example, the cancer genome atlas (tcga) project is using this array and has already processed 46000 samples (as of) and made the data publicly available (http://cancergenome.nih. gov/). furthermore, large cohort studies are becoming interested in measuring methylation and are expected to use cost-effective arrays with some studies already published . this work introduces a software development framework for the analysis of illumina infinium methylation arrays. although the design is general, the current version of our software focuses on the illumina infinium humanmethylation450 bead array (the 450k array), their most recent product. this array has been extensively described , but we include a to whom correspondence should be addressed.short description here for completeness. the two-color array interrogates the methylation status of 485 512 methylation loci (mostly cpg sites, but a small number of cytosines outside of the cpg context are also present), using bisulfite-converted dna. for each methylation locus, two signals of interest are recorded. one signal measures the amount of methylated dna (meth), and the other signal measures the amount of unmethylated dna (unmeth). in principle, the proportion meth/ (unmeth meth) is the methylation ratio (referred to as beta value by illuminas software) in the population of cells from which we extract dna. the methylation ratio, or its logit transform, is the quantity used in downstream analysis. in the scientific literature related to the 450k platform, logittransformed beta values are referred to as m-values. the meth and unmeth signals do not relate to the green and red channels in a straightforward way. the 450k platform includes two different methylation assay designs, referred to as infinium i and infinium ii, or type i and type ii. each methylation locus is interrogated by one of these designs. for a type i locus, the meth and unmeth signals are measured by two paired probes, with a given locus using either the red or green signal from these probes. type ii loci are assayed using a single probe, with meth and unmeth signals derived from the green and red channels, respectively. in addition to the methylation loci, the array contains a small number of control probes and 65 probes measuring common single-nucleotide polymorphisms (snps), intended for sample tracking. the reasoning behind using two different probe designs is simple, but illuminating for potential developers. type ii probes use only one probe per methylation locus and hence allow more loci on the array, at a fixed array size. however, owing to the chemistry used by the type ii probe design, type ii probes can only tolerate up to three cpgs within the 50-bp probe. the type i design tolerates more cpgs within the 50-bp probe, but assumes that all methylation loci in the probed sequence are in the same state, i.e. the probe measuring meth assumes all cpgs within the probed sequence to be methylated, and the probe measuring unmeth assumes all cpgs in the probed sequence are unmethylated. the ability to tolerate more cpgs in the probe allows type i probes to be used in regions of high cpg density, such as cpg islands (cgi). until recently, studies of dnam have focused largely on cgi. for example, the illumina products that preceded the 450k included the widely used infinium 27k array exclusively targeted cgi, primarily at gene promoters. however,, using a noncgi-centric array design, referred to as comprehensive arrays for relative methylation (charm), demonstrated that greater variability is present in regions outside cgi and coined the term cgi shores for regions within 2 kb of cgi. the 450k array design includes a set of regions identified as tissue-or cancer-specific using charm data, including cgis and cgi shores, as well as probes in other regions, which illumina refers to as shelf and open sea . here we present a software suite containing an assortment of new functionality for the analysis of this array, but also containing an infrastructure useful as a development platform for the research community. we note that subset-quantile within array normalization (swan) , one of the first alternative preprocessing methods, was developed by another group using our infrastructure. among the tools developed by our group, we specifically describe bump hunting and block finding capabilities. although current data analyses for these arrays have relied on single probe analysis , we have previously pointed out the advantages of borrowing strength across neighboring loci . furthermore, a recent finding related to cancer was the observation of large genomic [101000 kb] hypomethylated blocks . we introduce an approach that permits the discovery of hypo-and hypermethylated blocks with 450k data. we illustrate the advantages of our software with publicly available data.we have demonstrated several downstream advantages of using the minfi package. several preprocessing algorithms are available and the infrastructure provides a convenient way for developers to easily implement their techniques as bioconductor tools. in our experience, 510 of samples are of unusable quality, and visualization utilities provided by minfi permit users to identify these samples at the earliest stage of the analysis. by making snp annotation available, users can choose to be cautious about probes that may behave unexpectedly due to the inclusion of a snp in the probe sequence. we have demonstrated that degs are more likely to be located near dmrs than cpgs identified by single probe analysis. existing methods for identifying dmrs typically use fixed-size or dynamic windows to group individually significant dmps into regions (http://www2.cancer.ucl.ac. uk/medicalgenomics/champ/). our software is unique in that it provides both bump hunting and block finding capabilities, and the assessment of statistical significance for the identified regions. finally, because the package is implemented in bioconductor, it gives users access to the countless analysis and visualization tools available in r.  
