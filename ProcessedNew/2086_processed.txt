gene expression go-bayes: gene ontology-based overrepresentation analysis using a bayesian approach motivation: a typical approach for the interpretation of high-throughput experiments, such as gene expression microarrays, is to produce groups of genes based on certain criteria (e.g. genes that are differentially expressed). to gain more mechanistic insights into the underlying biology, overrepresentation analysis (ora) is often conducted to investigate whether gene sets associated with particular biological functions, for example, as represented by gene ontology (go) annotations, are statistically overrepresented in the identified gene groups. however, the standard ora, which is based on the hypergeometric test, analyzes each go term in isolation and does not take into account the dependence structure of the go-term hierarchy. results: we have developed a bayesian approach (go-bayes) to measure overrepresentation of go terms that incorporates the go dependence structure by taking into account evidence not only from individual go terms, but also from their related terms (i.e. parents, children, siblings, etc.). the bayesian framework borrows information across related go terms to strengthen the detection of overrepresentation signals. as a result, this method tends to identify sets of closely related go terms rather than individual isolated go terms. the advantage of the go-bayes approach is demonstrated with a simulation study and an application example. contact:in typical high-throughput experiments, such as gene expression microarrays, the first step in the analysis of the results is often to produce groups of genes based on certain criteria (e.g. genes that are differentially expressed). to gain more mechanistic insights into the underlying biology, overrepresentation analysis (ora) is conducted to use the knowledge of the functional characteristics of the genes to investigate whether gene sets associated with particular biological functions are overrepresented in the identified gene groups. draghiciis the first paper to discuss the overrepresentation to whom correspondence should be addressed. problem and propose different statistical methods that can be used in this area. ora is based on the postulate that if a biological process has more identified genes than expected by chance alone, that biological process is probably linked to the experiment. one of the most popular gene description databases used in ora was developed by the gene ontology (go) consortium . each go term annotates a set of genes, indicating their known molecular functions, involvement in biological processes and cellular component locations. go terms are structured in a directed acyclic graph (dag) of parentchild relationship, where a child indicates a more specific biological classification than its parent(s). based on the true-path rule the annotation of a gene to a go term implies automatic annotation to all the ancestors of that term. another feature is that a go term is allowed to have more than one parent nodes, a feature known as multiple inheritance. for example, immune response is not only a specific form of organismal movement but also a part of defense response. furthermore, some genes might be annotated by a parent go node but not by any of its children because less is known about that genes specific function. for a rigorous analysis, these dependency characteristics of the go dag need to be considered when developing statistical methods to detect overrepresentation of go annotations. in ora, the most commonly used statistical test is based on the hypergeometric distribution or its binomial approximation (; among others). let a denote a go term or the set of genes annotated to a (with cardinality i a ), and let s denote the set of genes (with cardinality i s ) based on a certain criterion (i.e. differential expression) from a full gene list g (with cardinality i) in an experiment. the number of genes belonging to both s and a (s a), denoted by n a , indicates the representation of a in s. under the null hypothesis that s and a are independent (i.e. the go term is irrelevant to the gene cluster), n a follows a hypergeometric distribution. the p-value measuring the significance of association is the tail probability of observing n a or more genes annotated by a in s,genemerge, funcassociate, gotree machine, etc.) have been developed based on the hypergeometric p-value. detailed review can be found in khatri and draghicidraghici (2005). the hypergeometric p-value provides a straightforward measure of overrepresentation for each individual go term. however, the major drawback of this approach is that it ignores the hierarchical structure in the go dag, which contains a substantial amount of information regarding the interactions among the go terms. we use an artificial dag to illustrate this issue. it consists of 25 nodes a j ,j = 1,...,25 , each denoted by a circle. let g = a,b,...,z denote the full list of genes, and 10 genes in s are marked in red. the rectangles contain the subset of genes annotated by each node, where (i a ,n a ) are listed under each rectangle.includes some important features of the go dag, such as multiple inheritance (e.g. a 14 and a 23 have two parent nodes) and that a gene might be annotated at different specific level (eg. gene k is annotated by a 2 , but not by any of its children: a 5 , a 6 and a 7 ). note that in this example s is overrepresented in the regions under a 2 , while underrepresented in the regions under a 3 and a 4. we report the hypergeometric p-values estimated by (1) in blue. first, given i and i s , go terms with the same (i a ,n a ) have exactly the same hypergeometric p-values. for example, with (i a ,n a ) = (2,2), the p-values for a 14 and a 24 are both 0.139. based on, a 14 is more likely to be linked with s because of the stronger evidence of overrepresentation in its neighboring nodes (related biological functions). using evidence only from individual terms, the hypergeometric p-value does not differentiate between a 14 and a 24. second, given i and i s , the hypergeometric p-value has a lower limit determined by i a , which is denoted as l(i a ). specifically, l(i a ) is achieved when n a = i a , i.e. the p-value reaches its lower limit when all the genes annotated by a are in s. the smaller the i a , the larger the l(i a). for example, we have l(3) = 0.046 as in a 12 and l(2) = 0.139 as in a 14. this observation suggests that if we set the threshold for the p-value at l(k), then the hypergeometric test could not identify any go terms with i a k. in ora, detecting more specific go terms, which usually have a relatively smaller i a , might be more desirable because they provide more detailed biological information. however, the hypergeometric test tends to identify less specific go terms because of the constraint of l(i a ). in, the most significant term selected by the p-value is a 2 , a term next to the root. the more specific terms that are associated with s (i.e. a 12 and a 14 ) are considered less significant compared with a 2. all of these issues essentially stem from the limitation of the hypergeometric test in treating the go terms as independent entities and ignoring their interrelated structure. recently some new methods have been proposed in ora. lewin andpropose to group closely related go nodes together and then compute a hypergeometric p-value for each group. in their approach, the graphical distance between nodes in the go dag is assumed to have some quantitative biological meaning.calculate the overrepresentation of a go term from leaf to root by downweighting the contribution of genes which are annotated by a child term that has been found to be significantly enriched.measure the overrepresentation of each go term relative to its parent(s). from root to leaf, their method computes the significance of overrepresentation for a go term conditional on the representation at the parent term(s). the last page: 907 905911in this article, we proposed go-bayes, a bayesian approach for go-based or. the model has a relatively simple format, with the first level as a logistic regression model and straightforward prior specification. the key innovation is that it can incorporate the dependence structure of the go dag on a global scale. the resulting measure on the association between go terms and selected genes borrows information across related go terms to strengthen the detection of overrepresentation signals. we have given detailed comparison between the go-bayes approach and the hypergeometric test, which is widely used in ora. our analysis using an artificial dataset and a real microarray dataset suggests that the go-bayes approach can produce more biologically meaningful results than the hypergeometric test. relying on individual go terms, the hypergeometric p-value has a closed form, which only requires the information on i, i s and (i a ,n a ) for each go term. go-bayes, on the other hand, does not have a closed form and it needs the information on the structure of the go dag. we have developed a program in c to implement the go-bayes approach. for the b-cell lymphoma cell line example in the application section, the b-score calculations were completed in 10 min on a mac (os x 10.4.11, 1.83 ghz intel core duo processor) computer. the program is available upon request from s.z. the go-bayes measure, r j p( j 0 y), is the posterior probability of a go term being positively associated with s. as a reviewer pointed out, r j behaves like a frequentist p-value under the null hypothesis , and a frequentisttype estimator of false discovery rate can be employed to assess the statistical significance. currently, the proposed method is based on binary outcomes (membership of genes in s). we are working on generalizing the go-bayes approach to cases with ordinal or continuous outcomes. although we have focused on the use of this approach  
