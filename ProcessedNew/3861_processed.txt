sequence analysis rainbow: an integrated tool for efficient clustering and assembling rad-seq reads motivation: the innovation of restriction-site associated dna sequen-cing (rad-seq) method takes full advantage of next-generation sequencing technology. by clustering paired-end short reads into groups with their own unique tags, rad-seq assembly problem is divided into subproblems. fast and accurately clustering and assembling millions of rad-seq reads with sequencing errors, different levels of heterozygosity and repetitive sequences is a challenging question. results: rainbow is developed to provide an ultra-fast and memory-efficient solution to clustering and assembling short reads produced by rad-seq. first, rainbow clusters reads using a spaced seed method. then, rainbow implements a heterozygote calling like strategy to divide potential groups into haplotypes in a topdown manner. and along a guided tree, it iteratively merges sibling leaves in a bottomup manner if they are similar enough. here, the similarity is defined by comparing the 2nd reads of a rad segment. this approach tries to collapse heterozygote while discriminate repetitive sequences. at last, rainbow uses a greedy algorithm to locally assemble merged reads into contigs. rainbow not only outputs the optimal but also suboptimal assembly results. based on simulation and a real guppy rad-seq data, we show that rainbow is more competent than the other tools in dealing with rad-seq data. availability: source code in c, rainbow is freely available at http:// sourceforge.net/projects/bio-rainbow/files/ contact:genetic markers are polymorphic dna sequences distributed along the chromosomes. they are important for studying population genetics, molecular evolution and inherited diseases. traditionally, genetic markers include restriction fragment length polymorphisms, simple sequence length polymorphisms, amplified fragment length polymorphisms, microsatellite polymorphisms, single-nucleotide polymorphisms (snps), short tandem repeats, etc. (http://en.wikipedia.org/wiki/genetic_ marker). the development of these genetic markers is usually a costly, laborious and time-consuming work and could not easily be parallelized . the advent of next-generation sequencing (ngs) technology enables sequencing many millions of reads with plummeting cost. methods for discovering and genotyping genetic markers based on ngs are rapidly springing up. these include reduced-representation libraries, complexity reduction of polymorphic sequences (crops) and restriction site associated dna sequencing (rad-seq); for a good review of these methods, see. they are very useful for population genetic/genomic studies, especially when the reference genomes are unknown. rad-seq could generate a genome-wide density of genetic markers, suggesting a broader application than the other methods. rad method was initially invented by michael miller (, b) using microarrays. then, high-throughput rad-seq was developed as an efficient method to identify genetic markers . rad-seq has been successfully used to discovery snps and study adaptive evolution in the stickback , to resolve genetic structure and direction of evolution in the pitcher plant mosquitoes , to infer phylogenies and to study interesting traits of butterfly (the heliconius). as illustrated in, the protocol of rad-seq can be summarized as first digesting the genomic dnas using restriction enzymes (res), then the digested restriction fragments are randomly sheared into staggered sequences and sizes suitable for sequencing, e.g. on illumina genome analyzer platform, are selected and amplified using pcr and last by sequencing the ends of selected segments, rad-seq data are ready for downstream analysis . the sequenced ends near the restriction site are called rad tags or tagged reads and the other ends are 2nd ends. at a particular restriction site, the tagged reads contain identical information. thus, by grouping the rad tagged reads and local assembling of the corresponding ends (2nd reads), contiguous sequences of $600 bp (limited by the insert size of library of the sequencing platform) that represent parts of the genome are generated. moreover, the tagged reads can be barcoded, enabling pooled individuals are sequenced in a single reaction. for examples,to whom correspondence should be addressed. y the authors wish it to be known that, in their opinion, the first two authors should be regarded as joint first authors. andused an enzyme to digest the genomic dnas of stickleback and guppy, and by locally assembling rad tags, they tried to identify snps and define putative haplotypes in populations. although these methods show potential application for local assembly and downstream population genomic and molecular evolution analysis, it lacks an efficient and integrated tool to fulfill the prerequisite clustering the identical tagged reads and local assembly work. we show here that clustering is the most critical and challenging problem, in that the number of reads to be clustered is huge and they may contain sequencing errors. in addition, the levels of heterozygosity and/or repetitive sequences may be high. a direct hashing method could quickly group the tagged reads but cannot tolerate the inherent sequencing errors. pairwise alignment for all short reads could overcome this weakness, but the cost of computation is extremely high. to avoid the cost of pairwise alignments, heuristic methods that filter out unnecessary comparison of distant sequences are introduced. these methods include cd-hit , uclust and dnaclust . all these tools employ a similar k-mer based method, i.e. the sequences are represented as a table containing the number of the occurrence of all substrings of length k, and insufficient k-mer number between two sequences will not be compared . they are developed for general clustering analysis, but may not be well suitable for ngs data. recently, seed used a block spaced seed approach to fast clustering ngs reads while tolerating up to three mismatches. it demonstrated the potential usefulness of spaced seed method for clustering huge amounts of next-generation short reads. another set of algorithms such as vmatch and bwa using suffix array to index sequences first, and by backtracking in the indexed structure, similarity between reads can be obtained.developed an exact algorithm slidesort, which used a recursive pattern growth method to find chains of k-mers and arbitrary edit distance could be calculated. however, these methods may not solve the rad-seq clustering problem properly. first, the customized similarity threshold is subtle. a higher level of mismatches could collapse too many similar sequences into one cluster, which could cause wrong assembly and will overestimate the diversity of the species. a lower level of mismatches splits one cluster into many smaller ones, which will generate redundant contigs or cannot be correctly assembled because of too few reads could be used. one goal in rad-seq is to collapse heterozygote while distinguish repeats. second, these methods can use the information of only the tagged reads, while the 2nd ends are deserted. the tagged reads usually consist of barcode, re site and the rad tag. barcodes and re sites and/or low-quality sequence at the tail must be removed before clustering. although ngs reads are evolving longer and longer, the total length for clustering is limited. given the paired-end reads of rad-seq, should we use both of the ends, which indeed uses longer sequence information. third, they are either not time efficient or not space efficient and combining with other tools to proceed subsequent analysis might be tough for biologists who are new to bioinformatics. to achieve these goals, we demonstrate a package called rainbow, which uses a spaced seed hashing method for primary clustering, a heterozygote calling strategy for further dividing clusters, a bottomup merging module using paired-end information of rad-seq and a greedy assembly method for local assembly all at one time. rainbow can quickly and accurately cluster and assemble the tagged reads and their 2nd ends with a low footprint of memory.in this article, we present rainbow as an efficient and general tool for rad-seq short reads clustering and assembling. it could quickly group and assemble millions of short reads with a small memory footprint. in addition, it could tolerate a highheterozygous genome. in particular, by using the topdown dividing and bottomup merging procedures, we can collapse heterozygote while distinguish repetitive sequences. we have shown that it performs well both on simulation data and real data. rad-seq is a developing field and intriguing the interests of more and more people. as the evolution of ngs technology, we believe rad-seq will improve a lot and become more important for biological research. in the future, we will improve rainbow in the following aspects. first, to improve the accuracy of clustering, base quality will also be incorporated into the dividing procedure. besides, to be compatible with more applications, we will add a seed shifting strategy that seed proposed to deal with overhanging bases, which could rescue reads due to irregular cuts. third, although rad-seq is mainly performed on the illumina genome analyzer, the rapid evolving rad-seq technology might spread to other platforms. we will prepare to let rainbow support more platforms.  
