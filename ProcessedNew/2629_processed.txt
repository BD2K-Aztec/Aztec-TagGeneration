sequence analysis kalignp: improved multiple sequence alignments using position specific gap penalties in kalign2 kalign2 is one of the fastest and most accurate methods for multiple alignments. however, in contrast to other methods kalign2 does not allow externally supplied position specific gap penalties. here, we present a modification to kalign2, kalignp, so that it accepts such penalties. further, we show that kalignp using position specific gap penalties obtained from predicted secondary structures makes steady improvement over kalign2 when tested on balibase 3.0 as well as on a dataset derived from pfam-a seed alignments. availability and implementation: kalignp is freely available atthe alignment of multiple sequences is essential for many tasks in sequence analysis, e.g. protein structure and function prediction, similarity search and phylogenetic analysis . due to the importance of multiple sequence alignment (msa) in a variety of biological applications, a number of programs have been developed. three aspects are usually considered when developing an msa program, the alignment accuracy, the computational speed and the memory usage. kalign2 is one of the fastest msa methods, and still the alignment accuracy is comparable to many of the slower methods. moreover, it produces high quality alignments consistently when aligning large number of sequences, i.e. kalign2 is well suited for msa tasks in large-scale genome analysis. however, in contrast to other methods such as clustalw , kalign2 does not allow externally supplied position specific gap penalties (espsgp).showed that gaps occur far more often between major secondary structure elements than within. also gaps are much more frequent in disordered regions of proteins. for integral transmembrane (tm) proteins, residues are more conserved at tm regions and few gaps are allowed within . to whom correspondence should be addressed. further, the inclusion of espsgp allows some inclusion of expertise knowledge into the alignment procedure. here, we introduce kalignp as a modified version of kalign2 that accepts espsgp. unlike clustalw, where espsgp is only applicable to profile alignments, kalignp incorporates espsgp into sequences and forward them to the full progressive alignment.we benchmarked kalignp using gap penalties from predicted secondary structure with other methods on balibase 3.0. kalignp outperformed kalign2 on all five reference-sets . the results were evaluated by sp (sum-of-pairs) score and tc (total columns) score . sp score is the sum of scores of the projected pairwise alignments and tc score is the sum of scores of each column for a multiple alignment. the4.51e-5 and 0.0167 for sp and tc scores, respectively, with the alternative hypothesis that true difference in the means of kalign2 and kalignp is less than 0. the paired t-test was performed by r. here, kalignp were optimized on balibase 3.0 using a 3-fold crossvalidation (see supplementary material). the largest improvement was made on rv50 (for proteins with insertions) where kalignp made a 2.0 improvement for sp score and 2.4 for tc score (see supplementary). only two methods in the benchmark outperformed kalignp, t_coffee and probcons but these methods are much slower. note that the speed of kalignp for alignment alone is comparable to kalign2. however, including the time for secondary structure prediction and espsgp calculation it is slower but still comparable to). kalignp made a steady improvement on the alignment of tm proteins as well. as shown in the benchmark on ref7 (for tm proteins) of balibase 3.0, kalignp outperformed kalign2 by 1.6 for sp score and 1.8 for tc score . however, the significance of the improvement as shown by the t-test is not strong (p-values are 0.0623 and 0.278 for sp and tc scores, respectively). this is most likely because the sample size is too small. the balibase 3.0 ref7 contains only eight alignments and the results for kalignp were obtained by optimizing parameters on all these alignments. therefore, over-training might be an issue here. to test the robustness of kalignp on the alignment of tm proteins, we created another reference dataset pfama-mem which was derived from pfam-a (version 24.0) seed alignments and filtered by matching the key word transmembrane in the de record. the same parameters optimized from ref7 were used to test these 51 alignments in pfama-mem (see supplementaryfor a list of these 51 pfam-a alignments). a similar improvement of kalignp over kalign2 was obtained . the p-values for paired t-test are 2.75e-4 and 3.85e-3 for sp and tc scores, respectively.  
