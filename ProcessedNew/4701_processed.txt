genome analysis totalrecaller: improved accuracy and performance via integrated alignment and base-calling motivation: currently, re-sequencing approaches use multiple modules serially to interpret raw sequencing data from next-generation sequencing platforms, while remaining oblivious to the genomic information until the final alignment step. such approaches fail to exploit the full information from both raw sequencing data and the reference genome that can yield better quality sequence reads, snp-calls, variant detection, as well as an alignment at the best possible location in the reference genome. thus, there is a need for novel reference-guided bioinformatics algorithms for interpreting analog signals representing sequences of the bases (a,c,g,t ), while simultaneously aligning possible sequence reads to a source reference genome whenever available. results: here, we propose a new base-calling algorithm, totalre-caller, to achieve improved performance. a linear error model for the raw intensity data and burrowswheeler transform (bwt) based alignment are combined utilizing a bayesian score function, which is then globally optimized over all possible genomic locations using an efficient branch-and-bound approach. the algorithm has been implemented in soft-and hardware [field-programmable gate array (fpga)] to achieve real-time performance. empirical results on real high-throughput illumina data were used to evaluate totalrecallers performance relative to its peersbustard, bayescall, ibis and rolexabased on several criteria, particularly those important in clinical and scientific applications. namely, it was evaluated for (i) its base-calling speed and throughput, (ii) its read accuracy and (iii) its specificity and sensitivity in variant calling.recent advances in sequencing technology continue to introduce novel and diverse high-throughput dna sequencing platforms, such as illumina. these innovations, promise to revolutionize biological, biomedical and translational research by rapidly transferring genomics breakthroughs from the byte banks to bedside. for any large-scale genomic sequencing effort aiming to fulfill these goals, to whom correspondence should be addressed. an important and rate-limiting initial step involves base-calling, which is now assuming an even more critical role, especially for these new (next-and next-next-generation) sequencing platforms. when the source genome references are available, the sequencereads obtained by the base-caller is next subjected to alignment (followed by variant-caller) procedures successivelyalthough, in principle, all three steps could be carried out in one integrated step while promising improvements in accuracy, computational complexity, data storage and transmission. base-calling takes the vector analog time series of signals generated by the sequencing machines as input, and produces a base-by-base digitized estimate of the underlying dna sequence that is most likely to have given rise to those signals. although the next-generation sequencing technologies listed above have reduced the cost and increased the throughput, these platforms pose new challenges for base-calling, as their technology is based on either relatively small number of unsynchronized molecules (e.g. illumina, 454 life science, ion torrent, solid) or single molecules with weak signal (e.g. pacific biosciences, oxford nanopore, helicos, life technologies). as a consequence, these platforms are not only error prone, they also corrupt signals in the data by non-stationary errors and generate much shorter reads than what is needed for both proper alignment and sequence assembly, as well as what used to be routinely possible with the traditional sanger sequencers. motivated by such challenges, novel base-calling frameworks have been proposed to deal with many unknown sources of noise in these data. these methods have already demonstrated that considerable improvement both in quality and read length is possible through sophisticated signal processing methods such as statistical learning , supervised learning and support vector machine (svm) , and model-based clustering and information theory . however, in doing so, these methods also expose base-calling to several other limitations. (i) over-fitting: parametric models (e.g. alta-cyclic, ibis, bayescall, rolexa) are likely to suffer from overfitting to the in-sample data and thus are unlikely to be very robust in dealing with varying out-of-sample datasets, even from the same sequencing platforms. (ii) computational cost: in a preprocessing step, all base-callers must learn the error model in the training data in order to build a classifier that then corrects the errors in the signal. this preprocessing step can be very time consuming (as in the case of bayescall, alta-cyclic and ibis) and may require a cluster computer facility (as in the case of alta-cyclic), thus preventing them from real-time base-calling, as would be neededtraining phase: since a subclass of these base-callers (e.g. alta-cyclic, ibis) needs a training phase using a library of correct reads, they require both a secondary basecaller and a sequence aligner to get started with the training library. on the contrary, this concern has been somewhat alleviated in the newer base-callers (e.g. bustard, bayescall), which estimate their parameters solely from intensity files. (iv) technology dependent: many base-callers (e.g. alta-cyclic, ibis and bayescall) use a detailed parametric model to describe the signal distortion as a function of successive cycles. such models require and hard-wire specific knowledge of the underlying sequencing technology into the algorithm, thus making it harder to customize the base-caller to support other platforms. currently, a major application of the next-generation sequencing technologies is in re-sequencing (e.g. dnaseq: dna sequencing with known reference source genome; rnaseq: mrna sequencing with known gene isoforms; chipseq: chromatin immunoprecipitation sequencing with known binding sites). despite the obvious centrality of alignment in these applications, traditional base-callers have avoided performing alignment until the end of the base-calling process; in fact, the typical pipeline for a re-sequencing process traditionally consists of two sequential steps:(1) base-calling: each single base of the read is called according to the intensity signal and error profiles.(2) alignment: sequence reads are aligned to a reference genome.because the base-calling process is error prone, and because correct alignment to the reference genome is non-trivial, high coverage is required in order to reduce the errors in re-sequencing and recover the true full dna sequence. to perform the alignment to the reference genome, the standard smithwaterman approach (or some variations of it) may seem appropriate. note that the smith waterman was developed in the context of homology analysis, is based on dynamic programming and thus requires its score function for evaluating the alignment quality to satisfy the principle of optimality . this algorithm [as well as others in this framework starting with needlemanwunsch, ] is based on certain markovian/stationarity assumptions that give rise to additive and affine score functions, which, while fine in the context of evolutionary analysis, are not necessarily valid in the alignment applications for current and future sequencing technologies. even worse, smithwaterman or needlemanwunsch algorithms are considered too impractical computationally, and are only used for local alignment after few plausible initial seed locations are determined using blast-or bwt-like heuristic aligners (thus adding to the false negatives). motivated by the limitations of current base-callers and the challenges of re-sequencing, we have designed a new basecaller, totalrecaller, which attempts to ameliorate the problems discussed above and significantly improves the quality of reads by injecting knowledge of the reference genome into the base-calling step. in this article, we present a framework (with its theoretical underpinnings) that replaces the typical sequential re-sequencing protocol into a combined pipeline that has the ability to concurrently perform base-calling, alignment and snp detection. it is important to. the statistics for high and low intensity levels depicted with their means and sds for four channelsone for each base b a,c,g,t , shown clockwise. a high intensity level(with a value above a threshold) in one of the channels indicates that this base should be called at a given cycle. a low intensity level(below threshold) in a channel means that this base should not be called at a given cycle. in a good set of intensities, it is expected that one channel is higher than a threshold, while all other three are lower than it. the panels depict that in later cycles the low and high intensities become increasingly indistinguishable, which causes erroneous base-calling for distal positions. emphasize that, since base-calling and alignment in totalrecaller are performed concurrently with the help of a reference genome, the generated reads could be biased toward the available genome. for this purpose, the trade-off analysis between snps sensitivity and specificity is also addressed in the article. while, for illustrative purposes, this article specifically addresses base-calling for the illumina platform, our method is, in principle, applicable to any other sequencing technology. adaptation to a different sequencing platform only requires redesigned score functions encapsulating error correction and alignmentand, thus, accommodating the different features and error profiles of the variant system in a technology-agnostic manner.including the base-caller introduced in this article, currently there are six base-callers for illumina sequencing machines: totalrecaller , bustard (illumina), alta-cyclic, bayescall, ibis [max. in the following, we compare the performance of these base-callers 1 according to the same metrics that have been used in the literature: namely, base-calling error rate, alignment rate and base-calling speed. since totalrecaller utilizes a reference genome for base-calling, base-calling statistics from datasets of three different organisms (with reference genomes of varying qualities) were analyzed . furthermore, basecalling results of totalrecaller are presented with different weights on reference alignment with respect to intensity information. finally, we conclude this section with detailed statistics on totalrecallers snp sensitivity and specificity, as they would be the most important in many clinical applications.this article introduces a new base-caller, totalrecaller, which opens new avenues for reducing errors significantly in  
