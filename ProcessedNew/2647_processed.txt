sequence analysis kmacs: the k-mismatch average common substring approach to alignment-free sequence comparison motivation: alignment-based methods for sequence analysis have various limitations if large datasets are to be analysed. therefore, alignment-free approaches have become popular in recent years. one of the best known alignment-free methods is the average common substring approach that defines a distance measure on sequences based on the average length of longest common words between them. herein, we generalize this approach by considering longest common substrings with k mismatches. we present a greedy heuristic to approximate the length of such k-mismatch substrings, and we describe kmacs, an efficient implementation of this idea based on generalized enhanced suffix arrays. results: to evaluate the performance of our approach, we applied it to phylogeny reconstruction using a large number of dna and protein sequence sets. in most cases, phylogenetic trees calculated with kmacs were more accurate than trees produced with established alignment-free methods that are based on exact word matches. especially on protein sequences, our method seems to be superior. on simulated protein families, kmacs even outper-formed a classical approach to phylogeny reconstruction using multiple alignment and maximum likelihood. availability and implementation: kmacs is implemented in c++, and the source code is freely available atcomparative sequence analysis traditionally relies on pairwise or multiple sequence alignment. with the huge datasets that are produced by next-generation sequencing technologies, however, todays alignment algorithms reach their limits. thus, with the growing number of completely or partially sequenced genomes, there is an urgent demand for faster sequence-comparison methods. over the past two decades, a wide variety of alignment-free approaches were proposed . although aligning two sequences takes time proportional to the product of their lengths, most alignment-free methods run in linear time. they are, therefore, increasingly used for genome-based phylogeny reconstruction and for large-scale protein sequence comparison. it is known, however, that alignment-free methods are generally less accurate than alignment-based approaches. most alignment-free methods calculate the relative frequencies of words of a fixed length k, also called k-mers, in the input sequences. other methods are based on variable-length matches; they have the advantage that it is not necessary to specify a fixed word length . these programs achieve usually better results than approaches relying on a fixed word length. however, algorithms using variable word lengths are typically more complex and require more sophisticated data structures than methods relying on fixed word lengths. a well-known approach that uses word matches of variable length is the average common substring (acs) method , which calculates for each position i in one sequence the length of the longest substring starting at i and matching some substring of a second sequence. as a further development of this idea, the shortest unique substring (shustring) approach has been proposed by. these authors also derived an estimator for the number of substitutions per site between two unaligned sequences based on the average shustring length; they implemented this approach in the program k r . acs and shustrings can be calculated efficiently using suffix trees . as the aforementioned methods, most approaches for alignment-free phylogeny reconstruction are based on exact word matches. recently, we suggested to use spaced-k-mers defined by pre-defined patterns of match and dont care symbols, instead of contiguous k-mers . the aim of this study is to apply the idea of inexact matches to word matches of varying lengths. we generalize the acs approach by considering, for each position i in one sequence, the longest substring starting at i and matching some substring in the second sequence with k mismatches. we propose an efficient heuristic to approximate the lengths of these substrings, and we describe kmacs, an implementation of this approach based on generalized enhanced suffix arrays. a web server for our program is described into whom correspondence should be addressed. the author 2014. published by oxford university press. all rights reserved. this is an open access article distributed under the terms of the creative commons attribution license (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.most alignment-free approaches to sequence analysis are based on exact word matches. in this article, we presented a novel alignment-free algorithm that takes mismatches into account. this is similar in spirit to the spaced-words approach that we previously proposed . but while spaced words uses word pairs of a fixed length with possible mismatches at pre-defined positions, kmacs considers maximal substring matches with k mismatches at arbitrary positions. in the spaced-words approach, the number of match positions in the underlying patterns is a critical parameter for the performance of the method. in contrast, in kmacs, there seems to be a fairly large range of values for k that lead to high-quality results, as shown by our test results. kmacs seems therefore less sensitive to user-defined parameters. the implementation of our approach using generalized enhanced suffix arrays enables us to analyse large sequence sets efficiently. still, the program k r is roughly one order of magnitude faster than kmacs. one reason for this is that k r uses one single generalized suffix tree representing all input sequences, which can be calculated in time proportional to the number of sequences (domazet-lo so and). in contrast, kmacs calculates one generalized enhanced suffix array for each pair of sequences, so its run time is quadratic in the number of sequences. on the other hand, calculating suffix arrays for two sequences at a time is less memory consuming, as one does not need to keep the suffix array for all input sequences simultaneously in main memory. thus, our approach can be applied to larger datasets than k r. the two approaches that we developed, kmacs and spaced words, are slower than the corresponding approaches based on exact matches, acs and the generic k-mer approach. our new approaches, however, produce significantly better results than those established methods. our test results suggest that spaced words performs slightly better than kmacs on genomic sequences, whereas on protein sequences, kmacs is superior. in our program evaluation, we used dna sequence sets with large evolutionary distances. on these sequences, our new alignment-free methods performed better than established methods that rely on exact word matches. algorithms using exact matches, on the other hand, seem to work better on smaller evolutionary distances. k r , for example, performs best on evolutionary distances of up to 0.6 substitutions per site . similarly, we observed that on closely related dna sequences, kmacs produces sometimes best results with k = 0, i.e. without mismatches (unpublished results). it seems therefore best to apply kmacs to distantly related sequence sets, while methods such as k r and acs may be preferred on evolutionarily more closely related sequences. in biological sequences, substitutions are more frequent than insertions and deletions. consequently, exact matches between local homologies can usually be extended until the first substitution is reached. the average length of longest common substrings and of shortest unique substrings, respectively, can therefore be used to estimate substitution probabilities . this is similar for kmacs as long as k is small enough. in this case, all k mismatches are likely to be used up in a k-mismatch common substring extension before the first indel occurs. thus, the average length of the longest k-mismatch common substrings depends on the frequency of mismatches and could be used to estimate substitution probabilities, just as in k r. in contrast, if k is sufficiently large, substring matches between local homologies are essentially extended until the first indel occurs. from this point on, the mismatch frequency is high and the remaining mismatches will be used up quickly. so in this situation, the average k-mismatch substring length depends on the frequency of indels rather than on the frequency of substitutions. this may explain why acs and k r work well on closely related sequences, while kmacs is superior on distantly related sequences where the frequency of indels may be a better measure for evolutionary distances than the frequency of mismatches. in our study, we used alignment-free methods to reconstruct phylogenetic trees and evaluated the quality of these trees. but phylogeny reconstruction is only one important application of sequence comparison. clustering, classification and remotehomology detection are other fundamental challenges in dna and protein sequence analysis. with the rapidly growing size of sequence databases, alignment-free methods have become indispensable for these tasks . given the speed of. average common k-mismatch substring lengths depending on the substitution frequency in simulated dna sequences, estimated with our greedy heuristic (lower curve) and calculated with an exact algorithm (upper curve) for various values of k. average number z of maximal exact matches starting at a position i in one sequence to a substring in a second sequence. we used simulated dna sequences with different lengths and substitution frequencies  
