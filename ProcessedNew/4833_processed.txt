utilizing the jaccard index to reveal population stratification in sequencing data: a simulation study and an application to the 1000 genomes project motivation: population stratification is one of the major sources of confounding in genetic association studies, potentially causing false-positive and false-negative results. here, we present a novel approach for the identification of population substructure in high-density genotyping data/next generation sequencing data. the approach exploits the co-appearances of rare genetic variants in individuals. the method can be applied to all available genetic loci and is computationally fast. using sequencing data from the 1000 genomes project, the features of the approach are illustrated and compared to existing methodology (i.e. eigenstrat). we examine the effects of different cutoffs for the minor allele frequency on the performance of the approach. we find that our approach works particularly well for genetic loci with very small minor allele frequencies. the results suggest that the inclusion of rare-variant data/sequencing data in our approach provides a much higher resolution picture of population substructure than it can be obtained with existing methodology. furthermore, in simulation studies, we find scenarios where our method was able to control the type 1 error more precisely and showed higher power. availability and implementation: contact: dmitry.prokopenko@uni-bonn.dein genetic association studies, the importance of population substructure/admixture and its potentially negative impact on the analysis results have long been recognized. numerous methods have been designed to detect population substructure and adjust genetic association analysis. so far, almost all methods implicitly assumed that the) extract the information about population substructure from the variance/covariance matrix of genotype data. the approaches have been shown to be efficient and are able to guard genetic association analysis under most circumstances. with the arrival of next-generation sequencing data, rare variants, i.e. genetic loci with small minor allele frequencies, are moving to the center of the genetic association analysis. the hypothesis is that rare variant/sequencing data will enable the direct identification of disease susceptibility loci, which genome-wide association studies have not been very successful at. although availability of rare variant/sequence analysis holds great promise, the effects of population substructure/ admixture on the association analysis of rare variants are unclear and suitable adjustment methods have not been discussed widely in the literature . the effectiveness of existing adjustment approaches which are mostly built on the estimation of the genetic variance/covariance matrix is unclear for rare variants, since the estimation of the allelic covariance based on rare variants might not provide sufficient power. this expected power loss can be attributed to the low variance of rare variant genotypes and thus the covariance matrix can be unreliable for small allele frequencies, e.g. it is suggested to use snps with common allele frequencies for the eigenstrat approach. moreover, the key feature of rare variant data in terms of population substructure is that such variants are genetically much younger . the mutations that originated rare variants have occurred much more recently than those of common variants, allowing rare variant data to reflect even relatively new admixture/substructure. it is therefore unclear whether the application of adjustment methods, when they are computed based on common variants, is a suitable way to control for population substructure/admixture in rare-variant analysis. in this article, we propose a method that is designed to detect population substructure/admixture both in rare variant data and in common variant data. instead of utilizing the genetic variance/covariance matrix, the jaccard similarity index is used. among existing similarity measures, the jaccard similarity index is most suitable for the similarity calculation based on sparse binary data, since it emphasizes mutual presences of minor alleles. in comparison to identity-by-state similarity measure the jaccard index has the advantage that it doesnt account for snps where a pair of individuals shares a 0 genotype, which is very efficient in a sparse dataset with only rare variants. we recommend, when available, to exclude potentially associated variants from the population structure estimation. if no such information is available, we recommend to include all rare variants in the analysis. in fact, rare variants typically do not show strong linkage disequilibrium with other rare or common variants. this is particularly due to their low minor allele frequencies . if the sample size is marginal and the sample contains only variants with very small allele frequency, excluding some long-range ld regions can reduce the resolution of population structure. however, if the jaccard index is applied to common variants, we recommend to apply ld-pruning on the common variants prior to analysis. the approach has the advantage that it can be applied to all available genetic loci and it is computationally fast. we have implemented a c program, which takes the genotype matrix and the position file as input and produces the jaccard similarity matrix between individuals. the application to the complete dataset of the 1000 genomes project (2504 individuals, 31 202 510 variants with maf 0.01) on one processor with 2 gb ram running under linux took only 8 h. first, we assess the performance of our approach by application to the 1000 genomes project phase 3 data. a comparison of the results with existing methodology suggests that our approach provides better discrimination between subpopulations than current methodology. the approach seems to work particularly well, when we restricted the method to rare variant loci. in simulation studies, we evaluate the type-1 error of our approach and compare it to eigenstrat, which uses pca based on the genetic covariance matrix. for completeness we include in the simulation studies a model-based method admixture , which uses a likelihood model to estimate population structure. under different scenarios, the proposed methodology preserves the type-1 error much better.next generation sequencing data is becoming highly available and numerous methods have been developed to study the association of variants with low minor allele frequencies with complex traits . however, the fact that rare variants might represent different patterns of population stratification is currently underestimated. recently, several consortia (1000 genomes, uk10k) showed that variants with a very low minor allele frequency often cluster within one population. those variants might represent younger population-specific mutations and, hence, can be utilized for population structure correction in rare variant tests. we propose an approach for the detection of population substructure in sequencing data that utilizes the information about co-appearances of the minor alleles between individuals. the attractive features of the approach are its computational speed and its capability to expose population substructure with higher resolution within sequence data than standard methodology. it requires no removal of long-range ld regions, when the dataset contains only rare variants. the approach can be seen as a modification of the eigenstrat approach in which the genetic covariance matrix is replaced by the jaccard similarity matrix. consequently, existing methodology can be used to guard association tests against confounding due to population substructure. for example, the principal components based on the jaccard similarity matrix can be included into the association analysis as covariates , or into the conditional sampling approach for rare variant analysis . several studies assessed the population structure in rare variants by applying standard pca, based on genetic covariance data. zhang et al. showed that including multiple classical pcs based on variants with low minor allele frequency might lead to power loss (overestimation) in association analysis. they also showed that classical pca, when applied to variants with maf 1 is sensitive to outliers and hence isnt effective in separating subpopulations. we confirm this in, left panel. here the second pc is driven by the largest variance of the sparse individual genotypes based on rare variants. our method based on jaccard similarity matrix was specifically designed to detect population stratification based on variants with small minor allele frequencies. we can see that due to sparsity of datasets with rare variants standard covariance-based methods fail to detect population structure. given the imminent arrival of large-scale whole genome sequencing (wgs) studies, there is a urgent need for methods that account for population structure in datasets with rare variants. we evaluated our approach by simulation studies and by application to the 1000 genomes project data. our empirical evidence based on the application to the 1000 genomes project data and simulation studies suggests that the proposed methodology provides a finer resolution picture of population substructure than existing methodology. the simulation studies show that our method is able to achieve equal or higher power in most of the simulated scenarios, while maintaining the type 1 error under the nominal level. overall, our method did not lose the power, when increasing the number of principal components, included in the analysis, in comparison the classical pca. this is an important feature for real data analysis with big sample sizes.  
