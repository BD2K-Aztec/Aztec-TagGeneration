the virtual fly brain browser and query interface motivation: sources of neuroscience data in drosophila are diverse and disparate making integrated search and retrieval difficult. a major obstacle to this is the lack of a comprehensive and logically structured anatomical framework and an intuitive interface. results: we present an online resource that provides a convenient way to study and query fly brain anatomy, expression and genetic data. we extended the newly developed brainname nomenclature for the adult fly brain into a logically structured ontology that relates a comprehensive set of published neuron classes to the brain regions they innervate. the virtual fly brain interface allows users to explore the structure of the drosophila brain by browsing 3d images of a brain with subregions displayed as coloured overlays. an integrated query mechanism allows complex searches of underlying anatomy, cells, expression and other data from community databases. availability: virtual fly brain is freely available online at www. virtualflybrain.org contact:with its relatively simple architecture and unparalleled level of genetic tractability, the brain of drosophila is an ideal model for fundamental neuroscience research. however, in practice, navigating the drosophila neurobiology literature and the various community databases is a real challenge. the literatures long history and diversity have resulted in a variety of often-conflicting terminologies. information about useful research reagents is scattered across a number of databases that are not interoperable and rarely even cross-referenced. consequently, finding, for example, data about the connectivity between two brain regions, or where genes are expressed or what resources exist is an arduous and difficult task. to realize the value of the scientific investment in drosophila neuroscience, the community requires a robust anatomical framework with the supporting data structures and computational tools to exploit it. the first challenge is to agree on a common framework for gross anatomy. this has been addressed, for the first time by the brainname consortium, who proposed a revised nomenclature for the insect brain (k.submitted for to whom correspondence should be addressed. publication) with each term defined both textually and as a volume in a reference drosophila brain. next we need to be able to construct and solve useful searches and integrate data from disparate sources. using the web ontology language owl 2 (http://www.w3.org/tr/owl2-primer/), it is possible to store complex relationships between terms and, with the help of reasoning software, to use those relationships to automate classification and drive queries. for example, the relationship between a class of neurons and a structure that it innervates can provide both a substrate for useful queries (what neurons innervate region x) and a criterion for classification (all neurons in class a innervate some region x). an ontology also provides a mechanism for common annotation of neuroanatomical data, allowing easy integration of data from disparate resources. aligned serial images, such as those from confocal microscopy, are a key tool for visualizing anatomical structures or regions of gene expression in the drosophila nervous system [e.g. (. demarcation (or painting) of known neuropil domains on top of such image stacks provides a powerful tool for research and study of the brain structure . processing and viewing such data locally can be done using graphics software such as amira or imagej/fiji . there are also powerful specialist desktop-based systems for interactively exploring the drosophila nervous system in 3d . however, such datasets are also large and viewing them requires high-specification workstation hardware and a lot of storage rather than commodity computing. another characteristic of such image data is that it is expensive to produce and therefore its sharing and distribution is of paramount importance. obviously sharing such bulky data imposes serious requirements on data storage and data transfer bandwidth. the ideal way of distributing and sharing image data is via web interfaces. most existing projects in the community use ad hoc solutions such as downsized, pre-compiled quicktime movies or representative reconstructions [e.g. flytrap ; braintrap (. some of the more recent solutions also provide interactive 3d browsing functions such as volume rotationalthough the reduction of resolution from raw dataset to that observed on the browser still remains an issue. to more fully exploit these 3d images, mechanisms are required to display the boundaries and extent of defined structures, such  
