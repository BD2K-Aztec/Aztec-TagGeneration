two-pass alignment improves novel splice junction quantification motivation: discovery of novel splicing from rna sequence data remains a critical and exciting focus of transcriptomics, but reduced alignment power impedes expression quantification of novel splice junctions. results: here, we profile performance characteristics of two-pass alignment, which separates splice junction discovery from quantification. per sample, across a variety of transcriptome sequencing data-sets, two-pass alignment improved quantification of at least 94 of simulated novel splice junctions, and provided as much as 1.7-fold deeper median read depth over those splice junctions. we further demonstrate that two-pass alignment works by increasing alignment of reads to splice junctions by short lengths, and that potential alignment errors are readily identifiable by simple classification. taken together , two-pass alignment promises to advance quantification and discovery of novel splicing events. contact:since the first successful application of short read sequencing to cdna in 2008, broad uptake has proven rna-seq an indispensable tool in the arsenal of molecular biology . however, for as long as it has existed, analysis of rna-seq data has been complicated by consequences of the gapped nature of rna . briefly, when rna is transcribed from dna, putative functional sequences (exons) are interspersed with sequences which are later removed (introns). because exons originate from noncontiguous genomic contexts, separated by varying distances, the primary challenge in ascribing rna sequences to their genomic origins is gapped alignment, for which many good tools have been developed . these aligners typically support the use of annotated gene references, which facilitate alignment to known splice junctions, while maintaining the ability to discover novel splice junctions. this approach has the implicit effect of requiring greater evidence for reads spliced over novel splice junctions compared with known splice junctions, and is implemented either by aligning in multiple stages as in tophat, or by varying alignment scores for different splice junction classes as in star (spliced transcripts alignment to a reference) . in all such tools, preference is given to knownsplice junctions, which reduces noise but biases quantification against novel splice junctions. two-pass alignment, a framework in which splice junctions are separately discovered and quantified, has recently gained traction owing largely to massive speed enhancements achieved by new aligners, which make aligning twice computationally feasible . the rationale behind two-pass alignment is elegant: splice junctions are discovered in a first alignment pass with high stringency, and are used as annotation in a second pass to permit lower stringency alignment, and therefore higher sensitivity. in the absence of annotation, compared to traditional single-pass alignment, an independent analysis demonstrated that two-pass alignment with star provides comparable mapping rates (though more multimapping), similar mismatch alignment rates, reduced read truncation, superior read placement accuracy, comparable indel accuracy, improved splice junction recall, and better annotated splice junction detection, with comparable discovery of true novel splice junctions at the cost of more false positive discoveries . while the effects of two-pass alignment on transcript assembly and transcript quantification have also been investigated, our primary interest is in splice junction expression quantification, which is relevant to ascertaining the validity of discovered splice junctions, and has not yet been thoroughly investigated . in light of the evidence that two-pass alignment can improve alignment rate and sensitivity, we investigated what advantages and disadvantages this approach might yield for splice junction quantification . here, we describe for the first time several appealing performance characteristics of two-pass alignment. in an experiment in which known splice junctions are treated as unannotated, twopass alignment provided excellent quantification accuracy, and significantly more accurate quantification than single-pass alignment. underscoring the wide applicability of the technique, these quantification benefits were observed across a variety of rna-seq datasets, including arabidopsis samples. as a salient takeaway, this corresponded to as much as 1.7-fold median deeper read coverage over novel splice junctions. we go on to demonstrate that two-pass alignment works by permitting alignment of sequence reads by fewer nucleotides to splice junctions. finally, while we find that two-pass alignment can introduce alignment errors as previously suspected, we demonstrate that these are relatively simple to detect. in summary, two-pass alignment significantly improves quantification of novel splice junctions, and we recommend its use in studies concerned with novel splice junction discovery and quantification.. two-pass alignment flowchart. center and right, stepwise progression of two-pass alignment. first, the genome is indexed with gene annotation, here gencode-basic. next, novel splice junctions are discovered from rna sequencing data at a relatively high stringency (12 nt minimum spanning length). third, these discovered splice junctions, and expressed annotated splice junctions are used to re-index the genome. finally, alignment is performed a second time, quantifying novel and annotated splice junctions using the same, relatively lower stringency (3 nt minimum spanning length), producing splice junction expression. input files and their associated file formats are shown on the right. left, pictorial representation of individual steps, for an individual novel splice junction. exons are illustrated in gray, indexed splice junctions in black, individual sequence reads supporting a known and a novel splice junction in blue and red, and read counts (splice junction quantification) in blue and red boxes. alignment parameters are provided in the methods, and supplementarytukey boxplots of quantification improvement across splice junctions, per sample, are plotted in, and the percentage of splice junctions improved upon are provided in . summary statistics per sample, including the median increase in read depth between two de novo alignment passes, and percentage of splice junctions improved are depicted in . from these analyses, we observe that two-pass alignment provides much more accurate quantification of novel splice junctions than single-pass alignment. this is depicted qualitatively for one sample, the a549 cell line, inas the blue distributions deviation from 1.0, compared with the green distribution, and quantitatively as boxplots inas deviation from zero. as an example, the median quantification in a549 was approximately 80 of the gold standard (green distribution,), and correspondingly, two-pass alignment improved that quantification by about 20 (a549 boxplot center,). across the twelve samples tested, two-pass alignment achieved 1.12 to 1.71 higher coverage over novel splice junctions than single-pass alignment . similarly, two-pass alignment improved the quantification of between 94 and 99 of the splice junctions in each sample, over single-pass alignment . next, we ascertained the absolute quantification accuracy of de novo 2-pass alignment, again in comparison to. from this analysis, we observe that regardless of its relative improvement over one-pass alignment, two-pass alignment provides accurate novel splice junction quantification. across the twelve samples, two-pass alignment provided correct quantification (identical to annotation 1-pass) of at least 75 of splice junctions, and provided nearly correct quantification (within 5 accuracy) of at least 88 of splice junctions. we speculate that variability in the percentage of splice junctions quantified identically to the standard, versus those within 5, was mostly driven by the number of reads per sample-samples with twice as many reads were less likely to produce exactly identical counts (seefor read counts). instead of normalizing (e.g. read sampling) to eliminate this effect, here we present the accuracy across unadulterated samples. one interesting (albeit, unfortunate) result was that de novo two-pass alignment completely missed between 2 and 9 of splice junctions per sample . these splice junctions were also completely missed by de novo one-pass alignment (a549 example: read depth ratio 0,), meaning they were not lost in the second alignment pass, but we were still curious what might introduce difficulty in aligning to these splice junctions. first, we recognized that most missed splice junctions were low expressed, covered by only a few reads in the standard quantification (see supplementary figs s1s12, b panels), but some missed splice junctions did have high expected quantification. we therefore sorted the splice junctions by their standard quantification in descending order, and found a strong enrichment of at/ac, gc/ag, and non-canonical splice site motifs at the top of the list(supplementary). in particular, annotated at/ac and gc/ag splice-site containing splice junctions were most likely to be missed, followed by non-canonical splice sites. this result makes qualitative sense, given that star penalizes splice junctions with non-canonical splice sites, but the magnitude of the effect was greater than we anticipated. we further note that in practice, non-canonical annotated splice junctions can still be readily aligned to by use of annotation and arent damaged by two-pass alignment alone, as evidenced by the annotation 2-pass distribution in, which missed very little (read depth ratio 0).  
