gene expression a statistical framework for illumina dna methylation arrays motivation: the illumina beadarray is a popular platform for profiling dna methylation, an important epigenetic event associated with gene silencing and chromosomal instability. however, current approaches rely on an arbitrary detection p-value cutoff for excluding probes and samples from subsequent analysis as a quality control step, which results in missing observations and information loss. it is desirable to have an approach that incorporates the whole data, but accounts for the different quality of individual observations. results: we first investigate and propose a statistical framework for removing the source of biases in illumina methylation beadarray based on several positive control samples. we then introduce a weighted model-based clustering called lumiwcluster for illumina beadarray that weights each observation according to the detection p-values systematically and avoids discarding subsets of the data. lumiwcluster allows for discovery of distinct methylation patterns and automatic selection of informative cpg loci. we demonstrate the advantages of lumiwcluster on two publicly available illumina goldengate methylation datasets (ovarian cancer and hepatocellular carcinoma). availability: r package lumiwcluster can be downloaded fromdna methylation is an important epigenetic modification and plays critical roles in transcriptional regulation, chromosomal stability, genomic imprinting and x-inactivation . numerous literatures have established the influence of dna methylation in transcriptional aberrations in human diseases including various types of cancer . dna methylation occurs in cytosines of cpg dinucleotides in human in a non-random fashion across the genome. in particular, cpg-rich regions (known as cpg islands) are usually hypomethylated, whereas repetitive genomic sequences are hypermethylated in normal cells. over the past decade, there has been vast research in studying alterations of to whom correspondence should be addressed. dna methylation in cancer. a general observed trend of perturbed dna methylation includes hypomethylation of oncogenes and hypermethylation of tumor suppressor genes, leading to genomic instability and tumorigenesis . several platforms are available for dna methylation profiling that includes high-throughput arrays and more recently, the nextgeneration sequencing instruments. the experimental approaches in high-throughput array-based methylation include bisulfite conversion-based methods, restriction enzyme-based methods and immunoprecipitation-based methods . a popular robust methylation profiling platform via bisulfite conversion is the illumina goldengate and infinium methylation assays based on the beadarray technology. this technology utilizes 3 m silica beads which are replicated 30 times on the array and has emerged as an attractive platform for genotyping, expression and methylation analysis . this technology requires less sample input but produces high-quality data , thereby reducing the cost of array experiments. the increasing popularity of illumina beadarray technology is apparent given the numerous scientific publications since 2008. however, there is only a handful of statistical framework for analyzing illumina beadarray gene expression , and limited work is available for methylation array counterpart . existing work for gene expression beadarray falls into the categories of data preprocessing and differential expression detection. this includes background correction methods , variance-stabilizing techniques and modified test statistics for differential gene expression in illumina beadarray . most of the framework for gene expression analysis is based on the assumption that the majority of the genes are not differentially expressed. in contrast, many sites are expected to be methylated , and therefore the assumptions in gene expression are not applicable to methylation experiments. the goal of our article is to provide a statistical framework for arraybased methylation profiling on illumina beadarray technology, by studying the source of biases and the data-generating mechanism of illumina methylation assays. specifically, we propose a model for correcting the source of biases in illumina methylation beadarray and introduce a weighted model-based approach for clustering the methylation profiles. the framework of our weighted model-based clustering can also be directly applied to other illumina beadarray platforms, e.g. gene expression beadchip, because it does not rely on the assumption that most beads are from the null distribution of no differential expression. in the next section, we describe thepage: 2850 28492855methylation levels in illumina methylation assays are quantified by the beta value using the ratio of intensities between methylated (m) and unmethylated (u) alleles. specifically, beta = max(m,0) max(m,0)+max(u,0)+100 where m and u are the red and green dyes, respectively, for the goldengate and veracode methylation assays, whereas for infinium assay, m and u are signals a and b (produced by two different bead types and reported in the same color), respectively. the constant 100 is to regularize beta when both m and u values are small . the beta values are continuous and range from 0 (unmethylated) to 1 (completely methylated). each locus reports an average beta value obtained from the average of ms and us across approximately 30 bead replicates, and individual beadlevel measurements are not readily available . a standard summary output from beadstudio (illumina software to process raw intensities) includes four columns for each sample, i.e. (1) average beta, (2) average m, (3) average u and (4) detection p-values, for each locus. therefore, our proposed framework will be based on the average beta values for convenience. the detection p-value reported by beadstudio can be used as a quality control measure of probe performance. the detection p-value is defined as 1p-value computed from the background model characterizing the chance that the signal was distinguishable from negative controls (supplementary materials). standard protocol by illumina recommends excluding probes that have a detection p-value greater than an arbitrary cutoff of 0.05. on the other hand,excluded samples that consist of 25 observations with detection p-values 110 5 , as well as probes (cpg loci) with median detection p-values 0.05, whereas hernandezexcluded probes with detection p-values 0.01 in 10 of the samples. in section 3.2, we will introduce a modeling framework that avoids arbitrary choice of detection p-value threshold. we will now explore and illustrate the source of biases present in illumina methylation beadarray based on the data generated by the thomas-conway lab at unc-chapel hill. the methylation experiment is performed on the goldengate cancer panel i methylation panel, which interrogates 1505 cpg loci/probes associated with 803 cancer-related genes (tumor suppressor genes, oncogenes, genes involved in dna repair, cell-cycle control, differentiation, apoptosis, x-linked and imprinted genes) where 28.6 contain one cpg site per gene, 57.3 contain two cpg sites and 14.1 have three or more sites . the probe length varies between 41 bp and 59 bp with median 50 bp, whereas the number of cg dinucleotides for each probe varies between 1 and 7. a pair of allele-specific oligonucleotide (aso) and locusspecific oligonucleotide (lso) measures the methylation level of a specific cg dinucleotide for a probe under the assumption that flanking cg dinucleotides within the same probe exhibit similar methylation status. in other words, the observed methylation level for the measured cg dinucleotide should not be affected by the number of flanking cg dinucleotides. to investigate the potentialsource of biases in illumina methylation assays, we utilize six positive control samples from our dataset, in which all the cytosines in cg dinucleotides are expected to be methylated and any deviation from methylated status indicates the presence of technical biases. we apply quantile normalization to these six positive control samples.compare the pairwise correlations among these positive controls before and after normalization, respectively. both plots show the high correlations among the positive controls, with improvement after normalization. in addition, array-based technology are known to be affected by the sequence and thermodynamic properties, e.g. melting temperature and gc content in proteindna binding and gene expression experiments . in, we plot the quantile normalized average beta values pooled from all positive controls against probe length, number of cg dinucleotides within each probe, melting temperature and gc content. individual plots for each positive control sample are given in supplementary materials. melting temperature is computed according to, whereas gc content is the percentage of c and g nucleotides for a given probe. as evident from,the observed methylation level is influenced by the sequence and thermodynamics properties of the probes. sequence length bias in methylation array is also observed in. since melting temperature is a function of gc content and sequence length, and gc content is highly correlated with the number of cg dinucleotides, our modeling framework will incorporate sequence length and gc content. in gene expression and proteindna binding arrays, gc content exhibits increasing trend with intensities due to the three hydrogen bonds compared with two hydrogen bonds in at pairs. however, the decreasing trend observed in methylation arrays can be attributed to the loss of efficiency in binding for a probe with more cg dinucleotides, because the cg dinucleotides within a probe are expected to have similar methylation status. although cg dinucleotides yield a more straightforward interpretation, we choose gc content which has more distinct values for better function approximation.the delineation of dna methylation patterns is important in understanding how these epigenetic changes might lead to aberrant expression patterns and disease . advancements in biotechnology have enabled high-throughput profiling of dna methylation, including the illumina goldengate and infinium beadarray via bisulphite conversion. these platforms are robust, highly reproducible and require less starting materials. in the first part of this study, we illustrated the source of biases present in illumina methylation arrays and proposed a model for correcting these biases. a common approach in analyzing illumina methylation data includes omitting cpg loci and samples that exhibit detection p-values larger than an arbitrary cutoff. this hard thresholding step often results in missing observations and information loss by discarding a subset of probes. we proposed a weighted model-based approach called lumiwcluster that weights each cpg locus/sample by its detection p-values for clustering dna methylation profiles. in this article, we set the weights as the median detection p-values across samples (or cpg loci) which appears to perform well in the two case studies. optimal selection of weight functions is beyond the scope of this article and will be an interesting future research direction.  
