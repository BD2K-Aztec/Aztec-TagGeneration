exploring single-sample snp and indel calling with whole-genome de novo assembly motivation: eugene myers in his string graph paper suggested that in a string graph or equivalently a unitig graph, any path spells a valid assembly. as a string/unitig graph also encodes every valid assembly of reads, such a graph, provided that it can be constructed correctly, is in fact a lossless representation of reads. in principle, every analysis based on whole-genome shotgun sequencing (wgs) data, such as snp and insertion/deletion (indel) calling, can also be achieved with unitigs. results: to explore the feasibility of using de novo assembly in the context of resequencing, we developed a de novo assembler, fermi, that assembles illumina short reads into unitigs while preserving most of information of the input reads. snps and indels can be called by mapping the unitigs against a reference genome. by applying the method on 35-fold human resequencing data, we showed that in comparison to the standard pipeline, our approach yields similar accuracy for snp calling and better results for indel calling. it has higher sensitivity than other de novo assembly based methods for variant calling. our work suggests that variant calling with de novo assembly can be a beneficial complement to the standard variant calling pipeline for whole-genome resequencing. in the methodological aspects, we propose fmd-index for forward backward extension of dna sequences, a fast algorithm for finding all super-maximal exact matches and one-pass construction of unitigs from an fmd-index.the rapidly decreasing sequencing cost has enabled whole-genome shotgun (wgs) resequencing at an affordable price. many software packages have been developed to call variants, including snps, short insertions and deletions (indels) and structural variations (svs), from wgs data. at present, the standard approach to variant calling is to map raw sequence reads against a reference genome and then to detect differences from the reference. it is well established and has been proved to work from a single sample to thousands of samples (1000). nonetheless, a fundamental flaw in this mapping-based approach is that mapping algorithms ignore the correlation between sequence reads. they are unable to take full advantage of data and may produce inconsistent outputs which complicate variant calling. this flaw has gradually attracted the attention of various research groups who subsequently proposed several methods to alleviate the effect, including postalignment filtering , iterative mapping , read realignment and local assembly . however, because these methods still rely on the initial mapping, it is difficult for them to identify and recover mismapped or unmapped reads due to highsequence divergence, long insertions, svs, copy number changes or misassemblies of the reference genome. they have not solved the problem from the root. another distinct approach to variant calling that fundamentally avoids the flaw of the mapping-based approach is to assemble sequence reads into contigs and to discover variants via assembly-toassemby alignment. it was probably more widely used in the era of capillary sequencing. the assembly based method became less used since 2008 due to the great difficulties in assembling 25 bp reads, but with longer paired-end reads and improved methodology, de novo assembly is reborn as the preferred choice for variant discovery between small genomes. for variant discovery between human genomes, however, the assembly based approach has not attracted much attention. assembling a human genome is far more challenging than assembling a bacterial genome, firstly due to the sheer size of the genome, secondly to the rich repeats and thirdly due to the diploidy of the human genome. many heuristics effective for assembling small genomes are not directly applicable to the human genome assembly. as a result, only a few de novo assemblers have been applied on human short-read data. among them, abyss , soapdenovo and sga , as of now, do not explicitly output heterozygotes. although in theory it is possible to recover heterozygotes from their intermediate output, it may be difficult in practice as the assemblers may not distinguish heterozygotes from sequencing errors. cortex is specifically designed for retaining heterozygous variants in an assembly, but it may be missing heterozygotes. allpaths-lg also paid particular attention to keep heterozygotes, but it still has a relatively low sensitivity. in addition, allpaths-lg only works with reads from libraries with distinct insert size distributions and prefers read pairs with mean insert size below three times of the read length, whereas many resequencing projects do not meet these requirements and thus allpaths-lg may not be applied or work to the best performance. even if we also include de novo assemblers developed for capillary sequence reads, the version of the celera assembler used for assembling the huref genome is the only one that retains heterozygotes while capable of assembling a mammalian genome. at last, one may think to map sequence readswe evaluated fermi on 101 bp paired-end reads from na12878 . the total coverage of the original data is 70-fold, but we only used half of them. we assembled the 35-fold reads with fermi on a machine with 12 cpus and 96 gb memory in 5 days. the peak memory usage is 92 gb. we obtained unitigs of n50 1022 bp, totaling 3.83 gb. after collapsing most heterozygotes and closing gaps with paired-end reads, we got longer contigs . unitigs are short and redundant mainly because they break at heterozygotes. for snp and indel calling, we aligned unitigs to the reference genome using bwa-sw with command line options -b9-q16-r1-w500. we called snps with the samtools caller and called indels by directly counting indels from the pileup output. we did not run a standard indel caller as short-read indel callers do not work well with long contig sequences.  
