gene expression a computationally efficient modular optimal discovery procedure motivation: it is well known that patterns of differential gene expression across biological conditions are often shared by many genes, particularly those within functional groups. taking advantage of these patterns can lead to increased statistical power and biological clarity when testing for differential expression in a microarray experiment. the optimal discovery procedure (odp), which maximizes the expected number of true positives for each fixed number of expected false positives, is a framework aimed at this goal. storey et al. introduced an estimator of the odp for identifying differentially expressed genes. however, their odp estimator grows quadratically in computational time with respect to the number of genes. reducing this computational burden is a key step in making the odp practical for usage in a variety of high-throughput problems. results: here, we propose a new estimate of the odp called the modular odp (modp). the existing full odp requires that the likelihood function for each gene be evaluated according to the parameter estimates for all genes. the modp assigns genes to modules according to a kullbackleibler distance, and then evaluates the statistic only at the module-averaged parameter estimates. we show that the modp is relatively insensitive to the choice of the number of modules, but dramatically reduces the computational complexity from quadratic to linear in the number of genes. we compare the full odp algorithm and modp on simulated data and gene expression data from a recent study of morrocan amazighs. the modp and full odp algorithm perform very similarly across a range of comparisons. availability: the modp methodology has been implemented into edge, a comprehensive gene expression analysis software package in r, available at http://genomine.org/edge/.since the development of microarrays, a large number of methods have been proposed to identify genes that are differentially expressed across biological conditions. methods exist that borrow strength across genes to shrink variances, apply data-adaptive thresholds to traditional statistics or calculate hierarchical bayesian posterior to whom correspondence should be addressed. probabilities . recently,proposed an approach called the optimal discovery procedure (odp) that borrows strength across genes with similar expression patterns when testing them for differential expression. the odp, which must be estimated in practice, maximizes the expected number of true discoveries for a fixed expected number of false discoveries. this optimality property makes the odp an attractive choice for use in analyzing gene expression and other high-throughput data. conceptually, the odp uses information about differential expression patterns across all genes to inform the decision about any specific gene.shows a simple simulated dataset that illustrates the odp concept. the black box highlights the genes that are differentially expressed among groups. the first set of differentially expressed genes are upregulated in the first two groups and downregulated in the third. the second set of differentially expressed genes are downregulated in the second group and upregulated in the first and third. the third set is upregulated in the second group and downregulated in the others. in this example, each pattern of differential expression is shared across genes. the number of genes sharing each pattern is different, and only three of the six possible differential expression patterns are present. the odp directly utilizes this information, stemming from the idea that if a gene shares an expression pattern with other genes that have been identified as differentially expressed, then it is more likely to be differentially expressed as well. it has been shown that the odp is more powerful for detecting differential expression than existing methods such as the traditional t-test (or f-test), a shrunken t-test, sam and empirical bayes methods . the odp statistic is related to the commonly used likelihood ratio (lr) test statistics, also known as the neymanpearson statistic . suppose we have observed an n1 vector of expression data x i for the i-th gene. the traditional lr statistic, which is optimal when testing a single hypothesis, evaluates the likelihood under the null hypothesis of no differential expression for that gene l i0 and the alternative hypothesis l ia , and forms their ratio l ia (x i )/l i0 (x i ) as the test statistic. if the ratio is large enough, then the gene is called differentially expressed. the odp has a similar structure, except the ratio is taken of all alternative likelihoods to all null likelihoods given the genes data x i , where these likelihoods are evaluated across all genes. the odp statistic is the ratio alt l ja (x i )/ null l j0 (x i ). as with the lr statistics, the odp statistic for a test also captures evidence against the null hypothesis in favor of the alternative hypothesis.. a heatmap of simulated gene expression data for a study comparing three groups. the genes inside the black box show three common gene expression patterns; the first pattern is downregulated for groups 1 and 2 and upregulated for group 3. the second pattern is downregulated for groups 1 and 3 and upregulated for group 2. the third pattern is downregulated for group 2 and upregulated for groups 1 and 3. the number of genes sharing each pattern is different, and only three of the six possible differential expression patterns are present. the odp is designed to utilize these expression patterns to improve inference of differential expression. but in contrast to the univariate lr test, the odp summarizes the evidence against the null taking into account the information from the other (possibly related) tests being performed. when another gene is uninformative, it contributes essentially nothing to the above odp statistic because its likelihood is very low. although the odp statistic is more powerful than traditional statistics developed for testing single hypotheses, it requires the evaluation of a large number of likelihoods for each dataset. for each gene, the number of terms to calculate in the odp statistic is on the order of the total number of genes, resulting in a computational cost that grows quadratically in the number of genes when doing a genome-wide analysis. the original odp estimator introduced inperforms this exhaustive set of calculations. however, if groups of genes share common expression patterns, they will have similar probability distributions, and therefore their calculations can be compressed into a single computational step. here, we propose to identify modules of genes based on similarity of probability distributions using a clustering scheme based on the kullbackleibler distance. the odp statistic can then be calculated using only the distributions derived from the centroids of these modules and weighted by the number of genes in that module. since the number of modules is much smaller than the number of genes, the odp computation will be substantially reduced. however, the performance of and results from the modular odp approach are very similar to the full odp approach. in addition to a substantial reduction of computation, the unknown parameters for each centroid can be accurately estimated because multiple genes are used.the modp estimator (2) has two advantages over the full odp estimator (1). first, the number of modules is generally much smaller than the number genes (k m), thereby dramatically reducing the computational burden. the second advantage is that the averaged parameter fits within each module will be more stable than individual genes parameter estimates. we now compare the behavior of the modp estimator to the full odp estimator both on simulated gene expression data and on data from a study comparing gene expression levels in human leukocytes from individuals living in three different environments. we show below that the modp algorithm offers nearly identical results as the full odp, while indeed requiring substantially less computing time.the optimal discovery procedure (odp) is a powerful approach for the analysis of high-throughput gene expression data . however, the full odp requires the computation of a large number of likelihoods to evaluate the statistic for any specific gene. this leads to computational costs that grow quadratically in the number of genes. since significance of these statistics is typically evaluated by a non-parametric bootstrap approach requiring many sets of odp statistics to be calculated, there is a strong need for methods that reduce the computational cost of evaluating these statistics. here, we have introduced a new approach for calculating odp statistics, based on forming probabilistic gene modules using the kullbackleibler distance and greatly reducing the number of likelihood calculations making up each statistic. the modp statistics are formed from a small number of likelihood calculations, making the computation grow nearly linearly in the number of genes. even though the modp statistics are substantially faster to calculate, we have shown that they produce nearly identicalresults to the full odp statistics in both simulated and real data examples. even though the modp requires the user to decide the number of modules in advance, we have shown that the modp statistics are relatively robust to the choice of the number of modules. in both the simulated and real data examples, it was observed that 50 modules or more were sufficient to match the performance of the full odp. also because the modp method borrows strength across multiple genes, the averaged parameter estimates defining each module form more stable estimates of gene expression variation relevant to the study and may contribute important information beyond unsupervised clustering. although we have used the normal likelihood in the formulation of our method, justified because the data are continuous and can be shown to be approximately normal, the odp approach may be utilized with other probability distributions. the methodology presented in this article has been implemented in the edge software package , freely available at http://genomine.org/edge/.  
