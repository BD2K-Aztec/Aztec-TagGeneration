gene expression inference with deep learning motivation: large-scale gene expression profiling has been widely used to characterize cellular states in response to various disease conditions, genetic perturbations, etc. although the cost of whole-genome expression profiles has been dropping steadily, generating a compendium of expression profiling over thousands of samples is still very expensive. recognizing that gene expressions are often highly correlated, researchers from the nih lincs program have developed a cost-effective strategy of profiling only $1000 carefully selected landmark genes and relying on computational methods to infer the expression of remaining target genes. however, the computational approach adopted by the lincs program is currently based on linear regression (lr), limiting its accuracy since it does not capture complex nonlinear relationship between expressions of genes. results: we present a deep learning method (abbreviated as d-gex) to infer the expression of target genes from the expression of landmark genes. we used the microarray-based gene expression omnibus dataset, consisting of 111k expression profiles, to train our model and compare its performance to those from other methods. in terms of mean absolute error averaged across all genes, deep learning significantly outperforms lr with 15.33 relative improvement. a gene-wise comparative analysis shows that deep learning achieves lower error than lr in 99.97 of the target genes. we also tested the performance of our learned model on an independent rna-seq-based gtex dataset, which consists of 2921 expression profiles. deep learning still outperforms lr with 6.57 relative improvement, and achieves lower error in 81.31 of the target genes. availability and implementation: d-gex is available at https://github.com/uci-cbcl/d-gex.a fundamental problem in molecular biology is to characterize the gene expression patterns of cells under various biological states. gene expression profiling has been historically adopted as the tool to capture the gene expression patterns in cellular responses to diseases, genetic perturbations and drug treatments. the connectivity map (cmap) project was launched to create a large reference collection of such patterns and has discovered small molecules that are functionally connected using expression pattern-matching (e.g. hdac inhibitors and estrogen receptor modulators) . although recent technological advances, whole-genome gene expression profiling is still too expensive to be used by typical academic labs to generate a compendium of gene expression over a large number of conditions, such as large chemical libraries, genome-wide rnai screening and genetic perturbations. the initial phase of the cmap project produced only 564 genome-wide gene v c the author 2016. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.com expression profiles using affymetrix genechip microarrays . despite the large number of genes ($22 000) across the whole human genome, most of their expression profiles are known to be highly correlated. systems biologists have leveraged this idea to construct gene regulatory networks and to identify regulator and target genes . researchers from the lincs program (http://www.lincsproject.org/) analyzed the gene expression profiles from the cmap data using principal component analysis. they found that a set of $1000 carefully chosen genes can capture $80 of the information in the cmap data (http://support.lincscloud.org/hc/en-us/ articles/202092616-the-landmark-genes). motivated by this observation, researchers have developed the l1000 luminex bead technology to measure the expression profiles of these $1000 genes, called the landmark genes (http://support.lincscloud.org/hc/en-us/articles/ 202092616-the-landmark-genes), with a much lower cost ($$5 per profile) . therefore, researchers can use the expression signatures of landmark genes to characterize the cellular states of samples under various experimental conditions. if researchers are interested in the expression of a specific gene other than landmark genes, the expression profiles of the remaining $21 000 genes, called the target genes, can be then computationally inferred based on landmark genes and existing expression profiles. with the l1000 technology, the lincs program has generated $1.3 million gene expression profiles under a variety of experimental conditions. however, computationally inferring the expression profiles of target genes based on landmark genes is challenging. it is essentially a large-scale multi-task machine learning problem, with the target dimension ($21 000) significantly greater than the feature dimension ($1000). the lincs program currently adopts linear regression (lr) as the inference method, which trains regression models independently for each target gene based on the gene expression omnibus (geo) data. while lr is highly scalable, it inevitably ignores the nonlinearity within gene expression profiles that has been observed . kernel machines can represent dexterous nonlinear patterns and have been applied to similar problems . unfortunately, they suffer from poor scalability to growing data size. thus, a machine learning method enjoying both scalability and rich representability is ideal for large-scale multi-task gene expression inference. recent successes in deep learning on many machine learning tasks have demonstrated its power in learning hierarchical nonlinear patterns on large-scale datasets . deep learning in general refers to methods that learn a hierarchical representation of the data through multiple layers of abstraction (e.g. multi-layer feedforward neural networks). a number of new techniques have been developed recently in deep learning, including the deployment of general-purpose computing on graphics processing units , new training methodologies, such as dropout training and momentum method . with these advances, deep learning has achieved state-of-the-art performances on a wide range of applications, both in traditional machine learning tasks such as computer vision , natural language processing , speech recognition and in natural science applications such as exotic particles detection , protein structure prediction , rna splicing prediction and pathogenic variants identification . here, we present a deep learning method for gene expression inference (d-gex). d-gex is a multi-task multi-layer feedforward neural network. we evaluated the performances of d-gex, lr (with and without different regularizations) and k-nearest neighbor (knn) regression on two types of expression data, the microarray expression data from the geo and the rna-seq expression data from the genotype-tissue expression (gtex) project . gpu computing was used to accelerate neural network training so that we were able to evaluate a series of neural networks with different architectures. results on the geo data show that d-gex consistently outperforms other methods in terms of prediction accuracy. results on the gtex data further demonstrate d-gex, combined with the dropout regularization technique, achieves the best performance even where training and prediction were performed on datasets obtained from different platforms (microarray versus rna-seq). such cross platforms generalizability implies the great potential of d-gex to be applied to the lincs program where training and prediction were also done separately on the microarray data and the l1000 data. finally, we attempted to explore the internal structures of the learned neural networks with two different strategies and tried to interpret the advantages of deep learning compared with lr.we have introduced two types of gene expression data, namely the geo microarray data and the gtex/1000g rna-seq data. we have formulated the gene expression inference as a multi-task regression problem, using the geo data for training and both the geo and the gtex data for testing. we have also described our deep learning method d-gex, and another two methods, lr and knn regression, to solve the problem. next, we show the predictive performances of the three methods on both the geo data and the gtex data.revealing the complex patterns of gene expression under numerous biological states requires both cost-effective profiling tools and powerful inference frameworks. while the l1000 platform adopted by the lincs program can efficiently profile the $1000 landmark genes, the linear-regression-based inference does not fully leverage the nonlinear features within gene expression profiles to infer the $21 000 target genes. we presented a deep learning method for gene expression inference that significantly outperforms lr on the geo microarray data. with dropout as regularization, our deep learning method also preserves cross platforms generalizability on the gtex rna-seq data. in summary, deep learning provides adropout rate 0 10 25. the overall error decreasing curves of d-gex-9000 2 on gtex-te with different dropout rates. the x-axis is the training epoch and the y-axis is the overall error. the overall error of lr is also included for comparison better model than lr for gene expression inference. we believe that it achieves more accurate predictions for target gene expressions of the lincs dataset generated from the l1000 platform. interpreting the internal representation of deep architectures is notoriously difficult. unlike other machine learning tasks such as computer vision, where we can visualize the learned weights of hidden units as meaningful image patches, interpreting the deep architectures learned by biological data requires novel thinking. we attempted to interpret the internal structures of the neural networks learned from gene expression data using strategies that were inspired by linear model. yet, more systematic studies may require advanced computational frameworks that are specifically designed for deep learning. unsupervised feature learning methods, such as autoencoder and restricted boltzmann machine may provide some insights on this problem. in the current setting, target genes were randomly partitioned into multiple sets, and each set was trained separately using different gpus due to hardware limitations. alternatively, we could first cluster target genes based on their expression profiles, and then partition them accordingly rather than randomly. the rationale is that target genes sharing similar expression profiles share weights in the context of multi-task neural networks. ultimately, the solution is to jointly train all target genes, either by using gpus with larger memory such as the more recent nvidia tesla k80, or by exploiting multi-gpu techniques .  
