sequence analysis sapa tool: finding protein regions by combination of amino acid composition, scaled profiles, patterns and rules functional modules within protein sequences are often extracted by consensus sequence patterns representing a linear motif; however, other functional regions may only be described by combined features such as amino acid composition, profiles of amino acid properties and randomly distributed short sequence motifs. if only a small number of functional examples are well characterized , the researcher needs a tool to extract similar sequences for further investigation. availability and implementation: we provide the web application sapa tool, which allows the user to search with combined properties , ranks the extracted target regions by an integrated score, estimates false discovery rates by using decoy sequences and provides them as a sequence file or spreadsheet. source code, user manual and the web application implemented in perl, html, css and javascript and running on apache are freely available at http://sapafinding functional regions in protein sequences is an important annotation task. although many features of proteins are encoded by interacting amino acid residues positioned apart from each other in sequence, some exist as linear motifs represented by a continuous stretch of residues. estimations for eukaryotes assume that such linear regions cover up to 30 of all protein sequences . they have diverse functions in protein folding, protein complex assembly, protein protein interactions, ligand binding, signalling and as sites of post-translational modifications . many such sites may be extracted with distinct sequence patterns, simple or complex rules for amino acid neighbourhoods or position-specific matrices, which describe a specific amino acid sequence and its allowed variations, as collected by the interpro or the prosite database . functional regions may also be predicted by a specific amino acid composition and similarity to a scaled amino acid profile or index, which defines for each residue a weight for being part of a sequence with a specific property. such scaled profiles are collected by the aaindex database and may be applied by scanning tools like the application pepwindow of the emboss program suite . in silico identification and analysis of hydroxyproline-rich glycoproteins from arabidopis thaliana were recently performed by the bio-ohio software, a tool, which combines the searches for regions of biased amino acid composition (e.g. 50 past) and that for repeated small patterns like ap, pa, sp and tp . a functional region may also be characterized by low complexity because of stretches of the same amino acid or the repeated occurrence of short sequence motifs as compiled by thecontrol sequences. the region of the proteins to be scanned may be restricted. the set minimum size of the target sequence has to comply with all settings. overlapping or adjoining targets will be fused. three decoy methods (riffled, shuffled, reversed) allow the user to make a set of decoy sequences, which are scanned together with the imported proteins for estimation of a cumulative local false discovery rate (fdr) . the fdr for a specific target score is two times the observed number of decoy targets above or equal to that score, divided by the number of all observed targets above or equal to that score. although the reversed method conserves local amino acid composition completely, the random method would scramble it; however, it removes the natural sequence redundancy and underestimates the fdr. we designed a riffling method, which mixes the sequence analogous to the riffled shuffle of a stack of playing cards, mostly conserves sequence redundancy and destroys local amino acid composition (for details see the programs decoy help file, manual and the supplement). the user selects minimum occurrence percentages for up to six single amino acids or three groups of related amino acids, which must be found in selected target sequences. up to three scaled aaindex amino acid profiles can be used for scoring and/or selecting target sequences, which can be set to remain below or above a specified mean score value. targets are also optionally selected depending on their motif content. the motifs are defined by an extended version of the prosite pattern syntax , and are combined with and, not or or operators. each target sequence is scored by the information content of each amino acid matched by a composition setting, the scores of the appropriately re-scaled and weighted aaindex scales and the information content of the defined motifs. details of the scoring scheme are described in the manual and the supplement. the scores of each protein are the sum score of their target scores. the result screen summarizes the applied search settings, the scoring scheme and target/protein extraction results. a result table shows all targets sorted by their scores and contains protein sequence icons with highlighted target regions, where the scores are encoded by different colour intensities. when clicking on an icon, a pop-up window shows the sequence with the highlighted regions. all setting and result tables may be downloaded as a multiple excel spreadsheet file and protein sequences as a fasta-formatted sequence file. the sapa tool enables easy subsetting of any protein list using compositional, profile and motif data, scores the targets appropriately and estimates their fdr. the example provided in the supplementary information shows how the sapa tool can extract sequences with properties derived from o-glycosylated peptides. often, only a few experimentally confirmed example sequences are available. similar sequences, when extracted, can be experimentally investigated for more information, which allows a new and better informed round of sequence retrieval by the sapa tool. for example, mass-spectrometric analysis of fragmented peptide ions provides quantitative information on their amino acid composition via their immonium ions; this information can be used to extract the respective subset of sequences, resulting in higher confidence levels for peptide identification. more usage examples and references for them are described in section 4 of the supplementary data.  
