sequence analysis kappa, a simple algorithm for discovery and clustering of proteins defined by a key amino acid pattern: a case study of the cysteine-rich proteins motivation: proteins defined by a key amino acid pattern are key players in the exchange of signals between bacteria, animals and plants, as well as important mediators for cellcell communication within a single organism. their description and characterization open the way to a better knowledge of molecular signalling in a broad range of organisms, and to possible application in medical and agricultural research. the contrasted pattern of evolution in these proteins makes it difficult to detect and cluster them with classical sequence-based search tools. here, we introduce key aminoacid pattern-based protein analyzer (kappa), a new multi-platform program to detect them in a given set of proteins, analyze their pattern and cluster them by comparison to reference patterns (ab initio search) or internal pairwise comparison (de novo search). results: in this study, we use the concrete example of cysteine-rich proteins (crps) to show that the similarity of two cysteine patterns can be precisely and efficiently assessed by a quantitative tool created for kappa: the j-score. we also demonstrate the clear advantage of kappa over other classical sequence search tools for ab initio search of new crps. eventually, we present de novo clustering and subclustering functionalities that allow to rapidly generate consistent groups of crps without a seed reference. availability and implementation: kappa executables are available for linux, windows and mac os at http://kappa-sequence-search.sourceforge.net.in recent years, novel types of proteins defined by a key amino acid patternoften referred to as x-rich proteinshave emerged as important and diversified actors of molecular signalling in animals and plants. although glycine-rich proteins , proline-rich peptides and leucine-rich repeatscontaining proteins are nowadays the subject of increasing research, cysteine-rich proteins (crps) still remain the most extensively studied ones . although traditional sequence search tools were successfully used to characterize the diversity of crps in various organisms, implementation of numerous manual data curation steps was always necessary, with the drawback of being both tedious and timeconsuming. moreover, manual intervention always introduces the risk of a subjective, hence, potentially skewed or biased analysis. in this article, we introduce key aminoacid pattern-based protein analyzer (kappa), a new automated sequence search program dedicated to the discovery and clustering of x-rich proteins, and we assess its performance on plant crps.although quite heterogeneous, crps share three common features: (i) a small size (50200 amino acids); (ii) the presence of a signal peptide at their n-termini to allow secretion; (iii) a mature protein comprising six or more cysteines (usually from 6 to 14). they are involved in a wide range of functions in living organisms. for instance, antimicrobial peptides (amps) such as defensins are broadly studied for their role in human innate immunity against viruses, bacteria and fungi , and in plant responses to pathogens . plantbacteria symbiotic equilibrium relies on crps as well (van de), while venoms from snakes, spiders and scorpions have also adopted the crps as neurotoxins and myonecrotic agents . thus, characterization of these communication mediators opens the way to future applications for human health and agronomy . in addition to their inter-organism communication functions, crps appear to be important messengers for cellcell signalling within a single individual. they are particularly involved in the control of developmental processes, such as seed, root and stomata development , but also in sexual reproduction in plants and in animals . numerous families of crps like defensins, thionins, albumins, snakins, lipid-transfer proteins, rapid alkalinization factors (ralfs), etc. have already been described, each of them being characterized by a precise cysteine spacing pattern. in several plant species, these crps can represent up to 23 of the total genome . describing their diversity and evolution now becomes a major stake in plant, animal and microbe biology. the structural particularities of crps are a challenging issue for bioinformaticians: on the one hand, the cysteine backbonewhich governs maintenance of disulfide bonds, hence, the 3d structure of proteinsis highly conserved in a given crp family, even between distant species. for instance, all defensins share a c-core and a cysteine-stabilized (cs) ab motif . on the other hand, the remaining residues in the sequenceinvolved in fine and specific recognition functionscan exhibit a fast evolutive speed, often underlined by a positive selection. hence, global sequence identity can be extremely low in a given crp family (supplementary). as shown in our study, this dual evolutive pattern makes it difficult to discover paralogues and orthologues of already known crps with classical ab initio sequence similarity search tools. in addition, the cysteine backbone itself can evolvethough at a lesser speedand give rise to new families of crps that may be specific to a given taxon. literature suggests that crps have been largely under-predicted ; it is therefore essential to be able to detect and cluster crps de novo, without necessarily relying on a set of reference proteins. the kappa workflow, presented in supplementary, meets this sequence search challenge by extracting and comparing cysteine patterns by means of a quantitative similarity index called j-score. this mapping step allows to detect crps that are similar to reference patterns (ab initio search) or to cluster crps having similar patterns without relying on a reference (de novo search). a blast-based subclustering step then allows to refine clustering, analyzing the remaining amino acids of the sequence and to visualize output groups of crps graphically. kappa is a free program coded in python 3 and is executable on most of existing operating systems (linux, mac os, windows). it supports sequence search parallelization by multithreading. unix manual pages and a complete users guide are also available.by providing an automated pipeline specifically dedicated to the evolutive specificities of proteins defined by a key amino acid pattern, like crps, kappa fills a gap in the landscape of sequence search computational tools. supplementarypresents salient advantages of kappa over more conventional approaches. the j-score appears to be a robust, quantitative and objective tool to describe cysteine pattern similarity and explore all its aspects: block identity i accounts for subtle modifications of cysteine spacing within a given family, while pattern persistence p allows to investigate emergence of new groups of crps within a given taxon. numerous families of crps have been detected and characterized so far in a small number of model organisms. moreover, the number and availability of new sequenced proteomes is quickly growing, especially for non-model organisms. considering the functional importance of crps in plants and animals, there is an increasing need to characterize their orthologues in these new proteomes. focusing on the cysteine spacing with the j-score, the kappa ab initio search function made it possible not only to detect new members of crp families within reference species themselves, but also orthologues belonging to more distant species. furthermore, the ab initio search is also flexible, since mapping parameters, especially stringency options, enable users to choose an optimal research framework. one can indeed decide to be strict in the similarity search, using a high j-score threshold or high stringency parameters, or more permissive and detect new -like proteins. traditional sequence search approaches such as blastp do not make a difference between key residues and the rest of the sequence; hence, true homologues of input crps are intermingled with non-related, low similarity sequences. although hmmer and psi/ phi-blast can give more weight to cysteines and other conserved residues, they are less performant in dealing automatically with extensive divergence of blocks between cysteines, and with fine modifications of the cysteine spacing itself. this is why previous reports dealing with crps always implemented curation steps relying on manual review of data or home-made scripts to obtain a consistent final protein dataset. though often leading to correct results, this time-consuming approach is suboptimal when dealing with large-scale, proteome-wide studies. kappa addresses this issue by providing a fast and accurate analysis pipeline based on quantitative criteria. moreover, the optimization functionality makes it easy to determine the best parameters for a given sequence search experiment. besides providing an automated pipeline, kappa also innovates by relieving the user of the need for reference cysteine patterns. indeed, the de novo search and clustering function applied to a whole proteome can uncover totally new families of crps without a reference.in the challenging case of proteins defined by a key amino acid pattern, kappa provides a new and accurate detection method over hmmer-based sequence search strategies implemented in previous crp studies and in gene-finding pipelines such as spada . implementation of kappa on available proteomes opens the way to a better and quicker understanding of the diversity, evolution and functions these peculiar proteins, as shown for the crps, egz proteins and sprr2s.  
