sequence analysis detecting clustering and ordering binding patterns among transcription factors via point process models motivation: recent development in chip-seq technology has generated binding data for many transcription factors (tfs) in various cell types and cellular conditions. this opens great opportunities for studying combinatorial binding patterns among a set of tfs active in a particular cellular condition, which is a key component for understanding the interaction between tfs in gene regulation. results: as a first step to the identification of combinatorial binding patterns, we develop statistical methods to detect clustering and ordering patterns among binding sites (bss) of a pair of tfs. testing procedures based on ripleys k-function and its generalizations are developed to identify binding patterns from large collections of bss in chip-seq data. we have applied our methods to the chip-seq data of 91 pairs of tfs in mouse embryonic stem cells. our methods have detected clustering binding patterns between most tf pairs, which is consistent with the findings in the literature, and have identified significant ordering preferences, relative to the direction of target gene transcription, among the bss of seven tfs. more interestingly, our results demonstrate that the identified clustering and ordering binding patterns between tfs are associated with the expression of the target genes. these findings provide new insights into co-regulation between tfs. availability and implementation: see www.stat.ucla.edu/$zhou/ tfkfunctions/ for source code.gene expression in high organisms is regulated by the combinatorial binding of multiple transcription factors (tfs) to the dna sequence in upstream or other regulatory regions of the gene. a set of interactive tfs often shows complex binding patterns. clusters of multiple tf binding sites (tfbss) co-localized in a short dna region form the so-called cis-regulatory modules (crms). more complicated patterns, such as ordering preference among binding sites (bss) of different tfs in a regulatory region, may exist and encode hidden regulatory signals. detecting combinatorial binding patterns and crms is thus an important step toward a comprehensive understanding of cis-regulation.consequently, computational methods have been developed for this purpose based on different types of genomic data. early methods build probabilistic models for tfbss and their occurrences in crms to identify clusters of tfbss from dna sequence data. for a recent review of these methods, see hardison and taylor (2012). when the tfs involved in a particular cellular condition are known, methods have been developed to detect clusters of motif matches appearing more frequently than expected given a background model for the dna sequence . there are also de novo methods for the discovery of crms, such as;) for a few examples. essentially, this group of methods finds clusters of tfbss based on the enrichment of motif matches compared against a simple background model. because motif signals are usually weak in high organisms, sophisticated binding patterns, such as the ordering and other location preferences among tfbss, cannot be reliably detected from sequence data alone and thus are often not incorporated in these methods. recently, chip-seq technology has been applied to generate genome-wide binding data for tfs in various cellular conditions. the accumulation of such binding data for multiple tfs in the same condition makes it possible to explore the relation among the binding of these tfs. for example, more than 10 tfs have available chip-seq data in mouse embryonic stem cells (escs) . one may want to find out whether the binding of two tfs is independent of each other and, if not, identify specific binding patterns suggested by the data. such results may indicate how two or more tfs work together to regulate the expression of target genes and help detect novel regulatory signals. however, those motif-enrichment methods reviewed above are not directly applicable owing to the different data type and their simplified model assumptions. on the other hand, ad hoc methods have been used to define and detect clusters of bss or chip-seq peaks in recent studies.defined multiple tf binding loci by peaks within 100 bp. lee and zhou (2013) identified context-dependent co-regulators from co-bound regions constructed by chip-seq peaks of two tfs with distance 550 bp.determined whether binding regions have a clustering tendency based on the empirical distribution of peak-to-peak distances.found clusters of bss by iteratively merging peaks within 100 bp and then constructed some test using poisson approximation.identified inter-site spacing bias for some fixed range between 0 and 100 bp by a fishers exact test on the to whom correspondence should be addressed. contingency table of site pair counts within or outside the range. one sees an arbitrary use of distance thresholds and simple empirical tests in finding clusters of bss (or peaks) in existing work, without any consideration of ordering preference among tfbss or the individual location distribution for bss of a tf. clearly, there is a pressing need for new statistical methods to infer combinatorial binding patterns from chip-seq data. in this work, we develop statistical methods to detect clustering and ordering patterns between bss of two tfs from their chip-seq data. we assume that under the null model the locations of bss of a tf follow an inhomogeneous poisson point process. test statistics for clustering and ordering binding patterns are constructed based on ripleys k-function , a widely used method for detecting point patterns in spatial statistics, and its generalizations to pairwise tf binding data. our approach does not rely on a pre-specified distance threshold for the detection of clusters of bss and can automatically find the distance level at which the clustering pattern, if exists, is most significant. we make use of the large number of bss in chip-seq data and demonstrate that the null distributions of the test statistics can be accurately approximated by largesample theory. this eliminates the need for computationally intensive simulations and allows for efficient large-scale analysis.in this work, we study binding patterns in chip-seq data generated from mouse escs. escs are pluripotent stem cells derived from the inner cell mass of the blastocyst, an early-stage embryo . they are known to have two distinctive properties, pluripotency and the ability to replicate indefinitely , which make escs especially important in clinical research. it is expected that many complex diseases might be treated by transplanting cells generated from escs . there has been a substantial amount of recent work on the gene regulatory network in mouse escs, which involves the combinatorial regulation by a number of tfs . for example, oct4 is known as a master regulator of pluripotency, and a valid amount of oct4 is needed for dedifferentiation and for sustaining esc self-renewal . four tfs, oct4, sox2, cmyc and klf4, can reprogram somatic cells back to esc-like cells having the characteristics of self-renewal and pluripotency . genome-wide chipseq data have provided the binding regions of410 tfs that play key regulatory roles in mouse escs . computational analyses have been performed to identify the sequence motifs of these core tfs and to detect other co-regulators that may regulate genes by working with these tfs . however, except for some ad hoc analysis on the co-occurrence between binding peaks, it appears that no principled approaches have been applied to detect combinatorial binding patterns from this rich collection of data. in this analysis, we apply our methods to 14 tfs with available chip-seq data from three recent publications and systematically identify clustering and ordering binding patterns between all 91 tf pairs. the 14 tfs are oct4, sox2, smad1, stat3, nanog, esrrb, tcfcp2l1, tcf3, nr5a2, e2f1, nmyc, cmyc, zfx and klf4. we also suggest potential regulatory roles of the identified combinatorial binding patterns by examining the expression profiles and functional annotations of their target genes. we first verified via a simulation study that the normal approximations to the null distributions of the test statistics, z c (11) and z o (21), are accurate for the data analyzed in this work. one key feature that distinguishes our methods from other ad hoc methods is the use of inhomogeneous poisson processes in modeling bs locations, which takes into account the location preference of tfbss in upstream regions. in the simulation study, we also compared our approach against a simple method that ignores the location preference in detecting clustering. the simple method produced substantially more false discoveries. this shows that modeling the marginal binding distribution of a tf is a critical component for the detection of significant binding patterns. see supplementary document for a detailed description of the simulation study.  
