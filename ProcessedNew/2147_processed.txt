gustaf: detecting and correctly classifying svs in the ngs twilight zone motivation: the landscape of structural variation (sv) including complex duplication and translocation patterns is far from resolved. sv detection tools usually exhibit low agreement, are often geared toward certain types or size ranges of variation and struggle to correctly classify the type and exact size of svs. results: we present gustaf (generic multi-split alignment finder), a sound generic multi-split sv detection tool that detects and classifies deletions, inversions, dispersed duplications and translocations of !30 bp. our approach is based on a generic multi-split alignment strategy that can identify sv breakpoints with base pair resolution. we show that gustaf correctly identifies svs, especially in the range from 30 to 100 bp, which we call the next-generation sequencing (ngs) twilight zone of svs, as well as larger svs 4500 bp. gustaf performs better than similar tools in our benchmark and is furthermore able to correctly identify size and location of dispersed duplications and translocations, which otherwise might be wrongly classified, for example, as large deletions. availability and implementation: project information, paper benchmark and source code are available via http://www.seqan.de/projects/ gustaf/.variation in the human genome remains only partially characterized. theoretically, whole-genome sequencing (wgs) data carry the potential to identify all genomic variation, including small variants such as single nucleotide variants and small indels, as well as larger structural variants (svs; typically defined as 450 bp), such as large deletions, inversions, duplications and translocations. however, the difficulty lies in computationally analyzing the large-scale data obtained from wgs and reliably identifying the whole range of genomic variation. with current algorithms and methods, only small variants, up to 30 bp, can be identified rather confidently, while larger variation still poses a major challenge . large and complex rearrangements are often accompanied by micro-homologies or microindels (onishi) around their breakpoints, which makes them even harder to detect, particularly with base pair resolution. many bioinformatics tools have been developed in recent years that address sv detection through identification of certain signatures in the sequencing data . mainly, they rely on one or multiple of the following four approaches:(i) identifying discordant read pairs that span sv breakpoints , (ii) detecting regions of unexpectedly low or high read depth , (iii) identifying split reads that span sv breakpoints or (iv) local reassembly of sv candidate regions . typically, overlap between different tools is low . this is partially due to the fact that most tools are geared toward certain types of data, e.g. for specific read lengths, or toward certain sv size ranges and types, e.g. mid-size indels. also, the different strategies suffer from various biases and sources of errors. read depth methods are vulnerable to read depth fluctuations leading to non-uniform coverage, e.g. due to gc content and mappability issues. even after successfully normalizing for coverage biases, the spectrum of svs that can be identified through read depth signatures is limited to copy number variable regions, i.e. deletion and amplification. read pair methods are vulnerable to mis-mappings caused by repetitive regions in the genome and are furthermore susceptible to chimeric read pairs . both read depth and read pair methods have problems identifying small svs, i.e. less than a few hundred base pairs, which we here term the next-generation sequencing (ngs) twilight zone of svs. for read depth methods, it is hard to discern coverage changes in small regions from natural read depth fluctuations. for read pair methods, such relatively small deletions are difficult to identify because paired read spacing may still lie within the variance of the insert size distribution. of the four strategies, only split-reads-and assembly-based methods yield single nucleotide resolution, by identifying reads or reconstructing contigs that directly span sv breakpoints. when correctly mapped onto the reference genome, the read(or contig-)to-reference alignment of an sv-spanning read (contig) will be split into partial alignments at the breakpoint positions, hence yielding base pair resolution. the split-read approach has been primarily used in conjunction with read pair methods that identify potential sv-spanning reads through abnormal paired read distance or orientation . this significantly reduces the search space for split mapping, which is computationally expensive to apply to the whole genome. to whom correspondence should be addressed. however, with increasing read lengths (and improved local reassembly approaches that generate contigs), the split-mapping approach becomes more and more powerful, as it yields highest confidence and base pair resolution. therefore, we aimed to develop a method that can generically split-map contigs or reads of arbitrary length. our tool gustaf (generic multi-split alignment finder) allows for multiple splits at arbitrary locations in the read, is independent of read length and sequencing platform and supports both single-end and paired-end reads. gustaf is based on finding local alignments of a read, and then essentially chaining local alignments into a semi-global read-to-reference alignment. similar approaches are used in the context of whole-genome alignment, where large rearrangements between locally collinear blocks are maintained in graph or graph-like structures, e.g. the alignment graph , the a-bruijn graph or the enredo graph , or in the shuffle-lagan glocal alignment algorithm . local alignments are identified with stellar (; www.seqan.de/projects/stellar), an edit distance local aligner, which guarantees to find all local alignments of a given minimal length, maximal error rate and maximal x-drop. in theory, however, our approach can take local alignments from any aligner as input, making it versatile and adaptable. because local alignments are allowed to be anywhere in the reference genome, it allows for non-collinearity of chained local alignments, and hence has the power to identify all types of sv. in contrast to other sv callers, gustaf furthermore attempts to correctly classify sv events leading to multiple breakpoints such as translocations and dispersed duplications including the actual length of the duplication (see also). these complex sv patterns incorporate pseudodeletions that make them harder to classify and that are often wrongly reported by other methods. in the following, we introduce our method gustaf and compare it with two other popular methods that are able to report svs with base pair resolution, pindel and delly .  
