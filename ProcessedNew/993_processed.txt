classification of ncrnas using position and size information in deep sequencing data motivation: small non-coding rnas (ncrnas) play important roles in various cellular functions in all clades of life. with next-generation sequencing techniques, it has become possible to study ncrnas in a high-throughput manner and by using specialized algorithms ncrna classes such as mirnas can be detected in deep sequencing data. typically, such methods are targeted to a certain class of ncrna. many methods rely on rna secondary structure prediction, which is not always accurate and not all ncrna classes are characterized by a common secondary structure. unbiased classification methods for ncrnas could be important to improve accuracy and to detect new ncrna classes in sequencing data. results: here, we present a scoring system called alps (alignment of pattern matrices score) that only uses primary information from a deep sequencing experiment, i.e. the relative positions and lengths of reads, to classify ncrnas. alps makes no further assumptions, e.g. about common structural properties in the ncrna class and is nevertheless able to identify ncrna classes with high accuracy. since alps is not designed to recognize a certain class of ncrna, it can be used to detect novel ncrna classes, as long as these unknown ncrnas have a characteristic pattern of deep sequencing read lengths and positions. we evaluate our scoring system on publicly available deep sequencing data and show that it is able to classify known ncrnas with high sensitivity and specificity. availability: calculated pattern matrices of the datasets hesc and eb are available at the project web sitenext-generation sequencing platforms such as solexa/illumina, abi solid or 454/roche are extensively used to sequence small rnas of roughly 1436 nt length at astonishing rates in various organisms . for instance, they are used to determine expression profiles of mirnas, 2024 nt long rna molecules, that have emerged in recent years as important posttranscriptional regulators in all known multicellular organisms and that are known to play roles in development, tumorigenesis and viral infection . besides mirnas other small noncoding rna (ncrna) classes such as pirnas , snornas or scarnas have been investigated. only recently, 454 sequencing revealed the existence of 16 nt long rna (therefore termed unusual small rna or usrnas) in cells infected with kshv . usrnas to whom correspondence should be addressed.are derived from both virus and host cell and are associated with the rna-induced silencing complex (risc). advances in throughput, accuracy and the ability to sequence longer reads will not only lead to more and more precise detection of already known ncrna classes, but also to the discovery of new types. it is therefore of great interest to develop methods for automatic classification of ncrna using deep sequencing data. most ncrnas have very specific structural properties that have been used to classify them , e.g. trnas possess a cloverleaf structure, whereas mirna precursors form stable hairpins. however, these methods rely on the prediction of rna secondary structure and even for short molecules the current rna secondary structure energy model is not always able to predict the native structure . this can be due to the incompleteness of the nearest neighbor energy model or explained by the fact that the minimal free energy structure is not necessarily the native one due to unknown modifications or effects of folding kinetics . in the case of de novo prediction of, e.g. mirnas, the exact pre-mirna sequence is not known a priori. even if the hairpin can be predicted for the pre-mirna sequence, it could be disrupted, if a few bases upstream or downstream are appended or removed from this sequence. therefore, multiple windows around a putative mirna are folded or a local folding tool such as rnalfold is used. this however necessarily leads to an increased false positive rate since many genomic sequences that do not encode mirnas can fold into stable hairpins . deep sequencing offers additional criteria to distinguish ncrna classes. a typical experimental setup is to determine the content of small ncrna in a cell under certain conditions. therefore, only intervals on the genome are considered, where enough sequencing reads have been aligned to. the specific number of reads depends on the tradeoff between sensitivity and specificity. if the experiment aims to identify a special class of ncrnas, specialized algorithms can be applied that detect specific features of that ncrna class based on biological knowledge. for example, in mirna biogenesis, one strand of the precursor is preferentially included into risc (the mature mirna) and the other is rapidly degraded (mirna star). considering this bias together with structural mirna properties can dramatically increase specificity of mirna detection, as shown before . mirnas recognize their targets by their seed region and, due to their biogenesis, have specific lengths . both features of mirnas should be detectable in an excess of deep sequencing reads that align to a specific genomic position and have a specific length. however, this is not always the case for mirnas in large-scale experiments (e.g.). the read start position of many mirnas follow a narrow distribution that is often skewed toward the mirna 3 end(c) a snrna (u2). frequencies of reads starting at position (x-axis) and of length (y-axis) are visualized in different shades of gray. note that both the snrna and the trna could easily be mistaken for a mirna, if only the most abundant read is considered. graphical respresentations for all pattern matrices are available on the project web site. and read lengths are often variable (see also). such alternative mature mirna forms are often referred to as isomirs . in addition to positioning and lengths of reads, distances of reads aligned in close proximity of other reads also carry information about ncrna classes: at least for animals, the mirna star should be detectable at a distance of roughly 40 nt to the mature mirna . distance information also helps to distinguish mirnas from degradation products of other abundant rna species such as trnas or snrnas . and, most importantly, using this information can help to classify novel ncrna or ncrnas that do not possess a characteristic secondary structure. in this article, we show how to exploit position and lengthdependent read patterns to classify ncrnas. we make no further assumptions about structural and other class-specific properties and only consider primary information from the alignment of deep sequencing reads on the genome. our method alps (alignment of pattern matrices score) allows to detect mirnas and other known ncrna classes with high accuracy and due to its unbiased nature, it also provides a straight-forward way to discover and classify novel ncrnas. our approach is complementary to existing methods that rely on structural properties and we expect that their combination with our approach allows to increase their sensitivity and specificity.we applied our method to previously published illumina sequencing data , where small rnas of human embryonic i428page: i429 i426i432pattern matrix frequencies are visualized in different shades of gray and white areas correspond to unaligned parts of the matrices. note that with the gap cost function in 2(a), the mirna star start positions on the right parts of the matrices are correctly aligned, whereas slightly altered parameters in 2(b) erroneously move the necessary gap to the end, where it is not penalized. stem cells (hesc) and embryoid body cells (eb) have been sequenced. we used bowtie to align the trimmed reads to the human genome (hg19) obtained from the ucsc genome browser. we allowed no mismatches but did not restrict the number of loci a read can be aligned to. we identified intervals as described in section 3 (t = 50,m = 1000) and assigned them to the classes in. we determined the normalized pattern matrices (see project web site for graphical visualizations) and computed all pairwise alps similarities for various scoring systems. first, we checked which choices of gap parameters make differences in the alignments of intervals. we considered the intervals of hsa-mir-99b and hsa-mir-185 that are both 5 donors (i.e. the mature mirna originates from the 5 arm of the precursor), are expressed at similar levels (1892 and 2148 reads in eb, respectively) and have different loop lengths. thus, a correct alignment must introduce a gap between the positions of the mature mirna and the mirna star in the sequence of column vectors of mir-185 (which has the shorter loop). if we calculate the optimal freeshift alignment using the hill matrix h 2,1 and min-product matrix multiplication, gap parameters of o =0.005 and e =0.001 are indeed able to produce a correct alignment . we emphasize, that meaningful ranges of gap parameters are highly dependent on the other parameters and that automated parameter optimization could resolve these ranges. a second theoretical consideration can be made by examining the inner and outer score distributions . when the sum-min and the sum-product operator is used with the same matrix (the identity matrix), scores of the former naturally tend to be higher than scores of the later. if the identity matrix is replaced by h 4,1 or h 8,1 , scores also tend to increase. for all parameter choices, it is apparent that inner and outer scores are significantly different, but their distributions are not completely separated. the outer distribution describes all alps similarities between pairs of intervals, one annotated as mirna, the other not annotated as mirna. however, mirbase is not complete, and as a consequence, it is possible that the outer score distribution contains mirnamirna scores, which can explain the elongated right tail of all p outer. the inner distribution consists of all pairwise alps similarities of two intervals both annotated as mirna. especially when using m = id l , many scores tend to be small, since only exact agreements in length are rewarded, and two mature mirnas may have differing sizes. in addition, mirna may be 5 donors or 3 donors or both mature and mirna stars are expressed at very similar levels. as a consequence, p inner does not only contain overall high scores, but also scores indicating differing subclasses. however, all these parameter choices are able to separate mirnas from other ncrnas, when we use all scores for classification. using any aggregate statistics fails in many cases: if the maximal scores is used, a true mirna may be too similar to an interval with unknown annotation, which is in fact a still unknown mirna, leading to a misclassification. if one uses the minimum, the inner scoring is hampered by subclasses. therefore, using all scores and a statistically robust method to combine them (such as fishers method) is necessary for reliable classification. in order to assess whether alps is able to classify ncrna reliably, we applied the following procedure: each annotated interval i was removed from its cluster c a and the described method was used to determine the class of i. since we did not restrict the number of loci a read could align to, and many of the abundant ncrnas are present in multiple copies in the human genome, we considered only scoressscores scoress(i,j) where the genomic sequences of i and j did not contain common subsequences of length 10, i.e. no deep sequencing read has been counted in both intervals i and j. for all other scores, p-values were calculated and combined as described. we then calculated recall and precision for each class a separately as the number of intervals correctly assigned divided by the number of intervals originally belonging to c a (recall) and divided by the number of intervals assigned to c a (precision), respectively. as indicated above, we tried various parameter combinations to classify ncrnas. since there are only very few unique snrnas, snornas and rrnas, we only considered mirnas and trnas for evaluation. except for some obviously too extreme parameter combinations (e.g. too negative gap parameters for global alignments), the classification performance was remarkably stable with recall values of up to 98 at a precision of 60 for mirnas . these relatively low precision values in the mirna class rise the question, whether our scoring tends to classify too many intervals as mirnas. however, the classes unknown and misc_rna are not excluded from our analyses, and nearly all of the intervals additionally assigned to the class mirna originate from unknown and misc_rna whose pattern matrix indeed is very similar to that of mirnas. we predicted the secondary structures of the corresponding sequences using rnafold and some of them are indeed predicted to be able to fold into hairpins. whether these reads really correspond to mature mirnas, are degradation products or otherwise processed rnas must still be elucidated, however. here, we applied our method only to abundant ncrnas. this is inherent to the method as we have to estimate the distribution of read lengths per position for an ncrna gene, which is only possible, if enough reads have been sequenced. due to further development of current sequencing techniques, it will be possible to achieve more and more sequencing depth at lower costs and therefore, also low abundant ncrnas will be represented by enough sequencing reads. i429page: i430 i426i432deep sequencing reads of ncrnas follow very specific patterns regarding their length and positions with respect to their genes. classes of ncrnas are defined by their function and biogenesis and often share a common structure. each of these can contribute to a biased distribution of reads on the ncrna gene:@bullet regulatory rnas such as mirnas, pirnas or sirnas are believed to recognize their targets by a short complementary region (seed). therefore, for a proper function, the cell has to take care that the seed of these rna classes is not shifted and, as a consequence, a wealth of deep sequencing reads starting at specific positions should be detectable. this can be observed in the pattern matrices computed for high-throughput sequencing data. the consideration of reads starting at adjacent positions allows to distinguish these ncrna classes from degradation products of other abundant species.@bullet the specific pattern observed for longer ncrnas such as trnas (see) can possibly be explained by their degradation: cleavage by rnases can be biased toward certain parts of the trna, which leads in the case of the cloverleaf structured trnas to a pattern of trna halves or quarters . although some of these degradation products can be mistaken for, e.g. a mirna due to similar length, the consideration of longer intervals and the i430page: i431 i426i432  
