accurate viral population assembly from ultra-deep sequencing data motivation: next-generation sequencing technologies sequence viruses with ultra-deep coverage, thus promising to revolutionize our understanding of the underlying diversity of viral populations. while the sequencing coverage is high enough that even rare viral variants are sequenced, the presence of sequencing errors makes it difficult to distinguish between rare variants and sequencing errors. results: in this article, we present a method to overcome the limitations of sequencing technologies and assemble a diverse viral population that allows for the detection of previously undiscovered rare variants. the proposed method consists of a high-fidelity sequencing protocol and an accurate viral population assembly method, referred to as viral genome assembler (vga). the proposed protocol is able to eliminate sequencing errors by using individual barcodes attached to the sequencing fragments. highly accurate data in combination with deep coverage allow vga to assemble rare variants. vga uses an expectationmaximization algorithm to estimate abundances of the assembled viral variants in the population. results on both synthetic and real datasets show that our method is able to accurately assemble an hiv viral population and detect rare variants previously undetectable due to sequencing errors. vga outperforms state-of-the-art methods for genome-wide viral assembly. furthermore, our method is the first viral assembly method that scales to millions of sequencing reads. availability: our tool vga is freely available athuman immunodeficiency virus (hiv) exhibits high genomic diversity within an infected host, which affects many clinically important phenotypic traits such as escape from vaccine-induced immunity, virulence and response to antiviral therapies . to accurately characterize an intra-host hiv population, sequencing technologies must be sensitive enough to detect and quantify rare variants . next-generation sequencing (ngs) technologies offer deep coverage of genomic data in the form of millions of sequencing reads . while the sequencing coverage is high enough to capture rare variants, the presence of sequencing errors makes it difficult to distinguish between rare variants and sequencing err0ors. additionally, low viral population variability (i.e. pairs of individual viral genomes that have small genetic distance) and the presence of individual variants having low abundance complicates accessing viral diversity and assembling full-length viral variants. the full picture of viral diversity in a population remains undiscovered due to errors produced by sequencing platforms. current sequencing technologies use different underlying chemistry and offer trade-offs among throughput, read length and cost . while the current sequencing platforms can potentially detect point-mutations, error rates may result in false-positive single nucleotide variant (snv) calls or wrong genome variant sequences. computational error correction techniques are able to partially correct the sequencing error and provide an opportunity to discover highly expressed individual viral genomes, but low abundant variants remain undiscovered. current methods are not able to differentiate true biological mutations from sequencing artifacts, thus significantly limiting the possibility of a method to assemble the underlying viral population. in this article, we propose a method to overcome these limitations by coupling a high-fidelity sequencing protocol with an accurate method, referred to as viral genome assembler (vga), to assemble a heterogeneous viral population. high-fidelity sequencing protocol, known as safeseqs, has been applied to detect rare somatic mutations, but its application on detecting rare viral mutations has been neglected. similar to safe-seqs we apply a special library preparation technique that eliminates sequencing errors during the demultiplexing step. the proposed protocol attaches individual barcode sequences during the library preparation step for every fragment, then amplifies each tagged fragment. reads are clustered according to the original fragment based on the attached barcode. an error-correction protocol is then applied for every read group resulting in a method that corrects errors inside the group and produces a corrected consensus read. highly accurate data in combination with deep coverage allows for accurate estimation of the underlying diversity of a viral population. importantly, the low per-base sequencing cost of the illumina platform makes it realistic to greatly increase coverage to detect ultra-rare variants. our sequencing protocol introduces novel challenges for virus assembly and we develop a novel assembly approach for reconstructing and estimating the frequency of a to whom correspondence should be addressed.we have presented vga, an accurate method for viral population assembly from ultra-deep sequencing data. the proposed algorithm is coupled with a high-fidelity sequencing protocol able to eliminate errors from sequencing data. deep coverage in combination with highly accurate data allows our method to accurately estimate the underlying diversity of a viral population. in particular, it makes possible to distinguish true biological mutations from sequencing errors, facilitating assembly of rare individual genomes. our method condenses the viral population into a conflict graph built from aligned reads. to distinguish between viral variants, the conflict graph is colored into a minimal set of colors. each color represents individual viral genomes composed from the set of non-conflicting reads. an expectationmaximization algorithm was used to estimate relative abundance frequencies of assembled viral genomes. to our knowledge, our method is the first viral assembly method that scales to millions of paired-end sequencing reads. experiments on both real and synthetic hiv datasets generated with various sequencing parameters and distribution assumptions suggest that vga is able to assemble diverse viral population from millions of paired-end reads. the ability of our method to maintain 100 assembly accuracy makes it suitable for clinical applications. in addition, the constant increase of sequencing depth offered by high-throughput technologies provide us with unprecedented resolution promising to increase number of discovered ultra-rare viral variants in the population.  
