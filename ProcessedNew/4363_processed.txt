speeding up tandem mass spectral identification using indexes motivation: tandem mass spectrometry (ms/ms) has been routinely used in proteomics studies. post-translational modification (ptm) identification is a challenging problem in tandem mass spectral analysis. results: in this article, we define two scoring functions for identifying peptides/proteins with ptms from ms/ms spectra: match scores and diagonal scores, as well as two spectral identification problems based on the two scores. we propose several index-based algorithms for the two problems. both theoretical and experimental analyses show that the index-based algorithms significantly improve on speed when compared with existing algorithms. contact:tandem mass spectrometry (ms/ms) has been routinely used in proteomics studies. in an ms/ms experiment, digested peptides (in bottom-up approaches) or intact proteins (in top-down approaches) are measured by mass spectrometers to generate tandem mass spectra, and the spectra are analyzed by software tools to identify the peptides or proteins . in ms/ms spectral identification, query ms/ms spectra are searched against either a protein database or a spectral library. when the query spectrum is searched against a protein database, it is a common procedure to select a set peptides/proteins whose molecular masses are similar to the precursor mass of the spectrum (within an error tolerance), then convert the peptides/proteins to theoretical spectra which the query spectrum is actually compared with. in this case, searching against a protein database can be treated as searching against a theoretical spectral library. given a query ms/ms spectrum s and a set t of ms/ms spectra, the spectral identification problem is to compute the similarity score between s and each spectrum in t and report the best-scoring spectrum in t. post-translational modifications (ptms) of proteins play a crucial role in generating the heterogeneity in proteins and also help in utilizing identical proteins for different cellular functions in different cell types. many studies in mass spectrometry involve ptm identifications . in the blind mode of ptm identification, where ptms are unknown, the main task is to compute the similarity score between a spectrum from to whom correspondence should be addressed.. comparison between a spectrum s =2,9,11,13 with a ptm and a spectrum t =2,6,8,10 without ptms. spectrum s has a ptm of 3 when compared with spectrum t. the ptm is represented as three consecutive 0s in the shaded area in the vector representation of s. the second and third 1s in s are shifted by 3 to the right when compared with t. (a) there is only one matched mass pair between s and t (the mass pair is connected by a dotted line). (b) there are two matched mass pairs between s and t ( = 3) a modified form of a peptide and another (theoretical) spectrum from the unmodified form of the same peptide. we define match scores and diagonal scores, which are two similarity scores between a spectrum with ptms and a spectrum without ptms. based on the two scores, we define the match spectral identification (msi) problem and the diagonal spectral identification (dsi) problem for identifying spectra with ptms. we used diagonal scores as a filter in top-down protein identification in and found that existing algorithms are time consuming for computing diagonal scores when the spectral library is large. in the past several years, high-accuracy spectra have become available due to the advance of mass spectrometers, which makes it possible to use indexes to speed up the computation of match scores and diagonal scores. in this article, we propose several index-based algorithms for the msi and dsi problems, which significantly improve on speed when compared with existing algorithms.we implemented all algorithms in java and tested the algorithms on a desktop computer with a 2.6 g cpu and 12 g memory.the speed of the index based algorithms is related to the resolution of ms/ms spectra, and the algorithms are fast for high-resolution ms/ms spectra. it is a surprising result that using indexes speeds up the computation of diagonal scores. generally, fft is the best solution for computing the convolution of two vectors. but when the two vectors are sparse, the simple comparison algorithm and algorithm 2 are much faster than fft, and the index-based  
