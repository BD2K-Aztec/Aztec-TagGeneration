2dspan: semiautomated 2-d segmentation, classification and analysis of hippocampal dendritic spine plasticity motivation: accurate and effective dendritic spine segmentation from the dendrites remains as a challenge for current neuroimaging research community. in this article, we present a new method (2dspan) for 2-d segmentation, classification and analysis of structural/plastic changes of hippo-campal dendritic spines. a user interactive segmentation method with convolution kernels is designed to segment the spines from the dendrites. formal morphological definitions are presented to describe key attributes related to the shape of segmented spines. spines are automatically classified into one of four classes: stubby, filopodia, mushroom and spine-head protrusions. results: the developed method is validated using confocal light microscopy images of dendritic spines from dissociated hippocampal cultures for: (i) quantitative analysis of spine morphological changes, (ii) reproducibility analysis for assessment of user-independence of the developed software and (iii) accuracy analysis with respect to the manually labeled ground truth images, and also with respect to the available state of the art. the developed method is monitored and used to precisely describe the morphology of individual spines in real-time experiments, i.e. consequent images of the same dendritic fragment. availability and implementation: the software and the source code are available at https://sites. google.com/site/2dspan/ under open-source license for non-commercial use.neuronal cells in different brain regions are covered with dendritic spines , which are small membranous protrusions having a length of around few microns. they form the postsynaptic compartment of most excitatory synapses in the central nervous system . dendritic spine is usually composed of a spine head and a spine neck that connects the spine head to the dendritic shaft . more specifically, a spine head, where the excitatory synapse is located, is separated from the parent dendrite by a thin neck, isolating the spine cytoplasm from the dendrite . spines are likely to play an essential role in neural circuits but their exact function is still a matter of debate .because of their morphology, dendritic spines are assumed to play a role in electrical and biochemical compartmentalization . synaptic plasticity is essential for brain development and higher brain functions . changes in dendritic spine morphology are believed to associate synaptic plasticity , which seem to be critical for synaptic function . however, the understanding of the relationship between the changes in dendritic spine structure and synapse functions remains inadequate. the quantitative contribution of spine morphology to biochemical compartmentalization is still unknown, in spite of being a long-standing hypothesis . therefore, the important question is, whether or how much the synaptic strength may be adjusted through structural changes in spine necks (or the complete spine) . effective solution to this problem is particularly difficult due the complex morphology of the dendritic spines. the problem gets compounded with the limited resolution of optical microscopic images . in many situations, the spines are difficult to be segmented from the images of dendritic segments having hundreds of these protrusions. identification of true spine boundaries is difficult and time-consuming . accurate quantitative analyses of the spines depend on the question, how easily and effectively the spines can be segmented from the dendrite? recently, some researchers have tried to address the earlier issue. a patent cooperation treaty (pct) application presents a method for characterizing one or more neurons comprising dendritic spines utilizing a grassfire process. the technique is particularly efficient for detecting separated spine heads. however, no detailed description is provided on how to precisely detect the contours of the spine. the work by) presents a method for segmentation and analysis of every spine separately using a contour tracing algorithm. two points are marked for each spine, one at the bottom of the neck and the other at the head [the farthest point (fp) on the spine from the neck]. then a parameterized contour tracing algorithm detects the spine boundary and the morphological attributes. this process requires extensive user-intervention. in images with hundreds of spines, marking two end-points and choosing appropriate segmentation parameters for every spine is a rigorous job. this makes segmentation of dendritic spines both times consuming and error-prone. in one of the recent developments,proposed an advanced 3d approach for segmentation of the spines, however, that kind of approach requires many optimization steps and extensive manual supervision. apart from the works mentioned earlier, several neuromorphological tracing tools are also available . many of these techniques use the commercial reconstruction software neurolucida . existing tracing tools like, filament tracer (http://www.bitplane.com/imaris/filamenttracer), amira (http://www.fei.com/software/amira-3d-for-life-sciences/), eutectic nts (http://neuronland.org/nlmorphologyconverter/ morphologyformats/eutectics/spec.html), 3dma-neuron (http:// www.ams.sunysb.edu/lindquis/3dma/3dma_neuron/3dma_neuron. html), neuronj (http://www.imagescience.org/meijering/software/neu ronj/), neuronstudio (https://en.wikipedia.org/wiki/neuronstudio), neuron_morpho (http://www.southampton.ac.uk/$dales/morpho/), etc. require extensive manual annotations and parameter selection for automated/semiautomated reconstructions. for example, filament tracer (a module of the commercial imaris software) incorporates visualization and editing utilities and performs morphometric calculations by fitting the objects from the finite list of shapes (such as, cone, ball and cylinder). similarly, neuron_morpho, an open-source tool for semiautomatic digital tracing of neurons from image stacks, generates outline of the neurite or soma by drawing straight lines across the width of the section. none of these applications provides formal morphological definitions of spines. some applications like neuronj are developed as imagej plugins and are slow in analyzing images. these tools are often applicable on specific types of images, like, 8-bit grayscale or indexed color images. the proposed 2dspan method significantly reduces human involvement and allows the operators to quantitatively assess dendritic spine plasticity. users need to mark a specific dendritic segment, automatically segment the spines using the designed convolution kernels and finally mark the spines of interest to extract relevant features with high accuracy and minimal intervention. moreover, the proposed 2dspan method allows morphological analysis of spines from different type of images including those acquired by super-resolution, confocal and wide field microscopy images. the overall method is divided in two steps: (i) segmentation of the dendritic spines and (ii) quantitative assessment of spine morphology. in the article, we briefly describe the theory behind the developed segmentation algorithm and highlight the main features of the 2dspan interface and software architecture. the performed experimental validation is done with respect to the confocal images of dendritic spines from dissociated hippocampal cultures. finally, we conclude with a discussion on open-source software development, limitations and future plans.the developed 2dspan tool is useful in a variety of applications involving large-scale annotation of dendritic spines for quick and accurate assessment of spine plastic changes. there are two specific challenges involved in this process: (i) accurate segmentation of individual spines from the dendritic segment and (ii) quantitative analysis of spine morphology for effective assessment of dendritic spines structural changes. as discussed before, the objective of this work is to demonstrate the efficacy of the 2dspan tool in annotation of dendritic spines and to compare its performance with respect to the available tools. specifically, we have concentrated on the analysis of spine plasticity using the morphological features presented in the previous section. the confocal light microscopy images of dendritic spines from dissociated hippocampal cultures have been used for: (i) quantitative analysis of spine morphological changes, (ii) reproducibility analysis for assessment of user-independence of the developed software,(iii) accuracy analysis with respect to the ground truth (gt) annotations generated by the experimental biologists and also with respect to the available state of the art. in the following subsection, we first describe the image acquisition protocol and the image sets used for the experimental validation. then, we present the analysis of spine structural changes of the mentioned datasets, mutually blind three-user reproducibility analysis using the developed 2dspan software and finally, the error analysis with respect to the gt annotations and also with respect to the work by).a step-by-step representation of the segmentation process over a synthetic dataset, by applying the convolution kernel k90 f90; k11; k12g; (a) the start p and end q points are marked on a synthetic dataset, (b) the convolution kernel k11 is first applied on p, (c and d) results of successive application of the convolution kernel k11, on p2 and p3, respectively, marked in (b), (e) result obtained after iterative application of k11 on the image (stop, when q is reached or no further application of the kernel is possible), (f) now, the convolution kernel k12 is first applied on q, (g) result obtained after iterative application of k12 on the image, (h) the segmented dendrite region r 3 is estimated by intersection of the regions generated by k 11 and k 12 , a manual seed point is then placed inside the potential spine region, (i) the spine region is segmented using region growing from the manual seed and the base pixels are identified following the definition 1 2dspan: segmentation, classification and analysis of dendritic spine plasticity. hippocampi were triturated in plating medium, then centrifuged for 10 min at room temperature, at 208.5 g. the resulting cell pellet was suspended in plating medium, cells were counted and plated at density 120 000 cells per 18-mm-diameter coverslip (assistent, germany) coated with 1 mg/ml poly-l-lysine (sigma) and 2.5 lg/ml laminin (roche). at 3 h after plating medium was exchanged for maintenance medium (neurobasal-a without phenol red, 2 b-27 supplement, 1 penicillin-streptomycin, 0.5 mm glutamine, 12.5 lm glutamate, 25 lm b-mercaptoethanol) and cells were kept at 37 cc, under a humidified 5 co 2 atmosphere. 3.1.2 live cell imaging and chemical long-term potentiation (cltp) stimulation cultured hippocampal neurons were transfected at 14 days in vitro (div) with syn-gfp plasmid to visualize neuronal morphology. live cell imaging was performed on 2022 div. prior the imaging, the cells were placed in an acquisition chamber with controlled temperature (37 c) and stable co 2 (5) concentration. dendritic segments decorated with dendritic spines were imaged at the time 0, before stimulation, and then was induced by bath application of a mixture of 50 lm forskolin, 50 lm picrotoxin and 0.1 lm rolipram (each dissolved in dmso) in maintenance media. dendritic segments were imaged at 10 min after cltp induction. images were acquired using the carl zeiss lsm780 confocal microscope with a c-apochromat 40/1.2 na water immersion objective using 488 nm wavelength argon laser at 3 transmission at 70 nm/pixel resolution. a series of z-stacks were acquired at 0.4 lm step.in this work, we present a new tool for fast and accurate annotation of dendritic spines from confocal microscopy images. however, the 2dspan method allows determining the morphology of spines from super-resolution microscopy and is not limited only to confocal images. please note that, the applied confocal imaging technique provides sufficient resolution to detect the changes of dendritic spines morphology . we also define and extract several morphological features from the segmented spine images for quantitative assessment of spine structural plasticity. although there are some tools that serve somewhat similar purposes, like the one developed by), they do not provide theformal morphological definitions to different spine compartments. for example, there were no formal morphological characterizations to base, neck and head of a spine, in the prior works. there are plenty of biological discussions in contemporary literature but most of them are subjective with respect to digital image segmentation and analysis. we also provide an automatic spine classification framework based on the features extracted from the segmented spines. the proposed spine classification model works on a rulebased decision tree framework and may be improved further in future versions of the software. the performance of the classifier is assessed by comparing the manual annotations from experimental biologists. the developed spine segmentation methodology is based on a novel convolution kernel-based approach. this methodology is effective in isolating the dendritic segment in between two manually embedded seed points on the image, using the 2d graphical user interface of the developed software. the spines on either side of the dendritic segment are marked by the user by placing a single inside seed, leading to segmentation of the spine from the dendritic segment. the morphological features like area and length of the spine are computed immediately. other features like neck-length, neck-width and head-width are also estimated for each segmented spine. the segmentation and classification steps in the 2dspan tool are extremely fast and almost instantaneous on a standard desktop computer. the segmentation task takes $1 s and the classification of individual spines takes several milliseconds computation time on the desktop computer used in our experiment. to assess the efficacy of the developed tool, we first analyzed dendritic spine structural changes with respect to two image datasets, before and after cltp. we have quantitatively assessed the transitions between the spine categories stubby, filopodia, mushroom and spine-head protrusions. the changes in spine area and length are observed over all segmented spines. for all nonstubby spines, the changes in neck-length and neck-width values are analyzed. we have also assessed the changes in head-width in all mushroom type spines. please note that the objective of this study is to demonstrate the capabilities of the developed 2dspan tool and therefore we are not inferring any biological significance from the experimental observations. for stability and robustness study, a three-user reproducibility analysis has been performed. both qualitative and quantitative analysis show exciting results on the t0 and t10 image sets. the accuracy analysis is performed with respect to the manually annotated gt dataset and also with respect to the prior works available in this domain. there are still scopes for improvement especially with respect to the design of the user interface and also with respect to the preprocessing steps for the image sets. the complete work depends on the binarization algorithm applied on the roi marked by the user. at this moment, we use a global binarization on the complete region. this process may sometime inflict noise in the data, leading to inappropriate segmentation of the spines. we are currently working on that issue and hope to improve the same in the upcoming version of the software. the basic software architecture, along with a representative screenshot (supplementary) is discussed in supplementary and also in the user manual. finally, on the availability of the developed software, we would like to mention that the complete open-source, platform-independent package is available at https:// sites.google.com/site/2dspan/ for non-commercial use by the research community.  
