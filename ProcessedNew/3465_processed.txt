pattern recognition methods to relate time profiles of gene expression with phenotypic data: a comparative study motivation: comparing time courses of gene expression with time courses of phenotypic data may provide new insights in cellular mechanisms. in this study, we compared the performance of five pattern recognition methods with respect to their ability to relate genes and phenotypic data: one classical method (k-means) and four methods especially developed for time series [short time-series expression miner (stem), linear mixed model mixtures, dynamic time warping for-omics and linear modeling with r/bioconductor limma package]. the methods were evaluated using data available from toxicological studies that had the aim to relate gene expression with phenotypic end-points (i.e. to develop biomarkers for adverse outcomes). additionally, technical aspects (influence of noise, number of time points and number of replicates) were evaluated on simulated data. results: none of the methods outperforms the others in terms of biology. linear modeling with limma is mostly influenced by noise. stem is mostly influenced by the number of biological repli-cates in the dataset, whereas k-means and linear modeling with limma are mostly influenced by the number of time points. in most cases, the results of the methods complement each other. we therefore provide recommendations to integrate the five methods.comparing time courses from different types of measurements is an important topic in biological research , because it contributes toward understanding the response of complex cellular systems to perturbations. in particular in toxicogenomics (which stands for the application of-omics technologies to toxicology), comparing time courses of gene expression with time courses of phenotypic endpoints (i.e. biomarkers for the adverse outcomes induced by a chemical compound) may help to distinguish gene expression changes related to toxicity from changes not related to toxicity . thepresent study focuses on comparing time courses of gene expression with time courses of phenotypic data, also called phenotypic anchoring of gene expression data. phenotypic anchoring may provide additional insight in the response to perturbations that cannot be generated by analyzing gene expression alone. various statistical tools can be used for phenotypic anchoring , including pattern recognition. pattern recognition includes clustering (e.g. k-means), classification (e.g. support vector machines) and model reduction (e.g. principal component analysis) . biological entities belonging to the same cluster are assumed to be functionally related . in this study, five representative pattern recognition methods were chosen. first, we included a clustering method that is able to remove random patterns, called short time-series expression miner (stem). removing random patterns is important for datasets with a high number of variables compared with the number of time points . secondly, dynamic time warping for-omics (dtw4omics), a method that takes into account time delays in biological processes , is considered. in contrast to clustering methods (which treat all variables in the dataset as equivalent entities), dtw4omics treats the phenotypic data as predefined profiles and searches for genes matching these profiles using a distance metric. thirdly, linear mixed model (lmm) mixtures, a clustering method correcting for variability between replicates , is discussed. furthermore, we applied k-means, a classical clustering method for static data. finally, we used a regression method [linear modeling with the r/bioconductor package limma (, to find relationships between gene expression and phenotypic endpoints. the five methods were compared with respect to their ability to extract functionally related groups of genes, their sensitivity to measurement noise, the influence of the number of time points and the influence of the number of biological replicates. the technical aspects (influence of noise, number of time points and number of replicates) were evaluated on simulated data, mimicking real expression and phenotypic data. the biological outcome was evaluated exploiting two public datasets from toxicogenomics.applying pattern recognition methods to toxicogenomics time series of both microarrays and phenotypic endpoints can provide new hypotheses about interactions of the genome with the adverse outcome of exposure to a toxicant. these new hypotheses will guide wet laboratory experiments (e.g. knock down experiments) that aim to verify such new relationships. in this study, we evaluated five pattern recognition methods. the main focus is on methods developed for time series methods, except k-means, which we added to the study in order to assess the impact of time dependencies on pattern recognition. another method for static data, that has been frequently applied to time series, is weighted correlation network analysis (wgcna) , which combines correlation analysis with hierarchical clustering . clusters obtained by applying static-based methods on time series are often less biologically coherent than clusters determined with time-series methods . however, this could not be observed from this study. stem, lmm mixtures and k-means treat all the genes and endpoints as equivalent entities and cluster them all together. as a consequence several endpoints may end up in the same cluster and some clusters will have no endpoints. in our study, having several endpoints within the same cluster was found upon applying stem, lmm mixtures and k-means. having two or more endpoints within the same cluster has the advantage that similarity between the two endpoints is explicitly known. a drawback of having two endpoints in the same cluster is that one cannot really assess whether any particular gene in the cluster is more strongly associated with one endpoint than the other. another drawback is that one can have only certainty that the gene expressions really match the profile of the endpoint if the endpoint is at the center of the cluster. dtw4omics treats the endpoints as profiles and matches each of the genes to these profiles. limma uses the endpoints as fixed effects in a regression model. as a consequence, for dtw4omics and limma, each cluster has only one endpoint and a gene can match more than one endpoint or none. clustering methods that do not correct for random patterns, like lmm mixtures and k-means divide the datasets into large clusters. this mostly leads to a large amount of pathways related to a large number of biological processes. correcting for random patterns (like stem) results in smaller gene lists, which has the advantage that these lists are mostly easier to interpret. a disadvantage is that if two variables are highly correlated to one of the model profiles by coincidence, the two variables would also be in the same cluster, which leads to false positives. another drawback is that in cases when the variable is not correlated to one of the model profiles, it is not taken into account for further analysis. in this way information may be lost. while stem, lmm mixtures, k-means and limma find gene expression modifications that covary simultaneously with the investigated endpoints, dtw4omics allows time lags and delays. because of this property results from applying the dtw4omics approach are more influenced by the number of time points than the two other time series methods . limma is more sensitive to noise than the other methods . lmm mixtures and limma need biological replicates (for modeling the random effects), while stem, dtw4omics and k-means in principle can be applied without having replicates. however, this is not recommended because it decreases the accuracy of stem, and to a lesser extent, of dtw4omics and limma . stem and dtw4omics both use a permutation test for calculating significance. permutation tests assume independence between subsequent time points, which can be disadvantageous in case clear trends are observed in the data . lmm mixtures clustering and limma take into account variability between replicates. the consequence of having a low number (23) of replicates is that variability (the random effect in the model) can be overestimated or underestimated. for lmm mixtures, underestimation (respectively, overestimation) of the variability between replicates leads to clustering too strictly (respectively, not strict enough), and as a consequence, may generate false negatives (respectively, false positives). another disadvantage of lmm mixtures, and of model-based clustering in general, is that the algorithm is slow compared with other methods. for limma, underestimation (respectively, overestimation) of the variability between replicates has influence on variance shrinkage and leads to decreased (respectively, increased) sensitivity to detect relationships between genes and phenotypic endpoints, which in its turn leads to false negatives (respectively, false positives).for all five methods studied, pathway and go analysis of these gene lists provided pathways and go terms that have been previously related with exposure to the particular toxicant or with one of its adverse outcomes (see supplementary material). the hallmarks of cancer review biological processes related to all types of cancer, and the signaling pathways involved in those biological processes. those hallmarks are: (1) sustaining proliferative signaling; (2) evading growth suppressors; (3) avoiding immune destruction; (4) enabling replicative immortality; (5) tumor-promoting inflammation; (6) activating invasion and metastasis; (7) inducing angiogenesis; (8) genome instability and mutation; (9) resisting cell death and (10) deregulating cellular energetics. because b(a)p is a carcinogen and menadione causes hepatocellular carcinoma, pathways known to be involved in the hallmarks of cancer provide biologically relevant hypotheses to test in follow-up experiments. for b(a)p, in particular signaling pathways related to dna damage response are relevant . examples are signaling pathways involving p53, nfkb and myc . for menadione, pathways related to oxidative stress provide relevant hypotheses. signaling pathways influenced by oxidative stress given in martindale and holbrook (2002) include pathways involved in growth arrest, cell proliferation, senescence and apoptosis. all five methods provide biologically relevant pathways and go terms that are related to the exposure to the toxicant or its adverse outcomes (e.g. cancer, oxidative stress) (see figs. 25 and supplementary material, section 3). therefore, in terms of retrieving biologically relevant information, there is no method that outperforms the others. if we compare the results of limma, the only regression-based model in the study, with the results for the other (correlation-and distance-based) methods, we observe the following. lmm mixtures positively relate the pathway direct p53 effectors to dna adducts, while limma finds a negative relationship. four genes of direct p53 effectors are in both the genes lists resulting from lmm mixtures and limma analysis (pcna, tnfrsf10b, lif and bax), which means that these four genes have a positive correlation with dna adducts, but a negative regression coefficient. this can be explained as follows. the regression coefficient of the limma model gives the relationship between gene expression and dna adducts, when all other variables in the model (treatment, time) are held constant. this means that the positive relationship observed by determining similarities between the time profiles was due to another (confounding) variable. this shows an advantageous property of limma, namely correcting for confounding factors. for the menadione dataset (dataset), limma cannot find any pathways related to oxidative dna damage, while all other methods generate a pathway list. for this dataset, applying dtw4omics results in detecting some pathways that cannot be found without time warping. one of these pathways is related to the hallmarks of cancer . this shows the relevance of having a method taking into account time delays. applying the methods for phenotypic anchoring described in this article results in poorly overlapping gene lists. this is a general problem of clustering algorithms. there are several reasons for the lack of consistency between methods. first, parameters (optimal number of clusters, thresholds) are determined by statistical means and not on biological properties . second, differences in output are due to different intrinsic properties of these methods. limma is a regression method, while the other methods are based on similarity measures (correlation, distance). other differences in intrinsic properties (taking into account time dependencies, delays, variance; correcting for random patterns) are shown in. for static-based methods, several attempts have already been undertaken to address these issues. wgcna selects thresholds based on scale-free topology, a network property previously observed in biological networks . consensus clustering attempts to combine the different approaches, capturing the advantageous properties of each methods . however, to our knowledge, similar attempts have not been undertaken for methods developed for time series, taking into account time dependencies and delays. in summary, we conclude that all five methods are suitable for extracting new hypotheses concerning gene-phenotypic endpoint relationships and none of the five methods outperforms the others in terms of biology. furthermore, all methods have their limitations. because these methods provide complementary results, we recommend developing a method that integrates the results from the different methods. a possible way to do this is to calculate a weighted score for the probability of each geneendpoint relationship based on the accuracy of the methods. simulation experiments can guide the choice of the weight for each method. for example, because stem was highly influenced by the number of biological replicates, we decrease the weight for stem when having less replicates. in a similar way, we can adapt the weight of k-means and limma according to the number of time points. we can then multiply the false discovery rate for each pathway with this probability score in order to correct for inaccuracies due to the low number of replicates and/or time points.  
