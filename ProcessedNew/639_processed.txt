a zero-inflated poisson model for insertion tolerance analysis of genes based on tn-seq data motivation: transposon insertion sequencing (tn-seq) is an emerging technology that combines transposon mutagenesis with next-generation sequencing technologies for the identification of genes related to bacterial survival. the resulting data from tn-seq experiments consist of sequence reads mapped to millions of potential transposon insertion sites and a large portion of insertion sites have zero mapped reads. novel statistical method for tn-seq data analysis is needed to infer functions of genes on bacterial growth. results: in this article, we propose a zero-inflated poisson model for analyzing the tn-seq data that are high-dimensional and with an excess of zeros. maximum likelihood estimates of model parameters are obtained using an expectationmaximization (em) algorithm, and pseudogenes are utilized to construct appropriate statistical tests for the transposon insertion tolerance of normal genes of interest. we propose a multiple testing procedure that categorizes genes into each of the three states, hypo-tolerant, tolerant and hyper-tolerant, while controlling the false discovery rate. we evaluate the proposed method with simulation studies and apply the proposed method to a real tn-seq data from an experiment that studied the bacterial pathogen, campylobacter jejuni. availability and implementation: we provide r code for implementing our proposed method attransposons are genetic elements that can be inserted into genomes mediated by enzymes called transponsases. an application of transposons in genomic studies is insertional mutagenesis which refers to the construction of a library of bacterial strains, each being a mutant generated by random insertion of a transposon. transposon mutagenesis has facilitated our understanding of gene functions through identifying the phenotypes of the corresponding mutants. with the recent advent of next-generation sequencing (ngs) technologies, it is possible to sequence many transposon insertional mutants simultaneously, and the resulting technique that combines transposon mutagenesis with ngs technologies has been referred to as transposon sequencing (tn-seq). the tn-seq technique generates huge amount of data and allows genome-wide analysis of gene functions through mutagenesis. four different transposon sequencing technologies were proposed independently in 2009 and have been reviewed in van. they all share similar ideas of sequencing the dna v c the author 2016. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.com sequences flanking the transposon insertion site. we conducted a tnseq experiment to identify genes involved in the growth of a highly virulent strain (ia3902) of the bacteria campylobacter jejuni, which has been reported to be the major cause of sheep abortion and implicated in human gastroenteritis in the united states . by randomly inserting tn5 transposons into locations within the genome, we generated a library of mutant bacterial strains. details of our tn-seq experimental procedure are described in section s-1 of the online supplementary material. in summary, the genomic dna was extracted from the library of mutants after growth in a liquid medium. after shearing the extracted dna into fragments and amplifying the fragments with transposon-specific primers, we applied illumina sequencing to obtain sequence reads flanking the transposon insertion sites. by mapping the sequence reads to the genome of c.jejuni ia3902, we identified locations of transposon insertions and measured the relative abundance of mutants containing a transposon at each possible insertion site by enumerating the sequence reads mapped to the corresponding site. the transposon used in our experiment, tn5, can randomly insert into any locations of the target dna, but was reported to insert at the 3 0 end of the sequence a-gntywranc-t with a slight bias . other transposons may have different sequence preferences of the insertion sites. for example, the himar1 transposon inserts randomly between t and a in ta dinucleotides. an important research objective in a tn-seq experiment such as ours is to classify genes according to their tolerance to transposon insertion mutagenesis, or equivalently, to classify genes with respect to their effects on bacteria fitness/growth. a gene can be tolerant of disruption if the transposon insertion into the gene does not affect the growth of bacteria. on the other hand, a gene is hypo-tolerant of transposon insertion if the inactivation of the gene by transposon insertion suppresses the growth of bacteria. such a gene may provide an essential or core function in bacteria survival. a gene can also be hyper-tolerant of transposon insertion, suggesting that the inactivation of the gene may provide a growth advantage. a successful antimicrobial treatment needs to avoid inactivation of such hypertolerant genes. the above classification has been discussed inand is adopted throughout our article. in tn-seq data, the count of reads corresponding to each possible insertion site provides a measurement of the abundance of mutants containing a transposon at that location. a gene may have zero counts of sequence reads either because the gene is hypo-tolerant to transposon insertion and essential in bacteria survival, or because no transposons were inserted into any location in this gene just by chance. an appropriate statistical model should take into consideration both the probability of transposon insertion and the abundance of bacterial mutants in case that a transposon insertion happens. another challenge in tn-seq data analysis is the high dimensionality. usually, thousands of genes are simultaneously studied in one tn-seq experiment, whereas each gene contains up to thousands of locations for potential transposon insertions. the outcomes of tn-seq experiments, the read counts, are measured at the level of insertion locations, which suggests the development of statistical models at the same level to avoid loss of information. besides, statistical models need to take into account of the variation among insertion locations within a gene, as well as variation among genes. there have been a few statistical methods proposed for the analysis of tn-seq data and they deal with different levels of data summary. some researchers proposed to first reduce the data from the level of locations to the level of genes using the count of locations with zero mapped reads for each gene, and then model such counts using discrete distributions such as poisson distributions or negative-binomial distributions . such models ignore the magnitudes of the read counts for locations with non-zero counts, which measures the abundance of the corresponding mutants and hence contains important information about gene tolerance status.divided the genome into contiguous overlapping windows (with width 400600 base pair) and then employed a non-parametric test to assess tolerance status to bacterial growth for each of these windows. dejesus and loerger (2013) described a four-state hidden markov model and used geometric distributions for the count data at each location to model the conditional distribution of read counts given different states, and then each gene was assigned to a tolerance state according to the most frequent state found within the boundaries of the gene sequence.presented a tn-seq data analysis pipeline named artist. one arm of artist, el-artist, implements the method proposed bythat uses the results from the method proposed byas training set for the hmm algorithm and reports the estimate of state of genes as essential, domain essential, sick or neutral. all of these methods are applicable to tn-seq data with transposons inserted only into specific target locations (such as transposon himar1 that only inserts into ta dinucleotides). when using transposons (say, ez::tn) that could insert into any genome locations, the resulting tn-seq datasets typically are unsaturated and contain excess zeros. these methods have difficulty in dealing with such tn-seq datasets because they do not model the possibilities that no transposons are inserted into certain locations of genes during the construction of transposon mutant libraries. in this article, we propose a zero-inflated poisson (zip) model to deal with the excess of zeros for the analysis of tn-seq data at the level of locations. to account for the two possible reasons that give rise to zero read counts at a given location, we apply a mixture model with a point mass at zero and a poisson distribution. the component of point mass at zero corresponds to the case when there is no transposon inserted at the location, and hence there should be zero reads mapped to the corresponding location. this component is associated with a mixing probability that models the chance of not having a transposon insertion at a location, and this probability may vary across different locations depending on the genomic sequence or potentially other covariates that may affect the chance of insertion. the poisson distribution component models the count of reads mapped to the given location when a transposon is inserted there, and the mean of the poisson distribution provides a measurement of the abundance of mutants for the corresponding gene. this model reflects how the count data of tn-seq are generated at the location level, and allows us to estimate the chance of having transposon insertion and the abundance of mutants corresponding to different genes, and the latter allows us to identify genes involved in bacterial growth. our tn-seq experiment studied one specific growth condition of the mutant library. to classify genes with respect to their effects on bacterial growth, we utilize data of pseudogenes observed in the same experiment. pseudogenes are dysfunctional relatives of genes that have lost their protein-coding abilities. pseudogenes are still important in genomic studies because they provide a record of how the genomic dna has been changed without evolutionary pressure and can be used as a model for determining the underlying rates of nucleotide substitution, insertion and deletion in the genome. in our model, we consider pseudogenes to be tolerant of disruption as they have already lost their protein coding abilities before mutagenesis. thus comparing the normal (non-pseudo) genes with pseudogenes provides information about the tolerance status of the normal genes. more specifically, the genes with mean abundance of mutants not significantly different from the mean abundance of pseudogenes mutants will be classified as tolerant, and those genes with mean abundance of mutants significantly below (above) the mean abundance of mutants for pseudogenes are hypo-tolerant (hypertolerant). we apply an expectationmaximization (em) algorithm to estimate parameters of the zip model, including the mixing probability of insertion and mean abundance of mutants for thousands of genes. then we estimate the asymptotic variancecovariance matrix of all estimated parameters and perform a wald test for each gene to assess whether each gene is tolerant of transposon insertion or not by comparing the mean abundance of mutants of this gene with that of the pseudogenes. the method byis applied to control the false discovery rate (fdr) as an error criterion in the multiple testing problem. at the end, we classify all normal genes into three different classes: hypo-tolerant, tolerant and hyper-tolerant, which reflects their tolerance to transposon insertion. the remainder of the article is organized as follows. section 2 presents our zip model for tn-seq data, our method to estimate model parameters and our procedure for the multiple hypothesis testing to identify the tolerance status for genes. in section 3 and section 4, we present a simulation study and a real data analysis, respectively. section 5 concludes the article with discussions.a zip model is proposed in this article to model the excess of zeros observed in the tn-seq data. the mixture model of point mass at zero and a poisson distribution are constructed specifically according to the way tn-seq data are generated. multiple testing procedures are applied to classify genes into different categories with respect to transposon insertion tolerance, hence identify genes whose functions are closely related to bacterial growth. we evaluated the proposed method using both simulation studies and analysis of two real datasets. simulation studies in section 3 demonstrates that our proposed method performs well in terms of both the estimation of parameters and the classification of genes. in the main text, we discuss an application of our proposed model to the tn-seq data with the tn5 transposons which could be inserted possibly into any site within the genome. our model can also be used in the analysis of tn-seq data from experiments where transposon insertions are restricted, for example, experiments using himar 1 transposons that insert into ta dinucleotides only. an application of our method to a himar 1 dataset is presented in section s-2.3 of the online supplementary material. investigation of the distributions of read counts across gene-coding regions indicates that the resulting tolerance statuses classified by the proposed method are reasonable for both datasets. to validate the results, experiments with knock-out genes can be conducted. if a gene is truly hypo-tolerant or even essential, disruption of this gene would reduce growth fitness or even cause death of the strain. similarly,knockout of a hyper-tolerant gene would induce advantages for corresponding bacterial growth. the real data we obtained only studied one growth condition, and we propose to use pseudogenes as an internal standard to set the threshold that classifies normal genes into hypo-tolerant, tolerant and hyper-tolerant categories. the threshold depends on the reliability of the list of pseudo-genes and gene annotations. pseudogenes are a regular feature of bacterial genomes, which are dna sequences that are closely related to functional genes but have mutations that destroy the function . they are usually identified by comparison with the functional sequence in a close relative (allele if in the same species, homlog if in another species;). the mutations in pseudogenes introduce premature stop codon or frame-shift, and then prevent normal translation of a functional protein. in terms of nucleotide composition and length, they are similar to other genes in their genomes. among different strains of c.jejuni, we found that the number of pseudogenes ranges from 18 (i.e. in ia3902) to a few hundreds, which account for about 110 of the open reading frames of their genomes. in other taxa, pseudogenes were commonly found to be at the similar ratio, as revealed in staphylococcus pyogenes, vibrio vulnificus, vibrio parahaemolyticus, yersinia pestis and salmonella . in experiments where several growth conditions are included, our method can be easily generated to those applications by involving growth conditions as factors in modeling the insertion probability and the poisson mean. our proposed method allows incorporation of covariates into the zip model and accommodates factors that might affect the insertion rate. in the real data analysis, we quantified the increased insertion probability for the insertion sites matching the target sequence of the tn5 transposon. such quantification provides insights into the mechanism of transposon insertion. besides matching with target sequence, other factors that may potentially affect the transposon insertion rate can also be fit into the zip model and tested for significance. factors that may affect the mean abundance (l g ) may also be incorporated into the model through poisson regression. large sample theory is implemented in our method while applying the wald test. in our tn-seq data, we have more than one million locations, which justifies the large sample assumption is satisfied. the estimated values of mean abundance have been used to classify normal genes into the three tolerance groups. in addition, the magnitude of the estimated values of mean abundance measures how important the corresponding genes are with respect to bacterial growth. if the estimated mean mutants abundance of a normal gene is far above that of pseudogenes, this suggests that the inactivation of this normal gene by transposon insertion provides an obvious growth advantage. on the other hand, if the estimated mean mutants abundance of a normal gene is far below that of pseudogenes or even close to zero, this normal gene may have essential function on bacterial growth. to test for finite sample behavior of our method, we also tried a simulation study in which only several genes were simulated and we varied the number of possible insertion locations for each gene to check when our method is applicable, and it turns out that the result is good enough as long as the number of possible insertion locations is 50 or more. conflict of interest: none declared.  
