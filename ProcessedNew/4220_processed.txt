sharaku: an algorithm for aligning and clustering read mapping profiles of deep sequencing in non-coding rna processing motivation: deep sequencing of the transcripts of regulatory non-coding rna generates footprints of post-transcriptional processes. after obtaining sequence reads, the short reads are mapped to a reference genome, and specific mapping patterns can be detected called read mapping profiles, which are distinct from random non-functional degradation patterns. these patterns reflect the maturation processes that lead to the production of shorter rna sequences. recent next-generation sequencing studies have revealed not only the typical maturation process of mirnas but also the various processing mechanisms of small rnas derived from trnas and snornas. results: we developed an algorithm termed sharaku to align two read mapping profiles of next-generation sequencing outputs for non-coding rnas. in contrast with previous work, sharaku incorporates the primary and secondary sequence structures into an alignment of read mapping profiles to allow for the detection of common processing patterns. using a benchmark simulated dataset, sharaku exhibited superior performance to previous methods for correctly clustering the read mapping profiles with respect to 5 0-end processing and 3 0-end processing from degradation patterns and in detecting similar processing patterns in deriving the shorter rnas. further, using experimental data of small rna sequencing for the common marmoset brain, sharaku succeeded in identifying the significant clusters of read mapping profiles for similar processing patterns of small derived rna families expressed in the brain. availability and implementation: the source code of our program sharaku is available at http:// www.dna.bio.keio.ac.jp/sharaku/, and the simulated dataset used in this work is available at the same link. accession code: the sequence data from the whole rna transcripts in the hippocampus of the left brain used in this work is available from the dna databank of japan (ddbj) sequence read archive (dra) under the accession number dra004502.since high-throughput sequencing allows for deep sequencing with high sensitivity, rna sequencing with a next-generation sequencer (rna-seq) can detect not only the complete expression patterns of transcribed rnas but also fragments derived due to the splicing, maturation processing, or non-functional degradation of the rnas. rna-seq studies targeting micrornas (mirnas) have revealed the existence of many different rna fragments derived from small rna species other than microrna, providing further proof that derived rna fragments are not simply random degradation products but are rather stable entities, which might have functional activity . the evidence accumulating about shorter sequences or fragments derived from non-coding rnas indicates that post-transcriptional processes are relatively common mechanisms to derive functional smaller molecules from various rna families such as trnas and snornas. for example, the so-called trna-derived rna fragments (trfs) are derived from processing at the 5 0 or 3 0-end of mature or precursor trnas . these sequences constitute a class of short rnas that are the second most abundant type of rna after mirnas. since the discovery of small rnas derived from trnas, a variety of names have been used to refer to similar entities, such as trna-derived rna fragments (trfs) , stress-induced small rnas (tirnas) and trna-derived small rnas (tsrnas) . their uniform start and stop sites of cleavage in trna, together with their nonrandom size property, strongly suggest that trfs are derived from trna cleavage in a specific and regulated manner . in addition, several studies have identified a class of small fragments derived from snornas (called sdrnas), some of which may regulate splicing or translation . the biological roles of such sno-derived rna and trna-derived small rnas have primarily been investigated in cancer cells . trna-derived fragments participate in several types of biological processes, including as signal molecules in a stress-induced response and as regulators of gene expression. sdrnas can function as mirnas, regulators of alternative splicing, and tumor suppressors and oncogenes. the reads for such short derived rnas are relatively abundant, i.e. greater than background levels, in small rna-seq datasets. chen and heard (2013) pointed out that these reads are precisely mapped to specific regions of primary or secondary structures, and might contain special motifs or base biases, reflecting the involvement of special enzymes involved in their generation. hence, mapping a large amount of sequence reads onto a reference sequence can reveal specific forms of mapping patterns for the maturation process or random patterns for non-functional degradations (see(a)). these mapping patterns of rna-seq short reads constitute the socalled read mapping profiles (see(b)) .also pointed out that the non-specific degradation products include rna fragments that are rapidly digested by the surveillance machinery from rna molecules, which are defective in processing, folding and functions. thus, it is crucial to reliably distinguish the true shorter rnas from their non-functional degradation products to clearly identify derived and functional small rnas and fragments. therefore, the aim of the present study was to develop a computational tool for the comprehensive analysis and rapid identification of the post-transcriptional processing patterns of non-coding rnas based on high-throughput rna-seq data. the algorithm developed in this study was designed to capture specific forms of read mapping patterns mapped to specific regions of primary or secondary structures reflecting the functional activities of enzymes, and to distinguish them from non-functional degradation products. there are only a few existing tools to analyze such read mapping profiles of rna-seq data and detect footprints of the post-transcriptional processes or degradations of rnas. flaimapper predicts and annotates non-coding rna-derived fragments by determining the start and stop positions from read mapping profiles. flaimapper can predict mirna boundaries with high accuracy. deepblockalign , which our present study takes quite a similar approach to, is an alignment-based method for alignments of read mapping profiles to find non-coding derived rnas that share similar post-transcriptional processing. alps is also alignment-based, but is not designed for the purpose of identification of short derived rna fragments. blockclust computes a similarity score between read mapping profiles to detect similar processing patterns and cluster read mapping profiles. blockclust includes a high-dimensional feature representation to encode read mapping profiles and calculates the similarity scores based on a graph kernel. therefore, blockclust does not rely on alignment-based techniques and is not designed for the purpose of calculating the alignment of read profiles. however, all of these methods are computed based only on the information of read mapping profiles and do not take the rna sequence and secondary structure information into account. further, those methods did not address the reliable distinguishability of processing patterns from the random degradation. constructing an alignment for a pair of biological sequences such as dna, rna and protein sequences is a fundamental and robust method of sequence analysis . the pairwise alignment of biological sequences is achieved according to insertions, deletions and match operations so that the two sequences are aligned with the same column length. the similarity score of an alignment is calculated according to the predefined scores for insertions, deletions and matches. similarly, one can define the alignment between a pair of read mapping profiles (see(c)).an alignment of two read mapping profiles for snord14 and snord21 output by sharaku, using the small rna-seq data for the common marmoset brain with the annotations of rna sequence alignment and the predicted secondary structure. the solid line represents the read coverages of snord14, and the dashed line represents the read coverages of snord21. (d) schematic illustration of the necessity of incorporating the primary and secondary structures of rna sequences into an alignmentin previous work with the deepblockalign algorithm , the alignment program was designed to compare and align any read mapping profiles regardless of the rna family to which they belong. the alignment program was also applied to the comparison of read mapping profiles of the same rna gene across different samples that might be expected to induce different read mapping profiles . this method is effective for the differential processing analysis of read mapping profiles of each non-coding rna gene. in contrast with previous work, our primary goal was to detect specific forms among similar read mapping patterns mapped to specific regions of primary or secondary structures reflecting the functional activities of enzymes by alignments of read mapping profiles, and to distinguish these from non-functional degradation products. we developed a new read mapping profile alignment program named sharaku, which incorporates the primary and secondary structures of rna sequences into an alignment of read mapping profiles. this is accomplished in combination with dafs, a program for the simultaneous aligning and folding of rna sequences . as a result, the most advanced feature of sharaku is that it simultaneously aligns the read mapping profiles and rna sequences with the folding rna secondary structures. since each type of derived rna fragments is cleaved from its precursor with a specific context of primary sequence and secondary structure, we can expect that the simultaneous alignment of read mapping profiles with the primary and secondary structures contributes to precise identifications of the type of derived rnas. thus, application of sharaku to the mixture of different rna families would enable the accurate clustering of read mapping profiles with respect to 5 0-end processing or 3 0-end processing of each rna family, and facilitate the detection of common processing patterns shared among different rna families (see(d)). note that sharaku was not designed for classification of rna sequences into different rna families. further, sharaku produces an alignment of read mapping profiles at the nucleotidelevel resolution, as(c) displays. in contrast, deepblockalign uses blockbuster to generate block groups and aligns any read mapping profiles at the level of individual blocks and block groups, including those in unannotated regions or unknown rna genes. on the other hand, the current version of sharaku can only be applied to the annotated non-coding rna regions. several previous studies have explored the similarities and evolutionary relationships between snornas and mirna precursors. these similarity features represent molecules involved in the same processing pathways with a similar set of processing enzymes and the same rnai targets. these similarity features are often confirmed based on the conservation of their primary and secondary structures, such as structural characteristics of typical h/aca or c/d boxes. we hypothesized that in addition to sequence structure conservation, determining the similarity among read mapping profiles might help to identify the functional or processing similarities between snornas and mirna precursors.several previous studies have explored the similarities and evolutionary relationships between snornas and mirna precursors. as a result, various relationships between snornas and mirnas have been identified, from snornas with mirna features to dual function snomirnas and mirnas with snorna features. these similarity features represent molecules involved in the same processing pathways with a similar set of processing enzymes and the same rnai targets. these similarity features are often confirmed based on the conservation of their primary and secondary structures, such as structural characteristics of typical h/aca or c/d boxes. we hypothesized that in addition to sequence structure conservation, determining the similarity among read mapping profiles might helpwere added to the hybridization chamber and incubated with the blots. the membrane was then exposed to a phosphoimager and scanned. the largest band appearing at a distance just short of the 100-nt marker indicates the expression of the origin trna from which the short fragment rna was derived sharaku i375 to identify the functional or processing similarities between snornas and mirna precursors. an interesting small cluster in the clustering tree shown in(highlighted with an arrow and asterisk) consisted of a mixture of snornas, mirnas and trnas. in particular, we found that the snorna hbii-52 and the mirna let-7a have quite similar features in their secondary structures and read mapping profiles, indicating a similar processing mechanism to produce the derived shorter fragments at 3 0-ends.shows these features. indeed, small derived rnas from hbii-52 were previously reported to resemble mirnas . another interesting cluster is cluster (6) of the 5 0-end processing of mirnas. the cluster contained two trnas. pro-tgg-trna has the typical mirna-like secondary structure and mirna/ mirna duplex, shown in. supporting this result, previous work has indicated possible cross-talk between trna-derived rna fragments and the canonical pathway of mirnas . thus, the alignments and clustering of read mapping profiles using sharaku can give insight into revealing the common processing patterns in different families of non-coding rnas and their derived fragments, which could help to clarify the processing pathways and biological functions of derived rna fragments. one of the merits of sharaku is to calculate the optimal alignment based on not only the pattern of read mapping profiles, but also primary and secondary structures of rna sequences. since each type of derived rna fragments is cleaved from its precursor with a specific context of primary sequence and secondary structure, we can expect that the simultaneous alignment of read mapping profiles with the primary and secondary structures contributes to precise identifications of the type of derived rnas. to combine the pattern of read mapping profiles and the primary and secondary structures of rnas, a sankoff-type algorithm is required to be implemented. we implemented sharaku with dafs framework, which enabled to efficiently combine the pattern of read mapping profiles and the primary and secondary structures of rnas by the dual decomposition technique. in the present study, we have only dealt with annotated noncoding rnas. however, sharaku can also be applied to the alignment and clustering of novel and unannotated regions by employing tools such as blockbuster in order to determine the expressed block regions on the reference genome that are obtained from rna-seq reads. as non-functional degradation products, we only considered the degradation of rna from the 3 0-end in the simulated dataset. therefore, performance evaluations of sharaku to determine the tolerance for the other two classes of rna-degradations, endonucleases and 5 0 exonucleases, are required. these issues will be addressed in our future work.) and annotations with lines indicating the predicted locations of deriving fragments for a snorna hbii-52 and a mirna let-7a found in the clusters. the line for mirna secondary structure indicate the predicted locations of the mature mirna. the secondary structures predicted by rnafold and annotations, with lines indicating the locations of derived fragments for a trna pro-tgg-trna and an mirna let-7b found in the cluster of the 5 0-end processing of mirnas. the line for mirna secondary structure indicates the predicted locations of the mature mirna i376 m.tsuchiya et al.with the aim of offering computational tools for comprehensively analyzing the post-transcriptional processing patterns of non-coding rnas and detecting their common processing patterns, based on rna-seq, we developed a new algorithm called sharaku to align two read mapping profiles of next-generation sequencing data for non-coding rnas. sharaku incorporates the primary and secondary structures of rna sequences into an alignment of read mapping profiles by combining with dafs, which constructs reliable structural alignments that maximize the expected accuracy of a predicted common secondary structure and its sequence alignment. sharaku could simultaneously align the read mapping profiles and rna sequences with information of the folded rna secondary structures. in an experiment using a simulated dataset, sharaku achieved an almost perfect clustering result, and exhibited higher accuracy than deepblockalign. in an experiment with real data of small rna sequencing for the common marmoset brain, sharaku succeeded in identifying the five major clusters plus four scattered clusters representing typical processing patterns. this method also revealed some interesting clusters consisting of mixtures of several rna families that predicted common processing patterns among different rna families. these results demonstrate that sharaku can be an indispensable tool for analyses of the processing patterns and functions of regulatory non-coding rnas with deep-sequencing data.  
