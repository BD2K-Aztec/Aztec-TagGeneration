snpgenie: estimating evolutionary parameters to detect natural selection using pooled next-generation sequencing data new applications of next-generation sequencing technologies use pools of dna from multiple individuals to estimate population genetic parameters. however, no publicly available tools exist to analyse single-nucleotide polymorphism (snp) calling results directly for evolutionary parameters important in detecting natural selection, including nucleotide diversity and gene diversity. we have developed snpgenie to fill this gap. the user submits a fasta reference sequence(s), a gene transfer format (.gtf) file with cds information and a snp report(s) in an increasing selection of formats. the program estimates nucleotide diversity, distance from the reference and gene diversity. sites are flagged for multiple overlapping reading frames, and are categorized by polymorphism type: nonsynonymous, synonymous, or ambiguous. the results allow single nucleotide, single codon, sliding window, whole gene and whole genome/population analyses that aid in the detection of positive and purifying natural selection in the source population. availability and implementation: snpgenie version 1.2 is a perl program with no additional dependencies. it is free, open-source, and available for download at https://github.com/hugheslab/ snpgenie. contact:next-generation sequencing (ngs) technologies allow the rapid sequencing of pooled dna samples containing genetic material from multiple individuals. the resultant single-nucleotide polymorphism (snp) data may be used to reliably estimate population genetic parameters with more accuracy and less expense than the separate sequencing of multiple individuals , especially when samples are large and coverage is high. unfortunately, high coverage data also suffer from a substantial false-positive error rate. snp calling techniques can address this issue, but the only software currently available for evolutionary analysis of pooled ngs data, popoolation , is inextricable from a problematic snp caller that has an extremely high false-positive rate . further, popoolation relies on large pileup files and problematic simplifications, including use of the reference sequence alone to determine the number of nonsynonymous and synonymous sites. ideally, software for evolutionary analyses of these data would allow users to first call snps using any preferred method, and then process the results using standard methods for determining the numbers of nonsynonymous and synonymous differences and sites. we have developed snpgenie to meet this need. using snp calling results, snpgenie estimates: (i) nucleotide diversity (p), and its nonsynonymous and synonymous partitions (p n and p s ) for coding), circumventing a major limitation of pooled data for other applications . indefinitely large genomes with multi-nucleotide variants may be analysed at speeds exceeding those of popoolations default settings. the results allow users to test evolutionary hypotheses on the roles of negative (purifying) selection, positive (darwinian) selection and random genetic drift in the sampled population. in general, p n p s indicates neutrality, p n p s indicates purifying selection and p n p s may indicate positive selection favoring multiple amino acid changes . comparing h o at distinct polymorphic site categories may also address these hypotheses . parameter estimates are available at the nucleotide, codon, sliding window, whole gene and whole genome/population levels.to validate snpgenies execution of themethod, we constructed sequences with all 61 non-stop codons and known numbers of differences. mega version 6 was used to calculate p n and p s. snp reports and gtf files were then constructed to reflect the known variant frequencies and reference sequence, and snpgenie was used to estimate the same parameters. all results agreed to the last decimal. next, both snpgenie and popoolation were used to analyse a pooled h5n1 sample. the nonsynonymous and synonymous mean numbers of pairwise differences per site and numbers of sites (the numerator and denominator of p n and p s ) were then estimated for the hemagglutinin (ha; supplementary tables s1a and s1b) and neuraminidase (na; supplementary tables s2a and s2b) genes. when popoolation estimates were regressed on those from snpgenie, all r 2 values were significant (p 0.001; f-test), but smaller for differences in na. popoolation overestimated differences for ha and underestimated them for na, while overestimating the number of nonsynonymous sites . p was significantly lower in ha (p 0.01 for p n ; p 0.001 for p s ; two-sample t-tests), consistent with previous evidence for a population bottleneck upon viral transmission that is driven by selection for specific ha residues . because popoolation overestimated differences in ha, this suggests that its false discovery rate may be exacerbated in low-diversity (e.g. bottlenecked) contexts. most differences between snpgenie and popoolation can be attributed to: (i) differences in snp calling; (ii) popoolations treatment of stop codon variants as nonsynonymous; and (iii) snpgenies use of allele frequency data in determining the number of sites, contrasted to popoolations use of the reference sequence alone. popoolation also reports p s 0 for codons with no synonymous sites, where p s should be undefined. this could highly inflate the p n /p s ratio, overestimating the prevalence of positive natural selection. if the false positive calls are random, 75 will be nonsynonymous , exacerbating this problem. planned future improvements in snpgenie include additional snp report formats (e.g. vcf) and weighted mutational pathways.  
