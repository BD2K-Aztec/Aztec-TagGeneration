a novel approach for resolving differences in single-cell gene expression patterns from zygote to blastocyst during embryonic mouse development, the initially totipotent 1cell zygotes become restricted in their potential and through a sequential differentiation process, different lineages are generated. differentiation of embryonic stem cells of the mouse is thought to start in the 8-cell stage . first, differentiation between inner cell mass (icm) and trophectoderm (te) can be observed. the te gives rise to extra-embryonic structures such as the placenta while the icm subsequently differentiates into primitive endoderm (pe) and the epiblast (epi). although the pe will also give rise to extra-cellular structures providing nutrient supplies for the embryo, the pluripotent epi gives rise to the foetus . for a better understanding of the mechanisms and timing of cell fate decisions, it is desirable to assess gene expression patterns at different stages of the developing cells. conventional techniques measure these gene expressions from pools of cells; however, as fate decisions are made by individual cells, this may mask the dynamics of single cells . recent technical advances allow for measuring the expression of multiple genes in single cells by means of a quantitative polymerase chain reaction (pcr) method . such methods are a promising tool which will provide a new wealth of data in the future. to gain insights in underlying fate decisions, it is important to develop computational techniques allowing for a comprehensive analysis of this new type of data. in this article, we present our new approach at the example of the cellular development of the mouse zygote to blastocyst; however, our methodology is not limited to this particular example and can be applied to a range of other datasets and cell types. the most comprehensive analysis to date linking cell fate decision during the development of the zygote to the blastocyst to gene expression data has been performed by . the authors analysed the expressions of 48 genes in single cells. therefore, the expression levels of these 48 genes were measured at different stages of the cellular development (from 1-cell stage of the mouse embryo to 64-cell stage) on a single-cell level. have analysed these data by performing a pca of expressions of 48 genes for cells at the 64-cell stage. although it was possible to use results from the pca to resolve transcriptional differences between te, pe and epi cells, no differences in gene expression patterns for cells until the 16-cell stage could be resolved using pca. although this analysis provided valuable insights into cell fate decisions after the 16-cell stage, the authors reported that no differences in gene expression patterns could be found for earlier stages in the cell development. in a subsequent analysis, the authors identified id2 and sox2 as the earliest markers for differentiation of outer and inner cells followed by inverse correlations of fgfr2/fgf4 in the inner cell mass. however, id2 and sox2 could only be. the totipotent blastomere differentiates first into inner and outer cells. next, after approximately 3.5 days, the icm differentiates into pe cells and epi cells (a). the data-driven illustration is shown on the right hand side. for pca (panel b), differentiation into icm and te can be seen, followed by differentiation from icm into pe and epi. icm and pe/epi as well as early cell stages could not be resolved. for our novel approach (bottom right), all developmental stages could be resolved and a new te-like sub-population at the 16-cell stage was discovered. the dashed arrows reflect that the lower subpopulation at the 16-cell stage is significanlty more te-like than the other identified by a univariate analysis of the distribution of gene expressions within the 16-cell stage and the 32-cell stage. although pca proved to be a useful technique to identify some markers for te, pe and epi stage, a different approach for dimensionality reduction which embeds the high-dimensional data nonlinearly in a twodimensional or three-dimensional space, may yield deeper insights. thus, differentiation is thought to start as early as at the 8-cell stage ; if this is reflected in early changes in gene expression patterns, it may be possible to identify these changes by embedding the data in a low-dimensional space. taking into account potentially complex interrelations between different genes may result in an embedding better reflecting the true structure of the data and allowing for reliable identification of new subpopulations and markers, also in these early cell stages. however, identifying a suitable alternative to pca is challenging for several reasons. first, there is usually a trade-off between interpretability and complexity of an embedding: linear techniques such as pca are usually well interpretable as those factors which are most important at specific areas of the mapping can be identified by analyzing the loadings of the pca. in contrast, the results of many more complex, nonlinear embeddings are hard to interpret as no explicit mapping between the low-dimensional latent space and the highdimensional data space (or vice-versa) is related to the embedding. second, it is not clear how the group structure of the data, i.e. the fact that different instances of the data come from one of seven different developmental stages, can be considered when performing the embedding. at one extreme, it is possible to perform one embedding of all the data pooled together without considering its structure; at the other extreme, it is possible to perform a separate embedding for each developmental stage. both approaches have severe drawbacks, as in the first approach potentially useful information is discarded while in the latter approach similarities across cell stages are not considered.using a nonlinear embedding allows to assess differences in gene expression patterns, both within the same developmental stages and across different developmental stages which cannot be resolved with linear pca. we have presented a framework which combines the advantages of nonlinear dimensionality reduction methods with interpretability and the ability to take prior knowledge on the structure of the data into account. this was achieved by taking advantage of the smooth mapping within gplvms as this allows for the construction of relevance maps which illustrate which genes are most important at different stages of the embryonic development. furthermore, an additional term in the likelihood of gplvm was introduced which encourages the preservation of small local distances between data points of the same developmental stage. this facilitates a better discovery of novel subclasses within the same developmental stage. although we have presented this framework at the example of single-cell gene expression data of the developing mouse embryo, our algorithm is suitable for a wider range of problems: our result indicates that it may be beneficial for datasets consisting of single-cell gene expression data from different groups of cells, when at least one of the groups is expected to be heterogeneous. for example, this can be the case for other types of stem cells such as blood stem cells from different developmental stages or tumour cells from different clinical or pathological stages. the separation of the 16-cell stage in two distinct subclusters could be discovered using the extended gplvm; it could be shown that the cells assigned to one of the subclusters were significantly more similar to te cells than the cells in the other subcluster. this indicates that these cells may be more likely to become te cells than icm cells in subsequent stages of the cellular development. when analyzing differences in the gene expressions patterns of the two newly identified subpopulations, the strongest difference occurred for id2. this is consistent with the findings in (who report that id2 is the earliest te-specific marker; however, we also found considerable differences in the levels of gata4 and, to a smaller extent, klf4 and hand1. although identified subpopulations with high/low id2 at the 16-cell stage via a univariate violin-plot, we have shown that these sub-populations can also be resolved using the extended gplvm framework. this has the advantage that the differences in gene expressions across all 48 genes can be identified simultaneously, rather than changes in one gene only. thus, it can be seen from the analysis of the sub-clusters that not only id2 is differentially expressed but also gata4; this suggests that not only id2 but also the expression level of gata4 at the 16-cell stage could indicate whether a cell is more likely to become a te cell or an icm cell. similarly, hand1, which is a known marker for te cells , was differentially expressed between the two subclusters in the 16-cell state. furthermore, a gplvm-based approach to identify new subpopulations scales well to higher dimensions. although it is possible to analyse univariate violin-plots for 48 genes, this can become impractical when a very high number of genes is analysed. although the application of the extended gplvm algorithm allows for a clear separation of two subclusters in the 16-cell stage, the parameter has to be chosen carefully; to find an adequate value resulting in a mapping with the right balance of preserving dissimilarities as well as local distances within developmental stages, it can be necessary to vary over a wide range which may be time-consuming. in general, when trying to find an appropriate value for , it can be helpful to start off with standard gplvm ( = 0). next, can be increased iteratively until the data are broken up in many small, isolated clusters of similar data-points; in this case (as illustrated infor early cell stages), too much weight is placed on preserving small local distances. depending on the application of the algorithm, it may also be beneficial to use a different distance measure or a different cost function to encourage the preservation of local distances. although we have used euclidean distances to calculate the distances in the data space, it is also possible to use measures such as a correlation coefficient or the l1 measure. furthermore, different cost functions i631we have presented a novel framework for resolving differences in gene expression patterns for the early mouse embryo based on single-cell gene expression data. therefore, a nonlinear mapping between a low-dimensional latent space and the high-dimensional data space was combined with gene relevance maps and gradient plots in order to ensure interpretability. a novel extension to the gplvm algorithm taking the local structure of the data into account and preserving small local distances within the same developmental stage was presented. using this new approach, we could resolve differences of gene expressions between all cell stages as well as identify a new sub-population at the 16-cell stage with was significantly more te-like than other cells at the 16-cell stage.  
