co-expression analysis of high-throughput transcriptome sequencing data with poisson mixture models motivation: in recent years, gene expression studies have increasingly made use of high-through-put sequencing technology. in turn, research concerning the appropriate statistical methods for the analysis of digital gene expression (dge) has flourished, primarily in the context of normalization and differential analysis. results: in this work, we focus on the question of clustering dge profiles as a means to discover groups of co-expressed genes. we propose a poisson mixture model using a rigorous framework for parameter estimation as well as the choice of the appropriate number of clusters. we illustrate co-expression analyses using our approach on two real rna-seq datasets. a set of simulation studies also compares the performance of the proposed model with that of several related approaches developed to cluster rna-seq or serial analysis of gene expression data. availability and and implementation: the proposed method is implemented in the open-source r package htscluster, available on cran.the application of high-throughput sequencing (hts) to the study of gene expression has revolutionized the scope and depth of understanding of the genome, epigenome and transcriptome of dozens of organisms. in particular, the recent use of hts technologies to sequence ribonucleic acid content (rna-seq), has rivaled the use of microarrays for transcriptomic studies as it offers a way to quantify gene expression without prior knowledge of the genome sequence by providing counts of transcripts. although both technologies seem to be complementary , rna-seq can provide information about the transcriptome at a level of detail not possible with microarrays, including allele-specific expression and transcript discovery. although a variety of different protocols exist for hts studies, the same broad preprocessing steps are followed. namely, if an appropriate genome sequence reference is available, reads are mapped to the genome or transcriptome; otherwise, de novo assembly may be used. after alignment or assembly, read coverage for a given biological entity (e.g. a gene) is subsequently calculated. the quantification of gene expression in rna-seq data remains an v c the author 2015. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.com active area of research , and in this work, we focus on measures of digital gene expression (dge) (counts). these count-based measures of gene expression differ substantially from data produced with microarrays. for example, rna-seq data are discrete, positive, and highly skewed, with a very large dynamic range. in addition, due to the sampling nature of sequencing, low precision tends to be observed for weakly to moderately expressed genes . finally, sequencing depth (i.e. the library size) and coverage vary between experiments, and read counts are known to be correlated with gene length . to date, most developments concerning the statistical analysis of rna-seq data have dealt with the issues of experimental design , normalization and the analysis of differential expression . in this work, we focus on the question of co-expression analyses for rna-seq data. identifying biological entities that share similar profiles across several treatment conditions, such as coexpressed genes, may help identify groups of genes that are involved in the same biological processes . clustering analyses based on metric criteria, such as the k-means algorithm and hierarchical clustering , have been used to cluster microarray-based measures of gene expression as they are rapid, simple and stable. however, such methods require both the choice of metric and criterion to be optimized, as well as the selection of the number of clusters. an alternative to such methods are probabilistic clustering models, where the objects to be classified (genes) are considered to be a sample of a random vector and a clustering of the data is obtained by analyzing the density of this vector . presently, most proposals for clustering rna-seq data have focused on grouping together biological samples rather than biological entities (e.g. genes). for example, anders and huber (2010) perform a hierarchical clustering with a euclidean distance of samples following a variance-stabilizing transformation, andcluster fourteen diverse tissues of soybean using hierarchical clustering with pearson correlation after normalizing the data using a variation of the reads per kilobase per million mapped reads (rpkm) measure.discussed the clustering of samples using hierarchical clustering with a modified loglikelihood ratio statistic as distance measure based on a poisson loglinear model; this model is similar to that offor the clustering of serial analysis of gene expression (sage) gene profiles using a k-means algorithm and a poisson loglinear model. more recently,considered poisson and negative binomial mixture models to develop a modelbased hybrid-hierarchical clustering algorithm. in this work, like, we focus on the use of poisson loglinear models for the clustering of countbased hts expression profiles; however, rather than using such a model to define a distance metric to be used in a k-means or hierarchical clustering algorithm, we make use of finite mixtures of poisson loglinear models. this framework has the advantage of providing a straightforward procedure for parameter estimation and model selection, as well as a per-gene conditional probability of belonging to each cluster.for each simulated dataset in the two settings (fly and human liver), htscluster and the methods described in section 3.2.1 were fit over a range of possible numbers of clusters (k 1;. .. ; 40), with model selection performed using the slope heuristics (htscluster, poisl) or the ch index (witten, si-nb, si-pois). in addition, for all competing approaches, the model with the true number of clusters (k 15) was also included. models were subsequently compared using the adjusted rand index (ari) and the estimated number of clusters k, shown in tables 1 and 2, respectively. the oracle ari is also included for comparison, based on the assignment of observations to components maximizing the conditional probability using the true parameter values in the poisson mixture model. in both simulation settings considered here, we note that a major difficulty for the alternative methods is the choice of the number of clusters to be included; the witten, si-pois, and si-nb methods all exhibit significantly lower ari values when model selection is performed using the ch index as compared to when the true number of clusters is fixed. this difficulty appears to be especially pronounced for the witten approach, where ari values for the model selected using the ch index is less than 0.2 in both simulation settings and the selected number of clusters is significantly underestimated. for the si-pois and si-nb methods, the ch index also tends to underestimate the number of clusters present in the data, although this trend is less marked than for the witten approach, particularly in the human simulated data. in the case of the poisl approach, although the slope heuristics approach appears to generally yield an appropriate estimate of k in both simulation settings, the corresponding ari values tend to be lower than those attained by thehtscluster approach. even when the number of clusters is fixed to the true value, the competiting methods tend to have equivalent or smaller ari values than the models selected via slope heuristics for the proposed htscluster approach, in spite of the fact that all approaches (with the exception of si-nb and k-means) also make use of an underlying poisson model. in other words, if the true number of clusters is known, the performance of the si-pois and si-nb approaches is quite good and very nearly attains that of the oracle model; however, when the number of clusters must be estimated from the data (as is typically the case in real applications), htscluster has much stronger performance than the competing methods on these simulated data. model selection via the slope heuristics for the htscluster approach leads to a slight overestimation of the number of clusters, but these slightly more complex models have ari values close to those found using the oracle poisson mixture model. finally, we note that the clustering task in the human liver setting (where only two conditions are present) appears to bein this work, we have proposed a method and associated r package htscluster to cluster count-based dge profiles based on a poisson mixture model that enables the use of a rigorous framework for parameter estimation (through the em algorithm) and model selection (through the slope heuristics). the model is parameterized to account for several characteristics of rna-seq data, including: (i) a set of normalization factors (s jl ) to account for systematic differences in library size among biological replicates, (ii) a per-gene offset parameter (w i ) to account for differences among genes due to overall expression level and (iii) a condition-specific cluster effect (k jk ). as the marginal sums of each gene are fixed in the model, variations in expression among experimental conditions may be modeled throughout the extremely large dynamic range of dge typical of rna-seq data. in particular, this parameterization enables a straightforward interpretation of the model, as k jk s j corresponds to the proportion of reads attributed to condition j in cluster k. a co-expression analysis on two sets of real rna-seq data highlighted the functionality of htscluster in practice, in particular with respect to model selection and visualization of overall cluster behavior. finally, the processing time and memory requirements ofhtscluster reflect the fact that parameter estimation must be performed over a large set of models to enable model selection; one run of htscluster (version 2.0.4) took about 50 minutes and used about 450 mb of memory for the human liver data (k 1;. .. ; 50), and about 2 h with 1800 mb of memory for the fly developmental data (k 1;. .. ; 60). (all analyses were run on a dell latitude e6530 quad-core 2.70 ghz intel(r) core(tm) with 10gb ram, running a 64-bit version of windows 7 professional.) as previously mentioned, htscluster shares some similarities with other related approaches, although there are several key differences. first, we note that both poisl and witten (2011) also make use of an underlying poisson model; however, rather than using a finite mixture model, the former uses a k-means algorithm based on the loglikelihood and the latter applies a hierarchical clustering procedure based on a pairwise dissimilarity matrix of dimension (n n). on the other hand,suggest the construction of a hierarchical tree of either poisson (si-pois) or negative binomial (si-nb) mixture models with an alternative parameterization to that proposed here. contrary to all of these alternative related approaches, the htscluster approach provides a straightforward and robust way to choose the number of clusters present in a given dataset. a set of simulation studies, with parameters selected based on two real datasets, allowed a comparison of htscluster with the aforementioned related approaches in a controlled scenario. these simulations highlighted the importance of an appropriate procedure to perform model selection, as well as the satisfactory performance of htscluster in the objective of clustering and estimating the number of clusters. in addition, even when the number of clusters was fixed to the true value, we found that the alternative methods were generally observed to have similar or lower ari values than htscluster. however, conclusions from these simulations should be drawn with some caution, particularly as the data were simulated based on a mixture of poisson distributions. a great deal of discussion has focused on the most appropriate way to simulate rna-seq data in the context of differential expression , and for the time being this remains an open question for co-expression analyses. finally, we note that in the context of differential expression analyses, the scientific community has generally focused on the use of negative binomial models due to the large variability typically observed among replicates for a fixed gene. this so-called overdispersion is modeled via the inclusion of a common dispersion parameter / or a per-gene dispersion parameter / i , typically estimated using a shrinkage approach or a parametric regression fit across all genes . the si-nb approach recently attempted to apply a similar approach to the task of co-expression analysis through a finite mixture of negative binomial models, where / i is estimated from the data using a quasi-likelihood approach and treated as fixed in the mixture. however, for co-expression analyses it is difficult to estimate these per-gene dispersion parameters in practice due to the small number of replicates typically available in experiments concerning multiple conditions. a useful direction for future research may be to define a mixture of negative binomial models in which information about this dispersion parameter is shared among genes belonging to the same cluster.  
