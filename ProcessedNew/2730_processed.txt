lncrna-id: long non-coding rna identification using balanced random forests motivation: long non-coding rnas (lncrnas), which are non-coding rnas of length above 200 nucleotides, play important biological functions such as gene expression regulation. to fully reveal the functions of lncrnas, a fundamental step is to annotate them in various species. however, as lncrnas tend to encode one or multiple open reading frames, it is not trivial to distinguish these long non-coding transcripts from protein-coding genes in transcriptomic data. results: in this work, we design a new tool that calculates the coding potential of a transcript using a machine learning model (random forest) based on multiple features including sequence characteristics of putative open reading frames, translation scores based on ribosomal coverage, and conservation against characterized protein families. the experimental results show that our tool competes favorably with existing coding potential computation tools in lncrna identification.it has been suggested that less than 2 of the human genome codes for proteins . the majority of the transcriptome contains non-coding rna (ncrna) genes , which function directly as rnas instead of coding for proteins . the most recently discovered class of ncrnas is long non-coding rnas (lncrnas), which are generally defined as non-coding transcripts of length above 200 nucleotides . increasing evidence has shown that lncrnas play important and diverse biological functions. for example, lncrnas anril and hotair bind to chromatin-remodelling complexes prc1 and prc2 to alter chromatin and transcription. gas5 lncrna acts as a decoy for the gr transcription factor and prevents gr from binding to dna and transcriptional activation. malat1 rna binds to sr proteins to regulate mrna alternative splicing, whereas bace-1as rna binds to the complementary bace-1 mrna to regulate bace-1 translation. as a result, the dysfunctions of lncrnas are associated with a wide range of diseases ranging from neurodegeneration to cancer . lncrnas exist in many species such as arabidopsis , zea mays , honey bee , chicken and zebrafish . in recent years, a large number of lncrnas have been identified. gencode comprises 9277 manually annotated lncrna genes in the human genome. the lncrnadisease database contains 1564 human lncrnas that are likely to be associated with diseases. thus, given the functional importance and ubiquity of lncrnas, it is important to annotate them on a genome scale in various species. with the advances of the next-generation sequencing technologies, the transcriptomes of a large number of organisms have been sequenced, providing us a unique opportunity to mine lncrnas. the assembled transcripts contain different types of functional elements such as small ncrnas, lncrnas and protein-coding genes. lncrnas can be effectively distinguished from most small ncrnas, such as v c the author 2015. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.com mirnas and snornas, using size as the main criterion. however, lncrnas share similarities with protein-coding transcripts in terms of transcript length and splicing structure . in addition, lncrnas tend to encode putative open reading frames (orfs). for instance, h19, xist, mirg, gtl2 and kcnqot1 all have putative orfs greater than 100 amino acids, but have been characterized as functional ncrnas . thus, a major challenge for lncrna identification is to distinguish lncrnas from proteincoding genes, especially in non-model organisms lacking comprehensive protein-coding gene annotation. many efforts have been made to distinguish between lncrna and protein-coding transcripts, ranging from applying a threshold for a single feature to more complicated supervised machine learning methods. one commonly used feature is the length of the orf. for example, a simple approach is to classify a transcript containing an orf of length above 100 amino acids as a protein-coding gene . this criterion is arbitrary and is not always correct . using this simple criterion, the mouse xist rna gene , which encodes a putative orf of 298 amino acids (aa), was mis-classified as a protein-coding gene when it was first discovered . a probability model constructed from multiple criteria has also been used to identify protein-coding and non-coding regions such as the one used in the phylogenetic codon substitution frequencies (phylocsf). phylocsf is based on nucleotide substitutions of multispecies sequences. it uses multiple sequence alignments to calculate the phylogenetic conservation score. as an alignment-based method, it usually requires high quality alignments , which are not trivial to produce and can incur high computational cost. more accurate approaches for identifying lncrnas use supervised machine learning methods. these approaches can be further divided into two types. one relies on sequence alignments and the other is alignment-free. representative examples of alignment-based methods include coding-potential calculator (cpc) . cpc aligns transcripts against known protein databases. as homologous protein-coding genes tend to share higher sequence conservation than lncrnas, the alignment score or its statistical significance provides useful information to differentiate these two types of transcripts . an alternative and faster approach is alignment-free methods such as cpat and plek . cpat integrates linguistic features of transcript sequences into a logistic regression model for lncrna prediction. plek integrates k-mer based features into a support vector machine to distinguish lncrnas from mrnas. in addition, cpat and plek allow users to create a model with their own data. this option, which is not present in cpc and phylocsf, is very useful for lncrna identification in different species. despite the promising progress for lncrna identification, there is still a need for better approaches and tools. in particular, existing machine learning-based tools do not carefully handle the imbalanced training data, in which one class has far more instances than the other. the issue of imbalanced training data is particularly pronounced for lncrna identification when it is formulated as a binary classification problem in existing tools. for example, due to poor annotation of lncrnas, many species have far less characterized lncrnas than protein-coding genes. as a result, a classifier tends to over-predict query transcripts as the protein-coding transcript (major class) . in addition, many existing tools need users to provide a score threshold for lncrna identification, which is not always obvious from users perspective. for example, phylocsf and cpat do not suggest the specific type of an input transcript, but only output a coding potential score. the predefined score cutoffs of phylocsf and cpat vary from species to species. phylocsfs score cutoffs of 50 and 300 were used for mouse and zebrafish , respectively. cpat suggests the score cutoffs of 0.364 and 0.44 for human and mouse, respectively. these specific score cutoffs cannot be immediately applied to other species. even worse, not every tool can be trained on different species to provide users with necessary information to choose an appropriate score cutoff. in this article, we present lncrna-id, an lncrna identification tool, which applies random forest (rf) classification to distinguish lncrnas from protein-coding genes. rf is a classification model aggregating multiple classification trees generated from boot-strap samples and has been successfully applied in bioinformatics . lncrna-id has several advantages over existing tools. first, it still takes advantage of alignment-based features, which have strong discriminative power. however, instead of using genome-scale multiple sequence alignments or pairwise alignments against all existing protein sequences, lncrna-id uses profile hidden markov model (profile hmm)-based alignments, rendering more sensitive homology search and shorter running time than existing alignment-based lncrna identification tools. second, lncrnaid is easy to use as it does not require users to provide a score cutoff. it automatically determines the type of a query transcript as well as provides a coding potential score. third, lncrna-id can be applied to various species by providing an option to train the classifier for different data. fourth, lncrna-id does not require a large number of training data of neither protein-coding transcripts nor lncrnas to construct a classifier and can handle imbalanced classes in the training data. in our experiments, we evaluated the performance of lncrna-id on two different species, human and mouse. in addition, we benchmarked lncrna-id with cpc, cpat, phylocsf and plek on both species. the experimental results show that lncrna-id has both good sensitivity and specificity.lncrna-id can be applied to different species. we evaluated the performance of lncrna-id on both human and mouse. specifically, we used four datasets. the first human dataset (h1) and the mouse dataset (m1) were generated from gencode consortium within the framework of the encode project. gencode is known to have the most comprehensive annotation of long non-coding rnas available to date. the second human dataset (h2) is cpats original dataset generated from multiple resources: refseq , a human lncrna catalog and gencode. we further conducted four additional experiments simulating training data with different imbalanced ratios to demonstrate that lncrna-id was able to maintain robust performance with imbalanced training data. finally, we tested lncrna-id on a small but experimentally verified lncrna dataset from mouse (m2). to quantify the classification performance, we used five standard metrics: sensitivity, specificity, accuracy, false positive rate (fpr), positive predictive value (ppv) and f-score, which are defined as follows: sensitivity tp tp fn ; specificity tn tn fp accuracy tp tn p n ; fpr fp fp tn ; ppv tp tp fp f score 2 sensitivity ppv sensitivity ppv lncrnas are regraded as the positive class and protein-coding transcripts are regarded as the negative class. tp is the number of correctly classified lncrnas and tn is the number of correctly classified protein-coding transcripts. sensitivity is the proportion of correctly classified lncrnas in the set of all lncrnas. specificity is the proportion of correctly classified protein-coding transcripts in the set of all protein-coding transcripts. accuracy is the ratio of correctly classified transcripts in all predictions. false positive rate (fpr) refers to the portion of falsely classified lnrnas among all protein-coding transcripts. ppv is a ratio of true positives to combined true and false positives. f-score is the harmonic mean of sensitivity and ppv and hence can be used as a single measure for the overall classification performance.in this work, we have proposed and implemented lncrna-id, an accurate lncrna identification tool using balanced random forest classification. lncrna-id ensembles multiple random forest classifiers induced from balanced down-sampled data and thus is able to maintain robust performance with imbalanced and limited learning data. the experimental results in both human and mouse genomes demonstrate that the features used by lncrna-id have strong discriminative power in distinguishing lncrnas from protein-coding transcripts. in addition, we conducted experiments using lr, which combines our feature set with the logistic regression model in cpat, and compared its performance with lncrna-id. the experimental results showed the utility of balanced random forest model for highly imbalanced training data. according to our empirical experimental results, the ribosome interaction features are the most discriminative features. the reason might be that ribosome is closely related to the protein translation mechanism, which is the major difference between coding and noncoding transcripts. in our experiments, we focused on the ribosome interaction in eukaryotes where annotated lncrnas are more publicly available. in eukaryotes, a small 40s ribosomal subunit contains 18s rrna whereas in prokaryotes a small 30s ribosomal subunit contains 16s rrna. further study is needed to investigate whether the similar ribosome signal could be captured with 16s rrna as with 18s rrna. among all classification tools, phylocsf had the worst performance. a closer look at this result shows that in the human dataset, phylocsf could not determine the coding status of a decent amount of lncrnas (16.97) and some coding transcripts (0.03). this is because they are either non-conserved transcripts or do not have sufficient long orfs. if both ribosome profiling data (ribo-seq) and mrna-seq data are available, a more accurate ribosome release signal could be measured using the number of mapped reads on orf and 3 0 utr. the rrs is then defined as the ratio of the two normalized ratios of mapped reads on these two regions, rrs r orf =r 3 0 utr riboseq =r orf =r 3 0 utr mrnaseq , where r is the number of mapped reads on a sequence. plek has comparable performance to lncrna-id on human but did not perform well on mouse data. plek was run on the prebuilt model, which was trained on a very large number of coding transcripts and lncrnas. thus it is possible that their training data contains some of our testing data and leads to very good performance on human. if plek can be re-trained using our training data, we can conduct a more thorough comparison.  
