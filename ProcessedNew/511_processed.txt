as-rigid-as-possible mosaicking and serial section registration of large sstem datasets motivation: tiled serial section transmission electron microscopy (sstem) is increasingly used to describe high-resolution anatomy of large biological specimens. in particular in neurobiology, tem is indispensable for analysis of synaptic connectivity in the brain. registration of sstem image mosaics has to recover the 3d continuity and geometrical properties of the specimen in presence of various distortions that are applied to the tissue during sectioning, staining and imaging. these include staining artifacts, mechanical deformation, missing sections and the fact that structures may appear dissimilar in consecutive sections. results: we developed a fully automatic, non-rigid but as-rigid-as-possible registration method for large tiled serial section microscopy stacks. we use the scale invariant feature transform (sift) to identify corresponding landmarks within and across sections and globally optimize the pose of all tiles in terms of least square displacement of these landmark correspondences. we evaluate the precision of the approach using an artificially generated dataset designed to mimic the properties of tem data. we demonstrate the performance of our method by registering an sstem dataset of the first instar larval brain of drosophila melanogaster consisting of 6885 images. availability: this method is implemented as part of the open source software trakem2transmission electron microscopy (tem) offers currently the highest available resolution to investigate the structure of biological samples. the superior resolution of tem is classically used to reveal subcellular structures such as organelles and some of the largest macromolecular assemblies inside cells. for anatomical studies on the tissue level, tem finds most applications in neurobiology to reveal neuronal connectivity maps that underlie the function of the nervous system. the reconstruction of the complete neuronal connectivity map in caenorhabditis elegans remains the pinnacle of these studies . on the nanometer scales, brains are gigantic structures and many overlapping images must be assembled as a mosaic to cover a substantial portion of the tissue. moreover, serial sectioning is required to capture the volume of the specimen (d). digital imaging and high-precision beam or specimen shifting equipment simplifies the reconstruction of to whom correspondence should be addressed. mosaics within one section by providing a good initial estimate of the tile configuration . however, due to the minute distances involved the precision of the instruments is insufficient for seamless stitching of the tiles . adjacent sections are rotated and translated arbitrarily with respect to each other . physical sectioning, the subsequent manipulation of the sections by contrast gaining staining procedures and imaging with the electron beam introduce significant distortions and artifacts into the captured images (h). the goal in reconstruction of serial section tem (sstem) data is to identify the configuration of all tiles that best preserves both the continuity and geometry of 3d structures in the specimen making it amenable for subsequent segmentation and analysis. particularly in neurobiology, it is important to preserve the continuity of axons across large distances and the ability to distinguish and localize synaptic connections between neurons.propose a registration pipeline for large sstem datasets based on correlation of image intensities within and across sections. they are able to identify overlapping tiles in unordered sets automatically, mosaic them by propagating pairwise translation and refine this initial layout by warping each tile to its preceding partners. the resulting section mosaics are registered relative to each other by searching a rigid transformation initially and subsequently warping one section to the other. this solution guarantees continuity of 3d structures by maximizing the overlap of similar image content in adjacent sections. on the other hand, it cannot preserve geometrical properties because the unavoidable registration error is accumulated with each consecutive registration step. instead of using all image intensities, it is possible to register two or more images using corresponding salient points as a statistic about the image content as proposed byfor panorama stitching. reducing the problem from full resolution image content to a relatively small number of corresponding points simplifies the estimation of the globally optimal configuration for a large number of tiles. state of the art techniques (; tuytelaars and van) allow both automatic detection of interest points and extraction of affine invariant local descriptors for these points. affine invariant matching becomes nearest neighbor search in a local feature descriptor space. it was shown bythat the local descriptor as used in the scale invariant feature transform (sift;) outperforms competing techniques in both distinctiveness and robustness with respect to significant image deformation and other disturbing artifacts. in this article, we present a fully automatic registration method for large sstem image mosaics that globally minimizes thewe presented a fully automated method for registration of large sstem image mosaics. the method identifies the optimal configuration of image tiles regardless whether or not an initial guess of the configuration is available. it is capable of correctly placing tiles with only minimal image content provided that this content is connected to the rest of the tile graph. disconnected graphs of tiles are registered independently. thus, the approach is ideally suited for alignment of sstem data generated either manually or using a robotic setup. we use sift to identify corresponding landmarks and use them as a statistical sample for similar image content in the tem images. the scale invariance of sift is well suited to capture the changing appearance of small structures at low scale levels and the presence of meaningful similar features at multiple scales. larger, more distinctive local descriptors together with the requirement that correspondence candidates must be geometrically consistent yields reliably large sets of true matches. the reduction of the registration task to a compact set of corresponding landmarks enables global minimization of square correspondence displacements for very large tile systems. registering the 6885 tiles drosophila larval brain dataset took 24 h on an intel xeon computer with two 2.66 ghz dual-core-cpus and 8 gb of ram, with the most time-consuming operation in the procedure being the exhaustive nearest neighbor search in the 512 d local descriptor space. principally, there is no upper limit to the size of the dataset other than the available storage space. the described methods for robust outlier removal and global optimization are applicable to a wide variety of microscopy image mosaicking tasks. we used it successfully to register light microscopy image mosaics including sets of overlapping 3d confocal image stacks and applied it to bead-based registration of selective plane illumination microscopy (spim;) datasets consisting of 3d stacks of the same specimen taken from different angles . in, we identify the pairwise 3d translation between overlapping confocal image stacks by normalized crosscorrelation and globally minimize the translational offset of largepage: i63 i57i63  
