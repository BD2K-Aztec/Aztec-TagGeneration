genetics and population analysis genotype calling and phasing using next-generation sequencing reads and a haplotype scaffold motivation: given the current costs of next-generation sequencing, large studies carry out low-coverage sequencing followed by application of methods that leverage linkage disequilibrium to infer genotypes. we propose a novel method that assumes study samples are sequenced at low coverage and genotyped on a genome-wide micro-array, as in the 1000 genomes project (1kgp). we assume poly-morphic sites have been detected from the sequencing data and that genotype likelihoods are available at these sites. we also assume that the microarray genotypes have been phased to construct a haplotype scaffold. we then phase each polymorphic site using an mcmc algorithm that iteratively updates the unobserved alleles based on the genotype likelihoods at that site and local haplotype information. we use a multivariate normal model to capture both allele frequency and linkage disequilibrium information around each site. when sequencing data are available from trios, mendelian transmission constraints are easily accommodated into the updates. the method is highly parallelizable, as it analyses one position at a time. results: we illustrate the performance of the method compared with other methods using data from phase 1 of the 1kgp in terms of genotype accuracy, phasing accuracy and downstream imputation performance. we show that the haplotype panel we infer in african samples, which was based on a trio-phased scaffold, increases downstream imputation accuracy for rare variants (r2 increases by 40.05 for minor allele frequency 51), and this will translate into a boost in power to detect associations. these results highlight the value of incorporating microarray genotypes when calling variants from next-generation sequence data.genome-wide association studies (gwas) are known to be well powered for the detection of common variants that increase disease risk, and have uncovered many replicated associations in recent years. however, the effect sizes of many associated loci are relatively small and together explain only a small proportion of the heritability for many diseases and traits. it has been argued that rare variants with larger effects might harbour the remaining genetic variability . next-generation sequencing allows whole-genome sequencing of a large sample of individuals so that a more detailed picture of human polymorphism can be obtained. projects such as the 1kgp are working to produce a catalogue of polymorphisms with low (minor allele frequency2) and rare (maf50.005) allele frequencies. the current analysis pipeline starts by detecting sites exhibiting evidence of polymorphism. genotypes are then called at the polymorphic sites, and then haplotypes are estimated across all such sites, often as a by-product of calling the genotypes. the sets of haplotypes produced can be used as reference panels for imputation into gwas and allow investigations of rare variant associations that go beyond previous imputation analyses from less complete reference panels such as hapmap. given the current costs for sequencing, it is still not viable to deeply sequence a large number of individuals, so given a fixed amount of resources, there is a trade-off between sample size and coverage. the consensus view favours low-coverage sequencing of large numbers of samples. for example, the 1kgp will be sequencing $2500 individuals at $4, the uk10k project will sequence 4000 whole genomes at $6 (http://www.uk10k.org/), and the genome of the netherlands is sequencing 750 individuals at $12 (http:// www.nlgenome.com/). the current paradigm for detecting, genotyping and phasing polymorphic sites from low-coverage sequence data starts by mapping sequence reads to a reference genome. mapped reads that overlap a given site (s) in a single individual (i) are then combined together to form genotype likelihoods (gls). gls are the probabilities of observing the reads given the underlying (unknown) genotype and can be written as pr is jg is , where r is and g is denote the reads at site s and the true underlying genotype, respectively. methods exist for calculating these gls and involve combining information about the bases observed in reads, while allowing for the possibility of sequencing errors via base and mapping quality scores. so, for example, if the set of reads only contains the a allele, then the gl pr is jg is aa will be larger than the other likelihoods, but other genotypes will still have non-zero likelihood. as sequence to whom correspondence should be addressed. coverage increases, the likelihoods should become more peaked around the true genotype. in low-coverage sequencing, there may be no reads spanning a site, in which case, the gls will be identical across all possible genotypes. detecting polymorphic sites involves combining information across individuals at a site to infer whether there are at least two alleles observed across all individuals in the sample . once a site is detected, the sites genotypes can be called using a missing data likelihood that is optimised via an em algorithm , but this will only work well when coverage is high and the gls contain very good information about the genotypes of all samples. when coverage is low, power to call genotypes can be gained by taking advantage of linkage disequilibrium (ld) between sites in close proximity. methods that do this are extensions of phasing and imputation algorithms that pool information across samples and sites to infer multi-site genotypes and their underlying haplotypes (e.g impute2, beagle [browning andand mach). in some studies, such as gwas, the individuals being sequenced will also have been genotyped on a genome-wide single nucleotide polymorphism (snp) chip. for example, in the 1kgp, individuals are both sequenced and genotyped on the illumina omni2.5m chip. some commercial vendors also return gwas array data with sequencing results, so this design may become more prominent in the future. up to now, chip genotypes have primarily been used to validate sequencingbased genotype calls, as the error rates of snp chips are generally low (50.5) (o). in this article, we present a method that uses snp chip genotypes to aid the process of genotype calling from sequencing reads. the first step of our method involves estimating haplotypes at the chip snps using an accurate phasing method to form a haplotype scaffold. we then call genotypes at a polymorphic site using a model of the ld between the site and the surrounding sites in the haplotype scaffold. we use an markov chain monte carlo (mcmc) algorithm that iteratively updates the unobserved alleles at a site using the gls and the local ld. we use a multivariate normal model to capture both allele frequency and ld information around each site that results in fast mcmc updates. when sequencing data are available from motherfatherchild trios, mendelian transmission constraints are easily accommodated into the updates. the method analyses one position at a time and results in a highly parallelizable method that can be applied to a large sample. we call our method mvncall. our approach is similar to the qcall approach , which also analyses one snp at a time using a haplotype scaffold. qcall builds approximate coalescent trees at each site and then infers phased genotypes by considering possible mutations on branches of the trees. this approach does not scale well as the number of sequences increases and is the reason why this method was not applied to the phase 1 of the 1kgp. mvncall is much faster and has enabled us to analyse the phase 1 dataset. in the sections that follow, we present in detail the underlying model developed for genotype calling and phasing. we apply our method and other methods to chromosome 20 of the phase 1 of the 1kgp. we carry out an imputation analysis using the haplotype sets inferred by the different methods as reference panels, and we compare imputation accuracy.our proposed model for genotype calling and phasing assumes a study design where samples have been both sequenced and genotyped. the 1kgp uses exactly this design and this was a major motivation for developing such an approach. in addition, many cohorts of samples from gwas have been genotyped using microarray chips, and it is likely that these samples might be sequenced in the future, providing a combined set of data that also fits in with our approach. in fact, some commercial vendors also return gwas array data with sequencing results. the genotyped data from the microarrays can be fed into a phasing algorithm, and the resulting haplotypes serve as a haplotype scaffold in our model so that ld information between the scaffold sites and non-scaffold sites can be utilised. to capture this ld information, we use an approximate model that summarises the allele frequencies and the pairwise correlation between snps using a multivariate normal distribution. there is an increasing body of literature that the use of a normal distribution can capture enough information about correlations in alleles both between snps and between individuals to provide useful levels of inference . future extensions might utilise a normal approximation to efficiently call genotypes from low-coverage sequencing data together with a haplotype reference panel and without a haplotype scaffold. our model would also be relatively easy to extend to other types of polymorphism such as indels and multi-allelic variants. utilising phase informative reads when constructing haplotype panels from sequence data may also prove to be beneficial . when applied to data from phase 1 of the 1kgp that include 1092 individuals from 14 distinct population backgrounds sequenced at 4 and genotyped on the omni2.5m chip, we find that our method outperforms beagle in all population groups in terms of genotype accuracy. this is an interesting result because mvncall analyses one site at a time rather than all sites jointly as in beagle. it may be argued that jointly modelling all sites at once is a more appropriate strategy because this approach utilises ld information between all the sites being called. on the other hand, when the calling of genotypes is difficult, which can be the case when sequence coverage is low, it may be that the beagles joint approach suffers from convergence problems and the resulting haplotypes include errors due to this problem. the methods snptools and thunder also model all sites jointly but perform slightly better than mvncall on the european and asian comparisons. it may be that the underlying models they use are much better than the model used in beagle, or that the computational strategies that they use do a better job at avoiding convergence problems. a major use of the haplotype panels produced by the 1kgp is imputation of genotypes into gwas. it was thus natural that we assess the ability of mvncall to produce haplotype panels in terms of downstream imputation performance. a key finding of this work is that the panel of haplotypes that we produce from the 1kgp african samples results in a clear boost in downstream imputation performance at rare variants, when compared with the haplotype panels produced by snptools, thunder or beagle. mvncall results in a 0.05 increase in mean r 2 at rare variants below 1 frequency when compared with other methods. this is a substantial boost in accuracy, as studies of rare variants are in general less powerful. the r 2 metric used for our assessments has direct relevance to the power of such studies . in admixed samples, mvncall produces similar results to snptools, and both these methods have better performance than thunder and beagle at rare variants. we do not see the same increase in imputation performance when imputing european samples. this may be because a substantial proportion (47) of african samples in the reference panel have a haplotype scaffold that has been derived using trio phasing. we have shown that the haplotypes our method constructs when using a trio-phased scaffold have much lower switch error rate compared with the haplotypes from a scaffold phased without family information. it may be that it is this increase in haplotype accuracy that translates into a downstream effect on imputation performance. in contrast, only 4.4 of the european haplotypes in the reference panel were derived from a trio-phased scaffold. almost 85 of the mexican samples in the haplotype reference panel were derived using a trio-based scaffold, which might lead us to expect that imputation in mexican samples should be better when using mvncall reference haplotypes. the ancestry ofhaplotype diversity across the genome and this degrades imputation performance and drives the similarity between methods. imputation of rare variants in mexican samples is noticeably worse (supplementary) than in the african and european samples (and supplementary). overall these results highlight the gains that can be made when using microarray genotypes to improve genotype calls and phasing using low-coverage sequence data. future analysis of the 1000 genomes project data would benefit from fully incorporating the illumina omni2.5m genotypes into the genotype calling and haplotype estimation process.  
