rnasurface: fast and accurate detection of locally optimal potentially structured rna segments motivation: during the past decade, new classes of non-coding rnas (ncrnas) and their unexpected functions were discovered. stable secondary structure is the key feature of many non-coding rnas. taking into account huge amounts of genomic data, development of computational methods to survey genomes for structured rnas remains an actual problem, especially when homologous sequences are not available for comparative analysis. existing programs scan gen-omes with a fixed window by efficiently constructing a matrix of rna minimum free energies. a wide range of lengths of structured rnas necessitates the use of many different window lengths that substantially increases the output size and computational efforts. results: in this article, we present an algorithm rnasurface to efficiently scan genomes by constructing a matrix of significance of rna secondary structures and to identify all locally optimal structured rna segments up to a predefined size. rnasurface significantly improves precision of identification of known ncrna in bacillus subtilis. availability and implementation: rnasurface c source code is available fromrnas perform diverse enzymatic, regulatory and structural functions in living cells and are involved in nearly all housekeeping cellular processes. numerous new classes of non-coding and regulatory rnas were discovered during past decades. for example, micrornas regulate gene expression through post-transcriptional repression of messenger rna . other prominent examples include the rna role in translation , messenger rna localization , alternative splicing , epigenetic states , virus replication and so forth. moreover, according to recent studies of the human genome, up to 90 of the genome may be transcribed, and a substantial fraction of transcripts may represent functional non-coding rnas . biological function of the majority of functional rnas crucially depends on its tertiary structure. rna molecules fold hierarchically and sequentially, therefore the tertiary structure is largely determined by the secondary structure scaffold . for example, riboswitches regulate gene expression by switching between two specific secondary structures . there exist numerous methods to predict secondary structure computationally (for a review see), among which free energy minimization based on nearest neighbor thermodynamic parameters is the most prevalent approach. generally, rna sequences have numerous suboptimal structures, which have energies close to the optimal one . in addition to this, inaccuracies of the energy parameters, base modifications and dependence on cell conditions yield a moderate quality of the structure prediction by energy minimization with the average sensitivity of 75 and selectivity of 79 . however, the optimal energy could be a good measure to define propensity of a sequence to fold in a stable structure, the minimum free energy (mfe) of functional rnas can be distinguished from that of random sequences . on the other hand, there exist rna regions actively bound by protein factors. relatively low mfe, due to selection against formation of stable secondary structure, may represent a signal of an accessible site . structural potential of an rna sequence reflects significance of its secondary structure mfe. next-generation sequencing technologies produce vast amounts of genomic data. hence, identification in genomes of segments with unusual structural potential is of special interest. this problem has two sides: to efficiently scan genomes and to assess significance of output hits. there are several programs that efficiently scan genomes. rnall and rnaslider use a window-based approach to calculate the mfe and structure of each local sequence of a predefined size. rnalfold slightly diminishes the output size by considering only structures with paired first and last nucleotides, so-called closed structures. these programs focus on efficient computing and ignore significance of output hits. the only discriminator in these programs is mfe. however, mfe strongly depends on the length and dinucleotide composition of a sequence . comprehensive comparison of rna structure scores (shows that to whom correspondence should be addressed. the author 2013. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.com z-score can be used as a suitable measure of the structural potential. the z-score of a sequence is calculated aswhere e is the mfe of a biological sequence, and are the average and standard deviation of the energy distribution of shuffled sequences with preserved length and average dinucleotide composition. there also exists a less common approach, which uses uniqueness of secondary structure instead of thermodynamic stability to assess its significance . an early attempt to detect significant structures was based on a monte carlo simulation . this approach becomes impractical for sequences of moderate (several thousand of nucleotides) size. further studies introduced look-up tables to eliminate bias of nucleotide composition, combined with regression on sequence length or the notion of asymptotic z-score . the current stateof-the-art program rnalfoldz extends rnalfold by calculating z-score using svr. to our knowledge, the implementation of rnalfoldz is now embedded in rnalfold. approaches, that analyze rna segments of a fixed size, suffer from an inability to detect structured elements of varying sizes, whereas functional rnas fall into a wide range of sizes. here, we circumvent this limitation. to that end, we define the surface of the structural potential as the surface of z-scores for all genome subsequences shorter than a predefined size.visualizes this concept. the line at the bottom represents a segment of the genome, each point on the heatmap represents a subsequence and color represents structural potential of this subsequence (from highly structured dark blue to highly nonstructured dark red). we introduce the program rnasurface that efficiently reconstructs the surface of structural potential using a new fast algorithm for z-score evaluation. this approach introduces an intuitively clear definition of locally optimal segments as peaks in the surface of structural potential. besides identification of structured regions, the surface usage allows one to identify structured domains comprising the region. we apply our method to the genome of bacillus subtilis and identify genome regions with high structural potential. a highly accurate determination of structured intervals or regions of accessibility is useful for several purposes: preprocessing during de novo search for regulatory and noncoding rnas; accurate definition of ncrna boundaries; and correlation of genome-scale structural potential with other genomic features (gene boundaries, ribosome profiling, transcriptome data, binding sites of protein factors etc.).we analyzed the genome of b.subtilis to benchmark the programs and to study regions of structure accumulation. this gram positive bacterium has numerous cis-acting regulatory rnas and small rnas. in addition, widespread rho-independent transcription termination and non-random prevalence of stem-loops structures make b.subtilis an object of specific research interest.  
