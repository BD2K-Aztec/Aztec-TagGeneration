lca*: an entropy-based measure for taxonomic assignment within assembled metagenomes motivation: a perennial problem in the analysis of environmental sequence information is the assignment of reads or assembled sequences, e.g., contigs or scaffolds, to discrete taxonomic bins. in the absence of reference genomes for most environmental microorganisms, the use of intrinsic nucleotide patterns and phylogenetic anchors can improve assembly-dependent binning needed for more accurate taxonomic and functional annotation in communities of microorganisms, and assist in identifying mobile genetic elements or lateral gene transfer events. results: here we present a statistic called lca inspired by information and voting theories that uses the ncbi taxonomic database hierarchy to assign taxonomy to contigs assembled from environmental sequence information. the lca algorithm identifies a sufficiently strong majority on the hierarchy while minimizing entropy changes to the observed taxonomic distribution resulting in improved statistical properties. moreover, we apply results from the order-statistic literature to formulate a likelihood-ratio hypothesis test and p-value for testing the supremacy of the assigned lca taxonomy. using simulated and real-world datasets, we empirically demonstrate that voting-based methods, majority vote and lca, in the presence of known reference annotations, are consistently more accurate in identifying contig taxonomy than the lowest common ancestor algorithm popularized by megan, and that lca taxonomy strikes a balance between specificity and confidence to provide an estimate appropriate to the available information in the data. availability: the lca has been implemented as a stand-alone python library compatible with the metapathways pipeline; both of which are available on github with installation instructions and use-casesthe rise of next-generation sequencing technologies has generated a tidal wave of sequencing projects in natural and engineered ecosystems, resulting in a plethora of environmental sequence information. several software pipelines, including mg-rast (meyer to whom correspondence should be), humann , and metapathways have been developed to process environmental sequence information, provide taxonomic and functional annotations and assist in metabolic pathway reconstruction. despite the availability of these pipelines, accurately assigning taxonomy to environmental sequence information remains a challenging enterprise given a general lack of reference genomes for most uncultivated microorganisms. from a bioinformatics perspective, current software tools lack statistical frameworks and hypotheses tests for the assignment of reads or assembled contigs to discrete taxonomic bins leaving developers and investigators with limited theoretical direction . due to the popularity of the megan software, the lowestcommon ancestor (lca) method is routinely applied to individual open reading frame (orf) annotations with a correction based on homology search quality statistics . while using lca to assign individual orf taxonomy seems straightforward, it is unclear how to effectively apply this rule to contigs or scaffolds containing multiple orfs. consider an alternative perspective of electing a representative taxonomy where each qualifying orf annotation votes for overall contig assignment. in this election individual orfs may have differing taxonomic opinions, projecting their vote differently onto the tree of life. two popular voting theory results provide justification in choosing a majority as the correct response. condorcets jury theorem considers an election of two opinions, one correct and one incorrect, and voters each independently choose one of these two opinions with the assumption that they choose the correct response with probability p 1 2 . the observed majority converges in probability to the correct decision as the election size grows to infinity. alternatively, feige and colleagues studied the depth of noisy decision trees where each query at a node produces the correct answer with some probability p 1 2 . they derived tight bounds on the number of queries required to compute threshold and parity functions, and analyze a noisy comparison model with tight bounds on comparison, sorting, selection, and merging. however, applying these voting theory methods to taxonomic count data is complicated by the hierarchical definitions. for instance, individual orfs predicted on the same contig may be assigned to differentlets work lca through an illustrative example where taxonomic annotations are quite variable and dispersed . a simple majority method, choosing the taxonomy with the most annotations may be intuitive, but a majority of 3 out of 11 taxa is not very convincing. alternatively, to combat this dispersion it might be a good idea to elect the lca as the majority, but this very conservative estimate manifests limited resolving power (e.g., root, prokaryotes, etc.). in the case of individual orf annotations, lca estimates would be made less extreme by discarding annotations that do not meet certain quality thresholds, on the evolutionary assumption that hits to taxa phylogenetically further away from the origin will be less similar. however, in the case of assembled environmental sequence information, e.g., contigs or scaffolds, this is often not an option, because common practice summarizes annotations via some taxonomic estimation method (e.g., best-blast, lca). lca takes a bottom-up approach by expanding the specific simple majority estimate upwards in the taxonomic hierarchy, progressively collapsing annotations until a satisfying majority, an -majority, is obtained. here we can leverage relevant voting theory results like condorcets jury theorem and the work of feige on noisy decision trees to justify a proportion 1 2 . however, there remains the issue of how to collapse the tree automatically, as collapsing arbitrarily can introduce significant bias. here we will use the information-theoretic interpretation of entropy to motivate an algorithm of collapsing annotations in a principled way. since the application of information entropy is relatively rare in microbial ecology outside of diversity estimation , we will provide a brief introduction that will help in the understanding and motivation of lca. entropy (shannons entropy) is the fundamental unit of information defined as the average amount of information needed to specify the state of a random variable. intuitively it can be described as a measure of uncertainty. the uniform random variable, a situation where all outcomes are equally likely has the highest possible uncertainty, and therefore the highest entropy, while a more spiked random variable has less uncertainly, and therefore less entropy. entropy is an extremely useful concept, and has been central to the development of coding theory (e.g., file compression), cryptography, and signal processing . moreover, differences in entropy (also known as relative entropy or the kullback-leibler divergence) are used as a measure for the divergence between two probability distributions . for example, in machine learning, random forest classifiers use entropy as a measure of separation quality, and it is used to identify the most discriminating separations in a hierarchy of classifier models . the lca algorithm, uses the concept of entropy to measure the amount of change that collapsing annotations up the tree to a particular node will cause, calculating an -majority while minimizing the change in entropy of the taxonomic distribution as much as possible.the performance of lca was compared against two other taxonomic estimation methods, lca 2 and majority. lca 2 is the application of the lca algorithm to the taxonomic annotations of a contig, while majority is a simple majority method where taxonomy is ascribed to the most number of annotations (supplementary file 1, section s2). we evaluated the relative prediction performance of the three methods against two sets of simulated metagenomic contigs (with and without target genes in the annotation database) and one set of contigs from 201 microbial dark-matter (mdm) single-cell amplified genomes (sags) obtained from the genomic encyclopedia of bacteria and archaea (geba) mdm project , a united states department of energy joint genome institute (jgi) initiative for sequencing thousands of bacterial and archaeal genomes from diverse branches of the tree of life (section 4). in general, the voting-based measures majority and lca outperformed lca 2 using both the simple-walk and weighted taxonomic distance (wtd) distances (see methods). in both the small (10 100 randomly sampled contigs from 100 taxa) and large (10 2000 randomly sampled contigs from 2000 taxa) simulations, as well as the geba mdm contigs, lca and majority had simple-walk distances closer to zero when compared with lca 2 . with reference annotations removed from the target database, distances of all three measures were significantly increased in magnitude and variability, with voting based measures offering only a marginal improvement . a similar pattern was observed with the wtd, but here lca 2 is more penalized for predictions widely outside their original taxonomic lineage. here, lca 2 predictions near the root caused a cluster of negative wtd values in the geba mdm contigs . again, the removal of reference annotations increased wtd distances in terms of magnitude and variability, with the voting-based measures offering relatively minor improvement . from a regression analysis perspective, it is also possible to express these distances as error measurements, and calculate the root-mean squared error (rmse) as a measure of accuracy . here the voting-based methods exhibited smaller rmse values in all cases, but were only significantly different at the 95 confidence level in the large simulation and geba mdm contigs when measured by the wtd. without reference annotations there was a trend to smaller rmse values in the voting-based methods, but there was no significant has numerous impossibility results that challenge all three of the common-sense principles of voting: preserving majority rule, requiring a minimum level of core support, and rewarding sincere voters . taxonomic reconciliation between ncbi tree entries and ribosomal rna gene or cog alignments (akin to methods recently implemented in phylosift ) would allow for an apples-to-apples comparison between taxonomic and functional marker gene binning methods, e.g., ml-treemap, metaphlan , support more powerful integrative alignmentdependent binning models, and facilitate principled placement of taxa from one tree into the other.  
