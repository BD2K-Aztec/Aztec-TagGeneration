a de novo metagenomic assembly program for shotgun dna reads motivation: a high-quality assembly of reads generated from shotgun sequencing is a substantial step in metagenome projects. although traditional assemblers have been employed in initial analysis of metagenomes, they cannot surmount the challenges created by the features of metagenomic data. result: we present a de novo assembly approach and its implementation named map (metagenomic assembly program). based on an improved overlap/layout/consensus (olc) strategy incorporated with several special algorithms, map uses the mate pair information, resulting in being more applicable to shotgun dna reads (recommended as 200 bp) currently widely used in metagenome projects. results of extensive tests on simulated data show that map can be superior to both celera and phrap for typical longer reads by sanger sequencing, as well as has an evident advantage over celera, newbler and the newest genovo, for typical shorter reads by 454 sequencing. availability and implementation: the source code of map is distributed as open source under the gnu gpl license, the map program and all simulated datasets can be freely available atprocessing of shotgun metagenomic sequence data usually does not have a fixed end point to recover one or more complete genomes as for isolated microbial genomes, sometimes with the exception of finishable dominant populations . nevertheless, with the proliferation of metagenomic projects, the assembly tools, which aim to combine sequence reads into contiguous stretches of dna called contigs, are still expected to play an important role in sequence processing, due to more valuable genomic content they can provide . recently, the comparative assembly approach such as amos comparative assembler, which uses a reference genome or closely related species to align reads, to whom correspondence should be addressed. was applied to facilitate assembly of short reads . however, because of the potential bias caused by phylogenetic complexity and diversity, the de novo assembly methods are still regarded as irreplaceable tools for accurately assembling the novel genomic sequences that broadly exist in the metagenomic sequencing data . as the high-throughput sequencing technologies by the nextgeneration sequencing platforms such as illumina (http://www. illumina.com), solid (http://www.appliedbiosystems.com) and helicos (http://www.helicosbio.com) are available in metagenomic projects, many efforts have been devoted to develop assembly tools such as ssake , velvet and euler-sr/euler-usr . however, these methods are not targeting the metagenome sequencing. moreover, compared with sanger and 454 sequencing, the current limitation of shorter reads (200 bp, typically 25100 bp) and higher errors by the new sequencing platforms does not allow a significant utility for metagenomic analyses for the difficulty in phylogenetic study or gene function inference . in fact, shorter reads technologies have not been widely used in metagenome sequencing, and meanwhile the sequencing technologies producing longer reads, such as sanger (usually 7001000 bp) and 454 sequencing (usually 200500 bp), are still the overwhelming recommendation and thus remain the major source of metagenomic sequence data . therefore, it is never trivial to continue to emphasize the importance of longer reads to metagenomic analyses, clearly including the reads assembly tool designed specifically. to date, for such longer shotgun reads in many metagenome projects, the assembly still relies largely on the existing tools demonstrating high performance to manage for single genome, such as phrap (http://www.phrap.org), celera assembler and pcap . however, the assembly of a community of genomes is different from the assembly of a single genome. in the assembly of single genomes, the fundamental problem is the presence of repeated dna fragments in the target sequence that often leads to assembly errors. however, metagenomic assembly has its particular difficulties due to two challenges : the genomic repeats may originate from either the same genome or the different genomes, and the inhomogeneous coverage distribution and the low abundance of organisms provide limited information to handle repeats. unfortunately, the design for the task of single-genome assembly prevents the traditional de novo assembly softwarewe compare the performance of map to celera assembler and phrap (http://www.phrap.org) on 800 bp simulated datasets, whereas compare to celera assembler and newbler on 200 bp simulated datasets. celera assembler and phrap are commonly used on sanger reads and represent two styles of approaches, olc approach and greedy approach. newbler is the widely used software for 454 reads assembly distributed by 454 life sciences. the celera assembler, which first targeted sanger reads, distributed a new version for 454 reads assembly and claimed to outperform newbler. newbler also uses olc approach. parameters were chosen to reduce the assembly chimerism. specially, for error-free test sets, the minimal overlap identities for map, celera and newbler were set as 99.5, and for error sequencing test sets, the minimal overlap identities were set as 98. detailed parameter settings are available in supplementary materials. we conducted the comparison of different assemblers on simulated data by assessing the quality of contigs produced by them. five independent quantities, defined to illustrate the assembly performance, are summarized in tables 1 and 2. specifically, we used the proportion of the reads assembled into contigs, the number of contigs and their average length (i.e. contig size) to evaluate the assembly capacity. the two measurements are used to evaluate the assembly accuracies: the proportion of chimeric contigs in total contigs and the proportion of the so-called divergent contigs in total contigs. following the studies in) andare those that have identity t (t = 99 for error-free type datasets, and t = 95 for sequencing error-type data), with respect to the reference genomes., chimeric contigs are defined as those which comprised reads from different organisms. a divergent contig is defined as having an identity t (t = 99 for error-free data and t = 95 for sequencing error data) comparing against the original reference genomes from which the metagenomic reads are sampled. the results of the first three quantities of assembly capacity, namely the percentage of reads assembled into contigs, the number of contigs and their average length, are presented as follows. for the 800 bp datasets, the comparison of map, celera and phrap is presented in. in general, the three assemblers have a similar level in terms of the assembly capacity. although phrap shows a little more reads assembled and more contigs than both map and celera, most often it generates shorter contigs than other two assemblers do. in fact, the assembly capacity of each assembler is locked in a zero-sum game, any more for the number of contigs usually means a shorter average length of contigs. for the 200 bp datasets, the results of map, celera and newbler are listed in. on the error-free datasets, map and celera have a similar performance on the assembly capacity. while on the sequencing error-type datasets, map outperforms celera with higher proportion of assembled reads, larger contig number and longer contig size. on all 200 bp datasets, newbler assembles many fewer reads in contigs and generates fewer contigs compared with both map and celera. for example, in the hc, error-free data, newbler only assembled 5.1 of reads into contigs, whereas map assembled 34.3 of reads. when assembling the mc data, newler increases the assembled reads to 44.3, however, still 64.0 by map. in the lc datasets of both error free and sequencing error type, newbler has the longest contig average length among three assemblers. however, when we calculate the larger contigs by each assembler, we found that map has more large contigs than newbler. for example, on the mc data of error-free type, map generates 4546 large contigs with length longer than 1000 bp, whereas newbler generates 4059 large contigs (see supplementary). this indicates that the shorter contig average length of map than newbler is just caused by the much more short contigs generated by map. therefore in conclusion, map demonstrates its high assembly capacity to same level of celera and phrap on the 800 bp datasets, whereas to a great extent outperforms both celera and newbler on the 200 bp datasets. misassembly has certainly negative effects on the further analysis phases such as gene calling or translation initiation signals finding . thus for a metagenomic assembler, there is great demand to improve the quality of assembly. however, the existing well-known assemblers applied in metagenome projects were designed originally for individual genomes, which generate enormous misassembly especially chimeric contigs when processing metagenomic reads . chimeric contigs are composed of reads from different species and, thus, become a critical measure of assembler utility. in the current test on simulated data, the proportion of chimeric contigs in total contigs assembled by different assemblers is given (tables 1 and 2). for all six 800 bp datasets, map demonstrates overall lower chimeric contig ratio than both celera and phrap do, whereas phrap has much more chimeric contigscompared with other assemblers, several distinct features of map algorithm should be pointed out. first, map does not refer to any other information such as genome length or sequencing coverage that is often used in the assemblers targeting the isolated genomes, because such information is clearly not applicable to the situation of metagenomic assembly. what is more important is that map employs mate-paired information different from other assemblers did. for example, the celera assembler used mate-paired information in the scaffold constructing. the celera assembler later developed a new pipeline cabog, which finds the best overlap graph in the unitigger module . in this algorithm, mate pairs are used to correct the misassemblies by breaking the unitigs that are found violated with the mate pair constrains. pcap used mate-paired information to correct contigs and to link contigs into scaffolds. different from these assemblers, map uses mate pairs as a core measure to construct contigs when repeats hamper the assembly. based on mate-paired information, map designs a series of procedures to implement the layout stage. with respect to the olc strategy, map uses the strategy similar to celera. thus in many cases, map generates contigs in similar size as celera does. however, the former uses mate pair information to prevent error contigs from being formed, whereas the latter uses the information to correct and break wrong contigs. these two strategies are quite distinct, but both can avoid errors and in some cases have the similar results. however, the map strategy is more reasonable to avoid error when compared with celera. for example, lacking sufficient mate pair information, celera was not able to detect the potential errors, which generated through other operation (such as best overlap graph strategy in cabog) by its method, whereas map will sacrifice the size but avoid potential errors by leaving alone the conservative unitigs. in addition, map does not include the scaffolder module as bambus 2 does. bambus 2 uses the scaffold graph to report the regions of variation in closely related strains and to distinguish between them. the analysis of the strain variation among metagenomes could be carried out by a stand-alone software such as strainer . we have demonstrated that our strategy can achieve higher assembly accuracy in terms of both reads and nucleotide sites, while maintaining high assembly capacity. however, the application of map algorithm is sensitive to several factors such as the mate pair length and sequence coverage, which are the state of the art challenges in metagenomic assembly. as the map algorithm finds mate pair paths in the overlap graph, too long length of the mate pairs may lead to too many nodes traversed between them and complicating the process of finding mate pair paths. in addition, low sequence coverage may greatly reduce the number of overlaps, making the overlap graph being sparse. thus, a deeper sequencing may increase the efficiency of map, especially in the short read data. it should be noted that without mate pair information, map assembles the reads into unitigs, functioning similar to the assembler minimus . it is noted that unlike the metagenome projects sequencing on sanger platform in early years, recently emerged metagenome projects using 454 sequencing platform were sometimes inclined not to take the mate pair approach to sequence the dna fragments mainly due to the lower costs. however, robust mate pair protocols are increasingly regarded as essential to new sequencing technologies for their wider application in de novo sequencing, especially to metagenomic assembly process . the study in this article demonstrates that using mate pair information to resolve the repeat in the overlap graph is the promising method for metagenomic assembly. moreover, our attempt in this article provides valuable support for the mate pair approach in the trade-off in sequencing protocol selection for 454 sequencing platform or other next generate sequencing platform in metagenome projects. as we have clarified, our assembly method are designed to address the issue of longer metagenomic reads (recommended as 200 bp) from such as sanger and 454 sequencing technologies. the strongest reason for this interest is that longer reads are  
