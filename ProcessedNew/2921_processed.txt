systems biology meta-storms: efficient search for similar microbial communities based on a novel indexing scheme and similarity score for metagenomic data background: it has long been intriguing scientists to effectively compare different microbial communities (also referred as metagenomic samples here) in a large scale: given a set of unknown samples, find similar metagenomic samples from a large repository and examine how similar these samples are. with the current metagenomic samples accumulated, it is possible to build a database of metagenomic samples of interests. any metagenomic samples could then be searched against this database to find the most similar metagenomic sample(s). however, on one hand, current databases with a large number of metagenomic samples mostly serve as data repositories that offer few functionalities for analysis; and on the other hand, methods to measure the similarity of metagenomic data work well only for small set of samples by pairwise comparison. it is not yet clear, how to efficiently search for metagenomic samples against a large metage-nomic database. results: in this study, we have proposed a novel method, meta-storms, that could systematically and efficiently organize and search metagenomic data. it includes the following components: (i) creating a database of metagenomic samples based on their taxonomical annotations , (ii) efficient indexing of samples in the database based on a hierarchical taxonomy indexing strategy, (iii) searching for a metage-nomic sample against the database by a fast scoring function based on quantitative phylogeny and (iv) managing database by index export, index import, data insertion, data deletion and database merging. we have collected more than 1300 metagenomic data from the public domain and in-house facilities, and tested the meta-storms method on these datasets. our experimental results show that meta-storms is capable of database creation and effective searching for a large number of metagenomic samples, and it could achieve similar accuracies compared with the current popular significance testing-based methods. conclusion: meta-storms method would serve as a suitable database management and search system to quickly identify similar meta-genomic samples from a large pool of samples.microbes are everywhere around us on the planet, and the total number of microbial cells on earth is huge: a rough estimation of their number is 10 30 . microbes usually live in communities, and each of these communities has different community structures and functions. as such, microbial communities would serve as the largest reservoir of genes and genetic functions for a vast number of applications in bio-related disciplines, including biomedicine in healthcare, bioenergy, bioremediation and biodefense (national research council (u.s.). committee on metagenomics: challenges and functional applications. and national academies press (u.s.), 2007). because 490 of the strains in a microbial community could not be isolated and cultivated , the metagenomic methods have been used to analyze the microbial community as a whole. understanding the taxonomical structure of a microbial community (alpha diversity) and the differences in taxa among microbial communities (beta diversity) have been two of the most important problems in metagenomic research. in contrast to alpha diversity, which measures how many kinds of microorganisms are there in a single community, beta diversity measures how community membership varies over time and space, and is especially important for finding the complex relationships among a large numbers of samples. understanding the beta diversity is critical for studying microbial ecology. for example, human microbiome projects and related efforts to study microbial communities occupying various human body habitats have shown a surprising amount of diversity among individuals in skin , gut and mouth ecosystems . furthermore, the microbial communities would differ significantly even for those from types of similar environment . next-generation sequencing techniques have enabled the fast profiling of a large number of metagenomic data. thus, a rapidly increasing number of metagenomic profiles of microbial communities have been archived in public repositories and research labs around the world. as such, it is becoming more and more important to compare microbial communities in large scale. to whom correspondence should be addressed.with the fast accumulation of metagenomic samples and sequencing data, their comparison becomes very important to illustrate their similarities and differences. as such, the database search for metagenomic samples is becoming more and more important. however, current metagenomic data are not organized well (thus they are only data repositories, but not yet modernized and manageable database), and current metagenomic sample comparison methods are generally based on pairwise comparisons (thus, only comparable in small-scale, and difficult with large-scale analysis) without efficient index supporting. therefore, we have designed the meta-storms system as a system for database creation, indexing and searching for similar metagenomic samples. meta-storms is not only a database builder and searcher, but a search-engine-based metagenomic sample comparison system that could organize the database well, and could perform quick and accurate search. although it is one of the first systems of its kind, meta-storms has already been proved to perform well in similarity search for a large numbers of samples. its main advantages include: ability to handle large number of samples in an integrated system, fast indexing and candidate retrieval, accurate scoring function for comparison, etc. first, meta-storms has advantages in system integrity: it can take input of the 16 s rrna pyro-sequencing data or wgs data, thus is independent of any other method to retrieve the community structure of the metagenomic samples. additionally, the database could be built based on more than 10 000 metagenomic samples, making it one of the first systems that could handle such a large number of samples. second, its index is simple, yet quite fast and accurate in clustering different samples. the fast speed comes out of the simple categorization by only using phyla with high abundance as the index key. therefore, such indexing scheme would be useful, especially when there are many samples, for organizing samples in a metagenomic database. third, for sample comparison, it was noted that significance tests such as the p-test and the fast unifrac replicated permutation become decreasingly useful as the depth of coverage and the number of samples increase . however, although our methods based on scoring(b) phylogenetic tree of human microbiome samples and query results, which were matched to the right body sites. numbers on left part are samples that were matched to the body sites indicated by the corresponding arrows. function does not need complex computation, it is as accurate as those based on significance tests with fast speed. therefore, our scoring function might be a better alternative to the traditional time-consuming significance test. functional comparison of different metagenomic samples have also shown the ability of meta-storms to accurately and efficiently identify microbial communities of similar functions, and also help to shed new light onto the functional diversity of the microbial communities. with the advance of wgs of metagenomic samples, it is anticipated that the functional profiling and comparison of metagenomic samples would become more and more important, for which meta-storms would be of greater importance. in conclusion, meta-storms would provide key methods for metagenomic projects to facilitate the research in metagenomics, and more broadly, microbial communities, including human microbiome projects, earthmicrobiome project, etc. current meta-storms method could be updated in index efficiency and consistence. first, current indexing strategy is suitable for searching samples with dominant genomes (which are always the case) against large database. for query samples without dominant phyla, or when samples in the database are quite similar to each other (e.g. from the same source), we recommend the exhaustive search for high reliability rather than indexed query. second, the statistical model for the database search could be improved by integrating a mixture model. by these refinements, it is expected that the overall performance of meta-storms could improve further. all of these issues are expected to be addressed in our future work.  
