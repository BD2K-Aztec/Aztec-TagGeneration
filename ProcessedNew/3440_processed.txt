passion: a pattern growth algorithm-based pipeline for splice junction detection in paired-end rna-seq data motivation: rna-seq is a powerful technology for the study of transcriptome profiles that uses deep-sequencing technologies. moreover, it may be used for cellular phenotyping and help establishing the etiology of diseases characterized by abnormal splicing patterns. in rna-seq, the exact nature of splicing events is buried in the reads that span exonexon boundaries. the accurate and efficient mapping of these reads to the reference genome is a major challenge. results: we developed passion, a pattern growth algorithm-based pipeline for splice site detection in paired-end rna-seq reads. comparing the performance of passion to three existing rna-seq analysis pipelines, tophat, mapsplice and hmmsplicer, revealed that passion is competitive with these packages. moreover, the performance of passion is not affected by read length and coverage. it performs better than the other three approaches when detecting junctions in highly abundant transcripts. passion has the ability to detect junctions that do not have known splicing motifs, which cannot be found by the other tools. of the two public rna-seq datasets, passion predicted 137 000 and 173 000 splicing events, of which on average 82 are known junctions annotated in the ensembl transcript database and 18 are novel. in addition, our package can discover differential and shared splicing patterns among multiple samples. availability: the code and utilities can be freely downloaded from https://trac.nbic.nl/passion and ftp://ftp.sanger.ac.uk/pub/zn1/ passion contactglobal transcriptome analyses provide important insights in the qualitative and quantitative aspects of gene expression. a few years ago, transcriptome composition was mainly measured using microarrays. with the development of next-generation sequencing, a massively parallel transcriptome sequencing technology called to whom correspondence should be addressed. rna-seq has been developed and widely applied in transcriptome profiling. compared with microarrays, rna-seq measures the transcriptome without prior knowledge of genome sequence and enables the detection of previously unknown transcripts. moreover, rna-seq is more sensitive toward changes in low abundant transcripts, and has a much broader dynamic range (t). one of the opportunities offered by rna-seq is the detection of (novel) splice isoforms. splicing is a process in which introns are excised and the flanking exons are joined to form the mature mrna. in eukaryotes, almost all multi-exonic genes undergo alternative splicing . recent studies have revealed that variations in splicing patterns are associated with alzheimers and other complex diseases . detection of splicing patterns will therefore not only contribute to the characterization of transcript structures but also help to understand cellular and disease phenotypes. discovery of splice junctions using rna-seq is mainly achieved by aligning the reads that span exonexon junctions to the reference genome. current fast aligners such as bowtie and bwa can efficiently map reads to the exon region, but are less efficient in the mapping of reads across splice junctions. recently, many dedicated tools for detection of splice junctions have been developed. alexa-seq uses an exonexon junction database of all possible pairwise connections of the known exons from ensembl to assess the expression, differential expression and alternative expression of known and predicted transcript isoforms. the obvious limitation is that alexa-seq can only detect junctions between known exons but is not able to detect alternative transcripts including yet unknown exons. other algorithms do not rely on existing transcript annotations. tophat is one of the pioneers in this field. it first builds exon islands and connects the potential exons using the known splicing motifs (gtag, gcag, atac), and finally realigns previously unmapped reads to the joined parts. mapsplice first splits reads into smaller segments and then aligns these to the reference genome individually. a potential junction is detected, if a missing segment can be reconstructed by the extension of neighboring exonic segments. all the potential junctions are finally evaluated by a score based on anchor significance and entropy. hmmsplicer first splits the reads into two fragments and aligns them separately to the reference genome. once a fragment is aligned, a hidden markov model (hmm) is used to detect the most probable splice position, and finally all junctions are scored, filtered and divided into canonical and non-canonical junction sets. however, these methods have limitations. tophat cannot detect junctions with novel splicing motifs since it requires the guidance of known splice sites to join exons. both mapsplice and hmmsplicer divide reads into small segments, and therefore potentially work better for long reads than for short reads. both studies showed that they perform well on lowly expressed genes but are less accurate on highly abundance transcripts . moreover, while mapsplice and hmmsplicer are designed to handle both single-end and paired-end reads, neither of them exploit the paired information in their algorithms. here we introduce passion, a pattern growth-based splice site detection pipeline developed only for the analysis of paired-end rna-seq reads. passion uses the mapped read in a pair as anchor and then uses a high-resolution algorithm, pattern growth, to remap the proximal and distal fragments of the unmapped read to a local region of the reference indicated by the mate. it is capable of identifying both known and novel canonical and non-canonical junctions with snp or sequencing error tolerance.we have presented passion, a package that is capable of capturing both annotated and novel splice junctions with high accuracy. instead of using the popular data structures applied in nextgeneration sequencing analysis, e.g. suffixarray and hash table, the key component of passion is based on pattern growth which has not been applied in rna-seq analysis before. in addition, passion currently can facilitate the discovery of differential and shared splicing patterns from multiple samples. one unique advantage distinguishing passion from tophat, mapsplice and hmmsplicer is that passion can detect the splice junctions with unknown motifs, which are missed by the other tools. in passion, splicing motifs are not used in the main stages of junction detection, which are building exon islands, high-resolution remapping and filtering. only in the last step of the pipeline, canonical and non-canonical motifs are applied to finalize the breakpoint within the microhomology range. for those without motifs, they also will be reported with the leftmost breakpoint as the final location. another advantage is that passion is very accurate for highly abundant transcripts. it is shown that in sample s1, a small fragment of genes, 3, are highly expressed with read coverage 100 (supplementary). in the case of pooling rna-seq datasets, more transcripts will be highly covered. currently, many algorithms can accurately analyze low abundance transcripts, but are less efficient for detecting junctions in highly expressed genes. however, passion has a high true positive rate for both low and high abundance transcripts. first, the application of a local search strategy helped to rule out potential false locations. secondly, we used pattern growth, a high-resolution algorithm which can be accurate to a single nucleotide level. together with the aid of splice site motifs, passion is able to predict precise breakpoints of exonexon junctions without any nucleotide shift. the third and most important factor is the read depth-dependent cutoff filtering. by default, passion reports junctions where the depth of supportive reads is 10 of the average coverage of the more highly expressed flanking exon. it seems quite simple but effective. this filtering scheme is similar to the minimum minor isoform frequency parameter in tophat, in which junctions are reported if the abundance of the supportive reads is at least 15 of the depth of more deeply covered exons. mapsplice and hmmsplicer use very complicated scores to remove the spurious junctions but are less effective for highly abundant transcripts. as for the memory usage, passion consumes 9 gb memory for 17.2m pairs of 75 bp long reads with the default settings. the memory usage can be improved by setting a smaller bin size parameter, since reads are processed per bin. theoretically, reducing the bin size will increase the frequency of file reading and writing, but it will not significantly increase the cpu processing time. currently, passion is the third fastest method according to the cpu processing time. the wall time can be decreased by setting up to eight parallel threads at initial mapping and high-resolution remapping, which are the most time-consuming steps. moreover, with computer resources becoming cheaper and cheaper and more computer clouds and clusters becoming available, memory and cpu running time will not be the bottleneck for computing. accuracy should be the more important concern in data analysis. nevertheless, we still missed some rare splicings mediating cross chromosome gene fusion, because we assume that both reads in a pair are mapped to the same chromosome. it will be one of the tasks to tackle in the near future. besides, we are also interested in detecting allele-specific expression and rna editing events. quantification of these post-transcriptional modifications will contribute to study imprinting, regulation of differential expression and differential stability of genes or transcripts. eventually such detailed analysis will increase our understanding of cell and disease phenotypes. currently, more and more labs prefer to sequence rna using the paired-end protocol due to the obvious advantages provided by paired-end reads over single-end reads. passions ability to take advantage of paired-end reads together with its overall high performance will make passion a valuable tool for rna-seq data analysis in the future.  
