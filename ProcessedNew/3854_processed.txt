structural bioinformatics r3d align: global pairwise alignment of rna 3d structures using local superpositions motivation: comparing 3d structures of homologous rna molecules yields information about sequence and structural variability. to compare large rna 3d structures, accurate automatic comparison tools are needed. in this article, we introduce a new algorithm and web server to align large homologous rna structures nucleotide by nucleotide using local superpositions that accommodate the flexibility of rna molecules. local alignments are merged to form a global alignment by employing a maximum clique algorithm on a specially defined graph that we call the local alignment graph. results: the algorithm is implemented in a program suite and web server called r3d align. the r3d align alignment of homologous 3d structures of 5s, 16s and 23s rrna was compared to a high-quality hand alignment. a full comparison of the 16s alignment with the other state-of-the-art methods is also provided. the r3d align program suite includes new diagnostic tools for the structural evaluation of rna alignments. the r3d align alignments were compared to those produced by other programs and were found to be the most accurate, in comparison with a high quality hand-crafted alignment and in conjunction with a series of other diagnostics presented. the number of aligned base pairs as well as measures of geometric similarity are used to evaluate the accuracy of the alignments. availability: r3d align is freely available through a web server http://rna.bgsu.edu/r3dalign. the matlab source code of the program suite is also freely available for download at that location.alignments of homologous rna sequences can provide great insight into the structures, functions and evolutionary histories of rna molecules. as is the case for proteins, alignment procedures based solely on sequence similarity will also correctly align secondary structure features of rna, when sequence similarity is high. but such methods are inadequate for rna homologs that have diverged significantly in sequence, and alignment methods that take into to whom correspondence should be addressed. account watsoncrick base-pair co-variation are needed to obtain accurate alignments that reflect the conserved secondary structure. homologous rna molecules share a core conserved secondary structure and 3d structure. as more 3d structures of rna homologs appear, robust methods for simultaneous alignment at multiple structural levels, sequence, secondary structure and 3d structure are needed that can reveal the common structural features. this knowledge, extracted from the extant 3d database, can in turn guide efforts aimed at efficiently aligning the exponentially growing number of homologs known only from sequence . for example, although only a handful of atomic-resolution 3d structures of ribosomal rnas are known, hundreds of thousands of homologs have been sequenced. we have 3d structures of three bacterial and one archaeal 23s rrnas, the bacteria thermus thermophilus (t.th.), escherichia coli (e.coli) and deinococcus radiodurans (d.r.) and the archaeon h.m. in previous work, we produced hand-crafted alignments of these structures, a non-trivial task for which no software existed at the time . because producing a hand-crafted alignment is a labor-intensive and time-consuming process, and in light of the rapid increase in 3d rna structures in the pdb/ndb , we were motivated to develop automated tools to align rna 3d structures in a robust manner. this article reports a successful effort to do so. for the purposes of this article, an alignment of two rna structures is a list of correspondences between individual nucleotides from the two rnas. in every alignment, we require that the correspondences be well-ordered (if nucleotides i and j are aligned with nucleotides i and j , respectively, then i j if and only if i j ) and uniquely assigned (no nucleotide should be aligned to more than one nucleotide from the other rna). a number of research groups have developed programs for aligning rna 3d structures, and we briefly review previous work in this section. dial aligns rna 3d structures using a quadratic time dynamic programming algorithm that includes terms for similarity in nucleotide sequence, base pairing and nine torsional angles used to describe the rna backbone. the nine torsional angles include six dihedral angles used to define rna backbone conformations and the dihedral angle that describes rotation about the glycosidic bond . it also uses two additional virtual angles and , introduced in and reintroduced in . sara performs pairwise rna 3d-to-3d alignment by implementing a unit-vectorpage: 2690 26892697we tested r3d align by aligning the 3d structures of 5s, 16s, 23s rrnas of e.coli (e.coli) and thermus thermophilus (t.th.). we also aligned the 3d structures of 5s and 23s rrnas of e.coli and haloarcula marismortui (h.m.). pdb files 2aw4, 2j01 and 1s72 were used for e.coli, t.th. and h.m.,respectively. we chose these test cases because high-quality hand-crafted alignments are available to effectively assess the accuracy of the alignments . also, these structures provide appropriate test cases because they are large and highly structured, with many non-watsoncrick base pairs and long-range interactions. moreover, e.coli, t.th and h.m.are phylogenetically distant so there are significant differences in sequence and structure. we also tested r3d align on other rnas including rnasep and trna (see section 3.5). in this section, we focus on the alignment of the 16s rrna molecules of e.coli and t.th., pdb files 2avy and 1j5e, respectively . because the dial and sara web servers are incapable of producing alignments of structures this large, we asked the authors of the respective programs to provide alignments from local installations of these programs. the r3d align web server is capable of aligning 16s and even 23s rrna molecules. evaluations of the 5s and 23s alignments can be found in supplementary materials s4 and s5. to align the molecules, we used the iterative approach discussed in the previous section, which took 13 min to run. we benchmarked using a local installation of r3d align on a compaq presario cq60 notebook with one intel pentium t4200 processor running at 2.0 ghz and with 4 gb of ram. matlab version 7.7 (r2008b) was used for this benchmark.one application of an accurate 3d-to-3d alignment method such as r3d align is to create a consensus interaction list. one application of an accurate 3d-to-3d alignment method such as r3d align is to create a consensus interaction list. for a variety of reasons, two crystal structures of the same molecule (whether from the same organism or different organisms) will show small variations in the local structure of the rna. when one structure shows a base pair but the other shows the corresponding two bases falling just outside the classification limits, it is reasonable to infer the presence of the base pair in the second structure. a r3d align alignment can be used to locate near base pairs in one structure that are aligned with true base pairs in another. the near base pairs can then be inferred to be true base pairs. this could be used in conjunction with annotation program like fr3d, and the results would be useful for page: 2697 26892697we have introduced a new method for aligning two rna 3d structures and provided an implementation of this method in the r3d align program suite and web server. in contrast to the existing methods which either rely on a reduced, linear representation of the 3d structure or on single global rigid superpositions, we focus on superpositions of local neighborhoods, which take into account interactions of all types while maintaining independence from discrete classifications of pairwise nucleotide interactions.. we have shown that r3d align can be used to accurately align large rna structures. the 16s rrna alignment produced by r3d align was compared with alignments produced by other methods. it was shown to be the most accurate and to closely approximate a hand-crafted alignment. we have also introduced new display methods and diagnostics to compare and evaluate alignments. among the new tools introduced is a spreadsheet which displays all of the alignment information in addition to all base pairs detected in the structure. this spreadsheet format is also useful for comparing different alignments side-by-side. new bar diagrams were introduced which concisely display the alignment and the structural similarity of the local neighborhoods of each aligned nucleotide.  
