systems biology efficient statistical significance approximation for local similarity analysis of high-throughput time series data motivation: local similarity analysis of biological time series data helps elucidate the varying dynamics of biological systems. however, its applications to large scale high-throughput data are limited by slow permutation procedures for statistical significance evaluation. results: we developed a theoretical approach to approximate the statistical significance of local similarity analysis based on the approximate tail distribution of the maximum partial sum of independent identically distributed (i.i.d.) random variables. simulations show that the derived formula approximates the tail distribution reasonably well (starting at time points 410 with no delay and 420 with delay) and provides p-values comparable with those from permutations. the new approach enables efficient calculation of statistical significance for pairwise local similarity analysis, making possible all-to-all local association studies otherwise prohibitive. as a demonstration, local similarity analysis of human microbiome time series shows that core operational taxonomic units (otus) are highly synergetic and some of the associations are body-site specific across samples. availability: the new approach is implemented in our elsa package, which now provides pipelines for faster local similarity analysis of time series data. the tool is freely available from elsas website: http:// meta.usc.edu/softs/lsa.understanding how genes regulate each other and when the regulations are active is an important problem in molecular biological research. similarly, in ecological studies, it is important to understand how different organisms and environmental factors, such as food resources, temperature, etc., regulate each other to affect the whole community. for generality, we will refer to either genes in gene regulation studies or organisms or environmental factors in ecological studies as factors. time series data can give significant insights about the regulatory relationships among different factors. many computational or statistical approaches have been developed to cluster the genes into different groups so that the expression profiles of genes in each cluster are highly correlated . most of these methods consider the correlation of expression patterns across the entire time interval of interest. for many gene regulation relationships, the regulation may be active in certain subintervals. methods based on the global associations of the gene expression profiles may fail to detect these relationships. several local association-based methods have been developed to address this problem . borrowing the idea from local alignment for molecular sequences,proposed to identify local and potential time-delayed (lagged) associations between gene expression profiles. here, local indicates the two factors are only associated within some time subinterval, and time-delayed indicates there is time shift in the associated profiles. the strength of local association is measured by local similarity (ls) score and the statistical significance of ls score is evaluated by a large number of permutations. the authors showed that such analysis can identify associated pairs that are not detectable through global analysis.used a similar approach to study local associations of microbial organisms in the ocean over a 4-year period, and this approach has been used in several other recent ecological studies .recently extended the approach to deal with replicated time series where not only statistical significance of ls score can be evaluated, but also a bootstrap confidence interval can be obtained. one of the major limitations of the local similarity analysis is the time-consuming permutation procedure used to evaluate the statistical significance (p-value) of the ls score. when a large number of (g) genes are considered, gg 1=2 gene pairs need to be evaluated. for a type i error , in order to adjust for multiple testing, the bonferroni corrected threshold is 2=gg 1. for g 5000, the threshold is 4 10 9 when 0:05, which will need over 2:5 10 8 permutations that are computationally prohibitive. although in practice false discovery rate (q-value) is used to correct for the multiple comparison problem, still, thousands of to whom correspondence should be addressed. y the authors wish it to be known that, in their opinion, the first two authors should be regarded as joint first authors. permutations are needed for estimating p-values that were used for q-value calculation. a fast and efficient theoretical approximation for the statistical significance of the ls score is urgently needed. recently,provided an upper bound for the p-value corresponding to a ls score. however, the upper bound is not tight. we make the following contributions in this article. first, feller (1951) developed an approximation theory for the range of partial sums for independent identically distributed (i.i.d.) random variables with mean zero, andextended the results to markovian random variables. although the theory developed by feller (1951) was later further extended by others, it has not been applied to the field of computational biology. we are the first to use fellers theory to approximate the distribution of ls scores. on the other hand, the theory corresponding to the scenario that the expectation of each random variable is negative was used byand karlin and altschul (1993) to derive the statistical significance for local sequence alignment. such a development was crucial for the wide use of blast in computational biological research. second, the theory by feller (1951) and others are valid only when the number of summands (time points) is large. however, it is not clear how large the number of time points should be so that the approximation is reasonable for the ls score. we show through simulations that the approximation from feller (1951) is reasonable as long as the number of time points is at least 10 for ls score without time delay. in addition, we show how we can adapt fellers approximation to calculate statistical significance of ls score with time delays. simulations showed that the resulting approximation is appropriate when the number of time points is above 20. finally, we applied the developed theory to the analysis of real datasets from gene expression profiles to metagenomics communities, where interesting biological results were obtained. the organization of the article is as follows. in the methods section, we provide the theoretical bases for deriving the approximate tail probability that the ls score is above a threshold. in the results section, we use simulations to study the number of data points n needed for the theoretical approximation to be valid. we also use the theoretical formula to study three real datasets arising from different high-throughput experiments: microarray, molecular finger printing and ngs tag-sequencing. the article concludes with some discussion on further applications and future research directions.  
