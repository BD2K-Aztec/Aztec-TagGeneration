sequence analysis bima v3: an aligner customized for mate pair library sequencing mate pair library sequencing is an effective and economical method for detecting genomic structural variants and chromo-somal abnormalities. unfortunately, the mapping and alignment of mate-pair read pairs to a reference genome is a challenging and time-consuming process for most next-generation sequencing alignment programs. large insert sizes, introduction of library preparation protocol artifacts (biotin junction reads, paired-end read contamination , chimeras, etc.) and presence of structural variant breakpoints within reads increase mapping and alignment complexity. we describe an algorithm that is up to 20 times faster and 25 more accurate than popular next-generation sequencing alignment programs when processing mate pair sequencing.large genomic chromosomal rearrangements play an important role in the development and progression of many cancers. amplifications, inversions, deletions and translocations can modify the expression and/or functionality of many tumor suppressors and oncogenes. thus, identification of large genomic rearrangements in cancer cells can greatly aid in our understanding of the mechanisms underlying cancer progression. mate pair (mp) library sequencing offers an efficient, a costeffective and a comprehensive method to detect the presence of and to determine the fine grain structure of structural variants throughout the entire genome. mps large 25-kb fragment size increases the likelihood that a read pair will span a structural variant and minimizes the number of read pairs required to detect and characterize an event. multiple samples can be processed on a single lane of a flow cell, reducing costs without degrading accuracy. coverage analysis can accurately determine aneuploidy, amplification and deletion on multiplexed samples. for a detailed description of the mp sequencing protocol, please refer to http://www.illumina.com/technology/mate_pair_sequen cing_assay.ilmn. the mp library preparation protocol introduces several sequencing artifacts that complicate mp read pair mapping and alignment. after shearing, biotin end-labeling and size selection, 25-kb dna fragments are circularized by joining two ends of a single fragment. in the circularization step, chimeras, or false mps, can be generated when two separate fragments ligate. before sequencing, the circularized dna is randomly sheared into 500-bp fragments, and the biotin-containing fragments are isolated. because shearing is random, the biotin junction can be within the sequencers read length of either end of the fragment, producing reads containing sequence from two different genomic locations. finally, the biotin isolation step is not 100 efficient, 1015 of the sequenced read pairs consist of paired-end reads. the use of large insert sizes and the presence of paired-end reads, biotin junctions, chimeras and breakpoint junctions in mp sequencing make alignment more difficult and time-consuming. large insert sizes and chimeric reads increase the expected paired read mapping search space. sequencing through biotin junctions (2025 of 100-bp reads) and structural variant breakpoint junctions produces reads containing sequence from multiple genomic locations. the presence of pair-end reads, chimeras and discordant read pairs spanning structural variants increases the complexity of correctly scoring paired genomic locations. to address the difficulties of mp sequencing alignment, we have created binary indexing mapping algorithm (bima) v3, the latest version of a mapping and alignment tool designed to handle mp sequencing artifacts. building on bimas proven track record , v3s enhancements allow it to accurately align up to 25 more reads in up to 1/20 the time of currently popular next-generation sequencing (ngs) alignment programs.the accuracy and execution time of bima v3 were compared with two popular ngs alignment programs, burrows-wheeler aligner (bwa;) and novoalign (http:// www.novocraft.com). two data sets, one synthetic and one real, were used to measure alignment accuracy and single threaded execution time. each data set consisted of 1 000 000 mp read pairs (2 000 000 total reads), each 100 bp in length. the whole-genome simulator for next-generation sequencing (dwgsim) (https://github.com/nh13/dwgsim/wiki) were used to generate and evaluate the synthetic data set . the real data set was sequencing from the lymph node prostate cancer cell-line (lncap) (prostate adenocarcinoma) and was evaluated by comparing the reference genome position predicted by the ngs alignment programs with reference genome positions predicted by blast-like alignment tool (blat;;). the synthetic data set portrays all evaluated aligners being roughly equivalent in accuracy (bima having a slight advantage) but vary significantly in alignment time. unfortunately, synthetic mp sequencing does not accurately model all artifacts present in real mp sequencing (biotin/breakpoint junctions, paired-end read contamination, chimeras, etc). both novoalign and bwa require a considerable amount of additional processing time ($50 to $250) to deliver significantly fewer accurately mapped reads ($10 to $25) on real mp sequencing . bima v3s utilization of three hash tables with 32-bit keys requires a significant amount of process memory, 128 gb during hash table creation and 100 gb during alignment, compared with novoalign and bwa (8 gb and 5 gb, respectively). it is faster for bima to generate indexes during every invocation ($800 seconds using three threads), than read in a compressed pre-computed index from a shared file system. because novoalign and bwa pre-compute their indexes, the alignment times reported in tables 1 and 2 do not include index generation. bima v3 accurately aligns more mp reads in less time than popular ngs alignment programs, enabling researchers to discover more structural variants with less coverage. researchers are already using it to develop new genetic testing methods (k.cradic et al., manuscript submitted) and reprocess 100s of existing mp data sets to identify previously undetected structural variants.the lncap cell line was sequenced using an optimized illumina mate pair protocol , 100-bp reads, $2400-bp insert, etc. one million read pairs were aligned on a single core of an intel xeon 2.9-ghz e5-2690. reported reference genome positions were compared with individual read alignments predicted by blat. see supplemental materials for an expanded comparison (including bwa-mem), algorithm invocation details and a detailed explanation of the analysis performed.one million synthetic mate-pair read pairs were generated with dwgsim from the hg19 human reference genome (100-bp reads, 4 000-bp insert, 0.51.5 error rate, 0.1 mutation rate, etc). alignment time, in seconds, was captured on a single core of an intel xeon 2.9-ghz e5-2690. see supplemental materials for an expanded comparison (including burrows-wheeler aligner maximal exact matches; bwamem), algorithm invocation details and the full dwgsim_eval reports.  
