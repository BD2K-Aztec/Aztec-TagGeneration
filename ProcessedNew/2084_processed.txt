gmcloser: closing gaps in assemblies accurately with a likelihood-based selection of contig or long-read alignments motivation: genome assemblies generated with next-generation sequencing (ngs) reads usually contain a number of gaps. several tools have recently been developed to close the gaps in these assemblies with ngs reads. although these gap-closing tools efficiently close the gaps, they entail a high rate of misassembly at gap-closing sites. results: we have found that the assembly error rates caused by these tools are 20500-fold higher than the rate of errors introduced into contigs by de novo assemblers. we here describe gmcloser, a tool that accurately closes these gaps with a preassembled contig set or a long read set (i.e. error-corrected pacbio reads). gmcloser uses likelihood-based classifiers calculated from the alignment statistics between scaffolds, contigs and paired-end reads to correctly assign contigs or long reads to gap regions of scaffolds, thereby achieving accurate and efficient gap closure. we demonstrate with sequencing data from various organisms that the gap-closing accuracy of gmcloser is 3100-fold higher than those of other available tools, with similar efficiency. availability and implementation: gmcloser and an accompanying tool (gmvalue) for evaluating the assembly and correcting misassemblies except snps and short indels in the assembly are available at https://sourceforge.net/projects/gmcloser/.next-generation sequencing (ngs) technologies allow the low-cost and high-speed construction of unknown genome sequences by de novo assembly. the assembly of reads produces contigs, but the extension of these contigs frequently stops at sites with repetitive regions, heterozygous alleles, sequencing errors or low read coverage, causing assembly fragmentation . hence, for large eukaryotic genomes with highly repetitive and/or polymorphic sequences, the lengths of the contigs generated by short read assembly are generally short. contig fragments are then further linked with paired-end (pe) or mate-pair (mp) reads, which are generated by sequencing both ends of dna fragments with a range of sizes, to form scaffolds. scaffolds contain many gaps, with a range of sizes, which are estimated from the fragment sizes of pe or mp reads. closing the gaps in scaffolds is an important finishing process in assembly construction. because the gap regions correspond not only to repeat sequences, which are often found in intergenic regions, but also to gene-encoding regions, which could not be assembled because of low read coverage or heterologous sites, the effectiveness and accuracy of gap closing significantly affects downstream analyses, including gene annotations for the constructed assemblies. connecting the contigs (non-gapped dna segments split by gaps in scaffolds and hereafter referred to as subcontig) encompassing a v c the author 2015. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.com gap in a scaffold by closing the gaps increases the length of the subcontigs and its capacity to include the encoded genes to be annotated. gap closing has traditionally been performed by manually or semi-automatically sequencing pcr-products generated with primers that encompass the gaps . however, recently developed gap-closing tools that use ngs reads, gapcloser (, b), image , gapfiller and finis , have replaced the laborious manual gap-closing process. the former three tools use a similar strategy to close gaps: (i) alignment of pe reads to the contig regions of the scaffolds; (ii) collection of unmapped mates when the other read of a pair is aligned to a region neighboring a gap; (iii) local assembly of collected unmapped reads based on de bruijn graphs; and (iv) the iteration of processes (iiii). image is usually only applicable to assemblies of small genomes . gapcloser is designed for use as a finishing process of a soapdenovo assembler, but can be used as an independent tool. gapfiller is unique in that it assembles only reads that are partially aligned to span a gap, and considers the consistency between the gap lengths and the lengths of the sequences used to fill the gaps to increase the accuracy. finis closes gaps by constructing local assembly graphs using reads that were not used for the assemblies and pre-built contig-graph information. finis can only be applied to assemblies from some specific assemblers (i.e. velvet and soapdenovo). another tool to close the gaps in assemblies is pbjelly , which use pacbio long reads instead of short ngs reads. pbjelly closes gaps and corrects errors in the closed sequences that are derived from pacbio reads by adopting consensus sequences of the multiple reads aligned to the gap regions. additionally, assembly-merging tools, pcap.rep , gam-ngs , gaa , garm , cisa , fgap , maia , minimus2 and mix can potentially close the gaps by merging the assemblies, although they are intended for assembly extension rather than gap closure. in this study, we demonstrated that all the existing gapclosing tools cause a high rate of misassembly at gap-closing sites. to develop a gap-closing tool with a lower error rate, we adopted a strategy with which gaps are closed with a set of preassembled contigs or long reads. our strategy involves the selection of the correct alignments between scaffolds and contigs (or long-reads) by measuring the likelihood ratios of the true alignments. we demonstrate that this likelihood-based method allows the efficient and accurate connection of contigs and is applicable to other technologies that involve the merging or assembly of contigs or long reads.3.1 current gap-closing tools display a high rate of misassembly in the gapcurrent gap-closing tools use a strategy that aligns pe-reads, followed by the k-mer-based local assembly of the reads aligned around the gap regions. although this strategy efficiently closes gaps, itgap closing in c.elegans sspace scaffolds. for s.cerevisiae s288c and c.elegans, simulated pacbio reads were generated with pbsim, and errorcorrection was conducted using pacbiotoca and proovread, respectively. gap-closing results for gapcloser and gmcloser with a real contig set (fm e or sp e) are shown for comparison. results of successive treatments using gmcloser with a real contig set and pacbio reads are also shown (fm e:14). the bars are as in. the data are from the assembly results of gmcloser at iteration 3. the minimum alignment overlap identity to measure misassembly events with gmvalue was set to 92, because the pacbio reads could be incompletely error-correctedgap closing with gmcloserintroduces a large number of errors . the high misassembly rates of the k-mer-based gap-closing tools probably arise because the gap-closing process involves assembly at genomic sites that are difficult to assemble with de novo assemblers. because the current gap-closing tools use only pe reads that are mapped to gap-flanking regions for local assembly, misassembly could occur frequently at repeated regions in which reads can be incorrectly aligned. these hardto-assemble sites include repetitive regions and regions of highly polymorphic sequences that are attributable to sequencing errors or heterozygosity. nevertheless, assembly tools are likely to generate many contigs that cover gaps in the scaffolds, because the gaps present in scaffolds generated with an assembler can be efficiently closed with a contig set generated with the same assembler. therefore, our gap-closing strategy, based on the alignment of a preassembled contig set, allows accurate and efficient gap closing. the assemblies in which the gaps were closed with gmcloser and with an intact contig set still contained a number of errors. however, most of these errors were derived from misassembly errors contained in the preassembled input contigs. thus, the use of preassembled contig sets generated with accurate assemblers, such as soapdenovo2, should ensure accurate gap closing with gmcloser. the high accuracy and high effectiveness of gmcloser for gap closing are also due to the likelihood-based selection of the correct alignment between a contig and a subcontig of a scaffold. this selection method uses likelihood ratios for three alignment factors: the alignment overlap length, the alignment overlap identity and the mapping rate of pe reads, which are determined statistically from true and false alignment datasets. although likelihood-based algorithms or bayesian probabilistic approaches have been adapted to estimate genotypes, short read alignments and assembly errors , no likelihood-based method has been developed to select the correct alignment of dna fragments such as contigs. our selection method of contig alignment should be applicable to the development of tools involving the alignment of dna sequence sets, such as assemblers of long reads or contigs. after a successive treatment of different contig sets with gmcloser, a number of gap regions are still barely filled, and these gap regions seem to correspond to genomic regions with low read coverage. sequencing reads generated with the pacbio rs platform have long read lengths (mean: 10 kb, max: 50 kb) and relatively constant coverage across the sequenced genome, although the sequencing error rate is high ($15;). the errors in pacbio rs reads can be effectively corrected with short reads or with a multiple-alignment strategy between the pacbio reads . in this study, we have demonstrated that the gaps in assemblies can be efficiently and accurately closed with a low coverage of error-corrected pacbio reads using gmcloser, and that the gap-closing accuracy of gmcloser is better than that of another gap-closing tool with pacbio reads, pbjelly . this feature of gmcloser should also offer economical benefits, especially for assemblies of large genomes. however, the accuracy of the gap closing with pacbio reads is lower than that with preassembled contig sets, and many of the misassemblies are attributable to incomplete error-correction of pacbio reads (supplementary tables s8 and s12). thus, the future development of more complete methods for error-correction of pacbio reads would allow a more accurate gap closure with gmcloser.  
