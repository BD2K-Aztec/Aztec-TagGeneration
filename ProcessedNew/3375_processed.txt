optimized application of penalized regression methods to diverse genomic data motivation: penalized regression methods have been adopted widely for high-dimensional feature selection and prediction in many bioinformatic and biostatistical contexts. while their theoretical properties are well-understood, specific methodology for their optimal application to genomic data has not been determined. results: through simulation of contrasting scenarios of correlated high-dimensional survival data, we compared the lasso, ridge and elastic net penalties for prediction and variable selection. we found that a 2d tuning of the elastic net penalties was necessary to avoid mimicking the performance of lasso or ridge regression. furthermore, we found that in a simulated scenario favoring the lasso penalty, a univariate pre-filter made the elastic net behave more like ridge regression, which was detrimental to prediction performance. we demonstrate the real-life application of these methods to predicting the survival of cancer patients from microarray data, and to classification of obese and lean individuals from metagenomic data. based on these results, we provide an optimized set of guidelines for the application of penalized regression for reproducible class comparison and prediction with genomic data. availability and implementation: a parallelized implementation of the methods presented for regression and for simulation of synthetic data is provided as the pensim r package, available at http://cran.r-project.org/web/packages/pensim/index.html.multivariate regression is a flexible machine learning method, suited to prediction of discrete, continuous and censored time-toevent (survival) outcomes from arbitrary combinations of predictor variable classes. in genomic settings, collinear predictors typically greatly outnumber available samples (p n), a now-classic example being the prediction of cancer patient survival from tumor gene to whom correspondence should be addressed. expression data . in this setting, ordinary regression is subject to overfitting and instability of coefficients , and stepwise variable selection methods do not scale well . regression has been successfully adapted to high-dimensional situations by penalization methods (review by), and penalized regression has been shown to outperform univariate and other multivariate regression methods in multiple genomic datasets . two penalization methods, and a hybrid of these, are most commonly used. ridge regression uses a penalty on the l 2 norm of the coefficients, which introduces bias in the prediction error in exchange for reduced variance. however, ridge regression keeps all variables in the model and thus cannot produce a parsimonious model from many variables. lasso regression (penalizes the l 1 norm, which tends to reduce many coefficients to exactly zero and thus performs variable selection in addition to prediction. however, the lasso has been noted to be inferior to ridge regression for prediction in lower dimensional situations, and tends to select only one of a group of collinear variables, which may not always be desirable .thus proposed the elastic net, penalizing both the l 1 and l 2 norms with individual tuning parameters, as a way to achieve the best of both lasso and ridge. these three variants of penalized regressionlasso, ridge and elastic nethave since been applied to a variety of phenotype prediction tasks using genomic data (for example,). several previous simulation studies have investigated properties of the elastic net , the lasso and ridge regression , but have not compared all these methods with alternative strategies for their application. we present a comprehensive assessment and optimization of these methods, using two contrasting configurations of simulated genomic data and two genome-scale experimental datasets. comparative studies of this nature provide the most realistic and unbiased assessments of available machine learning methods, issues which have been identified as critical to researchers selection of appropriate methodology . we introduce a 2d optimization of the elastic net penalty parameters, and show that it or a comparable procedure is necessaryto establish optimized guidelines for reproducibly linking genomic features (such as gene expression) to outcome using penalized regression , we compared the lasso, ridge regression and elastic net with three strategies for 2d tuning of its penalty parameters. we additionally varied the stringencies of an optional univariate pre-filter and evaluated two methods for selecting from repeated tunings, using simulated high-dimensional datasets with several configurations of signal-to-noise ratio and censoring of survival outcomes. results of these simulations, along with current best practices for high-dimensional model assessment, were used to guide analyses of two publicly available experimental datasets: a microarray experiment investigating survival of cancer patients with lung adenocarcinomas and metagenomic data from the metahit consortium describing the composition of gene function in the gut microbiotas of lean and obese individuals. based on the results of these simulations and subsequent comparable analyses of real experimental data, we provide a set of guidelines for penalized regression analysis of diverse high-dimensional data.  
