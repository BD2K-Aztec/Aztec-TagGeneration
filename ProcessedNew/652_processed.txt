bambus 2: scaffolding metagenomes motivation: sequencing projects increasingly target samples from non-clonal sources. in particular, metagenomics has enabled scientists to begin to characterize the structure of microbial communities. the software tools developed for assembling and analyzing sequencing data for clonal organisms are, however, unable to adequately process data derived from non-clonal sources. results: we present a new scaffolder, bambus 2, to address some of the challenges encountered when analyzing metagenomes. our approach relies on a combination of a novel method for detecting genomic repeats and algorithms that analyze assembly graphs to identify biologically meaningful genomic variants. we compare our software to current assemblers using simulated and real data. we demonstrate that the repeat detection algorithms have higher sensitivity than current approaches without sacrificing specificity. in metagenomic datasets, the scaffolder avoids false joins between distantly related organisms while obtaining long-range contiguity. bambus 2 represents a first step toward automated metagenomic assembly. availability: bambus 2 is open source and available from http://amos.sf.net.metagenomics, the direct sequencing of dna from all organisms in an environment without culturing, has recently emerged as a new scientific field that enables the discovery of novel organisms and genes as well as the study of population structure and dynamics . metagenomic studies have greatly expanded the understanding of microbial diversity. for example, viral quasi-species have been shown to affect pathogenicity in the poliovirus due to cooperation between differently adapted individuals in a population, as well as between coinfecting viruses . other recent studies have relied on metagenomics to identify novel genes and uncultured microbes . the assembly of metagenomic data is complicated by several factors such as: (i) widely different levels of representation for different organisms in a community; (ii) genomic variation between to whom correspondence should be addressed. closely related organisms; (iii) conserved genomic regions shared by distantly related organisms; and (iv) repetitive sequences within individual genomes. similar challenges occur in the assembly of polymorphic eukaryotes, a challenging domain for existing assembly algorithms. for example, the assembly of the sea squirt genome ciona savignyi required extensive manual intervention and customized scripts despite the fact that this genome is fairly simplethere were only two haplotypes of roughly equal coverage . metagenomic data are considerably more complex. due to the lack of assembly tools specifically targeted at metagenomic projects, studies rely on existing assemblers and attempt to mitigate some of the challenges posed by the data through iterative adjustment of assembly parameters and post-processing. tuning is critical as existing assemblers make frequent errors even in simulated datasets with significantly lower complexity than true environments . at the same time, current assemblers produce fragmented assemblies, hampering downstream analysis. for example, in the analysis of the global ocean survey data, the celera assembler was heavily modified to allow high error rates in order to account for strain variation, and to overcome the effects of varied coverage levels on the statistical repeat detection procedure . only two assemblers were developed specifically for metagenomic datasets . however, neither utilizes mate-pairs, our focus in this work. we present novel scaffolding algorithms optimized for non-clonal assembly. though our algorithms are also applicable to polymorphic genomes, the primary focus of this article is on metagenomic analysis. these algorithms are implemented in a software tool called bambus 2. bambus 2 supersedes our previous scaffolder, bambus , which was targeted at clonal sanger data. we will show that, when applied to metagenomic datasets, bambus 2 generates large scaffolds while avoiding false joins between distantly related organisms. furthermore, our software can automatically identify genomic regions of variation that correspond to previously characterized polymorphic loci.in the following section, we demonstrate the performance of bambus 2 by comparing it with two assemblers used in recent page: 2968 29642971bambus 2 is not a stand-alone assembler. instead, it is a drop-in scaffolding module optimized for non-clonal data and is compatible with the output of many modern assemblers. thus, bambus 2 can be applied to virtually all existing sequencing technologiesit is sufficient to start with an assembler that is best suited for that type of data. we have shown that it can easily be applied to the output of celera assembler, newbler, soapdenovo and minimus, and have demonstrated its performance in sanger, 454 and illumina data. bambus 2 includes an executive script (named gobambus2) that will automatically process input data in a variety of formats and run the pipeline, making it easy to use.  
