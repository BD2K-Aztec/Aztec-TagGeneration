rvd2: an ultra-sensitive variant detection model for low-depth heterogeneous next-generation sequencing data motivation: next-generation sequencing technology is increasingly being used for clinical diagnostic tests. clinical samples are often genomically heterogeneous due to low sample purity or the presence of genetic subpopulations. therefore, a variant calling algorithm for calling low-frequency polymorphisms in heterogeneous samples is needed. results: we present a novel variant calling algorithm that uses a hierarchical bayesian model to estimate allele frequency and call variants in heterogeneous samples. we show that our algorithm improves upon current classifiers and has higher sensitivity and specificity over a wide range of median read depth and minor allele fraction. we apply our model and identify 15 mutated loci in the paxp1 gene in a matched clinical breast ductal carcinoma tumor sample; two of which are likely loss-of-heterozygosity events.next-generation sequencing (ngs) technology has enabled the systematic interrogation of the genome for a fraction of the cost of traditional assays . protocol and platform engineering improvements have enabled the generation of 1 10 9 bases of sequence data in 27 h for $$1000 . as a result, ngs is increasingly being used as a general platform for research assays for methylation state , dna mutations (1000 genomes), copy number variation , promoter occupancy and others . ngs diagnostics are being translated to clinical applications including non-invasive fetal diagnostics , infectious disease diagnostics , cancer diagnostics , and human microbiome analysis (the human microbiome project consortium, 2013). increasingly, ngs is being used to interrogate mutations in heterogeneous clinical samples. for example, ngs-based noninvasive fetal dna testing uses maternal blood sample to sequence the minority fraction of cell-free fetal dna . infectious diseases such as hiv and influenza may contain many genetically heterogeneous sub-populations . dna sequencing of individual regions of a solid tumor has revealed genetic heterogeneous within an individual sample . importantly, accounting for technical errors can drastically improve performance . however, the primary statistical tools for calling variants from ngs data are optimized for homogeneous samples. samtools and gatk use a naive bayesian decision rule to call variants . gatk involves more sophisticate pre-and post-processing steps wherein the genotype prior is fixed and constant across all loci and the likelihood of an allele at a locus is a function of the phred score . recently, some have developed algorithms to call low-frequency or rare variants in heterogeneous samples.developed a bayesian framework which can model the normal dna contamination and intra-tumor heterogeneity by parameterizing the normal genotype cell proportion at each snp. varscan2 combines algorithmic heuristics to call genotypes in the tumor and normal sample pileup data and then applies a fishers exact test on the read count data to detect a significant difference in the genotype calls . strelka uses a hierarchical bayesian approach to model the joint distribution of the allele frequency in the tumor and normal samples at each locus . with the joint distribution available, one is able to identify locations with dissimilar allele frequencies. mutect uses a bayesian posterior probability in its decision rule to evaluate the likelihood of a mutation . rvd uses a hierarchical bayesian model to capture the error structure of the data and call variants . that algorithm requires a very high read depth to estimate the sequencing error rate and call variants. several studies have compared the relative performance of these algorithms.demonstrated that varscan-somatic performed the best when comparing samtools, gatk and splinter for detecting minor allele fractions (mafs) of 18, with 500 coverage required for optimal performance. however,also highlighted the fact that varscan2 yielded more false positives at high read depth.showed that varscan-somatic outperformed strelka and had performance on-par with mutect in detecting a 5 maf for read depths between 100 and 1000. the remainder of this article is organized as follows. in the next section we describe the statistical model structure of our new algorithm, rvd2. then, we derive a sampling algorithm for computing the posterior distribution over latent variables in the model and use those samples in a bayesian posterior distribution hypothesis test to call variants. we compare the performance of rvd2 to several other variant calling algorithms for a range of read depths and minor allele fractions. finally, we show that rvd2 is able to call variants on a heterogeneous clinical sample and identify two novel loss-ofheterozygosity events.we tested rvd2 using synthetic dna and data from the hcc1187 primary ductal carcinoma sample. the inference algorithm parameters were set to yield 4000 gibbs samples with a 20 burn-in and 2 thinning rate for a final total of 1600 samples. we drew 1000 samples from estimate the posterior probability of a variant. we performed the posterior difference test to identify mutations in the haploid synthetic data. we set the threshold s 0 and the size of the test a 0:05. for the hcc1187 dataset, we identified both somatic and germline mutations. in the posterior somatic test, we set the threshold s 0 and the size of the test a 0:05. in the posterior germline test, we set the threshold s 0:05 considering the low average coverage (40). the size of the test is set at a 0:15. we performed the v 2 non-uniformity test after the posterior density tests.we describe here a novel algorithm for model estimation and hypothesis testing for identifying single-nucleotide variants in heterogeneous samples using ngs data. our algorithm has a higher sensitivity and specificity than many other approaches for a range of read depths and mafs. our inference algorithm uses gibbs sampling to do inference in the rvd2 hierarchical empirical bayes model. this sampling procedure provides a guarantee to identify the global optimal parameter settings asymptotically. however, it may require many samples to achieve that guarantee causing the algorithm to be slower than other deterministic approaches. we opted for this balance of speed and accuracy because computational time is often not limiting and the cost of a false positive or false negative greatly outweighs the cost of more computation. another factor that can affect the speed of rvd2 is the number of mh sample within one gibbs sampling run. rvd2 is able to use multiple cores in parallel, which can significantly improve time efficiency. in future studies, we plan to reduce the computational cost by using more sophisticated mcmc sampling methods or deterministic approximation methods such as variational em or stochastic variational em. we have focused on the statistical model and hypothesis test in this study and our results do not include any pre-filtration of erroneous reads or post-filtration of mutation calls beyond a simple quality score threshold. incorporation of such data-cleaning steps will likely improve the accuracy of the algorithm. our approach does not address identification of indels, structural variants or copy number variants. those mutations typically require specific data analysis models and tests that are different than those for singlenucleotide variants. furthermore, analysis of rna-seq data or other data generated on the ngs platform may require different models that are more appropriately tuned to the particular noise feature of that data. the availability of clinical sequence data is increasing as the technical capability to sequence clinical samples at low-cost improves. consequently, we require statistically accurate algorithms that are able to call germline and somatic point mutations in heterogeneous samples with low purity. such accurate algorithms are a step toward greater access to genomics for clinical diagnostics.  
