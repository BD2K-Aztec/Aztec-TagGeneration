systems biology phosphochain: a novel algorithm to predict kinase and phosphatase networks from high-throughput expression data motivation: protein phosphorylation is critical for regulating cellular activities by controlling protein activities, localization and turnover, and by transmitting information within cells through signaling networks. however, predictions of protein phosphorylation and signaling networks remain a significant challenge, lagging behind predictions of transcriptional regulatory networks into which they often feed. results: we developed phosphochain to predict kinases, phosphat-ases and chains of phosphorylation events in signaling networks by combining mrna expression levels of regulators and targets with a motif detection algorithm and optional prior information. phosphochain correctly reconstructed $78 of the yeast mitogen-activated protein kinase pathway from publicly available data. when tested on yeast phosphoproteomic data from large-scale mass spectrometry experiments, phosphochain correctly identified $27 more phosphorylation sites than existing motif detection tools (netphosyeast and gps2.0), and predictions of kinasephosphatase interactions overlapped with $59 of known interactions present in yeast databases. phosphochain provides a valuable framework for predicting condition-specific phosphorylation events from high-throughput data. availability: phosphochain is implemented in java and available atprotein post-translational modifications (ptms) enable proteins to rapidly switch from one state to another. signaling networks exploit this feature to transmit information from the cytoplasm and outside the cell to the genome by interfacing with transcription factors, which themselves form complex gene regulatory networks. in comparison with gene regulatory networks, our understanding and prediction of signaling networks is undeveloped, yet critical to a systems view of complex regulatory dynamics. protein phosphorylation is by far the most commonly studied and predominant post-translational modification of signaling networks. moreover, phosphorylation of signaling proteins is fundamental to cellular responses, health and disease . kinases and phosphatases, which are responsible for adding and removing phosphates from proteins, are common drug targets . the vast majority of existing tools for predicting phosphorylation events tend to focus on predicting phosphorylation sites from amino acid sequences . this approach is limited because kinases and phosphatases tend to act on many of the same sites, and thus it is not clear which factors are active under which conditions . therefore, we sought to include activity data to improve the predictability of phosphorylation events and to reconstruct signaling networks. studies of signaling networks in both yeast and mammalian cells reveal that the expression of genes encoding kinases often increases with the activation of the signaling pathway, suggesting that expression might be a predictor of signaling network activities. similarly, high-throughput phosphoproteomics studies using biochemical enrichment and mass spectrometry have led to large experimentally validated proteomic databases annotating phosphorylation on target proteins . these data map the potential changes of protein activities and can be used to predict new phosphorylation events and phosphorylation-driven regulatory networks. therefore, we developed a tool, called phosphochain, which includes condition-specific regulatory information (i.e. kinase and phosphatase activities or proxies thereof) to predict ptm regulatory events and signaling network activities. in comparison with 70 other phosphorylation prediction tools (supplementary), only regphos and her module included activity data, and regphos only used it to verify their predictions. phosphochain works by constructing an alternating decision tree (adtree) containing nodes that predict whether a kinase or phosphatase is active as well as the activities of target proteins based on protein activity patterns and phosphorylation sequence to whom correspondence should be addressed. y the authors wish it to be known that, in their opinion, the first two authors should be regarded as joint first authors. motifs that occur in multiple experiments. here, we apply phosphochain to the yeast mapk (mitogen-activated protein kinase) network as a test case and on a genome-wide scale to predict the entire kinase-phosphatase-transcription factor regulatory network in yeast. the decision tree provides three biologically relevant predictions: (i) given the measured activity for a few factors, it predicts the activity levels for many targets; (ii) it predicts the target sequence for factors (kinases or phosphatases); and (iii) it predicts the chain of post-translational modifications (such as in the mapk pathway) that are responsible for downstream transcriptional changes.phosphochain is built on the hypothesis that proxies for pa can be used in conjunction with detection and prediction of) that describes which kinases and phosphatases acting at specific binding sites affect the activity of a target protein. phosphochain generates rules based on pa measurements and the presence of putative template kinase and phosphatase binding motifs (e.g. hog1 is activated, and a hog1 binding motif is present) that predicts the activity level of a target protein (e.g. ste12). pa levels are estimated from mrna expression levels in genome-wide expression studies involving genetic perturbations. phosphochain works by iteratively adding good rules to a master list of rules that, together, lead to a single strong hypothesis. phosphochain accepts as input a pa matrix that contains activity measurements for a set of proteins p across a set of experiments e (, panel i.1). for example, to reconstruct the mapk pathway, p is a dataset containing 336 genes encoding kpt and e contains 28 mrna expression experiments in which mapk-related factors have been deleted including some experiments in which multiple genes were deleted (van). each experiment is correlated with da measurements for the proteins when the factors f (i.e. known kinases and phosphatases) are perturbed to produce an frm. for these experiments, the da matrix includes 6097 proteins and a dataset with perturbations of 144 kinases and phosphatases (kp). if a da matrix is not available, then a subset of the pa matrix containing activity levels for all factors f may be used instead. however, including prior information through a da matrix is particularly important when using mrna expression data because it is not the ideal proxy for post-translational modification-related activity. similarly, phosphochain accepts as input protein sequences p., panel i.2, shows how an sasm is used to generate template (consensus) motifs n that encapsulate all known target motifs m present on these sequences. a boolean mm is then generated that encodes which of the target proteins contain one or more of the jnj motifs. phosphochain then generates a separate tree for each of the target proteins. as shown in, panel i.3, the algorithm generates conditions that combine the frm and mm to produce a cm that identifies which conditions are satisfied (e.g., factor 1 is active, and template motif 3 is present). these conditions are evaluated for each of the jej experiments to produce the cm, which is paired with a class vector. the class vector represents the activity level for each target protein p during each experiment based on mrna levels. phosphochain then iteratively constructs an adtree by evaluating all jcj conditions (, panel ii.1) and adding that rule that minimizes a weighted loss function. thus, phosphochain selects the best rule for predicting ps activity level across all experiments (, panel ii.2). the experiments are then re-weighted so those misclassified by the previously added rule contribute more toward the subsequent rule selected in the next iteration (, panel ii.3). after t iterations, the resulting adtree predicts the activity level of a single protein across all conditions. thus, each tree predicts the activity level for one protein (, panel iii.1) and the factors and motifs that contribute to the final activity level (, panel iii.2). this procedure is repeated for all target proteins in p, and a complete signaling network is reconstructed by chaining multiple trees together (, panel iii.3). this is accomplished by simply ordering the predictions of each protein. the resulting network includes all predictions, thus emphasizing completeness and revealing potential complex network structure. notably, during a given experiment, only some of the conditions may be satisfied; thus, phosphochain also predicts condition-specific regulation. to test phosphochains performance and the relative importance of its components, we compared phosphochain to (i) phosphochain, which is phosphochain without the da matrix; (ii) medusa, which is the inspiration for phosphochain and is designed to detect transcriptional regulation; and (iii) adtree, which is essentially phosphochain without binding motifs. we tested these algorithms abilities to reconstruct the phosphorylation-related portion of the four well-studied yeast mapk pathways shown in (supplementary). phosphochain was trained using mrna expression data as pa measurements for 28 gene deletion experiments (van), which included deletions of genes that encode the 19 kinases and phosphatases present in the mapk pathway. we used 10-fold cross-validation to evaluate the cutoff parameters for the frm and mm and to compare phosphochain with other tools. the results demonstrate that phosphochain accurately predicts mrna expression and that accuracy was stable for nearly all cutoffs (supplementary).  
