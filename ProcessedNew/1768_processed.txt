fast filtering for rna homology search motivation: homology search for rnas can use secondary structure information to increase power by modeling base pairs, as in covariance models, but the resulting computational costs are high. typical acceleration strategies rely on at least one filtering stage using sequence-only search. results: here we present the multi-segment cyk (mscyk) filter, which implements a heuristic of ungapped structural alignment for rna homology search. compared to gapped alignment, this approximation has lower computation time requirements (o(n 4) reduced to o(n 3)), and space requirements (o(n 3) reduced to o(n 2)). a vector-parallel implementation of this method gives up to 100-fold speed-up; vector-parallel implementations of standard gapped alignment at two levels of precision give 3-and 6-fold speed-ups. these approaches are combined to create a filtering pipeline that scores rna secondary structure at all stages, with results that are synergistic with existing methods.a covariance model (cm) is a probabilistic profile model of one or more structural rnas with a consensus secondary structure. cms are used for database search and for multiple alignment, and form the basis for the rfam database of known structural rnas . explicitly modeling the secondary structure allows the model to capture information about an rna when the base pairs are preserved even if the sequence changes. a cm includes states that can describe a base pair as a single unit, so that the score can favor good combinations rather than only single residue conservation; the states are arranged in a branching tree structure that reflects the shared consensus fold of the rna. inclusion of secondary structure increases the sensitivity and specificity of homology searches for rna compared to sequence profile methods . cms do neglect some higher order features of rna structure, such as pseudoknots, but this is generally acceptable for homology search. a large obstacle to the application of cms is one of the computational costs: both memory and time requirements have worse scaling behavior than their sequence-only counterparts. many different approaches have been used for increasing the speed of cm search and alignment. acceleration methods generally fall into three classes: direct hardware acceleration of the base to whom correspondence should be addressed. method , heuristic filters that reduce the number of sequences to be searched and heuristic bands that reduce the number of possible alignments per sequence. filtering and banding techniques for rna search can be based on sequenceonly or sequence-and-structure models, but one common approach is a sequence-only filter such as the blast filter used in the rfam database pipeline . recent work in filtering methods has focused on the automatic design of profile hmms and on models that include small amounts of structural information . structure description languages and heuristic rna structural search methods stand on their own, but can also be used as structure-based filters for cm search . a recent example in this area also focuses on automatic rather than manual creation of filters . banding approaches for cm search include hmm bands and structure-derived bands , and similar methods are used in other types of rna algorithms such as combined alignment and folding . the infernal software package includes an accelerated search pipeline that incorporates several of these ideas . this pipeline begins with maximum-likelihood hmm filters derived from the cm , followed by hmm-banded structural alignment . these results are further passed to alignment using structure-based query-dependent banding (qdb) . the final scoring is done by the inside algorithm, which integrates over all possible alignments rather than only considering the single best alignment. the use of filters does decrease sensitivity somewhat, but it provides 30-fold speed improvements . the 3.0 version of the hmmer software package for profile hidden markov models (http://hmmer.janelia.org) also includes an acceleration pipeline for searches, but its approach is conceptually quite different. hmmer3 begins with ungapped alignment, under a model that produces short alignment segments with positionspecific scores and no indels, and also includes a loop that allows the detection and combined scoring of a set of these hits interspersed with unaligned sequence; this is called the multi-segment viterbi (msv) algorithm. a second stage performs more typical viterbi alignment including gaps, before a final filter that calculates the forward score, the total likelihood of the sequence, integrating over all possible alignments. sequences that pass all three filter stages are subjected to some additional processing before being displayed in the results. in addition to this tiered approach moving from simpler to more complex models, hmmer3 uses simd vector parallelization at each filter stage to decrease the time requirements. the first stage msv calculation runs with 16-foldpage: 3103 31023109mscyk is a heuristic designed for search acceleration; we expect that its speed comes with a loss of sensitivity, but we want the loss to be minimal. to quantify this performance trade-off, we evaluated the mscyk pipeline using the rmark-2 benchmark used in earlier  
