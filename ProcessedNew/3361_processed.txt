genetics and population analysis opticall: a robust genotype-calling algorithm for rare, low-frequency and common variants motivation: existing microarray genotype-calling algorithms adopt either snp-by-snp (snp-wise) or sample-by-sample (sample-wise) approaches to calling. we have developed a novel genotype-calling algorithm for the illumina platform, opticall, that uses both snp-wise and sample-wise calling to more accurately ascertain genotypes at rare, low-frequency and common variants. results: using data from 4537 individuals from the 1958 british birth cohort genotyped on the immunochip, we estimate the proportion of snps lost to downstream analysis due to false quality control failures, and rare variants misclassified as monomorphic, is only 1.38 with opticall, in comparison to 3.87, 7.85 and 4.09 for illuminus, genosnp and gencall, respectively. we show that opticall accurately captures rare variants and can correctly account for snps where probe intensity clouds are shifted from their expected positions. availability and implementation: opticall is implemented in c++ for use on unix operating systems and is available for download atburgeoning whole-genome and whole-exome sequencing projects are likely to require large-scale microarray-based follow-up studies. already, custom arrays, such as metabochip and immunochip, utilize snps identified through population-based sequencing efforts such as 1000 genomes to better survey loci known to underpin variation across related phenotypes . typically, the allelic probes on these custom arrays have undergone less stringent quality control (qc) compared to those that make it onto mass-produced gwas arrays. this drop in probe quality, in addition to a greater focus on low-frequency and rare variants (those with minor allele frequencies 0.55 and 0.5, respectively; the 1000) presents many problems for existing genotype-calling algorithms. genotype-calling algorithms use normalized measures of dna binding to allele specific probes to ascertain the genotype of an individual at a given snp. as an example, a wild-type homozygous genotype at a particular snp would have a high intensity value for the wild-type allelic probe, and little or no intensity for to whom correspondence should be addressed. the alternative allelic probe. a heterozygous sample would have intermediate intensities for both probes. existing callers vary in both the statistical models they apply, and how they utilize the intensity data across individuals and snps. illuminas proprietary genotype-calling software, gencall, uses a custom clustering algorithm that encompasses several biological heuristics to determine genotypes from intensity clouds obtained by gathering all individuals at a single snp. if less than three well-defined genotype clusters are observed, gencall uses a neural network model to estimate the location and shape of the undefined clusters. gencall is designed to work on illumina arrays and, being based on a pretrained neural network, its performance on a new dataset is dependent on how close the new data matches the data used to train the network. another commonly used genotype-calling algorithm, illuminus , also designed for illumina arrays, again clusters intensity data across samples on a per snp basis, using an unsupervised clustering method based on a mixture model of students t-distributions. this unsupervised approach removes the need for a called training set. however, low-frequency snps and/or small sample sizes can result in poorly defined clusters and inaccurate genotype calls due to the small number of rare allele observations.discovered within-sample intensity data also tended to cluster into three distinct genotype groups. on the basis of this observation, they created genosnp, a within-sample genotype-calling algorithm. clustering within sample can be advantageous for rare variants and small sample sizes, as three well-defined clusters are always observed. a drawback of the approach is that intensity variation between snps is not accounted for, resulting in inaccurate genotype calls for snps where intensity clusters are shifted from their expected positions. we have developed opticall, a novel genotype-calling algorithm that uses both within and across sample intensity data to accurately ascertain genotypes from across the minor allele frequency spectrum. in the following sections, we describe opticall and compare its output to that from existing algorithms using 4537 samples from the 1958 british birth cohort genotyped on the immunochip, an illumina iselect hd custom array .to test the performance of opticall, and compare it to existing algorithms, we used data from 4537 individuals from the 1958 british birth cohort who were genotyped using the immunochip, an illumina iselect hd custom array designed for deep replication of autoimmune disease genome-wide association study results and fine-mapping within 184 known autoimmune disease loci . genotypes were called at 192 402 snps using opticall, gencall, illuminus and genosnp. default parameters were used when running each of the algorithms. the genotype data from each algorithm underwent a simple qc protocol to reflect a typical association study. snps failed qc if they had a call rate 98 or hwe p10 5 .shows the qc results for each caller across the dataset. calls from illuminus and genosnp produce the most discordant results at qc (with 5157 and 8815 unique qc passes and fails, respectively) whereas gencall and opticall appear to have more overlapping qc outcomes with other callers.  
