structural bioinformatics assignment of protein sequences to existing domain and family classification systems: pfam and the pdb motivation: automating the assignment of existing domain and protein family classifications to new sets of sequences is an important task. current methods often miss assignments because remote relationships fail to achieve statistical significance. some assignments are not as long as the actual domain definitions because local alignment methods often cut alignments short. long insertions in query sequences often erroneously result in two copies of the domain assigned to the query. divergent repeat sequences in proteins are often missed. results: we have developed a multilevel procedure to produce nearly complete assignments of protein families of an existing classification system to a large set of sequences. we apply this to the task of assigning pfam domains to sequences and structures in the protein data bank (pdb). we found that hhsearch alignments frequently scored more remotely related pfams in pfam clans higher than closely related pfams, thus, leading to erroneous assignment at the pfam family level. a greedy algorithm allowing for partial overlaps was, thus, applied first to sequence/hmm alignments, then hmmhmm alignments and then structure alignments, taking care to join partial alignments split by large insertions into single-domain assignments. additional assignment of repeat pfams with weaker e-values was allowed after stronger assignments of the repeat hmm. our database of assignments, presented in a database called pdbfam, contains pfams for 99.4 of chains 450 residues.clustering proteins of known structures into families or superfamilies is a long-standing task of particular importance in understanding structurefunction relationships and for protein structure prediction by homology. usually, protein classification in the pdb is accomplished at the level of domainssubstructures that recur as functional units in different protein contexts. structure-based domain classifications of the pdb, such as scop and cath , are constructed by comparing the available protein structures in the pdb and creating classifications of new folds and superfamilies manually. existing structure-based classifications cover only a portion of the pdb. the most recent scop release (v. 1.75a) is 2 years behind the pdb and only covers 61 of current pdb entries. cath was last updated in november 2011 and covers 64 of the current pdb. sequence-based approaches, such as pfam , prodom , interpro , smart and supfam , can be readily applied to new structures because most new structures fit into existing sequence clusters. in this way, they are well suited for rapid and automated classification of new structures in a way that structure-based classifications are not. some differences between sequence-based and structurebased classifications occur when a single sequence domain is structurally two or more domains with separate hydrophobic cores or a single structural domain is two sequence domains . structure-based methods are often superior in recognizing remote relationships between families, as these relationships may be apparent only from structural similarity and in the absence of any recognizable sequence similarity. even with structural information, it may be difficult to distinguish between divergent and convergent evolutionary relationships . our aims in this article are two fold: first, to develop a general procedure that can be used to make rigorous assignments of existing protein family classification systems for any set of protein sequences, and second, to perform this task for the entire pdb. for the pdb, we wish to define a method that can be run automatically on a weekly or monthly basis. we have thus chosen the sequence-based domain classification given by pfam, as new proteins in the pdb can be readily assigned to existing pfams, without manual intervention required by structure-based classification systems. pfam is a database of protein families, in which each family is represented by a hidden markov model (hmm) created from manually curated multiple sequence alignments . the pfam classification of protein families has gained widespread acceptance among biologists because of its wide coverage of proteins and a sensible naming convention related to protein functions and commonly used names (pkinase, sh2, etc.). pfam was recently used in the protein structure initiative to select targets and divide them among different high-throughput centres . some pfam families are seeded by structures in the pdb . two or more related pfam families are grouped into a pfam clan . such relationships are often to whom correspondence should be addressed. identified through structural similarity, as they are in the structural classification systems. several assignments of pfam domains to the pdb are currently available, including pfam itself , sifts and the rcsb (research collaboratory for structural bioinformatics), covering 45, 87 and 94 of unique sequences in the pdb, respectively. each of the currently available sources of pfam assignments to the pdb suffer from one or more of a number of problems. first, because they use only the original pdb or uniprot sequences against the pfam hmms, they miss many potential assignments that occur when the sequence is not closely related to any single pfam family. it is likely that sequence methods based on profileprofile comparison may identify these relationships and provide higher levels of statistical significance. second, in some cases, these sources also provide completely overlapping assignments, sometimes when two different pfams in the same clan align to the same region of a pdb sequence with good e-values. if we want to cluster at the family level and then the superfamily level, this produces discrepancies. third, some proteins have long insertions relative to the pfam hmm definition, and hmmer may produce two alignment segments, one on either side of the insertion. these two segments cover non-overlapping regions of the hmm, and together should comprise a single pfam assignment. however, the publicly available sources simply list these separately, and they cannot easily be distinguished from repeated domains in the same protein. fourth, some protein structures are composed of two chains that together comprise a single pfam domain, i.e. two non-overlapping regions of the same pfam hmm. pfam, sifts and the rcsb do not properly account for domains split by insertions or split between different chains. we overcome some of the deficiencies of other pfam databases using several strategies. the first is to use consensus sequences derived from psi-blast profiles and to run these through the pfam hmm library. such sequences can be fed to the pfam hmms like any protein sequence, and they usually produce more complete alignments with better e-values than the original sequences. similar techniques have been used by us previously and by others . secondly, we utilize hhblits to produce hmms for pdb sequences and their parent uniprot sequences, and then apply hmmhmm alignment of these hmms against the pfam hmms using hhsearch . the third approach is to utilize structure alignment of statistically confident and complete structures in pfam families with weak hits in the same pfam familieseither those with poor e-values and/or alignments that cover only a portion of the pfam hmm. this allows us to verify whether a weak assignment is correct and to extend short alignments. finally, we have developed a procedure for optimally combining assignments from these multiple sources into pfam architectures for each protein in the pdb. the procedure combines non-overlapping or minimally overlapping partial assignments to the same pfam into single assignments, thus, accounting for large insertions or domains split across multiple protein chains. we assign additional repeat domains at weaker e-values if the same repeat family is assigned earlier in the procedure at an e-value better than the general cut-off. we explore the properties of the regions and proteins that cannot be assigned to a pfam domain and the interactions between pfam domains in the biological assemblies of structures in the pdb, according to our pfam assignments. regions not assigned to pfams have a greater tendency to be disordered in protein structures and to have lower rates of regular secondary structure than regions assigned to pfam domains. the number of pfampfam interactions is increased by the number of assignments made using the methods described here but are also critically dependent on the usage of biological assemblies from crystal structures rather than the asymmetric units. the pfam assignments can be searched through the protcid server (http://dunbrack2.fccc.edu/protcid) by pdb codes, pfam codes and sequences. downloadable files of the pfam assignments and those proteins that cannot be assigned are also available on the website http://dunbrack2.fccc.edu/protcid/ pdbfam. our procedure is general and can be applied to other domain classification systems and other target sequence sets. even if the target sequence set is not the pdb, structural information may still be used for proteins in the sequence set that can be readily aligned with proteins of known structure.one potential use for the assignments in pdbfam is in programs that perform searches of the pdb with a query sequence or structure and return lists of structures that contain similarities to the query above some threshold. examples include fold recognition servers, such as ffas , and structure similarity search servers, such as fatcat. often the list of hits returned consists solely of the pdb entry and chain, residue numbers and sequence or structure alignments. it is, therefore, difficult to know whether the hits are related to each other or whether they share any functional relationship with the query. scop and cath designations are sometimes provided, which solves the first problem, but scop and cath represent less than two-thirds of the pdb, and their utility for this purpose is, therefore, limited. we believe that our pfam domain assignments and associated clan information may be used to provide both relationships among the hits (shared pfams or clans) and functional information of the hits (e.g. pkinase). protein domain classification is also useful in the analysis of the interactions of protein domains with each other. our protcid server provides information on clusters of similar interfaces between homologous proteins or protein pairs in multiple crystal forms in the pdb . assignments that are as accurate and complete as possible allow for better identification of biologically relevant interfaces in multiple crystal forms. each pfam in the pdb has a webpage in protcid listing all pdb entries that contain that pfam, the chain architecture of the protein containing the pfam, and the chain architectures of any other protein sequences in the same entry. thus, looking up a pfam in protcid provides information on other domains that the pfam may interact with, either within the same chain or in protein complexes.our assignments using pfam have some limitations. we have defined a pipeline using a combination of available methods that is relatively efficient and can be applied automatically on a regular basis. it is possible that different choices might increase the representation slightly (e.g. different ways of defining the consensus sequences or the use of several structure alignment programs). but the coverage is high as it is, and exploring further avenues is likely to be a case of rapidly dwindling returns. pfam does not have models for some kinds of proteins. for instance, about half of the entities 4250 amino acids that do not have pfam assignments in our results are virus proteins, especially virus capsids. pfam is organized into clans, and these may in most cases be useful for inferring structural relationships at the superfamily level. but many clans have hmms of very different lengths; therefore, the structural domains are not likely to be completely consistent across clans. also, it is likely the case that some superfamily relationships evident in scop and cath are missed by the pfam clans. we cannot make assignments to many peptides, either because the parent uniprot sequence is not known or does not exist or because the peptide belongs to the region of a protein that is not within a pfam domain. it is likely that intrinsically disordered protein regions have less coverage in pfam than folded domains, and many peptides bound to proteins come from these regions. nevertheless, our assignments cover 99.4 of unique sequences in the pdb  
