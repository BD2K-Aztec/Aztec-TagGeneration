structural bioinformatics mdpocket: open-source cavity detection and characterization on molecular dynamics trajectories motivation: a variety of pocket detection algorithms are now freely or commercially available to the scientific community for the analysis of static protein structures. however, since proteins are dynamic entities, enhancing the capabilities of these programs for the straightforward detection and characterization of cavities taking into account protein conformational ensembles should be valuable for capturing the plasticity of pockets, and therefore allow gaining insight into structurefunction relationships. results: this article describes a new method, called mdpocket, providing a fast, free and open-source tool for tracking small molecule binding sites and gas migration pathways on molecular dynamics (mds) trajectories or other conformational ensembles. mdpocket is based on the fpocket cavity detection algorithm and a valuable contribution to existing analysis tools. the capabilities of mdpocket are illustrated for three relevant cases: (i) the detection of transient subpockets using an ensemble of crystal structures of hsp90; (ii) the detection of known xenon binding sites and migration pathways in myoglobin; and (iii) the identification of suitable pockets for molecular docking in p38 map kinase. availability: mdpocket is free and open-source software and can be downloaded at http://fpocket.sourceforge.net.over the past two decades, a variety of algorithms have been proposed with the aim to identify binding pockets for small molecules in biomolecular targets . these algorithms can be classified into three broad classes depending on the general method used for cavity detection: (i) geometrybased, (ii) energy-based or (iii) sequence-based methods. the first class relies on geometrical features of pockets with no or few to whom correspondence should be addressed. considerations for the interaction energy between a putative ligand and the pocket. energy-based algorithms estimate the suitability of a pocket to bind a molecule using probepocket interaction energy calculations. the latter methods are usually computationally more expensive and require specific atom typing and the use of underlying force fields. sequence-based methods exploit the propensity of conserved residues in the binding site. last, various hybrid methods, combining at least two of the previous approaches, also exist . the reader is directed to recent reviews for a detailed discussion of different cavity detection algorithms . the vast majority of cavity detection algorithms have been developed to treat static structures, like crystal structures of proteins available in the protein data bank (pdb). however, this represents a serious limitation to account for the intrinsic plasticity of the binding pocket. protein dynamics act on a multitude of aspects in protein function. for instance, side chain flipping or domain motions can obstruct or free internal cavities or channels that allow migration of ligands and reshape the binding sites . in turn, these findings raise challenging questions about the impact of protein flexibility on the topological features of cavities and their binding properties. few works have attempted to account for the dynamical behaviour of proteins in the identification of binding cavities and tunnels. the interplay between protein dynamics and ligand migration pathways can be characterized by tools that rely on prior molecular dynamics (mds) simulations and further post-processing of the trajectory. voidoo allows internal cavity and volume calculations, but it is rather time consuming and its use is not straightforward. caver is a pymol plugin that allows internal channel detection on md trajectories. caver was recently improved to a software called mole using computational geometry principles instead of grid-based calculations . more recently, wolfson and coworkers have proposed a method called molaxis for detection of channels from the interior of the protein to the bulk solvent . these methods are designed to detect channels on static structures or conformational ensembles of the protein. in order to examine the suitability of internal pathways for ligand migration, more time consuming techniques like implicit ligand sampling have been proposed . glazer et al.(2009) have used mds for the identification of calcium binding sites and have shown that the inclusion of dynamic behaviour can improve function prediction. recently, a matlab-based approach called dynamic map ensemble (dyme) has been proposed for the analysis of putative internal channels from md trajectories using voronoi tessellation and clustering techniques. regarding the binding of ligands in cavities, protein dynamics has been accounted for by using a set of privileged static structures, which are chosen as representative conformational states of the pocket based on experimental x-ray structures or from md simulations of the target . more recently, eyrisch and helms established a protocol for the detection of transient cavities in proteinprotein interfaces by using md simulations and the cavity detection algorithm pass . other approaches combine conformational sampling and/or selection from md simulations to allow pocket adaptation to a given ligand positioned in the binding site . finally, a distinct strategy has been adopted in pele , as internal pockets and channels are identified based on localized perturbations that combine monte carlo sampling and energy minimization calculations to track and predict ligand migration pathways. in this work, a new generic pocket detection program called mdpocket is presented. the aim of mdpocket is to identify and characterize binding sites and channels that might be transiently formed in the protein from the analysis of conformational ensembles generated by mds or other sources. the core of this new program is the recently published open-source platform fpocket (le), which is a very fast geometry-based cavity detection algorithm. the platform relies on three programs: (i) fpocket, which identifies cavities in a protein; (ii) dpocket, which extracts descriptors of the pocket; and finally (iii) tpocket, which allows assessment of pocket scoring functions. one main advantage of fpocket is its adaptability to a given problem: initially developed for the discovery of small molecule binding sites, it can detect different types of cavities, including very small pockets, ligand binding sites or even tunnels via a proper choice of parameters available through command line. mdpocket is fast and well suited for the study of processes where tracking of cavities is of interest. in particular, the capabilities of mdpocket are illustrated by examining (i) the plasticity of the hsp90 binding site using a set of x-ray crystallographic structures, (ii) the analysis of xenon binding sites and migration pathways in myoglobin (mb) and (iii) the selection of suitable docking sites for p38 (asp-phe-gly) dfg-in binders. the software is freely available as part of the fpocket software package and can be downloaded from http://fpocket.sourceforge.net.mdpocket is a new tool intended to facilitate the qualitative and quantitative analysis of transient pockets and channels from conformational ensembles that account for the intrinsic dynamics of proteins. mdpocket is based on fpocket, a general-purpose pocket detection program, allowing adaptable, fast, free and reliable pocket detection. the accuracy of pocket prediction is mainly limited by two factors: (i) the grid-based nature of mdpocket, and (ii) the choice of parameters for filtering and clustering -spheres. as mdpocket uses a grid-based methodology, the results can be affected by the necessary structural superimposition of the snapshots. results derived for p38 map kinase, where the two domains exhibit large relative motion with respect to each other, show a dependence on the set of atoms used for alignment. if the alignment is done using as reference one of the two subunits, pocket detection and averaging during time will be altered for all pockets on the other subunit. consequently, pocket frequency and density on the second subunit are underestimated. in such a case, one should perform the structural alignment on the cavity of interest (the active site in our case), and bear in mind that pockets found on other places of the protein might not be representative of the whole trajectory. the use of different parameter sets for pocket detection can have a major influence on results. here, three parameter sets have been assessed, each addressing a given purpose. for exploratory mdpocket runs, probably water probe-sized -spheres (parameter set 3) are sufficient to give insights into the pocket behaviour during md trajectories. however, if the main aim is to explore internal pathways in the protein matrix, parameter set 2 is better suited. this is illustrated by the analysis of the 50 ns md simulation of mb. mdpocket was capable of identifying crystallographically known xe-binding pockets and infer putative connections between these binding sites in agreement with the experimental data. furthermore, mdpocket allows for identification of the hise7 migration pathway, which is considered to be the main entry of diatomic ligands to the distal haem cavity. exploration of binding sites adapted for compounds (i.e. drugs, substrates) larger than gaseous small molecules can be simply made by changing the search parameters (default parameter set). this versatility is illustrated by simulating the docking of 32 ligands to p38 map kinase. virtual screening techniques often consider a rigid receptor conformation or at most a set of receptor conformations page: 3284 32763285  
