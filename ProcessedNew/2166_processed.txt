sequence analysis hapmuc: somatic mutation calling using heterozygous germ line variants near candidate mutations motivation: identifying somatic changes from tumor and matched normal sequences has become a standard approach in cancer research. more specifically, this requires accurate detection of somatic point mutations with low allele frequencies in impure and heterogeneous cancer samples. although haplotype phasing information derived by using heterozygous germ line variants near candidate mutations would improve accuracy, no somatic mutation caller that uses such information is currently available. results: we propose a bayesian hierarchical method, termed hapmuc, in which power is increased by using available information on heterozygous germ line variants located near candidate mutations. we first constructed two generative models (the mutation model and the error model). in the generative models, we prepared candidate haplotypes, considering a heterozygous germ line variant if available, and the observed reads were realigned to the haplotypes. we then inferred the haplotype frequencies and computed the marginal likelihoods using a variational bayesian algorithm. finally, we derived a bayes factor for evaluating the possibility of the existence of somatic mutations. we also demonstrated that our algorithm has superior spe-cificity and sensitivity compared with existing methods, as determined based on a simulation, the tcga mutation calling benchmark 4 data-sets and data from the colo-829 cell line. availability and implementation: the hapmuc source code is available fromcancer is caused by genomic alterations. in particular, somatic point mutations play a clear role in cancer development . driven by the recent advancement of high-throughput dna sequencing technologies, mutation calling from tumor and matched normal sequences is becoming a standard approach in cancer research . the simple goal of this approach is to detect genetic alterations that are unique to the tumor sample. for this purpose, statistical approaches that allow distinction of true somatic mutations from relatively numerous germ line variants, sequencing errors and alignment errors are required. moreover, mutation calling methods need to be sufficiently sensitive to detect targets with low allele frequencies in cancer because of low tumor contents, copy number variations and tumor heterogeneity. in particular, it is important to capture subclones demonstrating tumor heterogeneity because this is thought to be one of the main causes of therapeutic resistance and cancer recurrence . there are mainly two approaches to detect somatic mutations using sequence data of a tumornormal pair. the first approach is to use fishers exact test on read counts for evaluating the differences in allele frequencies between tumor and matched normal tissue; varscan 2 and genomon are categorized in this group. by ignoring complex biological structures, this approach achieves a reasonable computational speed and robustness. the second approach is based on bayesian modeling, which calculates the posterior probability that tumor and normal samples would have different genotypes. somaticsniper , jointsnvmix , strelka and mutect are representatives of this second group. comparative concurrent analysis of a pair of tumor and normal sequences achieved a performance superior to the previous independent type of analysis in which tumor and normal samples were genotyped independently and results were subtracted. here, we focused on heterozygous germ line variants located near candidate somatic mutations. in real data, we observed that somatic mutations occurred mostly on one of two normal haplotypes; however, sequencing errors occurred randomly on normal haplotypes. the data are shown in section 3.1. based on this observation, we propose a novel statistical method, hapmuc, which can use the information of heterozygous germ line variants near candidate mutations. first, we constructed two generative models under a bayesian statistical framework: one represents true somatic mutations and the other regards candidate somatic mutations as errors. in our generative models, we prepared four candidate haplotypes by combining a candidate mutation and a heterozygous germ line variant, if available. the alignment probabilities of the observed reads given each candidate haplotype to whom correspondence should be addressed the author 2014. published by oxford university press. this is an open access article distributed under the terms of the creative commons attribution non-commercial license (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. for commercial re-use, please contact journals.permissions@oup.com were then computed by using profile hidden markov models (profile hmm;). next, we inferred the haplotype frequencies and calculated the marginal likelihoods by using a variational bayesian algorithm . finally, we derived a bayes factor (bf), which is the ratio of the marginal likelihoods of these two models, to evaluate the possibility of the presence of somatic mutations. we first demonstrated the effectiveness of hapmuc in a simulation study. second, we also confirmed its efficiency based on a real sequence dataset obtained from breast cancer cell line samples, which forms part of the the cancer genome atlas (tcga) mutation calling benchmark 4 datasets. third, we tested hapmuc in the context of a whole genome using the tcga datasets, and the analysis suggested that our algorithm performed better than the existing methods, including varscan 2, somaticsniper, strelka and mutect. in addition, we confirmed that the sensitivity of our algorithm was superior or comparable with the existing methods using the colo-829 dataset with its list of validated somatic mutations . finally, we discuss limitations and propose future research directions for accurate mutation calling.in this article, we addressed the problem of accurately detecting somatic mutations in cancer by using tumor and matched normal ngs sequences. based on 10 ccrcc patients data, we observed that true somatic mutations mostly occurred on one of two normal haplotypes; however, sequencing errors occurred randomly on normal haplotypes. based on this observation, we developed a novel bayesian statistical method, hapmuc, which can use the information of heterozygous germ line variants located near candidate mutations. in our simulation study, we demonstrated that our algorithm has superior performance compared with a simple fisher method when a candidate mutation occurs near a heterozygous germ line variant. we also tested our algorithm on several read lengths (100, 150, 300 and 1000 bp) as well as single-end reads and paired-end reads; hapmuc achieved higher auc values with longer reads and paired reads by using additional information. for calculating the likelihood of read pairs, we approximated it by multiplying the alignment likelihoods of the first and second read, which assumes that read pairs are generated independently given the haplotype. however, we should modify our modeling for read pairs, considering their insertion size distribution, as a read-pair usually comes from a fragment. we also confirmed the advantages of using heterozygous germ line variants based on breast cancer cell line samples, which are publicly available as a part of the tcga mutation calling benchmark 4 datasets. in this experiment, we excluded potential alignment artifacts by using some genomic annotations, a blat filter with human decoy sequence (37d5) and an indel filter because mapping errors can confuse the haplotype inference of our algorithm. however, detecting and eliminating alignment errors appropriately remains a problem. additionally, we evaluated our algorithm in the context of a whole genome using the tcga mutation calling benchmark 4 datasets. we compared the results of hapmuc with those of the simple fisher method, bayesian methods, which includes strelka, mutect and somaticsniper, and varscan 2, which is based on fishers exact test but which uses some filters. for both snvs and indels, our method shows higher auc values than the alternative methods. during subsequent manual inspection using integrative genomics viewer (igv) , we confirmed that hapmuc succeeded in using contextual information, such as mismatches and homopolymers, near candidate mutations. although several filtering approaches have been proposed, to date, no somatic mutation caller that integrates the contextual information into its score has been available. furthermore, the analysis using the colo-829 dataset with the list of validated somatic mutations (  
