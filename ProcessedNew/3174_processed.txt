multivariate multi-way analysis of multi-source data motivation: analysis of variance (anova)-type methods are the default tool for the analysis of data with multiple covariates. these tools have been generalized to the multivariate analysis of high-throughput biological datasets, where the main challenge is the problem of small sample size and high dimensionality. however, the existing multi-way analysis methods are not designed for the currently increasingly important experiments where data is obtained from multiple sources. common examples of such settings include integrated analysis of metabolic and gene expression profiles, or metabolic profiles from several tissues in our case, in a controlled multi-way experimental setup where disease status, medical treatment, gender and time-series are usual covariates. results: we extend the applicability area of multivariate, multi-way anova-type methods to multi-source cases by introducing a novel bayesian model. the method is capable of finding covariate-related dependencies between the sources. it assumes the measurements consist of groups of similarly behaving variables, and estimates the multivariate covariate effects and their interaction effects for the discovered groups of variables. in particular, the method partitions the effects to those shared between the sources and to source-specific ones. the method is specifically designed for datasets with small sample sizes and high dimensionality. we apply the method to a lipidomics dataset from a lung cancer study with two-way experimental setup, where measurements from several tissues with mostly distinct lipids have been taken. the method is also directly applicable to gene expression and proteomics. availability: an r-implementation is available atdata from experiments with multiple covariates are usually analyzed with multi-way analysis of variance (anova)-type methods. a typical one-way analysis setup in experiments looking for potential biomarkers for disease is the diseasedhealthy differential analysis. biological experiments often contain additional covariates, such as drug treatment groups, gender or time-series, resulting in a multi-way experimental setup. the traditional methods for multi-way analysis are univariate multi-way anova, and its multivariate generalization manova. in the two-way case, to explain the covariate-related variation of the to whom correspondence should be addressed. data in one data source, say x, the following linear model is usually assumed:here the a and b (a = 0,...,a and b = 0,...,b) are the two independent covariates, and the main effects x a and x b and the interaction effect x ab model the variation from the baseline level (grand mean) x. the is a noise term. a recurring problem in omics measurements, in particular in gene expression and metabolomics, is the small number of samples versus high dimensionality; the traditional multivariate methods break down due to the singularity of the covariance matrix. a further disadvantage of manova is that it gives only a p-value describing the statistical significance of the effects, and the location (which variables) and direction (up/down) of the effects have to be deduced afterwards separately by other methods, such as t-tests. the latter holds for anova as well. dealing with the small sample size problem is currently an active research topic, and has already led to working solutions. multi-way, multivariate anova-type analysis can be done in the small sample size cases with simple two-step approaches relying on a prior principal component analysis (pca) dimension reduction . another approach is forming sparse latent factors , where some of the variables but not all are associated with each factor. in this approach, covariate information is used for factor regression and the model has been extended with univariate anova models with a joint sparsity prior . we have recently introduced a unified bayesian machine learning model especially designed for metabolomic experiments with a two-way setup and small sample size. this approach assumes similarly behaving correlated groups of variables, a valid assumption for metabolites, and models the multi-way covariate-related variation for the groups. the model is an extension of a factor analyzer and models the statistical significance of multivariate covariate effects on the low-dimensional factor space, representing the discovered clusters of variables. however, the multi-way data analysis problem becomes complicated when heterogeneous data with multiple covariates are integrated from multiple sources. different data sources usually have distinct, unmatched variable spaces with different dimensionalities; this becomes evident when considering integration of transcriptomics and metabolomics data, or metabolic profiles from different tissues which usually have different metabolites. if the variable spaces were the same, one might want to consider the source as an additional covariate in a standard anova-type analysis. however, this is usually impossible since variable spacespage: i392 i391i398we first demonstrate the functioning of the method on simulated data, focusing on how the generated effects are found when the sample size is small. we then apply the method to a lung cancer study where lipidomic profiles have been measured from several tissues of model mouse samples, under a two-way experimental setup (disease and treatment). different tissues have distinct lipids. finally, the method is compared with a standard (one-source) manova-approach including dimension reduction with pca.we have generalized anova-type multi-way analysis to cases where measurements from multiple sources are available for samples having a multi-way experimental setup. furthermore, the method is able to decompose the covariate effects to shared and sourcespecific effects, unlike any existing methods. the problem is solved by a hierarchical latent variable model that extends the generative model of bayesian cca to model multi-way covariate information of samples, by assigning population-specific priors on the shared latent variable of cca. the method is designed for cases with high dimensionality and small sample size, common in bioinformatics applications.  
