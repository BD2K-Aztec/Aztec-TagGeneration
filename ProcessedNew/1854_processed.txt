bioimage informatics flowfit: a bioconductor package to estimate proliferation in cell-tracking dye studies herein we introduce flowfit, a bioconductor package designed to perform quantitative analysis of cell proliferation in tracking dye-based experiments. the software, distributed as an r bioconductor library, is based on a mathematical model that takes into account the height of each peak, the size and position of the parental population (labeled but not proliferating) and the estimated distance between the brightness of a cell and the brightness of its daughter (in which the dye is assumed to undergo a 2-fold dilution). although the algorithm does not make any inference on cell types, rates of cell divisions or rates of cell death, it deconvolutes the actual collected data into a set of peaks, whereby each peak corresponds to a subpopulation of cells that have divided n times. we validated flowfit by retrospective analysis of published proliferation-tracking experiments and demonstrated that the algorithm predicts the same percentage of cells/generation either in samples with discernible peaks (in which the peaks are visible in the collected raw data) or in samples with non-discernible peaks (in which the peaks are fused together). to the best of our knowledge, flowfit represents the first open-source algorithm in its category and might be applied to numerous areas of cell biology in which quantitative deconvolution of tracking dye-based experiments is desired, including stem cell research. availability and implementation:in cell proliferation-tracking experiments, cells are stained before being cultured under various conditionswith a fluorescent dye to follow proliferation kinetics. at each mitosis, the dye is roughly equally divided between daughter cells, so that each daughter is about half as fluorescent as the mother. at any given moment, therefore, the fluorescence intensity of a cell bears witness to its divisional history when compared with the intensity of the parental population.in a typical experimental pipeline, cells are first labeled with a tracking dye, then allowed to proliferate (frequently in the presence of specific stimuli) and finally analyzed by flow cytometry by collecting data for (i) unlabeled cells (used as a negative control), (ii) unstimulated labeled cells (the non-proliferating population) and (iii) sample(s) of labeled and stimulated cells (the proliferating populations). if the characteristics of the logarithmic amplifier on the flow cytometer are known, it is possible to derive, from a histogram of fluorescence intensity, the proportion of cells that have undergone any particular number of divisions (. generally, a flow cytometer with 1024 channels (channels range) represents a nominal range of 4 log decades. several fluorochromes have been used to track cell proliferation , including dna-binding fluorescent dyes (hoechst 33342, thiazole orange), cytoplasmically distributed fluorescent dyes (calcein, 2 0 ,7 0-bis-(2-carboxyethyl)5(6)-carboxyfluorescein), covalent coupling fluorescent dyes (carboxyfluorescein succinimidyl ester, fluorescein isothiocyanate) and membrane-inserting fluorescent dyes (pkh26, cellvue lavander). although each dye displays advantages and disadvantages for individual experimental purposes [reviewed in (, a common problem is represented by the quantification of the fluorescence signal: under optimal conditions some dyes [e.g. carboxyfluorescein diacetate succinimidyl ester (cfse)] form separate peaks defining different proliferative generations, whereas others (e.g. pkh26) do not . a good proliferation-tracking algorithm should be able to give similar results in both cases. here we introduce flowfit, an r (r development core team, 2012) bioconductor library that fits a set of peaks (corresponding to different generations of cells) to the histogram of fluorescence intensity acquired during a fluorescence-activated cell sorting (facs) experiment. the package is integrated with the bioconductor libraries used for the analysis of flow cytometry datasets: flowcore and flowviz . the performance of flowfit was evaluated by the retrospective analysis of a published dataset of dye-tracking experiments , in which lymphocytes were stained with three different proliferationtracking dyes: cfse, cell proliferation dye efluor 670 (cpd) and celltrace violet (ctv). in particular, we meta-analyzed a subpopulation of cd4 lymphocytes labeled with the three different staining reagents. the three samples were allowed to proliferate under identical growth conditions; however, differences in the characteristics of the dyes yielded rather different to whom correspondence should be addressed. fluorescence histograms with different peak definitions . flowfit was able to deconvolute equally well in all situations and to estimate the same percentage of cells per generation under all conditions.the proliferation-fitting algorithm was tested by retrospective analysis of a published dataset consisting of three samples of mouse lymphocytes stained with cfse, ctv and cpd . we focused on the raw data used to generateof the original paper. this subset of raw data contains four samples:(1) cd4 non-stimulated lymphocytes labeled with cfse, cpd and ctv (parental population)(2) cd4 lymphocytes labeled with cfse and stimulated(3) cd4 lymphocytes labeled with cpd and stimulated(4) cd4 lymphocytes labeled with ctv and stimulatedthe datasets, already gated for cd4 lymphocytes, were log10 transformed after truncation at 1. then, we performed three parentfitting on the parental sample to establish the position and size of the parental population for the three dyes . using the parental peak position and size as a best guess, we performed a proliferationfitting with the dynamic model on the cfse and ctv samples. in the cpd sample, the stimulated population did not display well-separated peaks, at variance with the ctv and cfse samples. thus, for the cpd sample, we used a fixed model (proliferationfitting with fixedmodel true), keeping the parental peak position fixed . finally, we compared the percentage of cells per generation in the three samples and evaluated the concordance among the fittings. using the chi-squared test, we did not observe any significant difference in the distribution of cells per generation among the three estimates (p 1), arguing that the algorithm is correctly estimating the percentage of cells per generation in the three samples (supplementary). altogether, the proliferationfitting analysis performed on the datasets published by quah and parish, which yielded similar results compared with those of the original study, argues for the suitability of flowfit to the analysis of cell proliferation in tracking dye experiments with either poorly or well-discernible peaks, based on the dual possibility to fit them, respectively, with the dynamic model or with the fixed model. we also performed an in silico analysis to benchmark the performance of the algorithm with random samples (and supplementary materials section 3, including supplementary figs. s7s21) for the dynamic and fixed models. in general, the dynamic model performed well with samples where the parental peak size (that corresponds to the variance in the initial staining) is small and the proliferating population forms wellseparated peaks. the fixed model, on the other hand, performs well also with samples with a poorly defined cell division peaks (cf: supplementary figs. s8 and s14).the objective of this work was to provide an open-source algorithm to quantify the proliferation of cells in tracking dye experiments. of note, although the proliferation-fitting algorithms currently available for this type of analyses (modfit lt tm , fcs express and flowjo) are commercial software, flowfit is already publicly available and published with the artistic 2.0 license in the bioconductor r framework. we provided statistical demonstration of the quality of the fitting with both in silico analysis and real dataset analysis. in particular, we demonstrated the intrinsic versatility of flowfit in providing reliable results in the analysis of samples with both discernible and non-discernible peaks. at variance with modfit lt tm , which uses a statistical analysis of the fluorescence histogram to identify potential peaks and a gaussian model for the single peak, flowfit uses a levenbergmarquadt algorithm to minimize the difference between the observed data and the model, and uses a non-gaussian formula (1) to define a peak. in addition, flowfit is fully integrated in the bioconductor r framework. in recent years, several approaches, based on dye tracking, have been developed to identify and isolate adult stem cells (scs) from normal and tumor tissues (e.g.). these methodologies rely on the fact thatin the normal adult sc compartmentscs divide asymmetrically to generate two daughter cells with opposite proliferative and differentiative fates: one of the two daughter cells retains the sc fate and withdraws into quiescence, whereas the other becomes a progenitor and enters a tumultuous phase of repeated symmetric divisions, required to expand the progenitor compartment, followed by terminal lineage differentiation. one characteristic of the sc compartment in cancer is that the cancer scs tend to skip rounds of asymmetric division, in favor of symmetric divisions, after which both daughters divide again . this leads to an expansion of the sc compartment. the rate of skipping seems to be higher in poorly differentiated more aggressive tumors . methodologies to follow the kinetics of sc division in vitro and to compare the rate of symmetric versus asymmetric divisions are needed if we want to understand the biological bases of homeostasis of normal sc compartments and of how expansion of the sc compartment drives cancer growth and aggressiveness. we envision this as one of the major areas of application for flowfit. to this aim, the integration of flowfit with a stochastic model of cell proliferation based on a gillespie algorithm will likely be required to analyze in real tumor tissues the proliferation kinetics of cancer scs compared with that of their tumor progeny, and to compare proliferation data from these populations with relevant theoretical models of proliferation (for instance, models of asymmetric versus symmetric mode of division in the cancer sc versus the transient-amplifying compartment of progenitors). this approach will probably be instrumental to identifying parameters in the stochastic model able to yield the best overlap between real data and simulations.note: summary of in silico analysis: random samples with different levels of division peak quality (supplementary section 2.1). the maximum peak width that gives reliable results (column: varying peak size, 017) correspond to a parent population with 75 of the events distributed across 25.7 channels (in a facs with 1024 channels and 4 log decades), a peak size of 0.4 corresponds to a parent population peak with 75 of the events distributed across 61.7 channels (in a facs with 1024 channels and 4 log decades); random samples with different distribution of cells per generation (supplementary section 2.2): the percentage of samples that gives reliable results is depicted (column: random samples).  
