genome analysis contra: copy number analysis for targeted resequencing motivation: in light of the increasing adoption of targeted resequencing (tr) as a cost-effective strategy to identify disease-causing variants, a robust method for copy number variation (cnv) analysis is needed to maximize the value of this promising technology. results: we present a method for cnv detection for tr data, including whole-exome capture data. our method calls copy number gains and losses for each target region based on normalized depth of coverage. our key strategies include the use of base-level log-ratios to remove gc-content bias, correction for an imbalanced library size effect on log-ratios, and the estimation of log-ratio variations via binning and interpolation. our methods are made available via contra (copy number targeted resequencing analysis), a software package that takes standard alignment formats (bam/sam) and outputs in variant call format (vcf4.0), for easy integration with other next-generation sequencing analysis packages. we assessed our methods using samples from seven different target enrichment assays, and evaluated our results using simulated data and real germline data with known cnv genotypes. availability and implementation: source code and sample data are freely available under gnu license (gplv3) at http://contra-cnv.sourceforge.net/targeted resequencing (tr), including whole-exome sequencing, is becoming widely adopted as a cost-effective way to interrogate specific genomic regions across a large number of samples, a technique particularly useful for the study of genetic causes of cancer and other diseases. a number of studies have demonstrated success in the application of tr to the identification of diseasecausing variants, including variants associated with a rare mendelian disorder. freemansheldon syndrome , inherited mutations for breast and ovarian cancer and to whom correspondence should be addressed. a single non-sense mutation that causes a syndromic form of cleft palate . the primary objective of tr, as in above studies, is the detection of single-nucleotide variants (snvs) and short (50 bp) insertions and deletions (indels) within the targeted regions. inherent limitations on sequence alignment of short reads prohibit the detection of larger indels and, therefore, many potential disease-causing copy number variations (cnvs) are not accessible from tr data. while whole-genome sequencing and single-nucleotide polymorphism (snp) genotyping microarrays are more appropriate tools for genome-wide cnv interrogations, it is imperative that robust cnv analysis methods be developed for tr data, in order to maximize the utility of the rapidly increasing amount of tr data that are being generated globally. cnv detection methods have been developed for whole-genome sequencing and incorporate three main aspects: the estimation of copy number breakpoint locations by segmentation using depth of coverage (doc) , the incorporation of paired-end or mate pair information to enhance detection accuracies (a.submitted for publication;) and the reduction of representation biases due to gc-content and other physio-chemical characteristics . segmentation and bias reduction have been applied to tr data on large target regions (40 kb) . however, the size of a target region in most tr projects is typically small, ranging from 100 to 200 bp as in exon or wholeexome capture. in addition, genomic distribution of target regions is often sparse and uneven due to the size of intronic segments and the arbitrary locations of the genes of interest. the small size, sparseness and non-contiguous nature of target regions pose challenges to the application of existing cnv methods on tr data. even if the doc is high in the target regions, data resolution would be too low to make reasonable segmentation and bias reduction on a whole-genome scale. it has also been reported that the underlying assumptions made for cnv estimation in whole-genome sequencing fail to hold in the exome sequencing setting . more specifically, the assumptions that genome-wide read depth is normally distributed, and that segmentation search space is continuous, fail to apply for exon capture data. to date, a limited number of methods have been published for the cnv analysis of tr data. exome cnv was designed specifically for whole-exome capture.the technical variation of coverage across five human and one mouse exome capture platforms were compared. the one platform that exhibits a distinct coverage distribution is the older, arraybased capture platform (seqcap array), with a slope larger than all other platforms in the (log) mean-variance plot . its association with larger doc variations is also apparent from the chromosome-wide log-ratio plots , making it unsuitable for cnv and other doc-based analyses. other solution-based capture platforms are comparable, with ez exome v2 being the most stable in our sample cohort. our comparison of log-ratio plots between single-end and paired-end seqcap array data shows no remarkable differences. however, we have no access to further single-end data to make similar comparisons for other platforms. given the reduction in sequencing cost, it is expected that sequencing data will be predominantly paired-end. the use of a matched control versus that of a control set was also compared in terms of log-ratio variation . as expected, using multiple samples to create a baseline coverage helps to reduce doc variations, and in turn log-ratio variations, improving cnv detection sensitivity. as shown in, increasing the number of samples in the control set would reduce the sd of log-ratios at any given coverage, until a minimum level of sd is reached. therefore, even when a matched control is available, a secondary analysis using multiple unmatched normal samples as the control can be performed (in additional to a paired analysis) to improve the detection of true positives. the main difference between contra and exome cnv is their approach to calling a region significant. exome cnv models the log-ratios using a gearyhinkley transformation , based on an approximation that doc has a normal distribution of equal mean and variance. this model makes the assumption that doc follows a poisson distribution, which converges to normal with sufficient doc. there are two limitations of this approach: (i) low doc regions are not properly addressed and (ii) a poisson model fails to capture the increasing variance at high doc, a characteristic that is evident from the mean-variance plot of our data and that has been discussed in the context of rna-seq and a negative binomial model . contra, on the other hand, was developed based on empirical relationships between log-ratios and doc that have been observed to be consistent across multiple target enrichment platforms. it relies on the case sample being largely copy number neutral, through which a null distribution of log-ratios is estimated and outlying events (cnvs) detected. this assumption has been demonstrated to hold sufficiently well for normal individuals in our evaluation using hapmap data. for non-diploid samples, the limitation of contra is a reduced sensitivity in cnv detection when a large proportion of the target regions are associated with a copy number change, such as in a small custom capture of tumor material (supplementary materials). however, this limitation is eased in the case of wholeexome capture, where a large proportion of copy number neutral regions can be achieved. furthermore, this limitation does not apply to family and population studies, where cnv events are expected to be rare.the inherent limitation of tr data, regardless of analysis methods, lies in the high variation of doc. such a high variation makes the detection of a single copy number gain a very difficult task, as apparent from, where the cloud of null data spreads across the log-ratio = 0.58 line (1.5 fold-change). the detection of hemizygous deletions would perform better as it corresponds to a 2 fold-change (log-ratio =1), but would be challenging for regions with coverage less than 30x. in addition to cnv calls at the region (exon) level, contra offers a function to predict large cnvs spanning multiple regions. however, care must be given to the interpretation of these large predictions. a large cnv segment often consists of a percentage of regions that have inconclusive cnv status (high p-values). they may correspond to either copy number neutral regions or low coverage regions. the strategy employed by contra is to set a threshold on this percentage, above which no cnv call is made. on the other hand, the strategy used by exome cnv is to add up doc across the regions and then assess the overall log-ratio , heavily biasing toward those regions with high coverage. neither of these methods adequately addresses the sparseness and non-contiguous nature of target regions, an inherent limitation of tr data that restricts practical prediction to be made at the region level. for this reason, while tr (or exome sequencing) is appropriate for predicting novel single-exon cnvs and screening for known cnvs, other technologies such as genotyping microarrays must be used for the accurate predictions of larger cnvs. for the upstream processing of sequence data, contra imposes no requirements on the methods used, but it is recommended that multi-mapped reads and pcr duplicates be removed to reduce signal noise in doc. downstream analysis after cnv detection includes the removal of known cnps from candidate cnv regions using public resources, such as the copy number variation project (http://www.sanger.ac.uk/humgen/cnv). this is particularly useful when a pooled control strategy is used.targeted resequencing data across seven capture platforms have been assessed in terms of coverage and log-ratio variations. we have developed a method for the detection of cnv based on empirical relationships between log-ratio and coverage. contra outperforms an existing algorithm based on a simulated dataset, and is particularly suitable for population and family studies. our methods are available as a software package, contra, via http://contra-cnv.sourceforge.net  
