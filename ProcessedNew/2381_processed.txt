structural bioinformatics improvement of 3d protein models using multiple templates guided by single-template model quality assessment motivation: modelling the 3d structures of proteins can often be enhanced if more than one fold template is used during the modelling process. however, in many cases, this may also result in poorer model quality for a given target or alignment method. there is a need for modelling protocols that can both consistently and significantly improve 3d models and provide an indication of when models might not benefit from the use of multiple target-template alignments. here, we investigate the use of both global and local model quality prediction scores produced by modfoldclust2, to improve the selection of target-template alignments for the construction of multiple-template models. additionally, we evaluate clustering the resulting population of multi-and single-template models for the improvement of our intfold-ts tertiary structure prediction method. results: we find that using accurate local model quality scores to guide alignment selection is the most consistent way to significantly improve models for each of the sequence to structure alignment methods tested. in addition, using accurate global model quality for re-ranking alignments, prior to selection, further improves the majority of multi-template modelling methods tested. furthermore, subsequent clustering of the resulting population of multiple-template models significantly improves the quality of selected models compared with the previous version of our tertiary structure prediction method, intfold-ts. availability and implementation: source code and binaries can be freely downloaded from http://www.reading.ac.uk/bioinf/ downloads/.sequence-structure alignment methods are the springboard of template-based modelling (tbm). the 3d model output of singletemplate modeling methods is based on the top-ranked best available single template from the most similar protein of known structure . single-template models built for sequences with high-sequence identity (5060), between target to whom correspondence should be addressed. and template, are known to provide highly accurate models; 30 sequence identity (the twilight zone), models must be built using more intensive fold recognition methods . consensus-based fold recognition approaches such as lomets , 3d-jury , 3dshotgun , pcons and intfold-ts improve the selection of single-templates by the use of alternative models from several independent servers or in-house version of those methods run as metaservers. the top-ranked consensus models, however, may not always be the best option due to suboptimal alignments. it is important to consider optimal alignments both at the global (overall protein sequence) and local (regions such as domains) levels. in addition, the coverage of the targettemplate alignment must be considered when evaluating or selecting 3d models to guide experimental work. after all, the nearer-native a protein model is, the better information it can provide towards protein design for use in medicine, agriculture, biofuels and other fields of applications. multiple-template modelling methods that mix and match , recombine templates or thread alternative target-template alignments (,b) have been produced in an effort to improve the quality of predicted 3d models. the advantage of using multiple-template methods is mainly attributed either to the increased alignment coverage or the incorporation of the best single template, which is dependent on alignment accuracy and template complementarity (,b). additionally, convergence is one problem identified in the use of multiple templates, which may arise from different alignments containing contradictory information. the quality of a model can be improved by combining complementary good templates, which is especially true for multi-domain targets; but model quality may deteriorate when there is one template that is closer to the target than all other available templates. in general, multiple-template modelling can improve on single-template models when it can provide an increase in coverage of the target, can give more useful information such as sequence and structure conservation and/or conserved distance restraints or can identify better alternative alignments for harder targets (quality prediction as the remaining limiting factors . the top-performing groups have attempted to address these limiting factors in numerous ways . various single-template and consensus methods incorporate model quality assessment (mqa) methods to rank alternative models . pconsm , for example, uses proq for model quality assessment of the top six models drawn from the top six template sequences of pcons.net . on the other hand, raptorx (peng and xu, 2011b) uses tm-score (; zhang and skolnick, 2004) as a quality measure of the sequence-template alignment, from which the quality of its 3d model can be estimated. additionally, multicom combines multiple templates, alternative alignments and similar models guided by global model quality assessment. furthermore, with i-tasser (known as zhang-server in casp) , the multi-template 3d models include global confidence scores, which are a measure of their overall prediction accuracy. our own intfold-ts method integrates modfoldclust2 into the core of its pipeline. this mqa tool reranks all alternative models, generated by four in-house versions of single-template methods, based on their global quality scores. the accuracy of this method addressed the strong emphasis of casp9 on assessment of all-atom models producing predicted per-residue errors . however, while we were relatively successful at providing accurate local error estimates for our casp9 models, we did not make any attempt at fixing the predicted errors prior to submission. in an attempt to exploit our accurate per-residue quality predictions, we have now explored the multipletemplate modelling approach described here. our approach is to use the modfoldclust2 local and global quality assessment scores, from the initial single template models, to inform target-template alignment selection, with the aim of consistently and significantly improving models through multiple-template modeling. the latest implementation of our template-based modelling server, intfold2ts, uses a further iteration of modfoldclust2 to rank the resulting pool of multiple-template models. our new intfold2-ts method shows a statistically significant improvement over the singletemplate methods and consensus single-template methods tested.three structural alignment scoring methodsthe gdt_ts (global distance test total score), the tm-score (template modelling score) and the maxsub scoreprovide the performance metrics for the benchmarking. these scores, generated by the tm-score method, show how similar two protein structures are to each other, in this case, the model and the experimentally determined native structure. for clarity and brevity, the results shown in this article are the benchmarking results against the casp9 full chain dataset. however, the full analyses for both the casp8 and casp9 full chain and domain datasets (with and without fm domains) are shown in the supplementary data. furthermore, in the supplementary data, an analysis of the upper limits for multi-template modelling based on perfect model selection is shown. in this case, the tm-score between the model and native structure is used to determine the global quality for each model. the perfect local quality scores are calculated as the distances between equivalent ca atoms based on the tm-score superposition between the model and native structures. although all structural alignment scores were used for benchmarking, the main tables and figures shown here were based on the gdt_ts score, which has been used as an official casp measure since casp4. the 9-fold-recognition methods that represent single-template modelling methods are as follows: sp3, sparks2 (spk2), hhsearch, coma, qqq, gggd, gggf, nnnd and sssc. the consensus methods that cluster-specific single-template methods and generate single-template models are represented here by lomets, intfold-ts40 and intfold-ts90. the multi-template methods applied to sets of alignments from individual methods are denoted by the subscript _multi (e.g. sp3_multi3 is the multi-template modelling method 3 applied to the sp3 alignments).in this article, we evaluate alternative methods for the selection of target-template alignments for multiple-template modelling, using the alignments generated by a number of alternative single-template modelling methods. we explore the use of modfoldclust2 local and global model quality assessment scores as a discriminatory measure to refine the selection of better target-template alignmentsh o : the method in the row produces models that are equal or lower in quality than those produced by the method in the column. h 1 : the method in the row produces higher quality models than the method in the column. p-values 0.05 indicate significant differences (in boldface). the wilcoxon signed-rank sum test p-values were calculated using gdt_ts scores of 117 casp9 full chain targets.prior to multi-template modelling. although there is a basic nuance that using multiple templates will translate into a better model, this is shown not to be true in all cases and success is dependent on the target-template selection method used. comprehensive analyses of our multiple-template models showed that there are appropriate combinations of templates that will lead to improvement of a model quality over that of the single-template model. when that combination is not found, then multiple-template modelling will not provide a better option over single-template modelling and may sometimes lead to a deterioration of model quality. the aim of multiple-template modelling should not be to simply mix and match segments of templates to achieve more coverage; it should, most importantly, be to improve model quality. from benchmarking the alternative alignment selection approaches on the casp8 and casp9 full chain and domain datasets, we have found that the most consistent way to significantly improve models is to make use of accurate predicted local model quality scores to guide alignment selection. furthermore, using accurate global quality prediction scores, for re-ranking the order of alignments prior to selection, significantly improves most of the multi-template modelling methods tested. this corroborates the findings of. the upper theoretical limits of these strategies are investigated through use of perfect model quality assessment scores (supplementary tables and figures). the results indicate that there is room for improvement and it is therefore worthwhile putting further effort into developing more accurate model assessment to guide multi-template modeling. overall, sp3 proved to be a competitive single-template method when tested on the casp9 datasets and it provides a useful baseline single template modelling method. the increased performance of both intfold-ts40 and intfold-ts90 relative to sp3 points again to the usefulness of generating consensus single-template models using modfoldclust2. however, these simple consensus methods only make use of the modfoldclust2 global scores and do not exploit the accurate per-residue error predictions. according to the casp9 assessors accurate per-residue error predictions are crucial indicators of a models usefulness. here, we are now capitalizing on the accuracy of modfoldclust2 for predicting model quality at both the global and per-residue level, using identified errors in single template models to guide alignment selection for multi-template modelling. the multi3 and multi7 methods were observed to be the best performing methods and they consistently and significantly improved model quality for all of the original sequence-structure alignment methods, on all datasets and according to all model quality scoring metrics. the multi3 works by simply rejecting any subsequent target-template alignment after the top hit, if the overlapping local regions from the alignment are not predicted to improve the local model quality according to modfoldclust2. the multi7 method uses essentially the same approach but the targettemplate alignments for each method are firstly re-ordered using the modfoldclust2 global scores.  
