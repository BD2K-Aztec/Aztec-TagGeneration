sequence analysis ptpanâ€”overcoming memory limitations in oligonucleotide string matching for primer/probe design motivation: nucleic acid diagnostics has high demands for non-heuristic exact and approximate oligonucleotide string matching concerning in silico primer/probe design in huge nucleic acid sequence collections. unfortunately, public sequence repositories grow much faster than computer hardware performance and main memory capacity do. this growth imposes severe problems on existing oligonucleotide primer/probe design applications necessitating new approaches based on space-efficient indexing structures. results: we developed ptpan (spoken peter pan,pt is for position tree, the earlier name of suffix trees), a space-efficient indexing structure for approximate oligonucleotide string matching in nucleic acid sequence data. based on suffix trees, it combines partitioning, truncation and a new suffix tree stream compression to deal with large amounts of aligned and unaligned data. ptpan operates efficiently in main memory and on secondary storage, balancing between memory consumption and runtime during construction and application. based on ptpan, applications supporting similarity search and primer/probe design have been implemented, namely findfamily, probematch and probedesign. all three use a weighted levenshtein distance metric for approximative queries to find and rate matches with indels as well as substitutions. we integrated ptpan in the worldwide used software package arb to demonstrate usability and performance. comparing ptpan and the original arb index for the very large ssu-rrna database silva, we recognized a shorter construction time, extended functionality and dramatically reduced memory requirements at the price of expanded, but very reasonable query times. ptpan enables indexing of huge nucleic acid sequence collections at reasonable application response times. not being limited by main memory, ptpan constitutes a major advancement regarding rapid oligonucleotide string matching in primer/probe design now and in the future facing the enormous growth of molecular sequence data. availability: supplementary material, ptpan stand-alone library and arb-ptpan binary on http://ptpan.lrr.in.tum.de/.fast methods for non-heuristic exact and approximate oligonucleotide string matching are of central importance for in silico primer/probe design and evaluation. many applications in the field of nucleic acid diagnostics are based on the usage of indexing structures to speed up computations . a prominent example is the pt-server, the central search index of the software package arb, which is used worldwide for phylogenetic microbial sequence analyses of molecular markers such as ribosomal rna . based on suffix trees, the pt-server is suitable for highly efficient approximate oligonucleotide string matching supporting the design and in silico evaluation of phylogenetic primers and probes widely applied in microbiology . furthermore, it is the basic component of the probecheck server and the recently published comprehensive signature search tool cassis . the pt-server has to fit into main memory during construction and application. this imposes limitations on the rapidly growing databases. current collections of small subunit ribosomal rna (ssu-rrna) such as greengenes or silva are already becoming unsuitable for common desktop computers. the growth of silva (see statistics at http://www.arb-silva.de/documentation/background/ release-104/) reveals the fatality of the memory dependence in near future. in addition, the pt-server relies on hamming distance metric for approximate string matching concerning primer/probe design and evaluation. the resulting inability to identify insertions or deletions (indels) prohibits the detection of possible sequencing errors or mutations which can lead to a misjudgment of the sensitivity of primers or probes with severe implications to experimental results . finally, the pt-server can only be constructed from an arb database limiting its field of application strictly to the arb environment. consequently, a new memory efficient and sustainable approach is required, coping with the increasing sequence data flood. extended levenshtein (edit) distance metric search includes significant matches with indels and thus improves the future in silico prediction of sensitivity and specificity of an oligo primer/probe sequence. for the same reason, the new approach should support indexing of ambiguous sequence characters and treating matches at ambiguous positions in an efficient way. it seems reasonable to treat all ambiguities as wildcard in string matching (n-character).page: 2798 27972805ptpan combines several techniques to construct a persistent and space-efficient suffix tree. the core structure is a partitioned, truncated and stream-compressed suffix tree. utilizing the suffix tree, approximate string matching algorithms as well as primer/probe design functionality have been implemented. the three main steps of the ptpan construction algorithm are as follows:(1) data retrieval and preparation (section 3.1).(2) partition determination and index header storage (section 3.2).we presented ptpan, a persistent and space-efficient suffix index for oligonucleotide string matching which deals with limited main memory. it incorporates enhanced non-heuristic exact and approximate search capabilities to find exact as well as approximate matches containing substitutions and indels, due to a user-defined search string distance. it has been developed and optimized to support similarity searches and primer/probe design in huge nucleic acid sequence collections, highly demanded in molecular microbial diagnostics. ptpan is integrated into the arb software package and available as stand-alone library. we have reviewed memory-efficient indexing structures according to their viability for non-heuristic approximate oligonucleotide string matching with respect to our main focus, primer/probe design in large nucleic acid sequence databases (section 1). in doing so, we have evaluated bwa for suitability page: 2804 27972805for our approach in practice. bwa is a successful non-heuristic short read mapper based on a space-saving index structure with fast construction times . although short read mapping is a problem related to oligonucleotide string matching for primer/probe evaluation, it differs in the actual goal. bwa aims at the best hit for a short read. in contrast, primer/probe design for microbial diagnostics targets at finding all matches with distance smaller or equal to a required value to the query string. every match is important to detect in silico sensitivity and specificity of a primer/probe as good as possible, in particular to identify potentially cross-reacting non-target sequences (and respective organisms) in the analyzed data collection. bwa performed approximate string matching faster than ptpan for default settings, though missing significant matches. to get thorough enough results for careful primer/probe evaluation, bwa parameter settings had to be adopted resulting in a performance worse than ptpan. furthermore, essential information for advanced evaluation of primer/probe candidates is not provided (see section 4.4). extending bwa by required functions would lead to a further incalculable slowdown, as we concluded. we focused our further efforts on suffix trees on secondary storage. the remaining challenges of high space requirements and inability to efficiently carry out approximate string matching were targeted. we employ partitioning and truncation combined with a new suffix-tree stream compression to reduce space requirements and optimizing the index structure for topdown traversal required by approximate oligonucleotide string matching. though the achieved memory efficiency has an implication for the current implementation of probedesign, the length of probes is limited to the depth of the suffix tree, 27 at maximum. nevertheless, this is sufficient for many applications such as pcr or fluorescence in situ hybridization (fish) . designing longer probes is possible using a sideway if no other options exist. probematch results, e.g. of a 27mer probe target candidate, provide context information of each match. with this a target candidate sequence can be elongated according to the matching base characters within the context. since probematch is not limited to 27mers, this procedure can be repeated iteratively in order to design longer oligonucleotide probes. alternatively, concatenation of overlapping 27mer probe target sequence candidates could be applied. an index providing comparable functionality targeting the same field of application, namely primer/probe design based on oligonucleotide approximate string matching, is the widely used pt-server integrated into the arb software package . a detailed comparison between pt-server and ptpan revealed similarities as well as important differences. as public nucleic acid sequences may contain ambiguous base characters, proper handling is required. both indexes treat all ambiguities as n-character during build and wild-card during search. the great advantage of this is the identification of matches containing ambiguous characters which helps to optimize in silico primer/probe evaluation. in addition, both indexes support basic-and weighted-match mode (section 3.4.2). this is extremely advantageous during search and evaluation of diagnostic oligonucleotide primer/probe candidate sequences. in particular, a weighted mismatch allows to measure a fine grain distance between a match and the search sequence string, taking type and position of substitutions into account. this enables rating of in silico specificity and sensitivity of a probe by evaluating its distance to target and non-target sequences. this is important when predicting the ability of an oligonucleotide probe to cross-react with a non-target oligonucleotide sequence stretch despite mismatches . both ptpan and the pt-server return a meaningful result list for each query, facilitating fast evaluation of query hits significantly. the list incorporates hit names, absolute and relative position in the original multiple alignment, number of mismatches, weighted mismatch scores and the sequence contexts in a multiple differential alignment. for list creation, the original sequence data are required to retrieve context information. to avoid memory intensive permanent accesses to the original database during applicationas with the pt-serverptpan incorporates all sequence and alignment information making it independent of the sequence data source. besides the similarities, there are some major advantages of ptpan compared with the pt-server. for approximate string matching, the pt-server utilizes the hamming distance metric for finding exact matches and those with substituted bases. however, it misses matches with indels. this could be a major drawback when trying to assess in silico coverage and specificity of diagnostic oligonucleotide primer/probes. mcilroy and colleagues have recently shown that oligo probes can form stable hybrids with non-target sequences despite indels, leading to false positives in fish . thus, the ability to include indels into the probe design and evaluation process is of great interest. ptpan, utilizing the levenshtein distance metric, also detects matches with real indels and those resulting from sequencing errors at the target position (sections 3.4.2 and 4.5). this is a major advancement for in silico primer/probe design. the pt-server relies entirely on source sequences in the arb database format for index construction. ptpan currently supports arb databases and multifasta files. moreover, it provides an interface easy to implement for other sequence data formats. ptpan is available as stand-alone library, too. hence, it is easily usable for oligo string matching beyond the arb software environment. finally, ptpans central advantage over the pt-server is its significantly lower main memory demand during index construction and application (section 4.3). the pt-server has comparable memory requirements on disk as it reduces space consumption by truncation, but significantly higher demands in main memory (section 4.3). this causes severe problems when trying to applyptpan is a space-efficient, persistent nucleic acid sequence data index. with suffix trees on secondary storage as core structure, it combines partitioning, truncation and a new stream-compression technique. it performs well for approximate oligonucleotide string matching, probe design and similarity search functions, all taking indels into account. even largest gene sequence databases can be searched efficiently on common desktop computers, now and in the future, due to ptpans superior sustainability. as future core component of the worldwide used software package arb, complementing or even replacing the arb pt-server, it will offer thousands of users advanced functionality with significantly reduced hardware requirements. currently, the only ptpan trade-off is the slower, though still, reasonable query time. to overcome this constraint facing the continuous data flood, the efficient usage of multicore architectures by parallelization could be a promising continuative approach.  
