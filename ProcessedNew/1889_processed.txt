from sets to graphs: towards a realistic enrichment analysis of transcriptomic systems motivation: current gene set enrichment approaches do not take interactions and associations between set members into account. mutual activation and inhibition causing positive and negative correlation among set members are thus neglected. as a consequence, inconsistent regulations and contextless expression changes are reported and, thus, the biological interpretation of the result is impeded.transcriptomic studies measure gene expression in different conditions. striking genes, which are differentially regulated between the conditions, are of primary interest and investigated for common features and membership in group of genes, which have the same function or belong to the same biochemical pathway. to whom correspondence should be addressed.a first impression of similar behavior of genes can be achieved via clustering of genes . the usually more effective overrepresentation analysis (ora) tests the overlap of a predefined group of genes and the set of differentially expressed genes assuming the hypergeometrical distribution under the null hypothesis . the method is widely accepted and has been subject to modifications of diverse visual and model related features (see, for an overview), though the basic statistical principle remained unchanged. however,criticize that the sampling procedure of ora is statistically invalid and leads to a hazardous interpretation of the resulting p-value. furthermore, the concentration on the usually small group of significantly differentially expressed genes, compared with the set of all the other, usually thousands of genes analysed in the study that are ignored, is not suitable for an investigation on a global scale. both points of criticism are resolved in gene set enrichment analysis (gsea) as it uses a valid sampling procedure and computes over the whole scope of genes . a kolmogorovsmirnov test statistic is applied to test whether the ranks of the p-values of the genes in the gene set can be a sample from a uniform distribution. several modifications of gsea have been published (see, for an overview). though ora and gsea are convenient in the analysis of genes that are independently expressed, a serious problem arises when these methods are applied to gene set definitions extracted from regulatory networks and metabolic pathways. the assumption of independence among set members does not hold anymore; genes are found to be correlated due to mechanisms of co-regulation and co-expression. initial steps to deal with that problem include implicit accounting for the correlation structure (e.g.) and integration of network topology of undirected interaction networks (e.g.). based on these first efforts,have proposed gene network enrichment analysis (gnea) that uses ora to test for overrepresentation of gene sets in transcriptionally affected subnetworks of a global interaction network. as the sign of gene expression changes and the direction of regulatory interactions are so far not taken into account, substantial features of the data are still ignored and the dynamics of the transcriptomic system are not realistically reflected. activation and inhibition are essential regulatory mechanisms in the transcriptional machinery of the cell and are causes for up-and down-regulation of particular genes. although processes like post-translational modification and combinatorial effects between regulatory proteinsin this work, we presented gene graph enrichment analysis (ggea), a novel algorithmic framework to detect increased agreement between positively and negatively correlated expression patterns of genes, connected by activating and inhibiting edges in signed and directed transcriptional networks. the method exploits directed regulatory relations represented as fuzzy logic rules to assess and identify graphs, which maximize the consistency between the regulatory network and the expression data. ggea is a major improvement to current gene set enrichment strategies, as we found experimentally validated regulatory interactions not to be consistent per se with the expression data in top ranked and statistically significant result sets of these methods. that was validated in a large-scale consistency study of 1000 e.coli chips using the e.coli regulondb, currently the best curated regulatory network, for the investigation of consistency. as set enrichment strategies ignore mutual regulation among set members, we observed that activations and inhibitions are only average consistent with the gene expression in these result sets. even strong causal signals, i.e. a regulator with differential expression of high statistical significance, in pairwise directed regulations were frequently not properly reflected. inhibitions were more seriously neglected than activations. this is partly due to a data bias, as there are more activations than inhibitions in the database. hence, more genes, and thus also more significant genes, are involved in activations just by chance. as gene set enrichment analysis mainly computes upon the leading edge of the ranked p-value vector of genewise differential expression (see), gene sets with a majority of activating genes are more likely to be reported. on the other hand, we found activitations clearly better conserved than inhibitions across all experiments stored in the m3d database. for ggea, we observed, under consideration of this bias, that activations were nearly optimally consistent and inhibitions were preserved in a large fraction of regulations. ggea achieved the highest concordance between the regulation direction and the expression behaviour of the incorporated regulator and regulated target gene. it should be emphasized that ggea consistently aligned weak (only moderately differentially expressed) signals, which are usually not taken into account by set enrichment methods. that improved sensitivity enables preference of weak, but coherent regulations over strong, but contextless signals. this is expected to better reflect the nature of key cellular regulators. as ggea exploits the consistency for the computation of its score, we additionally carried out a more independent benchmark to investigate how well statistically significant expression changes of single genes can be explained by other set members. as a measure of explainability, we used the number of additional genes, which were needed to connect significant members of a set to a regulatory network. we found this evaluation of particular interest, as it tries to approximate the process of the human interpretation. for all set enrichment methods, only a small amount of genes could be explained by other set members in a significant result and we observed frequently that several additional genes were needed. implied is that set enrichment indeed indicates that there is something striking happening in a certain result set; however, conclusions whether observed expression changes are coherent and in context with the surrounding regulators cannot be drawn. this is resolved by ggea. it systematically reports more easily explainable sets than all other methods, and the fraction of explainable sets with a single additional gene is increased by over 30 in comparison with the best set enrichment method. furthermore, we applied ggea in two pilot case studies of human neuronal tumours using regulatory interactions of signalling pathways, though incorporated proteinprotein regulations cannot be measured at the transcriptional level. nonetheless, we again hypothesize that genes, annotated to be associated in a pathway, should show higher correlation patterns than arbitrary genes, which are not. on the other hand, we argue that signal cascades normally target altered gene regulation. on the glioma dataset, ggea discovered throughout specific and disease-related pathways. induced by increasing specificity, the fraction of false positives decreases. unspecific and inconsistent pathways are replaced by more appropriate pathways. an example is the detection of the neurotrophin signalling pathway that modulates i372we showed in three independent and differently designed studies that ggea consistently aligns regulation and expression and yields result sets where statistically significant expression changes can be explained by regulators within the set. moreover, ggea eases the biological interpretation of reported gene sets, as they are more coherent than sets reported by set enrichment methods. this means many more of their relevant genes are connected or can be connected by a minimum number of additional factors. in summary, our new method ggea is an intuitive enrichment method, which uses gene regulatory information to improve consistency and coherence of detected enriched gene sets and, thus, substantially reduces the fraction of false positive and false negative classifications of relevant gene sets. ggea significantly improves the detection of gene sets where measured positively or negatively correlated expression patterns coincide with directed inducing or repressing relationships between the respective pairs of genes. hence, gene set regulators, such as transcription factors, can explain a significant portion of the observed expression changes. as ggea is as fast and easy to apply to experimental data as state-of-the-art set enrichment analysis methods, it provides an alternative for interpreting gene expression measurements and for deriving first insights into the relevant processes. the advantages of ggea will increase in the future with the availabilty of better grns and better models for regulatory relations in these grns.  
