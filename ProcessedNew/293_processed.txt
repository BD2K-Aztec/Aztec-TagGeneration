databases and ontologies an application of a relational database system for high-throughput prediction of elemental compositions from accurate mass values high-accuracy mass values detected by high-resolution mass spectrometry analysis enable prediction of elemental compositions , and thus are used for metabolite annotations in metabolomic studies. here, we report an application of a relational database to significantly improve the rate of elemental composition predictions. by searching a database of pre-calculated elemental compositions with fixed kinds and numbers of atoms, the approach eliminates redundant evaluations of the same formula that occur in repeated calculations with other tools. when our approach is compared with hr2, which is one of the fastest tools available, our database search times were at least 109 times shorter than those of hr2. when a solid-state drive (ssd) was applied, the search time was 488 times shorter at 5 ppm mass tolerance and 1833 times at 0.1 ppm. even if the search by hr2 was performed with 8 threads in a high-spec windows 7 pc, the database search times were at least 26 and 115 times shorter without and with the ssd. these improvements were enhanced in a low spec windows xp pc. we constructed a web service mfsearcher to query the database in a restful manner. availability and implementation: available for free at http://webs2. kazusa.or.jp/mfsearcher. the web service is implemented in java, mysql, apache and tomcat, with all major browsers supported.identification or annotation of metabolite peaks detected by mass spectrometers (mss) is one of the crucial steps in ms-based metabolomic studies . accurate mass values measured by high-resolution ms instruments, such as orbitrap ms and time-of-flight ms, are used in calculations of elemental compositions for the peaks and/or the product ions generated in multistage ms (ms n ) analyses , by which comprehensive identifications/annotations of metabolites have been reported . several software tools are available for calculation of elemental compositions: hr2 , automfcalculator , masstoformula function of the chemistry development kit and molecular weight calculator (http://www.alchemistmatt.com/). these tools generate all possible formulae under the condition of user-defined kinds and numbers of atoms (hereafter described as atom condition) and return elemental compositions that match the given mass value with the mass tolerance. an advantage of these tools is that users can change the atom conditions for each calculation. a disadvantage is that generations and evaluations of the same formulae cannot be avoided when similar mass values are repeatedly examined. this latent redundancy causes a limitation of the calculation rate when the tools are applied for the large number of mass data detected in metabolomic studies. to raise the throughput of metabolite annotations and then metabolomic data productions, acceleration of the calculation rate of elemental compositions is required. we report here a database approach that remarkably improves the prediction of elemental compositions. because the atom condition can be fixed for high-throughput surveys, all possible elemental compositions under the atom conditions are calculated and stored in a relational database system. the elemental compositions that match the given mass values with the mass tolerances are searched from the database. therefore, the latent redundancy occurring in other tools is eliminated.  
