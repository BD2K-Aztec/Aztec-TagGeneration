systems biology influx_s: increasing numerical stability and precision for metabolic flux analysis in isotope labelling experiments motivation: the problem of stationary metabolic flux analysis based on isotope labelling experiments first appeared in the early 1950s and was basically solved in early 2000s. several algorithms and software packages are available for this problem. however, the generic stochastic algorithms (simulated annealing or evolution algorithms) currently used in these software require a lot of time to achieve acceptable precision. for deterministic algorithms, a common drawback is the lack of convergence stability for ill-conditioned systems or when started from a random point. results: in this article, we present a new deterministic algorithm with significantly increased numerical stability and accuracy of flux estimation compared with commonly used algorithms. it requires relatively short cpu time (from several seconds to several minutes with a standard pc architecture) to estimate fluxes in the central carbon metabolism network of escherichia coli. availability: the software package influx_s implementing this algorithm is distributed under an opensource licence at http:// metasys.insa-toulouse.fr/software/influx/metabolic flux analysis (mfa) aims at quantifying the actual rates of biochemical reactions occurring in living cells. in recent decades, mfa has been increasingly used to identify novel metabolic pathways , for indepth understanding of metabolism . it is extensively used in biotechnology to improve the metabolic properties of industrially relevant organisms . more recently, mfa has been successfully integrated with other omics tools (transcriptomics, proteomics, metabolomics, etc.) to obtain novel biological insights through systems biology . the growing interest in mfa underlines the importance of developing reliable tools. the present contribution particularly addresses the need for accurate and stable algorithms for solving to whom correspondence should be addressed. the least-squares problem that underlies the calculation of fluxes in mfa. in a stationary metabolic system, the biochemical reactions which occur in a cell can be described by the following stoichiometric linear equation:where s is mn stoichiometric matrix, m rows and n columns correspond to the number of metabolites and reactions, respectively, v is the vector of all net fluxes. each component of the vector v expresses a net flux, i.e. the net quantity of material converted by a particular reaction per time unit. the whole equation system expresses the mass conservation law in the metabolic system. at metabolic (quasi-)steady-state, the intracellular concentrations of metabolites are kept constant. for most metabolic systems, the stoichiometry matrix s is underdetermined, i.e. the number of equations m is lower than the number of fluxes n. some fluxes can be measured experimentally. this is generally true of input and output fluxes, but is usually not enough to allow the calculations of all fluxes in the system. the remaining degrees of freedom, so-called free fluxes, need additional equations to be calculated. this can be achieved using different approaches. for example, flux balance analysis (fba) requires maximization of some linear cost function like biomass yield . in the approaches using isotope labelling experiments (ile) discussed in this article, additional relationships between fluxes come from the measurement of the labelling patterns (or isotopomer distributions) of selected metabolites. currently, these measurements can be made by mass spectrometry (mass isotopomers) or by nuclear magnetic resonance (nmr) (positional isotopomers). the mfa-ile approach was developed in the 1950s when 14 c radioactive isotopes were used to elucidate fragments of carbon metabolism in rat liver . since the 1980s1990s, a stable isotope 13 c has preferably been used instead of the radioactive 14 c. for many years, the equations describing the label distribution in a given metabolic network and their solution were derived by hand . in the early 1990s, general mathematical descriptions of the labelling problem were introduced . this generalization led to a need to solve algebraic systems of high dimensions (often ill-conditioned) to find the labelling state of a given metabolic network. this paved the way for the intensive use of applied mathematics in the mfa field.introduced a variable change based on the cumomer (cumulated isotopomer) concept. this approach allowed a large non-linear system to be decomposed into a cascade of smaller linear problems, one per cumomer weight and thus greatly simplified the computational needs for labelling state calculations. a general software exploiting the cumomer approach 13cflux was then published, which provides flux estimation based on all types of labelling data (mass and positional isotopomers) .proposed another variable change based on elementary metabolite unit (emu) concept. the emu framework is based on an efficient decomposition of an atom transition network, which identifies the minimum amount of information needed to simulate the experimental data without any loss of information. this led to a significant reduction in the dimension of the labelling problem. as a consequence, the computation of labelling variables now requires much less time and memory. a software based on emus, called openflux, is now available . a comparable gain in the computation of cumomers was announced by. these authors showed that often a highly dimensional linear system describing cumomers of a given weight can be decomposed into series of smaller linear subsystems corresponding to so-called strongly connected components (sccs). to the best of our knowledge, there is currently no publicly available software exploiting this approach. for a more complete review of recent progress in mfa-ile, including both experimental and mathematical improvements, see. the emu and scc concepts led to computational gains by improving the mathematical formulation of the labelling data problem involved in residue calculation. another potential source of improvement is the optimization process, i.e. the iterative process by which the simulated labelling data are fitted to the experimental data. the two stepsi.e. residue calculation and optimizationof the flux calculation process are independent, and can be improved separately. it is likely that future software will combine the most efficient solutions for each calculation step. here, we present an original deterministic algorithm called non-linear least squares with inequality constraints (nlsic) with its improved optimization process. it solves mfa-ile problems with good convergence robustness without sacrificing convergence speed. nlsic also enhances the numerical accuracy of a final solution. moreover, it did not suffer from the local minima problem in the cases we had at hand. we discuss this aspect in the section 5. in this article, the performance of the nlsic algorithm is illustrated by solving a mfa-ile problem. but this algorithm can be advantageously applied to a larger framework of non-linear leastsquares problems with inequality constraints. the nlsic algorithm is particularly suited to solve constrained least-squares problems with ill-conditioned or even rank-deficient jacobian. we start with the formulation of the mathematical problem in mfa-ile. we then describe the nlsic algorithm and its practical implementation for flux estimation. the influx_s software is further validated in the numerical section by comparing its performance to that of several other algorithms available in the widely used 13cflux software package. for this purpose, the different algorithms were applied to publicly available data from).we developed an algorithm for solving nlsic, which was used to solve the mfa-ile problem. in this field, it outperformed widely used algorithms such as bfgs, donlp2 or evolution algorithms not only in numerical stability but also in the accuracy of the solution. the increased numerical accuracy led us to conclude that a problem of local minima, as often mentioned in the literature dedicated to mfa-ile, could in some cases be a false problem. probably, it was lack of precision in convergence which was interpreted as trapping in a local minimum. the significantly improved computer efficiency, accuracy and reliability of influx_s makes the mfa-ile approach more accessible for a wide biological community interested in fluxomics. we can reasonably expect that the nlsic algorithm will also provide the same benefits in future mfa-ile developments dealing with the dynamics of labelling propagation in metabolically stable networks. the software influx_s implementing nlsic in the mfa-ile context is distributed under opensource licence. it has the same general character and input format as 13cflux software as it can take into account all types of labelling data coming both from ms and nmr.  
