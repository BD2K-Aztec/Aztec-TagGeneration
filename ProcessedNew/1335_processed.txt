design of shortest double-stranded dna sequences covering all k-mers with applications to protein-binding microarrays and synthetic enhancers motivation: novel technologies can generate large sets of short double-stranded dna sequences that can be used to measure their regulatory effects. microarrays can measure in vitro the binding intensity of a protein to thousands of probes. synthetic enhancer sequences inserted into an organisms genome allow us to measure in vivo the effect of such sequences on the phenotype. in both applications , by using sequence probes that cover all k-mers, a comprehensive picture of the effect of all possible short sequences on gene regulation is obtained. the value of k that can be used in practice is, however, severely limited by cost and space considerations. a key challenge is, therefore, to cover all k-mers with a minimal number of probes. the standard way to do this uses the de bruijn sequence of length 4 k. however, as probes are double stranded, when a k-mer is included in a probe, its reverse complement k-mer is accounted for as well. results: here, we show how to efficiently create a shortest possible sequence with the property that it contains each k-mer or its reverse complement, but not necessarily both. the length of the resulting sequence approaches half that of the de bruijn sequence as k increases resulting in a more efficient array, which allows covering more longer sequences; alternatively, additional sequences with redundant k-mers of interest can be added. availability: the software is freely available from our website http:// acgt.cs.tau.ac.il/shortcake/.gene regulation is a central focus of biological research. the main factors that regulate gene expression are transcription factors (tfs). these proteins bind to short dna sequences, either in promoters or enhancers, and by that encourage or impede gene transcription. tfs bind to different dna sequences with different affinity and specificity. understanding tf-binding specificity and its effect on gene expression and the final phenotype is a fundamental goal in the study of gene regulation. recent technologies measure the binding intensity of a tf to many dna sequences [e.g. protein-binding microarray (pbm) and mitomi. these technologies synthesize a large set of dna sequences and measure the binding intensity of the tf to each of those sequences. some technologies use random dna sequences . others use sequences that cover all possible dna k-mers, as they provide a complete picture of the binding spectrum . a similar approach was also used to test binding in vivo. a recent study used synthesized enhancer oligomers designed to cover all 6mers to test their effect on limb formation in zebrafish . de bruijn sequences are the most compact sequences that cover all k-mers . the length of a de bruijn sequence of order k over alphabet jaej is jaej k , where the dna alphabet is ae fa, c, g, tg. because of the exponential dependency on k and small space on the experimental device, these technologies are limited to a small value of k. the most popular technology, pbm, was used in hundreds of experiments to date using arrays with k 10. to create p-long probe sequences, the sequence is split into intervals of length p with k 1 overlap (p 36 is used in pbms). despite the universal and high-throughput nature of these technologies, the data produced are still limited. for many tfs, binding depends on 410 dna positions, usually with six to eight core positions and additional side positions that have a significant contribution . a recent study from the taipale laboratory using htselex showed that many tfs have longer motifs that are not covered well by an all 10mer array . the rankmotif algorithm for pbm data also generates motifs of length 410 in most cases . covering all k-mers for a greater value of k will lead to improved understanding of tf binding. as the probes are double-stranded dna segments, one can save by using the reverse complementarity of dna: whenever a k-mer is included, its reverse complement is included as well, and there is no need to cover it again. this brings up the following question: a sequence s is called a reverse complementary complete sequence of order k (rc complete sequence for short) if for each k-mer either the k-mer or its reverse complement are included in s. can we construct an optimal (minimum length) rc complete sequence? theoretically, if for each k-mer t the sequence s includes either t or its reverse complement but not both, one could save a factor of nearly 2 compared with the length of a de bruijn sequence. ministeris and eisen (2006) andproposed the use of (regular) de bruijn sequences for designing probes for pbms. philippakis et al. used linear feedback shift registers to generate a de bruijn sequence with good coverage of gapped k-mers. this approach was used for constructing two microarrays that are in use today with k 10 . the idea of exploiting reverse complementarity was raised by, who sketched an algorithm for it without proof. in fact, as we shall show, the algorithm of to whom correspondence should be addressed. the author 2013. published by oxford university press. this is an open access article distributed under the terms of the creative commons attribution non-commercial license (http://creativecommons.org/licenses/ by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. for commercial re-use, please contact journals.permissions@oup.commintseris and eisen (2006) does not provide an optimal solution for even values of k. in the context of sequence assembly,) solved the problem of constructing a minimum length sequence that covers a given set of k-mers, using reverse complementarity. although their algorithm can be applied to solve the problem raised in this study, they do not address it directly. when applied to our problem, their algorithm requires ok 2 log 2 jaejjaej 2k time. as we shall see, our algorithm is much faster. in this study, we address the problem of constructing an optimal rc complete sequence. we first give a lower bound for the length of such a sequence. we prove that for odd k, there exists a sequence that achieves the lower bound and show how to construct it in time complexity that is linear in the output sequence length. for odd k, the algorithm constructs two tours that are reverse complementary to each other and together cover all edges of the de bruijn graph and is identical to. then, we show how to adjust the algorithm to handle the case of even k, achieving a saving factor approaching 2 as k increases. we give two solutions: a simple near-optimal one requiring linear time and a more complex (okjaej 5k=4 logjaej time) solution that guarantees optimality of the resulting sequence. in particular, this implies that the lower bound is not tight for even k. we implemented the algorithm and we demonstrate the saving it achieves. the produced sequences are nearly half the length compared with a regular de bruijn sequence. the article is organized as follows. we first provide formal definitions and preliminaries. we then present a lower bound for the length of an optimal sequence based on k-mer counts. then, we present an algorithm that works in linear time on the de bruijn graph and prove that it solves the problem for odd k. we conclude by describing the two possible solutions for even k and report on experimental results with all the algorithms.3.1 a lower bound for the length of an rc complete sequence first, we derive a lower bound for the length of an rc complete sequence from k-mer counts.proposition 1. denote by n k the length of an optimal rc complete sequence of order k., if k is even ( 1 proof. we consider separately the cases of odd and even k. for odd k, there are no palindromes, as the middle position in a k-mer differs from its reverse complement. each k-mer must be represented in the sequence by itself or its reverse complement. i72  
