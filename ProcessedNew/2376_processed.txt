genome analysis improved similarity scores for comparing motifs motivation: a question that often comes up after applying a motif finder to a set of co-regulated dna sequences is whether the reported putative motif is similar to any known motif. while several tools have been designed for this task, habib et al. pointed out that the scores that are commonly used for measuring similarity between motifs do not distinguish between a good alignment of two informative columns (say, all-a) and one of two uninformative columns. this observation explains why tools such as tomtom occasionally return an alignment of uninformative columns which is clearly spurious. to address this problem, habib et al. suggested a new score [bayesian likelihood 2-component (blic)] which uses a bayesian information criterion to penalize matches that are also similar to the background distribution. results: we show that the blic score exhibits other, highly undesirable properties, and we offer instead a general approach to adjust any motif similarity score so as to reduce the number of reported spurious alignments of uninformative columns. we implement our method in tomtom and show that, without significantly compromising tomtoms retrieval accuracy or its runtime, we can drastically reduce the number of uninformative alignments. availability and implementation: the modified tomtom is available as part of the meme suite at http://research into gene regulation has motivated significant interest in the bioinformatics community in the computational problem of motif finding . consequently, numerous tools have been developed to identify motifs given a set of co-regulated sequences . more recently, the growth of motif databases such as jaspar , transfac and a protein-binding microarray (pbm) motif database spurred the development of new tools designed to allow researchers to test whether the motif returned by a motif finder is significantly similar to a known motif to whom correspondence should be addressed.[e.g. stamp, mahony and benos (2007) and tomtom,. such motif search tools may be viewed as blast for motifs, and their utility includes identification of newly detected motifs and automatic clustering of transcription factor into motif families. motif search tools can potentially represent each motif in a variety of ways. the most detailed representation consists simply of the complete list of known binding sites. while useful in some cases, this representation is difficult to work with. at the other extreme is the consensus sequence representation, which often glosses over important subtleties of the motif. motif database search tools, therefore, typically use a position weight matrix (pwm) representation of the motif. the pwm is typically a 4l matrix where l is the length of the motif and the (i,j) entry of the matrix contains either the frequency or, alternatively, the count of letter i at position/column j. after selecting a motif representation, one of the first steps in designing a motif database search tool is the choice of a distance or similarity function between motifs. to the best of our knowledge, all current tools use a linear similarity function which sums up the similarities between the aligned columns of the two motifs.performed a comprehensive study comparing the most popular column similarity functions. their finding was that while generally there are very small differences between most of these functions, the euclidean distance (ed, section 7.1 in supplementary material) consistently gives slightly better results than the other measures.made the important observation that ed, as well as most other scores that are commonly used for measuring similarity between motifs, does not distinguish between alignments of columns with identical composition. for example, the ed score assigns the same perfect score to the two pairs of column alignments in figures 1a and 1b. due to the linearity of the score, it follows that the alignments in figures 1c and 1d also share the same score, even though one is clearly more informative than the other. this is not merely a theoretical issue. indeed, we have observed that tomtom occasionally includes clearly spurious alignments of uninformative columns in its reported list of significant alignments . while uninformative alignments 1 are not the common case, they do persistently show up, even when using curated databases that often trim leading and trailing stretches of uninformative columns.), where the height of each letter is proportional to the nucleotide frequency; in all other figures, the height of the letter is proportional to the nucleotide frequency times the information content of the column. figures (a) and (b) show an alignment of a pair of columns with identical composition: all a in (a) and uniform in (b). figures (c) and (d) show two competing alignments between the same pair of motifs. these alignments would have the same scores under most similarity scores, including ed, even though one is clearly more significant than the other.in this section, we compare the performance of various combinations of methods for selecting an optimal querytarget alignment with methods for assigning an overall motif p-value. each such target function (alignment-selection and motif p-value evaluation) is assessed with respect to two criteria: reduction of uninformative alignments and retrieval accuracy. we begin with the former criterion.comparison of several target functions (a combination of alignment selection and an overall p-value estimation) in terms of reduction of uninformative alignments and retrieval accuracy. the first column specifies the column similarity method (seefor the meaning of ed, pcc, kls, allr and sw). all these scores were originally implemented in tomtom and were modified here to their complete versions (3) where the prefix complete is used. the second column specifies how the optimal alignment is chosen. tomtom selects the optimal alignment based on the offset p-value computed relative to an iid null model. we also tested computing the offset p-values relative to our hmm (sixth row) and selection based on the maximal complete score (starting from the seventh row). the third column specifies how the overall p-value is computed. tomtom uses an independent alignments assumption (ind alignments), mc refers to monte carlo estimation where the p-value is estimated by generating 10 000 samples for each target motif using either the hmm or the iid null target model. ind alignments (dp) refers to our dp calculation of the p-value of the optimal complete score using an independent alignment assumption. the fourth column specifies the percentage of the significant alignments that are uninformative. an alignment is considered significant if its overall p-value computed using the indicated method is below the 0.05 threshold. the alignment is considered uninformative if the information content of all aligned columns is less than 0.5. the fifth column specifies the average of the auc over all queries. note that the first row is the current default in tomtom. all experiments were done using the mouse pbm database. for comparison, using the blic score yields the same reduction in uninformative alignments as any of the complete scores but also the worst auc of 0.9645. while this retrieval accuracy might still be acceptable when the database contains deeper motifs the blic auc drops significantly (see supplementary table s2 and section 2).  
