idba-ud: a de novo assembler for single-cell and metagenomic sequencing data with highly uneven depth motivation: next-generation sequencing allows us to sequence reads from a microbial environment using single-cell sequencing or metagenomic sequencing technologies. however, both technologies suffer from the problem that sequencing depth of different regions of a genome or genomes from different species are highly uneven. most existing genome assemblers usually have an assumption that sequencing depths are even. these assemblers fail to construct correct long contigs. results: we introduce the idba-ud algorithm that is based on the de bruijn graph approach for assembling reads from single-cell sequencing or metagenomic sequencing technologies with uneven sequencing depths. several non-trivial techniques have been employed to tackle the problems. instead of using a simple threshold, we use multiple depthrelative thresholds to remove erroneous k-mers in both low-depth and high-depth regions. the technique of local assembly with paired-end information is used to solve the branch problem of low-depth short repeat regions. to speed up the process, an error correction step is conducted to correct reads of high-depth regions that can be aligned to highconfident contigs. comparison of the performances of idba-ud and existing assemblers (velvet, velvet-sc, soapdenovo and meta-idba) for different datasets, shows that idba-ud can reconstruct longer contigs with higher accuracy. availability: the idba-ud toolkit is available at our websitesince, over 99 of microbes cannot be cultivated, single-cell sequencing and metagenomic sequencing technologies are used to study these microbes . single-cell sequencing technology amplifies and sequences genome of an individual cell without cultivation . since the amplification bias, the sequencing depths at different regions of the genome can be extremely uneven. metagenomic sequencing studies a microbe community as a whole and has similar problem of uneven sequencing depths of genomes because different species in a sample have different abundances. almost all existing de novo assembly tools were designed for single genome with uniform sequencing depth and were used by some recent studies on microbes (to whom correspondence should be addressed.to evaluate the performance of our algorithm, experiments (all experiments were done on a machine with 8-core 2.40 ghz intel cpu and 144 gb memory. the tested assembler was run with multiple threads, if it supports.) are carried out on several datasets with different properties. results on existing general purpose assemblers like velvet , soapdenovo , idba and special purpose assemblers like velvet-sc , meta-idba were compared. different k-values were tried for each assembler and the result with best performance are shown and compared. two most important statistics, n50 and coverage are calculated to evaluate the contiguity and completeness of assembly results. n50 is the length of the longest contig such that all the contigs longer than this contig cover at least half of the genome being assembled . coverage is the proportion of the genome being covered by output contigs. in this article, only correct contigs are considered in the calculation of n50 and coverage. a contig is considered as correct if it can be aligned to the genome reference by blat with 95 similarity. for correct contigs, the substitution errors are computed by comparing the alignment between contigs and genome reference. for unaligned contigs, the number of contigs and the number of bases are recorded for comparison.  
