mt-hess: an efficient bayesian approach for simultaneous association detection in omics datasets, with application to eqtl mapping in multiple tissues downloaded from motivation: analysing the joint association between a large set of responses and predictors is a fundamental statistical task in integrative genomics, exemplified by numerous expression quantitative trait loci (eqtl) studies. of particular interest are the so-called hotspots, important genetic variants that regulate the expression of many genes. recently, attention has focussed on whether eqtls are common to several tissues, cell-types or, more generally, conditions or whether they are specific to a particular condition. results: we have implemented mt-hess, a bayesian hierarchical model that analyses the association between a large set of predictors, e.g. snps, and many responses, e.g. gene expression, in multiple tissues, cells or conditions. our bayesian sparse regression algorithm goes beyond one-at-a-time association tests between snps and responses and uses a fully multivariate model search across all linear combinations of snps, coupled with a model of the correlation between condition/ tissue-specific responses. in addition, we use a hierarchical structure to leverage shared information across different genes, thus improving the detection of hotspots. we show the increase of power resulting from our new approach in an extensive simulation study. our analysis of two case studies highlights new hotspots that would remain undetected by standard approaches and shows how greater prediction power can be achieved when several tissues are jointly considered. availability and implementation: c source code and documentation including compilation instructions are available under gnu licence atintegrating different layers of genomic information is essential to improve our understanding of the genetic basis of complex diseases. the development of integrative analysis strategies has become an important part of experimental design in the era of next-generation genomics . a fundamental task faced by many integrative strategies in genomics is to study the associations between two high-dimensional datasets. the study of such associations and the related biological questions can be naturally built within a regression framework, which exploits prior biological knowledge on the direction of the relationships between the different layers of genomics data. one prime example is expression quantitative trait loci (eqtl) analysis, which links dna polymorphisms to gene expression levels on a genome-wide basis. typically, such analyses would involve testing for association of all transcript-snp pairs. when eqtl studies involve large numbers of variants and genes, performing millions of such tests can become slow and it has been necessary to develop fast implementations . to go beyond such one at-atime strategies, eqtl mapping can be performed using high-dimensional regression models with expression measurements modelled as responses and genetic variants as predictors . the high-dimensional regression framework leverages information across the set of responses that are related to the same predictor, increasing the probability of detecting hotspots, i.e. genomic loci that regulate several genes at once. there is currently much interest in dissecting tissue, cell type or condition specificity of eqtls . the multiple tissues or cell types add an extra dimension to the data. for instance, analysis of eqtls across multiple tissues or cell types can inform to which extent eqtls are shared (or conserved) between different systems, therefore elucidating fundamental genetic regulatory mechanisms. so far these questions have been addressed using one of two alternative approaches. the first uses separate analysis for each tissue, and intersects the resulting lists of genetic variants . the second approach combines tissues but performs a separate analysis for each predictor (genetic variant) and response (gene expression level). neither approach fully exploits the data available, nor both can result in a loss of power to detect small effect eqtls that are shared across conditions. to the best of our knowledge, there is currently no alternative method that goes beyond one-at-a-time association tests and models simultaneously the expression of multiple genes under multiple conditions in a multivariate way. in this article, we propose a generic bayesian variable selection approach and an associated evolutionary stochastic search algorithm to tackle the challenging integrative task of linking parallel high-dimensional multivariate regressions in a computationally efficient way. the specificity of our approach is: (i) to move away from single feature at-a-time analysis and account for the correlated nature of the predictors by implementing a fully multivariate model search over the space of predictors (ii) to allow the analysis of multidimensional responses, and (iii) to exploit the relatedness of multiple responses through a bayesian hierarchical model. hierarchical modelling of expression responses allows us to exploit the potential functional relationships (e.g. co-regulation relationship, mrnamrna interactions, proteinprotein interactions, etc.) between multiple genes, thus increasing the power to detect hotspots. we build on our previous work , demonstrate the power of our new efficient hierarchical implementation in an extensive simulation study when compared with manova or the intersection of condition/tissue-specific results. we also illustrate the benefits of our approach in two case studies related to eqtls in multiple conditions (tissues or cell types), where we recapitulate previously validated hotspots and uncover new hotspots. in one case study, we also show that when several tissues are jointly considered the prediction error is substantially reduced compared with separate single-tissue analysis. even though our case studies relate to eqtl analyses, the model and algorithm that we present are generic and can be used for a large range of integrative genomics analyses that can be formulated within a parallel regression framework, such as finding targets for mirnas by regressing gene expression levels on mirna levels , linking dna variation and metabolites levels, the so-called mqtl analyses , or linking copy number alterations and tumour gene expression .the availability of data collected over multiple tissues or conditions is becoming increasingly common given the decreasing cost of generating transcriptomic, metabolic and epigenetic phenotypes over large cohorts of individuals . in this article we present a new model that exploits the multidimensional nature of these data and extends st-hess presented in: our new hierarchical model and c algorithm, mt-hess is able to analyse a large number of responses collected over dependent multiple tissues or conditions and regress them on a large set of correlated predictors. similar to its parent version, mt-hess retains the ability to perform hotspot discovery inomics experiments. to the best of our knowledge, mt-hess is the first tool able to unravel whether a genetic marker has a systemic role and influences several omics traits in multiple related conditions at the same time. this is demonstrated in the complex multiple tissue scenario of our real rat data analysis. the increased power of mt-hess allowed the detection of both experimentally validated and previously undiscovered putative hotspots for the idin network across left ventricle, aorta and liver tissues. prediction error analysis confirms the importance of the new detected hotspots. modeladequacy measure shows the superiority of mt-hess model over st-hess and the benefit of the integrated analysis. while in the rats dataset it is possible to perform a leave-one-out crossvalidation approach, in larger datasets out-of-sample prediction error can be performed by taking a random split of the data, for instance 50/50, and reserving the remaining data for calculating the average prediction error. due to a lack of competing algorithms that can analyse multiple layers of correlated responses in a fully multivariate fashion, we have compared mt-hess with a manova test, which is extensively used when multiple outcomes are present. recall that such manova test is performed for each pair of (snp response vector) at a time, where the vector of responses correspond to the expression in multiple tissues or conditions. we see that mt-hess outperforms manova, demonstrating that our hierarchical modelling approach is more powerful than pairwise methods. when faced with an eqtl analysis task which involves multiple tissues, a natural alternative to manova test is to compare results from the intersection of single-tissue model (ist-hess) with those from the multiple-tissue one (mt-hsss). our extensive simulation study show that when there is a similar pattern of association but varying levels of signal-to-noise ratio across tissues, mt-hess clearly outperforms ist-hess. this is well in keeping with the construction of the model underlying mt-hess, which performs a statistically sound evidence synthesis for detecting hotspots between the set of conditions or tissues. when signal-to-noise ratio is constant across conditions/tissues mt-hess results become closer to those of ist-hess pointing to the benefit of adjusting for external sources of correlated noise prior to mt-hess analysis, for example by using a latent factor approach as in. in our simulation study we show a substantial gain of power of mt-hess when the association in each tissue were too weak to be detected by st-hess, a situation also illustrated in our first case study where two new hotspots were highlighted by mt-hess, whereas they were not detected in the single tissue analyses. here the st-hess signal is relatively noisy and the ability of mt-hess to borrow and synthesize information between different layers of the responses results in higher power for mt-hess. our new c implementation of the complex hierarchical structure in mt-hess (comprising st-hess as a special case) permits efficient analysis of very large datasets. it made feasible an mt-hess analysis of our human dataset, where a multivariate analysis and variable selection between 3000 responses in three cell types and nearly 22 000 snps was carried out. the putative novel trans master regulator situated near a long intergenic non-coding (linc) rna (ensembl transcript enst00000507733) (see section 4.2) is a good example of the power of our approach for generating hypotheses which can be validated by follow-up experiments. the clear separation between noise and signal offered by our sparse regression approach is paramount for successfully prioritizing such further validation. in conclusion, our new algorithm mt-hess with its efficient c architecture is tailored to jointly analyse realistic case studies that comprise a large number of responses collected over dependent multiple tissues or conditions and a large set of potentially collinear predictors.  
