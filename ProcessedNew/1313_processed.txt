gene expression demix: deconvolution for mixed cancer transcriptomes using raw measured data motivation: tissue samples of tumor cells mixed with stromal cells cause underdetection of gene expression signatures associated with cancer prognosis or response to treatment. in silico dissection of mixed cell samples is essential for analyzing expression data generated in cancer studies. currently, a systematic approach is lacking to address three challenges in computational deconvolution: (i) violation of linear addition of expression levels from multiple tissues when log-transformed microarray data are used; (ii) estimation of both tumor proportion and tumor-specific expression, when neither is known a priori; and (iii) estimation of expression profiles for individual patients. results: we have developed a statistical method for deconvolving mixed cancer transcriptomes, demix, which addresses the aforemen-tioned issues in array-based expression data. we demonstrate the performance of our model in synthetic and real, publicly available, datasets. demix can be applied to ongoing biomarker-based clinical studies and to the vast expression datasets previously generated from mixed tumor and stromal cell samples. availability: all codes are written in c and integrated into an r function , which is available at http://odin.mdacc.tmc.edu/$wwang7/ demix.html.solid tissue samples frequently consist of two distinct components, glandular epithelium and its surrounding stroma. traditional analytic approaches that ignore the presence of tissue heterogeneity may suffer from inaccurate transcriptional profiling and are likely to miss important genes that are related to shaping cancers. to remove heterogeneity in tumor samples, researchers can use laser capture microdissection to physically isolate the different tissue components. however, this technique is time-consuming, costly and requires special equipment that is not available at all institutes. thus, it is of substantial interest to isolate expression data from mixed samples in silico. in biomarker-based clinical trials, microarray gene expression data are actively studied to profile transcriptions of hundreds of cancer patients . current methods for dissecting array-based expression data are limited in their application to actual data for the three following reasons. first, existing methods assume a linear mixture of expression levels, as presented by log-transformed data. this assumption, recently shown to be invalid, can distort the estimation of tissuespecific expressions . we describe this linear assumption by ax b, where a is a matrix of individual tissue-specific expression, x is a vector of mixture proportions and b is a vector of observed expressions.showed that raw measured data should be used for input b. when log-transformed fluorescent intensity data are used instead, the output a is underestimated. the convention of using log-transformed expression data started because such data were shown empirically to follow a normal distribution , which is straightforward for model building and parameter estimation. no available model-based methods are designed to analyze data from heterogeneous tumor samples before the data are log-transformed. second, the available methods do not provide a practical way to jointly estimate both tissue proportions (x) and tissue-specific expressions (a). most methods require good knowledge of one of these measures. the tissue-specific expressions (a) can be derived from a set of genes with known expression profiles in all constituting tissue types or from a set of genes that show significant enrichment in one of the tissue types . other methods focus on deconvolution of gene expressions based on known tissue proportions (implemented a bayesian model to assess the tissue proportions as well as gene expression levels, using strong previous information on the proportions.took reference profiles from all tissue components and allowed for adjustments in tissue-specific expression levels from the reference profiles.to whom correspondence should be addressed. developed a geometry-based method to estimate mixture proportions without knowledge of all tissue-specific expressions, which directly improved the method of, but did not deconvolve individual gene expressions. third, previous methods have focused on estimating the mean tissue-specific expressions for each gene and thus are not applicable to estimating individual expression levels in each sample and each gene. methods for in silico dissection of individual gene expression profiles are urgently needed. it is straightforward to compute these individual profiles in a matched design, where the mixed sample and one pure tissue sample are obtained from the same individual. in a more commonly observed unmatched design, where tissue samples are derived from mixed and pure tissues from different individuals, no methods are available to deconvolve these individual profiles, yet downstream biomarker analyses depend on the accuracy of these profiles. to bridge the gap from current methods to actual applications, we propose a statistical approach for deconvolving mixed cancer transcriptomes, demix. our method supports the analysis of mixed tissue samples under four data scenarios, with or without reference genes, and with a matched or unmatched design. here, reference genes are a set of genes for which expression profiles have been accurately estimated based on external data in all constituting tissue types. we anticipate that demix can broaden the investigation of mixed samples and increase the accuracy of downstream transcriptome analysis. the rest of this article is organized as follows. in section 2, we briefly explain the general framework of demix and describe four strategies in detail. in section 3, we conduct a simulation study and a validation study using publicly available data. we provide concluding remarks and potential extensions of our method in section 4.we have presented a novel statistical method, demix, for computational dissection of gene expression levels from mixed tissue samples, and in particular, for microarray data generated from cancer patient samples. our method addresses three existing problems for in silico dissection: (i) model-based analysis of raw measured data that follow a log 2 normal instead of a normal distribution; (ii) estimation of both tissue proportions and tissue-specific expression levels; and (iii) reconstitution of patient-specific gene expressions. we also provide uncertainty measures on estimated tissue proportions. demix provides practical solutions by requiring knowledge of gene expression of one tissue type, which does not have to be matched, i.e. derived from the same sample. our solutions vary according to data scenarios, to take advantage of all the available information. both simulation studies and analysis of actual data highlight the importance of following a linear mixture of gene expression levels on data before they are log-transformed, for which demix is the first method to do so. our validation study showed that demix performs accurately on expression data generated from both affymetrix and illumina platforms. our method can be applied to analyzing newly generated expression data from biomarker studies, as well as to re-analyzing data generated from previous studies. our method is useful when there is little information on gene expression levels in one of the mixing components, and at the same time the mixing proportions, which could be obtained from other sources such as pathologist estimates or from dna copy number data , are not available. we do not require knowledge of reference genes. however, when such knowledge is available, we have provided an alternative solution to take advantage of the information. even though our algorithm requires a minimum of one gene as a reference gene, we recommend using at least 510 genes to alleviate the potential influence from outliers and to identify an optimal set of s. demix uses expression levels from thousands of genes to estimate each and is, therefore, robust to perturbations in the expression of a minority of genes, arising from interaction with surrounding tumor cells. demix can also use a list of selected genes that are not affected by the tumor, when available, for the estimation of proportions. if cell proportions are estimated reliably, they can also be used to estimate mean expression levels in both normal and tumor tissues for potentially perturbed genes, based on the linear relationship ax b on raw measured data. when reference genes are considered, demix performed similarly or better than pert in estimating tissue proportions with our validation data (supplementary figs s9 and s10). our estimation procedure under matched or unmatched samples with reference genes is computationally efficient. on a pc with a 2.2 ghz intel core i7 processor, the computation of our simulation data consisting of 20 matched samples and 2000 genes in each sample takes $1 s. in contrast, it takes $10 min to complete the computation of the same data without knowledge of any reference genes. we used the neldermead optimization procedure that includes a numerical integration of the joint density, which may explain this substantial increase in computation time. demix takes a two-stage approach by first estimating thetially expressed genes at varying p-value cut-offs (bonferroni-corrected), using different models. the third curve from the top corresponds to comparison between the three pure brain and the three pure liver tissue samples i s and then estimating the means and variances of gene expressions based on the i s. a joint model that estimates all parameters simultaneously will be able to further incorporate the uncertainty measure of the tissue proportions. however, the estimation step from such a model can be computationally intensive and may not be suitable for the analysis of high-throughput data. we identified a few considerations for the deconvolution of microarray data. first, the assumed linear mixture of data before they are log-transformed may not perfectly hold for some samples, e.g. samples 1 to 3 from the affymetrix data, and for some genes, e.g. those with extreme expression values such as 52 4 or 42 14. second, our estimation method is based specifically on log 2 normal distributions of the raw measured data for each mixture component. when this assumption is violated, a deterioration of accuracy is to be expected. third, microarray technology has inherent limitations, such as high background noise and inconsistent gene expressions across experiments. screening out genes with low expression levels and accounting for batch effects must be tackled before deconvolution. we found scale normalization using mas5 can obscure the actual linear mixture of expression levels, on which the downstream deconvolution is based. summarization using rma, together with quantile normalization, seemed to retain our linearity assumption of the raw measured data most of the time. our model assumes that a mixed sample consists of at most two cellular compartments: normal and tumor, and that the distributional parameters of normal cells can be estimated from other available data. these assumptions seem to us to be a logical place to begin, but there remain important situations where more complex modeling may be needed. first, we assume pure normal samples to be representative of the normal tissues in the mixture samples, allowing for estimation of sample-specific expression values. this assumption can be violated as there are sometimes perturbations of gene expression levels in tumorstromal interactions, as previously discussed. second, both normal and tumor tissues may in turn consist of different cell types, with different transcriptional activity, and represented in proportions that can be variable across samples. this has been studied in, which used reference profiles from all cell types. extensions of our model to deconvolution of more than two mixture components can address this issue without requiring reference profiles from all mixing components and can be done with a more computationally efficient density integration and optimization procedure. currently, to identify i s, we assume a roughly stable composition of one or multiple cell types within each tissue component. with data from real tissue samples, it is necessary to evaluate the extent to which this assumption is valid. the variation in the composition of multiple cell types from sample to sample will be captured by the variance of the distribution of expression levels within each tissue, which is estimated based on the data. when there exist multiple tumor subtypes, our method should be applied separately to samples that belong to the same subtype.  
