a novel statistical method for quantitative comparison of multiple chip-seq datasets motivation: chip-seq is a powerful technology to measure the protein binding or histone modification strength in the whole genome scale. although there are a number of methods available for single chip-seq data analysis (e.g. peak detection), rigorous statistical method for quantitative comparison of multiple chip-seq datasets with the considerations of data from control experiment, signal to noise ratios, biological variations and multiple-factor experimental designs is underdeveloped. results: in this work, we develop a statistical method to perform quantitative comparison of multiple chip-seq datasets and detect genomic regions showing differential protein binding or histone modification. we first detect peaks from all datasets and then union them to form a single set of candidate regions. the read counts from ip experiment at the candidate regions are assumed to follow poisson distribution. the underlying poisson rates are modeled as an experiment-specific function of artifacts and biological signals. we then obtain the estimated biological signals and compare them through the hypothesis testing procedure in a linear model framework. simulations and real data analyses demonstrate that the proposed method provides more accurate and robust results compared with existing ones. availability and implementation: an r software package chipcomp is freely available atcoupling chromatin immunoprecipitation (chip) and nextgeneration sequencing (seq), chip-seq is a powerful technology for profiling protein bindings or histone modifications in the whole genome scale. since the introduction of the technology , a large number of experiments were conducted to create genome-wide profiles for many dna-binding proteins and different types of histone modifications under various biological contexts, for example, by large national consortiums such as encode and modencod . the main goal of analyzing data from a single chip-seq experiment is to detect protein binding or histone modification regions, often referred to as peaks. the raw data produced from chip-seq experiments are many short dna segments called reads. after aligning the reads to the reference genome, genomic regions with unusually large number of reads clustered are often deemed peaks. in recent years, a number of methods and software tools are developed for peak detection. two benchmark studies have also been conducted to compare different peak calling methods . with the continuous reduction of sequencing costs and the rapid accumulation of public data, it is v c the author 2015. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.com now a common practice to compare data from different chip-seq experiments, for example, to compare the binding of certain protein under different biological conditions. such analysis provides important information for studying the dynamics of epigenetic regulations. results from the analysis can be further associated with other data, such as gene expressions, to better understand the gene regulation mechanisms. the comparisons of chip-seq data have been widely performed. the most straightforward method is the overlapping analysis, which is to compare the peaks called from different experiments and defines common peaks or unique peaks, then represents them by venn diagram . this method, however, is highly dependent on the thresholds used for calling peaks. genomic regions barely over the threshold in one sample but under the threshold in the other will be declared as unique peaks even if the quantitative difference is small. moreover, it completely ignores the quantitative differences of peaks, that is, genomic regions being peaks in both samples will be deemed common peaks, even if the quantitative difference is large. due to these reasons, quantitative comparison is more desirable to compare chip-seq datasets. the quantitative comparison of chip-seq can be performed by comparing the read counts among different experiments, which is similar to rna-seq differential expression (de) analysis. however, it is a more complicated problem due to several reasons. first, the data from the ip experiments are affected by the genomic background, such as chromatin structures and dna sequence. these backgrounds are non-uniform across the genome, and could be highly variable across different experiments. the backgrounds, measured by control experiments, need to be taken into account in quantitative comparison of multiple chip-seq datasets. another complication arises from the different signal to noise ratios (snrs) of the experiments. many technical or biological artifacts contribute to snrs. for example, sample with less binding sites will have taller peaks because reads are allocated into narrower genomic regions. moreover, different snrs may result from differences of antibody qualities, experimental protocols or lab technician skills, etc. therefore, correctly accounting for snrs is important in quantitative comparison of chip-seq. in addition, considerations for biological variance and experimental designs remain, similar to that in de analysis of rna-seq. quantitative comparison of chip-seq (often referred to as differential binding problem) has gained some interests recently, and several methods have been proposed for two-condition comparison. there are two methods take the approach to model the differences of normalized read counts from two ip experiments: chipdiff applies hidden markov model on the differences to identify differential histone modification regions, and dime uses a finite exponential-normal mixture model on the differences to detect differential binding sites. however, neither the control experiment nor the biological replicates are considered in these methods. moreover, these methods do not account for snrs and cannot be easily extended for multiple condition comparison. manorm and chipnorm consider different snrs. both methods normalize the data before comparison: manorm performs normalization based on ma-plot, and chipnorm uses quantile normalization. but again, neither considers control data at the normalization step, and these methods cannot be easily extended to handle more complicated experimental designs. there are two software packages provide functionalities to consider the control data: dbchip and diffbind . both methods directly apply existing methods and software package developed for rna-seq de analysis. they start from a list of candidate regions which are unions of peaks called for each individual experiment. these regions are then treated like genes, and rna-seq de methods are directly applied for comparison. to account for the control experiment, the software provide option to subtract the normalized control counts from ip counts, then round the differences and use them as inputs for the software. there are several problems with this approach. first, the underlying assumption of the methods is that the background noise and biological signals are additive, which is not always true based on our real data observation (details in later section). second, these methods dont consider the snrs from different experiments. finally, most rna-seq de methods are developed based on negative binomial distribution assumption of the gene counts. subtracting control from ip counts then rounding will likely to violate that model assumption, which lead to incorrect statistical inferences. in this work, we develop a comprehensive and rigorous statistical method, named chipcomp, to perform quantitative comparison of multiple chip-seq data from experiments with narrow peaks, including data for most of the protein binding, some histone modifications if the modification regions are narrow, and the dnase-seq experiments. chipcomp takes into consideration of (i) genomic background measured by the control data; (ii) snrs in different experiments; (iii) biological variances from the replicates and (iv) multiple-factor experimental designs. we demonstrate using simulations and real data analyses that chipcomp provides more accurate and robust results compared with existing methods.in this work, we develop a novel statistical method to perform quantitative comparisons of multiple chip-seq datasets and detect differential protein binding or histone modification regions. statistical methods of differential analysis for other sequencing data such as rna-seq have been well developed. the comparison of chip-seq data, however, is more complicated because of different background noises and snrs in distinct experiments. existing methods either ignore the data from control experiments (such as manorm or dime), or directly apply rna-seq methods without proper normalization (such as dbchip or diffbind). the proposed method describes the data by a rigorous statistical model with the considerations of control data, snrs, biological variations, and general experimental designs. statistical test procedures are developed for detecting differential regions. simulation and real data analyses results demonstrate that chipcomp provides more accurate and robust results compared with existing methods. the essence of the method is to extract biological signals from different experiments and then compare. the process involves estimating and removing biological and technical artifacts, and normalization of the biological signals. to ensure that the estimated biological signals are comparable across different experiments, proper references are needed for normalization and put the biological signals in a common baseline. in that regard, the proposed method relies on two important assumptions. first, the chip-seq datasets in comparison need to have a nontrivial number of common peaks. in fact, when there are very few common peaks among datasets, a simple overlapping analysis of the peak will be adequate. second, it is assumed that theres no global difference in the true biological signals for the common peaks across all datasets, which is the same assumption used by manorm. this assumption provides a common baseline for different datasets for comparison. similar assumption has been used in de analysis for many years: a majority of the genes show no de. the hypothesis test is performed based on the log biological signals, which is derived based on log counts. when the counts at candidate regions are very small, this procedure could bring some biases and high variance. to overcome that, we added a small constant in the counts to squeeze the lower end of the log count distribution, and carefully derived the variances for estimated parameters to take the raw counts into consideration. a similar approach has been proposed in a recently developed rna-seq de method, voom , and proved to have good performance. the proposed method describes the count data from replicated samples through a lognormal-poisson model. more often, these data are described by negative binomial, which is a gammapoisson compound distribution. in our model, the underlying poisson rate is assumed to follow a lognormal, instead of gamma distribution. this is mainly motivated by methodological convenience. however, when the shape parameter in gamma distribution is reasonably large, the gamma and lognormal distributions become very similar. simulation results show that the results from chipcomp is robust and still provides good results when the data are from negative binomial. so we believe that our method will perform well in real data settings. the method is specifically designed for comparison of chip-seq with short peaks, including most of the protein binding data, some histone modification data and dnase-seq. for histones modification data with long peaks/blocks such as h3k9me3, the method is not directly applicable. however the problems presented in those data are similar: consideration of backgrounds, different snrs, biological variances, etc. to design method working for the quantitative comparison of data with long peaks is our research plan in the near future.  
