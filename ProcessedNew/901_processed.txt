cellcode: a robust latent variable approach to differential expression analysis for heterogeneous cell populations motivation: identifying alterations in gene expression associated with different clinical states is important for the study of human biology. however, clinical samples used in gene expression studies are often derived from heterogeneous mixtures with variable cell-type composition, complicating statistical analysis. considerable effort has been devoted to modeling sample heterogeneity, and presently, there are many methods that can estimate cell proportions or pure cell-type expression from mixture data. however, there is no method that comprehensively addresses mixture analysis in the context of differential expression without relying on additional proportion information, which can be inaccurate and is frequently unavailable. results: in this study, we consider a clinically relevant situation where neither accurate proportion estimates nor pure cell expression is of direct interest, but where we are rather interested in detecting and interpreting relevant differential expression in mixture samples. we develop a method, cell-type computational differential estimation (cellcode), that addresses the specific statistical question directly, without requiring a physical model for mixture components. our approach is based on latent variable analysis and is computationally transparent; it requires no additional experimental data, yet outperforms existing methods that use independent proportion measurements. cellcode has few parameters that are robust and easy to interpret. the method can be used to track changes in proportion, improve power to detect differential expression and assign the differentially expressed genes to the correct cell type. availability and implementation: the cellcode r package can be downloaded atdifferential expression analyses are used widely in the study of human biology, but their utility is often limited by the extreme variability (and the resulting poor reproducibility) of human molecular measurements. one biological source of measurement variance is heterogeneity in sample composition. human samples are often mixtures of multiple cell types with relative proportions that can vary several fold across samples. for example, in diseased brain, cell populations can change markedly, as some cell types die, whereas others proliferate . in cancer samples, there may be different amounts of stromal tissue and different sub-populations of cancer cells that are molecularly distinct (schwartz and shackney,). cell-type variation is particularly pronounced in blood, where proportions of different cell types can vary 4-fold naturally . consequently, it is well established that mrna and protein measurements from human blood, or blood derivatives such as peripheral blood mononuclear cells (pbmcs), are extremely variable. much effort has been devoted to the development of computational methods that can accurately model and analyze mixture samples. existing approaches can computationally estimate proportions, pure expression states or bothsimple matrix decomposition to complex iterative procedures. importantly, these methods are largely focused on estimating physical quantities (pure expression states and proportions) rather than statistical ones (such as effects and interactions), and most are not designed for differential expression analysis. a recent r package unifying many of the existent methods lists only two (dsection and cssam) that can work as differential expression pipelines, and both require independent cell proportion measurements as input . shen-orr et al. had showed that cssam can be effective at addressing two questions. it can be used both to find differentially expressed (de) genes, when standard statistical methods fail, and to assign the de genes to the cell type in which their regulation has been altered. the latter is an important goal as disease-associated expression changes are expected to be cell-type specific and knowing which cells are affected by the disease state is important for interpreting the results. in this study, we demonstrate that these two goals, improving the power to detect de genes and assigning altered expression to the cell type of origin, can be effectively approached with latent variable analysis. our cell-type computational differential estimation (cellcode) method is designed for de analysis and requires no additional dataset-specific knowledge. in particular, we demonstrate that by relying on the data structure alone, we can correct for mixture variation and improve statistical power as well as or better than methods that use explicit cell proportion measurements. we also show that the cellcode framework can be used to assign expression alterations to their cell type of origin with high accuracy. our method is widely applicable and we demonstrate that it can be used to derive new insights from existing data.the biological complexity of quantitative measurements derived from mixture samples raises many challenges. the variation of mixture components from sample to sample induces large variance in gene expression measurements, making it difficult to detect relevant gene regulation. on the other hand, the cell-type proportions themselves may be different between the clinical groups, giving rise to many de genes that do not correspond to any actual transcriptional regulation. finally, for genes that are altered within a cell-type the source of transcriptional regulation is ambiguous, as many cell types are assayed together. we propose a multi-step statistical framework that uses latent variable analysis to analyze differential expression from mixture samples. we first estimate a set of surrogate proportion variables (spvs) by cross-referencing putative marker genes with the data correlation structure. these spvs are then included in the differential expression analysis to improve the detection of bona fide regulated genes. finally, the de genes are assigned to the cell type in which they are regulated, evaluating interaction between genes and estimated spvs.we propose a method for dissecting mixture datasets that is specifically designed for analyzing differential expression. our method extracts cell proportion covariates from the data structure and estimates the confounding and interaction effects. we demonstrate the sensitivity and accuracy of this method on simulated data and its capacity to generate biological insights using experimental datasets. our method neither requires nor utilizes independent proportion measurements. even when such measurements are available, because of various limitations in these data, they may not produce optimal covariates for statistical testing. for example, coulter counter measurements can have an error of 5 or more for the rare cell types . additionally, some cell types that are counted may preferentially lose rna due to processes such as apoptosis and, consequently, cell counts may not accurately reflect pooled mrna composition. most importantly, independent cell proportion measurements may not identify important molecularly distinct cell types. for example, the study by shen-orr et al. did not differentiate b-cells and t-cells, which cannot be distinguished by the coulter principle alone. in contrast, cellcode can capture variation from molecularly distinct cell types as long as some independent proportion variation in present and appropriate marker genes are available. despite these limitations of the independent cell proportion measurements, it may be possible to develop a hybrid approach that makes use of this additional information. for example, a method that constrains the estimated latent variables to correlate with known covariatesfor an example] might be adapted to extract mixture variation. in summary, we propose a statistical framework for the analysis and interpretation of mixture samples that requires no dataset-specific prior knowledge yet performs comparably to or better than methods that use additional information. we demonstrate the general utility of evaluating interaction effects between known clinical groups and latent variables. in our case, the latent variables are celltype proportions, but the methodology can be readily adapted to other latent sources of variation.  
