turboknot: rapid prediction of conserved rna secondary structures including pseudoknots motivation: many rna molecules function without being translated into proteins, and function depends on structure. pseudoknots are motifs in rna secondary structures that are difficult to predict but are also often functionally important. results: turboknot is a new algorithm for predicting the secondary structure, including pseudoknotted pairs, conserved across multiple sequences. turboknot finds 81.6 of all known base pairs in the systems tested, and 75.6 of predicted pairs were found in the known structures. pseudoknots are found with half or better of the false-positive rate of previous methods. availability: the program is available for download under an open-source license as part of the rnastructure package at:in many cases, rna functions in cells without being translated into proteins. these non-coding rnas (ncrnas) carry out a wide range of functions, including catalysis, intracellular protein trafficking, immunity and gene regulation . the functions of these ncrnas depend on their structures. rna structure is hierarchical, beginning with the sequence of nucleotides (the primary structure), then the set of all canonical, i.e. gc, au and gu base pairs (the secondary structure), and ultimately the full 3d positioning of all the atoms in the molecule (the tertiary structure). the secondary structure tends to form on a faster time scale and with stronger interactions than those interactions that fold the tertiary structure, so the secondary structure can usually be predicted independently of knowing the overall tertiary structure . the most accurate method of secondary structure determination is comparative sequence analysis. it relies on the hypothesis that sequences that serve the same function share the same structure. but comparative sequence analysis is impractical in many situations to whom correspondence should be addressed. because it requires significant human insight and a large number of diverse sequences . commonly, the secondary structure for a single sequence is predicted using free energy minimization. these methods use a set of thermodynamic parameters that predict the folding free energy change of a given structure and a dynamic programming algorithm to find the structure with lowest free energy change . the thermodynamic parameters can be used with a different type of dynamic programming algorithm to predict a partition function, which can be used to predict the base pairing probability for all possible canonical pairs . base pair probabilities can be used to assemble structures called maximum expected accuracy (mea) structures . briefly, mea prediction seeks to maximize the sum of probabilities of each base pair for all paired bases and the probabilities of being single-stranded for all unpaired bases. empirically, mea structure prediction works because that base pairs predicted to be the most probable are the most likely to be in the known structure . although comparative sequence analysis is not yet automated, a number of methods have been developed to improve structure prediction by using the information available in homologous sequences. . these methods use a supplied input sequence alignment, predict the structure for each sequence and then find the common structure, or align and fold the sequences simultaneously. these programs have been reviewed previously . the recently published turbofold algorithm is one such method that improves secondary structure prediction by predicting a conserved structure using two or more homologous sequences . it refines base pairing probabilities of an arbitrary number of sequences using their probabilistic alignments in an iterative manner. structures are then assembled using a mea algorithm from the final set of base pairing probabilities. because of computational complexity, most programs that predict secondary structure do not predict pseudoknots. formally, a pseudoknot occurs if an rna has two base pairs, one between bases i and j, and a second between i and j , such that i i j j. pseudoknots make up only a small fraction of base pairs, but they are often found in ncrnas. predicting the minimum free energy secondary structure that includes pseudoknots of any topology has been proven to be np-hard . in spite of this, a number of single-sequence methods have been developed to). these methods limit the set of possible pseudoknot topologies to accelerate the search. a number of available methods has been previously reviewed . recently, a new algorithm was published, probknot, that uses a single sequence partition function to predict pairing probabilities and assigns base pairs if the two bases are mutually maximally probable to pair with one another . this algorithm can find pseudoknots of any topology. while the partition function does not include terms for pseudoknotted structures, the probknot algorithm was able to find pseudoknotted base pairs with reasonable accuracy compared with other methods, and at minimal computational cost: the algorithm is o(n 2 ) in addition to the o(n 3 ) partition function calculation. approaches to the pseudoknot prediction problem that employ information from sequence and structural homology are few in number. like single sequence methods , a monte carlo alignment and folding method has also been published . also analogous to single sequence methods , another approach identifies common pseudoknot-free structures and then iteratively matches regions that can form pseudoknots . a third approach computes a score matrix based on alignment and thermodynamic information and uses a maximum weight matching (mwm) algorithm to assemble an optimal secondary structure . the latter two approaches are dependent on a high-quality sequence alignment as input, either one assembled manually or one computed from sequences with a large degree of sequence identity (70 or more). such alignments are not always available, particularly for newly discovered classes of rnas. this contribution reports a new algorithm, turboknot, for predicting rna secondary structures conserved in multiple sequences, including pseudoknots. turboknot assembles structures in the same way as probknot, but with the pairing probabilities predicted by a turbofold calculation using multiple sequences to inform the pairing probabilities. the additional computational cost compared with turbofold is small compared with the turbofold calculation itself, just o(mn 2 ), where mis the number of sequences used and n is the length of the longest sequence. it is benchmarked against two algorithms capable of predicting pseudoknots that also use multiple sequences as input, ilm and hxmatch . it is also benchmarked against the single sequence probknot algorithm . finally, two algorithms that cannot predict pseudoknots are included in the benchmark, turbofold and mea (maxexpect) .over the range of rna families tested, which have a variety of functions and structures, turboknot averaged a sensitivity of 79.8 and a ppv of 72.9 . for comparison, turboknot was benchmarked against two other multisequence methods that can predict pseudoknots: ilm version 1.0 and hxmatch version 1.2.1 . each was run with default parameters. sequences were aligned for input into these algorithms using muscle version 3.6 , which performs well for rna sequence alignment compared with other available tools . in addition to these two methods, benchmarks were run using probknot , a single sequence method that can predict pseudoknots, turbofold , the underlying multisequence method that cannot predict pseudoknots and maxexpect , a single sequence method that cannot predict pseudoknots. other single-sequence methods capable of predicting pseudoknots were recently benchmarked , and probknot compares favorably against these. it is used here as a representative of this class of algorithms. one algorithm, dotknot, has been published more recently. its performance on this test set is included in supplementary tables s3s5 for comparison. similarly, multisequence algorithms that cannot predict pseudoknots were recently benchmarked , and turbofold compares favorable and is used as a representative of them here. the average sensitivity and ppv of turboknot were better than any other method capable of predicting pseudoknots. additionally, turboknot had a higher sensitivity than turbofold, albeit at a tradeoff in ppv. since turboknot considers a larger structure space than turbofold, it is natural to find more correct base pairs with a cost to the ppv. for pseudoknots in particular, turboknot found 289 correct pseudoknotted base pairs out of a total of 5897 in the known structures, and it made 672 false positive predictions of pseudoknotted pairs . this is more true positives and fewer false positives than any other tested method. when consideringmaxexpectunderlined results represent the best performance out of all the algorithms that predict pseudoknots. bold results represent absolute best performance. a sequences were selected at random with replacement, so some sequences were chosen more than once. b pseudoknots were counted using the method ofstructures with pseudoknots rather than individual pairs, turboknot found at least one true positive pseudoknot in 59 structures out of 239 predictions, and out of 426 tested structures that contain at least one pseudoknot (supplementary). this is again more true positives and fewer false positives than any other tested method. the use of an mwm algorithm to assemble structures given the turbofold pair probabilities was also considered as a control (supplementary tables s7 and s8). this approach resulted in the identification of the exact same set of correct base pairs as those based on mutual maximum probability pairs, plus a small number of extra incorrect pairs. the additional, incorrect pairs were so few that they only affected the second decimal places of the ppv percentages. the exception was the tmrna family, in which a small number of additional correct base pairs were identified. the minor difference between these two approaches was due to how well the turbofold algorithm refines the pairing probabilities by excluding structures that are not conserved. as another control, an mwm algorithm was used to predict structures from pair probabilities calculated using a single sequence partition function. this added a number of spurious base pairs (supplementary). this emphasized the importance of the probknot approach when single sequences are used. time benchmarks were performed on all tested algorithms. groups of five random sequences were used, with average lengths varying from 80.0 nt to 458.8 nt . the hxmatch algorithm performed the fastest. turboknot was significantly slower, but it could still carry out the computations in a reasonable amount of time for a user with a typical desktop computer.shows a sample structure prediction for mycobacterium tuberculosis rnase p using turboknot, probknot or turbofold . the turboknot and turbofold structures are similar, but the turboknot algorithm is able to identify most of the pseudoknotted base pairs. probknot has a lower sensitivity and ppv overall for non-pseudoknotted base pairs in this structure. it identifies the four correct pseudoknotted base pairs that turboknot missed, but it also finds eight pseudoknotted base pairs that are not in the accepted structure. turboknot overextends some helices as compared withturbofold when there are valid bases available to pair. the accuracy of the extra base pairs added when turboknot extends helicesin the same way as thein the process it predicted more than twice as many false positive pairs as there were true pseudoknotted pairs in the accepted structures. single sequence methods, with or without pseudoknot-prediction capabilities, were reported as having poor performance on the prediction of tmrna structure . the results with the sequences used here are consistent with that result. turboknot (and turbofold), however, show significant improvement for this difficult class of rnas. turboknot shows its best pseudoknot-prediction capabilities on this class of rnas, with 49 of all predicted pseudoknotted base pairs being true positives. in contrast, group i introns show slightly worse sensitivity in turbofold and turboknot compared with maxexpect and probknot, although they did still have higher ppvs. this is likely because the long insertions present in some group i introns makes accurate sequence alignment difficult. indeed, ilm and hxmatch, which are dependent on a sequence alignment algorithm for input, did not perform well with randomly chosen groups of sequences from this class of rnas. these algorithms may have more success, however, when sequences with higher sequence similarity are used or when using a manually curated alignment, which would allow for more accurate sequence alignment. such groups of sequences are not always available. ilm was benchmarked in a previous study using just one sequence rather than an alignment, and, unexpectedly, it appears less accurate when using multiple sequences as input compared with previously reported benchmarks . this is likely because it was hindered by errors made by the sequence alignment algorithm, which aligns sequences but not secondary structure . it fared much better when given manually curated alignments based on structural homology . because hxmatch, which was given the same input sequence alignments, had similar results on similar classes of rnas, it is likely tools that consider both secondary structure and alignment at the same time are necessary to accurately align functionally similar rnas which are not chosen to have a relatively high sequence identity. while turboknot has significantly improved pseudoknot prediction accuracy, more work is needed to raise the accuracy to the current standard for non-pseudoknotted base pairs. dirks and pierce (2004) report an algorithm that computes a partition function that includes pseudoknots of some limited topologies in o(n 4 ) time. this partition function could be used by turbofold and turboknot to consider a larger structure space, ideally increasing the probability of true pseudoknots at the expense of false ones that are predicted currently at an acceptable increase in computational expense.  
