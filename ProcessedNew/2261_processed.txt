ibd-groupon: an efficient method for detecting group-wise identity-by-descent regions simultaneously in multiple individuals based on pairwise ibd relationships motivation: detecting ibd tracts is an important problem in genetics. most of the existing methods focus on detecting pairwise ibd tracts, which have relatively low power to detect short ibd tracts. methods to detect ibd tracts among multiple individuals simultaneously, or group-wise ibd tracts, have better performance for short ibd tracts detection. group-wise ibd tracts can be applied to a wide range of applications, such as disease mapping, pedigree reconstruction and so forth. the existing group-wise ibd tract detection method is com-putationally inefficient and is only able to handle small datasets, such as 20, 30 individuals with hundreds of snps. it also requires a previous specification of the number of ibd groups, or partitions of the individuals where all the individuals in the same partition are ibd with each other, which may not be realistic in many cases. the method can only handle a small number of ibd groups, such as two or three, because of scalability issues. what is more, it does not take ld (linkage dis-equilibrium) into consideration. results: in this work, we developed an efficient method ibd-groupon, which detects group-wise ibd tracts based on pairwise ibd relationships , and it is able to address all the drawbacks aforementioned. to our knowledge, our method is the first practical group-wise ibd tracts detection method that is scalable to very large datasets, for example, hundreds of individuals with thousands of snps, and in the meanwhile , it is powerful to detect short ibd tracts. our method does not need to specify the number of ibd groups, which will be detected automatically. and our method takes ld into consideration, as it is based on pairwise ibd tracts where ld can be easily incorporated.two or more alleles are identical by descent (ibd) if they are identical copies of the same ancestral allele. ibd tracts are regions shared between two or more individuals if they inherit identical nucleotide sequences in the regions from common ancestor. ibd detection has been applied to a wide range of applications, such as detecting relatedness of unknown individuals , reconstructing pedigrees , phasing haplotypes , disease mapping and so forth. recently, many methods have been developed to detect ibd tracts between pairs of individuals, based on genotype data or haplotypes.proposed relate, which uses a continuous time markov model where the hidden states are the number of alleles shared ibd between pairs of individuals at a given position.proposed plink, which detects extended chromosomal segmental ibd sharing between pairs of distantly related individuals by use of a hidden markov model (hmm), in which the underlying hidden ibd state is estimated given the observed ibs (identity-by-state) sharing and genome-wide level of relatedness between the pair.proposed a program germline based on a dictionary of haplotypes that is used to efficiently discover short exact matches between individuals. these matches are then expanded using dynamic programming to identify long, nearly identical segmental sharing that is indicative of relatedness. browning and browning (2011) implemented an algorithm fastibd in the program beagle, which is based on estimating frequencies of shared haplotypes because a shared common haplotype is unlikely to reflect recent ibd, whereas a shared haplotype that is rare is likely to be identical by descent. a fixed number of haplotype pairs are sampled for each individual from the posterior haplotype distribution. each sampled haplotype corresponds to a sequence of hmm states. the fastibd algorithm searches for pairs of sampled haplotypes sharing the same sequence of hmm states for a set of consecutive markers. overlapping shared haplotype tracts are merged, and the merged shared haplotype tract is a mosaic of pairs of sampled haplotypes. a fastibd score is calculated for each merged tract, and if the score is below a user-specified threshold, the tract is reported as ibd. these methods have been shown to be powerful to detect long pairwise ibd tracts. however, they generally suffer from low power to detect relatively short ibd tracts, for example, ibd tracts of length 51 mb. and they all aim to detect pairwise ibds only. methods to use group-wise ibd relationships or ibd tracts shared by multiple individuals to increase the power for short ibd tracts detection have been proposed.have proposed methods to detect group-wise ibd tracts for cases in which some pedigree information or information about ibd sharing is available.proposed a more general markov chain monte carlo (mcmc) method where it does not assume any previous information about ibd sharing patterns. groupwise ibds are detected directly from unphased genotype data, using an hmm model where the states are possible ibd tracts among the given set of individuals. an mcmc approach is developed to infer relevant information about the parameters of the hmm model. besides the capability to report group-wise ibd tracts, it is also shown that the mcmc approach has relatively the author 2013. published by oxford university press. this is an open access article distributed under the terms of the creative commons attribution non-commercial license (http://creativecommons.org/licenses/ by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. for commercial re-use, please contact journals.permissions@oup.com high power to detect short ibd tracts compared with the pairwise ibd tracts detection methods. the mcmc method, however, suffers from intensive computation; therefore, it can be only applied to small datasets, for example, 2030 individuals with 500 snps. and the mcmc method takes tens of hours even on these small datasets. it also requires a previous specification of the number of ibd groups, or partitions of the individuals where all the individuals in the same partition are ibd with each other. the number of ibd groups needs to be small, such as two or three. this is unrealistic in many cases. what is more, the mcmc method does not take linkage disequilibrium (ld) into account, which is common in the genotype data. to address all the drawbacks of the mcmc method, we developed a method ibd-groupon, which detects group-wise ibd tracts based on pairwise ibd tracts. we first use beagle to detect pairwise ibd tracts, as beagle allows us to adjust a threshold to detect short ibd tracts, with the side effects of obtaining many false-positive ibd tracts. then we construct an hmm to select the most likely group-wise ibd tracts to eliminate false-positive ibd tracts, based on the assumption that the length of a false-positive ibd tract is generally smaller than that of the true positives, and thus false positives generally have lower likelihoods. we also developed a depth first search algorithm, as well as a shortest path algorithm to effectively select the possible values of the states of the hmm such that our method is scalable to large datasets. ibd-groupon does not require any specification of the number of ibd groups and the length of the ibd tracts, which will be detected automatically. using both simulated and real data, we show that our method is not only much more efficient than the mcmc method but also much more accurate, in that it has much lower false-positive rate. and to our knowledge, it is the first practical method that is able to detect group-wise ibd tracts on large datasets, for example, hundreds of individuals with thousands of snps, and in the meanwhile, it does not assume any previous information of the ibd sharing patterns. it also takes ld into consideration, as beagle considers ld for pairwise ibd detection.proposed a method dash that identifies pairwise ibd tracts using germline first and then conducts an iterative minimum cut algorithm to identify densely connected components as ibd clusters. the method cuts the haplotypes into windows, and the min-cut algorithm runs recursively until it identifies a subgraph of desired density or a trivial subgraph that contains no edges to be cut. the idea is similar to ibdgroupon but with the following significant differences: (i) dash takes the density threshold of the subgraphs, as well as the length of the windows as the parameters of input. ibdgroupon uses an hmm to determine the cliques and the length of the identified ibd tracts automatically. (ii) dash identifies the ibd clusters in each window independently. ibdgroupon builds a global probabilistic framework to combine information cross-windows. indeed, dash can be considered as a special case of ibd-groupon where there is one hmm state for each window but with one value for each state. we show in our experiments that compared with dash, not only ibd-groupon requires no parameter tuning but also it produces more accurate results. and the two methods have similar execution time.in this work, we proposed an efficient method ibd-groupon to detect group-wise ibds in multiple individuals simultaneously based on pairwise ibd relationships. an hmm is created, and the values of the states are efficiently generated using depth first search and shortest path algorithms. our method is the first practical method to handle large data sets with hundreds of individuals and thousands of snps, and in the meanwhile, has good performance for both long and short group-wise ibd tracts. it is shown that our method is not only much more efficient but also reports much fewer false positives than thenote: the top-100 values are saved for each state. we only consider pairwise ibd tracts. threshold for beagle is 10e-8 and for ibd-groupon is 10e-4.  
