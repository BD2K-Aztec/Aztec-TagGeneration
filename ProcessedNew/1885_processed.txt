sequence analysis fr-hit, a very fast program to recruit metagenomic reads to homologous reference genomes fragment recruitment, a process of aligning sequencing reads to reference genomes, is a crucial step in metagenomic data analysis. the available sequence alignment programs are either slow or insufficient for recruiting metagenomic reads. we implemented an efficient algorithm, fr-hit, for fragment recruitment. we applied fr-hit and several other tools including blastn, megablast, blat, last, ssaha2, soap2, bwa and bwa-sw to recruit four metagenomic datasets from different type of sequencers. on average, fr-hit and blastn recruited significantly more reads than other programs, while fr-hit is about two orders of magnitude faster than blastn. fr-hit is slower than the fastest soap2, bwa and bwa-sw, but it recruited 15 times more reads. availability: http://weizhongli-lab.org/frhit.metagenomic data provide a more comprehensive picture for our understanding of the microbial world. an important step of such understanding is to compare the raw sequencing reads against the available microbial genomes to analyze the phylogenetic composition, genes and functions of the samples. such a procedure, referred to as fragment recruitment, was introduced in the global ocean sampling (gos) metagenomics study . sequences from metagenomic samples exhibit great differences from the available genomes. although there are thousands of available complete microbial genomes, they hardly cover the broad and diverse species in many metagenomic samples. a typical metagenomic dataset may have hundreds or thousands of species, and many of them are novel. therefore, it is critical for fragment recruitment methods to align reads to homologous genomes. in the gos study, blast was used for fragment recruitment. however, it is too slow to handle large datasets. the explosion of next-generation sequencing data stimulated the development of new mapping programs, such as soap , bowtie , bwa and many others. these programs are several orders of magnitude times faster than blast, but they can only identify very stringent similarities that tolerate only a few to whom correspondence should be addressed. mismatches and gaps. so these mapping programs are insufficient for fragment recruitment. the slightly slower programs like blat , ssaha2 and last can recruit more reads than the mapping programs, but their fragment recruiting capacities are still limited. in this article, we present a new fragment recruitment method, fr-hit. given reference genomes, metagenomic reads and sequence identity and alignment length cutoffs, the goal of fr-hit is to align the most reads to references with minimal computational time.we applied fr-hit on four metagenomic datasets and compared it with blastn, megablast, soap2, bwa, bwa-sw, ssaha2, blat and last. the first dataset has 1 million 75 bp illumina reads from metahit sample mh0006 . the other three datasets are from 454 gs20, gsflx and titanium platforms, with 688 590, 288 735 and 502 399 reads, respectively. their average lengths are 99, 233 and 345 bp, respectively. the gs20 and gsflx datasets were downloaded from camera under ids scums_smpl_arctic and bats_smpl_174-2. the titanium data were from ncbi under accession srr029691. for the illumina dataset, we used the 194 human gut genomes from metahit study as reference. for the 454 datasets, we used the 1985 completed bacterial genome sequences downloaded from ncbi in april 2010 as references. the two reference databases are 1.139 and 3.823 gb in size. a read is considered recruited if it is aligned to a reference with 30 bp and 80 identity. such cutoffs represent a basic need for fragment recruitment, to recruit more reads and to prevent obviously spurious hits. more discussions and examples of parameters are available in supplementary material. parameters of all the programs are listed in supplementary table s2. the cpu time and the number of recruited reads are shown inand supplementary. fr-hits results with different parameters are provided in supplementary table s4. on average, fr-hit and blastn recruited significantly more reads than other programs, fr-hit is 2 orders of magnitude faster than blastn. fr-hit is slower than the fastest mapping programs soap2, bwa and bwa-sw, but it recruited 15 times more reads. in these tests, fr-hit shows better recruitment rate and speed than ssaha2. fr-hit is slightly slower than megablast, blat and last, but it recruited much more reads than them. using the illumina data as an example, blastn recruited 475 584 reads in 7168 min. soap2 used 1.5 min, but only recruited 141 417 reads. fr-hit recruited 523 868 reads in 45 min. metagenomic data contain many novel species, so 4964 of reads cannot be recruited by fr-hit. due to the use of overlapping k-mers, fr-hit needs more memory than other programs. it used 4 and 8 gb for the two reference databases in these tests.  
