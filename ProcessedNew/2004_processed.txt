genome analysis genome annotation test with validation on transcription start site and chip-seq for pol-ii binding data motivation: many chip-seq experiments are aimed at developing gold standards for determining the locations of various genomic features such as transcription start or transcription factor binding sites on the whole genome. many such pioneering experiments lack rigorous testing methods and adequate gold standard annotations to compare against as they themselves are the most reliable source of empirical data available. to overcome this problem, we propose a self-consistency test whereby a dataset is tested against itself. it relies on a supervised machine learning style protocol for in silico annotation of a genome and accuracy estimation to guarantee, at least, self-consistency. results: the main results use a novel performance metric (a calibrated precision) in order to assess and compare the robustness of the proposed supervised learning method across different test sets. as a proof of principle, we applied the whole protocol to two recent chip-seq encode datasets of stat1 and pol-ii binding sites. stat1 is benchmarked against in silico detection of binding sites using available position weight matrices. pol-ii, the main focus of this paper, is benchmarked against 17 algorithms for the closely related and well-studied problem of in silico transcription start site (tss) prediction. our results also demonstrate the feasibility of in silico genome annotation extension with encouraging results from a small portion of annotated genome to the remainder. availability: available from http://www.genomics.the recent advances in microarray technologies (tiling arrays, snp arrays, etc.) and more recently in high-throughput sequencing [next-generation sequencing (ngs)] allows for more complete genome-wide annotation of functional sites. the rapid increase in the data volumes has put pressure on the development of data analysis techniques capable of coping with large volumes of data that can reliably extract relevant knowledge. this article analyses and benchmarks techniques introduced inbased on supervised learning and the generalization capabilities of predictive models that are trained on part of the genome and tested to whom correspondence should be addressed. on the remainder. our approach consists of dividing the genome into small tiles and then allocating a binary label to each tile according to the observed phenomenon (e.g. the presence of a transcription factor binding site within the tile). a model is then trained on a portion of the genome to predict the labels from the dna content of tiles and then tested on the whole genome. the prediction accuracy is then used to assess the properties of the assay. there are many interesting phenomena which can be analysed by this approach and we will now focus on two key examples:(1) a quality test for chip-seq experiment: we first discuss a quality test for chip-seq experiments when there is no (independent) gold standard to assess the final results. in the paper by, we compared a few sets of putative peaks for stat1 and pol-ii binding sites generated by various analysis methods applied to the chipseq experimental data of. as the gold standards provided by the encode project were extracted from the same experimental data and their putative peaks were a part of our comparative study, an independent and objective way of evaluating the various lists of peaks was required.introduced a consistency benchmark: for each list of putative peaks ordered by the allocated p-values, a model was trained using only chromosome 22 to predict the overlap of a tile with a peak from the tiles dna content. the model was then applied to the whole genome and its predictions compared with the list of putative peaks. the lists, and the peak calling algorithms generating them, that provided more consistent (accurate) predictions deemed to be more accurate. significant differences in the peak calling algorithms were observed. the article is linked directly to those methods developed by, for both pol-ii and stat1, but here the focus is mainly on predicting pol-ii.(2) an extension of annotation: a critical hurdle in the way to full mechanistic interpretation of genetic data is extending the annotation of the human genome such that every regulatory sequence in the genome is identified along with known disease-associated genetic variations and changes. the analysis of the transcriptome by ngs methods generates novel genomic expression landscapes, state-specific expression, single-nucleotide polymorphisms (snps), the transcriptional activity of repeat elements and both known and new alternative splicing events. these all have an impact on current models of key signalling pathways ... suggesting thatpage: 1611 16101617in section 3.13.4 below, we cover the main experiments with detection of pol-ii binding and in silico tss detection. in section 3.5, we outline additional experiments with chip-seq data for transcription factor stat1.in this article, we aimed to demonstrate that chip-seq results can be used to develop robust predictors by training on a small part of the annotated genome and then testing on the remainder, primarily for the purpose of cross-checking the consistency of the chip-seq results and also for novel genome annotation. as a proof of principle, we have chosen two encode chip-seq datasets for binding of the transcription factor stat1 and the pol-ii complex. stat1 experiments have shown that rsv models are superior in learning global patterns compared with standard pwm-based approaches. for pol-ii, where pwms are not applicable, we have compared against the best-of-class in silico tss predictors arts as tss is closely related to pol-ii binding. though arts is our focus as a baseline, we also benchmarked against 16 other specialized algorithms using the methods of. our predictors are created by a generic algorithm and not a tss specific procedure page: 1616 16101617with customized problem-specific input features; for instance, we do not take into account the directionality of the strands, which may improve performance, as such information is not available from empirical chip-seq data. nevertheless, we have demonstrated that the lack of such information does not prevent the development of accurate classifiers on-par with dedicated tools such as arts at the 500 bp resolution. for our aim of developing a generic and robust technique for genome annotation, arts, originally intended for higher 50 bp resolution, is too specialized and overly complex; indeed, arts uses five different sophisticated kernelsi.e. custom-developed techniques for feature extraction from dna neighbourhood of 1000 bp around the site of interest. this includes two spectrum kernels comparing the k-mer composition of dna upstream (the promoter region) and down stream of the tss, the complicated weighted degree kernel to evaluate the neighbouring dna composition, and two kernels capturing the spatial dna configuration (twisting angles and stacking energies). consequently, arts is very costly to train and run: it takes 350 cpu hours (, sec. 3.1) to train and scan the whole genome. furthermore, for training the labels are very carefully chosen and cross-checked in order to avoid misleading clues (, sec. 4.1). in contrast, our generic approach is intended to be applied to novel and less-studied dna properties, thus we do not assume the availability of prior knowledge. consequently, our model uses only standard and generic genomic features and all available labelled examples in the training set. it uses only a 137-dimensional, 4merbased vector of frequencies in a single 500 bp tile, which is further simplified using feature selection to 80 dimensions. this approach is generic and the training and evaluation is accomplished within 4 cpu hours (we stress again that as stated in section 3.1, for the sake of fairness, we have used not only chip-seq trained rsv models, but also two different models rsv rfg and rsv ex , which are trained using refgene annotations only, which were used for training arts. however, while arts used all refgene annotations available in hg16 resulting in n + = 8.5k positive and n = 85k negative examples, we have used a much smaller training set, namely the sites residing on chromosome 22. in the case of rsv ex , which is by design the closest to the annotation used in the original arts publication , this results in only n + = 1k positive and n = 12k negative examples, which is more than seven times less than arts training used. yet, as we see inand 2, the performance of arts and rsv ex tested against refgeneex annotations are virtually equivalent. the same equivalent performance was seen testing rsv rfg on our refgene annotation for hg18. finally, note that model interpretation is very feasible as our rsv models are linear combinations of simple k-mer frequencies. this creates the potential for novel insights into the molecular mechanisms underpinning the phenomena of interest. we have not yet explored the utility of model interpretation but consider it an important area for future research. we have found that the roc do not discriminate well between the performance of different predictors with high precision, which inevitably occurs for low recall (0.5). similar features are shown by the roc curves infor the high specificity regions. thus, roc and auroc are not informative for genomewide scans under highly unbalanced class sizes . the same applies to enrichment scores and consequently kolmogorovsmirnov statistic (see the section 6 in supplementary materials ). one curious point of note is the sharp decline in precision that can be observed as recall 0 in. this can only be caused by the most confidently predicted samples being negatively labelled. one hypothesis is that these are in fact incorrectly labelled true positives. support for this may be that the decline is not observable when using the exon-restricted negative examples in. this hypothesis has been confirmed by testing for human and mouse against annotations by (un-clustered) cage tags and is the focus of a follow-up paper. one of the most intriguing outcomes is the very good performance of the rsv po2 predictor in the tests on the refgene and refgeneex datasets and also on the benchmark of. after all, the rsv po2 was trained on data derived from broad chip-seq peak ranges on chromosome 22 only. this chip-seq data (rozowsky page: 1617 16101617) was derived from hela s3 cells (an immortalized cervical cancer-derived cell line) which differ from normal human cells. those peaks should cover most of the tss regions but, presumably, are also subjected to other confounding phenomena [e.g. pol-ii stalling sites (. in spite of such confounding information, the training algorithm was capable of creating models distilling the positions of the carefully curated and reasonably localized tss sites in refgene. this warrants a follow-up investigation, which we intend to conduct in the near future.  
