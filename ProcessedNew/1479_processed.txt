dr.seq: a quality control and analysis pipeline for droplet sequencing motivation: drop-seq has recently emerged as a powerful technology to analyze gene expression from thousands of individual cells simultaneously. currently, drop-seq technology requires refinement and quality control (qc) steps are critical for such data analysis. there is a strong need for a convenient and comprehensive approach to obtain dedicated qc and to determine the relationships between cells for ultra-high-dimensional datasets. results: we developed dr.seq, a qc and analysis pipeline for drop-seq data. by applying this pipeline , dr.seq provides four groups of qc measurements for given drop-seq data, including reads level, bulk-cell level, individual-cell level and cell-clustering level qc. we assessed dr.seq on simulated and published drop-seq data. both assessments exhibit reliable results. overall, dr.seq is a comprehensive qc and analysis pipeline designed for drop-seq data that is easily extended to other droplet-based data types.in recent years, the advances of rna-seq technology have allowed single-cell rna-seq (scrna-seq) to emerge as a powerful and popular technique to study the cell-to-cell expression variability of thousands genes . however, the time and cost constraints of preparing libraries from many individual cells have prevented scrna-seq for more broad applications. recently, drop-seq and indrop, two new, easy, fast and low-cost technologies to quickly profile thousands of individual cells for rna-seq, have been developed . as both technologies are based on the combination of dropletbased microfluid and individual-cell barcode approaches, and their data structures are largely similar, we termed both technologies as drop-seq in this study. drop-seq only requires 12 h to prepare 10 000 single-cell libraries for sequencing . the breakthrough of this technology provides many applications, such as the deconstruction of a cell population, the detection of rare cell types and the inference of interactions between genes. however, drop-seq technology still suffers from some restrictions. currently, the mrna capture rate, conversion efficiency and sequencing depth are not sufficient to cover thousands of genes from a large fraction of cells, leading to increased levels of noise, which can influence the interpretation of drop-seq data. therefore, quality control (qc) should be the first step in the analysis pipeline to assure the data quality and to provide a solid basis for subsequent analysis. although there are already some qc algorithms for bulk rna-seq and scrna-seq data, a qc pipeline specifically for drop-seq data is still necessary given the low capture efficiency, high dimensionality and sequenced cell number. here, we presentdr.seq, an integrated drop-seq qc and analysis pipeline. dr.seq can systematically evaluate drop-seq data quality together with the visualization of unsupervised cell clustering.the dr.seq qc and analysis pipeline uses two paired sequencing files (fastq or sam format) as input. one file contains transcript information, and the other contains cell barcode and umi information. the transcript-sequencing file was aligned to the reference genome, and the mapped reads with high sequencing quality were kept. dr.seq provides four groups of qc measurements (supplementary methods): (i) reads level qc including quality, nucleotide composition and gc content of the reads. (ii) bulk-cell level qc including gene body coverage and reads alignment summary (supplementary). (iii) individual-cell level qc including the distributions of reads duplicate rate, intron reads rate and covered gene number in selected stamps, for the evaluation of mrna capture efficiency at individual-cell level (supplementary). (iv) cell-clustering level qc including gap statistics and silhouette score for the evaluation of the sample heterogeneity (supplementary figs s3a and s3b). in addition to a qc report document describing the above qc measurements, dr.seq also generated a series of analysis results, including: (i) expression index, (ii) paired-wise correlation table, (iii) pca and t-sne dimensional reduction output, (iv) cluster assignment for selected stamps and (v) visualization of t-sne and clustering output (supplementary, supplementary methods). to evaluate the performance of our pipeline, we simulated drop-seq data from 10 cell types by sampling reads from bulk-cell rna-seq data in 10 human cell lines (supplementary). to assess the performance of cell clustering on the tolerance of low sequencing depth and small cell number in certain cell types, we simulated drop-seq data with different sequencing depths per cell and different numbers of individual cells in certain cell types, respectively (supplementary methods in supplementary file 1). to estimate the stability of cell clustering, goodman-kruskals lambda index was conducted to compare the clustering results with predefined cell type labels. dr.seq showed reliable cell clustering results with 1000 or more reads per cell and 20 or more individual cells per cell type (supplementary). we applied dr.seq on published drop-seq data in mouse retinal cells , and obtained a multifaceted and detailed qc reports (supplementary file 2) together with a series of analysis results. the running time of each qc and analysis step of dr.seq was also displayed (supplementary).in summary, dr.seq is specifically designed for qc and analysis of drop-seq data. it takes standard-format input files via simple commands, reports informative qc measurements from four levels, and provides detailed analysis results. it also displays tolerance of low sequencing depth and small cell number in certain cell types. besides, dr.seq has the potential to be easily extended to other droplet-based data types, such as drop-chip .dr.seq  
