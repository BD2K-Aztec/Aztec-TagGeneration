optimal design of gene knockout experiments for gene regulatory network inference motivation: we addressed the problem of inferring gene regulatory network (grn) from gene expression data of knockout (ko) experiments. this inference is known to be underdetermined and the grn is not identifiable from data. past studies have shown that suboptimal design of experiments (doe) contributes significantly to the identifiability issue of biological networks, including grns. however, optimizing doe has received much less attention than developing methods for grn inference. results: we developed reduction of uncertain edges (reduce) algorithm for finding the optimal gene ko experiment for inferring directed graphs (digraphs) of grns. reduce employed ensemble inference to define uncertain gene interactions that could not be verified by prior data. the optimal experiment corresponds to the maximum number of uncertain interactions that could be verified by the resulting data. for this purpose, we introduced the concept of edge separatoid which gave a list of nodes (genes) that upon their removal would allow the verification of a particular gene interaction. finally, we proposed a procedure that iterates over performing ko experiments , ensemble update and optimal doe. the case studies including the inference of escherichia coli grn and dream 4 100-gene grns, demonstrated the efficacy of the iterative grn inference. in comparison to systematic kos, reduce could provide much higher information return per gene ko experiment and consequently more accurate grn estimates. conclusions: reduce represents an enabling tool for tackling the underdetermined grn inference. along with advances in gene deletion and automation technology, the iterative procedure brings an efficient and fully automated grn inference closer to reality. availability and implementation: matlab and python scripts of reduce are available on www.cabsel.ethz.ch/tools/reduce.gene regulatory networks (grns) describe the regulatory interactions among genes in a cell, i.e. how the transcription of one gene is regulated by those of the others. such networks are often described as a directed graph with nodes representing genes and edges representing gene regulations. perturbations to the grn in a cell, for example because of gene mutations, could lead to changes in the gene expression profile and correspondingly in the cellular phenotype. the understanding of genegene interactions and their pathological alterations could shed light on the mechanism underlying genetic diseases such as cancer. for this reason, the inference of grns has garnered much attention in systems biology. further fueled by the ever-growing public databases of gene expression profiles, hundreds of algorithms have been developed for inferring grns from such data. these methods borrow and extend techniques from different fields, such as statistics, machine learning and systems model identification. despite the large number of available methods, the inference of grn from gene expression data still remains unsolved to date. the crux of the problem is the underdetermined nature of this inference, leading to the lack of network identifiability or inferability . this issue often leads to the existence of multiple equivalent solutions to the inference problem, i.e. there exist a family of network graphs that are consistent with the available expression data. we recently developed an ensemble inference algorithm called transitive reduction and closure ensemble (trace) with the goal of generating an ensemble of digraphs that are consistent with a given gene knockout (ko) dataset (ud). more specifically, trace produces upper and lower bound digraphs of the ensemble where any network in the ensemble is a subgraph of the upper bound and a supergraph of the lower bound. edges in the upper bound that are missing from the lower bound are deemed uncertain as these edges could not be verified by the provided data. the grn is therefore inferable when there exists no uncertain edges (i.e. the upper and lower bounds meet). using trace, we demonstrated that systematic ko experiments such as performing single-gene kos (skos) and double-gene kos (dkos) is a strongly suboptimal strategy for inferring grn (ud). the attention given to designing experiments for grn inference pales in comparison to developing inference methods. only a handful of strategies having been proposed previously. for example,proposed an optimization of perturbation experiments for a boolean model of acyclic grns using minimum set cover.formulated a heuristic strategy of ranking gene perturbations where genes with weaker differential expression or those associated with more uncertain interactions are more likely selected for kos. meanwhile,employed an evolutionary strategy to create an ensemble of s-system models of grn. the design of experiments (doe) involved performing virtual gene kos using the model ensemble and choosing the most informative ko experiment. on the other hand,developed a doe strategy based on bayesian linear regression with a sparse prior distribution of the grn, where experiments were selected according to the possible information gain. more recently,proposed a doe strategy for cellular reaction networks based on selecting a set of measurements, using which low confidence reactions are isolated in disjoint subnetworks or modules. finally,used a graph theory concept called node cut-sets or vertex separators, to formulate a systematic procedure for inferring grn digraphs. briefly, the strategy involves systematically knocking out the vertex separators of gene pairs with an indirect regulation, i.e. gene pair i and j where gene i regulates gene j through other gene(s). the authors showed theoretically that the inference of acyclic grn with n genes would require on gene ko experiments, while those with cycles would need on 2 experiments. in this work, we developed an algorithm called reduction of uncertain edges (reduce) for selecting the optimal gene ko experiment based on an ensemble of grns, particularly using the upper and lower bounds of the ensemble. reduce was formulated as a constrained optimization problem to maximize the number of uncertain edges that could potentially be verified. we introduced the concept of edge separatoid, similar to vertex separators, as the basis to count the number of possible edge verification associated with a given gene ko combination. finally, we proposed an iterative procedure for the grn inference, in which the upper and lower bounds of the ensemble are continually updated during iterations of wet-lab ko experiments and dry-lab optimal doe using reduce. as a proof of concept, we applied the iterative procedure to infer the grn of e.coli under ideal conditions. we further demonstrated the efficacy of reduce using benchmark gene expression simulator genenetweaver (gnw) in the inference of five 100-gene gold standard networks from dream 4 in silico network inference challenge . we compared the performance of the iterative inference with performing systematic ko experiments.in this section, we demonstrate the performance of reduce by applying the iterative procedure into three case studies, involving 100-gene random scale-free networks under ideal conditions, e.coli grn under ideal conditions and five 100-gene gold standard grns from dream 4 challenge using gnw data . as the starting point, we assume that the complete set of sko experiments have been performed. we used trace to construct the initial g u and g l from the expression data from sko. note that in this case g u,0 is the accessibility matrix of g ;. for the 100-gene dream 4 grns, we employed gnw for the data generation using the same settings as in the challenge. in the implementation of reduce, we used ga with a population size of 100 and a maximum generation of 50, which we found to give a good balance between finding globally optimal solution and reducing computational cost. all other ga optimization parameters were set to the default values (see supplementary information).in this work, we developed a method called reduce for optimizing gene ko experiments for the purpose of inferring grn digraphs. the method builds on the ensemble inference of grns using gene expression data (ud). in particular, reduce uses the upper and lower bounds of an ensemble of grns to find the optimal set of gene kos which would potentially reduce the most number of uncertain edges. we further proposed an iterative procedure which cycled over performing gene ko experiments, updating ensemble bounds and optimizing gene ko by reduce. as a proof of principle, we successfully applied the iterative procedure to infer the grn of e.coli under ideal conditions (no data noise, infinite sensitivity). the iterative inference could converge to the true grn, whereas performing all combinations of dkos or dkos based on ad pairing could not despite the larger number of experiments. using benchmark data generator and 100-gene gold standard networks of dream 4 challenge, the proposed iterative inference procedure could significantly outperform dko experiments providing informative data, as judged by network distances from the true grns. in particular, the iterative procedure could converge to a unique digraph with a lower td than the ensemble bounds from the complete set of dko experiments, while using 12 orders of magnitude fewer experiments. for roughly the same number of experiments, dko experiments based on ad pairing led to verifications of fewer uncertain edges and much larger tds from the gold standard network. we recommend implementing the iterative inference procedure using a gradual increase of ko genes, i.e. starting with n(v ko ) 1 and increasing n(v ko ) when reduce could not find any feasible solution. such a strategy is preferred because knocking out a large number of genes simultaneously could be detrimental to cell viability. as shown in, even with limiting the number of ko genes to no more than three (v ko with at most two genes), the iterative procedure could verify a large fraction (93) of the uncertain edges in e.coli grn. also, in practice one would not necessarilyoptimal design of gene knockout experimentswant to carry out the iterations until completion (e.g. due to budget constraint). here, reduce will still prove to be useful in maximizing the information return per ko experiment. for the 100-gene networks in dream 4 challenge, the iterative procedure produced a unique digraph (i.e. g u and g l converge) but the inferred grn deviated from the true grn. here, errors in the input upper and lower bounds contributed significantly (79) to the total errors in the final grns (i.e. the majority of the errors were not due to reduce). fns dominated over fps (86 of errors were fn). we further noted that on average, 90 of the fns were associated with fan-in motifs where a gene was regulated by two or more genes. the inference of such motif from steady-state gene ko data is fundamentally challenging because perturbing one of the regulators may not lead to any differential expression of the target gene due to compensatory effects. meanwhile, the remaining errors were not associated with any particular network motifs. since errors in the initial input to reduce were not included in the set of uncertain edges, the iterative inference could therefore not correct these errors. the issue of fn above could be addressed by considering other types of data, for example time-series gene expression data and transcription factor binding sites. when considering time-series data, we ideally need (i) fast sampling to capture transient changes in the expression of target genes and (ii) slow compensation by other regulators. meanwhile, if the binding sites of transcription factors are known (see for example fantom project), one could then construct a transcriptional regulatory network. any edges in the transitive closure of this transcriptional network which do not appear in the input upper bound, are possible fns and should be added to the upper bound. beside the fn issue, a recent study demonstrated that the ordering of gene deletions acea and pgi in e.coli could influence cells transcriptomic profiles . in the analysis of the data from this study (supplementary data file), we found that the order of deleting the two genes affected the expression of 53 out of 4690 genes (at false discovery rate 5). furthermore, gene acea showed a differential expression upon deleting gene pgi, suggesting that acea is accessible from pgi. however, pgi was not differentially expressed in the ko of acea. consequently, by analyzing the differential expression of dko dpgi and dacea in the background of dacea, we should be able to verify edges emanating from pgi to all genes that are accessible from both pgi and acea. among the verifiable edges satisfying the condition above (ignoring antisense transcripts), the transcriptomic discrepancy between deleting dacea-then-dpgi and dpgi-then-dacea did not cause any difference in the verification outcomes of these edges (0 out of 3). nevertheless, the influence of the order of gene deletions demonstrated in the above study could complicate the grn inference, which future does and network inference algorithms would need to address. the initial ensemble bounds for the iterative procedure in the case studies came from applying trace to expression data of sko experiments. if the transcription factor genes are known a priori, then trace requires only the sko data of each transcription factor gene to construct the initial upper and lower bounds of the grn ensemble. beside using trace, one could also construct the initial upper and lower bounds of the ensemble from prior knowledge. when the members of the initial ensemble are known a priori, the upper and lower bounds could be constructed by taking the union and intersection of the members, respectively. for example, one could obtain the initial ensemble from the grn predictions using different network inference algorithms, following the idea of wisdom of crowds . when observational data (as opposed to ko data) are available, one could also construct a markov equivalence class, for example using pc algorithm . the markov equivalence class represents the ensemble of dags encoding the same independence and conditional relationships that result from a bayesian network learning using such data. again, the upper and lower bound could be constructed by taking the union and intersection of the dags in this equivalence class.  
