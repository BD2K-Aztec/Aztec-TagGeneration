genetics and population analysis mtg2: an efficient algorithm for multivariate linear mixed model analysis based on genomic information we have developed an algorithm for genetic analysis of complex traits using genome-wide snps in a linear mixed model framework. compared to current standard reml software based on the mixed model equation, our method is substantially faster. the advantage is largest when there is only a single genetic covariance structure. the method is particularly useful for multivariate analysis, including multi-trait models and random regression models for studying reaction norms. we applied our proposed method to publicly available mice and human data and discuss the advantages and limitations. availability and implementation: mtg2 is available in https://sites.google.com/site/honglee0707/previously, methods were developed to estimate genetic variance and genetic correlations between complex traits explained by genome-wide snps using linear mixed models . as genetic relatedness among (conventionally) unrelated subjects could be estimated based on genomic information, which replaces family studies with population studies, the model allows estimation of the genetic effects to be much less confounded with family environmental effects. for this same reason, the approach has also been proposed as a more powerful tool to detect genotype environment interaction (g e) . that is, in the presence of g e, the genetic correlation between genetic effects in different environments is significantly lower than one . in order to capture g e across a trajectory of multiple environments, random regression models have been proposed for evolutionary and livestock genetics . the random regression model is also known as the reaction norm model . in estimating genetic variance explained by genetic markers, lee and van der werf (2006) introduced an efficient average information (ai) algorithm to obtain residual maximum likelihood (reml) estimates. as opposed to using hendersons mixed model equation (mme) the algorithm was based on using the variance covariance matrix of phenotypic observations directly, hence the term direct ai algorithm. the algorithm is particularly advantageous when using a dense covariance matrix, such as the genomic relationship matrix (grm), and with a large number of multiple variance components. the direct ai algorithm has been implemented in gcta-greml and multiblup that have been widely used in human, evolutionary and livestock genetics. here, we combine the direct ai algorithm with an eigen-decomposition of the grm, as first proposed by. we apply the procedure to analysis of real data with univariate, multivariate and random regression linear mixed models with a single genetic covariance structure, and demonstrate that the computational v c the author 2016. published by oxford university press.when using the heterogeneous mice data (n 1908) for the multivariate linear mixed model with up to five traits, mtg2 only took afor mtg2 and gemma, it took $4 s for the eigen-decomposition, which is only required to be done once per dataset then can then be reused for multiple analyses. a gemma does not have a function for the random regression model.there are two main limitations to mtg2 as well as gemma. the eigen-decomposition technique cannot be used with more than one grm as also noted by zhou and stephens (2014) unless a special condition is satisfied, i.e. one full-rank grm and multiple low-rank grms are provided . in models with multiple grms, gemma cannot be used and mtg2 becomes slow although it is still considerably faster than asreml and wombat (supplementary). second, the eigen-decomposition technique requires a balanced design (i.e. no missing phenotypes across traits). phenotypic imputation can be used for missing phenotypic values. in this work, we used imputed missing phenotypes for the mice data (10 missing for each trait), although mtg2 without the eigen-decompostion could still be used for the data, including the missing values. we observed that the results from the data with and without the imputed missing phenotypes were not very different (supplementary table s2 and). for the human data, missing phenotypes were less than 1, therefore the results with and without the imputed missing phenotypes were almost identical (results not shown). finally, both mtg2 and wombat are able to facilitate a parallel computation that further raises efficiency.  
