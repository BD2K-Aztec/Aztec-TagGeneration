genome analysis an effective statistical evaluation of chipseq dataset similarity motivation: chipseq is rapidly becoming a common technique for investigating proteindna interactions. however, results from individual experiments provide a limited understanding of chromatin structure, as various chromatin factors cooperate in complex ways to orchestrate transcription. in order to quantify chromtain interactions, it is thus necessary to devise a robust similarity metric applicable to chipseq data. unfortunately, moving past simple overlap calculations to give statistically rigorous comparisons of chipseq datasets often involves arbitrary choices of distance metrics, with significance being estimated by computationally intensive permutation tests whose statistical power may be sensitive to non-biological experimental and post-processing variation. results: we show that it is in fact possible to compare chipseq datasets through the efficient computation of exact p-values for proximity. our method is insensitive to non-biological variation in datasets such as peak width, and can rigorously model peak location biases by evaluating similarity conditioned on a restricted set of genomic regions (such as mappable genome or promoter regions). applying our method to the well-studied dataset of chen et al. (2008), we elucidate novel interactions which conform well with our biological understanding. by comparing chipseq data in an asymmetric way, we are able to observe clear interaction differences between cofactors such as p300 and factors that bind dna directly. availability: source code is available for download atwith the advent of genome sequencing, a central question of genome biology concerns how genetic instructions in the genome translate into biochemical states of a cell, and how completely different cellular phenotypes can arise from the same genetic background. in particular, how do the various histone modifications, transcription factors and other chromatin proteins orchestrate a particular transcriptional profile? sequencing technology now makes it possible to map the location of the various chromatin proteins with great precision. chipseq to whom correspondence should be addressed. studies can thoroughly characterize the binding sites of transcription factors, giving a global view of the genes they regulate, making the identification of specific binding motifs much easier, and uncovering previously uncharacterized variation . chipseq has also been used to profile histone modifications, increasing our understanding of the role of such modifications in transcription and differentiation as well as allowing for the discovery of novel genes not detected by other methods . ultimately, a complete understanding of chromatin organization must involve not only actual characterization of the locations of individual chromatin proteins but also an understanding of how they interact with each other to regulate transcription. gene regulations in metazoan organisms can be quite complex, with transcription factors interacting combinatorially with each other as well as with histone modifications and the various chromatin modifiers . although chipseq experiments hold the promise of investigating these effects on a system-wide level, suitable methods of analysis are still being developed [e.g.. an initial step in building genome-wide understanding of chromatin organization is developing methods that infer biologically meaningful co-occurrence of chromatin components from a series of chipseq experiments. the simplest approach to this problem [used in (is to compute the total overlap of peakenrichment regions from different experiments. while this method has a strong intuitive basis, it has several limitations. one problem simply concerns the variability in size of enrichment regions: transcription factors appear as distinct punctate peaks, for example, while chromatin modifications produce broad enrichment regions . moreover, general variations in peak distribution (such as peak length, peak number, etc.) can arise anywhere in the experimental pipeline, as well as in subsequent data processing, making direct comparisons between datasets, especially those produced by different protocols, difficult . more recently, statistical methods to assess co-occurrence have been proposed. these methods involve the computation of some metric of similarity between datasets such as correlation , number of clustered transcription factors , distance-based measures , etc., and then the estimation of the probability the observed metric would occur by chance, either by simulation or analytically using bounds from parametric models .by using the threshold-based summary statistic, we can visualize an all-against-all comparison of thedata .while our method is similar in principle to overlap-based statistics, the results differ significantly from overlap (supplementary). the general similarity structure produced by our analysis agrees well with previous studies . two main clusters emerge, one composed of c-myc, n-myc, e2f1, zfx and klf4, and the second composed of nanog, sox2, p300, oct4 and smad1. however, there are some notable differences from the previous studies. for example, since our method performs an asymmetric comparison, we observe some one-sided interactions. in particular, all interactions involving p300 are highly asymmetric, implying that while p300 co-occurs with many other factors, the reverse associations are much weaker. the natural interpretation of such asymmetric interactions is that one factor (p300) binds to a subset of genomic locations of another (oct4, sox2, etc.). in the case of p300, the pattern of asymmetric interactions with many other factors is indicative of its co-factor function as p300 does not bind dna on its own but is recruited by other dna binding proteins . another result particular to our analysis is that while nanog is tightly associated with the sox2, oct4, p300 cluster, by far its strongest association is with smad1. while nanog has been shown to co-occur in proteins complexes with oct4 , smad1 is the only factor in this dataset that has been shown experimentally to interact directly with nanog . the interaction serves to block bone morphogenetic protein (bmp) induced differentiation that is meditated by smad1. the smad1nanog interaction is also highly asymmetric, so that smad1 co-occurs with nanog more often than nanog co-occurs with smad1. this pattern indicates that the nanogsmad1 interaction occurs at a subset of nanogs genomic locations and is consistent with nanog having diverse roles in stem cell maintenance that page: 613 607613involves both activation and repression of target genes . overall, the complete interaction pattern presents a hierarchical structure depicted as a directional interaction graph in. in particular, the second cluster (nanog, sox2, p300, oct) interacts more strongly with the first (c-myc, n-myc, e2f1, zfx, klf4) than vice versa, indicating a subset relationship. this global hierarchical pattern is consistent with the first cluster being more broadly distributed and having a more general role, as several of the proteins in this cluster are involved in proliferation and have important roles outside embryonic stem cells . on the other hand, the factors in cluster 2 (nanog, sox2, oct4) have a more restricted distribution and are considered to be specific markers of pluripotency . we have developed a method for chipseq comparisons that is statistically rigorous, yet fully transparent and thus intuitive to biology researchers. in particular, our method makes simple assumptions and does not rely on any numerical optimizations or permutation tests; our ability to observe uniform p-value distributions in simulated and non-interacting real datasets lends confidence to our predictions for real data. our method naturally extends to the concept of conditional similarity making it easy to investigate how general biases in genomic locations of chromatin factors affect the perceived clustering among them. the transparency of our method should aid in its adoption in the general biology community as the output is very easy to interpret. for every query interval, our method produces the closest reference interval, the distance between them and the corresponding numerator, denominator and p-value, making it easy to trace the results back to the proximity events in the original data.  
