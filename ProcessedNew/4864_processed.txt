genetics and population analysis virvarseq: a low-frequency virus variant detection pipeline for illumina sequencing using adaptive base-calling accuracy filtering motivation: in virology, massively parallel sequencing (mps) opens many opportunities for studying viral quasi-species, e.g. in hiv-1-and hcv-infected patients. this is essential for understanding pathways to resistance, which can substantially improve treatment. although mps platforms allow in-depth characterization of sequence variation, their measurements still involve substantial technical noise. for illumina sequencing, single base substitutions are the main error source and impede powerful assessment of low-frequency mutations. fortunately, base calls are complemented with quality scores (qs) that are useful for differentiating errors from the real low-frequency mutations. results: a variant calling tool, q-cpileup, is proposed, which exploits the qs of nucleotides in a filtering strategy to increase specificity. the tool is imbedded in an open-source pipeline, virvarseq, which allows variant calling starting from fastq files. using both plasmid mixtures and clinical samples, we show that q-cpileup is able to reduce the number of false-positive findings. the filtering strategy is adaptive and provides an optimized threshold for individual samples in each sequencing run. additionally, linkage information is kept between single-nucleotide polymorphisms as variants are called at the codon level. this enables virologists to have an immediate biological interpretation of the reported variants with respect to their antiviral drug responses. a comparison with existing snp caller tools reveals that calling variants at the codon level with q-cpileup results in an outstanding sensitivity while maintaining a good specificity for variants with frequencies down to 0.5.rna viruses such as hiv-1 and hcv exist in their host as complex populations composed of several closely related subgroups. they are referred to as quasi-species and originate from high and error-prone replication rates . this heterogeneous mixture of genomes allows a viral population to rapidly adapt to changing environments. the fittest mutants outcompete the others, allowing the virus to develop resistance to antiviral therapy. the characterization of sequence variation within the viral population is key for understanding pathways to resistance, but the identification of low-frequency variants remains challenging . until recently, the genetic diversity of a virus population could be assessed only through genotyping by sanger sequencing, which provides information on only the most abundant viral variants. massively parallel sequencing technologies allow for a more in-depth characterization of sequence variation, including low-frequency viral strains. however, their measurements still involve substantial technical noise, complicating the analysis . pyrosequencing, commercialized by roche 454, was the most common sequencing method for viral population sequencing . the recent announcement by roche to retract the 454 technology from the market by mid-2016 illustrates the pressing need to evaluate and implement alternative technologies. recently illuminas sequencing technique has strengthened its position in this field (thys et al., manuscript under review). illumina also complements the sequenced nucleotides with quality scores (qs) that reflect the basecalling substitution error probability. the 454 qs, however, do not have such an intuitive interpretation . filtering based on qs has already proven valuable to reduce false-positive findings. it often involves the use of a hard quality threshold. unfortunately, this does not account for variation in quality between runs resulting in too stringent or too relaxed thresholds. most variant calling tools focus on the detection of single-nucleotide polymorphisms (snps) or perform haplotype reconstruction . haplotype assembly has to whom correspondence should be addressed. its weakness in the detection of low-frequency variants , whereas the latter is our main interest. instead, we prefer to call variants within the read length to avoid challenges encountered in the haplotype reconstruction. on the other hand, linkage between the nucleotides is lost when calling variants at the snp level. in this contribution, we introduce a novel strategy for calling variants at the codon level (nucleotide triplets), which facilitates immediate biological interpretations, particularly in virology applications where drug target regions are of interest. in this article, we present an innovative approach for variant calling at the codon level, named q-cpileup, that reduces the number of false-positive findings by exploiting the qs of the nucleotides generated by sequencing. our thresholding strategy is adaptive to provide an optimized threshold for individual samples in each sequencing run. q-cpileup is imbedded in a pipeline, called virvarseq, which starts from fastq files.many sequence variant identification tools have been described in literature to call variants at the snp level. most approaches are tailored to call snps in human resequencing projects where snps can be either heterologous (50) or homologous (100). however, in viral deep sequencing projects, the snp frequency can vary between 100 and 0, whereas snps present in 51 of the reads also may be of interest. further, our main focus is the detection of drugresistant variants for which a specific drug-target region has to be investigated. hence, it would be beneficial to report variants at the codon level per amino acid position to enable an immediate biological interpretation of the variants with respect to their antiviral drug responses. variant calling tools used by the virologists in this research field are either not fully described in-house tools (noguera-julian et al., 2013) or build based on snps at the dna or rna level only. in the latter case, one needs to retrieve the linkage information between the neighboring nucleotides to deduce effects at the coded amino acid level. this process is not always straightforward. some of the variant callers developed for viral population sequencing have add-on tools, like v-profiler for v-phaser , to convert the list of snps to a list of codon variants. however, these are mainly developed for 454 data. none of the available tools reports the variants immediately at the codon level. therefore, q-cpileup was initially developed and imbedded in a pipeline. by taking the weakest link as a representative for the quality of the codon, the filtering remains at the individual nucleotide level but reporting is done at the codon level. the approach is adaptive to allow for differences in quality between the runs. the intersection point between the distributions of the errors and reliable calls is suggested as a threshold (qit). however, other criteria could also be considered. for instance, the number of false discoveries can be controlled by defining the qit as a certain quantile of the reliable call component distribution. by using the 5 quantile as a qit, 5 of the codons, which are truly present in the population, are falsely considered as being errors. this statement relies heavily on the interpretation of the distributions as errors and reliable calls. however, the three-component mixture distribution should be considered only as a working assumption. moreover, it is impossible to check the actual interpretation of the mixture distributions. hence, the interpretation of the different components as error and reliable calls cannot always be warranted, particularly when low qs are underrepresented. therefore, we advise users to assess the distribution plots as diagnostic tools to critically judge whether the chosen threshold is acceptable and/or meaningful. instead of applying hard filtering with a qit, as suggested in this article, the posterior probabilities of the reliable call distribution could be used. the counts of a codon at a particular position can be weighted with these probabilities. by doing so, codons with a low q will have a low contribution in the final frequency estimates. hence, data are not filtered but weighted with the probabilities of being truly present in the reliable codon population. this method also relies on the interpretation of the different component distributions as error distribution and reliable call distribution. importantly, we have shown that the filtering strategy using hard threshold qit is robust to runs where the distributions deviate from the working assumption. the impact on the final codon table frequencies was minimal. overall, our proposed filtering strategy controls the false-positive rate at reasonable levels with no false discoveries above a reporting limit of 1. the noise is effectively reduced while retaining the reliable calls even at low frequency. this suggests that the reporting limit of detection at 1 could be lowered, although distinguishing true variants from error at 0.5 remains challenging. depending on the risk one is willing to take to include a small number of false-positive findings, either one of the cutoffs can be used. more importantly, q-cpileup shows a splendid sensitivity that could not be achieved by the snp callers while maintaining a good specificity for variants with frequencies down to 0.5. this sensitivity will allow further investigation of the reported variants above one of the cutoffs defined by the specificity to search for resistance-associated mutations, or in the next step to monitor drug resistance and guide treatment (dierynck et al., submitted for publication). currently, the clinical cutoff is not yet defined for minority drugresistant virus variants, and it is still a subject of open debate . some studies have found no significant association between the presence of low-frequency variants and subsequent virological failure, whereas others report clear correlations . the availability of methods that detect low-frequency variants at the codon level with high sensitivity and good specificity can help in defining the clinical benefit of low-frequency resistance testing.a variant calling tool is proposed for identifying true variants at the codon level within a viral population using illumina sequencing. the variants are filtered using base-calling qs for reducing false-positive findings. the lowest q of the three nucleotides of the codon is taken as representative for the codon. an adaptive strategy is developed to provide an optimized threshold for individual samples in each sequencing run. the intersection point of the component distributions of the mixture is suggested as a valuable threshold, qit. codons with a q below this threshold are not reported. the robustness against deviations of the working assumption justifies the utilities of our method for low-and high-quality sequencing runs. it is shown that the generated filtered codon table is reporting far fewer false-positive findings compared with the codon table based on the raw data. moreover, virvarseq has a superb sensitivity compared with existing snp callers while maintaining a good specificity for codon variants with frequencies down to 0.5. this suggests that the current reporting limit of detection at 1 can even be lowered. the tool is implemented in a userfriendly open-source pipeline, virvarseq, which allows virologists to call variants at the codon level starting from the fastq files.  
