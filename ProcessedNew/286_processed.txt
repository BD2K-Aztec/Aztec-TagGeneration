analysis of nanopore data using hidden markov models motivation: nanopore-based sequencing techniques can reconstruct properties of biosequences by analyzing the sequence-dependent ionic current steps produced as biomolecules pass through a pore. typically this involves alignment of new data to a reference, where both reference construction and alignment have been performed by hand. results: we propose an automated method for aligning nanopore data to a reference through the use of hidden markov models. several features that arise from prior processing steps and from the class of enzyme used can be simply incorporated into the model. previously, the m2mspa nanopore was shown to be sensitive enough to distinguish between cytosine, methylcytosine and hydroxymethylcytosine. we validated our automated methodology on a subset of that data by automatically calculating an error rate for the distinction between the three cytosine variants and show that the automated methodology produces a 23 error rate, lower than the 10 error rate from previous manual segmentation and alignment. availability and implementation: the data, output, scripts and tutorials replicating the analysis are available at https://github.com/ucscnanopore/data/tree/master/automation.the use of hidden markov models (hmms) in analyzing biosequence data is widespread and is the backbone of such services as pfam, tmhmm and sam-t08 . these services use hmms to identify regions of interest in observed sequences. briefly, hmms model a sequence family with emission probabilities for each possible base or amino acid at each position of a reference. hmms can perform an alignment between an observed sequence and the reference and can allow for features such as insertions or deletions compared with the reference . this hmm methodology can be extended to analyze nanopore data, which is ionic current sampled at a high frequency instead of a sequence of characters . the ionic current is the flux of ions through a tiny hole (the nanopore) in an insulating barrier as a voltage is applied.when biomolecules pass through the nanopore, they block the passage of ions, causing characteristic drops of ionic current . more recently, both single-nucleotide resolution and discrimination of three epigenetic variants of cytosine have been achieved by using u29 dnap to mediate the movement of dna through a m2mspa nanopore. the ionic current can be processed into segments, which summarize the ionic current while a dna molecule is held in a particular position within the nanopore by u29 dnap (j. schreiber and k. karplus, submitted for publication). each segment, instead of representing each nucleotide individually, is influenced by a number of adjacent nucleotides which correspond to the length of the narrowest region of the pore. for the pore m2mspa, the word length is approximately four nucleotides.an important task in the use of nanopore devices is decoding the sequence of segments into information about the underlying biosequence that generated it, which is complicated because the dna motor is not a perfect stepper motor and the segmentation algorithm is not perfect. however, the combined behavior of the enzyme, nanopore and signal processing can be modeled with a somewhat more complicated hmm than the simple profile hmms usually used in protein and dna sequence modeling. the hmm presented here is specific to using u29 dnap with an m2mspa pore and using our current segmentation algorithm. different classes of enzymes may have different features that need to be modeled, and different segmenters may have different rates of over-or undersegmentation. we propose an automated way to align nanopore data to a reference model using this hmm. we validate this approach using a three-class classification problem, in which the strands contain either a single cytosine (c), methylcytosine (mc) or hydroxymethylcytosine (hmc) in an otherwise-identical sequence. these single cytosine variants have been shown to produce different ionic current levels as they pass through the nanopore . hand analysis of data from the dna molecules tested in this article resulted in a classification error rate of approximately 10 . we show that this error rate can be reduced to 23 using our automated methodology on a small dataset.the complexities of nanopore data have made hand curation of data popular, leading to questions of unconscious bias in data selection.. the expected number of deletions, insertions, backslips and undersegmentations in each position across the hmm. each value is calculated by summing the transition matrix calculated using the forward-backward algorithm for each respective state in each module in the hmm. three phenomena of note are (i) the spike of inserts at position 9, indicating either our need to include another state or a location that the enzyme is likely to stall briefly at, (ii) the spike of backslips at position 17 followed by increased deletes at positions 18 and 19, indicating that the observed sequences had a slight preference to align to states before position 17 than positions 18 or 19 and (iii) the general uptick of these occurrences at the end of the sequence, indicating that the end of the strand may be ambiguous due to variable dissociation times. soft call accuracy measurements using the trained model on testing data. (a) the mcsc accuracy and filter scores are shown plotted for each event, ordered by their filter score. the mcsc accuracy represents the accuracy expected using events with this filter score or higher. as more events are included, the accuracy goes down. the top 26 of events (to the left of the red line) give 98 accuracy. (b) soft call accuracy for each event is plotted, sorted by the filter score just as in (a). only a few events have a soft call accuracy between 0 and 1, and sorting by filter score gives good discrimination between events with high accuracy and those with low accuracy. the orange line is the rolling mean using a 31-event window with 15 events on each side and indicates the expected soft call accuracy of events with that filter score  
