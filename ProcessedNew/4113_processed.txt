sans: high-throughput retrieval of protein sequences allowing 50% mismatches motivation: the genomic era in molecular biology has brought on a rapidly widening gap between the amount of sequence data and first-hand experimental characterization of proteins. fortunately, the theory of evolution provides a simple solution: functional and structural information can be transferred between homologous proteins. sequence similarity searching followed by k-nearest neighbor classification is the most widely used tool to predict the function or structure of anonymous gene products that come out of genome sequencing projects. results: we present a novel word filter, suffix array neighborhood search (sans), to identify protein sequence similarities in the range of 50100 identity with sensitivity comparable to blast and 10 times the speed of usearch. in contrast to these previous approaches, the complexity of the search is proportional only to the length of the query sequence and independent of database size, enabling fast searching and functional annotation into the future despite rapidly expanding databases. availability and implementation: the software is freely available to non-commercial users from our website http://ekhidna.biocenter. helsinki.fi/downloads/sans. contact: liisa.holm@helsinki.fi.k-nearest neighbor classifiers are used widely and successfully to infer the function of newly sequenced proteins. neighbors are commonly determined by sequence comparison. protein sequence databases have grown so large that retrieving the neighbors of a query sequence is prohibitive in the exact mode and takes 12 min using popular heuristics. with several thousand proteins in each new genome, blasting consumes considerable resources in contemporary bioinformatics research. strategies for database searching fall into five categories: 1. all versus all pairwise comparisons using exact alignment [e.g. ssearch (or generating fast approximate alignments [e.g. fasta (. 2. comparison against a representative subset rather than all proteins (e.g.;3. comparison against a library of profile models of protein families (e.g.). to whom correspondence should be addressed.the speed of the methods increases toward the bottom of the list. usearch is orders of magnitude faster than blast, and we report here a novel method which is 10 times faster than usearch. the fast methods are based on word filters. conserved amino acids are often clumped in homologous protein sequences so that there is a good probability of finding identical k-mers . many practical tools combine word filters with explicit alignment of a filtered subset of the database . very short words obviously occur by chance in unrelated sequences. unique occurrences are expected when 20 k is greater than the size of the database, k being the length of the word. on the other hand, the sensitivity of a word filter decreases with longer words. spaced (k,l)-seeds are a special class of word filters with length l and the selectivity of a k-mer . we show experimentally that k = 6 is the sweet spot with respect to the current uniprot database and that sensitivity/selectivity drop either side of this value. the choice of k is thus critical for the performance of a word filter. in this work, we test a novel idea which dynamically adjusts word size. it is based on suffixes (substrings starting at position i in a sequence and continuing to the terminator). a suffix array is a data structure which orders the suffixes of a text (protein sequence database) in lexicographic order. neighboring suffixes share the longest common prefixes. the suffix array is a onedimensional representation of sequence space. our idea is to select a window around a query suffix from the suffix array to identify neighbors. the suffix array neighborhood has a constant size. in contrast, neighborhoods defined in terms of k-mer word vectors grow larger as the database grows larger. suffix arrays are used a lot in the analysis of nucleotide sequences (short read mapping, contig assembly, genome alignment, est clustering) (e.g.). the analysis of protein sequences differs from that of nucleotide sequences in that the range of interesting similarities extends to much higher levels of mismatches. suffix trees/arrays and related indices have been used previously to organize , search and align protein sequences, but they have not supplanted popular tools like blast. this article is organized as follows. we present comprehensive benchmark tests using real-world data from metagenome samples (6 million proteins), a bacterial genome (4000 proteins) and the uniprot database (18 million proteins). we compare blast, usearch and many variants of word filters. we characterize. a classification of approaches used by representative application programs for protein sequence retrieval. this work focuses on word filters based on suffix arrays or k-mer counting. related approaches or data structures are shown in gray and not expanded. sans is simple and fast but has a limited application range. other fast programs calculate explicit alignments for a filtered subset of database proteins. ssearch calculates the optimal alignment between the query and all database proteins the feasible regime for word filters and report the fastest known mapping tool for proteins. finally, we discuss potential applications in function inference .  
