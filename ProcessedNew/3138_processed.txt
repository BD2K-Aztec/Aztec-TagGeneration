mugsy: fast multiple alignment of closely related whole genomes motivation: the relative ease and low cost of current generation sequencing technologies has led to a dramatic increase in the number of sequenced genomes for species across the tree of life. this increasing volume of data requires tools that can quickly compare multiple whole-genome sequences, millions of base pairs in length, to aid in the study of populations, pan-genomes, and genome evolution. results: we present a new multiple alignment tool for whole genomes named mugsy. mugsy is computationally efficient and can align 31 streptococcus pneumoniae genomes in less than 2 hours producing alignments that compare favorably to other tools. mugsy is also the fastest program evaluated for the multiple alignment of assembled human chromosome sequences from four individuals. mugsy does not require a reference sequence, can align mixtures of assembled draft and completed genome data, and is robust in identifying a rich complement of genetic variation including duplications, rearrangements, and large-scale gain and loss of sequence. availability: mugsy is free, open-source software available from http://mugsy.sf.net.there are numerous sequenced genomes from organisms spanning across the tree of life. this number of genomes is expected to continue to grow dramatically in coming years due to advances in sequencing technologies and decreasing costs. for particular populations of interest, many individual genomes will be sequenced to study genetic diversity. the cancer genome atlas, 1000 genomes project and the personal genome project will generate genome sequences from at least several thousand people. for bacterial genomes, there are already over one thousand complete bacterial genomes in public databases. often, a pan-genome concept is needed to describe a species or population , requiring multiple sequenced genomes from the same species. there are already nine bacterial species with ten or more sequenced genomes in a recent version of refseq. hundreds of individual sequenced genomes are expected for some medically relevant to whom correspondence should be addressed. species and model organisms, such as escherichia coli. many of these genomes will be in the form of draft genomes, where the sequencing reads are assembled into numerous contigs that together represent a fraction of the actual genome, but are incomplete and contain physical sequencing gaps. in order to make use of this explosive growth in the number of sequenced genomes, the scientific community requires tools that can quickly compare large numbers of long and highly similar sequences from whole genomes. whole-genome alignment has become instrumental for studying genome evolution and genetic diversity . there are a number of whole-genome alignment tools that can align multiple whole genomes . whole-genome alignment tools are distinguished from collinear multiple sequence alignment tools, such as tools of , in that they can align very long sequences, millions of base pairs in length, detecting the presence of rearrangements, duplications, and large-scale sequence gain and loss. the resulting alignments can be utilized to build phylogenies, determine orthology, find recently duplicated regions, and identify species-specific dna. for divergent sequences, alignment accuracy is difficult to assess and popular methods can disagree, such was demonstrated by the relatively low level of agreement between outputs for the encode regions . given the difficulties in assessing accuracy, recent development has included methods that are statistically motivated and show improved specificity . at shorter evolutionary distances with large fractions of identical sequences, there is less ambiguity in alignment outcomes. yet, even within a bacterial species, aligning multiple genomes is not a trivial task, especially if the sequences contain rearrangements, duplications and exhibit sequence gain and loss. also, despite relatively short chromosome lengths for bacteria, typically a few million base pairs, the computational complexity of multiple sequence alignment makes it a formidable challenge. calculation of multiple alignments with a simple sum of pairs scoring scheme is known to be an np-hard problem , which makes calculation of an exact solution infeasible for large inputs. multiple genome alignment tools rely on heuristics to achieve reasonable run times. there are numerous methods to compare a single pair of wholegenome sequences . the nucmer and mummer package is a fast whole-genome alignment method that utilizes a suffix tree to seed an alignment with maximal unique matches (mums) . the suffix tree implementation of mummer is especially efficient and can be bothwe introduce mugsy, a new multiple whole-genome alignment tool that does not require a reference genome and can align mixtures of complete and draft genomes. using current generation sequencing technologies, a majority of newly sequenced genomes are expected to be draft genomes represented by multiple contigs after assembly. mugsy can identify sequence conservation and variation in any subset of these inputs. the primary advantage of mugsy over similar tools is speed. mugsy is able to align 57 e.coli genomes (299 mb) in 1 day on a single cpu and 31 s.pneumoniae genomes in 2 h. mugsy was also the fastest tool evaluated for the alignment of four assembled human chromosomes, completing the lcb identification and multiple alignment in 1 h provided a library of pairwise alignments. mugsy and tba were the only tools evaluated that completed alignments of four human chromosomes and 57 e.coli genomes in 2 days of processing time on a single cpu. on smaller datasets of closely related genomes, we found agreement between alignments generated by mugsy, mauve and tba. the primary difference was the number and boundaries of the aligned regions. our work relies heavily on two open source software packages, the suffix tree-based pairwise aligner nucmer and the segment-based alignment approach of seqan::tcoffee . we utilized nucmer to quickly build a library of pairwise homology across all input genomes. our work extends methods in seqan::tcoffee to accommodate wholegenome multiple alignment with rearrangements and duplications. mugsy implements a new procedure that identifies lcbs. the graph utilized for the lcb identification and segment-based multiple alignment is compact for highly conserved sequences allowing for efficient computation. this makes mugsy especially well suited to classification of species pan-genomes and other intra-species comparisons where there is a high degree of sequence conservation. alignment of many large, highly conserved sequences, such as human chromosomes, is likely to become increasingly popular as improvements in sequencing and assembly technologies allow for de-novo assembly of human genomes, including assembly of haplotypes. mugsy relies on a number of parameters including minimum mum length in nucmer and the lcb chaining parameters. careful choice of parameters is likely to be important for alignments at longer evolutionary distances. automatically determining parameters or providing user guidance on parameter choice is an area that needs improvement. also, for more divergent genomes, the performance advantages of the segment-based alignment approach decrease as the length of the conserved segments shorten and the size of the alignment graph grows. the alignment of 57 e.coli strains required slightly 12 gb of ram to build and process the alignment graph. the larger memory requirement of mugsy on more divergent genomes is a limitation of the tool and an area that we may be able to improve at the expense of longer runtimes. as biologists continue to explore the rich genetic diversity of the biosphere, thousands of genomes may soon be available for some species and the ability to read genetic information is outpacing the speed at which we can analyze the data for meaningful relationships. mugsy attempts to address this performance gap but additional algorithm development is needed. the alignment of hundreds or more even relatively small bacterial genomes remains a formidable challenge and may limit the use of the growing amounts of whole-genome data by biologists. as desktop computers are now commonly available with multiple cpus, parallel processing using multiple cpus is a readily available technique to improve runtimes. the pairwise alignment phase of mugsy and multiple alignment of each lcb are easily parallelized and well suited to run on multicpu cores or compute clusters. we plan to extend mugsy to support parallel processing to enable alignment of even larger datasets. whole-genome alignment incorporates sequence identity and synteny and is well suited to aiding annotation of orthologous genes and pan-genomes. we also plan to add support for deriving these features from the output of whole-genome alignments as future work.  
