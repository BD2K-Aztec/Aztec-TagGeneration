sequence analysis nonpareil: a redundancy-based approach to assess the level of coverage in metagenomic datasets motivation: determining the fraction of the diversity within a microbial community sampled and the amount of sequencing required to cover the total diversity represent challenging issues for metagenomics studies. owing to these limitations, central ecological questions with respect to the global distribution of microbes and the functional diversity of their communities cannot be robustly assessed. results: we introduce nonpareil, a method to estimate and project coverage in metagenomes. nonpareil does not rely on high-quality assemblies, operational taxonomic unit calling or comprehensive reference databases; thus, it is broadly applicable to metagenomic studies. application of nonpareil on available metagenomic datasets provided estimates on the relative complexity of soil, freshwater and human microbiome communities, and suggested that $200 gb of sequencing data are required for 95 abundance-weighted average coverage of the soil communities analyzed.metagenomics have provided important new insights into the diversity, dynamics and functional potential of natural microbial communities during the past decade, but several critical issues remain unresolved. many metagenomic surveys to date have sampled only a small fraction of the total community dna; this is particularly the case for soil and sediment communities. furthermore, the amount of sequencing required to cover the whole community remains speculative . the fraction of the genomes recovered in a sequencing dataset is termed coverage (supplementary box s1), and depends on the sequencing effort applied and the diversity of the community. when the coverage of a metagenome is unknown, results and conclusions about species richness, the evenness of the corresponding community, differences between communities and the extent and importance of rare community members are limited. moreover, differences between sequencing technologies and continuously changing sequence read lengths make it challenging to establish a universal approach for coverage estimation. determining the total number of unique species or operational taxonomic units (otus) present in a sample is frequently challenging due to the unknown number of non-sampled species and requires either complete coverage or knowledge of the species abundance curve, which typically remains elusive. the coverage achieved by a dataset can be calculated more efficiently, as it does not depend on a priori knowledge of the species abundance curve, and can be directly related to assembly quality . the level of coverage is typically assessed by identifying and counting otus and generating rarefaction curves . empirical and analytical models have also been applied to coverage estimation using read binning if assembly is not limiting or by targeting specific taxa when genome size and abundance are known. however, these approaches and their variations require either the use of a reference genome database or the clustering of reads in contigs or otus. the former is severely limited by the shortage of representative genome sequences from most habitats . the latter is limited by the quality of the assemblies, especially for highly complex communities, and the use of genes that are much more conserved than the genome average to be sufficiently similar to allow clustering of reads in otus such as the ribosomal rna genes. these genes, however, are known to miss important levels of ecological differentiation among closely related, yet distinct, otus . therefore, a method to estimate the coverage of a metagenomic dataset that is applicable to communities of varied diversity and does not depend on the quality of the assembly and the completeness of reference databases is highly desirable. here we introduce nonpareil (having no match or equal, referring to the count of unmatched reads in a dataset), a novel method that aims to fulfill this critical gap in contemporary metagenomic research. nonpareil examines the degree of overlap among individual sequence reads of a whole-genome shotgun (wgs) metagenome to compute the fraction of reads with no match, which is used to estimate the abundance-weighted average coverage (i.e. not the arithmetic mean based on all species in the sample but the average when the abundance of species is considered). subsequently, it fits a projection line to the estimated values to determine the amount of sequencing required for almost complete diversity coverage. the fraction of unmatched to whom correspondence should be addressed. the author 2013. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.com elements in a given subset of a finite collection (singletons in clustering terms) can be used to efficiently estimate the coverage of the collection, i.e. the fraction of the collection captured in the subset . this observation has been previously applied to metagenomic datasets to estimate species richness , functional coverage and coverage of gene amplicons based on ribosomal rna or other individual genes. to the best of our knowledge, nonpareil is the first method directly applying this concept to the whole-genome level, without using reference markers. further, we propose that nonpareil projection curves serve as a semi-quantitative proxy to the diversity of the communities. this feature is explored to rank natural communities in terms of the degree of their diversity.nonpareil curves were calculated for 143 short-read simulated metagenomes of various size and diversity levels, generated from publicly available bacterial genomes. nonpareil estimates of the average coverage of each metagenome correlated strongly (pearsons r 2 0.93, n 126) with the independently calculated coverage values based on the known composition of each metagenome. further, the amount of sequencing that was required to nearly cover the total diversity predicted by nonpareil (abundance-weighted average coverage of 95 for the genomes in the sample) corresponded tightly to the actual values for each metagenome (supplementaryand s2 and supplementary; pearsons r 2 40.65). the estimated abundanceweighted average coverage may also serve as an indicator for the expected quality of the metagenome assembly. although several factors other than the coverage are critical for assembly, our results show that the average coverage provides a lowerbound estimation of the fraction of assembled reads (supplementary), while the assembly n50 of samples with coverage below 60 rarely surpasses twice the read length for illumina datasets (supplementary). it is important to note that the precision of the algorithm was reduced at values of redundancy lower than 1 and higher than 90. these values approximately correspond to50.01x and 4400x sequencing depth, respectively (supplementary). because datasets with lower sequencing depth than 0.01x (i.e. too few sequences obtained) are strongly influenced by random variability and thereby subject to spurious results, nonpareil estimates are not reliable at this range and such datasets are flagged accordingly in the output of the algorithm. conversely, datasets with sequencing depth above maximum saturation (4400x) are best assessed by read recruitment (mapping), as high-quality assemblies should be achievable in these cases.  
