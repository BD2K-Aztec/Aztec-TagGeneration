phylogenetic analysis of multiprobe fluorescence in situ hybridization data from tumor cell populations motivation: development and progression of solid tumors can be attributed to a process of mutations, which typically includes changes in the number of copies of genes or genomic regions. although comparisons of cells within single tumors show extensive heterogeneity, recurring features of their evolutionary process may be discerned by comparing multiple regions or cells of a tumor. a useful source of data for studying likely progression of individual tumors is fluorescence in situ hybridization (fish), which allows one to count copy numbers of several genes in hundreds of single cells. novel algorithms for interpreting such data phylogenetically are needed, however, to reconstruct likely evolutionary trajectories from states of single cells and facilitate analysis of tumor evolution. results: in this article, we develop phylogenetic methods to infer likely models of tumor progression using fish copy number data and apply them to a study of fish data from two cancer types. statistical analyses of topological characteristics of the tree-based model provide insights into likely tumor progression pathways consistent with the prior literature. furthermore, tree statistics from the resulting phyloge-nies can be used as features for prediction methods. this results in improved accuracy, relative to unstructured gene copy number data, at predicting tumor state and future metastasis. availability: source code for software that does fish tree building (fishtrees) and the data on cervical and breast cancer examined hererecent studies of genetic variation in solid tumors have revealed massive intratumor heterogeneity in the spectrum of genomic changes within single tumors . these observations suggest the importance of understanding cell-to-cell variability, but profiling large numbers of single cells and building coherent models of their evolution remain challenging problems. fluoresence in situ hybridization (fish) is a technique that can be used to count the copy number of dna probes for specific genes or chromosomal regions that has proven useful in studying cancer. gene gains and losses are common in solid tumors, and fish provides a practical and reliable method for monitoring such changes in large numbers of individual cells from single tumors . fish is even more useful when one uses multiple colors to monitor multiple genes simultaneously . in this article, we developed new methods to model and analyze the progression of copy number changes, as measured by multi-color fish. our methods include analysis of multiple samples from the same patient, typically from different cancer stages. we applied the new methods to published data on cervical cancer with four gene probes and breast cancer with eight gene probes . the data for each sample are presented as a matrix, where each column is one of the probes and each row is a cell count pattern of four probe counts, such as 2,3,4,1 (or eight counts for breast cancer), and the number of cells matching that pattern. a normal cell has the count pattern of all 2s. both datasets include paired samples from an earlier stage and a later stage in the same patient. it is of interest to study cervical and breast cancer, as we do, because the number of cases of cervical cancer and breast cancer diagnosed early has increased owing to pap smears and mammograms, respectively. early diagnosis is important because lymph node metastasis is one of the best predictors of poor outcome . paradoxically, it has been shown statistically that early diagnosis of breast cancer has not led to a substantial decrease in deaths because most of the cancers diagnosed early would not progress to be life-threatening if left untreated . these are large-scale studies that do not address the benefits of early detection in individual cases. therefore, a consistent explanation of these findings is that earlier detection could be of clinical value if there were a better understanding of tumor evolution to help identify the early-stage cancers likely to progress to dangerous forms. the problem of modeling tumor progression has been studied by a variety of techniques and using different kinds of tumor data . several of these methods used techniques from the area of phylogenetics (reviewed by) because of the insight that tumor genomes to whom correspondence should be addressed. the author 2013. published by oxford university press. this is an open access article distributed under the terms of the creative commons attribution non-commercial license (http://creativecommons.org/licenses/ by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. for commercial re-use, please contact journals.permissions@oup.com evolve . most prior studies have used either comparative genome hybridization or sequencing of cell populations, which have the advantage that one can do genome-wide analysis, but the disadvantage that the input data are explicitly or implicitly averaged over many cells of the same tumor. other data types can offer distinct advantages, such as the microsatellite data used by, which can allow some inference of useful population genetic parameters generally difficult to assess with tumor data. fish is the only currently available reliable technique that allows measurements on enough individual cells to model the evolution of substantial intratumor heterogeneity. the disadvantage of fish is that it uses only a small number of preselected markers. only two of the previous studies analyzed fish data . these studies were limited either to two probes or to three probes and coarsely distinguishing only loss (copy number 52), neutral (copy number 2) and gain (copy number 42) . we address a need for new methods capable of handling the larger numbers of cells and probes in recent fish datasets. more specifically, we aim to develop a theoretical foundation for efficient handling of large copy number datasets. toward this goal, we develop theory and algorithms for a model of tumor progression driven by gains and losses associated with fish probes. our methods handle in principle any number of probes and any range of copy numbers 0 through max_copy (default 9). the use of max_copy limits the combinatorial search and hence running time of our methods on inputs where the measured copy numbers exceed this limit. the work is intended to establish a framework capable of giving useful tree inferences on state-of-the-art fish data, which might be extended in future work to handle even harder problem instances and more realistic models of tumor evolution. our contributions include the following:(1) reducing a model of the problem of modeling progression of fish probe cell count patterns to the rectilinear steiner minimum tree (rsmt) problem and thus bringing prior theory on the rsmt problem to bear on the fish phylogeny problem.(2) design and implementation of an exponential-time exact method and a polynomial-time heuristic method to construct trees modeling the progression of cell count patterns.(3) mathematical proof and software implementation of a new inequality that speeds up the rsmt-based computation.(4) definition and evaluation of new test statistics based on the trees computed by our methods. these test statistics give novel insight into the selective pressures in tumor progression, compared with test statistics derived from the cell count patterns alone.(5) definition and evaluation of features based on the tree structures that can be used with machine learning to classify the tumors. for example, we show improved effectiveness at distinguishing the cervical tumors that metastasize from those that do not.in this section, we present the results of experiments to evaluate the utility of tumor phylogeny inference for understanding the developmental processes of these tumor types. we also explore the prognostic value of tumor phylogenies by using them to derive features for classification experiments and comparing to features that do not rely on tree inference. for these experiments, we built tumor progression trees of the cc and bc data using the ploidyless heuristic approach to phylogenetic inference described in methods.shows representative examples of tumor progression trees from the cc dataset.shows a tree inferred from the primary tumor of patient 1 of the cc dataset.shows the tree for the paired metastatic sample from patient 1. the primary stage tree has more nodes and is more balanced and broader in shape compared with the metastatic stage tree. the distinct topologies of the trees may indicate the fact that cells residing in primary and metastatic sites of the tumor face different selective pressures. supplementary figures s4 and s5 show examples of trees inferred from a dcis sample and an idc sample of a patient with id 8 of the bc dataset. the complete set of trees from the cc and bc patients is provided in supplementary section s6.  
