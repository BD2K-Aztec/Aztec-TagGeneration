exims: an improved data analysis pipeline based on a new peak picking method for exploring imaging mass spectrometry data downloaded from motivation: matrix assisted laser desorption ionization-imaging mass spectrometry (maldi-ims) in omics data acquisition generates detailed information about the spatial distribution of molecules in a given biological sample. various data processing methods have been developed for exploring the resultant high volume data. however, most of these methods process data in the spectral domain and do not make the most of the important spatial information available through this technology. therefore, we propose a novel streamlined data analysis pipeline specifically developed for maldi-ims data utilizing significant spatial information for identifying hidden significant molecular distribution patterns in these complex datasets. methods: the proposed unsupervised algorithm uses sliding window normalization (swn) and a new spatial distribution based peak picking method developed based on gray level co-occurrence (gco) matrices followed by clustering of biomolecules. we also use gist descriptors and an improved version of gco matrices to extract features from molecular images and minimum medoid distance to automatically estimate the number of possible groups. results: we evaluated our algorithm using a new maldi-ims metabolomics dataset of a plant (eucalypt) leaf. the algorithm revealed hidden significant molecular distribution patterns in the dataset, which the current component analysis and segmentation map based approaches failed to extract. we further demonstrate the performance of our peak picking method over other traditional approaches by using a publicly available maldi-ims proteomics dataset of a rat brain. although swn did not show any significant improvement as compared with using no normalization, the visual assessment showed an improvement as compared to using the median normalization. availability and implementation: the source code and sample data are freely available at http:// exims.sourceforge.net/.matrix assisted laser desorption ionization-imaging mass spectrometry (maldi-ims) has gained popularity in omic sciences because of its ability to produce detailed spatial information of molecules in a given biological sample. by using a section of a tissue, ims can visualize a wide variety of biomolecules such as proteins, lipids and metabolites . although this technique has been well established in proteomics , the scope of the biological questions that can be addressed through this technology is still limited mainly due to the shortage of streamlined data analysis pipelines.illustrates the typical maldi-ims data acquisition workflow. in general, maldi-ims experiments are performed by thaw mounting a frozen tissue section onto maldi target, a matrix is applied that promotes molecular desorption and ionization, and a spectrum is acquired at each of the defined pixels. that is, for each spatial coordinate of the optical image a mass spectrum is obtained which represents the intensities of ionizable molecules with various mass/charge (m/z) values. therefore, a maldi-ims dataset can be considered as a collection of spectra. moreover, by plotting the intensity values corresponding to one particular m/z value, the intensity image represents the spatial distribution of the corresponding molecule(s). therefore, a maldi-ims dataset can also be considered as a collection of intensity images. biologists are mainly interested in identifying molecules that are differentially distributed (show different abundances) in diverse anatomical regions thus providing valuable information about the living organism under study. usually the maldi-ims datasets are complex and extremely large in size. for example, the eucalypt leaf maldi-fourier transform ion cyclotron resonance-imaging mass spectrometer (fticr-ims) data set, which is explained later in the sub section 2.1.1, includes 6545 pixels (spectra) each of which has $720 peaks resulting in a data set that is $38 gb. therefore, it is difficult and time-consuming to manually extract meaningful information from these datasets. currently, some visualization software packages like biomap, fleximaging, imagequest, datacube explorer, hdi (highdefinition maldi ms imaging), metabolite imager, msireader, scils lab and tissueview have been mainly used on continuous type data sets, where the set of m/z values is the same for all spectra . however, some of them do not support visualization of processed type datasets, where the set of m/z values is different from one spectrum to another . not only these software packages, but also there are many other published supervised and unsupervised methods which have not been implemented as software tools. mainly two unsupervised learning approaches, namely component analysis and spatial segmentation, have been utilized for untargeted analysis of maldi-ims data . several component analysis methods such as principal component analysis (pca), non-negative matrix factorization, maximum autocorrelation factorization and probabilistic latent semantic analysis have been used to uncover the variation present in maldi-ims data . among these methods, pca is the most widely applied algorithm which represents spatial patterns of molecules existing in the imaging dataset in terms of a set of score images. even though the mass spectra do not contain negative intensity values, pca score images can contain negative values which make the interpretation a challenge . a further difficulty is presented when attempting to determine co-localized ion images for each identified pattern. the most commonly used unsupervised data mining approach in maldi-ims is spatial segmentation . in this method, the imaging dataset is represented as a segmentation map, created by grouping spectra based on their similarity, highlighting chemically equivalent regions of the tissue. since the segmentation map is created solely based on mass spectral intensities, without considering their spatial relationships, it does not capture the underlying spatial structure.carried out de-noising of the individual intensity images before clustering spectra in order to improve the segmentation map. however, not all of the spatial relationships between spectra can be extracted through de-noising alone. hierarchical clustering algorithm has been extensively used for clustering mass spectra . however, it performs poorly when dealing with large and noisy imaging datasets. the main weakness of the above unsupervised learning approaches is that they mainly process the dataset in the spectral domain and do not make the most of the important spatial information available through this ims technology. recently, a spatial distribution based peak picking method and a clustering approach have been introduced and they have shown promising results . therefore it is essential to develop a streamlined data analysis pipeline specifically for ims data utilizing the important spatial information available through this ims technology. in this paper, we propose a new data analysis pipeline for revealing hidden significant molecular distribution patterns in maldi-ims data . the proposed algorithm consists of five consecutive main steps: where the first step involves spectra preprocessing. then, sliding window normalization (swn) is used to normalize the spectra and limit the influence of high intensity peaks.third, image de-noising and contrast enhancement are used to improve the visualization of intensity images. fourth, peak picking is performed by processing the individual intensity images. we introduce a new peak picking method based on an improved version of gray level co-occurrence (gco) matrix. it should be noted that, in this context, peak picking denotes the process of identifying molecules with structured spatial distributions; which is different to the standard process of finding peaks in a mass spectrum. finally, intensity images are clustered using the fuzzy c-means clustering algorithm. prior to clustering, gist descriptors and the improved version of gco matrices are used to extract features from individual intensity images, and the number of clusters is automatically estimated using minimum medoid distance. the primary difference between the proposed workflow and the existing spatial segmentation based methods is that after spectra normalization the dataset is considered as a collection of intensity images and the subsequent steps are applied on individual images in order to incorporate the significant spatial information such as pixel positions and the details of the neighbourhood pixels. we used a maldi-ims metabolomics dataset of a eucalypt leaf in order to assess the complete pipeline and a publicly available proteomics dataset of a rat brain to assess our peak picking method.the important steps in the proposed data analysis pipeline are discussed in detail along with the results under sections 3.13.4. we use the data sets described in section 2.1 to further describe the pipeline and to evaluate the performance.  
