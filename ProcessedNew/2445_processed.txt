inferring combined cnv/snp haplotypes from genotype data motivation: copy number variations (cnvs) are increasingly recognized as an substantial source of individual genetic variation, and hence there is a growing interest in investigating the evolutionary history of cnvs as well as their impact on complex disease susceptibility. cnv/snp haplotypes are critical for this research, but although many methods have been proposed for inferring integer copy number, few have been designed for inferring cnv haplotypic phase and none of these are applicable at genome-wide scale. here, we present a method for inferring missing cnv genotypes, predicting cnv allelic configuration and for inferring cnv haplotypic phase from snp/cnv genotype data. our method, implemented in the software polyhap v2.0, is based on a hidden markov model, which models the joint haplotype structure between cnvs and snps. thus, haplotypic phase of cnvs and snps are inferred simultaneously. a sampling algorithm is employed to obtain a measure of confidence/credibility of each estimate. results: we generated diploid phase-known cnvsnp genotype datasets by pairing male x chromosome cnvsnp haplotypes. we show that polyhap provides accurate estimates of missing cnv genotypes, allelic configuration and cnv haplotypic phase on these datasets. we applied our method to a non-simulated dataseta region on chromosome 2 encompassing a short deletion. the results confirm that polyhaps accuracy extends to real-life datasets. availability: our method is implemented in version 2.0 of the polyhap software package and can be downloaded fromcopy number variations (cnvs) are pervasive in the human genome and could play a key role to whom correspondence should be addressed. in human diversity and disease susceptibility . despite this, the population genetics of cnvsand particularly so for duplicationsremain relatively poorly understood. several analytical tools, such as haplotype analysis, which are standard for snp-based population genetics have yet to be modified to be applicable to complex multi-allelic cnvs. several technologies enable high-throughput cnv detection, including array comparative genomic hybridization (acgh) and snp genotyping arrays. many algorithms have been proposed to detect cnv regions and to estimate the integer copy-number (cn) genotypes in each region using these technologies . in particular, using snp genotyping arrays to simultaneously produce estimates of integer cn and snp genotype has become popular, particularly as a means to identify both snps and cnvs associated with disease. cnv association analyses are conducted either on estimates of integer cn genotype , or using normalized continuous intensity data measurements . as a result of intensive genotyping efforts worldwide for genomewide association studies, there are many datasets containing inferred cnv regions, cnv genotypes in these regions, as well as snp genotypes. however, cnvsnp haplotypes are rarely determined in these datasets, due largely to a lack of algorithmic development in this area. hence, haplotype-based approaches that have been shown to be more powerful than single-marker analyses are not fully exploited in cnv association studies. apart from improving the sensitivity of association studies, cnv snp haplotypes are also invaluable for studying the evolutionary history of cnvs. in particular, many techniques for detecting positive selection rely on accurate phasing . similarly, cnvsnp phasing will improve accuracy of estimates of linkage disequilibrium (ld) between snps and cnvs , particularly for multiallelic cnvs. identification of the haplotypic background(s) of a given cnv, will also help to distinguish single versus recurrent deletion/amplification events and will also shed light on the age of the cnv (from the size of the extended haplotype containing the cnv).we have presented a method for inferring haplotypic phase for cnv/snp genotype data among unrelated individuals. our method allows cnv regions and ploidy to vary along the sequence and between the individuals. our program accommodates both cnv and snp genotype data and infers missing genotypes and haplotypic phase for both types of data. our method allows uncertainty in the cn assignment by representing the cnv genotype as a probability distribution over multiple cnv genotypes. it is necessary to first calculate cnv genotypes prior to running our program. in particular, polyhap does not accommodate a continuous measurement in place of the integer cn genotypes. polyhap can includein principlean arbitrary maximum numberthe error bar of each switch error rate is based on a 95 equal-tailed bayesian interval given the prior beta(1/2,1/2). the number on the top of each cell graph represents cns at a pair of heterozygous sites (first digit is the cn at the first site and second is the cn at the second site). of copies. however, as the computational complexity scales roughly as copies 2 for non-internal phasing, and as e copies for internal phasing, meaning that internal phasing is feasible for up to 6 copies, and non-internal for up to 20 copies. similarly, polyhap cannot model complicated structural rearrangements, including inversions and translocations. polyhap requires a pre-defined number of ancestral haplotypes. in this study, we use eight ancestral haplotype states for internal phasing (two cn = 0 and six cn = 1 states) and nine haplotype states for non-internal phasing (one cn = 0, four cn = 1 and four cn = 2 states). we have also tried different numbers of ancestral haplotypes and found that the results are comparable. here, we would suggest using higher number of ancestral haplotypes when dealing with rare variants. the choice of ancestral haplotype number usually does notthe results from the simulation study demonstrate that our program provides accurate estimates of missing genotypes, allele configuration and haplotypic phase for both cnv and snp data. our method gives an imputation error rate 0.09 for imputing missing genotypes with one to four copies of alleles. also, our method provides accurate estimates of allele configurations on a pair of haplotypes, with an error rate 0.19. furthermore, polyhap successfully identified a haplotype comprising a short deletion on chromosome 2. our method gives encouraging results for inferring cnv haplotypic phase over different cns at heterozygous sites. although there are several situations where the switch error rate is 0.3, this might result from rare haplotypes in the dataset, and the accuracy here would be improved by using a larger population sample. also, reliable phase inferences can be distinguished using the uncertainty estimates. in general, a higher certainty rate indicates higher accuracy of the estimate. polyhap outperforms two existing methods for phasing cnv-snp haplotypescnvphaser and mocsphaserin terms of accuracy and capacity of dealing with large-scale datasets. comparing our method with fastphase/beagle for phasing bi-allelic cnv, polyhap is comparable to fastphase and gives more accurate estimates than beagle in most cases of cn transitions. one advantage of our new method over fastphase/beagle for phasing cnvsnp haplotypes is that polyhap is designed for inferring cnvsnp haplotypes and is able to accommodate some properties of cnv that differ from snps and to deal with multi-allelic cnv. our program provides two different levels of cnv phasing non-internal and internal. with internal phasing, the individual is considered as polyploid, and thus the phasing process is similar to that described for polyhap . internal phasing enables inference of the duplicated and original haplotype, but does not say which chromosome copy contains the amplification. noninternal phasing, on the other hand provides information about which chromosome copy contains the cnv, but not the internal structure of duplications. by providing both options, our program enables the researcher to choose a suitable level of phasing for the specific purposes of the study. our method is faster than cnvphaser, and is feasible for genomewide analyses using a computing cluster. the computing time for the french dataset with nine ancestral haplotype states and 10 repetitions of the em-training algorithm (containing 1106 markers on each of 24 individuals) was 0.8 h on a 8 gb computer, while the finnish dataset (containing 2149 markers on each of 347 individuals) took 1.5 h on a 16 gb computer. the computing time increases linearly with the number of markers and individuals. modelling the haplotypic background of cnvs will provide a better understanding of the evolutionary processes affecting cnvs. moreover, it will help us to better model cnvphenotype associationsto make cnvdisease associations more robust by simultaneously identifying the underlying haplotype harbouring the cnv and to disentangle associations between cnvs and phenotype from associations with flanking snps.  
