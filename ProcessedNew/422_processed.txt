sequence analysis a phylogenetic mixture model for the identification of functionally divergent protein residues motivation: to understand the evolution of molecular function within protein families, it is important to identify those amino acid residues responsible for functional divergence; i.e. those sites in a protein family that affect cofactor, protein or substrate binding preferences; affinity; catalysis; flexibility; or folding. type i functional divergence (fd) results from changes in conservation (evolutionary rate) at a site between protein subfamilies, whereas type ii fd occurs when there has been a shift in preferences for different amino acid chemical properties. a variety of methods have been developed for identifying both site types in protein subfamilies, both from phylogenetic and information-theoretic angles. however, evaluation of the performance of these methods has typically relied upon a handful of reasonably well-characterized biological datasets or analyses of a single biological example. while experimental validation of many truly functionally divergent sites (true positives) can be relatively straightforward, determining that particular sites do not contribute to functional divergence (i.e. false positives and true negatives) is much more difficult, resulting in noisy gold standard examples. results: we describe a novel, phylogeny-based functional divergence classifier, fundi. unlike previous approaches, fundi uses a unified mixture model-based approach to detect type i and type ii fd. to assess fundis overall classification performance relative to other methods, we introduce two methods for simulating functionally divergent datasets. we find that the fundi method performs better than several other predictors over a wide variety of simulation conditions.functional divergence in proteins over evolutionary time includes the processes of sub-and neo-functionalization after gene duplication, as well as specialization or loss of functions of proteins in distinct organismal lineages . to whom correspondence should be addressed.two main patterns of functional divergence (fd) at the amino acid residue level have been described in the literature and were classified by) as type i and type ii. in the case of a protein family composed of two subgroups, type i functional divergence is characterized by greater conservation at a site in one subfamily versus the other subfamily, indicating a difference in evolutionary rate between them due to fewer selective constraints in the more rapidly evolving group. for type ii, divergence sequence conservation at a site is observed in both subfamilies, but with a marked preference for different amino acids, generally with very different physicochemical properties in each group. accurate prediction of (fd) residues, also known as specificity determining sites in the case where divergence changes the substrate that is bound , leads to an enhanced understanding of the mechanisms underlying functional diversification. three main approaches have been used for the prediction of fd protein residues that, in broad terms, can be classified as primarily phylogenetic, information theoretic or biophysical. phylogenetic approaches such as evolutionary trace , diverge and various likelihood ratio test/rate shift based tests explicitly take into account a phylogenetic tree that describes the evolutionary relationships among the sequences in the protein family under consideration. in general, phylogenetic methods for fd prediction correlate observed patterns of amino acid substitution at a site in a multiple sequence alignment across subgroups within a phylogenetic tree. local conservation (i.e. within a subgroup on a phylogenetic tree) relative to other sequences reflect probable functional specificity of that subgroup if the degree of conservation is large relative to the overall divergences of the sequences within that subgroup. this general case can be extended to more rigorous statistical models of functional divergence such as the type i and type ii specific prediction methods employed by diverge . in contrast, information-theoretic approaches do not generally explicitly consider the relationship between sequences, only the known or predicted divisions into functional subgroups and perhaps some weighting based on overall sequence distances as in groupsim . these approaches contrast informationtheoretic measures of variation of site profiles within a subgroup to those observed at a site across the whole multiple sequence alignment. these profiles may most commonly be represented by some information-theoretic measure of variability among residuespage: 2656 26552663we investigated and compared the performance of the fundi methods and several other methods for fd site prediction over a range of tree topologies and sizes, identifying particular tree topologies that may prove problematic for prediction of functional divergence. the impact of taxon sampling (recovery of true molecular diversity), length of the branch separating the subtrees and overall tree length was also investigated in order to build a robust picture of the behavior of the various functional divergence prediction algorithms and their performance over phylogenetically diverse data. several programs were selected based on their performance in previous studies (;) as well as their ability to be used in a large-scale testing pipeline. we tested the performance of our own method, fundi (using both qmmraxml and raxml for site log-likelihood calculation), fundi+conswin, speer , groupsim , sequence harmony and multi-relief . both sequence harmony and multi-relief were used as implemented in multi-harmony . these programs represent the top-performing methods as determined by prior studies and include both phylogenetic and informationtheoretic approaches. a likelihood ratio test method for fd detection was also evaluated on both the simulated and real biological datasets. however, as it had poor performance in initial tests we did not do a complete set of analyses (see supplementary materials). eleven two subfamily biological datasets were selected fromand performance was evaluated. the 11 datasets were selected with the requirement that each subfamily had to be phylogenetically distinct and contain a minimum of four taxa per subfamily. the datasets selected feature a broad range in terms of number of taxa and number of fd sites. the performance of most classifiers as measured by auc-roc was very similar, with more variation seen in the auc-pr metrics (supplementary). using the medians of the auc-pr distribution to judge the overall performance, groupsim appeared to have the overall best performance with fundi-conswin and multi-relief as the next best performers in the auc-pr plots. median performance as measured by auc-roc is slightly higher on these 11 biological datasets than that observed under either of the two simulation conditions examined below, but not significantly, except in the case of speer in case of simulated dataset 2. we also compared the performance of the real-value evolutionary trace and difference-et methods here, but due to technical constraints were unable to perform those evaluations on our larger simulated datasets. in simulation set 1 across all 500 datasets, the performances of fundi using either qmmraxml or raxml were highly similar, outperforming all other methods tested as measured by the area under the precisionrecall curve (auc-pr), the area under the roc curve (auc-roc) and the average rank of true positive fd sites . the program groupsim applies a simple windowing method (conswin) for adjusting page: 2659 26552663) to be between 0 and 1 with high scores reflecting a better functional divergence score. for average rank lower median values show increased performance. the methods evaluated in all cases are fundi with qmmraxml, fundi with qmmraxml and the conswin windowing method, fundi with raxml, groupsim, multi-harmony (mr), sequence-harmony (sh) and speer. the 500 datasets were simulated with varying conditions over randomly generated tree topologies. scores of functional divergence based on neighboring residues in the primary sequence (described previously). we applied this same method to the posterior probabilities of functional divergence p(fd) generated by fundi with qmmraxml to see if it yielded an improvement and to ensure that our simulation settings were appropriate for group-sims prediction strategy. fundi+conswin displayed an increase in predictive performance compared with the non-windowed p(fd) scores alone . groupsim was the next best classifier after the three fundi-based methods across all datasets. surprisingly given previous studies , speer appeared to have the lowest performance for all three scoring metrics. the distribution of auc-pr values for fundi was significantly different from the other predictors in all pairwise comparisons by the wilcoxon signed-rank test with a bonferroni correction for multiple comparisons (p 8.8e-16). all other tests were also significantly different from one another with bonferroni corrected p 0.05.  
