gene expression next masigpro: updating masigpro bioconductor package for rna-seq time series motivation: the widespread adoption of rna-seq to quantitatively measure gene expression has increased the scope of sequencing experimental designs to include time-course experiments. masigpro is an r package specifically suited for the analysis of time-course gene expression data, which was developed originally for microarrays and hence was limited in its application to count data. results: we have updated masigpro to support rna-seq time series analysis by introducing generalized linear models in the algorithm to support the modeling of count data while maintaining the traditional functionalities of the package. we show a good performance of the masigpro-glm method in several simulated time-course scenarios and in a real experimental dataset. availability and implementation: the package is freely available under the lgpl license from the bioconductor web site (http://the use of rna-seq for transcriptome profiling as a replacement for microarrays has triggered the development of statistical methods to properly deal with the properties of these types of count-based data. rna-seq measurement of gene expression is based on the number of reads mapped to transcripts, which results in discrete quantities and left-skewed distributions. in contrast, microarray signals are scanned fluorescence intensities, and this translates into continuous and nearly normal expression data. although normality was typically assumed and linear models (lms) were applied to model microarray experiments, other distributions such as poisson and negative binomial (nb) capture better the nature of count data. hence, methods such as edger and deseq updated microarray analysis to rna-seq by incorporating appropriate statistical models, whereas other methodologies were developed specifically for the new technology . moreover, sequencing introduces specific biases to gene expression quantitation and, therefore, dedicated normalization methods exist for rna-seq to correct for sequencing depth, transcript length , gc content and non-uniform transcript distributions . the first rna-seq experiments were still constrained by the relatively high costs of sequencing in comparison with microarrays, which restricted experimental designs to casecontrol studies with low replication. as a consequence, the novel statistical methods mostly addressed this analysis scenario. as the technology became more affordable, other types of designs involving more samples, such as time-course experiments, started to appear. in a time-course study, the dynamics of gene expression are evaluated at different time points after induction by a particular treatment or in relation to development. statistical analysis of time-course data implies the identification of genes that change their expression along time and/or follow a specific expression pattern. masigpro is an r package designed for the analysis of transcriptomics time courses . masigpro models gene expression by polynomial regression and identifies expression changes along one or across several time series by introducing dummy variables in the model. the method progresses in two regression steps: the first one selects genes with non-flat profiles and the second step creates best regression models for each gene to identify specific time or series-associated changes. the package includes several clustering algorithms and visualization tools to group and display genes with the same expression patterns. masigpro has been applied in many different biological settings, such as biomedicine , biotechnology and plant research to cite some, and also has been implemented in several web services and used in combination with multivariate statistics to analyze multifactorial designs or as batch filtering technique . masigpro was developed to treat continuous microarray intensities and applies lms to model gene expression. in this article, we describe the update of masigpro to deal with rna-seq count data by incorporating generalized linear models into the package and allowing a more flexible choice in the reference family distribution. we demonstrate the appropriateness of this adaptation using simulated and real data and compare the method with edger that also accepts time-course designs. to whom correspondence should be addressed. the author 2014. published by oxford university press. this is an open access article distributed under the terms of the creative commons attribution license (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.comparison in this study. the major difference between masigpro and edegr methods is that masigpro is specialized in parameter estimation of serial data, i.e. when the independent variable is quantitative such as time. this is achieved by providing an easy way to define a polynomial model for the data that have the flexibility to fit different time-course patterns. in contrast, edger treats time not as a continuous variable but as multifactor. another important difference is that masigpro follows a second step that obtains the best model for each gene such that only significant coefficients are retained in each model, whereas edger applies the same model to each gene under the multifactor consideration. this results in models with more variables that might be prone to give false calls. moreover, we apply in the second step a filter on gene selection that takes into account the r 2 of the regression model, implying that only genes with a good fit to the model will be selected. the consequences of the different implementations are clear in the results of the simulation study and the experimental data. basically, we observed a better control of fdrs in masigpro and that genes selected by masigpro have not only significant models but also well-fitted models. finally, the masigpro package also provides clustering and visualization of significant genes. one important aspect that we considered in our simulation study was the number of replicates and the complexity of the. random examples from genes selected with (a) masigpro and edger, (b) masigpro and not with edger, (c) with edger and not preselected with masigpro and (d) with edger and not with masigpro because r 2 50.5 2601 next masigpro time-course experiment (one or two comparing series). our results indicate that one replicate is clearly not sufficient for the proper control of the fdrs. while initial rna-seq took advantage of the accuracy of the technology to avoid replication, recent studies highlight the importance of appropriate replication for a sound rna-seq data analysis . within the parameter settings of the simulation experiment, we show that masigpro-glms controls fdr and fn from two replicates and that the performance improves as the number of replicates and series increase. related to this, it is also interesting to comment results of the masigpro-lm analysis on the synthetic data. while it might be obvious that lms are not appropriate to model count data, one could speculate that after data normalization, discretization would be removed and the normalized data could be treated as continuous data. however, transformed data are not normally distributed, and right asymmetry still holds. although transformed data do not necessarily conserve the probability distribution of the untransformed data, the glms fitting process mainly depends on the assumed variance-to-mean relationship. linear transformations of the data do not change these relations and link functions such as the logarithm are not exclusive for discrete data. this becomes evident when looking into the masigpro-lm results on the simulated data: the linear model performs poorly in most scenarios. however, the central limit theorem suggests that models developed for normal data can be applied to nonnormal data if the available sample is large enough. we show that masigpro-lm can achieve good fdr control when five replicates per condition are used in the two series scenario, although still suffering from a significant rate of false-negative calls. the versatility of the masigpro package to choose the lms or glms with one simple argument option allows easy adaptation of the methodology to the types of data and experimental design. finally, although significance thresholds in masigpro-glm maintain their statistical meaning, the goodness of fit, which is used in the second step of masigpro to select genes with wellfitted models, is evaluated in glms in terms of the deviance: the percentage of deviance explained by the model. we conducted experiments with simulated data to understand how this parameter behaves in different experimental settings. our results indicated that similar to the recommended threshold in the lm version of masigpro, a cutoff value of 0.7 is valid in most scenarios. however, when data are abundant, i.e. triplicated measurements and multiple series, this threshold could be lowered to 0.5. indeed, this value was used in the analysis of the real arabidopsis dataset. the comparison with edger, which solely selects genes on the basis of a significant p-value, showed that the masigpro filtering based on a r 2 cutoff value resulted in genes with consistent models. genes that were significant with both methods but discarded by masigpro because of a r 2 50.5 used to have outliers or highly variable measurements . in conclusion, we show that masigpro-glm is suitable for the identification of degs from time-course rna-seq data under a wide range of experimental settings. the updated package successfully controls both false-positive and false-negative detection rates. funding: this work has been funded by the fp7 stategraproject, eu fp7and the spanish mineco. conflicts of interest: none declared.  
