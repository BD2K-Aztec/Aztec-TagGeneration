genome analysis scaffolding low quality genomes using orthologous protein sequences motivation: the ready availability of next-generation sequencing has led to a situation where it is easy to produce very fragmentary genome assemblies. we present a pipeline, swips (scaffolding with protein sequences), that uses orthologous proteins to improve low quality genome assemblies. the protein sequences are used as guides to scaffold existing contigs, while simultaneously allowing the gene structure to be predicted by homology. results: to perform, swips does not depend on a high n50 or whole proteins being encoded on a single contig. we tested our algorithm on simulated next-generation data from ciona intestinalis, real next-generation data from drosophila melanogaster, a complex genome assembly of homo sapiens and the low coverage sanger sequence assembly of callorhinchus milii. the improvements in n50 are of the order of $20 for the c.intestinalis and h.sapiens assemblies , which is significant, considering the large size of intergenic regions in these eukaryotes. using the cegma pipeline to assess the gene space represented in the genome assemblies, the number of genes retrieved increased by 4110 for c.milii and from 20 to 40 for c.intestinalis. the scaffold error rates are low: 8590 of scaffolds are fully correct, and 495 of local contig joins are correct. availability: swips is available freely for download atnew sequencing technologies have lowered the cost of generating genomic dna sequence to the point where high coverage of a moderately sized animal genome (e.g.51 gb) can be obtained for a few thousand euros. currently, short read lengths (i.e. 100 250 bp) present challenges for assembling sequence into a complete genome, usually owing to an inability of short reads to bridge repetitive sequence. this problem can be circumvented by using paired end or mate paired reads with different insert sizes long enough to span repetitive regions. for instance, the genome of the giant panda and, more recently, the one of the naked mole-rat have been sequenced using short read sequencing technology alone and achieved high quality. both projects used multiple libraries; the latter used 18 paired-end sequencing libraries with 8 different insert sizes spanning 170 bp to 20 kbp. this strategy has the disadvantage of incurring significant extra cost, and large insert size libraries require larger amounts of dna that may not be readily available for some taxa. apart from mainstream de novo assemblers, several groups have worked on incorporating available related assembled genomes into the assembly process . for instance, it is standard procedure (e.g. the orangutan genome project,) to use whole genome alignments to build super scaffolds by aligning the new assembly to the high quality genome of closely related species. many species, however, are sequenced precisely because they are not closely related to species for which a complete genome is available. thus, other approaches have been adopted to increase assembly contiguity. in, for example, researchers exploited the eukaryote exonintron gene structure and used rna-seq data to scaffold contigs from a caenorhabditis nematode genome, increasing the initial n50 from 5.0 to 9.4 kb. this strategy obviously requires the generation of rna-seq data in addition to genomic sequence, and genes that are not expressed in the rna-seq library will not be available for scaffolding. as protein sequences are generally well conserved across distant taxa (compared with non-coding or dna sequences), a possible way to deal with fragmented initial assemblies is to use orthologous proteins to guide the scaffolding of contigs that encode fragments of the same proteins. surget-groba and montoya-burgos used orthologous proteins to guide transcriptome assembly by mapping contigs onto a related protein set and improved the n50 of their zebrafish transcriptome assembly by up to 42 (surget). the presence of introns, large intergenic regions and the much larger volume of data involved in genome assemblies, however, make this a fundamentally more difficult problem. salzberg et al. introduced a gene-boosting algorithm that used amino acid sequences from predicted proteins to improve the scaffolding of a 6 mb bacterial genome, although again, as bacterial proteins lack introns, this is a somewhat easier problem to approach . here, we present an algorithm that uses proteome sets from different species to guide scaffolding of genome assemblies of various qualities (including highly fragmented ones, e.g. n50 5 3 kb). in this article, we use the term scaffolding to refer to the process of ordering and orienting contigs, although we recognize that we do not estimate distances between contigs. we call this swips (scaffolding with protein sequences). existing algorithms and strategies, including the ensembl genebuild process for low-coverage assemblies, and gpipe (heger to whom correspondence should be addressed. the author 2012. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.com this is an open access article distributed under the terms of the creative commons attribution license (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. and), are not suited for highly fragmented assemblies where a gene may be spread over multiple contigs. swips uses orthologous proteins (possibly from distantly related species) as guides to link exons of the same protein that may be situated on different contigs. to our knowledge, only one other published method, esprit , does this. esprit was used to bridge 666 callorhinchus milii contigs from a sanger-based assembly together and reported precision of $80. esprit, however, assumes a uniform evolutionary rate over the entire length of split proteins, something that is clearly questionable in the general case. we present a novel score optimization framework for scaffolding contigs and a strategy to optimize this score to improve the contiguity of novel assemblies, reduce their fragmentation, as well as predict the content of their exomes. we tested swips on a set of genomic assemblies of simulated ciona intestinalis next-generation sequencing data, real sequencing data from drosophila melanogaster, as well as the sanger sequenced, but low coverage (1.4) assembly of c.milii and a pre-assembled genome of homo sapiens.we have shown that our method is able to use protein sequences to order and orient contigs into scaffolds, thus improving assembly contiguity and gene prediction, showing significant improvements over the only other available tool. although the overall improvements in n50 found by swips may appear modest, they should be understood with reference to the fact that the majority of most animal genomes is composed of non-coding sequence, and thus not amenable to scaffolding via protein coding sequences. to confidently scaffold exon-containing regions on different contigs, we need to be sure that they come from the same gene. in the context of this problem, the most obvious way of doing this is by assuming that our guide protein comes from a gene that shares a 1:1 or many:1 orthologous relationship with the gene encoded by the exons. we thus need to test that each exonicsince human genes are known to possess longer introns than general eukaryotic genes, we allowed 200 kb (instead of 100 kb) to assess the accuracy of swips on the human assembly.. example of five contigs scaffolded using swips. protein sacc29144576 links contigs scaffold23914, c5811784 and scaffold25071 together, whereas spur115976525 links contigs scaffold23914, c5926424 and scaffold5359 together. the two protein models allow swips to scaffold all contigs together. each arrow represents a region of homology (dark grey); the intronexon structure (light grey and dark grey) of the orthologous proteins is clearly represented within each scaffold 164 y.i.li and r.r.copley  
