h5vc: scalable nucleotide tallies with hdf5 as applications of genome sequencing, including exomes and whole genomes, are expanding, there is a need for analysis tools that are scalable to large sets of samples and/or ultra-deep coverage. many current tool chains are based on the widely used file formats bam and vcf or vcf-derivatives. however, for some desirable analyses , data management with these formats creates substantial implementation overhead, and much time is spent parsing files and collating data. we observe that a tally data structure, i.e. the table of counts of nucleotides samples strands genomic positions, provides a reasonable intermediate level of abstraction for many genomics analyses, including single nucleotide variant (snv) and indel calling, copy-number estimation and mutation spectrum analysis. here we present h5vc, a data structure and associated software for managing tallies. the software contains functionality for creating tallies from bam files, flexible and scalable data visualization, data quality assessment, computing statistics relevant to variant calling and other applications. through the simplicity of its api, we envision making low-level analysis of large sets of genome sequencing data accessible to a wider range of researchers. availability and implementation: the package h5vc for the statistical environment r is available through the bioconductor project. the hdf5 system is used as the core of our implementation. there is interest in analyses of cancer genome data across large cohorts (kandoth et al., 2013), but the standard file formats are not well suited to the task. the bam format (li et al., 2009) provides low-level information (alignments), but is resource-hungry, especially for data from many samples at high depth. on the other hand, the vcf format (danecek et al., 2011) provides high-level information and focuses on reporting positive variant calls, while reporting of negative calls is usually not attempted and can be expected to encounter scalability limitations. however, absence of evidence is not evidence of absence: just considering every position that is not mentioned in a vcf file a no variant would imply a high false-negative rate, especially in the face of subclonality and uneven coverage.there is a need for an auxiliary format that is scalable, compact and accessible from multiple platforms. 2 hdf5 we use hdf5 (the hdf group, 2010) as the core of our implementation. hdf5 is designed to store large arrays of numerical data efficiently, scales well with the size of the datasets, supports compression and is available on many platforms in the form of libraries for different programming languages including c/c, java, python, matlab and r. our implementation relies on the rhdf5 bioconductor package (fischer and pau, 2012) for low-level access functions to hdf5 files. we store the mismatch tally in a dataset called counts and further quantities in the datasets coverages, deletions and reference. the four datasets, which can be thought of as large arrays of integers, are defined as follows:there is interest in analyses of cancer genome data across large cohorts , but the standard file formats are not well suited to the task. the bam format provides low-level information (alignments), but is resourcehungry, especially for data from many samples at high depth. on the other hand, the vcf format provides high-level information and focuses on reporting positive variant calls, while reporting of negative calls is usually not attempted and can be expected to encounter scalability limitations. however, absence of evidence is not evidence of absence: just considering every position that is not mentioned in a vcf file a no variant would imply a high false-negative rate, especially in the face of subclonality and uneven coverage.there is a need for an auxiliary format that is scalable, compact and accessible from multiple platforms.tallies stored in hdf5 files are a feasible and useful extension of the tool set of genome analysts. a concrete implementation of the tools necessary to make use of this data format is provided by the package h5vc. the associated documentation enables users to start using hdf5-based tallies immediately. given the amount of genomics data that will have to be handled in the near future, this technology has the potential to become a valuable tool for genomic research.is shown in a separate panel, with the genomic position as a common x-axis centered around the position of the variant. along the y-axis, alignment statistics of the forward and reverse strand are shown as positive and negative values, respectively. gray areas represent coverage by sequences matching the reference, and colored areas represent mismatches, deletions and insertions. (a) variant is present in the tumor sample but not in the control. (b) variant of comparable position specific statistics as (a). note the noisiness of the region, which is not immediately obvious from the position-specific values alone  
