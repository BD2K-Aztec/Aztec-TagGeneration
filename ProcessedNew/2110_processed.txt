data and text mining grammr: graphical representation and modeling of count data with application in metagenomics motivation: microbiota compositions have great implications in human health, such as obesity and other conditions. as such, it is of great importance to cluster samples or taxa to visualize and discover community substructures. graphical representation of metagenomic count data relies on two aspects, measure of dissimilarity between samples/taxa and algorithm used to estimate coordinates to study microbiota communities. unifrac is a dissimilarity measure commonly used in metagenomic research, but it requires a phylogenetic tree. principal coordinate analysis (pcoa) is a popular algorithm for estimating two-dimensional (2d) coordinates for graphical representation, although alternative and higher-dimensional representations may reveal underlying community substructures invisible in 2d representations. results: we adapt a new measure of dissimilarity, penalized kendalls s-distance, which does not depend on a phylogenetic tree, and hence more readily applicable to a wider class of problems. further, we propose to use metric multidimensional scaling (mds) as an alternative to pcoa for graphical representation. we then devise a novel procedure for determining the number of clusters in conjunction with pam (mpam). we show superior performances with higher-dimensional representations. we further demonstrate the utility of mpam for accurate clustering analysis, especially with higher-dimensional mds models. applications to two human microbiota datasets illustrate greater insights into the subcommunity structure with a higher-dimensional analysis.the underlying subcommunity structure of data provides vital information about the diversity of microbial composition within the communities. it is well established that human microbiota samples collected from different body habitats show differences in bacterial composition . microbiota in the same body habitat (say gut) may also vary wildly within and across populations, which may have great implications in human health, such as on obesity and other conditions . as such, it is of great importance to cluster samples or taxa to visualize and discover community substructures. assigning the recorded gene sequences into different taxonomic ranks yields a matrix consisting of non-negative integer values, typically known as the metagenomic count matrix. given a measure of distance between samples (e.g. dissimilarity between counts in different rows; see below), principal coordinateanalysis (pcoa) is a standard technique to place the samples on an euclidean coordinate space. the aim is to represent the samples as points in a coordinate space so that under a specified metric, the distance between any two points is representative of the dissimilarity between the samples which they represent. the amount of information in the dissimilarity that is conveyed by pcoa is through the principal components (pcs), which increases as the dimension of the coordinate space (number of pcs) increases. however, in practice, a vast majority of researches construct only two-dimensional (2d) pcoa models for ease of presentation . in several studies that used pcoa models, the amount of variance explained by the first two (pcs) is very small and does not exceed 30 . this is because the dimension of the distance matrix is equal to the sample size, which is typical high, and thus it is very unlikely that two or three directions can explain a huge proportion of the variability. an alternative to pcoa is metric multidimensional scaling (mds), which is modeled by optimizing the difference between true dissimilarity and distance between estimated coordinates, where the distance estimate is determined by the metric specified. in fact, when the metric is euclidean, metric mds is equivalent to pcoa, thus metric mds is a general class of dimension reduction models that includes pcoa as a special case. for different metrics, the shape of representation of the data is different. for example, in two dimensions, the shape of the pcoa model is a circle while that of the l 1-metric based mds model is a square. studying graphical representation of the samples under different norms might reveal features in the data that are not detected by pcoa. an important aspect that drives pcoa representation of the data is the measure of dissimilarity between samples. a popular measure of dissimilarity used in the metagenomic research community is unifrac distance , which is calculated by placing the samples on a phylogenetic tree and counting the number of unshared branches between the two samples. calculation of unifrac distance requires the phylogenetic information in addition to the taxonomic count matrix. as such, unifrac is the measure of choice in studies where the 16s rrna gene sequences are recorded because the phylogenetic tree, an important feature of the 16s data, can reveal relevant biological signals when used appropriately. this approach, however, is not practicable for studies in which the phylogenetic tree is not readily available, such as in shotgun sequencing, where one can only construct operational taxonomic units (otus) that best represent the samples, for example, through matching the shotgun sequences to a reference database. this calls for the development of a dissimilarity measure that can be used in the absence of a phylogenetic tree. since the data matrix comprises integer-valued counts with some extreme values, regular l p-norms may not be appropriate. as an alternative, we propose to use kendalls s-distance as the measure of dissimilarity. while s-distance is originally proposed to compare two sets of rankings, it can be easily extended to counts. properties of the kendalls s-distance are studied extensively and can be penalized to be applicable even when there are ties . depending on the penalty imposed, the kendalls distance may also be a metric. hence, metric mds models can be constructed without compromising the information. although, mds models are used mainly for graphical representation of data, they can also be used to study clustering. given the true community membership of samples, it is of interest to see if the graphical models can visually separate the clusters. for example, in the metagenomic count data described in, body habitats from which the samples are collected can be used to aid visualization of the aptness of the estimated clusters. for the gut microbiome data of obese twins , as another example, attributes of the individuals such as ethnicity, zygosity and obesity can be used to cluster samples to visually correlate with estimated clusters based on metagenomic count data. an interesting question that arises is to see how accurately clustering techniques such as partitioning around medoids (pam) perform as a follow-up step after metric mds modeling. when clustering using pam, the optimal number of clusters is determined using the average silhouette width. standard practice is to use the number of clusters that results in maximum silhouette width . this, however, can result in introduction of uninformative clusters with minute increase in the silhouette width. as an illustration, consider supplementarywhich shows the silhouette width plot constructed for a dataset, whose generating model was constructed based on the costello data as detailed in section 3. the graph shows that maximum silhouette width is not the best representative of the optimal number of clusters for this dataset. for example, consider the 4d l 1-mds model in the graph. the maximum silhouette width (0.8709) is obtained at 18 clusters. however, the model attains a width of 0.8206 for 10 clusters (the last big jump before the increases become incremental), gaining only 5.02 in width while creating 8 additional clusters. similar phenomenon is observed for all the pcoa models. in this article, we propose to use the kendalls s-distance as a measure of dissimilarity for metagenomic count data when a phylogenetic tree is not readily available. we then construct metric mds models for varying dimensions (focusing on dimensions 24 for feasibility of visualization) to study their aptness for representing metagenomic community substructures. a modified silhouette width plot in conjunction with pam, mpam, is proposed as a novel measure for determining the number of clusters that discounts incremental increases. these results are compared with their counterparts based on the pcoa models. we would like to emphasize that the primary aim of this article is not to determine which of these methods is the best unequivocally, but to carry out a comparison between them to make informed recommendations. as an illustration to demonstrate the methods, especially the outcomes when a higher dimension is used, we applied the methods to analyzing two datasets.in this article, we present a novel tool for graphical representation and clustering of metagenomic count data. in particular, we propose mpam, a modified silhouette width measure for determining the number of clusters in conjunction with the pam clustering method. in addition, we investigated and compared two methods for dimension reduction with different number of dimensionality in the projected space. results from simulation clearly indicate the need to explore projections to a dimension greater than two. we further demonstrate the use of the novel tool for two datasets that would benefit from being considered from a higher-dimensional perspective. while the original distance matrix (without being projected into a lower dimensional space) can be used directly for clustering, mpam clustering based on the projected data is in fact advantageous due to better separation obtained from minimizing the stress function in l 1-mds, especially if the projected dimension is relatively large (say 4d). we illustrate this using data generated from model ii (supplementary materials s7 and). kendalls s-distance is proposed to be used as a measure of dissimilarity for metagenomic count data, which is a useful tool for multidimensional modeling when the phylogenetic tree is not available. however, calculation of the s-distance is computationally intensive, with the computation time being on 2 k 2 , where n is the number of samples and k is the number of otus. a study on the computational time taken to compute the kendalls s-distance using grammr for various sample sizes and otus is provided in supplementary materials s8 and. for example, for a dataset with 100 samples and 2000 otus, it took a little bit over 2 min to complete the computation. we note that there are several potential methods that can lead to speed up of the computation, which will be considered in a future release of grammr. a general class of metric mds models is proposed for dimension reduction, enabling informative graphical visualization of data.. side-by-side barplots of the relative frequencies of biases in the estimated numbers of clusters (mpam-10 (left bar) and pam-10 (right bar)) for 4d l 1-mds. two dimensional l 1-mds models displaying the four estimated clusters for taxa using the gut samples. name of the taxa corresponding each sample point are provided as labelsthe popular pcoa model with two-dimensional projection is in fact a special case of this class. comparison of pcoa and another metric mds model, l 1-mds, for two simulation models appears to show that pcoa frequently underestimate the true number of clusters, although the biases tend to get smaller with a higher-dimensional projection. regardless of which metric mds model is used, the benefit of using a dimension greater than two is clearly demonstrated in both the simulation and the real data applications. while twodimensional models are easier to present on paper and thus popular, we would like to emphasize the benefit of higher dimensional representations, and that our method and accompanying software provide an interactive visualization tool for examining results for dimensions up to four. as seen in simulation studies, higher dimensional models reduce error of misclassification. also, the optimal number of clusters used in these models gets closer to the true number of clusters with an increase in dimension. while a single graphical representation of a dimension greater than three is not feasible, one can construct representations selecting three directions at a time to get a series of rotatable 3d plots for closer examination. this, however, is not recommendable for dimensions much greater than 4, as the number of such representations increases at a polynomial rate.  
