sequence analysis comparing clustering and pre-processing in taxonomy analysis motivation: massively parallel sequencing allows for rapid sequencing of large numbers of sequences in just a single run. thus, 16s ribo-somal rna (rrna) amplicon sequencing of complex microbial communities has become possible. the sequenced 16s rrna fragments (reads) are clustered into operational taxonomic units and taxo-nomic categories are assigned. recent reports suggest that data pre-processing should be performed before clustering. we assessed combinations of data pre-processing steps and clustering algorithms on cluster accuracy for oral microbial sequence data. results: the number of clusters varied up to two orders of magnitude depending on pre-processing. pre-processing using both denoising and chimera checking resulted in a number of clusters that was closest to the number of species in the mock dataset (25 versus 15). based on run time, purity and normalized mutual information, we could not identify a single best clustering algorithm. the differences in clustering accuracy among the algorithms after the same pre-processing were minor compared with the differences in accuracy among different pre-processing steps.recent developments in massively parallel sequencing allow for rapid characterization of a large number of sequences in a single run. 16s ribosomal rna (rrna) amplicon sequencing can reveal the composition of complex microbial communities . the unprecedented sequencing depth means that even less abundant species can be detected via their sequences. the taxonomic composition of such samples may be characterized by grouping the sequence fragments (reads) into clusters of operational taxonomic units (otus). for many, often uncultivable, microbes, the 16s rrna sequences are unknown. to avoid the dependency on incomplete databases , microbial community composition is typically determined by using a taxonomyindependent analysis (tia). in this approach, the 16s rrna sequences are compared against each other without directly assigning a taxonomy to the sequence; the number and size of the clusters(otus) indicate the diversity of the sample. recent benchmark studies have revealed several clustering programs that adequately cluster into otus . for this study, we selected all commonly used clustering approaches implemented in quantitative insights into microbial ecology (qiime) , and we also included esprit-tree as it performed well in a recent comparison of clustering methods and as well as methods that include rrna secondary structure information . recent reports suggest that before the clustering step several data cleaning, or pre-processing, steps should be performed to correct errors introduced during (pyro)sequencing . the two most important pre-processing steps are denoising, which corrects errors within the reads based on raw sequencing output (flowgrams), and chimera checking, which removes chimeric sequences. the aim of this study is to identify suitable combinations of pre-processing steps and clustering methods for oral microbial sequence data. we used two sets of pyrosequenced reads of 16s rrna to evaluate cluster accuracies. the first set, a mock dataset, had a known species composition (15 species; supplementary). the second set, a clinical dataset, has reads from samples of human saliva collected in a study on the influence of candida on the composition of the oral microbiome . assessing the performance of the pre-processing and clustering combinations is non-trivial, since no gold standard is available for the taxonomic composition of the samples. in this work, we use two strategies to assess this performance. first, we take a simple approach and check whether the number of clusters agrees with the expected number of species in the mock sample. the taxonomic composition of the clinical sample may be approximated by assigning a taxonomic label from a reference rrna database to each read. second, we assess the clusters based on labelling of sequences. therefore, we calculate the purity and normalized mutual information (nmi) scores . purity scores reflect the homogeneity of a cluster. if the majority of the labels in each cluster are the same, the purity score is high. however, the purity score does not penalize for the creation of multiple clusters that contain the same label(s). the nmi score, in addition, reflects the mutual information between the clusters and the taxonomic labels; a high nmi score is achieved when high purity is reached with a minimum number of clusters. to whom correspondence should be addressed. the author 2012. published by oxford university press. all rights reserved. for permissions, please e-mail: journals.permissions@oup.comthe accuracy of several clustering algorithms was assessed using two test sets of sequence reads: a mock dataset and a clinical dataset. the datasets were pre-processed in four ways: (i) no cleaning (nc),the clustering results were evaluated in two ways: a consensus and a unique method (see methods section). the consensus method merges the assigned lineages to a highest shared taxonomic level, while the unique method only merges the labels. here, the number of unique labels in the unique set is larger than in the consensus set . the clustering accuracy was measured with the purity and the nmi. below, the results of the clustering evaluation on the mock and clinical datasets are presented.we compared different pre-processing and clustering methods with respect to the clustering of sequences into otus. the different pre-processing methods showed clear differences in the number of clusters that were formed. the denoised and chimera checked data formed the number of clusters that was closest to the number of species in the mock.the cluster algorithms formed minimally 25 clusters , whereas 15 species were present in the mock community. in the clinical dataset, we observed around 300450 clusters after denoising and chimera checking. when using only one of the two pre-processing methods, 10003000 clusters were formed. without any pre-processing, the number of clusters reached beyond 7000. as with the mock community data, in the clinical dataset clustering the denoised and chimera checked data performed best if the nmi and purity scores were used as the quality criterion. the actual number of valid clusters in the clinical dataset is unknown. based on cloning and traditional sanger sequencing, currently, there are 6001200 species reported that are associated with the human oral microbiome . however, the oral microbiome diversity is estimated to be at least an order of magnitude higher based on data from high-throughput sequencing approaches . considering the decreasing number of clusters in the mock set in relation to increasingread pre-processing and a similar trend in the reduction of number of clusters in the clinical set, it is likely that the previous estimates are at the higher end of the actual diversity. we observe the same overestimation in microbial diversity as the authors of pre-clustering and denoising algorithms . the differences in the nmi and purity scores for the clustering methods are minor when compared with the differences for the pre-processing methods. the uclust reference-based methods generally outperform the other methods based on the nmi score, while the purity scores were also high. both suggest that the uclust reference methods are the methods of choice. however, it is important to note that these methods form a larger number of clusters than expected and larger than the minimal number of clusters found and use the same reference database on which the taxonomic labels are based, making such a statement too bold. in general, uclust and esprit-tree came out top among the non-reference based methods. they showed a similar performance based on purity and nmi scores, while giving the lowest number of clusters. a reference database is required for chimera checking in reference mode and for uclust in the reference modes. here, we used a trimmed and non-redundant reference, which greatly reduces run times . in this study, we did not use the trimmed set for training a classifier, but it has been found that this improves taxonomic classification . the majority of the mock reads (99.8) has been labelled with expected lineages. although the mock contains 15 species, we do not expect 15 clusters. the v5v7 regions of streptococcus mitis and streptococcus oralis are almost identical (99-100). thus, the expected number of clusters is (at least) 14. the different clustering algorithms returned 25 clusters at best. however, 11 of these 25 clusters have very few members (four are even singletons). if we use a relaxed threshold on cluster size of only 418 members, indeed, the 14 expected clusters remain. given the relatively large number of very small clusters, we do not expect this to generalize to a clinical sample. while a threshold on cluster size is more difficult to determine for a clinical sample, very small clusters (e.g. with less than five members) could also be disregarded here (o zok et al., 2012), though at the risk of underestimating diversity. the determination of the microbiome, based on a few hypervariable regions of the 16s rrna gene, makes it difficult to differentiate between several taxa on species level or even genus level. furthermore, the sequencer creates errors (noise), which makes it even more difficult or impossible to differentiate between related species, such as streptococcus species. in such cases, denoising, to filter out errors created by the sequencer, may regard the small differences between sequences as noise. thus, pyrosequencing (a region of) 16s rrna can distinguish between different genera or species, possibly in combination with denoising, only when sequences of the related taxa differ enough. it is important to note that denoising, chimera checking and clustering methods are context dependent: the result for a single read depends on the entire input set. this is specifically relevant for denoising of data from large studies, since it is typically done on several input files, like in this study. for example, similar sequences in one file can be denoised to sequence a, while in another be denoised to sequence b, simply because sequence a is more dominant in the one file and sequence b in the other. there was a remarkable difference in the number of reads discarded by chimera checking before and after denoising. on average, there was a 27 decrease in the number of non-unique reads when denoising was performed first. moreover, denoising, which can also be seen as a pre-clustering step, has a huge influence on the number of clusters generated. however, denoising differs from the (other) clustering methods as it takes flowgram data into account. this potentially allows denoising to differentiate between true sequence differences and sequencing noise. the results of this study and other studies suggest that it remains important to further investigate combinations of pre-processing steps. we find that the number of otus varies between one and two orders of magnitude depending pre-processing methods and clustering algorithms. using a single-species reference (escherichia coli), it was found that stringent filtering and low clustering thresholds should be applied to prevent overestimation of diversity : unfiltered reads overestimated the number of otus by two orders of magnitude . with respect to technical variation, pre-processing and reduction of error rate, the thorough work of schloss et al.(2011) on mock communities is interesting. they also report that filtering (sliding window quality filter or denoising combined with chimera removal) is required to reduce the number of otus closer to the number of expected otus. even after a 30-fold reduction in sequencing error rate, the number of expected otus and genera was not obtained . more recently, it was also recommended to remove pyrosequencing errors and chimeras before clustering . while we could not identify a single best clustering algorithm, cd-hit, esprit-tree and uclust perform well. in another study, uclust also performs well and comparable to cd-hit but is outperformed by an average neighbour algorithm . esprit-tree, an average linkage-based. the purity and nmi scores for the consensus and unique treatments on the clinical dataset. mothur average could not be used for the nc and cc set. (a) consensus purity, (b) consensus nmi, (c) unique purity and (d) unique nmi hierarchical clustering algorithm, was found to outperform cd-hit, uclust and mothur (average linkage) in another benchmark study . in summary, we tested four pre-processing methods and multiple clustering algorithms to cluster sequences into otus. by combining these steps, we assessed the influence of read filtering on clustering. we showed that cleaning influences the number of otus much more when compared with the different clustering methods. the pre-processing method that resulted in the highest nmi, the highest purity and the number of clusters closest to the expected number of clusters was the combination of denoising with chimera checking. our results give strong evidence that without pre-processing steps the data contains too many errors in order for any clustering algorithm to perform well. this warrants further investigation in pre-processing techniques that allow for the correction of such errors, as more accurate pre-processing will have a larger effect than improving current clustering techniques. alternatively, integrated approaches may be investigated.  
