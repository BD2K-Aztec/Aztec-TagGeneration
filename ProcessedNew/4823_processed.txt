gene expression using poisson mixed-effects model to quantify transcript-level gene expression in rna-seq motivation: rna sequencing (rna-seq) is a powerful new technology for mapping and quantifying transcriptomes using ultra high-throughput next-generation sequencing technologies. using deep sequencing, gene expression levels of all transcripts including novel ones can be quantified digitally. although extremely promising, the massive amounts of data generated by rna-seq, substantial biases and uncertainty in short read alignment pose challenges for data analysis. in particular, large base-specific variation and between-base dependence make simple approaches, such as those that use averaging to normalize rna-seq data and quantify gene expressions, ineffective. results: in this study, we propose a poisson mixed-effects (pome) model to characterize base-level read coverage within each transcript. the underlying expression level is included as a key parameter in this model. since the proposed model is capable of incorporating base-specific variation as well as between-base dependence that affect read coverage profile throughout the transcript, it can lead to improved quantification of the true underlying expression level. availability and implementation: pome can be freely downloaded atthe transcriptome is the complete set of transcripts in a cell under any given developmental stage or physiological condition. comprehensively cataloging all the components in the transcriptome is a grand challenge in the post-genome era. in the past decade, microarray technology has played a prominent role in advancing our understanding of transcriptome complexity by allowing scientists to simultaneously monitor the expression of almost all the genes in the genome . despite its overwhelming success, microarray technology has its limitations. for example, designing probes on the chip requires knowledge of to whom correspondence should be addressed. the genome sequence and annotation; hence, novel transcripts will be missed. additionally, cross-hybridization, background signal and saturation result in a reduction of microarrays dynamic range and accuracy. a recently developed sequencing-based technology for measuring gene expression, termed rna-seq, has the potential to overcome these limitations . the ultra-high-throughput next-generation sequencing technologies capable of producing millions of sequence reads dramatically increase the throughput in dna sequencing compared with conventional sanger technology and at a much lower cost. an array of studies has been published that successfully apply these new sequencing technologies to measure mrna expression levels in cells from various species . since illuminas platforms have been widely adopted in rna-seq experiments, we focused on short read rna-seq data generated from the illumina platform in this study. in rna-seq experiments using the aforementioned sequencing technologies, rna molecules are first converted to a library of cdna fragments with adaptors attached to both ends. each molecule, often after amplification, is then sequenced using one of the next-generation sequencing technologies. following sequencing, the resulting reads are aligned to known transcripts or de novo assembled together to produce a genome-scale transcriptional profile. a fundamental question in rna-seq data analysis is to derive expression level from raw sequencing output data. this is the basis of almost all further investigation such as detecting differentially expressed genes, alternative splicing events, etc. sophisticated and tailor-made data analysis methods are needed to fully realize the power of the new sequencing technologies. a natural idea is to use the total number of reads mapped inside each transcript, or region of interest (roi), to represent the expression level.proposed to use the number of reads per kilobase of a transcript per million mapped reads (rpkm) as the transcripts expression level. the rpkm method is easy to implement and takes into consideration the transcript length and the total number of uniquely mapped reads. however, the rpkm method is oversimplified, as it ignores the variability of read coverage within an roi demonstrated by real rna-seq data. morepage: 64 6368in microarray data analysis, it is now widely accepted that estimates of the expression levels based on parametric models such as the model-based expression index (mbei) are more accurate in reflecting the underlying expression levels than summary statistics of raw intensity values. inspired by the success of model-based methods in microarray data analysis, in this study, we strived to develop a model-based method for analyzing rna-seq data. when exploring the properties of base-level sequencing depth in rna-seq data, we found substantial variation in sequencing depth within most transcripts, especially for those that are highly expressed. we also found that a large proportion of transcripts (25)shows over-dispersion in base-level sequencing depth (supplementary), which is consistent with what has been reported in the literature . additionally, we found that base-level sequencing depth displays substantial dependence between base pairs that are close to each other. this type of dependence resembles spatial correlation between neighboring areas considered in spatial statistics research , and to the best of our knowledge, has not yet been reported in the literature on rna-seq data analysis. based on these observations, we believe that spatial models that can incorporate correlations such as pome have advantages over existing models in characterizing base-level rna-seq data. in this study, we used pome to estimate the expression level of an individual transcript. two types of random effects are introduced to characterize two types of variation in read counts, which are between adjacent base pairs (i.e. spatial correlation) and specific to each base pair (i.e. non-spatial variation), respectively. analyses of both simulated and real rna-seq data demonstrate that the expression indices estimated by pome reflect the underlying expression levels more accurately compared with existing methods. we believe that the improvement of estimation accuracy of pome comes from modeling the dependence between the read counts of base pairs adjacent to each other. the pome model can also be used for differential gene expression analysis by incorporating biological or experimental conditions or other covariates. we will pursue research in these directions in the future. pome model assumes over-dispersion in the observed count data which is the case for a large proportion of transcripts in rna-seq data, especially those highly expressed. for this reason, we focused on highly expressed transcripts in this study. from our experience, about one-quarter of all transcripts belong to this category. for these transcripts, our analysis on simulated as well as real data demonstrated that pome offers more accurate expression measure than other methods that we compared. we have also performed small-scale tests on transcripts with medium level expression, and found pome again outperforms rpkm, mseq and gpseq methods (data not shown). for lowly expressed transcripts, we do not recommend to use pome for inference because observed data may be under-dispersed. like many other model-based methods, the pome method is more computationally intensive than read enumeration methods. for a 100 bp transcript without replicate, it takes 23 s for pome to complete 10 000 mcmc iterations on a dell poweredge 1950 computing node (2.83 ghz cpu processors and 8 gb ram). the computation time increases almost linearly with the length of transcripts. however, since model fitting of individual transcript is independent of each other and thus can be performed simultaneously, the computational intensity of the pome method can be much mitigated by parallel computing. the power of modern cluster computers will also help in this regard. after all, we believe that accuracy in statistical inference outweighs computation cost as long as the latter is affordable. although we only applied the pome method to rna-seq data obtained from the illumina platform in this study, we believe it can also be applied to rna-seq data collected from other sequencing platforms such as solid with little or no modification, because these data possess similar data structures.  
