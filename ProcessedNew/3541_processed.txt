phylat: a phylogenetic local alignment tool motivation: the expansion of dna sequencing capacity has enabled the sequencing of whole genomes from a number of related species. these genomes can be combined in a multiple alignment that provides useful information about the evolutionary history at each genomic locus. one area in which evolutionary information can productively be exploited is in aligning a new sequence to a database of existing, aligned genomes. however, existing high-throughput alignment tools are not designed to work effectively with multiple genome alignments. results: we introduce phylat, the phylogenetic local alignment tool, to compute local alignments of a query sequence against a fixed multiple-genome alignment of closely related species. phylat uses a known phylogenetic tree on the species in the multiple alignment to improve the quality of its computed alignments while also estimating the placement of the query on this tree. it combines a probabilistic approach to alignment with seeding and expansion heuristics to accelerate discovery of significant alignments. we provide evidence, using alignments of human chromosome 22 against a five-species alignment from the ucsc genome browser database, that phylats alignments are more accurate than those of other commonly used programs, including blast, poy, mafft, muscle and clustal. phylat also identifies more alignments in coding dna than does pairwise alignment alone. finally, our tool determines the evolutionary relationship of query sequences to the database more accurately than do poy, raxml, epa or pplacer.the proliferation of high-throughput dna sequencing has produced a huge amount of genomic dna sequence, including genomes from many higher eukaryotes. intensively studied clades of organisms such as mammals, drosophila fruit flies and worms of the genus are now typically represented in public databases by complete or partial genomes of multiple species. a group of closely related genomes can be combined into a large-scale multiple alignment of orthologous sequences . to whom correspondence should be addressed. building a high-quality multiple-genome alignment requires a large investment of computational resources and curation time, particularly if the alignment will become a reference for future users. we would therefore like to amortize this investment by effectively utilizing information present in the alignment that is not readily available from its component genomes. multiple-genome alignments are commonly used to interrogate a clades evolutionary history , often with the help of a phylogenetic tree on the component species, or to discover genomic loci of unusually high conservation or unusually fast change . however, they are rarely used to augment one of the most common operations in bioinformatics: aligning a new sequence to an existing reference. in principle, using a reference multiple alignment, rather than any one of its component genomes, to align a query sequence should result in a more accurate alignment, since the aligner can use the pattern of conservation at each position to more accurately determine which query base corresponds to which multiple alignment column. moreover, given a phylogenetic tree relating the species in the reference, an aligner should be able to use standard probabilistic models of evolution to compare the likelihoods of possible alignments, rather than resorting to an arbitrary scoring system. in fact, alignment could even infer the evolutionary relationship of the query to the reference, placing it on the tree of the references species. in practice, however, most widely used alignment tools either cannot use reference multiple alignments or cannot do so in a phylogenetically aware way. blast and other accelerated variants of smithwaterman are widely used for pairwise sequence comparison, but these methods compare only individual sequences. psi-blast creates an alignment between a query and a profile computed from a database of individual reference sequences. however, the construction of the profile does not take into account phylogenetic information, so it does not weigh each reference sequence in a phylogeny-aware way. hmmer and sam can align a sequence to a pre-existing multiple alignment, if it is generalized to a profile hidden markov model, but even these tools use only statistical conservation at each position, rather than phylogenetic information, to perform alignments. tools for de novo multiple sequence alignment exist that use trees to improve alignment quality. the classic clustal software uses a guide tree to align multiple sequences. more recent tools, such as poy , can align sequences given a tree or jointly compute a multiple alignment and a supporting phylogeny. however, these tools cannot as a rule incrementally update a multiple alignment and tree starting fromphylat is built around an em-like algorithm that simultaneously computes an alignment between a query sequence and a multiple alignment and predicts the placement of the query on the tree associated with the multiple alignment. the algorithm iteratively refines query alignment and branch placement until both have converged. to accelerate this core alignment algorithm, we adopt a blast-like seed generation and extension heuristic (see supplementary materials). we use the evolutionary consensus sequence of the multiple alignment to rapidly generate pairwise seed alignments, filter these seeds by e-value, and finally apply the core algorithm to each seed. the structure of the aligner is illustrated in.while phylat generally aligned query sequences to their orthologous regions as inferred from the ucsc database, there were 350 human query sequences which were not aligned to their orthologous regions. we examined these query sequences using blast and found that all of them are highly conserved coding regions, which are likely difficult to distinguish from the orthologous loci on the basis of similarity alone. these 350 sequences are spread over 56 genes; the most frequently hit gene was igl2, hit by 87 queries, which is an immunoglobulin lambda locus. we also examined 48 human queries whose branch placements in phylat were not on the branch leading to rhesus yet had entropies 0.25, indicating high confidence in the wrong placement. these queries hit cds regions from 19 genes, listed in. we searched for these genes and their families in treefam and found that, for 45 of the 48 placements, the gene trees were different from the species tree. we hypothesized that phylats wrong branch placement prediction in these cases was an artifact of the incorrect tree provided for the informant species. to test this hypothesis, we reran phylat on the 45 identified cases using the appropriate gene tree from treefam as the reference tree in each case. we found that, in 40 out of the 45 cases, phylats query placements with the revised input tree were consistent with the gene tree from treefam. we further note that the distribution of the 48 wrong placements is in accordance with the theory of deep coalescence, which states that short wide trees may show more genes with deep coalescence than long narrow trees . seefor an example.we have described phylat, an efficient, phylogenetically aware tool computing and scoring local alignments between a query sequence and a large multiple alignment. in our tests, phylats accuracy in alignments involving coding dna exceeded that of blast, even using the consensus of all species in the database. phylats accuracy also exceeded that of phylogeny-aware alignment tools. moreover, the inferred placement of queries on the tree of the database species was typically both topologically accurate and confident. we believe that phylats methods will prove useful in augmenting existing high-throughput sequence comparison tools to exploit the extra information provided by multiple-genome alignment databases. several opportunities exist to improve phylats performance and utility. first, our assumption that successive residues in the query or successive columns in the multiple alignment are stochasticallyindependent is not realistic. it could be useful to add a dependence model between adjacent bases/columns to improve the accuracy of alignment. second, phylat assumes that its query is a single dna sequence. it would be useful to handle queries that are themselves multiple alignments. however, there are unresolved computational complexity issues with this extension. in particular, we cannot simply enumerate all simultaneous branch placements of all species in the query multiple alignment with respect to the database multiple alignment. some efficient way must be found to form a hypothesis about how the query species and database species relate within a single tree. third, we need to develop efficient approaches to estimate the statistical significance of gapped alignments in phylat without resorting to expensive simulations. karlin and altschuls theory for ungapped alignments is not applicable to gapped alignments . however, many kinds of alignments involving gaps were empirically demonstrated to follow evd . to derive empirical parameters of ka statistics, tens of thousands of alignments need to be generated and scored. this, the human query is placed on the branch leading to cow. the species tree shows that the human gene is closer to rat than cow, whereas treefam shows that the human gene is actually closer to cow than rat.  
