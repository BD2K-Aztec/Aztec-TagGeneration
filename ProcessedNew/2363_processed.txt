improved ancestry inference using weights from external reference panels motivation: inference of ancestry using genetic data is motivated by applications in genetic association studies, population genetics and personal genomics. here, we provide methods and software for improved ancestry inference using genome-wide single nucleotide poly-morphism (snp) weights from external reference panels. this approach makes it possible to leverage the rich ancestry information that is available from large external reference panels, without the administrative and computational complexities of re-analyzing the raw genotype data from the reference panel in subsequent studies. results: we extensively validate our approach in multiple african american, latino american and european american datasets, making use of genome-wide snp weights derived from large reference panels, including hapmap 3 populations and 6546 european americans from the framingham heart study. we show empirically that our approach provides much greater accuracy than either the prevailing ancestry-informative marker (aim) approach or the analysis of genome-wide target genotypes without a reference panel. for example, in an independent set of 1636 european american genome-wide association study samples, we attained prediction accuracy (r 2) of 1.000 and 0.994 for the first two principal components using our method, compared with 0.418 and 0.407 using 150 published aims or 0.955 and 0.003 by applying principal component analysis directly to the target samples. we finally show that the higher accuracy in inferring ancestry using our method leads to more effective correction for population stratification in association studies. availability: the snpweights software is available online at http:// www.hsph.harvard.edu/faculty/alkes-price/software/.applications in genetic association studies, population genetics and personal genomics motivate inference of genetic ancestry using single nucleotide polymorphism (snp) genotypes.in genetic association studies, ancestry inference can be applied to control population stratification, which can lead to spurious association between the genetic variant and the phenotype under study . in personal genomics, many private companies provide genetic testing on ancestry, which involves inference of ancestry based on information of genetic data from a single individual . in genome-wide association studies (gwas), several methods have been proposed to adjust for population stratification . methods that explicitly infer genetic ancestry include structured association , principal component analysis (pca) and multidimensional scaling . to infer genetic ancestry, these methods can be either applied to the target samples only or applied to the target samples combined with an external reference panel to improve accuracy; when inferring ancestry for a single target individual in a personal genomics setting, it is necessary to include an external reference panel. as an alternative to applying these methods to genome-wide data, they can be applied to a subset of ancestry-informative markers (aims). for example, aim panels have been developed for european americans and latino americans . the use of raw genotypes from a large reference panel to improve accuracy poses several complexities, including the logistics of obtaining and managing additional raw genotype data, concerns about sharing raw genotype data owing to privacy or other reasons and increased computational cost. although the aim approach can ameliorate some of these complexities, restricting to aims when genome-wide data are available reduces accuracy . given that data on genome-wide markers now can be generated through low-coverage sequencing at very low cost, an approach that can fully use the ancestry information of genome-wide markers is needed . here, we propose methods and software for ancestry inference based on genome-wide snp weights. this approach requires just the raw genotypes from the target samples and a set of genomewide snp weights pre-computed using external reference panels. notably, the reference panels of genotypes do not need to be shared. inferring ancestry using the genome-wide snp weights to whom correspondence should be addressed. does not depend on the sample size or diversity of the study samples, and can infer ancestry for related samples, for which direct pca is often confounded by family structure . to demonstrate our method, we first built an ancestry inference model for african americans using genome-wide snps and validated our model using independent hapmap 3 samples . this model predicts the first principal component (pc1) for african americans and can also transform predicted pc1 into european ancestry. we determined that predicted ancestry using genome-wide snp weights is more accurate than predicted ancestry using a limited number of aims. we extended the model to infer ancestry from east asian, european and west african populations using pc1 and pc2 from these populations. once again, predicted ancestry using genome-wide snp weights was extremely accurate. finally, we built an ancestry inference model for european americans using northwest european (nw), southeast european (se) and ashkenazi jewish (aj) ancestral populations . we used european american reference samples from the framingham heart study (fhs) share data to build the model and validated the model with independent samples from a bipolar disorder (bd) gwas and a breast cancer (bca) gwas . for both bd and bca datasets, the predicted pc1 and pc2 attained higher accuracy than direct application of pca. in addition, simulations showed that our method outperforms the aim approach in correcting population stratification in gwas. ancestry inference software incorporating snp weights for all of the populations considered here can be downloaded from http://www.hsph.har vard.edu/faculty/alkes-price/software/.in this study, we presented methods and software for ancestry inference using genome-wide snp weights derived from large reference panels. we showed empirically that this approach can accurately predict pcs and ancestry in populations of admixed continental ancestry and in european americans, which have more subtle population structure. our results highlight the advantage of inferring ancestry using genome-wide snps obtained from a large external reference panel. we further compared predicted pcs obtained by using genome-wide snps with those obtained by using subsets of random snps or aims, and showed that predicted pcs using genome-wide snps have the highest accuracy. aim panels have been proposed for ancestry inference in african americans , latino americans and european americans . for african americans, it had been suggested that accurate ancestry inference requires only 30 aims . however, we observed that genome-wide snps provide more accurate ancestry estimates than even 100 aims in african americans. thus, our approach based on genome-wide snp weights outperforms the use of aim panels. our simulation study of population stratification further confirmed this point by showing that adjustment using our method outperforms adjustment using 150 aims. in applications in real data analysis, the aim approach has the advantage that it requires less genotyping work if genome-wide snp genotypes are not available. however, as the genome-wide marker data can now be generated at very low cost, genotyping costs are less likely to be a limitation going forward . we also stress that our method can be used even when the input genotypes contain an incomplete set of snps compared with the genome-wide snp weights, for example, if they were typed on a different genotyping platform. our simulations show that 1000 random snps or 10 000 random snps are sufficient to predict ancestry with high accuracy in african americans or european americans, respectively. however, a smaller number of random snps genotyped in candidate gene or targeted replication studies would not be sufficient to infer ancestry in these populations. by constructing snp weights with a carefully selected unrelated reference panel, our approach can accurately infer ancestry for related target samples, while direct pca on related target samples may provide inaccurate estimates of populationof ancestry due to relatedness, but the ancestry inference is limited to the unrelated target samples, which may have insufficient sample size and diversity. by using a large external reference panel to compute the snp weights, our method is not limited to the target samples and can attain accurate ancestry inference for related target samples. another advantage of our method is that it is based on precomputed snp weights. the pre-computed snp weights can be readily shared with our software release. on the contrary, the existing methods for accurate ancestry estimation usually require raw genotypes from a large external reference sample. access to raw genotypes entails substantial administrative complexities, which can be time-consuming. the sharing of snp weights is also more privacy preserving than the sharing of raw genotypes. we note that it may be plausible to detect whether a given individual is in the set of samples used to calculate the snp weights, analogous to detecting whether a given individual is in the set of samples used to calculate summary statistics . however, because the samples that we used to calculate snp weights in were ascertained without regard to any phenotype, inferring whether a given individual is in that set of samples reveals less information than inferring whether a given individual is in a set of samples ascertained for a particular phenotype. our method also has the advantage of reduced running time. existing software requires time o(mn 2 ) to compute pcs, where m is the number of snps and n is the number of samples . in theory, randomized eigenvector approximations can reduce the running time to o(mn) . however, a colleague of ours reports that efforts to apply this approach to genetic data have not yet been successful, as in large datasets, eigenvalues may be highly significant (reflecting real population structure in the data) but only slightly larger than background noise eigenvalues, and thus sometimes missed by randomized methods (n. patterson, personal communication). thus, our simple o(mn) approach offers real practical advantages. our method relies on including samples from the appropriate ancestral populations to build the model, to correctly infer ancestry component for given admixed samples. however, the predicted pcs reflect the pcs obtained by performing pca on the combined raw genotypes from the admixed population and the ancestral samples, irrespective of which ancestral samples were included in the analysis. in the analyses presented here, we built ancestry inference models using samples from three continental populations or nw, se and aj european populations. when applying our method to samples with no good match in the ancestral populations used, we still accurately predicted the top pcs from pca, although caution is warranted in interpreting the results of either of these analyses with respect to the ancestral populations used. we can readily extend our method to build models with samples from other ancestral populations. for example, similar models can be built for indian and native american populations using appropriate reference panels . extension to more than three ancestral populations is straightforward, but accuracy is contingent on the sample size and diversity of the ancestral samples, as lower pcs may represent more subtle population structure. in summary, we have developed a method for ancestry inference using genome-wide snp weights. our method only requires genotypes from the target samples and publicly available snp weights, and is highly computationally efficient. the method can be readily applied in genetic association studies for population stratification adjustment and in personal genomics for predicting the ancestry component of an individual. for diseases or health outcomes associated with ancestry, the predicted ancestry values can be used for risk stratification and risk prediction .  
