sequence analysis rrbsmap: a fast, accurate and user-friendly alignment tool for reduced representation bisulfite sequencing reduced representation bisulfite sequencing (rrbs) is a powerful yet cost-efficient method for studying dna methylation on a genomic scale. rrbs involves restriction-enzyme digestion, bisulfite conversion and size selection, resulting in dna sequencing data that require special bioinformatic handling. here, we describe rrbsmap, a short-read alignment tool that is designed for handling rrbs data in a user-friendly and scalable way. rrbsmap uses wildcard alignment, and avoids the need for any preprocessing or post-processing steps. we benchmarked rrbsmap against a well-validated maq-based pipeline for rrbs read alignment and observed similar accuracy but much improved runtime performance, easier handling and better scaling to large sample sets. in summary, rrbsmap removes bioinformatic hurdles and reduces the computational burden of large-scale epigenome association studies performed with rrbs. availability: http://rrbsmap.computational-epigenetics.org/dna methylation is an important mechanism of epigenetic regulation in development and disease. many methods for dna methylation profiling have been developed, but only bisulfite sequencing gives rise to comprehensive dna methylation maps at single-base pair resolution . bisulfite treatment converts unmethylated cytosines (cs) into uracils, which gives rise to c-to-t polymorphisms after subsequent polymerase chain reaction amplification, while leaving methylated cytosines unchanged. by aligning and comparing bisulfite sequencing reads to the genomic dna sequence, it is thus possible to infer base pair-resolution dna methylation patterns. bisulfite-converted dna can be subjected to whole-genome resequencing, giving rise to comprehensive methylomes . however, this procedure requires deep sequencing of entire genomes, rendering it expensive in terms of sequencing cost as well as the required amount of input dna. reduced representation bisulfite sequencing (rrbs) addresses these limitations and provides a complementary technology to whole-genome bisulfite sequencing. in rrbs, dna is first digested with a restriction enzyme that includes a cpg in its recognition site and cuts dna independent of the methylation status of this cpg. subsequently, small dna fragments are size selected to enrich for cpg-rich genomic regions (which are often associated with epigenetic regulation) and subjected to high-throughput bisulfite sequencing. by concentrating on a small but informative portion of the genome, rrbs provides high-sequencing depth at affordable cost, making rrbs well suited for detecting subtle differences in large patient cohorts. furthermore, rrbs is readily applicable to small amounts of dna and formal-fixed, paraffin-embedded samples . rrbs is actively used by a number of groups . to our knowledge, no alignment tools have been published that are tailored to rrbs data. although some existing tools for bisulfite sequencing data can also be applied to rrbs, doing so requires custom pre-and post-processing, thus limiting the accessibility of rrbs for researchers with limited bioinformatic support. here we describe rrbsmap, a short-read alignment tool that is specifically tailored to rrbs. we show that rrbsmap provides a major advance in terms of runtime performance and usability compared to a well-validated maq-based pipeline, while maintaining high mapping accuracy.we compare rrbsmap with a maq-based pipeline that has been extensively used in our previous studies. this pipeline involves five steps: (i) in silico digestion of the target genome and indexing of size-selected restriction fragments; (ii) conversion of bam files into bfa files; (iii) alignment using the bisulfite alignment mode of maq (http://maq.sourceforge.net/); (iv) conversion of the map files into bam files; and (v) coordinate mapping of the aligned reads to remove the effects of in silico digestion. this custom pipeline provides high accuracy, and we used it successfully in a number of publications (. however, it is neither user-friendly nor easily portable and currently not publicly available. the comparison was performed on a total of nine rrbs libraries that were prepared from human embryonic stem cell dna and sequenced on illumina gaiix (supplementary). for pairs of biological replicates sequenced with 36bp single-ended reads (rows 16 in supplementary), we observed equal consistency between replicates and equal bisulfite conversion rates, but slightly higher aligned read numbers and cpg coverage for rrbsmap than for maq. the central processing unit (cpu) time was 5-fold lower and the actual (wall clock) time on a multicore processor node was 30-fold lower for rrbsmap than for maq. the memory consumption of rrbsmap was 3-fold lower than for maq. we also tested rrbsmap and maq on technical replicates sequenced with 76 bp paired-end reads (rows 79 in supplementary), which is a rarely used configuration for rrbs that we had not previously tested with the maq-based pipeline. compared to 36 bp single-end, rrbsmap almost doubles the cpg coverage that is achievable with rrbs, while not sacrificing accuracy or performance. in contrast, the maq-based pipeline does not work well for 76 bp paired-end reads, resulting in substantially lower alignment rates while maintaining high accuracy and consistency between replicates. in summary, rrbsmap performs at least as well as an extensively validated maq-based pipeline on the key performance metrics of bisulfite sequencing, and it significantly outperforms the maqbased pipeline in terms of runtime performance and in terms of genomic coverage for 76 bp paired-end reads. the performance of rrbsmap is sufficient to process thousands of rrbs libraries, a situation that is become increasingly realistic as dna methylation profiling follows genome-wide association studies and tackles large samples cohorts.  
