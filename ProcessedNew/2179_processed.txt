hhfrag: hmm-based fragment detection using hhpred motivation: over the last decade, both static and dynamic fragment libraries for protein structure prediction have been introduced. the former are built from clusters in either sequence or structure space and aim to extract a universal structural alphabet. the latter are tailored for a particular query protein sequence and aim to provide local structural templates that need to be assembled in order to build the full-length structure. results: here, we introduce hhfrag, a dynamic hmm-based fragment search method built on the profileprofile comparison tool hhpred. we show that hhfrag provides advantages over existing fragment assignment methods in that it: (i) improves the precision of the fragments at the expense of a minor loss in sequence coverage; (ii) detects fragments of variable length (621 amino acid residues); (iii) allows for gapped fragments and (iv) does not assign fragments to regions where there is no clear sequence conservation. we illustrate the usefulness of fragments detected by hhfrag on targets from most recent casp. availability: a web server for running hhfrag is available at http:// toolkit.tuebingen.mpg.de/hhfrag. the source code is available atthe success of many protein structure prediction methods critically depends on the existence of structural templates and our ability to detect them. it seems that known protein structures have reached a sufficient level of diversity for template-based structure prediction . the percentage of new folds in the protein data bank (pdb) dwindles, and even the new folds tend to reuse building blocks such as super-secondary structure motifs shared with non-homologous proteins . the new folds add to pdbs diversity by providing new arrangements of known motifs rather than by introducing completely novel building blocks. also our ability to identify structural templates has reached a level of sensitivity such that the boundaries between homology modeling and threading methods blur . structures evolve more to whom correspondence should be addressed. slowly than sequences and therefore highly divergent sequences may still share a common structure. the critical threshold of 30 sequence identity has been pushed to ever smaller values by profile profile methods superseding conventional sequence comparison algorithms. even if no full-length template exists or if we fail to detect it, there is still hope for structure prediction. segments of the query profile may show significant similarity to short conserved regions in proteins from different folds. such recurring sequence patterns often correlate with persistent local structure. examples of recurring motifs have been compiled into the i-sites fragment library and proved useful in protein structure prediction . i-sites aims to build a concise, static dictionary of reusable fragments and is an early attempt to discover a universal structural alphabet . in contrast, dynamic methods such as rosettas fragment extraction module nnmake aim to create a fragment library that is customized to the query sequence. although dynamically extracted fragments often correspond to the recurring motifs of static approaches, no attempt is made to compile them into a non-redundant universal dictionary. static fragment libraries trade low sequence coverage for high precision. therefore, dynamic fragment search seems more suitable for structure prediction. in conserved regions, also a dynamic approach should be as accurate as static libraries. but in nonconserved regions, the better coverage of dynamic fragment search comes at the price of reduced precision. another limitation is that fragments typically come in fixed size, with 9mer fragments being a popular choice . this is more for technical convenience rather than having a specific biological meaning. the actual instances of a structural motif often show variable lengths with extensions or deletions at the termini. i-sites tries to address this problem by defining a set of overlapping, partially redundant motifs. the rosetta fragment selection tool nnmake searches a database of crystal structures with better than 2.5 resolution and pairwise sequence identity 50 . all nine residue windows from the query sequence are compared to the database entries using a score that is based on sequence profile comparison and secondary structure match. the psi-blast profiles of the query and the candidate fragments are compared using the cityblock distance metric. this method has been extended by the frazor dynamic fragment selection tool . using integer linear programming, frazor combines the sequence profile similarity score with additional structural features (secondary structure, solvent accessibility and contact capacity) in order to improve the fragment selection. an alternative to fragment selection is the recent development of fragment sampling from probabilisticwe have introduced hhfrag, a new hmm-based fragment detection method that uses the profile comparison tool hhpred to build a customized fragment library for a query protein sequence. our results show that a dynamic fragment library has advantages over a static library in that it improves the sequence coverage dramatically. compared to other dynamic approaches such as rosetta nnmake, hhfrag improves the precision of the fragments significantly at the expense of a 1915 loss in sequence coverage. a distinctive advantage is that hhfrag extracts fragments with variable length that may also contain gaps. often fragments identified by hhfrag seem to point at a common evolutionary origin of the proteins sharing the same motif. consider the example of the gd box . the gd box links remotely homologous members of the cradle-loop barrel metafold and also otherwise unrelated folds sharing an analogous motif. hhfrag detects gd boxes with very high coverage and precision. this example shows that fragments found by hhfrag may arise from a common evolutionary origin and can be also the result of convergence. our experiences with decoy generation using rosettas abinitiorelax protocol shows that most likely new strategies of  
