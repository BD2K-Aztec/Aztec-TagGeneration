prediction of ribosome footprint profile shapes from transcript sequences motivation: ribosome profiling is a useful technique for studying translational dynamics and quantifying protein synthesis. applications of this technique have shown that ribosomes are not uniformly distributed along mrna transcripts. understanding how each transcript-specific distribution arises is important for unraveling the translation mechanism. results: here, we apply kernel smoothing to construct predictive features and build a sparse model to predict the shape of ribosome footprint profiles from transcript sequences alone. our results on saccharomyces cerevisiae data show that the marginal ribosome densities can be predicted with high accuracy. the proposed novel method has a wide range of applications, including inferring isoform-specific ribosome footprints, designing transcripts with fast translation speeds and discovering unknown modulation during translation. availability and implementation: a software package called riboshape is freely available at https://sourceforge.net/projects/riboshapegene expression is a fundamental biological process consisting of two parts: transcription of mrnas from dnas and translation of proteins from mrnas. studying the genome-wide dynamics of both processes is crucial for understanding how cells function and respond to various environmental conditions, thereby giving rise to the impressive complexity of living organisms. due to technological challenges, translation has not been studied as extensively as transcription, but recent advances in experimental protocol and sequencing technology are providing an unprecedented opportunity to examine the translation process at base-pair resolution. ribosome profiling applies either translation inhibitors or a flash-freeze protocol to immobilize the ribosomes walking along the transcript, and the ribosome-occupied regions (each of length 2830 nucleotides) can then be extracted and sequenced, providing detailed positional information about ribosomes. such snapshots of ribosome footprints enable quantitative monitoring and analysis of translational dynamics, making ribosome profiling an important technique for studying protein synthesis. in particular, it has been shown that protein abundance correlates better with ribosome densities than with mrna abundance . various factors may influence the translation mechanism. it has been proposed that the differential usage of synonymous codons, also known as the codon usage bias, is driven by evolutionary forces to facilitate translation speed . this hypothesis is supported by the finding that transcripts with wobble base-pairing encounter slower elongation , and also by the analysis of trna-adaptation index (tai) . another hypothesis associates the mrna secondary structure with translation efficiency, in particular near initiation sites . studies have found that initiation is the rate-limiting factor of translation and that ribosome densities tend to be higher near initiation sites in saccharomyces cerevisiae . also, positively charged residues on nascent peptides have been found to influence the footprint abundance . we refer the reader tofor a review of the major findings from utilizing ribosome profiling. although the debate surrounding the main determinant of translational dynamics remains open, the above-mentioned hypotheses have one thing in common; that is, the transcript sequence context plays an important role in governing the efficiency of translation. hence, investigating how transcript-specific distributions arise and to what extent they depend on the transcript sequence is essential toafter the filtering step described in section 2.1, we grouped genes according to their length into 5 bins: 250 codons, 251500 codons, 501750 codons, 7511000 codons and !1000 codons. we then decomposed each ribosome footprint profile using wavelet analysis with daubechies-8 basis and eight scales, as illustrated in.for comparison, we also considered a model with the symmetric kernel f n with the same set of bandwidths, as well as a model with no kernel smoothing. we trained the regression model using 9n/10 randomly chosen genes, where n is the number of genes in the corresponding bin, and chose the regularization parameter in (3) via five-fold cross-validation using the training data. then the model was tested on the genes that were left out, and the process was repeated until every gene has been tested. results of chx-treated footprints in various spaces are summarized in. the average performance is presented in terms of the pearson correlation coefficient between the predicted and the true ribosome marginal densities. notice that our method using asymmetric kernels achieved high accuracy in subspaces v 0 through v 4. this suggests that the global shape of transcript-specific ribosome footprint profile is well captured by our proposed kernelsmoothed codon sequences. the performance in the subspace v k decreases as k increases. this is partly due to noise in the read alignment or the sequencing noise inherent in ribosome profiling. thus, wavelet analysis is useful for studying the limit of the ribosome profiling technique and focusing on the reliable signals. the results from using non-smoothed codon sequences were the least accurate, supporting that the neighboring codons or interference play an important role in ribosome footprint distributions. using asymmetric kernel smoothing produced more accurate results than using a symmetric kernel. the same trend also holds for flash-freeze ribosome profiles . the performance of our method on chx-treated ribosome profiles was better than that on the flash-freeze profiles. this may be due to the large amplitude of ramps near the 5 0 end in chx-treated profiles . these ramps contribute significantly to global shapes, and can be well captured by asymmetric kernel smoothing. in general, our method with asymmetric kernels was able to predict the global shape of transcript-specific ribosome density with high accuracy. however, for the flash-freeze data, the correlation in the subspace v 0 was relatively poor for the genes shorter than 250 codons. this is because the global shape of their profiles in this subspace was rather flat for the flash-freeze data. if the mean squared error is used as the performance measure, the results for shorter genes are not so much worse than that for longer genes. as an example,shows the ribosome density of ybr212w in various subspaces and the corresponding predictions for both chx-treated and flash-freeze profiles.shows heatmaps of the regression coefficients for transcripts of length 250 codons in the space v 3. this result shows that cga (arginine), ccg (proline) and cgg (arginine) have a strong influence on the global shape of ribosome occupancy in flash-freeze data, while cga and cgg seem to have the dominant effect in chx-treated data. this may be related to wobble base pairing, which has been found to be associated with slow elongation . in particular, high ribosome occupancy has been observed on wobble-paired proline ccg (g-u base pairing) and arginine cga (i-a pairing) by. furthermore, cga is one of the codons with the most prolonged elongation rates, consistent with lareau et al. to examine further how the distribution of codons may affect the shape of ribosome footprint profiles, we carried out a slidingwindow analysis for each transcript, using a window size of 20 codons. for each transcript, we first identified all windows for which the average ribosome density was larger than twice the transcript-wide average ribosome density, and then considered those windows for codon enrichment analysis. for each selected window, let x x 1 ; x 2 ;. .. ; x 64 denote the observed codon distribution, where x i is the number of codons of type i within the window. we compared this observed codon distribution with the expected. accuracy of the prediction of marginal densities for chx-treated and flash-freeze ribosome footprint data. ns, sk and ask respectively denote using no kernel smoothing, using symmetric kernel (f n ), and using asymmetric kernels (f sg ; f srg ). the pearson correlation coefficient between the prediction and the measured ribosome density was averaged over genes. the results are listed for different spaces s and various gene lengths. the prediction achieves high accuracy in the global shape spaces, e.g. v 0 and v 1. as the scale increases, i.e., as the index m of v m increases, prediction becomes more difficult. length method chx: subspace s flash-freeze: subspace s(codons)prediction of ribosome footprint profile shapes from transcript sequences i187 distribution g g 1 ; g 2 ;. .. ; g 64 , where g i denotes the expected number of codons of type i within the window, assuming sampling 20 codons without replacement according to the codon distribution in the entire transcript. note that g follows a multivariate hypergeometric distribution. we performed a paired t-test on x and g over the selected windows and identified the codons enriched in high ribosomeoccupancy regions. we then compared the p-values from the enrichment analysis with the frequencies of the regression coefficients being nonzero, as illustrated in. the scatter plot for flash-freeze data shows that all of the significantly enriched codons were selected frequently by the regression model. codons that were selected frequently but not significantly enriched in high density regions might have been selected for prediction in low ribosomal density regions. for example, it has been observed previously that ggg and gtt are some of the codons with the least footprint abundance. for the chx-treated data, there were a few codons enriched significantly but not selected frequently ; this could be due to technical biases in the data, discussed in section 4.our results on s. cerevisiae data, especially the chx-treated footprints, show that the global shape of transcript-specific ribosomein particular, they show that codons cga, ccg and cgg strongly influence the global shape of ribosome occupancy in flash-freeze data, while cga and cgg seem to have the dominant effect in chx-treated data i188 t.-y.liu et al. density can be predicted with high accuracy. this suggests that the ribosome distribution along a transcript indeed depends on the sequence context. in particular, we find a few codons that dominate the global shape; these codons influence the ribosome density not only at the site where they appear, but also their neighboring positions. there are several possible reasons why applying kernel smoothing to codon sequences helps in predicting the shape of transcriptspecific ribosome occupancy profile. one possible reason is the interference among ribosomes. another possible explanation is that the physical footprint of each ribosome spans multiple codons (910 codons). lastly, it has been shown that positively charged amino acids on nascent peptides significantly slow down ribosomes downstream from where the residues are encoded. among all the methods compared, the asymmetric kernel smoothing performed the best. this could be due to the directional movement of ribosomes and the aforementioned effect of positively charged amino acids on downstream elongation speeds. also, 5 0 ramps can be better predicted using asymmetric kernels, which partly explains why the prediction accuracy for chx-treated ribosome profiles was slightly better than that for flash-freeze profiles. there are other factors not incorporated into our current model that could also help to explain ribosome distributions, e.g. mrna secondary structure. notice that in the results for chx-treated ribosome footprints, we achieved better performance in shorter genes. when applying a sliding window to genes with a prediction correlation coefficient below 0.3 and of length 10011500 codons, we observed that the correlation was lower near the 5 0 end. furthermore, when computing differences between the observed ribosome densities and the predicted densities from these poorly predicted genes, we noticed a weak positive correlation (r 0.0446) between the differences and the likelihood of double stranded conformations, i.e., the pars (parallel analysis of rna structure) scores of secondary structure defined byin a genome-wide measurement. although many potential factors including mrna secondary structure, codon usage bias, trnaadaption index, etc.are not explicitly incorporated into our model, most of these factors depend on the sequence context. this may be one of the reasons why considering transcript sequences alone enables reasonably accurate prediction of ribosome footprint profile shapes. it is possible that some of the features learned by our predictive model are due to technical biases in the data. library construction is a possible source of bias due to technical artifacts. artieri and fraser (2014) found three types of nucleotide biases by comparing mrna fragments (unprotected by ribosomes) with ribosome footprints to identify shared biases. these include an enrichment of adenine at the 5 0 and 3 0 ends, and a depletion of cytosine at the fourth nucleotide position in both the mrna and ribosome footprint reads. however, we note that the flash-freeze ribosome footprint data we analyzed were generated using a comprehensive set of adapter sequences to avoid the biases discussed in artieri and fraser (2014). furthermore, the flash-freeze protocol avoids the ribosome run-off phenomenon that can occur in chx pre-treatment. different models have been proposed in the literature to estimate elongation rates.developed a continuous-time, discrete-state markov model to simulate translational dynamics, in which initiation and elongation rates were inferred using the cell volume, ribosome abundance and trna abundance. these elongation rates were codon dependent but not position dependent. the model proposed bywas based on flow conservation, and it assumed that the occurrences of the same codon within an mrna transcript have the same dwell time, and hence the same elongation rate. our results suggest that these models should take the codon position into account. in other words, the elongation rate at a particular position along a transcript not only depends on the codon at that position but also the neighboring codons and how the neighboring codons are ordered.part of the results presented in this paper is based on combining four publicly available datasets. this overcomes the difficulty of sparse sampling that other work may encounter, e.g.. although our study is limited to the steady-state distribution of ribosomes, it examines the extent to which the sequence context influences ribosome distributions under normal conditions. one of the important applications of our method is to examine the positions where the steady-state prediction is significantly different from the actual measurements. these positions may lead to important findings of unknown factors that regulate translation. for example, our proposed method can be applied to cells grown under various environmental conditions, or to ribosome profiles obtained by different inhibitors, e.g. harringtonine , anisomycin . another application is the inference of isoform-specific ribosome footprints. it is known that many human genes have more than one isoform, and these isoforms contribute to the complexity of phenotypes . studying the translation of specific isoforms requires correctly assigning ribosome footprints to them. however, since the footprints of ribosomes are short (2830 nucleotides), identifying the correct isoform becomes challenging. our method provides a likelihood function for ribosome location, and can facilitate sequence alignment when more than one alignment exists. synthetic biology is another active research area that can benefit from our work: the ability to predict and compare the ribosome densities along different transcripts under various environmental conditions can facilitate the search for sequences with optimal translational properties and reduce the number of experimental trials necessary to build and test the sequences.  
