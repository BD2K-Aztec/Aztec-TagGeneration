transwesd: inferring cellular networks with transitive reduction motivation: distinguishing direct from indirect influences is a central issue in reverse engineering of biological networks because it facilitates detection and removal of false positive edges. transitive reduction is one approach for eliminating edges reflecting indirect effects but its use in reconstructing cyclic interaction graphs with true redundant structures is problematic. results: we present transwesd, an elaborated variant of transitive reduction for weighted signed digraphs that overcomes conceptual problems of existing versions. major changes and improvements concern: (i) new statistical approaches for generating high-quality perturbation graphs from systematic perturbation experiments; (ii) the use of edge weights (association strengths) for recognizing true redundant structures; (iii) causal interpretation of cycles; (iv) relaxed definition of transitive reduction; and (v) approximation algorithms for large networks. using standardized benchmark tests, we demonstrate that our method outperforms existing variants of transitive reduction and is, despite its conceptual simplicity, highly competitive with other reverse engineering methods. contactreverse engineering of cellular networks has become a key methodology in analysing and exploiting the increasing amount of data generated by omics technologies . whereas the structure of metabolic reaction networks could be reconstructed mainly from genomic informationin great detail for many organisms knowledge of the topology of regulatory and signal transduction networks is in many cases still incomplete and wiring diagrams even of canonical signalling pathways may differ in different cell lines . the ultimate goal of reverse engineering methods is the identification of interactions between the involved players (genes, proteins, etc.) by analysing data of systematic and controlled perturbation experiments. the result is a network, in many cases represented as a graph, which can be directed or undirected and to whom correspondence should be addressed. may have signs and/or weights at its edges. some algorithms deliver refined representations such as boolean networks , reaction networks or differential equations but the main result is still the underlying network topology. a simple yet smart method for reverse engineering is based on transitive reduction, a graph theoretical method whose potential for reconstructing regulatory networks was first recognized by. the basic idea is as follows: to reconstruct a regulatory network with n nodes, one first measures the state of the nodes in the wild-type and then performs at least n perturbation experiments: in experiment i node i is perturbed, whereas all other n1 nodes are screened whether they changed their state compared to the wild-type. if a perturbation in i affected j, a directed edge from node i to j, denoted by i j, is drawn. the complete set of these observed effects in all perturbation experiments yields the perturbation graph. each edge in the perturbation graph reflects either a direct or an indirect effect of one node upon another. the next step deals with a central issue in network reconstruction, namely identification and removal of edges that represent indirect effects. transitive reduction as used byaims at finding the minimal (most parsimonious) subgraph that can explain all effects seen in the experiments. transitive reduction in its most general form allows removal and addition of edges to find the minimum graph . however, in the context of network reconstruction, one usually focuses on the special case where edges may only be removed, i.e. where one searches for a minimal subgraph explaining the perturbation graph [also known as minimum equivalent graph problem (. herein, we only consider transitive reduction based on edge removals.determined the minimal subgraph from the perturbation graph by removing all edges i j for which a (simple) path starting in i and ending in j (not using i j) can be found, assuming the effect of i on j to be indirect, thus explainable by the path. the resulting graph is the transitive reduction of the perturbation graph. a simple example is depicted in. every acyclic graph has a unique transitive reduction (with a minimal number of edges;) explaining all measured perturbation effects. the method proposed byis easy to implement but has some drawbacks that might be the reason for its rare application. first, transitive reduction as described above does not consider the full amount of information that is available from perturbation experiments, even when considering only qualitative observations. if a node shows a significant response to a perturbation, one can at least classify the measured effect as up or down. this informationpage: 2161 21602168can be taken into account by adding a sign label to each edge in the perturbation graph, which becomes then a signed directed graph (seesigned version of). transitive reduction can then be performed in a similar way: an edge i j is deleted only if there is a path from i to j whose overall sign (product of the signs of the involved edges) corresponds to the sign of this edge. as can be seen in the example in, this may save edges that were mistakenly deleted in the unsigned version. a second drawback of the original approach of transitive reduction is the risk to remove true edges, even in signed perturbation graph. the radical pruning strategy of transitive reduction aims at minimizing false positive (fp) edges in the reconstructed network but it may lead to a high number of false negatives (fns). this effect becomes visible in networks comprising many (coherent) feed-forward loops where a node may affect another node via direct (edge) and indirect (path) links of the same sign. since feed-forward loops have been shown to occur frequently in gene regulatory networks , this property can become a serious limitation of the method. a third shortcoming is the prerequisite that the perturbation graph is acyclica condition that is often not fulfilled in realistic biological networks. if the perturbation graph is cyclic, the solution of transitive reduction is, in general, not unique. as we will see, negative cycles in signed perturbation graphs may bring about even more complications for transitive reduction. in this article, we will present transwesd (transitive reduction in weighted signed digraphs), a new variant of transitive reduction that seeks to overcome these problems. generalizations of transitive reduction to signed and cyclic directed graphs have been proposed by other authors . however, our approach combines and extends existing variants and differs in several key aspects (e.g. use of weighted perturbation graphs, treatment of negative cycles and handling of elementary versus non-elementary paths). we also discuss issues related to the identification of significant perturbation effects, a key step in generating the perturbation graph. using standardized benchmark tests, we demonstrate that our method outperforms existing variants of transitive reduction and is, despite its conceptual simplicity, highly competitive with other reverse engineering methods.using the developed reverse engineering methodology presented herein, we took part in the fourth challenge of the dialogue of reverse engineering assessments and methods (dream4) on in silico gene network reconstruction. the dream initiative offers a platform for objective assessment of rivalling methods based on in silico data providing a realistic scenario for high-throughput gene expression profiling and reconstruction of gene regulation networks . from the dream4 challenge, we present the results of our method for the dataset insilico_size_100 subchallenge, which can be downloaded from the dream website (http://wiki.c2b2.columbia.edu/dream/ index.php/the_dream_project). based on 5 sub-networks of 100 nodes sampled from gene networks of escherichia coli and yeast, realistic kinetic models with randomly selected parameters were generated and simulated with genenetweaver using stochastic differential equations. for reconstructing these networks, in silico measurement data were provided containing noisy steady-state mrna expression levels of wild-type and singlegene knockout and knockdown experiments as well as time-series data. the gold standards of the five networks were provided after announcing the results of all submissions and we can thus compare our computed results to the real networks. for each network, we first generated the perturbation graph as described above using the wild-type and knockout steady-state data. the two required parameters were trained from the dream3 challenges. edge weights were computed as conditional correlation coefficients from knockout and knockdown data. the results were very similar when using only the knockout data. the provided time series data were not used at all. we then applied transitive reduction with transwesd to the generated perturbation graphs yielding the final reconstructed graph. found edges were sorted according to their weight required for performance analysis [relevant for auroc (area under the receiver operator characteristics curve) and aupr (area under the precisionrecall curve) values; see below]. for comparison with the method of, we used net-synthesis to apply their algorithm of transitive reduction in the unweighted version of the perturbation graph. we also implemented the sos (save our signs) pruning procedure proposed by. this transitive reduction method also operates on weighted graphs but differs from transwesd in two key aspects: (i) as discussed in section 2 and analogous to net-synthesis, this pruning approach accepts non-elementary paths (containing negative cycles) for explaining edges and (ii) the length of a path is computed as the product of edge probabilities. based on this metric, an edge z v is removed if there is a (elementary or non-elementary) path z v of the same sign whose overall probability is larger than the probability of the edge z v. actually, sos pruning distinguishes two probabilities, one for having a positive edge (p + ) and one for having a negative edge (p ) and the sign s of the edge is given by the sign of p + p . for the dream setting, we used the same perturbation graph as for transwesd and we assigned the conditional correlation coefficients either with full amount to p + (if s is positive) or to p (if s is negative), whereas the other probability was set to zero.summarizes the results for all five networks and indicates for each inferred network the number of tp/fp/tn/fn edges, the computation time and standard statistical metrics assessing the quality of reconstructed networks. the latter were determined by the dream evaluation scripts and include auroc, aupr as well as pauroc and paupr (probabilities that a given or larger auroc/aupr value is obtained by random network link permutation as estimated from 100 000 runs; see). as the aupr value is more sensitive in sparse networks it is especially useful to assess the quality of reconstructed gene regulatory networks. the p-values reveal that our method produces results that are significantly better than randomly chosen networks. this even holds for the perturbation graph alone indicating that an appropriate thresholding strategy for classifying observed changes as relevant or not delivers large amounts of meaningful information. note that even the raw perturbation graphs obtained by our thresholding strategy outperform many solutions submitted to the dream4 challenge. applying transwesd to the perturbation graphs increased the aupr value in four of five networks, whereas in one network (2) aupr decreased marginally. as expected, the desired removal of fps by transitive reduction is inevitably accompanied by the removal of some tps. this often implies a decrease in the auroc value. however, in most of the cases this reduction is about one magnitude lower than the improvement in aupr. the positive effect of transitive reduction becomes more apparent when looking at the p-values and at the numbers of true and fps. in network 3, for example, the number of fps could be reduced by 98 (from 291 to 193) sacrificing only 3 tps (reducing the tps from 85 to 82), which results in a moderate increase of aupr from 0.309 to 0.326 and a more significant increase in the p-value from 6.23e-111 to 1.97e116. the effect of transwesd becomes even more pronounced if we take the same data but based on deterministic simulation without any noise (these data were provided when releasing the results of the challenge). for illustration,displays the results when taking noise-free data for network 5. without noise we can choose small thresholds, e.g. = 0.005 and = 0. as expected, auroc and aupr are much higher already in the perturbation graph. but using transwesd we can further increase the aupr (paupr) value from 0.442 (6.82e-102) to 0.567 (9.11e-132). the number of fps is reduced from 476 to 110, whereas the number of fns increases moderately from 33 to 61. hence, a perturbation graph with high quality increases the effectiveness of transitive reduction. in network 2, we observed a decrease of the aupr measures when applying transwesd, although the number of fps is reduced by 71 compared to 12 additional fns. strikingly, when announcing the results of dream4 challenge, it was mentioned that network 2 exhibited oscillations and that the knockout data provided represented, therefore, transient and not steady-state data. under those conditions, some edges in the perturbation graph may correspond to perturbation responses resulting from the action of non-elementary influence paths (with negative cycles) leading to a higher error rate of transwesd. as expected, the computational costs for generating the perturbation graph are constantly low. in contrast, running times for applying the full transwesd algorithm varies for the different networks and may become extensive. in two networks (1 and 4), we were able to apply the exact algorithm to the perturbation graph in reasonable time. for the other networks, we interrupted the exact algorithm after 5 h and used the approximate variant (approximate shortest path computation and no recalculation of paths after edge removals), which in all networks needed 5 s. checking the approximation results for errors [removed edges violating], we saw that the simplified algorithm introduced no errors in any of the five networks indicating that the simplified algorithm delivers reasonable approximations in realistic gene regulatory networks. however, when choosing 1 the number of errors may quickly increase, especially if the network contains positive cycles (data not shown). we also computed the transitive reduction using the method ofimplemented in net-synthesis taking as input the same perturbation graph as used for transwesd (without weights). as the computed result is non-unique and very sensitive to edge ordering, we repeated the computation for 10 different (random) orderings and took the best result [in terms of aupr value; for fair comparison, we sorted the (remaining) edges in the final graph also with respect to the edge weights taken from the perturbation graph]. the algorithm is much faster than full transwesd (but comparable with the approximate version: 5 s in all networks) and removes much more edges resulting in significantly less fns. however, this comes at the price of eliminating a relatively high number of tps. the resulting aupr values are constantly significantly lower than in networks obtained by transwesd. it even turns out that all networks obtained by net-synthesis have (partially considerably) lower auroc and aupr values than the perturbation graphs from which they were produced. these results indicate that the attenuated pruning strategy of transwesd based on edge weights is highly advantageous for reconstructing regulatory networks. probably for this reason, the sos pruning strategy ofwhich also operates on weighted graphsyielded better results than net-synthesis. however, the improvement in the aupr value (if it increased the aupr value of the perturbation graph at all) is significantly lower than for transwesd except in the problematic case of the nonstationary network 2, where sos pruning performed slightly better but also led to a decrease of the aupr value compared to the perturbation graph. generally, sos pruning deleted significantly less edges than transwesd, which can probably be attributed to the very conservative metric (multiplication of probabilities) used by sos pruning for quantifying path lengths. as a proof of principle, with the results presented in, our algorithm was ranked on place 3 (out of 19 submissions) in the dream4 insilico_size_100 sub-challenge. this result is page: 2167 21602168  
