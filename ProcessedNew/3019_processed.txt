mmr: a tool for read multi-mapper resolution motivation: mapping high-throughput sequencing data to a reference genome is an essential step for most analysis pipelines aiming at the computational analysis of genome and transcriptome sequencing data. breaking ties between equally well mapping locations poses a severe problem not only during the alignment phase but also has significant impact on the results of downstream analyses. we present the multi-mapper resolution (mmr) tool that infers optimal mapping locations from the coverage density of other mapped reads. results: filtering alignments with mmr can significantly improve the performance of downstream analyses like transcript quantitation and differential testing. we illustrate that the accuracy (spearman correlation) of transcript quantification increases by 15 when using reads of length 51. in addition, mmr decreases the alignment file sizes by more than 50, and this leads to a reduced running time of the quantification tool. our efficient implementation of the mmr algorithm is easily applicable as a post-processing step to existing alignment files in bam format. its complexity scales linearly with the number of alignments and requires no further inputs. availability and implementation: open source code and documentation are available for down-load at http://github.com/ratschlab/mmr. comprehensive testing results and further information can be found ataddressing the increasing need for fast and accurate mapping of highthroughput sequencing data to a reference sequence, many different software tools have been developed over the past years, many of which are frequently updated and improved . while numerous challenges have been addressed by the developers, e.g. the consideration of gaps and mismatches or the spliced alignment of rna-sequencing data, the problem of ambiguous read mapping still remains unresolved for many of the most popular alignment tools. depending on factors like read length, alignment sensitivity and repetitiveness of the target genome, a large fraction of reads aligns uniquely to the target and exactly one mapping location is reported. however, for the remaining, still significantly large, fraction of reads (1020, depending on alignment sensitivity), several possible mapping locations exist. currently, different strategies are employed to deal with these reads in downstream analyses, most of which have unfavorable side effects: discarding reads with ambiguous alignments from the alignment result leads to a systematic underestimation of abundance in genomic regions with multi-mapper ambiguities, whereas picking a random alignment or distributing weight across all alignments uniformly does not have a proper biological justification. we provide a brief review of related approaches in supplementary section a.5. here, we present a simple, yet powerful tool, called the multimapper resolution (mmr) tool, that assigns each read to a unique mapping location in a way that the overall read coverage across the genome is as uniform as possible. mmr makes use of the criticalas a proof of principle, we tiled the a.thaliana genome with overlapping 50-mers and aligned these 50 nt reads back to the genome. this resulted in a non-uniform coverage, in particular near repetitive regions (see supplementary). using mmr, we could fully resolve mapping ambiguities, resulting in the expected uniform coverage of 50 almost everywhere. although mmr has been successfully used in several studies , we wanted to rigorously test our approach on a set of 7 million artificial rna-seq reads that were generated with fluxsimulator based on a subset of 5000 genes randomly drawn from the human gencode annotation (v19). we simulated read sets of length 32 nt, 51 nt, 76 nt and 101 nt, resulting in average coverages between 9 and 28. the reads were then mutated using an empirical error model that led to a native error rate of 0.9. three levels of random noise (1, 2, 3) were applied in addition. we aligned the reads with tophat2 (v2.0.2;) and palmapper (v0.6;), allowing for up to 6 edit operations, with no annotation provided. further information is provided in supplementary section b.2. to investigate the effect of mmr on downstream analyses, we performed transcript quantification using cufflinks (v2.1.1) and rquant (unfiltered best mmr. mmr results on simulated read data: quantification results on 7 million simulated 51 nt reads aligned with tophat2, using rquant and cufflinks. accuracy was measured as spearman correlation to ground truth. unfiltered read sets are shown in dark, best-hit read sets in medium and mmr-filtered in light gray. native error rate is 0.9, noise levels 13 mmr: a tool for read multi-mapper resolutionmmr-filtered alignments, the best alignments only (the alignment ranked highest by the aligner) and on completely unfiltered alignments. for tophat2 and palmapper, the quantifications based on the mmr-filtered alignments showed a consistently better correlation to the ground truth than both the best-hit and unfiltered alignments sets. the shorter reads of length 51 nt showed larger improvements compared to unfiltered (cufflinks: 2.7, rquant: 15.0) and best-hit set (cufflinks: 5.6, rquant: 4.0) than the longer reads of length !76 nt, that showed consistent but smaller improvements (supplementary figs s5s7).we presented mmr, a post-processor for bam files, resolving ambiguous alignment locations. we showed its easy applicability to the output of different alignment methods and illustrated that mmr can greatly improve accuracy of downstream quantification methods. although the improvements seem moderate on a global scale, the effect on single genes can be much larger. given its lean implementation and the short running time, mmr is very well suited for large-scale genome-, exomeand rna-sequencing efforts. its good performance on short reads also suggests an application to ribosome footprinting data . mmr may also be useful for post-processing alignments in meta-genome projects for improved selection of taxa.  
