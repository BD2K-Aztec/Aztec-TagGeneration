Correcting errors in short reads by multiple alignments Motivation: Current sequencing technologies produce a large number of erroneous reads. The sequencing errors present a major challenge in utilizing the data in de novo sequencing projects as assemblers have difficulties in dealing with errors. Results: We present Coral which corrects sequencing errors by forming multiple alignments. Unlike previous tools for error correction, Coral can utilize also bases distant from the error in the correction process because the whole read is present in the alignment. Coral is easily adjustable to reads produced by different sequencing technologies like Illumina Genome Analyzer and Roche/454 Life Sciences sequencing platforms because the sequencing error model can be defined by the user. We show that our method is able to reduce the error rate of reads more than previous methods. Availability: The source code of Coral is freely available atNext-generation sequencing technologies, such as Illumina Genome Analyzer, Applied Biosystems SOLiD and Roche/454 Life Sciences DNA sequencing platforms, produce a vast amount of reads in a single run. Vagaries of the reads produced by each sequencing machine are still being discovered. Correction of errors in short reads is a critical task in bioinformatics. The variety of errors and biases of the current sequencing platforms must be addressed if the data is to be used to maximum effect. Error correction aims to revert these mistakes made by a sequencing platform by exploiting the redundancy of the data and judging each base in a read as correct or incorrect (and then ideally correcting it). Error correction helps to achieve high data use in de novo assembly. Furthermore, the computational demands of assembly algorithms are reduced significantly if reads are first corrected. Although we evaluate here the impact of error correction on de novo assembly, the technique could also be useful in other applications because error correction can potentially increase the mappability of reads in resequencing as well as in other applications of high-throughput sequencing. To whom correspondence should be addressed.Error characteristics of the different platforms are complex, making error correction a difficult task. For instance, the Roche/454 sequencing platform produces reads with indel errors, due mainly to homopolymers, whereas the SOLiD and Illumina platforms are prone to substitution errors.investigate quality score evolvement, error characteristics and biases of short sequencing reads. The first error correction method that is aimed at short read datasets is built into the assembly tool Euler SR . It uses the spectral alignment method, which first establishes a spectrum of trusted k-mers from the input data and then corrects each read so that it contains only sequences from the spectrum. Shrec byfollowed, a stand-alone error correction method. Shrec is based on a parallelized suffix-trie data structure that holds a set of reads and corrects errors with a majority voting scheme. Shrec was extended by Salmela (2010) to accommodate hybrid sets of reads from various sequencing technologies, with different read lengths and error characteristics. HiTEC byuses a suffix array of the reads to count how many times short sequences are present in the read set and use these counts to correct the reads. The approach byrevisits the idea of Chaisson and Pevzner by overlaying reads with trustworthy tiles (pairs of k-mers), and correcting differences between the reads and the tiles to obtain error corrected read sets. Quake byis another recent method that relies on spectral alignments to correct reads. In this article, we present Coral (=CORrection with ALignments), a novel approach, which relies on multiple alignments of short reads to correct errors in the data. The idea of using multiple alignments for correcting sequencing reads is not new. For example, the preprocessing in the Arachne assembler and the MisEd error correction tool use multiple alignments to correct reads from the older Sanger technology . Our new tool is the first to apply this approach to short read data. Most of the recent error correction tools are aimed at reads from the Illumina Genome Analyzer platform and therefore they are limited to correcting substitutions which is the dominant error type in Illumina reads. Coral is easily adjustable to different error models of the various sequencing platforms. Furthermore, adjusting the error model is easily accessible to the end user who only needs to set the familiar parameters of multiple alignments, gap penalty and mismatch penalty, to appropriate values according to the error model. For example, for Illumina reads one needs to set the gap penalty to a high value effectively disallowing indels, whereas oneThe aims of the experiments were 2-fold. First, we measured the quality of correction, and its effect on subsequent assembly. Secondly, the computational resources required for the new method were compared to alternative approaches (SHREC, Quake and Reptile). 1Experimental setup: for testing we used the datasets listed in. Unlike in other publications on the topic, we consider only real sequencing data and no simulated reads. We believe that none of the available read simulators can grasp the true characteristics of next-generation sequencing technologies, and thus observations on simulated data may be invalid. All tests were conducted on an otherwise idle AMD Opteron machine with 4 2.6 GHz CPUs, 32 GB main memory and 1024K L2 Cache. The operating system was Ubuntu Linux version 8.04.4 LTS. The compiler was g++ (gcc version 4.2.4) executed with the-O3 option. Times given are the average of two runs and were recorded with the Linux/Unix time command. To test the performance of the short read error correction tools under investigation, we first have to distinguish correct from erroneous bases in the experimental data. We accomplish this by mapping the reads to their respective references and defining mismatches and indels as errors in the sequence reads. This is common practise, as can be seen in the publications by . However, this method bears risks, since genomic variants such as SNPs can be defined as errors, and ambiguously mapping reads can lead to false classifications of bases as well. This is a general problem with short read data for applications like error correction, assembly or mapping, since the actual genomic sequence is hardly ever known, as that is the target of discovery. To minimize the risk of false classification, we only consider uniquely mapping reads for our experiments. Also, this disadvantage is the same for all of the tested methods. We used SOAP byfor mapping the Illumina reads and SHRiMP byto map the Roche/454 reads. We can then assess the performance of an error correction method by identifying how many of the alleged errors in the data it can correct. From these numbers, other statistics like specificity, sensitivity or gain can be inferred, which will be explained below. Such statistics, however, are not entirely satisfactory to assess the quality of corrections of a method, because it is unclear which statistic (when optimized) will indeed yield the best performance for other applications depending on the data. Since error correction of short read data really is a preprocessing step for other applications like assembly, we assess performance on the impact on this key Page: 1459 14551461The runtime is given as total runtime and CPU time (where applicable). application for short read data. For this purpose, we choose Edena by , a well-established short read assembler, to run on the corrected read sets.@BULLET Coral: standard parameters (with the appropriate configurations with regards to the sequencing platforms):-illumina/-454. Note, that we did not explore the parameter space to obtain optimal results for any of the error correction methods. In reality, when working on a read set fresh off a sequencing platform, there is no immediate feedback for the user, to identify good or bad error correction, which makes parameter choices hard. For this reason, we ran the tools with a best guess kind of configuration, to make it more indicative of a real application. For Shrec, this meant adjusting the cutoff value c, for Coral standard parameters and for Reptile standard configuration as well, since it estimates all the important statistics by itself. Statistical error correction performance: to assess the accuracy of the different methods by numbers, we identify the above four categories of error classification and then deduct the following statistics: @BULLET Sensitivity = TP/(TP + FN), the sensitivity towards erroneous bases. @BULLET Gain = (TP FP)/(TP + FN), as introduced by, a statistic to combine the two intuitions of removing errors without introducing additional ones. 
