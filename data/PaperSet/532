Systems biology Assigning spectrum-specific P-values to protein identifications by mass spectrometry Motivation: Although many methods and statistical approaches have been developed for protein identification by mass spectrometry, the problem of accurate assessment of statistical significance of protein identifications remains an open question. The main issues are as follows: (i) statistical significance of inferring peptide from experimental mass spectra must be platform independent and spectrum specific and (ii) individual spectrum matches at the peptide level must be combined into a single statistical measure at the protein level. Results: We present a method and software to assign statistical significance to protein identifications from search engines for mass spectrometric data. The approach is based on asymptotic theory of order statistics. The parameters of the asymptotic distributions of identification scores are estimated for each spectrum individually. The method relies on new unbiased estimators for parameters of extreme value distribution. The estimated parameters are used to assign a spectrum-specific P-value to each peptide-spectrum match. The protein-level confidence measure combines P-values of peptide-to-spectrum matches. Conclusion: We extensively tested the method using triplicate mouse and yeast high-throughput proteomic experiments. The proposed statistical approach improves the sensitivity of protein identifications without compromising specificity. While the method was primarily designed to work with Mascot, it is platform-independent and is applicable to any search engine which outputs a single score for a peptide-spectrum match. We demonstrate this by testing the method in conjunction with X!Tandem.Improvements in specificity, sensitivity and throughput of protein identifications progress at unprecedented pace. However, the scope of available mass spectrometric and informatics technologies and divergence of their physicochemical and algorithmic bases contributes to growing concern regarding the reproducibility, transparency and statistical reliability of the proteome analysis. In bottom-up proteomics, the identification proceeds via matching peptide MS/MS spectra to a database of sequences. The identity of proteins present in the sample is then inferred from individual peptide matches. While many peptide identifications are seemingly undisputed within any statistical framework, a large fraction of hits fall into borderline significance range. The ability to accurately assess the statistical significance of these identifications would increase specificity and sensitivity of mass spectrometry analyses. More importantly, at the protein level, a single estimate of statistical significance should combine evidence from all tandem mass spectra matched to the same protein. Arbitrary conventions that are employed for maintaining protein identification consistency will be rendered unnecessary by such estimate. At the peptide level, current identification methods can be classified into false discovery rate (FDR) approaches, P-value-based approaches, and posterior probability-based approaches. FDRs are typically estimated by searches against a decoy database (e.g. a database of reversed and/or randomized protein sequences) . A threshold determining statistical significance is selected specifically for a given dataset and a given peptide-to-spectrum scoring metric. More sophisticated statistical approaches involve simulations and analytical approximations . However, a single FDR threshold is applied to all spectra from the dataset. Therefore, it is not informative about statistical significance of individual matches and the estimate of the FDR threshold usually has a large variance. Specificity and sensitivity of identifications can be increased by stratifying peptide-spectrum matches (PSMs) using properties of spectra or peptide length in a statistical or machine learning framework. A number of recently developed methods report P-values specific to individual spectra. These methods are primarily basedPage: 1129 11281134We tested the method using two proteomic datasets obtained from in-gel trypsin digestion of (i) yeast and (ii) mouse brain proteins, analyzed with a Thermo LTQ-FT mass spectrometer (see Section 2). The datasets represent highly complex peptide mixtures from the two species. To confirm that P-values accurately estimate fraction of false positive identifications, we run searches in two sets of decoy databases. P-values corresponding to individual peptide or protein identifications determined in one decoy database set are plotted against the corresponding fractions of identifications in the other (qq-plot). By the definition of P-value, the fraction of false-positive identifications (estimated by the fraction of identifications in the decoy databases) at a given P-value should ideally be equal to this P-value. The qq-plots are shown inand in Supplementary Figures S1 and S2. As seen from the qq-plots, P-values provide practically acceptable approximation of the rate of false-positive identifications, i.e. predict fraction of decoy database hits below a specified P-value threshold. For example, the fraction of falsepositive identifications at P-value threshold 0.01 in the three mouse datasets is in the range of 0.00640.0119, and in the yeast datasets of 0.01200.0126. Next, P-values generally discriminate between searches in the forward (real) and reverse (decoy) databases better than peptide ion scores assigned by Mascot. At the 1 FDR threshold as determined by the search against the decoy database, selecting database hits by P-value rather than by score increases the number of identifications in the forward (real) sequence database. In addition, we tested the performance of spectrumspecific P-values using one other measure recommended by Matrix Science (www.matrixscience.com/pdf/2005WKSHP4.pdf)., shows the ROC curve when Mascot Ion score minus Identity score is used as a discriminant function, similar to. We find that ion minus identity score performs approximately equally well to ion score in discriminating true Page: 1132 11281134positive versus false positive hits. Spectrum-specific P-values outperform either combination of ion and identity scores. To test whether spectrum-specific P-values indeed allow peptide identifications with borderline ion scores, we analyzed the distribution of reverse database hits with respect to both ion score and P-values. As seen from, upper part, the fraction of reverse database hits for scores in the range 1020 is approaching the fraction of forward database hits, indicating that in this score range any forward hit is as likely to be true as false. The fraction of reverse database hits for scores in the range 2030 compared with forward identifications is much smaller. However, it is still of the order of 1. Applying strict P-value threshold eliminates almost all reverse database hits (, lower part and Supplementary Tables S3 and S4) while retaining significant number of forward database hits. Most of these forward hits were supported by at least two confident peptide identifications from the same protein, confirming that these forward hits are likely correct.and Supplementaryis another demonstration that identification by spectrum-specific P-values significantly outperforms identification by Mascot ion score. We count the fraction of reverse database hits at 1 FDR level obtained using Mascot ion score but not by the 1 FDR threshold if sorted by P-value. Conversely, we count the fraction of reverse database hits at the 1 FDR level obtained by sorting database hits by P-value but not by Mascot ion score.shows that the fraction of peptides passing only FDR cutoff is significantly higher than the fraction of peptides passing only Mascot score cutoff. In all datasets, results of the search according to P-values leads to higher number of true positive hits (approximated by hits in the database of real protein sequences) per false-positive hit (approximated by hits in the database of reversed protein sequences). Selecting peptide identifications by P-value rather than score leads to increased sensitivity at any specificity threshold (, Supplementary Figs S3 and S4).In addition to the performance comparison with raw Mascot scores, we tested the FDRs obtained with our method against those obtained using PeptideProphet. PeptideProphet source code TPP v4.4 was downloaded from http://proteinprophet.sourceforge.net/. For each of the three mouse and three yeast datasets, we ran xinteract to identify PSMs in combined target plus reversed database. Supplementaryshows the comparison of FDRs for peptides identified with PeptideProphet and using spectrum-specific P-values. Spectrum-specific P-values outperform PeptideProphet by 510, depending on the dataset. At the protein level, the use of P-values combining evidence from multiple peptides increases sensitivity over a conventional method of protein identification based on the score of the best scoring peptide from the protein (, Supplementary Figs S3S4). Importantly, the major increase in the number of truepositive identifications per false-positive identification (increase in sensitivity at a given specificity level) is observed at strict thresholds corresponding to low rate of false-positive identifications. This means that spectrum-specific P-values confidently validate mediumscoring true positives while efficiently suppressing high scoring false positives. To exclude the possibility that these additional identifications in the forward database are false identifications, we repeated the analysis limiting it to confidently identified proteins, i.e. proteins with at least three matching peptides (Supplementary). Spectrum-specific P-values increase the number of these confidently true positive identifications at any FDR cutoff. To demonstrate generality and platform independence of our approach, we applied spectrum-specific P-values to identifications made by X!Tandem platform (Supplementary Materials). We computed peptide P-values using parameters estimated from top hits according to X! Tandem hyperscore in searches against 50 decoy databases. These P-values are shown to provide accurate rate of false-positive identifications, as seen from qq-plots (, Supplementary). Discrimination between searches in forward and reverse databases by P-values versus X!Tandem E-values is shown in Supplementary Figures S7 and S8.We propose a method and software to assign statistical significance to peptide and protein identification by mass spectrometry. A single probabilistic confidence measure (P-value) is assigned to each identification. This P-value is spectrum-specific and independent of instrumentation or software scoring method. The platform independence is achieved because the method makes very few assumptions about the distribution of the PSM scores. It is based on the asymptotic extreme value distribution. The parameters of the extreme value distribution are estimated using newly obtained analytical unbiased estimates. 
