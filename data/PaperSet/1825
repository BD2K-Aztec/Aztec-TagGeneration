Finding metabolic pathways using atom tracking Motivation: Finding novel or non-standard metabolic pathways, possibly spanning multiple species, has important applications in fields such as metabolic engineering, metabolic network analysis and metabolic network reconstruction. Traditionally, this has been a manual process, but the large volume of metabolic data now available has created a need for computational tools to automatically identify biologically relevant pathways. Results: We present new algorithms for finding metabolic pathways, given a desired start and target compound, that conserve a given number of atoms by tracking the movement of atoms through metabolic networks containing thousands of compounds and reactions. First, we describe an algorithm that identifies linear pathways. We then present a new algorithm for finding branched metabolic pathways. Comparisons to known metabolic pathways demonstrate that atom tracking enables our algorithms to avoid many unrealistic connections, often found in previous approaches, and return biologically meaningful pathways. Our results also demonstrate the potential of the algorithms to find novel or non-standard pathways that may span multiple organisms.Over the last few decades, experimental studies on metabolic networks, coupled with computational methods, have generated increasingly large amounts of data. In turn, many specialized databases have been created to store and organize information about metabolic networks . These networks are usually presented as many small subpathways that are manually divided based on function. However, it is often difficult to navigate these subpathways to find connections between compounds, especially for novel or non-standard routes used in applications such as metabolic engineering. Furthermore, as more information is accumulated from metagenome work on multispecies communities, it is of interest to find pathways that are a composition of the metabolic pathways from multiple organisms. Combining parts of pathways existing in different organisms can lead to new ways of considering how metabolism works in complex To whom correspondence should be addressed. communities and provide novel routes to form important and useful compounds. Consequently, computational identification of biologically relevant pathways in large metabolic networks is required for applications such as metabolic engineering, metabolic network analysis and metabolic network reconstruction . The main contribution of this article is a pair of algorithms that find metabolic pathways by using atom mapping data to track the movement of atoms through metabolic networks. One algorithm finds linear pathways and the other algorithm finds branched pathways. They both take as input atom mapping data, a start compound, a target compound, a minimum number of atoms to conserve and a maximum number of pathways to return. A set of metabolic pathways, which conserve at least given number of atoms from the start compound to the target compound, are returned. Atom tracking is a crucial feature in finding meaningful metabolic pathways because it essentially eliminates spurious connections and reactions that do not correspond to useful or real biochemical pathways or reactions, which are present in earlier work . Furthermore, we are able to harness atom tracking in order to find branched pathways. While atom tracking does increase the complexity of finding pathways, we demonstrate that our algorithms can efficiently identify both linear and branched metabolic pathways, in which a certain threshold of atoms are conserved. The resulting metabolic pathways are validated on known functional pathways and reveal the potential of our algorithms to find novel or alternative pathways that may span multiple organisms.In this section, we first provide a brief evaluation of our approach on linear pathways. We then present three biologically motivated examples of branched pathways found by our algorithms that cannot be found using pathfinding methods available in the literature. The atom mapping graph used in all of the experiments contained 5844 compound nodes and 22 920 mapping nodes, built from KEGG RPAIR data. From the KEGG REACTION database, we obtain 7340 reactions from over 1000 organisms which have corresponding KEGG RPAIR entries. The KEGG data was acquired in July 2009. For the purposes of the results in this article, only carbon atoms were tracked, but the methods described can be used to track atoms of interest as long as proper atom mapping data is provided. The resulting pathways presented are ranked first by the number of carbon atoms they conserve and then by the number of reactions they contain. The implementation was done in Java using the Chemical Development Kit and the Java Universal Network/Graph Framework (http://jung.sourceforge.net/). All result figures are drawn using Graphviz (http://www.research.att.com/sw/ tools/graphviz/). All experiments were run on a single core from a 2.83 GHz Intel Xeon E5440 with access to 16 GB of RAM. For the branched pathways, the input k, for Eppsteins k-shortest paths algorithm, was set to one million and the seed pathways were chosen as all paths, without cycles, containing less mapping nodes than the shortest path plus four. 
