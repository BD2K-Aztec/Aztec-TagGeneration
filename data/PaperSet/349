Gene expression An improved method for computing q-values when the distribution of effect sizes is asymmetric Motivation: Asymmetry is frequently observed in the empirical distribution of test statistics that results from the analysis of gene expression experiments. This asymmetry indicates an asymmetry in the distribution of effect sizes. A common method for identifying differentially expressed (DE) genes in a gene expression experiment while controlling false discovery rate (FDR) is Storeys q-value method. This method ranks genes based solely on the P-values from each gene in the experiment. Results: We propose a method that alters and improves upon the q-value method by taking the sign of the test statistics, in addition to the P-values, into account. Through two simulation studies (one involving independent normal data and one involving microarray data), we show that the proposed method, when compared with the traditional q-value method, generally provides a better ranking for genes as well as a higher number of truly DE genes declared to be DE, while still adequately controlling FDR. We illustrate the proposed method by analyzing two microarray datasets, one from an experiment of thale cress seedlings and the other from an experiment of maize leaves. Availability and implementation: The R code and data files for the proposed method and examples are available at Bioinformatics online.Performing tens of thousands of hypothesis tests for one experiment has become a commonplace as technologies for producing high-dimensional data are becoming more prominent. This is especially the case in the field of statistical genomics, where technologies such as microarray and RNA-seq [see Brown and Botstein (1999) or Metzker (2010) for reviews of thesemeasure the abundance of messenger RNA transcripts for thousands of genes in each subject of a gene expression study. Oftentimes, researchers are interested in comparing the gene expressions of subjects from two treatment groups. A major objective of such experiments is to identify genes that exhibit differential expression, i.e. a difference in the population treatment mean expression levels. Meaningful biological results depend on reliable detection of differentially expressed (DE) genes. Hence, the power of detecting differential expression for genes that are truly DE should be as high as possible, whereas genes that are equivalently expressed (EE)i.e. genes that have no difference in the population treatment mean expression levelsshould have a minimal chance of being declared DE. Thus, we must find an appropriate method for testing multiple hypotheses that provides good power while controlling some multiple testing errors. When considering a traditional multiple testing problem, family-wise error rate (FWER) is often the preferred error rate used to control multiple testing error. The Bonferroni method and Holms (1979) method are commonly used for this purpose. These methods, however, are not appropriate for highdimensional gene expression data, as controlling FWER results in extremely low power for detection of differential expression. As a consequence, an alternative error rate known as false discovery rate (FDR;) is usually used. FDR is simply the expected proportion of EE genes among all genes declared to be DE, where the proportion is defined to be zero if no genes are declared to be DE. Although FDR allows for more Type I errors than FWER when controlling these different error rates at the same numeric level , the power for detecting differential expression is greatly increased, as discussed in Storey and Tibshirani (2003). A common method for identifying DE genes while controlling FDR in a gene expression experiment is the q-value method, first proposed by. The q-value for a given gene represents the estimated FDR if the given gene and all genes with smaller q-values are declared to be DE. This method estimates FDR based on a set of P-values corresponding to m hypothesis tests. As previously mentioned, researchers are often interested in studying gene expression differences between groups of subjects. This is most often accomplished by performing a hypothesis test for a difference in treatment expression means for each gene, converting the P-values from the resulting tests to q-values, and then declaring genes with a q-value less than an FDR threshold to be DE. Potentially relevant information that this method does not take into account is the signs of the test statistics.shows a histogram of t-test statistics from a microarray experiment described in. In this experiment, gene expressions from wild-type cells in thale cress seedlings were compared with those from mutant cells.shows the distribution of observed test statistics for 22 810 gene. Although it is not visually obvious, there is asymmetry in the distribution of test statistics, as more genes have negative test statistics than positive test statistics, which indicates asymmetry To whom correspondence should be addressed. in the distribution of effects sizes (i.e. the true differences in gene expression treatment means) as well. We propose a new method for FDR estimation that alters the traditional q-value method by separating the two-sided P-values from an experiment into two subsets of P-values based on the sign of the test statistics, and then computing the q-values separately for each subset to create a better ranking of the genes with respect to differential expression. Through simulation studies using both independent normally distributed data and real gene expression data, we demonstrate how the proposed method can result in an improved ranking of genes with respect to differential expression over the traditional q-value method while still adequately controlling FDR. The rest of the article is organized as follows. Section 2 reviews Storeys (2002) q-value method and introduces the proposed method for FDR estimation. Section 3 describes two simulation studies and uses the results of these studies to compare the performances of the proposed method and traditional q-value method by looking at the ranking of genes with respect to differential expression, the number of truly DE genes declared to be DE and also how well each method controls FDR. Section 4 presents analysis of two real microarray datasets, both from two-sample studies. Section 5 presents an analysis of a threetreatment gene expression experiment to illustrate how the proposed method can be generalized. Finally, Section 6 concludes the article with some discussion.Tables 1 and 2 as well as Supplementary Tables S1 and S2 (provided in the Supplementary Materials) present the results of the simulation studies. For each setting in each simulation study, the mean (based on the 500 simulated datasets) partial area under the receiver-operating characteristic (ROC) curve (pAUC) is given with its corresponding standard error in parentheses. These are partial areas because we considered only the most relevant region of the ROC curve where the false-positive rate was 0.10. The method that ranks the genes better with regard to differential expression will have a higher pAUC. For each simulation setting, a traditional paired t-test was performed to test for a difference in the mean pAUCs of the proposed method and the traditional q-value method. If this test was significant at 5, then the higher mean pAUC is presented in bold font in Tables 1 and 2 and the supplementary tables. Additionally, if the higher mean pAUC is at least 5 greater than the lower mean pAUC, then the higher mean pAUC is also underlined, and this method was considered to outperform the other method. The 5 improvement criterion was used to avoid situations where the mean pAUC was very similar between the proposed and traditional methods, in some cases equal when rounded to one decimal, but the t-test indicated a statistically significant (though not practically significant) difference. The combination of the two criteria allowed for the identification of simulation settings where both practical and statistical significance were present. In addition, mean S, the mean number of DE genes that were declared to be DE when FDR is nominally controlled at 5 is also given for each setting to observe the number of correctly identified DE genes, on average. Similar to the pAUCs, t-tests were used to determine whether one method produced a larger mean S and whether the higher mean S was at least 5 greater than the lower mean S. Also, to verify that each method adequately controls FDR, the empirical approximation of FDR was calculated for each method while nominally controlling FDR at 5. We will call this quantity V=R, which is the average of the dataset-specific fractions defined as the proportion of EE genes among all genes with q-values 0.05 or 0 if no genes have q-values 0.05. Regardless of data type, both mean pAUC and mean S increase as the sample size increases as well as when the mean effect size increases for both the proposed and traditional q-value methods. This is unsurprising, as increasing the sample size or the mean effect size increases the power for detecting differential expression. For the simulations involving normally distributed data with =1 (see), the proposed method performed better in 12 of 60 simulation settings with regard to mean pAUC, includingsettings with n = 4. In regard to mean S, the proposed method performed better in 25 of 60 simulation settings, including 18 of 20 settings with n = 4. The traditional method did not perform better than the proposed method in any simulation setting in terms of mean pAUC or mean S. When the mean effect size is increased to =2 (see Supplementaryin the Supplementary Materials), the proposed method outperformed the traditional method with regard to pAUC in 8 of 60 settings, all of which are in simulation settings with n = 4. For mean S, the proposed method outperformed the traditional method in 16 of 60 settings, including 14 of 20 settings with n = 4. As with =1, the traditional method did not outperform the proposed method in terms of mean pAUC or mean S in any simulation setting. For simulations involving microarray data with =1, the proposed method performed better than the traditional methods in 17 of 60 (14 of 20 settings with n = 4) and 23 of 60 (17 of 20 settings with n = 4) simulation settings in regard to mean pAUC and mean S, respectively. The traditional method did not perform better than the proposed method in any simulation setting in terms of mean pAUC or mean S. When =2 (see Supplementaryin the Supplementary Materials), the proposed method outperformed the traditional method in mean pAUC in only 5 of 60 simulation settings, all when n = 4. In terms of mean S, the proposed method outperformed the traditional method in 15 of 60 settings, 13 of which when n = 4. The traditional method did not outperform the proposed method in any simulation settings in terms of mean pAUC or mean S. When taking into account all simulation settings with normally distributed data, all of the 20 simulation settings in which the proposed method outperformed the traditional method in terms of mean pAUC were with A ! 0:8. For mean S, 33 (80.1) of the 41 simulation settings in which the proposed method performed better had A ! 0:8. Among all simulation settings involving microarray data, 18 (81.8) of the 22 simulation settings in which the proposed method outperformed the tradition method in terms of pAUC occurred when A ! 0:8. For mean S, this occurred in 31 (81.6) of 38 settings. Additionally, among the 42 simulation settings across all 240 simulations in which the proposed method outperformed the traditional method in terms of pAUC, 39 (92.9) occurred in simulation settings with n = 4. Among the 79 simulation settings where the proposed method outperformed the traditional method in terms of mean S, 62 (78.5) occurred in simulation settings with n = 4. The proposed method never outperformed the traditional method in simulation settings with n = 20 with regard to either mean pAUC or mean S. The traditional method did not outperform the proposed method in any simulation setting. As shown in the last two columns of Tables 1 and 2 and Supplementary Tables S1 and S2, both the proposed and traditional methods adequately controlled FDR near the 5 level across all simulation settings and data types.The proposed method for estimating FDR by first estimating 0 using all P-values and then analyzing two subsets of P-values separately based on the sign of the test statistics has advantages over the traditional q-value method when effect sizes are asymmetric. The proposed method was never outperformed by the traditional method in terms of mean pAUC or mean S in the two simulation studies, and ranked genes better with respect to differential expression in 17.5 of the simulation settings while adequately controlling FDR. The proposed method performed especially well for simulation settings with the smallest sample size (n = 4). Compared with the traditional method, the proposed method also declared more truly DE genes DE, on average, in 37.1 of simulation settings, and was never outperformed by the traditional method, even in simulation settings with symmetric effect sizes. Similar to the results for pAUC, the proposed method performed exceptionally well in simulation settings with n = 4. Therefore, we suggest that the proposed method be used to analyze datasets with small sample sizes (n 10) when the distribution of test statistics is asymmetric. Another advantage to the proposed method is that it can be generalized to analyze many gene expression experiments with more than two treatments, especially if the treatments in the experiment can be ordered by factors such as time or dose. Although the criteria used to partition the P-values differs depending to the treatment structure, the analysis is very similar once the partitioning has been performed.Improved q-values 
