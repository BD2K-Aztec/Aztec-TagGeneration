Bioimage informatics A bioimage informatics approach to automatically extract complex fungal networks Motivation: Fungi form extensive interconnected mycelial networks that scavenge efficiently for scarce resources in a heterogeneous environment. The architecture of the network is highly responsive to local nutritional cues, damage or predation, and continuously adapts through growth, branching, fusion or regression. These networks also provide an example of an experimental planar network system that can be subjected to both theoretical analysis and experimental manipulation in multiple replicates. For high-throughput measurements , with hundreds of thousands of branches on each image, manual detection is not a realistic option, especially if extended time series are captured. Furthermore, branches typically show considerable variation in contrast as the individual cords span several orders of magnitude and the compressed soil substrate is not homogeneous in texture making automated segmentation challenging. Results: We have developed and evaluated a high-throughput automated image analysis and processing approach using Phase Congruency Tensors and watershed segmentation to characterize complex fungal networks. The performance of the proposed approach is evaluated using complex images of saprotrophic fungal networks with 10 5 10 6 edges. The results obtained demonstrate that this approach provides a fast and robust solution for detection and graph-based representation of complex curvilinear networks. Availability and implementation: The Matlab toolbox is freely available through the Oxford e-Research Centre website: http://www.oerc .ox.ac.uk/research/bioimage/software Contacts:Rapid advances in imaging technologies have heralded a new era of quantitative measurements that offer considerable potential to improve our understanding of complex biological systems, particularly those that need to be considered as integrated functional units . In particular, enhanced image processing techniques have greatly facilitated characterization of interconnected transport and communication networks in animal systems, including vascular systems, milk ducts, respiratory pathways and neuronal circuitry [e.g. (. In contrast, there has been remarkably little progress to characterize macroscopic microbial network development for an entire taxonomic group of organisms, namely the fungi. Unlike other biological networks, which exist within an organism, the entire growth form of fungi is as an adaptive network. Foraging saprotrophic fungi play a central role in ecosystem biology as they are the only organisms capable of complete degradation of wood in temperate forests. These fungi form extensive interconnected mycelial networks of multi-hyphal cords that forage for scarce resources that are patchily distributed in time and space . The architecture of the network responds to local nutritional cues, damage or predation and the local structure is continuously remodeled through growth, branching, fusion or regression of the hyphal cords. Despite the absence of any centralized control system, these organisms exhibit complex foraging and decision making behavior as a co-ordinated individual. Unlike animal network models, microbial networks also provide an example of an extremely tractable experimental system that can be subjected to both theoretical analysis and experimental manipulation in multiple replicates . Early measures of macroscopic mycelial organisation focussed on fractal dimension as a useful tool to capture aspects of the network structure as a metric . However, a single summary statistic, such as the overall fractal dimension provides little opportunity to characterize the network structure and dynamics further or to explore the underlying mechanism leading to network optimisation. There has been some progress at the microscopic level to extract the physical network structure using (semi)-automated image analysis . However, to date, delineation of the network architecture from the larger soil-based systems has only been possibly manually , as basic intensity-based segmentation is not effective in this context (M.D.Fricker, L.Boddy and D.P.Bebber, unpublished data). As a result, the total number of macroscopic fungal networks analysed so far is relatively low. Nevertheless, graph-theoretic analysis of the digitised networks has provided evidence that these indeterminate, de-centralized systems yield adaptive networks with both high-transport capacity and robustness to damage, but at a relatively low cost, through a Darwinian process of selective reinforcement of key transport pathways and recycling of redundant routes . Furthermore, fungal networks dynamically modify link strengths and local connectivity when subject to experimental attack to readjust the balance between transport capacity, robustness to damage and resource allocation, resulting in increased resilience as the environment becomes more challenging . Existing image processing approaches for semi-automated fungal network extraction work best if the mycelium is grown on a suitable substrate, such as cellophane or nitrocellulose to facilitate acquisition of high-contrast images. The subsequent processing procedure typically involves noise reduction, using median or band-pass filters, intensity-based thresholding, with manual or automated threshold selection, followed by morphological processing to achieve an improved skeletonisation of the colony structure e.g. Barry and Williams (2011). However, these methods require rather specific culture conditions and illumination regimes that cannot readily be adapted for macroscopic networks grown on soil-based media, which is essential to explore the natural behavioural capability of these organisms and the range of their responses. In addition, the branches (termed cords in these systems) are multi-hyphal aggregates and show considerable variation in contrast as the individual cords span several orders of magnitude in diameter from m to mm, within a single colony. Furthermore, the background from the compressed soil substrate is not homogeneous in texture or reflectivity. Under these conditions, automatic characterization of the fungal network is challenging for conventional image processing approaches and more advanced solutions are required. We have developed a high-throughput automated image analysis approach to detect and characterize large complex fungal networks, grown under realistic conditions. We use watershed segmentation to extract the network rapidly, with prior curvilinear feature enhancement to highlight the network structure in noisy or low contrast images. The proposed enhancement method uses a novel brightness-and contrast-invariant approach based on the concept of local phase, called the Phase Congruency Tensor (PCT). The resulting skeleton is then pruned on the basis of local cost functions that incorporate both intensity and tensor direction information. A graph representation of the network is constructed from the pruned skeleton to give the network topology or a weighted network that includes edge lengths. To obtain an estimate of the edge thickness, which is important in predicting the physiological performance of the system, the skeleton is dilated to capture the approximate dimension at each point, and this value is used to set a local sampling region to estimate the reflected cord intensity for comparison with empirically derived calibration curves. This approach ensures that even sub-resolution branches can be analysed correctly. An addition procedure is applied to extract the resource region which is then used to redefine a corresponding part of the graph. Although we apply the method here to fungal networks, it has wide applicability to planar networks in any domain. highlight curvilinear features and reduce background effects. Although other alternatives are available, here we concentrate on methods based on tensors.Species such as P. impudicus produce densely cross-linked networks, with relatively well-defined thick cords. To summarise the complete extraction process, images of this species collected at high-resolution and high-contrast were rapidly segmented using the watershed method , with no additional requirement for curvi-linear feature enhancement. Oversegmentation, generally considered as a downside of the watershed transform, allows in this case a rapid delineation of highdensity networks. Pruning based on the average intensity of every branch was then carried out, providing a mechanism to control the overall level of detail of the final network . The graphrepresentation of the network was then calculated by defining the branch or fusion points and end points throughout the network as nodes, and then determining the edges that link them . The Euclidean length of each edge was also calculated from the segmented skeleton, and the cord thickness estimated from a sequence of morphological dilations of the skeleton until the threshold criterion was reached, combined with filtered pixel intensities to capture the difference in reflectivity for cords of different dimensions . The final step for the fungal networks was to identify the initial food resource and then redefine the graph in this region to connect all cords emanating from the resource with a central node . The performance of the proposed approach applied to the entire image is presented in. When no enhancement was applied, the watershed and pruning method was less reliable for low-contrast, low-resolution images, such as those obtained for Phanerochaete velutina, which has thinner, more diffuse cords, particularly at the growing margin. With varying levels of threshold, the network was initially over-segmented, but rapidly became dis-connected as the threshold was raised, making the choice of threshold critical (e). In comparison, even these challenging networks were efficiently extracted following intensity-independent PCT enhancement (see Section 4 for details) to give a very clean network over a broad threshold range (j), that greatly facilitated subsequent pruning operations . To quantify the performance of our approach, five complex regions of interest in the fungal images were selected. Manual tracing of network centerlines was performed exhaustively by an expert, to give a Gold Standard (GS) reference. In total, in all regions of interest, 2256 network branches were annotated. The GS and extracted network were compared using the network network distance measure d , defined as the average distance between each point on the GS network centerline and the corresponding closest point on the extracted network centerline, and vice versa. The standard deviation d of the network-network distance measures was also calculated. The distance error evaluation for each ROI, where the network was extracted using the proposed approach based on PCT vesselness, is presented in. For all annotated regions, the average distance error was d 0:7393pixel. The recommended setting used to calculate the PCT-based vesselness, can be found in . Supplementarypresents normalized histograms of distance error values d for all analyzed regions of interest in fungal images. Additionally, traced lines were identified as true/false Positives depending on whether a line was found in the gold standard at a distance smaller than two pixels. Precision and recall were calculated for a set of comparable approaches, and are shown in. Finally, a comparison of the network thickness estimated using optical microscope and our approach, for 10 randomly selected measurement points, is presented in Supplementary figures S5 and S6. 
