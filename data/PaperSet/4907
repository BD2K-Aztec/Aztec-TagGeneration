Weighted poolingâ€”practical and cost-effective techniques for pooled high-throughput sequencing Motivation: Despite the rapid decline in sequencing costs, sequencing large cohorts of individuals is still prohibitively expensive. Recently, several sophisticated pooling designs were suggested that can identify carriers of rare alleles in large cohorts with a significantly smaller number of pools, thus dramatically reducing the cost of such large-scale sequencing projects. These approaches use combinatorial pooling designs where each individual is either present or absent from a pool. One can then infer the number of carriers in a pool, and by combining information across pools, reconstruct the identity of the carriers. Results: We show that one can gain further efficiency and cost reduction by using weighted designs, in which different individuals donate different amounts of DNA to the pools. Intuitively, in this situation, the number of mutant reads in a pool does not only indicate the number of carriers, but also their identity. We describe and study a powerful example of such weighted designs, using non-overlapping pools. We demonstrate that this approach is not only easier to implement and analyze but is also competitive in terms of accuracy with combinatorial designs when identifying rare variants, and is superior when sequencing common variants. We then discuss how weighting can be incorporated into existing combinatorial designs to increase their accuracy and demonstrate the resulting improvement using simulations. Finally, we argue that weighted designs have enough power to facilitate detection of common alleles, so they can be used as a cornerstone of whole-exome sequencing projects.The need for low-cost large-scale rare mutation screens is on the rise, with the current shift of genome-wide association studies towards rare variants . Another major application of rare variants genotyping is in prenatal screens for rare genetic disorders; for example, the Israeli ministry of health sponsors carrier screening tests for a list of 36 severe and frequent genetic diseases (with prevalence higher than 1 in 1000 live births) in 35 different localities/communities . The Israeli ministry of health also provides free-of-charge screening for TaySachs, a recessive neurodegenerative disorder which is fatal by the age of 23, to couples of Jewish descent , as well as screens for Thalassemia (an inherited autosomal recessive blood disease) to all the Arab and Druze populations To whom correspondence should be addressed. and Jews of Mediterranean or Asiatic descent . Recent studies have described how sophisticated pooling designs for high-throughput sequencing (HTS) technologies can be used to dramatically reduce the number of pools required for carrier identification, and, therefore, can reduce the costs of such large scale carrier screens drastically . The cost reduction is accomplished because most of the cost of such projects is typically in the capture stage, which has to be performed only once per pool. Reducing the capture cost, even at the price of increasing the amount of sequencing, can lead to very significant decrease in overall cost (see typical calculations in Section 6.2 below). Using a smaller number of pools reduces the overall ability to reconstruct the genomes, but the theory of sparse signal recovery, also known as compressed-sensing , guarantees that with high probability the carriers of rare mutations can be identified. In the traditional pooled testing setup, the result of testing each pool is a True/False value . This is the framework adopted bywho use the number of wild-type and mutant allele reads in each pool to infer whether a pool contains carriers or not. However, the information obtained by sequencing a pool of mixed DNA is not limited to a True/False indication as to the presence of a carrier in the pool. The number of mutant and wild-type allele reads can be used to infer the number of carriers within each pool, where a high number of mutant reads is an indication of a high proportion of mutant allele carriers in the pool. This difference between the typical pooled testing scenario and the technology scenario was the basis of several recent works which suggested more complicated designs that take the specific scenario into account and design more efficient pooling and decoding strategies for identification of rare allele carriers.take a random design approach to identify extremely rare carriers whiletake a more structured approach and use a design based on the Chinese reminder theorem (CRTD) to identify rare allele carriers. These designs allow for the identification of multiple carriers. Another design which has been used in similar contexts is the shifted transversal design (STD) . One common feature of these designs is that they are all combinatorial: each individual is either present in a pool or absent from it. Using this combinatorial approach, one can, at best, hope to infer the number of carriers in a pool but not their identity. This information is accumulated across the overlapping pools and the identity of the carriers is then decoded in a manner reminiscent of the way one solves a Sudoku puzzle.Consider the following interesting riddle: You are given a set of n coins, one of which is counterfeit and, therefore, has a lighter weight. What is the minimal number of weighing required to identify the counterfeit coins using a spring scale? Such spring scale riddles were studied extensivelyfor an overview] and for simple versions of this riddle the solution generally requires O(d log(n)) weighings, where n is the number of coins, and d is the (known) number of counterfeit coins . Next, consider a well known but less studied variation of this riddle: instead of n coins, we now have n coin piles, one of which contains counterfeit coins. In this case, the counterfeit pile can be found with a single weighing by taking i coins from the i-th pile and weighing all the selected coins together. Even if the number of counterfeit piles is unknown, they can all be identified with a single weighing. This requires taking a i coins from the i-th pile such that the sequence a i n i=1 is a subset-sum-distinct sequence. A straightforward solution is to take 2 i1 coins from the i-th pile, but denser subset-sum distinct solutions exist such as the ConwayGuy sequence . These riddles demonstrate the power of weighted designs. The former riddle is solved using combinatorial designs, where each coin is either included of excluded from each weighting. The latter riddle allows us to take a different number of coins from each pile to and construct a much better strategy. The fact that we use a different number of coins from each pile allows us eventually to identify any number of counterfeit coin piles with a single weighing. The pooled sequencing scheme resembles the coin piles problem in the fact that we can pool different amounts of DNA from each individual similarly to the way we take a different number of coins from each pile. However, there are two important differences. First, with pooled sequencing our measurements are noisythe proportion of mutant reads does not correspond directly to the proportion of mutant reads in the pool. Second, the number of carriers in a group follows a Binomial distribution, with the parameter p being the minor allele frequency (MAF) which is either known or unknown, depending on the exact scenario. However, in the following sections we demonstrate how taking the weighted approach can dramatically increase the power of pooling designs, just as it did for the riddles described above.We start by analyzing NWDs. As discussed earlier, we use a conservative error rate of = 1 and an average coverage of 1000 (i.e. r = 1000). While this coverage is high for whole genome sequencing projects, it is very reasonable when targeting a small number of genes or several known mutation loci as is the case in prenatal screening. We start by limiting the discussion to carrier screens, that is, the probability of observing a mutant homozygous individual is 0. As discussed earlier, this is the case when screening for lethal recessive mutants but also when sequencing mitochondrial DNA, sex chromosomes in males, or monoploid organisms. We relax this assumption in Section 6.1. We computed the optimal NWDs and their corresponding values of P suc for d 2,3,4,5,6 using = 4 to simulate the case of TaySachs carrier screening in the Jewish Ashkenazi population . The performance of these designs as a function of the actual carrier prevalence in the populationis given in. Our simulations show that for low compression levels (d = 2,3) there is hardly any loss of P suc even for more common mutations. The baseline for comparison is defined as the P suc obtained by assigning the wild-type genotype to all the individuals, that is, 1. We then used numerical optimization to find the optimal NWD for various prevalence values.compares the performance of the optimal NWD for each value of , the optimal NWD for = 4 and the fair NWD for = 4 as described in Section 4.2. While the optimal NWD does outperform the other designs when = 4, as expected, the differences between its performance and the performance of the TaySachs optimal design are small. The fair design does not perform as well, but this is expected, given that it was not optimized with respect to P suc. As means of comparison to the combinatorial designs, we chose to focus on CRTD and STD and a cohort size of n = 1000 individuals. For the CRTD, we used windows of 31,32,33,35,37, yielding a compression rate of 6, while for the STD we used P = 37 and five windows, yielding a compression rate of 5.4.The performance of these designs was estimated by running 100 simulations for each prevalence value and calculating the empirical P suc. The decoding was done by belief-propagation using 20 iterations with a high damping factor ( = 0.95) to alleviate oscillation issues, and by using x MAP instead of x since finding the latter is intractable for such cohort sizes. The performance of these designs is compared to TaySachs NWDs with d = 5,6 in. The combinatorial designs, which rely on the principles of compressed sensing, display a near perfect reconstruction rate when the prevalence of carriers is small and therefore the signal is indeed sparse. However, as the prevalence increases, the performance of the combinatorial designs quickly deteriorates, and for prevalence higher than 3 the signal is too dense to reconstruct, and the performance of the designs is roughly equivalent to simply assigning the wild-type allele to the entire group. The NWDs do not display this characteristic phase-transition but rather show a slow decline in performance, with much better performance than combinatorial designs once for prevalences above 2.53. To study the performance of hybrid designs, we focused on hybrid designs with only two different weights, which allows us to quantify their performance as a function of one parameterthe ratio of the weights w 1 /w 2. We used a grid of 20 values of w 1 /w 2 and estimated the performance of the hybrid designs for a prevalence of 3 using 100 simulations each time. The optimal weight ratio in both designs was w 1 /w 2 = 0.2, and using w 1 /w 2 = 1, that is, resorting to the combinatorial designs, displayed very poor performance, as can be seen in. We then studied the performance of hybrid CRTD and STD using the optimal 0.2 ratio, as well as 0.3 and 0.5, and compared their performance to the corresponding combinatorial designs. To do so, we ran 100 simulations for each of the ratios, for each of the designs,and for prevalence ranging from 0.1 to 4 using step size of 0.1. The results for CRTD and STD are displayed inand 6, respectively, and show a clear improvement in performance when weighting is used. For example, one can look at the minimal prevalence of carriers in the population such that P suc 0.999. The combinatorial STD crosses this threshold for prevalence of 1.5, while for the hybrid designs with weight ratios 0.2, 0.3 and 0.5, this happens for prevalence of 1.9, 2.3 and 1.5, respectively. Similarly, one can look at the minimal prevalence such that the design underperforms the baseline, which happens for prevalence of 2.4 for the combinatorial STD and for prevalence of 3.4, 3.2 and 2.8 for the hybrid STDs with weight ratios 0.2,0.3 and 0.5, respectively. Results are qualitatively similar for CRTD. Encouraged by the significant improvement in the performance of the combinatorial designs due to the introduction of two weights, we studied the impact of adding a third weight. We used a grid-searchone, two and three weights, as well as a robust version of the three weights design with larger minimal weight. to find the optimal weight ratios for STD with three weights for a population with 3 carriers, which was approximately w 1 /w 2 = 0.35 and w 1 /w 3 = 0.05, and estimated the performance of this design in the same manner as before. The results show that the additional weight improves the performance of the design even further. It might seem counterintuitive at first that assigning such small weights to some of the individuals improves the overall performance of hybrid designs. The key to understanding this is that the decoding process crosses information between overlapping pools. Individuals with small weights in certain pools will have high weights in other pools, and in these pools there would be less uncertainty regarding the identity of the carrier. While each pool provides less information regarding the individuals with low weights, it provides much more information regarding the individuals with high weights, narrowing down the list of possible carriers by a factor of the number of weights. For example, with one carrier in a pool of 30, combinatorial designs would only allow us to infer that one individual out of the 30 in the pool is a carrier, while a hybrid design with three weights would narrow the list down to 10 possible carriers if the carrier is not assigned a small weight. So pools where an individual has a small weight provide less information regarding this individual while pools where the individual has a larger weight provide more information, and due to the design of overlapping pools this information can be used for better decoding. The fact that this tradeoff is beneficial might seem less surprising when one thinks about the convexity property of the mutual information. Mutual information is a concept from information theory that captures the reduction in uncertainty regarding the true value of one random variable X when we observe the value of a different variable Y , and is denoted I (X ;Y ) . In our i202 
