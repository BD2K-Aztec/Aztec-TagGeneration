Genome-wide functional element detection using pairwise statistical alignment outperforms multiple genome footprinting techniques Motivation: Comparative genomic sequence analysis is a powerful approach for identifying putative functional elements in silico. The availability of full-genome sequences from many vertebrate species has resulted in the development of popular tools, for example, the phastCons software package that search large numbers of genomes to identify conserved elements. While phastCons can analyze many genomes simultaneously, it ignores potentially informative insertion and deletion events and relies on a fixed, precomputed multiple sequence alignment. Results: We have developed a new method, GRAPeFoot, which simultaneously aligns two full genomes and annotates a set of conserved regions exhibiting reduced rates of insertion, deletion and substitution mutations. We tested GRAPeFoot using the human and mouse genomes and compared its performance to a set of phastCons predictions hosted on the UCSC genome browser. Our results demonstrate that despite the use of only two genomes, GRAPeFoot identified constrained elements at rates comparable with phastCons, which analyzed data from 28 vertebrate genomes. This study demonstrates how integrated modelling of substitutions, indels and purifying selection allows a pairwise analysis to exhibit a sensitivity similar to a heuristic analysis of many genomes. Availability: The GRAPeFoot software and set of genome-wide functional element predictions are freely available to download online atDespite the wealth of currently available DNA sequence, the important task of identifying functionally important biological regions remains difficult. One popular approach is to search for regions that are putative targets of purifying selection by virtue of being conserved at a variety of evolutionary distances . While mutational cold spots could also explain the existence of conserved elements, population genetics studies refute this hypothesis and conclude that purifying selection maintains To whom correspondence should be addressed. conserved elements in both Drosophila and human genomes . There exists a clear need for general methods that identify functional DNA in large mammalian and vertebrate genomes. Previous genome-wide conservation studies have estimated that 38 of the human genome is under purifying selection . However, protein-coding elements have been estimated to make up only 12 of the genome (International Human Genome Sequencing). Non-protein-coding conserved material, thus, represents a large fraction of all functional DNA, and specialized techniques such as exon-finders cannot identify the majority of the dark matter present in the human genome. Two general techniques have been used for identifying putative functional regions in the human genome by searching for regions with reduced rates of mutation. An example of an approach focusing solely on substitution data is the phastCons software package . phastCons utilizes a phylogenetic hidden Markov model (phylo-HMM) which annotates regions in a given multiple sequence alignment as conserved and non-conserved by modelling conserved regions with reduced rate of point mutations. The use of an HMM framework allows phastCons to estimate all model parameters, including the length and expected level of conservation, directly from the sequence data. Theoretical studies have concluded that comparative studies may exhibit increased statistical power when analyzing datasets with larger numbers of genomes, and phastCons has been applied to both a set of 17 and a set of 28 vertebrate genomes . A complementary approach, implemented in the consIndel software package, searches a precomputed multiple sequence alignment for regions with a reduced rate of insertion and deletion (indel) mutations . In this approach, the annotated set of ancestral repeats (ARs) is analyzed to determine the distribution of ungapped regions (sequences between indel events) in neutral regions. When the entire genome is examined, long ungapped regions that deviate from this null distribution were found to be highly enriched with previously annotated functional elements. Both phastCons and consIndel have dedicated tracks on the UCSC genome browser . While these techniques successfully identify many previously annotated functional elements, both make their predictions based on a paucity of either substitution or indel mutations. Additionally, both techniques make their predictions based on a fixed multiple sequence alignment. While this reduces the computational complexity of both methods, uncertainty or errors in the alignment will impactIn order to assess the performance of GRAPeFoot, we benchmarked its performance against the phastCons and consIndel software packages. We tested the three software package on five different types of previously annotated elements in the human genome. @BULLET Exons: we used the set of exons from the UCSC known genes track, which accumulates genes from a variety of sources based on protein data (SWISS-PROT and TrEMBL) and mRNA data (RefSeq, Genbank). @BULLET Putative transcription regulatory regions (pTRRs): these are a set of putative transcriptional regulatory sequences that have been identified from ENCODE experimental data. The 100 bp regions were identified via data from chromatin immunoprecipitated samples hybridized to highdensity microarray chips (ChIP-chip) for sequence-specific transcription factors. Set specificity was increased by requiring additional experimental evidence (chromatic activation, DNAase hypersensitivity and nucleosome depletion). @BULLET Predicted regulatory modules (PReMods): a genome-wide set of computationally predicted human transcriptional modules. Predictions are made by searching for clusters of phylogenetically conserved and repeating transcription factor motifs using a motif database consisting of 229 TFs. @BULLET microRNAs: we used the miRBase database, a database of published microRNA sequences and annotations.@BULLET ARs: we used the set of repeats predicted by the RepeatMasker program, which screens DNA sequences for interspersed repeats and low complexity DNA sequences. Since ARs are presumed to evolve neutrally, we benchmark the performance in finding these sequences in order to estimate a false positive rate.We wanted to compare the proportion of previously annotated elements detected by each of the three methods for a variety of different thresholds. To compare the three methods, we constructed receiver operating characteristics (ROC) curves for each method Page: 2119 21162120for each of the different functional element types. The y-axis of the ROC curve represents the true positive rate: the percentage of nucleotides within a functional element class that are correctly annotated as conserved (true positives), and the x-axis represents the false positive rate: the percentage of nucleotides within ARs detected by the method (false positives) for the same threshold. The curve is constructed by placing and connecting points on the plot for a range of different thresholds. For the GRAPeFoot results, each point on the ROC curve corresponds to 1 of the 10 sets of contiguous elements described in Section 2.5. Both phastCons and consIndel predictions assign each predicted contiguous element a score ranging from 0 to 1000. When constructing ROC curves for these predictions, we used these scores for thresholding. Each point on the ROC curves can be easily reproduced using the base-pair-wise intersection feature on the UCSC genome browser after loading in our publicly available list of conserved element predictions. We demonstrate an example of this in the Supplementary Material. Since the threshold value does not appear on either axis, the ROC curve allows us to compare method performance for a variety of different sensitivity/specificity regimes.displays ROC curves for four classes of functional elements: exons, pTRRs, miRNAs and preMODs. The legend for each plot displays the area under the curve (AUC), a summary statistic that evaluates the methods performance while taking into account both sensitivity and specificity. Higher AUC values correspond to increased predictive accuracy. Each ROC curve has been modified to exclude the point (1,1), which is present by definition in all ROC curves. This point corresponds to using a score or probability cutoff of zero in which case each method would annotate each nucleotide in the genome as functional, corresponding to both a true positive rate and a false positive rate of 100. The inclusion of this point on the graph, however, hinders the ability to compare the ROC curves for the different methods, and thus we chose to omit the point from both the graphs and the AUC calculations. The ROC analysis inshows that GRAPeFoot performs well when compared with both phastCons and consIndel for all four types of functional elements. Additionally, the AUC values demonstrate that the quality of predictions varies for the different methods. For all methods, accuracy was highest when detecting exons, followed (in decreasing order) by miRNAs, PReMods and pTRRs. This performance ordering was not unexpected given the average length and expected conservation of these functional elements. Both theoretical and genome-based studies have shown that the ability to detect functional elements via comparative genomics improves with longer elements and higher levels of conservation . Exons have an average length of 170 bp and are in general well conserved among vertebrates while microRNAs are significantly smaller, with an average length of 24 bp, and exhibit a reduced but similar level of conservation as exons . In contrast, regulatory modules are expected to contain large percentages of neutral DNA interspersed with regulatory signals such as transcription factor binding sites, which have an average length of 615 bp and can exhibit high degrees of variability . Thus, while all pTRRs were constrained to be 100 bp, only a small proportion of these bases (e.g. a pTRR could contain only one transcription factor binding site) may be functional and therefore subject to purifying selection. While all methods performed significantly better when detecting PReMODs, another set of putative regulatory modules, these modules were identified by searching for clusters of phylogenetically conserved motifs and therefore were assured to exhibit at least partial sequence conservation. 
