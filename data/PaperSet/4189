Sequence analysis Sensitive and fast mapping of di-base encoded reads Motivation: Discovering variation among high-throughput sequenced genomes relies on efficient and effective mapping of sequence reads. The speed, sensitivity and accuracy of read mapping are crucial to determining the full spectrum of single nucleotide variants (SNVs) as well as structural variants (SVs) in the donor genomes analyzed. Results: We present drFAST, a read mapper designed for di-base encoded color-space sequences generated with the AB SOLiD platform. drFAST is specially designed for better delineation of structural variants, including segmental duplications, and is able to return all possible map locations and underlying sequence variation of short reads within a user-specified distance threshold. We show that drFAST is more sensitive in comparison to all commonly used aligners such as Bowtie, BFAST and SHRiMP. drFAST is also faster than both BFAST and SHRiMP and achieves a mapping speed comparable to Bowtie. Availability: The source code for drFAST is available atGenomic variation between individuals or across species ranges from single nucleotide polymorphisms (SNPs) and structural variation to larger chromosomal rearrangements . Thanks to the improvements in sequencing technologies, large-scale genome variation studies such as the 1000 Genomes Project (1000 Genomes) have made it possible to better characterize normal human genomic variation and disease . The development of high-throughput sequencing (HTS) technologies has changed the landscape of genome research. The first commercially available HTS technology was from Roche/454 Life Sciences and was used to sequence the genome of James Watson . It was followed by other second generation sequencing platforms that generate orders of magnitude more data for a fraction of the cost, such as Illumina Genome Analyzer and AB SOLiD (McKernan To whom correspondence should be addressed. The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First). Third-generation sequencing platforms are now under development, and HeliScope and PacBio RS were recently made available; however, for the time being, they produce reads with higher error rates. Analysis of genomic variation using sequencing starts with mapping the randomly sheared and ideally uniformly sampled DNA fragments from the genome. Different properties and error models of sequence reads generated by these technologies require the development of specialized read mapping algorithms for each platform for accurate read alignment and characterization of genomic variants. This becomes more complicated for short reads: due to repeats and duplications in genomes, they can map to multiple locations with equal sequence identity. Leveraging the high sequence coverage and randomly selecting one best location when a read cannot be unambiguously placed has proven to be effective in discovering SNPs and small indels in relatively non-complex areas of the genome . However, structural variation detection sensitivity is shown to benefit from tracking all map locations of the reads including suboptimal alignments , and characterization of segmental duplications is extremely resistant against mapping the reads uniquely . Read mappers can be broadly classified into two categories according to the method used to index the reference genome using either hash tables or suffix arrays [compressed through the Ferragina-Manzini index (with the use of the Burrows-Wheeler Transform (. Hashbased aligners such as MAQ , SHRiMP , mrFAST , mrsFAST and BFAST have poorer performance in comparison to suffix array-based aligners [e.g. BWA , Bowtie (when dealing with short reads; however, their relative performance increases considerably and surpasses the suffix array-based aligners when the read length and thus the number of errors (mismatches or indels) that need to be tolerated increase. In this article, we describe a hash-based read mapping algorithm named di-base read fast alignment search tool (drFAST) designed for the di-base encoded color-space reads generated with the SOLiD platform. The main advantage of di-base encoding is increased base call accuracy due to each base being represented by two colors. This helps in differentiating base calling errors (color-space errors) from real sequence variance, thereby increasing the reliability of detected genomic variants. We show that mapping speed of drFAST is higher than other SOLiD-enabled hash-based read mappers, BFAST and SHRiMP ,To measure the performance of drFAST, we compared its two variants to popular color-space read mappers currently available.Parameters: we used the following parameter settings for these mappers:@BULLET drFAST: e=2,3 (error threshold for different runs).@BULLET Bowtie: n,v = 2,3 (error threshold for different runs);-a (for reporting all);-S (output in SAM format);-C (color-space mapping). @BULLET SHRiMP:-m 1 (score 1 for match);-i-1 (score-1 for mismatch)-x-1 (score-1 for color-space error);-U (ungapped alignment)-o 10 000 (maximum number of alignments for a read);-N 1 (number of threads);-h 96 (96 alignment identity). @BULLET SOCS:-x 0 (number of bases to trim);-s 2 (mismatch sensitivity);-t 4 (mismatch tolerance);-m 0 (maximum number of alignments for a read, 0 indicates to report all);-T 1 (number of threads);-l yes (consider the lower case bases in genome).@BULLET Mapreads: S = 0 (color-space mapping); M = 2 (number of mismatches allowed); A = 2 (count adjacent mismatches as one mismatch); Z = 10 000 (maximum number of alignment for a read).@BULLET PerM: seed S20 (full sensitivity for two SNPs);-v 4 (number of mismatches). We used the same parameters (for reporting all mapping locations) when available to ensure a fair comparison. Note that BWA and MAQ are not considered here since they ignore the first two characters of SOLiD reads. Data, reference genome and computing power: we used both simulated and real datasets for comparisons. We simulated three sets, each with 4 million reads of length 50 bp sampled randomly from chromosome 1 of human reference genome (NCBI build 35) as follows:@BULLET Set 1: we transformed the reads to color-space with no color errors and no mismatches.In addition, we randomly selected 1 million (50 bp long) reads from publicly available color-space reads generated from the genomes of NA18507 (SRX004555), NA10847 (SRX008164) and NA12156. We used the human reference genome (NCBI build 35, unmasked) as the reference genome in all our experiments. The benchmarking results we report are performed on a server with 64 bit Intel Xeon processor and 8 GB of RAM. Time, accuracy and sensitivity results: we give the comparison results for all the mappers above with respect to the proportion of the reads that have at least one map location on the reference genome (sensitivity), total number of map locations found (comprehensiveness) and time needed to map the reads.shows the results on simulated datasets with error threshold of 2 (color errors and mismatches), except in the case of PerM where we allowed up to four mismatches due to recommendations of its developers. drFAST maps all the reads from simulated datasets back to the reference genome very efficiently. The closest competitor to drFAST appears to be Bowtie, which is, in general, slower than drFAST-CT and is not 100 sensitive. Although Bowtie with a parameter setting of v = 2 seems to map each read to more locations than drFAST, when no substitutions are present (Set 1), or a single color error is added (Set 2), this is simply due to Bowtie not being stringent on the number of errors it permits disregarding the parameter setting; we noticed that there are mapping locations with more than five color errors. When the reads involve a nucleotide substitution (Set 3), the number of mapping locations are lower than that of drFAST. What is more interesting is the number of reads that can be mapped to the reference genome. It seems like Bowtie can map at most 61.9 of the reads even when they include a single color error (Set 2), in contrast, drFAST (both variants) map 100 of the reads. When the errors are in the form of nucleotide substitutions, the proportion of reads mapped by Bowtie drops to 51.66. Since Bowtie was the closest competitor to drFAST, we performed another experiment on the same datasets by increasing the error threshold to 3 . Interestingly for this setting, the proportion of reads mapped by Bowtie is 99.4, almost matching the 100 mapping sensitivity of drFAST. However, both in terms of time and the number of map locations, drFAST (both variants) perform better than Bowtie, especially when errors (Set 2 for color errors and Set 3 for nucleotide errors) are present. As all three sets are generated from chromosome 1 with at most two errors added, a sensitive mapper should be able to map all reads to chromosome 1 when the error threshold is set to 2. In order to experimentally check the accuracy of all locations found by drFAST, we simulated the corresponding Illumina reads (letterspace) and aligned to chromosome 1 using mrsFAST. As seen infor Sets 1 and 3, drFAST finds slightly more mappingdisease susceptibility and genome evolution. Although there are inherent accuracy and bias problems associated with different sequencing platforms , we can also leverage the different strengths of these technologies to increase confidence and) and structural variation discovery. For species where a reference genome is available as in human, mapping sequence reads to this reference assembly is the first step in genome analysis. Sensitivity and accuracy, as well as the speed of read alignment, are crucial for precise characterization of genomic variants. To this end, many mapping algorithms were developed focusing mainly on the Illumina Genome Analyzer data, and very little effort was devoted to analyze color-space reads generated with the SOLiD platform . The main limitation of the SOLiD-aware read aligners is that they were not optimized for structural variation detection [except for SHRiMP , which is more powerful in mapping to more complex areas of the genome], and they are unusable for segmental duplication analysis due to their unique mapping approach . On the other hand, by tracking all possible map locations and underlying sequence variation, drFAST provides an opportunity to better access and increase mappability in repeat and duplication-rich areas of the genome that are known to harbor much structural variation . Although the sensitivity of drFAST is higher than the other aligners, we also demonstrate speed enhancements of both dynamic programming and color transformation versions. Through its readiness to be integrated to VariationHunter for more sensitive SV discovery, to NovelSeq to characterize novel sequence insertions, and usability for segmental variation detection . drFAST is an important step forward for recovering additional genetic variation from di-base encoded color-space sequencing. 
