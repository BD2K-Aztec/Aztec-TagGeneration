Genome analysis Large-scale compression of genomic sequence databases with the Burrowsâ€“Wheeler transform Motivation: The BurrowsWheeler transform (BWT) is the foundation of many algorithms for compression and indexing of text data, but the cost of computing the BWT of very large string collections has prevented these techniques from being widely applied to the large sets of sequences often encountered as the outcome of DNA sequencing experiments. In previous work, we presented a novel algorithm that allows the BWT of human genome scale data to be computed on very moderate hardware, thus enabling us to investigate the BWT as a tool for the compression of such datasets. Results: We first used simulated reads to explore the relationship between the level of compression and the error rate, the length of the reads and the level of sampling of the underlying genome and compare choices of second-stage compression algorithm. We demonstrate that compression may be greatly improved by a particular reordering of the sequences in the collection and give a novel implicit sorting strategy that enables these benefits to be realized without the overhead of sorting the reads. With these techniques, a 45 coverage of real human genome sequence data compresses losslessly to under 0.5 bits per base, allowing the 135.3 Gb of sequence to fit into only 8.2 GB of space (trimming a small proportion of low-quality bases from the reads improves the compression still further). This is 4 times smaller than the size achieved by a standard BWT-based compressor (bzip2) on the untrimmed reads, but an important further advantage of our approach is that it facilitates the building of compressed full text indexes such as the FM-index on large-scale DNA sequence collections. Availability: Code to construct the BWT and SAP-array on large genomic datasets is part of the BEETL library, available as a github repository at https://github.com/BEETL/BEETL.In this article, we present strategies for the lossless compression of the large number of short DNA sequences that comprise the raw data of a typical sequencing experiment. Much of the early work on the compression of DNA sequences was motivated by the notion that the compressibility of a DNA sequence could serve as a measure of its information content and To whom correspondence should be addressed. hence as a tool for sequence analysis. This concept was applied to topics such as feature detection in genomes and alignment-free methods of sequence comparison a comprehensive review of the field up to 2009 is given by. However, Grumbach and Tahi in 1994 have been echoed by many subsequent authors in citing the exponential growth in the size of nucleotide sequence databases as a reason to be interested in compression for its own sake. The recent and rapid evolution of DNA sequencing technology has given the topic more practical relevance than ever. The outcome of a sequencing experiment typically comprises a large number of short sequencesoften called readsplus metadata associated with each read and a quality score that estimates the confidence of each base.and Deorowicz and Grabowski (2011) both describe methods for compressing the FASTQ file format in which such data are often stored. The metadata is usually highly redundant, whereas the quality scores can be hard to compress, and these two factors combine to make it hard to estimate the degree of compression achieved for the sequences themselves. However, both schemes employ judicious combinations of standard text compression methods such as Huffman and Lempel-Ziv, with which it is hard to improve substantially upon the naive method of using a different 2-bit code for each of the four nucleotide bases. For example, GenCompress obtains 1.92 bits per base (henceforth bpb) compression on the Escherichia coli genome. An experimenter wishing to sequence a diploid genome such as a human might aim for 20-fold average coverage or more, with the intention of ensuring a high probability of capturing both alleles of any heterozygous variation. This oversampling creates an opportunity for compression that is additional to any redundancy inherent in the sample being sequenced. However, in a wholegenome shotgun experiment, the multiple copies of each locus are randomly dispersed among the many millions of reads in the dataset, making this redundancy inaccessible to any compression method that relies on comparison with a small buffer of recently seen data. This can be addressed by reference-based compression , which saves space by sorting aligned reads by the position they align to on a reference sequence and expressing their sequences as compact encodings of the differences between the reads and the reference. However, this is fundamentally a lossy strategy that achieves best compression by retaining only reads that closely match the reference, limiting the scope for future reanalyses such as realignment to a refined referenceReads simulated from the E.coli genome (K12 strain) allowed us to assess separately the effects of coverage, read length and sequencingWe compared different compression schemes, both on the raw input sequences and the BWT. RLO denotes a reverse lexicographical ordering of the reads, SAP is the dataset where all the reads are ordered according to the same-asprevious array. The x-axis gives the coverage level whereas the y-axis shows the number of bits used per input symbol. Gzip, Bzip2, PPMd (default) and PPMd (large) show compression achieved on the raw sequence data. BWT, BWT-SAP and BWT-RLO give compression results on the BWT using PPMd (default) as second-stage compressor. error on the level of compression achieved. First, a 60 coverage of error-free 100 base reads was subsampled into datasets as small as 10.shows a summary plot of the compression ratios at various coverage levels for compression both on the original reads and the BWT transform. We found the PPMd mode (-m0=PPMd) of 7-Zip to be a good choice of second-stage compressor for the BWT strings (referred to asin the following). RLO-sorting the datasets led to a BWT that was slightly more compressible than the SAP-permuted BWT, but the difference was small (0.36 bpb versus 0.38 bpb at 60, both over 30 less than the 0.55 bpb taken up by the compressed BWT of the unsorted reads). In contrast, when gzip (http://www.gzip.org, Jean-loup Gailly and Mark Adler), bzip2 and default PPMd were applied to the original reads, each gave a compression level that was consistent across all levels of coverage and none was able to compress 2 bits per base. However, a sweep of the PPMd parameter space yielded a combination-mo=16-mmem=2048m that attained 0.50 bpb on the 60 dataset (in the following we will refer to this parameter setting as). This is because the E.coli genome is small enough to permit several-fold redundancy of the genome to be captured in the 2 GB of working space that this combination specifies. For a much larger genome such as human, this advantage disappears.of the reads less well than PPMd(default), as well as being several times slower. We also investigated the effects of sequencing errors on the compression ratios by simulating 40 datasets of 100 bp reads with different rates of uniformly distributed substitution error, finding that an error rate of 1.2 approximately doubled the size of the compressed BWT (0.90 bpb, compared with 0.47 bpb for error-free data at the same coverage). We were interested in the behaviour of BWT-based compression techniques as a function of the read length. To this end, we fixed a coverage of 40 and simulated error-free E.coli reads of varying lengths. As the read length increased from 50 bp to 800 bp, the size of the compressed BWTs shrank from 0.54 bpb to 0.32 bpb. This is not surprising since longer reads allow repetitive sequences to be grouped together, which could otherwise potentially be disrupted by suffixes of homologous sequences. Finally, we assessed the performance of the compressors on a typical human genome resequencing experiment (available at http://www.ebi.ac.uk/ena/data/view/ERA015743), containing 135.3 Gb of 100-base reads, or 45 coverage of the human genome. In addition to this set of reads, we created a second dataset by trimming the reads based on their associated quality scores according to the scheme described in bwa . Setting a quality score of 15 as the threshold removes 1.3 of the input bases. We again constructed the corresponding datasets in RLO and SAP order.shows the improvement in terms of compression after the trimming. Eliminating 1.3 of the bases improves the compression ratio by 4.5, or compressing the entire 133.6 Gb down to 7.7 GB.Analyzing the SRX001540 dataset allowed us to compare our results with ReCoil, but the reads are noisier and shorter than more recent datasets and, at under 3, the oversampling of the genome is too 
