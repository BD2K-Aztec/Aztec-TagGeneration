Sequence analysis Using population data for assessing next-generation sequencing performance Motivation: During the past 4 years, whole-exome sequencing has become a standard tool for finding rare variants causing Mendelian disorders. In that time, there has also been a proliferation of both sequencing platforms and approaches to analyse their output. This requires approaches to assess the performance of different methods. Traditionally, criteria such as comparison with microarray data or a number of known polymorphic sites have been used. Here we expand such approaches, developing a maximum likelihood framework and using it to estimate the sensitivity and specificity of whole-exome sequencing data. Results: Using whole-exome sequencing data for a panel of 19 individuals, we show that estimated sensitivity and specificity are similar to those calculated using microarray data as a reference. We explore the effect of frequency misspecification arising from using an inappropriately selected population and find that, although the estimates are affected, the rankings across procedures remain the same. Availability and implementation: An implementation using Perl and R can be found at busso.ncl.ac.uk (Username: igm101; Password: Z1z1nts).The identification of sequence variants predisposing to diseases that follow Mendelian inheritance patterns is a common application of next-generation sequencing technologies . A key step in these approaches is the identification of variants shared among affected relatives (, b, c). Usually a variant is defined as a deviation from a reference sequence. Next-generation sequencing of material enriched for exonic sequences has been successful in many cases, but has failed to identify the causative variants in others . Such apparent failures may have many causes but also focus attention on the desirability of simple measures to assess the results of the sequencing and analysis pipelines used. In disease-mapping efforts, it is clearly desirable to have a high probability of identifying a true variant while the number of falsely identified variants remains low. This will reduce the amount of work needed for validation of candidate variants, which is typically undertaken using Sanger sequencing or genotyping approaches. Our objective is to develop a simple and flexible approach for assessing the performance of a whole-exome or-genome sequencing experiment. It should allow assessing the whole process, from sample preparation to variant calling. The focus is on the detection of single-base sequence variants as opposed to changes in copy number or large rearrangements. One approach is to compare the identified variants with variants known to be present or absent. For this purpose, variants are commonly compared with the results of genotyping microarrays (e.g.). This allows for the probability of a specific variant at a given position in an individual to be considered as either 0 or 1. The price of this certainty is additional experimental costs. An alternative is to use variants where the probability of occurrence in a specific sample can be ascertained, thus allowing the probability of a variant present at a specific position to assume values other than 0 or 1. Here we formalize the second approach using sites known to be polymorphic in the human population. This approach can be seen as an extension of methods that rely on quality criteria such as the number of variants found in sites known to be polymorphic in the human population (e.g.). We compare our results with those obtained using microarray data and use our method to assess different analysis pipelines and to explore the importance of analysis parameters and coverage depth. As we are using known polymorphisms, we also investigate the influence of the population that was used to characterize the polymorphisms on the results. The use of microarrays to assess the accuracy of variant identification is likely to lead to biased results, as the polymorphisms present on microarrays usually exclude variants such as small insertion/deletions (indels). Such variants also represent a challenge for variant calling in next-generation sequencing. In the last paragraph, we therefore explore different analysis pipelines for indel calling. The results of such comparisons can be summarized in many ways. Commonly used metrics include, for example, the number or proportion of previously reported variants among the detected deviations from the reference sequence. As our focus is on a To whom correspondence should be addressed. The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. dichotomous outcome, i.e. the presence or absence of a variant at a particular position, we use here the probabilities of identifying the variant at a site that carries a variant and of identifying no variant at a site where only the reference sequence is present. We refer to these probabilities as sensitivity and specificity.In this section, we first explore some applications of the method proposed, then compare its results with estimates generated using the genotypes obtained through the microarray as the true genotypes. The method only requires that the allele frequencies in the population from which the samples were drawn are known. However, this may not be the case; therefore, we explore the effects of population misspecification. Pipelines:compares sensitivity and specificity estimates achieved using different alignment and variant calling program combinations. The values are based on 31 samples. For eight samples, SSAHA2 failed to produce results and generated the messages error: memory allocation failed cannot allocate memory or error: memory allocation for array of fasta structures failed cannot allocate memory . Represented for each combination are the median and the upper and lower quartiles. Interestingly, the alignment programs appear to have a stronger effect on sensitivity, whereas the variant calling programs appeared to effect specificity more strongly. All aligners yield similar specificities when used in combination with Samtools, and the combinations NovoAlign/Samtools and BWA/Samtools provided the highest sensitivity. Therefore, we used NovoAlign as aligner and Samtools as variant caller as the standard pipeline for subsequent analyses. The estimates for the specificity using Samtools with any aligner were in excess of 0.998. Parameter selection: Each alignment and variant calling program has a range of parameters, which can be set by the user. In general default, values are provided, but these may not always be appropriate, and altering these parameters can have a marked effect on sensitivity and specificity. Our procedure can be used to 57 Next-generation sequencing performance investigate such effects. As an example, we explore the effect of varying the quality thresholds for variant calling using the NovoAlign/Samtools pipeline . This threshold is the minimum base quality at a position, for a read, required for that read to be included in the variant call for that position.shows that altering this parameter has a dramatic effect on sensitivity, with a rapid drop when the values are set above 20. The effect on specificity is more modest, and increasing the values beyond 30 has only a limited effect. Coverage:explores the effects of average coverage. As expected, sensitivity increases with increasing coverage. With the parameters we used, there is a substantial loss of sensitivity when the average coverage was 540-fold. Specificity shows little variation with increasing depth. At low coverage, finding evidence for a variant generally becomes more difficult, thus leading to a low sensitivity and high specificity. Microarray comparison: For 19 samples, data were available from both platforms. The variants were called using the NovoAlign/Samtools pipeline with default parameters.compares sensitivity and specificity figures estimated using genotype microarray data (fourth column) and our method with two different sets of allele frequencies (second and third column). The frequencies used for the estimates in the third column were calculated from the genotyping results for the 19 samples. We see that compared with the microarrays, both specificity and sensitivity estimates are slightly lower by the frequency method using the CEU population frequencies (second column). One possible contributor to this effect is that the estimates are distorted because the allele frequencies do not match the frequencies in our sample. In fact, the difference is smaller when the allele frequencies used are derived from the genotyping results (third column). It should also be mentioned that specificity estimates are in the order of 0.999. These estimates, however, are based only on a limited number of polymorphic sites (10 165 sites), suggesting that the ability to adequately assess changes in the specificity will be limited. This is reflected in the correlation between the estimates obtained from microarrays and from population frequencies. Although there is a good correlation between the estimates for the sensitivity (; R 2 =0:71; P=4x10 50 ), the correlation for specificity is rather poor although still significant (R 2 =0:39; P=7x10 21 ).. Exploring the effect of parameter choice. Represented is the effect of minimum base quality threshold on estimated sensitivity (Panel A) and specificity (Panel B). Each point on the graph represents the result for a single sample analysed using the minimum base quality threshold given in the abscissaAllele frequency effects: The method we propose uses allele frequencies in the estimation of sensitivity and specificity. Allele frequencies vary between populations, and the ethnicity of the individuals who provided a sample may not always be precisely known. We therefore explored how the use of alternative allele frequency data from a variety of populations would influence our results.explores the effects of using the allele frequencies for 11 HapMap populations in the estimation of the performance of the pipelines used previously. The figure suggests that misspecification of population frequencies tends to lead to lower estimates of both sensitivity and specificity. However, the lines connecting the values for different pipelines calculated using different allele frequencies tend to be parallel. This indicates that the results are correlated (P50.01 for all comparisons), suggesting that although the estimates may vary, the different pipelines will tend to be in the same order.shows the results for different indel calling pipelines. For all pipelines, the sensitivity is substantially lower than the values obtained for single-base substitutions (compare with). We also observe that Samtools has the lowest sensitivity, whereas GATK performed best. We also saw that the combination BWA/GTAK performed best. The higher specificity value achieved by Dindel is likely due to the minimum variant call threshold used in analysis. The average estimates for sensitivity using the bowtie/ GATK and NovoAlign/GATK pipelines are 0.35 and 0.34, respectively.The approach we presented here estimates two parameters, the sensitivity and the specificity of variant calls in a next-generation sequencing experiment, by comparing the observed variants with population allele frequency data in a maximum likelihood framework. We illustrated some of its potential applications by comparing analysis pipelines and variant calling parameters and exploring the effects of differences in coverage. As both sensitivity and specificity are influenced by various experimental factors, including sample preparation, the sequencing itself and the bioinformatic pipelines used to analyse data, the procedure could be used to assess the performance of a sequencing experiment globally and could complement other commonly used approaches, such as the assessment of base call quality or of coverage metrics. 
