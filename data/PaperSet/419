A performance enhanced PSI-BLAST based on hybrid alignment Motivation: Sequence alignment is one of the most popular tools of modern biology. NCBIs PSI-BLAST utilizes iterative model building in order to better detect distant homologs with greater sensitivity than non-iterative BLAST. However, PSI-BLASTs performance is limited by the fact that it relies on deterministic alignments. Using a semi-probabilistic alignment scheme such as Hybrid alignment should allow for better informed model building and improved identification of homologous sequences, particularly remote homologs. Results: We have built a new version of the tool in which the Smith-Waterman alignment algorithm core is replaced by the hybrid alignment algorithm. The favorable statistical properties of the hybrid algorithm allow the introduction of position-specific gap penalties in Hybrid PSI-BLAST. This improves the position-specific modeling of protein families and results in an overall improvement of performance. Availability: Source code is freely available for download atSequence alignment is one of the most commonly used tools in modern biology. The BLAST and PSI-BLAST algorithms have become standard tools for homology detection. In particular, PSI-BLAST iteratively refines models for a protein family of interest with the goal of working toward the detection of weaker or more distant homologs. The detection of deeper evolutionary relationships can impact many aspects of biology such as the broadness of evolutionary studies , the quality of gene annotations , protein structure/function predictions and our understanding of genes found in metagenomic surveys . Improving PSI-BLAST has the potential to affect a large number of users and scientific applications. To whom correspondence should be addressed.The idea behind PSI-BLAST, or Position Specific Iterated Basic Local Alignment Search Tool, is to leverage information from identified homologs to create a position-specific substitution matrix that can then be used to detect even more distant homologs . These searches take place in an iterative fashion by using homologs identified in the previous round for the model building phase where the position-specific substitution matrix is refined for the next round. While this method increases the sensitivity of the subsequent searches, the BLAST core imposes a severe limitationnamely, an inability to incorporate position-specific gap costs. This limitation stems from the inability to statistically assess the significance of alignment scores with position-specific gap costs on practical timescales. Here, we overcome this limitation by replacing the alignment core of PSI-BLAST by the semi-probabilistic hybrid alignment algorithm . This algorithms main advantage over the alignment core of NCBI PSI-BLAST is its statistical tractability, particularly with regards to position-specific gap costs . In effect, Hybrid alignment introduces to PSI-BLAST one of the advantages usually reserved for profile Hidden Markov Models . The Hybrid PSI-BLAST software, which we present here, incorporates the hybrid alignment algorithm for both homolog detection and model building, thus allowing the use of position-specific gap costs that were previously unfeasible. We show that Hybrid PSI-BLAST represents an improvement to the overall sensitivity and selectivity of homolog detection in comparison to NCBI PSI-BLAST.Using the parameter values we identified using SCOP v1.69, we measure the performance of both NCBI and Hybrid PSI-BLAST by comparison against an independent dataset that derives from the ASTRAL40 subset of SCOP v1.75. Of the 10 569 sequences in the ASTRAL40 subset of SCOP v1.75, 4974 are not contained in the ASTRAL40 subset of SCOP v1.69. We use the new sequences as an independent set of queries for testing the performance of Hybrid and NCBI PSI-BLAST. We use version 2.2.18 of NCBI PSI-BLAST and Hybrid PSIBLAST as described above to search the NCBI nr database for homologs of the query sequences in ASTRAL SCOP v1.75 that are not in ASTRAL SCOP v1.69 and save the resulting models after each round. These models are then used to search the ASTRAL SCOP v1.75 database and we ask how many proteins identified by NCBI and Hybrid PSI-BLAST are in agreement or disagreement by plotting the number of true versus false hits that occur, ordered by E-value. In order to determine which hits are true and which are false, we use the SUPERFAMILY evaluation ruleset for SCOP 1.69 benchmarks which classifies each pair of sequences in SCOP as either homologs, non-homologs or undecidable. In general, two sequences in the same SCOP superfamily are considered as homologs, sequences in different folds are considered non-homologs and sequences in the same fold but different superfamily are considered undecidable. The authors of the evaluation ruleset also include a number of exceptions from this general classification scheme for common folds such as Rossmann folds and TIM barrels, as well as for individual sequences deemed to be misclassified by SCOP after manual inspection. Since a newer version of the ruleset is not available, we manually verified that none of the sequences covered by specific exceptions in the ruleset change classification between version 1.69 and 1.75. For the purpose of evaluating the algorithms, we ignore hits classified as undecidable. The round by round results for NCBI PSI-BLAST are shown in. From this plot, one can see the effects of the rather classic problem of model corruption in iterative approaches. As previously reported , NCBI PSI-BLAST performance initially improves in subsequent rounds, but then becomes worse past round 4 due to inclusion of a large number of non-homologs in the building of the query models. Hybrid PSI-BLAST exhibits very little model corruption up to round 7, as shown in.. Here, the optimal performance is given by round 6. Note that the coverage of Hybrid PSI-BLAST, while still subject to the effects of model corruption, is less sensitive than that of NCBI PSI-BLAST to these effects.Finally, we plot the best rounds for both algorithms and compare their overall performances.shows that Hybrid PSI-BLAST performs measurably better than NCBI PSI-BLAST. In order to determine if this improvement is due to the position-specific gap cost or due to the other changes in the algorithm, we repeat the evaluation of Hybrid PSI-BLAST keeping the gap weights constant at their initial value while keeping all other parameters the same.shows that in this case the model corruption effects are present but not as severe as for NCBI PSI-BLAST. Adding the performance of the best round of fixed gap cost Hybrid PSI-BLAST to, we find that its performance is between that of NCBI and full Hybrid PSI-BLAST in the low coverage region. However, in the higher coverage region Hybrid PSI-BLAST without position-specific gap costs performs worse than NCBI PSI-BLAST. We thus conclude that incorporating position-specific gap costs indeed improves detection of remote homologies.This work implements a version of PSI-BLAST that incorporates the semi-probabilistic hybrid alignment scheme. This alignment scheme allows for the use of position-specific gap costs and information from suboptimal alignments in the model building phase, resulting in overall more accurate homology searches than NCBI PSI-BLAST. The relevance of our result is that we have shown how to improve the very core of PSI-BLAST, i.e. the alignment engine, which was already backed by a long record of scientific scrutiny and sound theoretical foundations . Our performance improvements are orthogonal, and therefore potentially cumulative, to those brought about by more recent advances on. Here, the optimal performance is given by round 4, two earlier rounds than for Hybrid PSI-BLAST with position-specific gap costs. Note that the coverage of the fixed gap cost Hybrid PSI-BLAST is more sensitive to model corruption than the full Hybrid PSI-BLAST algorithm, but less sensitive than NCBI PSI-BLAST. other parts of PSI-BLAST such as the homolog detection and model building . 
