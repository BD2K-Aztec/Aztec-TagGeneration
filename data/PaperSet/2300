Identification of novel transcripts in annotated genomes using RNA-Seq We describe a new reference annotation based transcript assembly problem for RNA-Seq data that involves assembling novel transcripts in the context of an existing annotation. This problem arises in the analysis of expression in model organisms, where it is desirable to leverage existing annotations for discovering novel transcripts. We present an algorithm for reference annotation-based transcript assembly and show how it can be used to rapidly investigate novel transcripts revealed by RNA-Seq in comparison with a reference annotation.Whole transcriptome sequencing, known as RNA-Seq , leverages high-throughput sequencing technology to investigate the RNA content from a sample via the sequencing of cDNA. This technology has been the focus of numerous recent studies that demonstrate high resolution and accuracy in transcript abundance estimation, and it is being heralded as a possible replacement for microarray-based gene expression technology. This exciting development has partially eclipsed another important application of RNA-Seq: the improvement of existing genome annotations and even the possibility of complete de novo genome annotation based on multiple experiments, as is being demonstrated by the RGASP consortium (http://www.gencodegenes.org/rgasp/). In the context of genome annotation, RNA-Seq reads can be viewed as next-generation expressed sequence tags (ESTs) . RNA-Seq offers the promise of rapid, comprehensive discovery of novel genes and transcripts in considerably less time and at lower cost than ESTs from conventional Sanger sequencing. To whom correspondence should be addressed.. Histogram showing the percent of bases covered in annotated reference transcripts. The low-coverage transcripts would not be properly assembled using sequencing reads alone. In genomes with extensive annotations, there is clearly room for improvement by taking advantage of the information contained in the annotated transcripts when assembling and calculating expression values. However, a problem with using RNA-Seq for annotation is that genes that are expressed at a low level will be represented by few reads and may be only partially covered. To illustrate this point, we show inthe coverage of RefSeq annotated transcripts in a typical RNA-Seq experiment (see Section 3 for details of the experiment). The histogram shows that 29.1 of the transcripts are not covered at all, which will happen because they are not expressed or are at levels undetectable in the experiment. The remaining transcripts have varying levels of coverage (based on their expression level and length), and although many transcripts are completely covered, we found that of the transcripts with partial coverage, 64.4 are incompletely covered (95 coverage). This means that nave assembly methods will fail to reconstruct the majority of full-length transcripts. One approach to predicting complete transcripts from partial coverage is to incorporate RNASeq data in a gene finding system. Such approaches have been successful, but they rely on models of genes structures that may limit predictions based on prior biases. Other approaches, such as Scripture may be able to close gaps in coverage, but fail to incorporate existing annotation informationare mapped to the genome using a spliced read mapper that can map reads across junctions (shown in dotted lines). The reference annotation (blue) is used to generate faux-read alignments that tile the transcripts (green). The faux-read alignments are used together with the spliced read alignments to generate a reference genome-based assembly (black). This assembly is merged with the reference annotation, and noisy read mappings are filtered resulting in all reference annotation transcripts in the output (blue) as well as novel transcripts (light blue). during prediction. In the case of model organisms where gene annotations are based on years of effort, large consortia have combined state of the art computational predictions with careful human curated annotations . We have organized existing assembly strategies into three categories, and as far as we are aware, none of the programs in any of these categories can explicitly use existing annotations during assembly: @BULLET De novo transcript assemblythe direct assembly of sequenced reads into transcripts without mapping to a reference genome. Examples include. @BULLET Genome reference-based transcript assemblyassembly of transcripts by first mapping to a reference genome. These methods build on previous work using ESTs or mapped pyrosequencing reads We address the need for a reference annotation-based assembler by developing a novel approach through modification of an existing assembler that we term reference annotation based transcript assembly (RABT assembly). We adopt the approach of which is to identify transcripts only based on read alignments (i.e. without regard to prior information about protein coding gene structure), and we employ the parsimony approach to find the fewest number of transcripts explaining the data (in this case, the aligned sequenced reads together with the reference annotation). A key feature of our approach is that it rapidly identifies novel transcripts (with respect to the reference annotation).We ran our RABT assembler on a human RNA-Seq dataset sequenced from the Ambion Human Brain Reference by Illumina (accession no. SRA012427), and compared it to a reference genome assembly produced with Cufflinks on the same data. The reference annotation used was NCBI36/hg18 RefGene, downloaded from the UCSC genome browser database (http://genome.ucsc.edu). The reads were mapped using TopHat 1.2.0 with the splice junctions in the annotation provided. Both assembly algorithms required 1 h on an 8 core 2.26 GHz computer. We focus our analysis on novel transcripts within annotated genes. All other transcripts are purely a product of the original Cufflinks assembler and their properties/validation is described in that article. Furthermore, we do not validate splice junctions as these are found by TopHat and validated in . It is important to note that although we employed those tools, the RABT approach could be used with other mappers/assemblers.shows the comparison of the Cufflinks assembler with the RABT assembler. An average of 2.03 transfrags output by the Cufflinks assembler were found to be partial reference transcripts according to the filtering method described above. Furthermore, the transfrags assembled by RABT are 751 bp longer than those output by the Cufflinks assembler. This difference is due not only to the discarding of transfrags made from portions of known transcripts but also to the use of faux-reads generated from the reference annotation to predict complete novel isoforms of existing genes. For an example, see. We investigated the extent of novel isoform discovery in known genes and found an average of 0.95 new isoforms per gene. Such new annotated isoforms include novel junctions found by TopHat or novel combinations of junctions discovered by sequencing reads. To validate these novel transcripts, we calculated the phastCons44way conservation track in the UCSC Genome Browser. We calculated that the novel transcripts actually had higher average conservation probability than the reference transcripts (0.13 versus 0.12). Finally, we note that the use of faux-reads led us to slightly increase the number of novel assembled transcripts output by the RABT assembler than we see after filtering the original Cufflinks method for partial reference transcripts (see). This is likely due to rare cases where a single novel feature led to multiple transfrags being assembled in combination with pieces of reference transcripts. To test the extent of such false positives, we ran the RABT assembler excluding the actual sequenced reads, i.e. using only faux-reads. Using this method, 1032 transcripts were assembled and falsely labeled novel. Thus, we estimate that 3 of the transcripts defined as novel by the RABT assembler in the experiment above are false positives. To show that our method is applicable to different organisms, we also repeated these experiments on Drosophila melanogaster using RNA-Seq data from the first embryo time point of the. Comparison of assembler output for an example gene. Lack of sequencing coverage in the UTR and across one splice junction caused the Cufflinks assembler (teal) to output three transfrags that match the reference (blue) and a fourth that contains a novel splice junction. The RABT assembler output (red) includes both the reference transcript (NM_014774.1) and a novel isoform (NM_014774.2) that is assembled from a combination of sequencing reads, which reveal the novel junction, and faux-reads, which connect the three sections to form a single transcript. Note that even with the addition of the reference transcript, the total number of transfrags output by the assembler has been reduced for this locus, and the transfrag lengths have increased.The categories can be interpreted in the same manner as. These results show that the method also produces improved assemblies in fly. modENCODE dataset . Our reference was the r5.22 annotation from FlyBase (http://flybase.org/), which did not make use of this data. Again, we found that the novel transfrags had average conservation probabilities similar to known transcripts (0.49 versus 0.47). Further results for this experiment are found in.RNA-Seq is being increasingly adopted as the technology of choice for gene expression studies , and with large numbers of experiments producing partial transcripts of genes, it is expected that there will be rapid progress in the coming years in annotating genomes. As more complete genome annotations are produced, it is increasingly desirable to include them in analyses rather than assembling transcripts from scratch with every new experiment. The reference annotation-based transcript assembly approach we have introduced addresses this problem, and allows for the incremental improvement of annotations with RNA-Seq experiments. It is also convenient in that novel genes and transcripts (with respect to an existing annotation) are easily extracted from the output of our assembler. It is important to note that accurate genome annotation is crucial for accurate gene expression estimation. In previous work, it has been shown that incomplete annotations can bias gene expression estimates . The current practice of using RNA-Seq to estimate expression using known annotations when they are available is therefore liable to yield inaccurate results, especially in cases where genes have multiple isoforms, some of which may not yet be annotated. We, therefore, believe that RABT assembly is essential until annotations are improved and completed. A key feature of RABT is that it is a pure assembler. This means that it does not utilize information about the structure and content of coding genes or other external input (e.g. ESTs) during the assembly. We believe this is a feature (rather than a weakness of the method) because it means that RABT can assemble non-coding RNA transcripts. It is an interesting problem to extend RABT to allow for other external input, and we believe that similar approaches (based on faux-reads) may be fruitful. Along with this method, we present several open problems in RABT assembly. For example, deciding the optimal length and spacing of tiling reads that will connect transfrags while minimizing reorganizations of annotated transcripts is non-trivial and will vary depending on the properties of the experiment as well as the organism under investigation. The same is true for the parameters used in matching assembled transcripts with those in the annotation for filtering. While we believe we have chosen good parameters for this experiment, we do not believe there to be a one-size fits all approach and it should be interesting to develop a statistically sound approach to automatically determine the best tiling method. We also note that using more complete annotations as references with RABT can lead to a larger number of false positives as portions of annotated transcripts can be re-assembled in new combinations. For example, we estimate through faux-read only assembly that using the more complete UCSC annotation as opposed to the RefSeq annotation would lead to 5 times the number of false positives. Therefore, we recommend this method for use on organisms where deep annotations do not already exist. Continuing improvements in RNA-Seq technology will eventually result in the ability to sequence complete transcripts using long reads and fragments. Furthermore, large-scale surveys of transcripts in multiple developmental stages and tissues should be able to yield complete annotations of genomes solely based on RNA-Seq. However, until that time, it is imperative that genome 
