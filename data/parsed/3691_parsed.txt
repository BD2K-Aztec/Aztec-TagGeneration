gene_expression preserving biological_heterogeneity with a permuted surrogate_variable for genomics batch correction motivation sample source procurement process and other technical variations introduce batch_effects into genomics data algorithms to remove these artifacts enhance differences between known biological covariates but also carry potential concern of removing intragroup biological_heterogeneity and thus any personalized genomic_signatures as a result accurate identification of novel subtypes from batch corrected genomics data is challenging using standard algorithms designed to remove batch_effects for class comparison analyses nor can batch_effects be corrected reliably in future applications of genomics based clinical tests in which the biological groups are by definition unknown a priori results therefore we assess the extent to which various batch correction algorithms remove true biological_heterogeneity we also introduce an algorithm permuted sva psva using a new statistical_model that is blind to biological covariates to correct for technical arti facts while retaining biological_heterogeneity in genomic_data this algorithm facilitated accurate subtype identification in head_and from gene_expression data in both formalin_fixed and frozen samples when applied to predict human_papillomavirus hpv_status psva improved cross study validation even if the sample batches were highly confounded with hpv_status in the training_set availability_and all analyses were performed using r version the code and data used to generate the results of this manuscript is available from https sourceforge net_projects psva high_throughput genome_scale can yield powerful predictors of sample phenotype when applied to disease such as human_cancers the resulting classifiers may predict patient prognosis or therapeutic_strategy to select appropriate personalized treatment nonetheless technical_artifacts from sample_collection and processing introduce biologically irrelevant signal into highthroughput data referred to as batch_effects even modest changes to experimental_design such as the microarray scan date or technician can adversely impact the accuracy of genomic_analyses several batch correction algorithms can remove these artifacts statistically provided that pertinent biological groups are known and well represented in each batch gagnon current batch correction algorithms remove signal unrelated to the protected biological groups thereby enhancing group differences unrelated to batch for example combat corrects genomic_data using an empirical_bayes framework to fit parameters in a linear_model containing both batch and biological covariates similarly surrogate_variable sva uses an iterative procedure to estimate the effect of batch covariates spanning a space not associated with biological covariates although essential for class comparison these corrections sometimes unintentionally eliminate true biological_heterogeneity not encoded in the modeled biological covariates as a result novel patterns cannot be identified from such corrected data limiting inference of either dynamics from time course genomics data or of novel disease_subtypes the heterogeneity of human tumors makes the removal of sample_heterogeneity particularly challenging in cancer_genomics in this field biological_heterogeneity is essential to realize the central_goal of identifying personalized genomic_signatures to select optimal treatments for each cancer patient worse still the need to prioritize collection of formalin_fixed ffpe_samples for pathology may introduce an imbalance and significant technical_artifacts in samples available for such classification this study provides a comprehensive assessment of the extent to which batch correction techniques including notably sva and combat remove such biological_heterogeneity when correcting for technical_artifacts we also propose a new algorithm permuted sva psva to counteract such overcorrection of genomics data this algorithm incorporates an innovative statistical_model in the computational framework of sva to whom correspondence should be addressed to iteratively refine sample clusters after modeling the effect of known batches this algorithm removes technical_artifacts in replicate samples while retaining biological_heterogeneity in samples as a result correcting genomics data with psva improves subtype identification and class_discovery in batch affected gene_expression data from head_and hnscc tumors batch correction techniques have been well established for class comparison analysis of genomic_data nonetheless we observed that these algorithms potentially removed true biological_heterogeneity to facilitate such comparison therefore we developed anone combat sva sva combat psvanew batch correction technique psva which reversed the typical sva process to infer dominant sources of signal that is independent of known sources of technical_artifacts this algorithm simultaneously reduced differences in replicate samples arising from technical_artifacts while maintaining differences between unique samples not observed with other batch correction techniques moreover hierarchical_clustering of psva corrected data clearly delineated established hnscc subtypes from batch affected gene_expression data the psva classification further divided the atypical group into two primary clusters consistent with the recent_observation of the association of the atypical group with hpv_positive samples and of subtypes within hpv_positive hnscc moreover encoding some of the known subgroups delineated by hpv_status in our model did not substantially alter the batch corrected data with psva therefore we anticipate that future_application of psva to genomics data from other human_cancers without a priori_knowledge of diseases will similarly retain patient specific heterogeneity to facilitate class_discovery for example encoding cancer_types as batch with psva similar to the model employed for batch correction in the tcga pan cancer project could better identify the molecularly distinct subtypes across human_cancers that are required for personalized therapeutic selection beyond subtype identification the psva algorithm may also facilitate more subtle patterns in genomic_data using pattern finding algorithms particularly adept for time course data for example psva may enable the detection of the complex interacting dynamic signals in time course data without the prior_knowledge of specific time groups required for batch correction inand should be explored in future work an additional goal for genomics data is the development of classifiers to infer clinical groups in future genomics datasets that better assess prognosis or improve therapeutic selection implementation of such personalized genomics requires application of classification rules learned on training data to independent test data for which phenotype is by definition unknown a priori because psva does not require knowledge of these groups the algorithm can naturally be applied to also batch correct test data in such class_discovery problems and should be compared with other emerging_techniques including fsva consistent with our previous_findings 
