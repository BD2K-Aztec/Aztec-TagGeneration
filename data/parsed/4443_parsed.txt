structhdp automatic inference of number of clusters and population_structure from admixed genotype data motivation clustering of genotype data is an important way of understanding similarities and differences between populations a summary of populations through clustering allows us to make inferences about the evolutionary_history of the populations many methods have been proposed to perform clustering on multilocus genotype data however most of these methods do not directly address the question of how many clusters the data should be divided_into and leave that choice to the user methods we present structhdp which is a method for automatically inferring the number of clusters from genotype data in the presence of admixture our method is an extension of two existing_methods structure and structurama using a hierarchical_dirichlet hdp we model the presence of admixture of an unknown number of ancestral_populations in a given sample of genotype data we use a gibbs_sampler to perform inference on the resulting model and infer the ancestry proportions and the number of clusters that best explain the data results to demonstrate our method we simulated_data from an island model using the neutral coalescent comparing the results of structhdp with structurama shows the utility of combining hdps with the structure model we used structhdp to analyze a dataset of taita thrush turdus helleri which has been previously analyzed using structure and structurama structhdp correctly picks the optimal number of populations to cluster the data the clustering based on the inferred ancestry proportions also agrees with that inferred using structure for the optimal number of populations we also analyzed data from individuals from the human_genome diversity project from world populations we found that the clusters obtained correspond with major geographical divisions of the world which is in agreement with previous_analyses of the dataset availability structhdp is written in c the code will be available for download atthe clustering of individuals into populations is a frequently undertaken task in studies of genetic data clustering allows the summarization of individuals into groups based on genetic_similarity such a summary is easy to visualize and understand it enables us to make simple inferences about the similarities and differences between different groups of individuals we can also make inferences about evolutionary_history of populations an understanding of the population_stratification present in a set of to whom correspondence should be addressed individuals is also required for avoiding false_positives in genetic_association phenomena like migration and admixture make the clustering problem harder since individuals need not belong to exactly one population cluster but can have partial membership in multiple clusters different parts of an individuals genome can be inherited from individuals belonging to different populations the problem of clustering individuals while allowing partial membership in multiple clusters was addressed using a bayesian_model by extensions to the underlying model that account for other evolutionary_processes such as mutation and recombination have also been proposed an important question that needs to be addressed when solving the problem of population_stratification is deciding how many populations are required to best explain the variation observed in a given set of individuals the bayesian_models mentioned earlier require the user to specify a number of clusters also called ancestral_populations into which the individuals are divided however this might not always be possible or desirable to address this problem an extension of structure was developed by based on their method huelsenbeck and andolfatto developed structurama structurama automatically infers the number of population clusters into which a given dataset should be divided provided individuals only belong to a single population a commonly used solution to this problem is to use fixed dimensionality models in combination with an information criterion to decide the optimal number of populations in this article we present structhdp a method for automatically inferring the number of population clusters present in a group of individuals while accounting for admixture between ancestral_populations using the hierarchical_dirichlet framework for clustering developed by we extend the structure model so that the number of populations is inferred by the model and need not be specified by the user this work is also an extension of the dirichlet_process model developed by which has been implemented in structurama we simulated_data from an island model using the neutral coalescent to test the performance of our method at recovering the true number of ancestral_populations comparing the results of structhdp with structurama shows the utility of combining hdps with the structure model we used structhdp to analyze a set of taita thrush individuals turdus helleri this dataset has been previously analyzed using structure and structurama we found that structhdp correctly identifies the optimal number of populations to cluster the data the clustering enforced by the inferred ancestry proportions for individuals also agrees with that inferred using structure with the appropriate choice of the numberpage i i i we have presented structhdp a method for automatically inferring the number of population clusters present in a group of individuals while accounting for admixture between populations at the same time it also infers individual ancestry estimates under a structurelike model we demonstrated the effectiveness of our method on data simulated from an island model we also analyzed the taita thrush dataset and demonstrated that structhdp chooses the number of clusters that best explain the data our analysis of the hgdp dataset shows that our method is able to cluster populations even when the individuals in the dataset are admixed the ancestry proportions inferred for populations can be used to compute a distance measure between populations we found that the euclidean_distance between populations has a strong_positive with the f st distance between populations the ancestry proportions therefore provide a useful low_dimensional representation of populations our method uses an hdp to model the admixture of an unknown number of ancestral_populations present in individual_genomes in a given dataset we use an mcmc sampling algorithm gibbs_sampling to estimate the model_parameters the number of ancestral_populations that best explain the data is one of the parameters of our model the collapsed gibbs_sampler we implemented according tomarginalizes the uncertainty in the population allele_frequencies thus eliminating a possible source of error in the inference our experiments suggest that the hdp is not sensitive to the priors on the parameters and since we sample them in the algorithm the results are more sensitive to the choice of for the base distributions a large value of tends to produce populations with uniform high entropy allele_frequency distributions while a small value of produces populations with allele_frequency distributions highly_skewed in favor of very few alleles lowentropy a complete sensitivity analysis however is beyond the scope of this article it would also be instructive to perform simulations with more realistic and complex demographic models to understand the limitations of structhdp the model as described here can handle both single_nucleotide snp and microsatellite_markers however one of the limitations of our method is the computational time required for the gibbs_sampling this means that while our method can handle datasets of a few thousand markers and individuals it cannot be efficiently used on large_datasets of hundreds of thousands of markers however as our simulations show even with few loci the method_performs at recovering the number of populations required to explain the data best have described a way of implementing collapsed variational inference for hdps 
