phylogenetics bucky gene tree_species tree_reconciliation with bayesian concordance analysis motivation bucky is a c program that implements bayesian concordance analysis the method uses a non parametric clustering of genes with compatible trees and reconstructs the primary concordance tree from clades supported by the largest proportions of genes a population tree with branch_lengths in coalescent units is estimated from quartet concordance factors as sequencing_costs continue to drop and multiple orthologous_genes become easily available for a given set of individuals phylogenetic_trees are now commonly inferred from multiple_loci at once however trees inferred from different loci are very often incongruent with each other while some of this discordance might be explained by stochastic and technical errors undetected paralogy or model_misspecification it has become obvious that biological_processes are often at the heart of the discordance including incomplete_lineage ils horizontal gene transfers or hybridization concatenation of all loci is known to be powerful in some cases but also known to report inflated support values or to be misleading in other cases several approaches now specifically account for the discordance between genes such as mdc stem best and beast the former two methods assume that each gene_tree is inferred without error while the latter two methods integrate uncertainty in gene_tree estimation these methods assume that the sole reason for discordance is ils as modeled by the coalescent the bayesian concordance approach bca is an alternative method that integrates over gene_tree uncertainty and does not make any particular assumption regarding the reason for discordance it assumes no recombination within loci and free recombination between loci bca uses a non parametric clustering of genes with information_sharing across compatible genes itsthe concordance and population trees the primary concordance tree features relationships inferred to be true for a large proportion of genes it is built as a greedy consensus clades are ranked by their estimated cfs and included in the concordance tree one by one as long as they do not contradict a clade with a higher cf already in the tree showed that this greedy consensus provides an inconsistent estimate of the population tree when discordance is caused by the coalescent and if the population tree belongs to a region they called the too greedy zone they also showed that a method based on rooted triples called r consensus is consistent to estimate the population tree bucky implements a consensus method similar to the r consensus based on unrooted quartets and which consistently identifies the species_tree cfs are estimated from the full taxon set alignment and quartets are considered only afterwards the posterior mean cf of each quartet is computed and transformed to an integer weight as follows to ensure consistency for each set of four taxa the quartet with the largest estimated cf is favored and given weight while the other two conflicting quartets are given weight if cfs are estimated accurately and if the coalescent is solely responsible for the discordance then all quartets with weight must be compatible and identify the true population tree in practice incompatibilities between the favored quartets are resolved with the quartet joining algorithm described by which starts from the star tree and progressively joins pairs of nodes bucky currently outputs a population tree with the same set of leaves as in the gene_trees but see_supplementary to estimate the coalescent units u on a branch of the population tree bucky first calculatespcalculates calculatesp the average posterior mean cf of all quartets defining the branch under the coalescent model any such quartet has a cf of exp u therefore the branch length is estimated as asas log p p note that large coalescent units are difficult to estimate numerically when the quartet cf approaches in practice for anypany anyp u is set to a maximum of method accuracy from the population tree in the coalescent was used to generate gene_trees along which sequences of length were generated with a mutation_rate bucky was then used to estimate the concordance and population trees supplementary_material the gene_sets were also concatenated to obtain a consensus tree with mrbayes shows the proportion of times these three trees matched the true population tree all tested sets of coalescent branch_lengths x y correspond to a fair amount of discordance with x and y the population tree is outside the anomaly zone described by degnan and rosenberg with x y the tree is in the anomaly zone but outside the too greedy zone an even greater level of discordance is obtained using x y with a tree in the toogreedy zone in this case buckys estimated population tree is consistent but the concordance tree and the concatenation method do not estimate the true population tree consistently coalescent branch length estimates had a positive bias but became more accurate with more loci supplementary_material 
