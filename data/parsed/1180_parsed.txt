data_and correction of mass calibration gaps in liquid_chromatography metabolomics_data motivation high_mass is an important goal in liquid chro matographymass spectrometry experiments some manufacturers employ a mass calibration system that regularly switches between the analyte and a standard reference compound and leads to gaps in the analyte data we present a method for correction of such gaps in global molecular_profiling applications such as metabolomics we demonstrate that it improves peak_detection and quantification successfully recovering the expected number of peaks and intensity_distribution in an example metabolomics dataset availability_and available in xcms versions and higher distributed via bioconductor under gnu_general liquid chromatographymass spectrometry lcms has become a widely used methodology in metabolomics profiles generated by this method are highly complex and many software_packages have been designed to analyse this data e g mzmine xcms these typically employ a peakpicking algorithm for selection of peaks and removal of noise peaks are then matched between samples correcting small drifts in retention time rt and the final_result is a table of the integrated intensities of each peak in each sample an important goal in lcms experiments is the accurate measurement of the mass to charge ratio m z usually a mass calibration_method is used throughout the experiment to keep the m z deviation within the desired range ms manufacturers employ different methods to calibrate their instruments some manufacturers use a switching method which regularly changes the ms input between the analyte and a standard reference switching the flow in this way can avoid the problem of ionization suppression encountered with continuous_flow methods however changing the flow to the lock mass spray temporarily stops the analyte from being detected resulting in gaps in the analyte data these lock mass gaps can cause a single peak to be split into several smaller peaks confusing the process of peak matching to whom correspondence should be addressed even if the peak is detected correctly the true intensity will be underestimated due to the gap the situation is further exacerbated by rt drifts across samples which will cause the position of the gap within the peak to shift the peak_detection multiplicity and loss in intensity will thus vary depending on where the gap is in the peak this variability can lead to both false_positives in peak_detection and inaccurate intensity estimation while most vendor software is presumed to take account of such elements of ms design this is not true of widely used and community supported open_source for lcms data_processing we have developed a method that recovers the lost intensity by filling in the gap the method greatly_reduces errors in peak_detection matching and intensity estimation and is freely_available as a built in function stitch for the xcms package to test the method data were acquired for a single sample at two different lmis a first acquisition at an lmi of scans givinga total of three lock mass scans over the entire acquisition gave a dataset where few peaks would be affected by lock mass gaps this approximates data unaffected by the lock mass gap problem a second acquisition with an lmi of scans lock mass scans in total was chosen to correspond to a typical metabolomics protocol we then compared the xcms output for the lmi data with and without correction with the lmi data without correction to illustrate the success of the method we extracted two example peaks from the data the first peak m z rt s demonstrates how the correction algorithm improves peak_detection the bottom panel of the figure plotted in black clearly shows two scans missing due to lock mass acquisition these are corrected shown dashed in red resulting in a peak with very similar shape and intensity to that in the lmi data top panel this peak is detected by the software in the lmi and lmi corrected data but not in the uncorrected lmi data in the second example the peak m z rt s is detected in all three datasets however in the uncorrected lmi the peak is much shorter s compared to s in the lmi and the corrected lmi the gap effectively leads to a shorter peak and this reduces the intensity estimate by compared to the undamaged lmi data lmi intensity lmi intensity applying gap correction results in an intensity estimate just higher than the lmi data lmi corrected intensity many peak detection_algorithms use the shape of the peak to help identify it with the correction_method this shape is recovered and more peaks are found using the same parameter_settings peaks were detected in the lmi data while only peaks were detected in the lmi data a decrease of in the lmi corrected data peaks were found a gain of over the lmi data after grouping peak groups were matched between the three datasets extracted_ion were visually inspected confirming successful gap correction supplementary_material the correction_method brought the global intensity_distribution closer to the undamaged lmi data the median intensity dropped from in the lmi data to in the lmi data a reduction but was recovered with the correction_method to in the corrected lmi data difference from the lmi data as a further demonstration of the success of the correction_method peaks eluting while lock mass correction occurred were manually identified for the peaks with lowest m z were affected by gaps the fractional difference in intensity between the lmi and lmi data was computed for both uncorrected f u and corrected f c data for both gapped and non gapped peaks gap correction resulted in a distribution for gapped peaks much closer to that for non gapped peaks than for uncorrected data median f u and and f c and for gapped and non gapped peaks respectively see_supplementary the stitch function allows peak detection_algorithms to accurately find and integrate each peak we note that the method is generic and can be applied to data derived from any lcms experiment e g in metabolomics or proteomics we have implemented the algorithm within xcms one of the most widely used freely_available lcms data_processing packages in summary our gap correction_method allows lcms data acquired with lock mass gaps to be analysed with a higher degree of accuracy and confidence than currently possible 
