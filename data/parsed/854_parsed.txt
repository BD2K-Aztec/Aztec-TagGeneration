genome_analysis canonical stable general mapping using context schemes motivation sequence mapping is the cornerstone of modern genomics however most existing sequence mapping algorithms are insufficiently general results we introduce context schemes a method that allows the unambiguous recognition of a reference base in a query_sequence by testing the query for substrings from an algorithmically defined set context schemes only map when there is a unique best mapping and define this criterion uniformly for all reference bases mappings under context schemes can also be made stable so that extension of the query string e g by increasing read_length will not alter the mapping of previously_mapped positions context schemes are general in several senses they natively support the detection of arbitrary complex novel rearrangements relative to the reference they can scale over orders_of in query sequence_length finally they are trivially extensible to more complex reference structures such as graphs that incorporate additional variation we demonstrate empirically the existence of high performance context schemes and present efficient context scheme mapping algorithms availability_and the software test framework created for this study is available from https registry hub docker com u adamnovak sequence graphs many tools and algorithms exist for mapping reads to a reference_genome these tools are based on the idea of scoring local_alignments between a query string and a reference according to some set of match mismatch and gap scoring parameters and then finding local_alignments with maximal or near maximal scores seed and extend approaches coupled with memory_efficient substring indexes or hashing schemes have been highly_successful in heuristically accelerating this search_process the core problem with read_mapping is ambiguity there is often no single best place that a read maps especially in the case of recent duplication within the reference_genome the precise base level alignment of the read to a given location in the reference is also often ambiguous to mitigate this each mapped read is given a mapping quality a per read score that indicates how likely the mapping was generated erroneously quantifying this uncertainty is a reasonable_approach for many applications but even then the uncertainty can be difficult to accommodate downstream the difficulty of mapping a read to a reference motivates a consideration of its necessity recently alignment_free of variant_calling through substring detection have garnered significant interest the basic idea is not new the dbsnp database has long provided for each point variant in the database a flanking nucleotide string that indicates the dna context in which the variation was isolated in principle such a system of variant identification sidesteps the limitations of scorebased alignment and can be used to canonically detect variations however in practice insufficient rigor in defining the substrings to detect and a failure to account for other variation near identified point_mutations have limited the approachs usefulness here we formalize and extend this core idea we propose using multiple algorithmically defined context strings to canonically identify the presence of each base within a reference_genome potentially paving the way for high_specificity alignment_free variant_calling and evaluate the performance of such a method in practice in order to test the utility of the theoretical constructs described here a series of software tests were created in order to evaluate the mappings produced by the a b natural scheme described above mapping accuracy was evaluated for both error corrected long_sequences and error_prone short_sequences the new mapping scheme proposed hereboth radically different and more conservative than existing methodshas some important benefits the first is that it is versatile it can be used to map multi megabase mhc sequences while accounting for complex rearrangements but also does reasonably well with bp simulated reads the second major benefit is stability although requiring stability reduces coverage when mapping short_reads it reveals a majority subset of mapped positions that are aligned globally with high certainty this is a useful perbase quality_assessment somewhat orthogonal and complementary to the widely used read level mapping quality_scores the third major benefitbeing able to define variants in terms of canonical contexts which can diagnose their presenceis related to the second having a stable mapping scheme enables the articulation of sequences which when observed always indicate the presence of a particular variant this could ultimately pave the way for a highspecificity reference free method of variant_calling building on the dbsnp concept of flanking strings our results show that the context driven stable mapping_approach can be more conservative than existing mappers like bwa and lastz at the cost of coverage if there is any possibility of later having to admit that it was wrong in mapping a base a stable scheme will not map that base a weakly stable scheme is only slightly more permissive willing to map bases only if it knows they cannot possibly map elsewhere we show that the a b natural schemes can be much more selective than lastz and can in certain circumstances outperform bwa in avoiding mappings to paralogs and in the general_case are no worse this specificity comes at the cost of a reduced ability to contend with high sequencing_error however it is particularly important when analyzing regions like the mhc where some genes present in a query may not be present themselves in the reference to which reads are being mapped but may nonetheless have close and misleading paralogs in the reference the a b natural scheme presented here is more useful for mapping longer_sequences where the costs of stability incurred only near the sequence ends are lower and the chances of finding longer and more distinctive contexts are higher longer_reads are also more likely to directly exhibit some of the linearity breaking structural_rearrangements that our scheme is designed to deal with the scheme presented here largely recapitulates the grcs official alignments the a b instantiation for example has precision and recall when compared with the grc alignments as depicted in given that the grc alignments for the mhc alt loci do not contain any duplications translocations or inversions canonical stable general mapping using context schemes 
