reconstruction of clonal trees and tumor composition from multi sample sequencing_data dna_sequencing of multiple samples from the same tumor provides data to analyze the process of clonal_evolution in the population of cells that give rise to a tumor results we formalize the problem of reconstructing the clonal_evolution of a tumor using single_nucleotide as the variant allele_frequency vaf factorization problem we derive a combinatorial characterization of the solutions to this problem and show that the problem is np complete we derive an integer_linear solution to the vaf factorization problem in the case of error_free data and extend this solution to real_data with a probabilistic_model for errors the resulting ancestree algorithm is better able to identify ancestral relationships between individual mutations than existing_approaches particularly in ultra_deep data when high read_counts for mutations yield high_confidence vafs cancer is a disease resulting from somatic_mutations that accumulate during an individuals lifetime and lead to uncontrolled growth of a collection of cells into a tumor the clonal theory of cancer predicts that all cells within a tumor have descended from a single founder cell and that subsequent clonal expansions occur from additional advantageous mutations as a result the cells within a tumor may differ in their complement of somatic_mutations with each cell being a descendant of a clone from a clonal_expansion high_coverage of tumor_genomes allows one to study this intra_tumor by measuring the frequencies of mutations within a tumor characterization of intra_tumor and inference of the clonal evolutionary_history of somatic_mutations within a tumor provide useful insight in the tumors development and may help inform treatment somatic_mutations are typically measured in human_solid only at a single time point when the patient undergoes surgery therefore clonal_evolution is not directly observed and one is faced with the problem of inferring the ancestral relationships between cells in a tumor from measurements at one time point this is the problem of phylogenetic_tree a well studied problem the direct_application of phylogenetic_methods requires that we measure mutations in individual cancer_cells that correspond to the leaves species of the phylogenetic_tree however because of technical_limitations and financial considerations single_cell of tumors remains uncommon with nearly all cancer sequencing studiesincluding studies such as tcga and icgcsequencing a small number of samples from a bulk tumor each containing potentially millions of cells thus the data one obtains represent the mutations in a mixture of cells with potentially distinct evolutionary_histories given sequencing_data from a single sample a number of methods have been developed to determine the set of clones and their frequencies in a tumor some methods analyze changes in the variant allele_frequencies vafs of single_nucleotide i e the fraction of tumor_cells that contain each mutation other approaches analyze differences in read_depth duewe implemented ancestree in c using cplex v we analyze simulated_datasets and real tumor datasets the real_data consist of chronic_lymphocytic cll lung_adenocarcinoma and renal_cell tumors the lung and renal_tumors have undergone multi section sequencing whereas the cll tumors were sequenced over multiple time points for of the tumors we have both whole_genome whole exome_sequencing and targeted deep resequencing data of either the same or a subset of mutations for all sections of the tumor supplementary for all analyses we set a b and c see the supplementary appendix for results as a and b are varied reconstructing the evolutionary_history of a tumor given vafs measured in multiple sequenced samples for a single tumor is a a b c analysis of cll patient shows ancestrees ability to infer successive clonal expansions a the clonal tree output by ancestree is indicated by the black solid edges whose weights correspond to the posterior_probability of the ancestral relationship dashed edges are used to indicate ancestral clones which exist at the time of sequencing the blocks labeled a through e each represent a sequenced sample with colored edges indicating the inferred composition of clones and their fraction in each sample only edges with usage at least are shown b the confidence_intervals of vaf for the sample with the weakest ancestral evidence for each of the edges connecting gene gpr to lrrc a c the tree reported by phylosub which is identical to the tree reported by citup except for the addition of samhd mutations indicated in blue are those present in part a mutations indicated in red likely occur in regions affected by copy_number aberrationsreconstruction of clonal trees and tumor composition i challenging_task in this work we formalize this problem as the vaffp we derive a combinatorial characterization of the solutions to this problem and prove the problem is np complete we present the ancestree algorithm for solving an approximate version of the problem which allows errors and demonstrate the advantages of ancestree relative to existing_approaches there are a number of avenues for further investigation first we have ignored the effect of copy_number on vafs meaning that ancestree may not currently be applicable to some datasets second ancestree only outputs the single largest rooted subtree of the approximate ancestry graph that satisfies the sum condition the algorithm may be applied iteratively by removing the clonal tree found at each step from the ancestry graph and rerunning thus returning a forest however it is unclear how the trees in this forest relate to each other or if there is an approach for joining them third the theoretical results may be strengthened for example as the number m of samples is much smaller than the number n of mutations it would be interesting to see if the problem is fixedparameter tractable finally our use of the binomial_distribution to model read_counts may underestimate the variance e g due to factors such as pcr artifacts more realistic models of read_counts may improve the performance of ancestree finally we note that the kidney and lung datasets analyzed here contain multiple sections of a solid_tumor obtained at a single time point whereas the cll datasets contain samples obtained at different times future work will include handling multi section samples and multi time point samples separately to account for time related dependencies analysis of renal patient ev reveals distinctive sample_composition the clonal tree output by ancestree some sequenced sections r r are mixtures of clones appearing only in those sections in contrast other sequenced sections ln a ln b and r are mixtures of clones that each appear in more than one section in particular both lymph_node samples ln a and ln b are mixtures of the same two clones but in different proportions 
