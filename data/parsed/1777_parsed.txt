fast metabolite_identification with input_output kernel regression motivation an important problematic of metabolomics is to identify metabolites using tandem_mass data machine_learning have been proposed recently to solve this problem by predicting molecular_fingerprint vectors and matching these fingerprints against existing molecular_structure databases in this work we propose to address the metabolite_identification problem using a structured output prediction approach this type of approach is not limited to vector output space and can handle structured output space such as the molecule space results we use the input_output kernel regression_method to learn the mapping between tandem_mass and molecular_structures the principle of this method is to encode the similarities in the input spectra space and the similarities in the output molecule space using two kernel functions this method approximates the spectra molecule mapping in two phases the first phase corresponds to a regression_problem from the input space to the feature_space associated to the output kernel the second phase is a preimage problem consisting in mapping back the predicted output feature_vectors to the molecule space we show that our approach achieves state of the art accuracy in metabolite_identification moreover our method has the advantage of decreasing the running_times for the training step and the test step by several orders_of over the preceding methods metabolomics is a science which concerns the study of small_molecules called metabolites and their interactions in the cell an important problem of metabolomics is the identification of the metabolites present in a sample information on metabolites can be obtained using tandem_mass this technology allows to obtain a tandem mass_spectrum also called ms_ms spectrum by fragmenting a compound a ms_ms spectrum is a plot containing a set of peaks where each peak corresponds to a fragment these peaks represent the relative_abundance of the different fragments also called intensity in function of their mass to charge ratio the identification of the metabolite from its mass_spectrum is then needed for a more detailed biological_interpretation in general this step consists in a research of the obtained spectrum in databases of reference spectra followed by an analysis by experts of the domain computational_approaches for interpreting and predicting ms_ms data of small_molecules date back to the s however the early approaches were hampered by the unavailability of large_scale data on molecular_structures as well as reference spectra the introduction of molecular_structure databases such as pubchem as well as open mass_spectral reference_databases da has in recent_years fuelled the development of novel methods several novel strategies have been proposed including simulation of mass_spectra from molecular_structure combinatorial fragmentation and prediction of molecular fingerprints methods based on machine_learning we evaluated and compared our approach on a subset of ms_ms extracted from the gnps global natural_products social public spectral library https gnps ucsd edu proteosafe libraries jsp in d hrkop et_al in this article we have proposed for the first time to solve the metabolite_identification problem using a structured output prediction method namely iokr we have shown that our method improves the metabolite identification_rate comparing to competing_methods with considerable shorter running time in practise allowing training the models on a single computer instead of a large computing cluster in addition the structured output approach provides a more streamlinedand thus more easy to maintainone step prediction pipeline as opposed to two step pipelines of csi fingerid and fingerid which call for predicting and scoring fingerprints as an intermediate step heatmap of the percentage of correctly_identified metabolites top with iokr the rows correspond to the different output kernels built on fingerprints linear polynomial and gaussian and the columns to the input kernels derived from spectra and fragmentation_trees as well as the two multiple kernel combination schemes alignf and unimklfor future work the most important direction is to address the prediction of the dark_matter in metabolomics da the metabolites that fall outside the compounds in molecular_structure databases there we need to design better kernels and preimage algorithms for molecular_structures finally it is important to note that the recent breakthroughs in machine_learning methodologies for metabolite_identification rely heavily on the existence off community efforts building open reference_databases such as gnps and massbank at the same time the reference_databases still cover a small fraction of relevant metabolite space although machine_learning can generalize and extrapolate beyond the training data as also shown in this article the scarceness of training data still imposes limits on how accurate_models can be built to really push metabolomics forward we should widen and make more systematic the community efforts in building and utilizing reference_databases identified metabolites with iokr in function of the size of candidate sets we considered the candidate sets of size smaller than which corresponds to of the sets and divided them in bins according to their sizes a indicates the number of test metabolites that have a candidate set size in the corresponding size bin the percentage of metabolites that are ranked in top position top or above is shown on the b for the test metabolites falling in each size bin scatter_plot of classes in chebi ontology with shortest_paths of length from the class chemical entity x axis corresponds to the median number of candidates associated with the compounds in each class and y axis to the proportion of correct compounds with rank less or equal to for each class the size of the point is proportional to the number of compounds in gnps dataset that belong to that class and we only show classes with at least compounds the classes we can identify well are shown in red and the classes we cannot are shown in blue with chebi id and name next to themmetabolite identification with iokr i 
