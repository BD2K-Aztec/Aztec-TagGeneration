databases_and bayesian ontology querying for accurate and noise tolerant semantic searches motivation ontologies provide a structured representation of the concepts of a domain of knowledge as well as the relations between them attribute ontologies are used to describe the characteristics of the items of a domain such as the functions of proteins or the signs and symptoms of disease which opens the possibility of searching a database of items for the best match to a list of observed or desired attributes however naive search_methods do not perform well on realistic data because of noise in the data imprecision in typical queries and because individual items may not display all attributes of the category they belong to results we present a method for combining ontological analysis with bayesian_networks to deal with noise imprecision and attribute frequencies and demonstrate an application of our method as a differential_diagnostic support system for human_genetics availability we provide an implementation for the algorithm and the benchmark atontologies are knowledge representations using controlled_vocabularies that are designed to help knowledge sharing and computer reasoning an ontology can be defined as a specification of a conceptualization meaning that the ontology provides a computational representation of the concepts of a domain together with the semantic relations between them concepts are often represented as nodes and the relations between them as edges in a directed graph ontologies have become essential components of search_engines for the world_wide e commerce and medicine they are used to represent items of a domain of knowledge e g the chebi ontology not only provides a comprehensive representation of biologically_relevant small_molecules but also to represent the attributes of the items of a domain for instance the gene_ontology go provides a comprehensive representation of gene_functions i e the attributes of items of the domain of molecular_biology terms that describe only attributes of items are the base of ontologies to which we refer as attribute ontologies there is a special annotation relation by which items are linked to the terms in order to express the fact that an item possesses the attribute described by the term the annotation propagation rule implies that the annotation relation is propagated along other relations to parent terms and thus to all ancestor terms for instance in go annotation propagation is defined over is a and part of relations hence if a gene is annotated to the go term atp_binding it is implicitly annotated to all ancestors of the term including nucleotide_binding this leads to statistical_dependencies between ontology_terms that can substantially degrade the performance of ontology analysis methods in addition semantic_similarity have been developed that exploit information content or graph_structure to compare different items based on their annotations on the basis of these measures we have previously_developed an algorithm for querying a database with ontology_terms and ranking the results however none of the presently available ontology search algorithms has been explicitly designed to deal with the kinds of noise to be expected in real_life queries for instance in the setting of a clinical differential_diagnosis decision_support system falsepositive queries may ensue if a patient has signs or symptoms unrelated to the underlying diagnosis consider phenylketonuria pku which is a hereditary metabolic disease that is characterized by numerous phenotypic abnormalities in untreated patients a person with pku may additionally develop an unrelated disease such as rheumatoid_arthritis ra but the physician may not recognize the fact that the joint manifestations of ra are unrelated to the manifestations caused by pku on the other hand not every person with a given disease necessarily has all of the signs and symptoms that are associated with the disease for instance most patients with marfan_syndrome have aortic dilatation i e an expansion of the ascending_aorta but only about half have ectopia lentis which is a displacement of the lens of the eye if a feature occurs more frequently in one disease than in another then all else equal we would tend to believe that the former disease explains the presence of that feature better than the latter disease and therefore can be considered as the more likely candidate medical diagnostic decision_support have been under development for decades making use of algorithms based on bayes theorem fuzzy set theory bayesian_networks and artificial_neural many of these systems were designed for the diagnosis of individual diseases such as appendicitis several bayesian_network algorithms have modeled relations between diseases findings and probabilistic links between the findings but such bayesian_networks can be complex and intractable for large_scale problems in this work we develop the bayesian ontology query algorithm boqa which in contrast to previous_approaches integrates the knowledge stored in an ontology and the accompanying annotations into a bayesian_network in order to implement a search system in which users enter one or more terms of the ontology to get a list of the best matching domain items for this purpose we propose a graphical_model that both reflects the hierarchical_structure of the underlying attribute ontology and the propagation of errors of queries we derive an efficient algorithm to apply probabilistic_inference on this model given the queries and perform simulation_studies to assess the performance we conclude that embedding the ontology search into a bayesian_framework naturally enables a general framework for searching that deals with false_negative query items statistical_dependencies in the attribute ontology and annotation frequencies we demonstrate our method with an application as a decision_support system for differential_diagnosis in human_genetics the model is built using the human phenotype ontology hpo online_mendelian omim and orphanet ayme ayme shows an excerpt of the human ontology with annotated diseases whereasshows a high_level overview for the problem we note that a preliminary version of this application has been published in robinson and bauer in our clinical_diagnostics application the domain items correspond to diseases and hpo terms describe the attributes i e signs symptoms or other phenotypic abnormalities all referred to as symptom in the following of the diseases if i j then the patient has disease j and if i j the patient does not have the disease if h i then feature i is present in the patient whereas it is not present if h i q i expresses that symptom i was identified as present in the patient whereas if q i then symptom i was not observed by the physician making the diagnostic query a false_positive occurs if the physician diagnosed a symptom even though it is not truly present a false_negative occurs if the patient has a symptom which is not observed by the physician the result of this work is an efficient search_procedure called boqa that embeds an attribute ontology items of a domain and their annotations into a bayesian_network depicts a graphical_representation of the network for an example ontology the objective of the method is to find appropriate items given a set of user query terms which we handle by applying probabilistic_inference on the bayesian_network instance formulating the task as a bayesian_network problem allowshere i is active whereas i is inactive given that the probability that h is on is f the probability that h is on is f in addition the frequencies between the diseases and all other terms are so they can be omitted thus there are four possible configurations of the model the probability of configuration a is whereas for d it is f f one to take false_positive user queries as well as the attribute frequencies into account details are given in section we test boqa by using it as a differential diagnostic_tool for clinicians by simulating patients with diseases annotated using information from the hpo omim and orphanet roc and precision_recall analysis were used to compare the performance of boqa with two other ontology_based search procedures we report the results for different settings for the false_positive the false_negative as well the number of terms that are used to form a query of size s the upper part ofshows the evaluation of simulations through roc_curves the res lin and jc approaches which are all based on variants of raw semantic similarity_scores have the worst performance the p value method resp shows better performance as has been previously_reported the bayesian approaches presented here shows the best performance at all tested noise levels in particular the boqa performs better than the simpler boqa approach which lacks the inclusion of frequency information boqa is only beaten by the boqa approach in which the true_values of and are known due to the large disproportion between the positive_and classes the difference between the methods is noticeable but not very large in the roc_analysis the difference becomes clearer if one looks at the positive prediction value ppv at a fixed threshold for instance for the setting in which and s from the data generated for the patients boqa assigns items a marginal probability of which were true_positives this gives a ppv of in contrast the p value approach flagged items with a p value of which items were true_positives yielding a ppv of only as reported in the same conclusion holds for other parameter_settings the ppv and the precision of a classifier refer to the same quantity in general the so_called precision_recall analysis represents a complementary way of evaluating the results of prediction_methods in which a range of recall i e sensitivity thresholds are analyzed as shown in the lower part of the bayesian approaches indeed yield a higher_precision over the entire range of recall thresholds with all noise configurations tested we have demonstrated the use of boqa as a decision_support in human_genetics in which physicians enter the phenotypic abnormalities observed in a patient to search among mendelian_diseases for the most likely diagnosis to explain the symptoms of the patient in this setting boqa models a generative process in which a disease causes observable phenotypic abnormalities that are structured according to the hpo after the physician has entered the observations probabilistic_inference is applied in order to rank each disease according to the probability that it explains the observed phenotypic abnormalities we showed with simulations that a marginal probability of an item being of items as calculated by our model is a more precise indicator for finding the true item as a p value this holds true for the entire range of recalls one obvious reason for this improvement is that boqa directly models false_positive observations and seamlessly integrates available frequency information another important_reason is that boqa is a global approach it models the generation of search queries and applies probabilistic_inference by which the result of each item depends on the result of all other items the marginal probabilities add up to in order to derive an efficient inference algorithm we assume that exactly one item is responsible for the terms part of the query this simplification is often realistic in the field of medical_genetics which we used as a demonstration clearly boqa can also find combinations of items that best explain a given set of query terms by defining appropriate prior_distribution p i in equation which may be useful for certain applications note that this generalization has consequences on the tractabilityof the inference problem as combinations of items being active may have to be considered furthermore for reasons of efficiency we considered merely the frequency information for k lowest probable features in order to generalize the algorithm with respect to these simplifications it may be worthwhile to apply more sophisticated probabilistic_inference procedures such as sampling based or approximative ones these may also help to reduce the still relative large_gap between boqa and boqa our bayesian_approach to ontology_based searching allows a wide_range of extensions that may be useful in specific_situations for instance if a physician is absolutely sure that a certain observed feature is present then one could assign a very small value probability of false_positives to that feature analogously a very small range value can be asserted for a particular feature if the physician is sure that the feature is not present in the patient say because it has been ruled_out by a targeted laboratory investigation on the other hand if the physician is unsure this could be encoded by larger values for these parameters this additional knowledge could help to distinguish between different search results if no disease attains a probability another conceivable enhancement is the inclusion of knowledge about possible co occurrences of features as this requires a more complex annotation model a simulation experiment similar to the proposed one could be used to verify the usefulness of the approach although we have presented an application of boqa in the medical domain the search algorithm is by no means limited to medicine applications for searching archives of documents in order to find documents belonging to categories that have been annotated to certain concepts based on word usage may profit from boqa for instance if a word such as semiconductor occurs in of documents in the category computer hardware then the frequency of this term would be categories such as computer hardware would play the role of diseases in our example and documents would play the role of patients 
