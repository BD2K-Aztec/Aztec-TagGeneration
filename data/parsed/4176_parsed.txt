selection of models for the analysis of risk_factor trees leveraging biological_knowledge to mine large sets of risk_factors with application to microbiome data downloaded from motivation establishment of a statistical_association between microbiome features and clinical_outcomes is of growing interest because of the potential for yielding insights into biological_mechanisms and pathogenesis extracting microbiome features that are relevant for a disease is challenging and existing variable_selection methods are limited due to large number of risk_factor variables from microbiome sequence_data and their complex biological structure results we propose a tree based scanning method selection of models for the analysis of risk_factor trees referred to as smart_scan for identifying taxonomic_groups that are associated with a disease or trait smart_scan is a model_selection technique that uses a predefined tax onomy to organize the large_pool of possible predictors into optimized groups and hierarchically searches and determines variable groups for association test we investigate the statistical_properties of smart_scan through simulations in comparison to a regular single variable analysis and three commonly used variable_selection methods stepwise_regression least absolute shrinkage and selection operator lasso and classification_and cart when there are taxo nomic group effects in the data smart_scan can significantly increase power by using bacterial taxonomic information to split large_numbers of variables into groups through an application to microbiome data from a vervet monkey diet experiment we demonstrate that smart_scan can identify important phenotype associated taxonomic features missed by single variable analysis stepwise_regression lasso and cart in recent_years the problem inherent in characterizing microbiome communities is of rapidly_growing interest in considering dna_sequences extracted from samples of these communities application of this method of interrogation to large samples of individuals in population_based studies has become possible due to advances of technology and the significant reduction in sequencing_costs and investigators are increasingly considering the role of microbial_composition in human_health and disease microbiome research is an important rapidly_growing field one of its goals is the identification of features such as diversity or composition of microbial_communities and their association with host phenotypes typically the s_rrna from samples are sequenced and classified into taxonomic trees based on phylogenetic_relationships through reference alignment and or unsupervised_learning and then the association between tree structures and host phenotypes is investigated in such studies the statistical_analysis is challenging because of the large number of tree variables and hierarchical nested tree structures a variety of statistical_methods have been proposed for detecting the association between microbiome features and host phenotypes microbiome data commonly used for these analyses are sequence counts usually standardized to relative_abundances or dichotomized to presence_or of operational_taxonomic otus otus represent the lowest taxonomic_level into which a sequence can be assigned that is typically used in downstream_analysis an otu can be defined as a phylogenetic unit such as bacterial_species or genus or a set of similar dna_sequences learned by data clustering for many analyses a phylogeny relating the otus is needed the process of determining otu counts referred to as otu_picking can be reference based i e sequence_reads are mapped to a reference_database of known s_rrna using for instance the ribosomal database project rdp classifier in this case the otus have a presumed known phylogeny and taxonomy established externally and documented in the reference_database for many of the common species these relationships are well known in de_novo otu_picking reads are clustered based on sequence_similarity and otus are defined based on a maximum dissimilarity threshold here phylogeny can be inferred either de_novo e g by constructing a neighbor_joining tree or by mapping representative reads to a reference_database in either case once a phylogenetic_tree has been constructed the information comprising the tree can be leveraged in downstream_analyses downstream statistical_analysis methods can be categorized into several broad approaches simple univariate methods tests of diversity multivariate_methods and model_selection methods univariate approaches generally ignore the phylogenetic tree_structure and multivariate and correlated nature of the otu count_data these include simple one taxon at a time tests of association between phenotype and otu abundance or presence absence and are likely to be powerful when one or a few taxa have strong effects on host phenotype another relatively simple approach is to associate microbiome diversity with host phenotype numerous measures of diversity exist and provide different ways to quantify the richness or evenness of otus within a phenotype multivariate_methods that assess the association of an entire vector of multiple otus have been widely used as otu abundances are nonnegative and not distributed as a multivariate_normal standard multivariate_methods e g hotelling t test and multivariate_analysis manova are generally inappropriate methods have been developed to model the otu abundances as drawn from a dirichlet multinomial or mixture of dirichlet multinomials nonparametric multivariate_methods for hypothesis_testing are commonly used as well in general these are defined based on a distance measure of dissimilarity between each pair of samples with the samples characterized by a vector of otu counts the distance measure can be tree unaware e g euclidean_distance or braycurtis dissimilarity or tree aware tree aware measures can take into account the structure of the phylogenetic or taxonomic tree for example unifrac is a tree aware method that calculates distances between pairs of microbiome samples based on the fraction of the total branch length leading uniquely to one or the other community based on pairwise_distances various nonparametric multivariate tests can be conducted such as the mantel test and nonparametric manova a final category of methods for analyzing association between otu abundances and host phenotypes comprises regression_based variable_selection methods due to the large number of parameters usually coupled with relatively small_sample in microbiome data analysis l regularized_regression in particular the least absolute shrinkage and selection operator lasso has been considered as an appropriate choice in summary these four categories of methods were developed to address two types of questions while diversity tests and multivariate_methods are usually used to determine_whether the overall feature diversity or composition of an entire tree of otus is associated with a phenotype i e overall association univariate tests and model_selection methods identify which specific otus are associated i e specific association in practice a specific association is particularly interesting and important because it can provide biological_insight into the mechanism of the disease and help define a potential target for modification however existing_methods for detecting specific association such as univariate or multivariate_regression lasso etc have significant_limitations most of these methods do not take into account the taxonomic or phylogenetic_relationship among otus in these methods individual otus are modeled as separate variables independent of each other although shared evolutionary ancestry means that otus cannot be treated as statistically independent groups another issue is that the microbiome data can be classified across multiple levels and an association can be driven by an enrichment of an entire group of otus at higher taxonomic_levels such as bacterial families orders or even phyla in this case only modeling individual otus at the lowest taxonomic_level may significantly lose power because of weaker effects of individual otus although existing univariate tests and variable_selection methods even treebased multivariate_methods such as unifrac can be applied to different levels or subsets of the data to identify specific association conducting such analyses of all possible levels and subsets of a large taxonomic tree creates an intractable multiple comparison problem therefore strategies leveraging additional biological_information to reduce the model space and optimize the search_procedure are desirable to overcome these issues we have developed a novel tree based method selection of models for the analysis of risk_factor trees smart_scan which can leverage phylogenetic knowledge to mine large sets of tree risk_factors and is particularly appropriate and powerful for detecting the otus associated with host phenotypes and grouped by similar effects unlike those widely used multivariate_methods e g unifrac for overall association analysis using pairwise_distances between subjects or hierarchical tree of subjects smart_scan is designed for specific association analysis using the tree of risk_factors i e otus not the tree of subjects essentially smart_scan is a variable grouping technique that incorporates the known structure of the variables into models it adopts a tree scanning strategy that efficiently performs an iterative search for risk_factors or groups of factors within a structured tree this strategy was previously_introduced and used for detecting phenotypic associations with haplotype trees at candidate loci in this article we present the theory and algorithm of smart_scan and in comparison to other four existing_methods we investigate its statistical_properties using simulated_data and demonstrate its application using microbiome data from vervet_monkeys we used a dataset characterizing the gut_microbiome of vervet_monkeys chlorocebus pygerythrus under two different diets to demonstrate the application of smart_scan the production of this data has been described previously and details of dietary compositions are described elsewhere the dataset contains the s_rrna of gut microbiomes sampled from vervet monkey subjects of which animals were treated with a fatty diet and with normal_diet rectal_swabs were obtained from the animals and dna was extracted using the mobio powersoil kit and the s rrna_genes were amplified s rrna gene variable_regions v v and subjected to pyrosequencing using the life_sciences sequencing_platform sequences were compared with the rdp database after quality filtering and the taxa and their abundances found in each sample were tallied these procedures were those used in the human_microbiome a b these sequences were assigned to a taxonomic tree of bacterial_genera families orders classes and phyla via the rdp reference alignment and then the sequence count of each taxon divided by the total number of sequence_reads averagely reads per subject was used as estimates of relative_abundance animals were designated as being on the normal_diet or on the fatty diet analogous to a case control design the microbiome dataset we used has been submitted to the ncbi bioproject database with an accession id prjna we applied smart_scan sva stepwise_regression lasso and cart to the vervet monkey data to investigate the effects of a fatty diet on microbiome_composition out of bacterial_genera included in the analysis sva identifiedall these together make regular variable_selection methods suffer from low power microbiome data however have a unique feature i e the composition assessed by sequence_analysis can be organized into a hierarchically_structured phylogenetic_tree because such a tree provides the information on the similarity between taxonomic_groups it can be utilized to significantly improve model_selection based upon this idea we have developed a tree based model_selection method smart_scan and demonstrated its advantages over other methods in smart_scan we leverage the phylogenetic_information in a model_selection approach to obtain a more powerful test of association to realize the benefit of smart_scan it is assumed that phylogenetically close taxa have more similar effects than those that are distant this model appears to be supported by our analysis of the vervet monkey diet experiment in which of a large group of genera in a phylum was identified to be affected by diet importantly smart_scan is not only a useful tool for microbiome_analysis but also provides a strategy and framework for mining high_dimensional structured data and therefore has applications in other situations it can be easily extended to other model_selection problems in any situation that variables are hierarchically_structured and close variables share similar group effects for example it can be used to identify genes or gene groups that are associated with phenotypes using sequence or expression data in this type of analysis genes can be treated as variables to be selected and organized into a hierarchical_structure based on established pathway or gene_set information the key feature of smart_scan is variable grouping with the aid of known variable structure this feature makes smart_scan differ from many other multivariate_analysis techniques unlike the variable_selection in stepwise_regression lasso and cart through including and excluding variables in models smart_scan reorganizes variables into groups instead of selecting variables it selects the way of grouping variables an advantage of variable grouping is that different variables with similar or identical effects are summarized into a single group variable therefore the total numbers of variables in the final model could be substantially_reduced from this perspective smart_scan can be viewed as a technique of data dimensionality_reduction compared with other dimensionality_reduction methods such as principal_components pca and multidimensional_scaling mds smart_scan has clearer biological meaning and facilitates interpretation for example when it is difficult to biologically understand a pca from a linear combination of hundreds of otu variables with different loads we may clearly define a group of otus from the same bacterial family in smart_scan and then investigate the association between them and a clinical_outcome although smart_scan utilizes tree like hierarchical_structure it is very different from hierarchical_linear hlms also called multilevel_models or nested models because hlms are for modeling the structure of subjects not of predictor_variables smart_scan is also different from classification_and cart analysis cart is a widely used machine_learning which models the data through a decision_tree a decision_tree used by cart is very different from the phylogenetic_tree used by smart_scan in many aspects it does not necessarily reflect biological phylogeny or taxonomy unlike a phylogenetic_tree describing the hierarchical_structure of variables a decision_tree is a predictive_model describing how to use predictors in a treelike ordered boolean way to predict an outcome the phylogenetic_tree is known and used by smart_scan as a prior to help grouping and summarizing variables while a decision_tree is unknown and needs to be learned by cart in a data_driven predictive manner these differences however do not mean that smart_scan has no connection with other methods instead smart_scan can be easily incorporated with other methods for example after a large number of variables are grouped and summarized by smart_scan into fewer variables other methods e g stepwise_regression pca or cart can be applied to the new variables to refine the analysis overall smart_scan is flexible in terms of data modeling because the aic goodness_of makes it applicable to any data type for which likelihood_based models can be developed it can be applied to quantitative qualitative and survival phenotypes with or without covariates complex interactions and random_effects currently we have implemented smart_scan in r which can handle both quantitative and binary phenotypes more extensions will be developed and added it should be noted that when a p value cutoff is required to determine the significance in an application directly calculated p values in the final model of smart_scan could be inflated because the variable grouping and model_selection procedure tends to produce results deviating from the null_distribution this is a common issue of all model_selection methods and usually can be adjusted by a permutation_test which can be implemented by users through a standard random permutation of phenotype data supplementary another caveat to the application of smart_scan is that the result of an analysis and its interpretation rely on an estimated phylogenetic_tree and this estimated tree can be subject to ambiguity due to homoplasy because of parallel or convergent mutations and or horizontal_gene concerning tree ambiguity earlier work with nested clade analysis and treescan techniques that also use a phylogenetic_tree to generate a statistical_design and that motivated smart_scan showed that the statistical_design that emerges from using an estimated tree is actually robust to much potential ambiguity within that estimated tree and does not require a fully resolved tree for example most homoplasy occurs on long branches that separate phyla however smart_scan does not require that the phylogenetic_relationships among phyla be fully resolved rather smartscan only requires that the basic topology be an accurate one and does not require accurate branch_lengths exact interconnections or rooting of the tree we used the taxonomic_classification as the basis of our tree in this paper and a recent estimator of the bacteria phylogeny based on whole genomes revealed a general agreement between the taxonomic_classification and phylogenetic distribution of these genomes within phyla homoplasy is less of a problem and the estimated trees are more accurate so one great advantage of just using the tree to generate a statistical_design is that it makes homoplasy much less of a problem in inference of trait associations as opposed to inference of phylogeny however one aspect of horizontal_gene could be important in our inference structure in section we used sequence_data to estimate the bacterial abundance down to the genus level by counting the sequence_reads that were mapped to a set of reference_sequences with known predefined taxonomy when there are horizontal_gene events causing homoplasy between genera the abundance estimation could be biased because a transferred gene sequence in genus a could be aligned back to its original location genus b in the tree causing it to be counted for the abundance of genus b and not genus a accordingly we may interpret the abundance in a slightly different way it is not strictly generic abundance but rather sequence oriented abundance that complies with the reference_sequences therefore the actual goal of section can be understood as the identification of association between diet and sequences clustered based on their similarity not association between diet and strictly biological abundances alternatively an unsupervised_clustering tree based on only sequence_similarity not taxonomy reference alignment can also be used for the smart_scan analysis of course when biological abundances are of interest other analytical strategies may need to be adopted such as using data at higher taxonomic_levels or using subtrees with less homoplasy 
