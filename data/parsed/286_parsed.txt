analysis of nanopore data using hidden_markov models_motivation nanopore based sequencing_techniques can reconstruct properties of biosequences by analyzing the sequence_dependent ionic_current steps produced as biomolecules pass through a pore typically this involves alignment of new data to a reference where both reference construction and alignment have been performed by hand results we propose an automated method for aligning nanopore data to a reference through the use of hidden_markov several features that arise from prior processing_steps and from the class of enzyme used can be simply incorporated into the model previously the m mspa nanopore was shown to be sensitive enough to distinguish between cytosine methylcytosine and hydroxymethylcytosine we validated our automated methodology on a subset of that data by automatically calculating an error_rate for the distinction between the three cytosine variants and show that the automated methodology produces a error_rate lower than the error_rate from previous manual_segmentation and alignment availability_and the data output scripts and tutorials replicating the analysis are available at https github com ucscnanopore data tree master automation the use of hidden_markov hmms in analyzing biosequence data is widespread and is the backbone of such services as pfam tmhmm and sam t these services use hmms to identify regions of interest in observed sequences briefly hmms model a sequence family with emission probabilities for each possible base or amino_acid at each position of a reference hmms can perform an alignment between an observed sequence and the reference and can allow for features such as insertions_or compared with the reference this hmm methodology can be extended to analyze nanopore data which is ionic_current sampled at a high_frequency instead of a sequence of characters the ionic_current is the flux of ions through a tiny hole the nanopore in an insulating barrier as a voltage is applied when biomolecules pass through the nanopore they block the passage of ions causing characteristic drops of ionic_current more recently both single_nucleotide and discrimination of three epigenetic variants of cytosine have been achieved by using u dnap to mediate the movement of dna through a m mspa nanopore the ionic_current can be processed into segments which summarize the ionic_current while a dna_molecule is held in a particular position within the nanopore by u dnap j schreiber and k karplus submitted for publication each segment instead of representing each nucleotide individually is influenced by a number of adjacent nucleotides which correspond to the length of the narrowest region of the pore for the pore m mspa the word length is approximately four nucleotides an important task in the use of nanopore devices is decoding the sequence of segments into information about the underlying biosequence that generated it which is complicated because the dna motor is not a perfect stepper motor and the segmentation_algorithm is not perfect however the combined behavior of the enzyme nanopore and signal_processing can be modeled with a somewhat more complicated hmm than the simple profile_hmms usually used in protein and dna_sequence modeling the hmm presented here is specific to using u dnap with an m mspa pore and using our current segmentation_algorithm different classes of enzymes may have different features that need to be modeled and different segmenters may have different rates of over or undersegmentation we propose an automated way to align nanopore data to a reference model using this hmm we validate this approach using a three class classification_problem in which the strands contain either a single cytosine c methylcytosine mc or hydroxymethylcytosine hmc in an otherwise identical sequence these single cytosine variants have been shown to produce different ionic_current levels as they pass through the nanopore hand analysis of data from the dna_molecules tested in this article resulted in a classification error_rate of approximately we show that this error_rate can be reduced to using our automated methodology on a small dataset the complexities of nanopore data have made hand curation of data popular leading to questions of unconscious bias in data selection the expected number of deletions insertions backslips and undersegmentations in each position across the hmm each value is calculated by summing the transition_matrix calculated using the forward_backward algorithm for each respective state in each module in the hmm three phenomena of note are i the spike of inserts at position indicating either our need to include another state or a location that the enzyme is likely to stall briefly at ii the spike of backslips at position followed by increased deletes at positions and indicating that the observed sequences had a slight preference to align to states before position than positions or and iii the general uptick of these occurrences at the end of the sequence indicating that the end of the strand may be ambiguous due to variable dissociation times soft call accuracy measurements using the trained model on testing data a the mcsc accuracy and filter scores are shown plotted for each event ordered by their filter score the mcsc accuracy represents the accuracy expected using events with this filter score or higher as more events are included the accuracy goes down the top of events to the left of the red line give accuracy b soft call accuracy for each event is plotted sorted by the filter score just as in a only a few events have a soft call accuracy between and and sorting by filter score gives good discrimination between events with high_accuracy and those with low accuracy the orange line is the rolling mean using a event window with events on each side and indicates the expected soft call accuracy of events with that filter score 
