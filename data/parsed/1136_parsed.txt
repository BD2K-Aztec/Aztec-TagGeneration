structural_bioinformatics confidence assignment for mass_spectrometry based peptide_identifications via the extreme value distribution motivation there is a growing trend for biomedical_researchers to extract evidence and draw_conclusions from mass_spectrometry experiments the cornerstone of which is peptide_identification inaccurate assignments of peptide_identification confidence thus may have far reaching and adverse_consequences although some peptide_identification methods report accurate statistics they have been limited to certain types of scoring_function the extreme value statistics based method while more general in the scoring_functions it allows demands accurate parameter_estimates and requires at least in its original design excessive computational_resources improving the parameter estimate accuracy and reducing the computational_cost for this method has two advantages it provides another feasible route to accurate significance assessment and it could provide reliable statistics for scoring_functions yet to be developed results we have formulated and implemented an efficient algorithm for calculating the extreme value statistics for peptide_identification applicable to various scoring_functions bypassing the need for searching large random databases availability_and the source_code implemented in c on a linux system is available for download at ftp ftp ncbi nlm nih gov pub qmbp qmbp ms raid raid linux bitassigning accurate statistical_significance to identified peptides is fundamentally_important because these peptides form the basis for protein_identifications whose results are often used to infer biological_processes and functions statistical errors at the peptide_identification level inevitably propagate downstream and may have far reaching consequences undermining the biological conclusions drawn from high_level analyses therefore various approaches for bounding the occurrence of false identifications have been developed one frequently employed method is to globally control the proportion of false_discoveries pfd per experimental dataset the target_decoy approach is often used to estimate the pfd with its numerator the number_of in the target_database being approximated by the number of decoy hits and with its denominator being the number of peptides identified in the target_database however as discussed by this estimate can be inaccurate when a global grading standard to prioritize the peptide hits across spectra and across databases is lacking furthermore as emphasized by even with a correct grading standard present and under the same pfd cutoff two candidate groups from two different experiments do not have identical statistical significances these aforementioned problems can be mitigated however by computing per spectrum e values p values given a tandem_mass ms_ms spectrum and a quality_score cutoff s c the e value es c is defined to be the expected number of random peptides with scores the same as or better than s c similarly the p value ps c reflects the probability of finding a random peptide with quality_score s s c in general the e value is obtained by multiplying the p value by the total number of qualified peptides whose mass differences from the precursor ion are within the specified tolerance there are multiple advantages to employing e values p values for controlling false_positives type_i it permits peptide protein prioritization across spectra and experiments it allows the statistical significances from different analyses to be combined since the expected number of random matches per query can be defined without inferring experimental details the e value is an ideal choice for the universal grading standard for candidate peptides this greatly assists peptide prioritization in the target_decoy approach furthermore when candidate peptides are ranked by their e values and a threshold e value is chosen one may estimate the number_of by multiplying the threshold e value by the number of spectra analyzed this estimated number_of divided by the total number of candidate peptides with e values smaller than the threshold e value is the pfd estimate of s oric evidently the realization of the statistical benefits described requires accurate e values p values there exist several methods that compute e values p values using spectrum dependent information these methods use various parametric functions to fit the peptide score histogram per spectrum to estimate the e values p values for the peptides identified even though these assumed parametric functions may fit the histogram a per spectrum goodness_of gof is not provided hence there is no guarantee that such procedures can consistently yield accurate e values p values nevertheless there exist a few published_methods that do not assume any parametric form for the score distribution and are able to compute accurate spectrum specific significance consistently one of these methods extends the central_limit clt by analytically deriving a parametric distribution function accounting for finite sample_size and skewness to fit the peptide score histogram per spectrum another method computes e values p values by using a dynamic_programming also known as all possible peptides statistics apps to generate the score histogram of all possible peptides whose masses are close enough to that of the precursor ion alternatively similar to sequence_alignment statistics one may use the extreme value distribution evd for significance assignment indeed infer spectrum specific statistics by employing the evd with the parameters estimated from searching multiple random databases more information about the clt and the evd is provided in section although all three aforementioned methods can provide accurate significance estimates without assuming parametric fitting functions each admits some limitations specifically the clt based method is applicable only to a single choice of scoring_function the average of the sum of independent contributions the apps based method requires each of its scoring_functions be a sum of independent contributions and the evd based method whose parameter learning is in general challenging can be applied only to scoring_functions whose resulting score histograms fall in the domain of attraction of the evd among these three methods however the evd based one offers perhaps the most flexibility permitting scoring_functions other than the sum of contributions it may enable the development of more discriminative functions that improve the sensitivity_and of peptide_identification to estimate the evd parameters propose searching or random protein databases and obtaining from each the best or the best score s every random protein database of is made of random protein_sequences with lengths distributed according to the mouse proteome for each ms_ms spectrum its corresponding set of best scores is used to find the evd parameters maximizing the order_statistics probability_density this procedure however faces several challenges first for a given precursor ion mass the number of scored peptides may vary among the or random protein databases second even within the same random database the number of scored peptides may also vary by precursor ion masses the set of best scoring peptides may thus be sampled from populations of varying_size affecting the accuracy of the estimated evd parameters third as the mass accuracy of the precursor ion increases the small mass error tolerance yields few database peptides to score decreasing the accuracy of estimated evd parameters because the large number of scored random peptides nsrp needed to accurately fit the high_scoring tail of the evd becomes unattainable finally querying or random protein databases as prescribed by with a large set of ms_ms can require a substantial computational_cost which may deter software_developers from rigorously implementing evd based_algorithms in this manuscript we address the algorithmic challenges_faced byby completely eliminating the need for random protein databases for evd parameter_estimation in our evd implementation including xcorr hyperscore kscore and rscore in raid dbs random peptides used to estimate evd parameters are generated on the fly during the program execution this allows us to fix the nsrp regardless of the mass of the precursor ion its mass error tolerance d or the size of the protein database under this approach the computational_cost for generating highscoring random peptides is much less than the original evd implementation however our goal is not to design a fast significance assignment method but a flexible and robust one that can be pragmatically implemented in most tools without adding much computational_cost for the convenience of the readers we have summarized inthe acronyms used in this paper although all four scoring_functions mentioned in section are extensively tested for the accuracy of significance assignments and retrieval_performance we describe the results for only xcorr termed raid dbs evd xcorr in the main text the results for the other three scoring_functions are similar and are thus relegated to the sup plementary information by definition a decoy_database contains no true peptide that produces any of the observed spectra the primary function of a decoy_database is to mimic the real background one encounters when searching the target_database therefore if the decoy_database is properly constructed the distance between score distributions resulting respectively from searching the target and the decoy databases should be small however to firmly establish that a decoy_database is a good choice requires perhaps more work than the data analysis itself of course this work can be waived if accurate statistics can be obtained from the target_database alone for our evd implementation we have tested the effectiveness of error control using both random databases for type i and retrieval pfd curves for type_ii we find that the reported dpvs agree closely with the observed dpvs see supplementary figs s s and that the sori c pfds agree well with the target_decoy pfds the former shows that our assigned statistical_significance coincides with its definition while the latter indicates that the common choice of using reverse sequences as the decoy is reasonable in section the correlation between the set of maximum scores and the rank percentile after double logarithm transformation is introduced as the gof of the evd models and a cutoff value of is selected based on the work of kinnison evidently raising the threshold to a higher value reduces the number of spectra for analyses hence potentially reducing the number of peptides identified that is it increases the number of false_negatives leading to type_ii error on the other hand lowering the threshold too much will include spectra for which the evd models break down hence potentially increasing the number of false identifications leading to type_i our investigation indicates that the threshold value seems to yield a good balance between type_i errors the search options of raid dbs allow for the inclusion of posttranslational_modifications ptms and or single amino_acid polymorphisms saps the inclusion of ptms saps or isotopic_labeling enlarge the search_space hence generally reduces sensitivity as expected however the assigned statistical significances when accurate should naturally reflect this effect for example an identified database peptide with a low p value will have a worse e value when the search_space is large as compared to the case of a smaller search_space 
