gene_expression length bias correction for rna_seq in gene_set analyses motivation next_generation are being rapidly applied to quantifying transcripts rna_seq however due to the unique properties of the rna_seq the differential_expression of longer transcripts is more likely to be identified than that of shorter transcripts with the same effect_size this bias complicates the downstream gene_set gsa because the methods for gsa previously_developed for microarray_data are based on the assumption that genes with same effect_size have equal probability power to be identified as significantly_differentially since transcript length is not related to gene_expression adjusting for such length dependency in gsa becomes necessary results in this article we proposed two approaches for transcript length adjustment for analyses based on poisson_models i at individual gene level we adjusted each genes test_statistic using the square_root of transcript length followed by testing for gene_set using the wilcoxon_rank ii at gene_set level we adjusted the null_distribution for the fishers_exact by weighting the identification probability of each gene using the square_root of its transcript length we evaluated these two approaches using simulations and a real_dataset and showed that these methods can effectively reduce the transcript length biases the top_ranked go terms obtained from the proposed adjustments show more overlaps with the microarray_results availability r scripts are atnext generation sequencing has been rapidly applied to measure gene_expression levels the power of this application rna_seq in quantifying and annotating transcriptomes is striking by obtaining tens of millions of short_sequence from the transcript population of interest and to whom correspondence should be addressed the authors wish it to be known that in their opinion the first two authors should be regarded_as by mapping these reads to the reference_genome rna_seq produces digital signals counts rather than analog signals intensities in microarrays and thus leads to highly_reproducible results with relatively little technical variation when enough reads are collected from a sample it should be possible to detect and quantify rnas from all biologically_relevant classes including low and moderate abundance several methods have been proposed in the literature to calculate gene_expression levels based on rna_seq adjusted the gene read count_data by the length of the transcript used the reads or counts per kilobase kb per million_reads rpkm as the gene expression_level which adjusted the read_counts by the sequencing_depth in units of million_reads in addition to the transcript length in units of kb the rpkm index facilitates comparison of expression measurements across different genes and different samples based on a poisson_model proposed a more sophisticated method to measure the expression levels of a gene by taking_into all known isoforms of all genes all above methods represent gene_expression levels using normalized count_data which can be further processed and analyzed in a way similar to microarray_data such as empirical_bayes method one of the unique features of rna_seq is that the number of reads obtained from a gene depends on the transcript length therefore we have more power detecting differential_expression for longer transcripts it has been shown that in rna_seq the proportion of significantly_differentially increases with the transcript length while such bias is not present in microarray_data this length dependency can have major impact on gene_set gsa which tests sets of predefined genes based on existing knowledge for enrichment in a list of differentially_expressed or for the treatment condition effect on the gene_set as a whole gsa is commonly used in gene_expression analysis for identifying pathways and gene_ontology go terms the significant go terms identified from the rna_seq using existing procedures established for the microarray_data tend to be enriched for longer genes one purpose of conducting gsa is to rank predefined gene_sets such as pathways and go terms according to their relevance to the biological_question under study gsa typically is a two step process the first step is to summarize the data using a gene level statistic describing the degree of differential_expression of individual genes and possibly obtaining a list of significantly differentiallypage rna_seq is a rapidly_growing technology that has the potential to replace microarray in profiling gene_expression however when previously_established methods for gsa were directly used on rna_seq gene_sets that consist of longer genes tended to be identified as significantly_enriched in this article we proposed two strategies to reduce such length dependency the first strategy is to adjust the gene level statistics by removing transcript length dependency before applying a standard wilcoxon_rank at the gene_set level the second strategy is to adjust the gene_set test by replacing the central hypergeometric_distribution with wallenius non central hypergeometric_distribution in fishers_exact based on significant gene_lists our results showed that both strategies are effective in reducing length dependence in gsa analysis for rna_seq however the wilcoxon_rank based strategy shows a substantial higher_level of overlap with microarray_results the rna_seq technology is more sensitive to longer transcripts because it generates more reads from longer transcripts therefore we have more statistical_power longer transcripts for differential_expression however in this situation the statistical_power not only reflects the standardized effect_size and sample_size but also reflects the transcript length to our knowledge transcript length has not been found to be relevant to biological_processes the detection_bias for longer transcripts is arguably a candidate to be corrected in identifying_differentially from rnaseq_data our adjustments of gene level statistics modify the length effect substantially at gene level tests however the two methods z and z perform differently z reduces the positive length effect substantially but not completely removing it while z over adjusts the relationship to negative further fine_tuning these formulas is necessary to achieve ideal effect transcript length bias in rna_seq is just one obvious bias to be corrected found that the percentage of differentially_expressed also depends on gene_expression levels number of reads they proposed to remove this dependency using the same method as for the length bias if the investigator desires we also saw similar bias along the number of reads from the marioni data however it is not clear to us that completely removing the expression intensity bias is biologically correct because there has been evidence showing that the level of stochastic expression of genes is associated with the level of gene_expression therefore we decided not to pursue the adjustment for expression levels in the gsa analysis of rna_seq here if the adjustment is desired a similar strategy as described here can potentially be applied to remove the expression_level bias in gsa the transcript length dependency is also obvious since one of our goals of conducting gsa analysis is to rank the gene_sets based on pathways and go terms according to their relevance to the biological_question under study for follow_up studies the rank of gene_sets identified from the gsa should only depend on biological relevant_parameters such as the fold_change of the gene_expression and or the variation of the expression across samples therefore we believe that some adjustment for the transcript length bias is beneficial the fishers_exact is a simple procedure for identifying over represented gene_sets based on comparing a set of significantly_differentially against all genes under study when a set of significantly_differentially is generated from the rna_seq this method is a natural and common choice for the gsa however it has been demonstrated that the go terms identified using this method tend to be the ones with longer transcripts if no adjustment is applied to the gene level statistics one solution for this problem is adjusting the null_distribution used in the fishers_exact for obtaining p values to take into account of the transcript length in the null_distribution we used a non central hypergeometric_distribution with a noncentral parameter determined by the transcript length the non central parameter represents the average detection_power difference between the genes in the go 
