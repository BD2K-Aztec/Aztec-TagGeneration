identification of hierarchical chromatin domains motivation the three_dimensional structure of the genome is an important regulator of many cellular_processes including differentiation and gene_regulation recently technologies such as hi c that combine proximity ligation with high_throughput have revealed domains of self interacting chromatin called topologically_associating tads in many organisms current methods for identifying tads using hi c data assume that tads are non overlapping despite evidence for a nested structure in which tads and sub tads form a complex hierarchy results we introduce a model for decomposition of contact frequencies into a hierarchy of nested tads this model is based on empirical distributions of contact frequencies within tads where positions that are far apart have a greater enrichment of contacts than positions that are close together we find that the increase in contact enrichment with distance is stronger for the inner tad than for the outer tad in a tad sub tad pair using this model we develop the tadtree algorithm for detecting hierarchies of nested tads tadtree compares_favorably with previous methods finding tads with a greater enrichment of chromatin_marks such as ctcf at their boundaries availability_and a python implementation of tadtree is available atthe d architecture of the genome influences key cellular_processes such as gene_regulation replication_timing and differentiation chromosome_conformation c technologies use proximity ligation of dna to elucidate genome_structure at high_resolution de wit and de recently techniques such as hi c that couple proximity ligation and high_throughput have revealed megabase sized domains of self interacting chromatin called topologically_associating tads in both mammals and fruit_flies conserved across cell_types and species tads may partition the genome into functional_units and help regulate the distribution of epigenetic_marks hi c uses proximity based ligation to measure the frequency of physical_interaction between pairs of genomic_loci typically the raw read_pairs generated by a hi c experiment are assigned to bins of fixed width e g kb resulting in a contact matrix a where a ij is the number of contacts between bins i and j normalized for experimental bias several methods have been developed for the identification of tads from hi c data these methods may be roughly classified into two categories i methods that define a one dimensional d test_statistic from the contact matrix a ij and methods that exploit the two_dimensional d structure of the contact matrix compute a d directionality index di from the contact matrix this index defines whether contacts have an upstream bias downstream bias or no bias next they use a hidden_markov hmm to partition the genome into regions defined by changes in the di each transition into downstream bias marks the start of a domain and the next transition out of upstream bias marks its end introduce a d statistic called the boundary index bi which captures sudden shifts in interaction preference identify domain boundaries by calling peaks in the bi but do not explicitly pair these boundaries into domains leaving the domain structure ambiguous recently a number of methods have been introduced to identify chromatin domains using the full d contact matrix use dynamic programing to find domains with maximal intra domain contact_frequency this method includes a tunable size parameter and outputs the set of non overlapping domains that are most robust to changes in the parameter value more recently lvydeveloped a d model that fits a block diagonal matrix to observed contacts using maximum_likelihood this method is based on a generative_model where the expected contact_frequency across a tad is uniform all the methods above assume that tads are non overlapping however several studies have observed a hierarchical chromatin_organization including both tads and sub tads within them although tads are conserved across cell_types sub tads are thought to vary between cell_types and may facilitate changes in gene_regulation during differentiation and development in addition distinct combinations of proteins such as ctcf mediator and cohesin may demarcate tad and sub tad boundaries the distinct properties of tads and sub tads highlight the need for methods that can detect both simultaneously a very recent development in this direction is the arrowhead algorithm although this algorithm can identify overlapping domains it does not explicitly require that overlapping domains be nested and it is at present not publicly_available in this article we introduce the tadtree algorithm which detects nested hierarchies of tads in contrast to previously_published that rely on ad_hoc assumptions about the structure of tads we derive a straightforward model for the frequency of contacts within tads our model is based on the empirical observation that within tads the enrichment of contacts over background grows linearly with the distance between bins but at a rate that depends on the tad length thus every tad can be characterized by two parameters b the baseline enrichment for contacts between adjacent bins within the tad and d the rate at which contact_frequency increases with distance between bins using reported tads from previous_studies we derive relationships between the values of b and d when one tad is nested inside another from these observations we propose a model for tad hierarchies we combine our model for contact enrichment within tads with a d bi similar to the one used by we formulate and optimize an objective_function that scores a hierarchy of nested tad trees according to both the fit to the observed contact matrix and the bi of each tad and sub tad in the hierarchy we demonstrate that our resulting tadtree algorithm outperforms_existing on real_data predicting tads that have greater enrichment for binding of factors known to delineate chromatin_organization and showing_greater overlap with high_resolution data we used tadtree to analyze hi c data fromfor mouse_embryonic which had been binned at kb and normalized for sequencing bias using the method from yaffe and tanay this dataset included a matrix of contact frequencies for each chromosome available at http yuelab org hi c download html hi c and other approaches that combine high_throughput with c are becoming widely used to probe the d organization of the genome there is increasing evidence that sub tad structure varies between cell_types and contributes to changes in gene_regulation during differentiation and development tadtree is the first publicly_available algorithm that detects nested hierarchies of tads in hi c data thus tadtree will enable further research into the organization of tads and sub tads tadtree employs a straightforward linear_model of contact enrichment that is derived from earlier annotations of tads tadtree finds the best tad hierarchy via a dynamic programing algorithm using an approximation of this model we demonstrate that tadtree outperforms earlier methods on real hi c data in particular we show that tads determined by tadtree on lower_resolution kb data match more closely to tads derived on higher_resolution kb hi c data from moreover we find that tadtree derived tads have a higher enrichment at their boundaries for binding_sites of factors such that ctcf than are known to demarcate chromatin boundaries although the tadtree algorithm demonstrates that tad hierarchies can be informative there are several areas where the algorithm can be improved first tadtree finds only an approximate best fit to our model tests on smaller datasets using a brute_force search suggest that the approximate solution differs little from the true solution data not shown nonetheless finding an exact solution in polynomial timeor proving that this cannot be done may be an interesting problem for future_research a second limitation of tadtree is the rapid increase in runtime os with maximum tad size s third although our use of a parameter n specifying the number of tads returned by tadtree is a novel contribution compared with previous methods we have not included a procedure for model_selection leaving the choice of n to the user chromatin_structure is highly_dynamic and varies_widely from cell to cell because approaches such as hi c typically pool contacts from across a whole population it is unclear to what extent the tad trees identified in this article represent true chromosomal structures within individual cells although efforts have been made to deconvolve hi c contacts computationally this remains_a in the future advances in microscopy and single_cell hi c may shed light on whether tad trees are true chromosomal structures or artifacts of super position the emerging field of higher_order chromatin_organization is providing a new lens for viewing the regulatory landscape of cells chromatin_structure may provide a missing_link for understanding the regulatory changes that occur during differentiation and disease because megabase scale tads appear to be highly_conserved across both cell_types and species it is likely that key changes in chromatin_organization occur at the sub tad scale for example changes in the structure of subtads could fine_tune opportunities for contact between genes and enhancers therefore methods for deciphering the hierarchical_structure of chromatin will be important for linking genome_architecture to cellular state 
