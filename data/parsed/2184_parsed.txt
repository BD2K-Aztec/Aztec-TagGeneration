hierarchical block matrices as efficient representations of chromosome topologies and their application for c data_integration motivation recent advancements in molecular methods have made it possible to capture physical contacts between multiple chromatin fragments the resulting association matrices provide a noisy estimate for average spatial_proximity that can be used to gain insights into the genome_organization inside the nucleus however extracting topological information from these data is challenging and their integration across resolutions is still poorly addressed recent findings_suggest that a hierarchical_approach could be advantageous for addressing these challenges results we present an algorithmic framework which is based on hierarchical block matrices hbms for topological_analysis and integration of chromosome_conformation c data we first describe chromohbm an algorithm that compresses high_throughput c hit c data into topological_features that are efficiently summarized with an hbm representation we suggest that instead of directly combining hit c datasets across resolutions which is a difficult_task we can integrate their hbm representations and describe chromohbm c an algorithm which merges hbms since three_dimensional d reconstruction can also benefit from topological information we further present chromohbm d an algorithm which exploits the hbm representation in order to gradually introduce topological_constraints to the reconstruction_process we evaluate our approach in light of previous image microscopy findings and epigenetic data and show that it can relate multiple spatial_scales and provide a more complete view of the d genome_architecture availability_and the presented algorithms are available from https github com hit c techniques provide a means for studying the genome_architecture at a range of resolutions as oppose to light_microscopy c gives a population_based measure that relies on spatial_proximity but does not directly convey a spatial context all c derivatives consist of cross_linking nuclei followed by chromatin digestion and re ligation quantifying the number of ligation events between two chromatin fragments gives their contact_frequency in the examined population of nuclei providing a pairwise estimator for their distance hit c methods most notably the hi c method detect contacts between groups of loci per chromosome or genome_wide which are typically summarized in a non negative matrix called a contact_map analyzing contact_maps can reveal different scales of topological organization at a megabase mb resolution chromatin compartments and sub compartments were identified with principal_component pca and clustering further suggested that at shorter length_scales kilobases kb a genomic bin can be assigned with a state which represents its preference to interact with other bins along the sequence directionality index upstream downstream or none using hidden_markov hmm the researchers have shown that the genome can be segmented into regions of bins with the same state leading to the definition of topologically associated domains tads upstream or downstream regions and their boundaries none regions dynamic_programming and change_point detection were also employed for identifying transitions in contact_frequency enrichment which induce a topological genome segmentation owing to the definition of tads their position and boundaries can change considerably depending on the sequencing_depth and the bin size used for example studying hit c contact_maps at different resolutions revealed that previously_identified large tads can be divided_into subtads this hierarchical organization suggests the need for methods that could go beyond the tad based_segmentation and capture topologies at different length_scales hierarchical topologies derived from contact_maps can further provide a spatial context for studying point wise and relational properties e g histone_modifications and gene coexpression respectively this can in turn uncover associations between spatial_organization structure and genomic_features function that could not have been discovered when considering only the proximity of the sequence such evidence synthesis requires an approach which can relate datasets at different resolutions and link genetic and epigenetic features to the spatial_scale at which they work physics and statistical_mechanics have provided valuable lessons about the genome_organization by modelling the chromatin fibre as a polymeric chain of beads researchers have applied polymer physics to study the expected genome topology and dynamics in particular the distance and probability of contact of between beads loci given their distance on the sequence were a subject for much research measurements obtained with fluorescence_in fish and hit c experiments were used to motivate and validate hypotheses concerning these properties respectively and together with general_characteristics of polymer_chain behaviour were used to propose different models of chromatin_organization the increasing volume of hit c data calls for the development of algorithms and data_structures that can summarize compress and integrate datasets while considering issues of time and space complexity such a computational_approach can complement physics simulations and provide the necessary framework for large_scale studies of the d genome_architecture and its function in this paper we present a hbm based algorithmic framework for topological_analysis and integration of hit c data we first introduce the hbm representation for contact_maps and give the necessary definitions section next we describe chromohbm an algorithm which compresses a contact_map into a hbm by iteratively detecting dense modules communities of interacting chromatin segments section we then focus on the application of hbms for c data_integration we explain the difficulties_involved in directly combining hit c datasets and propose to merge their hbm representations instead using the chromohbm c algorithm section we also note that spatial inference can benefit from incorporating topological knowledge and describe chromohbm d an algorithm which takes a d reconstruction method and iteratively guides it by means of hbm traversal section in order to evaluate our approach we study hi c datasets and show that hbms highlight key topologies and that the merged hbm representation can capture multiple_scales of spatial_organization that could not have been detected by separately analyzing each dataset for the sake of space robustness and running time evaluation is given in the supplementary suppl information additional results of related or exploratory_analysis are also available on request let a and b be two contact_maps h a and h b their hbms respectively and h a b the merged hbm of h a and h b we would like to test bullet is h a b consistent if h a b is consistent then its topology should be in agreement with the separate topologies of h a and h b as well as with previous_findings bullet is h a b powerful if h a b is powerful then it should add new information which is not available when independently analyzing h a and h b also there should be a clear motivation for not directly comparing a and b for example large variation in contact_frequency distribution and range further evaluation of the robustness consistency and performance running time of chromohbm chromohbm c and chromohbm d is described in the suppl information see in order to evaluate how consistent and powerful separate and merged hbms are we study two contact_maps and their hbms which considerably differ in their binning a and a kb contact_maps generated from human_fibroblasts nuclei for chromosome we first compare the corrected de noised contact_maps we find that the kb contact_map is sparser and that the distributions of the two contact_maps are significantly different onesided t test significant differences are observed also when considering non parametric tests such as the kolmogorov_smirnov test p value we assume that n is a natural number h a matrixk k expand h a for i to k do p i n for j i to k do q j n the kb contact frequencies range between and with a mean of and a median of while the distribution of the kb contact frequencies is more rightly skewed the kb contact frequencies range between and and have a mean of and a zero median in order to allow for a more direct comparison we standardize the two contact_maps and compute the expanded version of the kb contact_map using equation testing for agreement between the two standardized contact_maps which now match in their dimensions yields a low pearson_correlation value r put together the notable variations between the and kb contact_maps make it difficult to integrate them and motivate the use of their hbm representation for this purpose we next apply chromohbm in order to generate the hbm for each of the contact_maps using the infomap algorithm for detecting communities this algorithm which is recognized as a leading approach for community detection in undirected weighted graphs aims at finding an optimal compression of the information_flow in a graph using random_walks as a proxy for the amount of information transferred between nodes its key idea inspired by information_theory is that finding a compression that can closely recover the information_flow in a graph is equivalent to detecting its topological modules or communities which dictate the dynamics of the system in the suppl information we further show that chromohbm recovers similar hbms independently of the detection method used robustness evaluation see given their hbms we apply chromohbm c to compute the merged hbm representation of the two contact_maps for description purposes we use h h and h merged to denote the kb kb and the merged hbms respectively shows h enlarged for visual clarity h and h merged we notice that some topological patterns that appear in h are missing from h and vice_versa small communities that are detected at the first level of h are missing or merged in h at the second level the two hbms detect mega communities that roughly correspond or overlap these communities are further combined into two large_clusters in blue at the third level of h this level of hierarchical organization is completely_absent from h at the last level level and level for h and h respectively bins which correspond to regions with a poor mappability and thus poorly covered are merged with the others to form the global community from a signal_processing point_of according to the heisenberg uncertainty principle the observed trade_off between h and h is expected smaller bins can better detect small_scale topologies but miss large_scale features good knowledge of frequency but poor_knowledge of position in contrast larger bins capture large_scale organization on the expense of finer details good knowledge of position but poor_knowledge of frequency h merged accommodates for the distinct scales that are captured by h and h and provides a multi_scale view of the organization of chromosome its first level matches the first level of h a small_scale topology while its fifth level roughly corresponds to the third level of h a large_scale topology at intermediate levels overlapping features detected by both hbms are combined together forming a unified view of the separate hierarchies in order to further evaluate the consistency of h merged we study active and repressed domains in chromosome these domains belong to a group of regions which appear throughout the genome termed ridges and anti ridges which show distinct_functional and structural_characteristics ridge domains are rich with genes and active regulatory_elements and are highly transcribed and expressed active they possess an open chromatin topology which further correlates with their high expression_level in contrast anti ridge domains are gene poor lowly transcribed and expressed and present a close and packed topology repressed shows the hbms of chromosome at positions to green frame upper panel and to red frame lower panel which correspond to a ridge and an anti ridge domain respectively for these specific regions differences in density were also confirmed with fish distances within the ridge domain shown to be larger than distances within the antiridge domain in line with the trend observed when analyzing the entire chromosome h captures finer topological details compared to h at the first level the ridge domain of h consists of four communities which roughly correspond to two communities in h in a similar way the two communities detected in the anti ridge domain in h form a single community in h when considering h merged we find that the anti ridge domain presents a flatter hierarchy compared to the ridge domain two levels versus three levels respectively with a smaller number of larger communities this is in agreement with the characteristics of anti ridge domains which are more dense than ridgethe merged hbm of the hbms in a and b generated with chromohbm c this track was retrieved from the ucsc_genome website domains for the ridge domain the first and third level of h merged closely correspond to the first and second level of h respectively the second level of h merged reveals however an additional scale that is missing from h and h the last and first two communities along the diagonal which are detected at the first level form one mega community while the other two communities are merged into a second mega community this topology recapitulates the picks of a regulatory mark shown as a vertical track next to h merged in which is associated with a high transcription activity the h k ac histone mark the first mega community corresponds to h k ac picks while the second matches a flat profile this partition which is missing from the separate hbms further illustrates the advantage of a merged view of multiple_scales 
