a fast and automated solution for accurately resolving protein domain_architectures motivation accurate prediction of the domain content and arrangement in multi_domain which make up of the large_scale protein databases provides a valuable_tool for function prediction comparative_genomics and studies of molecular_evolution however scanning a multi domain protein against a database of domain sequence_profiles can often produce conflicting and overlapping matches we have developed a novel method that employs heaviest weighted clique finding hcf which we show significantly_outperforms standard published approaches based on successively assigning the best non overlapping match best match cascade bmc results we created benchmark data_set of structural_domain assignments in the cath database and a corresponding set of hidden_markov based domain predictions using these we demonstrate that by considering all possible combinations of matches using the hcf approach we achieve much higher prediction_accuracy than the standard bmc method we also show that it is essential to allow overlapping domain matches to a query in order to identify correct domain assignments furthermore we introduce a straightforward and effective protocol for resolving any overlapping assignments and producing a single set of non overlapping predicted domains availability_and the new approach will be used to determine mdas for uniprot and ensembl and made available via the gene d websitean active field of bioinformatics pursues the identification and classification of protein_domain this is critical to our understanding of how proteins evolve new functions and how domain_family content can explain phenotypic_variation between organisms from an annotation perspective newly to whom correspondence should be addressed the authors wish it to be known that in their opinion the first two authors should be regarded_as sequence genomes can be scanned against libraries of domain families in order to predict the function of novel genes however due to both the huge number of sequences in the protein databases and also the large number of domain families it is essential to use fast robust sequence_analysis and comparison techniques furthermore unless manual validation is used when building profiles of families a given query_sequence can generate many conflicting and overlapping matches these are the result of complex structural_rearrangements and gene fusion_events that have occurred throughout evolutionary_history resources such as interpro and pfam apply extensive curation of their family models and the resulting predictions in contrast fully_automated protocols remain useful in helping identify novel families that are then fed into the manual_curation pipelines rather than directly used for biological analyses i e pfam b adda and chop however using manual verification is very expensive_and and will become increasingly so in the era of high_throughput gene d a member of the interpro consortium provides domain annotations based on the cath structural_domain classification cath provides a manually validated set of domains derived from structures in the pdb and these domains are grouped into superfamilies where there is evidence of common evolutionary ancestry from shared sequence structural and functional features gene d uses a similar approach to the superfamily resource which is based on the scop structural_classification a set of structural representatives are chosen from each superfamily in cath and used to seed an automatic iterative search_process sam target k the resulting multiple_sequence is then converted into a hidden_markov hmm each superfamily may be represented by more than one model with an average of four per superfamily these models are then used to identify probable homologous domains in protein_sequences and the resulting predictions merged into a final_set of assignments gene d aims to provide high_quality structural_domain annotations for the major genome and protein sequence_databases including ensembl uniprot and refseq see supplementary data for example genome_coverage the annotation_pipeline for determining a multi domain_architecture of a given query_sequence can be considered to consist of three main steps generate a hmm_model library to represent structural_domains in cath scan the query against the model library using hmmsequence search software e g hmmer a cath benchmark_dataset was constructed from a representative set of sequences from the pdb in order to evaluate the relative performance of the bmc and hcf approaches as well as the effect of varying the allowed overlap threshold if the domain assignment and boundary resolution process was working accurately we would expect to be able to reconstruct the manual assignments by scanning the pdb benchmark set against the cath hmm library using the same set of hmm results the prediction set we tested the two approaches against each other along with varying the allowed overlap parameter shows a comparison of the accuracy of the two methods with respect to correctly predicting the multi domain_architecture when hmm matches are not allowed to overlap i e threshold page the residue accuracy is the percentage of residues determined correctly as according to the source cath assignments only multi domain data shown this measure reflects the accuracy of boundary assignments more reliably than attempting to determine equivalence between predicted segments and curated segments plotted on the y axis is the percentage of chains for which df or df achieve at least the accuracy indicated on the x axis shown are the accuracy distributions for the bmc grey and hcf black methods with allowed overlaps of triangles and crosses and residues dashes and diamonds using hcf with a residue overlap achieves accuracy for of chains while only of chains are at least that accurate when df is used the bmc method only achieves accuracy versus for hcf increasing the overlap threshold makes a substantial_difference to the percentage of correct predictions for both bmc and hcf but relies on the new overlap resolution mechanism in df an optimal overlap limit of residues increases mda prediction_accuracy from to for hcf while bmc accuracy improves from to the superior_performance of the hcf algorithm largely arises from a decrease in false_negatives i e missing domain assignments although there is also some improvement in the false_positive this improvement is confirmed by examining the residue assignment accuracy the original_version of df where overlap only annotated of sequences with residue accuracy while df where overlap achieved this level of accuracy on of sequences an alternative approach for determining the allowed overlap is to use a percentage of the match length as can be seen in similarly high levels of accuracy are achieved by using a threshold between and using the hcf approach however as noted in the supplementary data the true false_positive for the gene d models over this benchmark are very low we suspect that a percentage threshold will be less tolerant with noisy predictions if a match can be overlapped by up to of its length at each end then erroneous matches that do not align with the boundaries of correct ones are more likely to be incorporated we have also tested whether limiting the prediction of discontinuous domains to those superfamilies for which they have been observed would improve the accuracy of the algorithm however despite our concern that this might in fact over fit to the benchmark data_set it slightly reduced overall performance data not shown the cath benchmark whilst useful for optimising parameters and the core algorithm does not completely emulate a real worldoverlap accuracy using a percentage overlap threshold also performs well on this benchmark set however see supplementary data of the matches in this benchmark are to nonhomologous families and so it is not clear that this method would be tolerant of noisy_data see situation scanning large highly_divergent sequence_databases for which the nearest structural representative may have a very dissimilar sequence to better re create this situation we generated two smaller benchmark sets to capture key aspects of this variation as described in the section the distant benchmark and the gapped benchmark the results on the multi_domain show a similar distribution and profile to the original benchmark seeand b suggesting that the results for the main benchmark can be considered to be generally representative of the relative accuracy of the two approaches the benchmark results above give us confidence that using hcf and a residue overlap limitwhich we now term df will produce more accurate architectures and allow us to detect many more domains to test this we analysed their performance on largescale sequence_databases to examine whether the new approach will translate into a significant_improvement to the gene d resource we searched a sequence database comprising uniprot and ensembl with hmmer and the cath v hmm library the matches were then resolved using both the old protocol df bmc with a one residue allowed overlap and the newly_defined df heaviest weighted clique with a residue allowed overlap in a very small number of cases sequences a graph was produced that contained more than edgesfor these the hcf approach took at least a day and sometimes much longer to calculate hence matches for these query_sequences were instead resolved using bmc to keep the computation time feasible both df and df ran across the whole set within two days on two dual core ghz intel_xeon cpus the df algorithms can be easily parallelized and so can be distributed across multiple cpus in practice the overall speed is limited by the time taken to solve the single most complex graph the mdas predicted by df for uniprot contained more domains than those predicted by df an increase of and a similar increase for ensembl compared to df the majority of new domains were restricted to just a couple of hundred superfamilies though around half of all superfamilies showed a clear increase and showed any decrease see furthermore whilst all of the matches to one superfamily were lost page accurate prediction of multi domain_architectures can be extremely useful for many function and network prediction_methods including phylogenetic profiling gene fusion_detection proteinprotein_interaction inheritance and annotation by homology transfer however current automated approaches are of unknown accuracy or are compared with pfam or interpro where manual_curation requires substantial investment both resources also contain many families that are not based on single domains which in turn creates problems when benchmarking domain related methods such as ab_initio domain prediction_algorithms gene d aims to be a gold_standard provider of domain_family assignments of equivalent accuracy to the manually_curated resources so we set out in the first instance to define a useful measure of our accuracy in predicting multidomain architectures and then to improve on those predictions since it is not possible to accurately estimate performance over uniprot we have generated a pdb based benchmark that provides a means of comparing different algorithms i e bmc versus hcf furthermore we show that the results are likely to hold true for scanning large protein_sequence repositories by simulating cases of uncharacterised domain superfamilies and the absence of close_relatives the benchmarks suggest that using df hcf and residue allowed overlapleads to a increase in accuracy compared to the old df protocol for predicting multi domain_architecture from a list of matches to a hmm_model library including single_domain the overall accuracy is with many of the errors due to erroneous structures and assignments in the pdb and cath most of the increase in multi domain prediction_accuracy is due to the loss of false_negatives and so would be expected to translate into an increased number of domains found in the sequence_databases as expected the number of domains found in uniprot and ensembl increased by as of gene d version all annotations have been generated using df there remains some room for improvement on the specific failures and many common mda archetypes especially transmembrane_proteins are simply not present in the pdb 
