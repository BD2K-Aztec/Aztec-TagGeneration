genetics_and a dynamic bayesian markov_model for phasing and characterizing haplotypes in next_generation motivation next_generation ngs_technologies have enabled whole_genome discovery and analysis of genetic_variants in many species of interest individuals are often sequenced at low coverage for detecting novel variants phasing haplotypes and inferring population structures although several tools have been developed for snp and genotype_calling in ngs_data haplotype_phasing is often done separately on the called genotypes results we propose a dynamic bayesian markov_model dbm for simultaneous genotype_calling and haplotype_phasing in low coverage ngs_data of unrelated_individuals our method is fully probabilistic that produces consistent inference of genotypes haplotypes and re combination probabilities using data from the genomes_project we demonstrate that dbm not only yields more accurate results than some popular_methods but also provides novel characterization of haplotype structures at the individual_level for visualization interpretation and comparison in downstream_analysis dbm is a powerful and flexible tool that can be applied to many sequencing studies its statistical_framework can also be extended to accommodate broader scopes of data haplotype_phasing is a long_standing problem in population_genetics the task is to computationally infer the combination of alleles haplotype at multiple single_nucleotide snps on a single_copy of chromosome while the data are collected in genotype format combination of alleles per snp on two copies of chromosomes from diploid genomes haplotype_phasing is important because haplotypes provide rich_information about the evolution history of individuals haplotype_phasing is challenging because its complexity grows exponentially with respect to the number of snps although snp_arrays have been routinely used to collect genotype data from individuals they only quantify genetic_variants at known snps nextgeneration_sequencing ngs on the other hand has the ability to detect all genetic_variants in individuals genomes sequencing machine reads out genomes as short dna_fragments called reads after aligning the reads to a reference_genome or by de_novo putative snps are called if reads aligned at the same position carry alternative alleles genotypes are further called at the putative snps by comparing the read_counts of alternative alleles for haplotype_phasing snps are sorted by their positions so that information of linkage_disequilibrium ld can be used in this study we will focus on ngs_data because genotype data is just a special_case many haplotype_phasing algorithms have been developed over the past_decade recent methods all use pairs of markov_chains per diploid individual to model ld among snps the states in markov_chains correspond to haplotypes and the transitions of states indicate recombination_events most methods however are designed for genotype data only although ngs_data can be converted to genotypes before haplotype_phasing such approach will produce poor results in low_coverage studies some methods also require genetic_maps which are unavailable in many studies we identified three methods that can phase haplotypes in ngs_data thunder pphs and hapseq thunder is a wrapper of mach where the latter works on genotype data and is among the most accurate methods in haplotype_phasing we therefore used thunder as a benchmark in this study pphs uses perfect phylogeny to infer haplotypes it however is designed for data in short regions without recombination and relies on other methods to assemble short haplotypes into longer ones we therefore did not include pphs in this study hapseq is modified from thunder that improves on haplotype_phasing if a read carries multiple alleles we did not compare hapseq as it addresses a different problem we included beagle as a second benchmark method beagle runs faster than thunder but performs as accurate although beagle does not directly work on ngs_data it takes genotype likelihoods as input which can be generated from read_counts we introduce a dynamic bayesian markov_model dbm for phasing and characterizing haplotypes in ngs_data of unrelated_individuals three main reasons motivated this work first we want to design a coherent probabilistic_model for haplotype_phasing such that inference consistency is theoretically justifiable some existing_methods use iterative conditional_probabilities to infer haplotypes for one individual at a time with the remaining individuals serving as donors such models do not have joint distributions corresponding to the conditionals used in iteration and thus their results may not be consistent second we want to develop a concise but sufficient representation of haplotypes for intuitive interpretation visualization and comparison in downstream_analysis existing_methods only output strings of alleles as haplotypes which neither reflect snp dependencies nor suggest haplotype relationships among individuals in many studies haplotypes are not of direct interest they are instead used as input in downstream studies such as association_mapping and population inference haploview is one example of haplotype characterization which shows haplotype block structures and snp correlation haploview however does not characterize haplotypes at the individual_level our third motivation is to provide users with a flexible tool for ngs_data analysis which can be applied to any species of interest with minimum input from the users a schematic view of our approach is shown in the observed read_counts do not carry haplotype_information across snps dbm takes read_counts as input and infers haplotypes via three key components an infinite state hidden_markov hmm modelling templates of haplotypes with two markov_chains fitted to each individual an emission probability of alleles from the state at each snp and an observation probability connecting alleles to the observed read_counts dbm is an example of non parametric bayes model equipped with markov structures and is also a variant of infinite state hmm we use markov_chain mcmc algorithms to estimate posterior distributions of model_parameters of interest particularly dbm outputs genotypes haplotypes and recombination probabilities between snps in addition dbm produces segmentations of haplotypes at the individual_level as mosaic combinations of states haplotypes within the same states are similar across snps but not necessarily identical due to random_mutations the state information produced by dbm can be directly visualized to evaluate the relationships of haplotypes among individuals at the snp resolution haplotype_blocks and recombination_hotspots can also be easily_identified a challenging_problem in hmm is to determine the number of states although too many states may reduce inference efficiency and over fit the data too few states may not be sufficient to capture all the information in the data and thus loose power in dbm we allow the number of states to vary across snps dbm uses a non parametric bayesian process to dynamically infer the number of states across snps it has great flexibility to fit regions with either simple or complex structures simultaneously dbm avoids over fitting the data via bayesian regularization we introduced a dynamic bayesian markov_model for joint inference of genotypes and haplotypes in ngs_data the method is fully probabilistic and produces consistent inference results a main_feature of dbm is its infinite state markov_chain that allows varying numbers of mixture components fitted to the data depending on the structural_complexity of the data across regions such that haplotype structures and snp dependencies can be most efficiently and sufficiently captured by the states using data from the genomes_project with individuals of different ethnicity we compared dbm with two popular algorithms thunder and beagle as they both have been used to phase haplotypes in the genomes_project the in all scenarios tested dbm produced either similar or better results than the two benchmark programs particularly for small sample datasets and or low sequencing studies dbm performed substantially better than the other two programs dbm is thus desirable for exploratory sequencing studies that involve limited samples at low sequencing_coverage for large sample datasets dbm performed_similarly to the other two methods and dbm had better runtime scalability with respect to the sample_size all three programs tested in this study call genotypes and phase haplotypes simultaneously which is more powerful than the two step approach consistent_with we demonstrated that using ld_information can substantially_increase the accuracy of genotype_calling dbm is a flexible tool that can be applied to many sequencing_projects with minimum input requirement from the user dbm takes input of either read_counts or genotypes in form of pseudo read_counts and outputs genotypes haplotypes and recombination probabilities additional information such as snp quality_scores and genetic_maps can also be provided but not mandatory missing genotypes can be easily accommodated and imputed by specifying zero read_counts for both alleles in the input_file although all examples shown in this article were generated from data in human_genome dbm can be directly applied to sequencing studies of any diploid species to fully use ld_information snps should be ordered by their genomic positions on the other hand dbm can work on unsorted snps in which case it reduces to a single snp call method dbm characterizes haplotypes via segmentation that captures the haplotype relationships among individuals and de correlates alleles across snps it also reveals the most likely recombination loci at the individual_level one can use dbm segmentation in downstream_analysis for hypothesis_testing and parameter_inference such as association_mapping and population evolution studies most de_novo population detection_algorithms require independent snps whereas our approach_enables use of all snps in form of haplotype segments which can potentially significantly increase the power for detecting subtle stratification dbm reports summary_statistics of a sample in form of haplotypes templates the templates are identified as commonly shared haplotypes among individuals the haplotype templates can be used to learn genetic_relatedness and diversities within and between groups of samples at the snp resolution to compare groups of individuals data from all groups of individuals should be input to dbm together such that the state indices are matched across groups population ngs_data are being increasingly generated in many species of interest and the sequencing cost continues to drop although dbm only facilitates the first step in population sequencing studies the dbm model itself has broader applications for example we can modify the observation and emission probability functions to take various types of data into account we can also modify the dbm model for de_novo detection of population_stratification and admixture_mapping where we allow unknown numbers of populations to be admixed without requiring ancestral references 
