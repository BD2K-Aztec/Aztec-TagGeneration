variance adaptive shrinkage vash flexible empirical_bayes estimation of variances motivation genomic studies often involve estimation of variances of thousands of genes or other genomic units from just a few measurements on each for example variance estimation is an important step in gene_expression aimed at identifying_differentially a common approach to this problem is to use an empirical_bayes eb method that assumes the variances among genes follow an inverse gamma_distribution this distributional assumption is relatively inflexible for example it may not capture outlying genes whose variances are considerably bigger than usual here we describe a more flexible eb method capable of capturing a much wider_range of distributions indeed the main assumption is that the distribution of the variances is uni modal or as an alternative that the distribution of the precisions is unimodal we argue that the unimodal assumption provides an attractive compromise between flexibility computational tract ability and statistical efficiency results we show that this more flexible_approach provides competitive_performance with existing_methods when the variances truly come from an inverse gamma_distribution and can outperform them when the distribution of the variances is more complex in analyses of several human gene_expression from the genotype tissues expression consortium we find that our more flexible model often fits the data appreciably better than the single inverse gamma_distribution at the same time we find that in these data this improved model_fit leads to only small improvements in variance estimates and detection of differentially_expressed availability_and our methods are implemented in an r package vashr available fromgenomic studies often involve estimation of variances of thousands of genes or other genomic units from just a few measurements on each for example variance estimation is an important step in gene_expression aimed at identifying_differentially the small number of measurements on each gene mean that simple estimates of the variance at each gene e g the sample variance can be quite unreliable a common solution to this problem is the use of empirical_bayes eb methods which combine_information across all genes to improve estimates at each gene in particular they have the effect of shrinking the variance estimates towards a common mean value which has a stabilizing_effect avoiding unusually large or small outlying estimates that may have high error a key_question is of course how much to shrink while all eb methods aim to learn the appropriate shrinkage from the data existing eb approaches make relatively inflexible modelling assumptions that could limit their effectiveness here we propose a new more flexible eb approach which can improve variance estimation accuracy in some settings perhaps the most commonly_encountered example of the use of eb methods is in gene_expression that aim to identify differences in gene_expression among conditions a typical pipeline for identifying_differentially computes a p value for each gene using a t test two condition experiments or f test multiple condition experiments both of which require an estimate of the variance in expression of each gene among samples in the classical t test or f test sample variances are used as plug in estimates of gene specific variances however when the sample_size is small sample variances can be inaccurate resulting in loss of power hence many methods have been proposed to improve variance estimation for example several papers suggested adding an offset standard_deviation to stabilize small variance estimates a more sophisticated approach used parametric hierarchical_models to combine_information across genes using an inverse gamma prior_distribution for the variances and a gamma likelihood to model the observed sample variances this idea was further developed by l nnstedt and speed andsmyth into an empirical_bayes eb approach that estimates the parameters of the prior_distribution from the data this improves_performance by making the method more adaptive to the data smyth also introduces the moderated t test which modifies the classical t test by replacing the gene specific sample variances with estimates based on their posterior_distribution this pipeline implemented in the software limma is widely used in genomics thanks to its adaptivity computational_efficiency and ease of use while assuming an inverse gamma_distribution for the variances yields simple procedures the actual distribution of variances may be more complex motivated by this phipson et_al limma with robust option denoted by limmar modified the procedures from smyth to allow for some small proportion of outlier genes that have higher variability than expected under the inverse gamma assumption specifically the limmar procedure changes the moderated t statistics from limma by decreasing their degrees_of df in a way that varies for each gene depending on whether the gene looks like an outlier genes that look like an outlier have their df reduced appreciably making them less significant whereas other genes have their df unchanged or reduced very little they showed that in the presence of such outliers this procedure could improve on the standard limma pipeline here we consider a more formal eb approach to this problem which generalizes previous eb methods by replacing the usual inverse gamma prior_distribution with a substantially more flexible family of distributions the main constraint we place on this prior is that the distribution of the variances or alternatively the precisions is unimodal this unimodal assumption not only seems likely to be plausible in many settings but also provides an attractive compromise between flexibility statistical stability and computational convenience specifically it provides more flexibility and generality than many parametric_models while avoiding potential over fitting issues of fully non parametric methods an alternative approach would be to use some kind of regularization to prevent over fitting see efron for example we use a mixture of possibly a large number of inverse gamma distributions to flexibly model this unimodal distribution and provide simple computational procedures to fit this model by maximum_likelihood of the mixture proportions our procedure provides a posterior_distribution on each variance or precision as well as point_estimates posterior mean the methods are an analogue of the adaptive shrinkage methods for mean parameters introduced in and are implemented in the r package vashr for variance adaptive shrinkage in r we compare our method with both limma and limmar in various simulation_studies and also assess its utility on real_gene we have presented a flexible empirical_bayes approach variance adaptive shrinkage or vash to shrinkage estimation of variances the method makes use of a mixture_model to allow for a flexible family of unimodal prior distributions for either the variances or precisions and uses an accelerated em based algorithm to efficiently estimate the underlying prior by maximum_likelihood although slower than limma vash is computationally_tractable for large_datasets for example for data with genes vash typically takes about s limma takes just a few seconds our results demonstrate that vash provides a robust and effective approach to variance shrinkage at least in settings where the distribution of the variances or precisions is unimodal when the true variances come from a single inverse gamma prior vash is no less accurate than the simpler method when the variances come from a more complex distribution vash can be more accurate than simpler methods if the sample_sizes to estimate each variance are sufficiently_large in the gene_expression we examined here the gains in accuracy of vash versus limma are small and likely not practically important while this could be viewed as disappointing it nonetheless seems useful to show this since it suggests that in many gene_expression contexts the simpler approaches will suffice at the same time it remains possible that our method could provide practically useful gains in accuracy for other datasets and as we have shown it comes at little cost in addition our work provides an example of a general approach to empirical_bayes shrinkageuse of mixture components with a common_mode to model unimodal prior distributionsthat could be useful more generally our method is implemented in an r package vashr available from http github com mengyin vashr codes for reproducing analyses and figures in this paper are at https github com mengyin vash 
