minfi a flexible and comprehensive bioconductor_package for the analysis of infinium dna_methylation microarrays motivation the recently released infinium humanmethylation array the k array provides a high_throughput assay to quantify dna_methylation dnam at loci across a range of genomic_features although less comprehensive than high_throughput sequen_cing based techniques this product is more cost_effective and promises to be the most widely used dnam high_throughput measurement technology over the next several years results here we describe a suite of computational_tools that incorporate state of the art statistical_techniques for the analysis of dnam data the software is structured to easily adapt to future versions of the technology we include methods for preprocessing quality_assessment and detection of differentially_methylated from the kilobase to the megabase scale we show how our software provides a powerful and flexible development platform for future methods we also illustrate how our methods empower the technology to make discoveries previously_thought to be possible only with sequencing based_methods availability_and dna_methylation dnam is a chemical_modification of dna that plays_a in regulating gene_expression epigenetic_mechanisms including dnam allow a single_genome to give rise to hundreds of phenotypically diverse cell_types in addition to its importance in normal development dnam is thought to play_an in diseases when dysregulated chemically dnam involves the addition of a methyl_group to a cytosine base c forming methylcytosine in adult mammalian_cells this modification occurs almost exclusively at cs immediately followed by a g in the direction denoted by cpg cpgs are depleted in mammalian_genomes and those that remain tend to cluster in regions termed cpg islands gardiner that are enriched near gene_promoters the health_implications of deciphering the dnam code have recently_received dnam is best understood in the context of cancer_biology where it is clear that aberrant gains_and of dnam almost universally accompany the initiation and progression of tumors much of the excitement surrounding epigenetics relates to the promise of therapies that reverse disease associated epigenetic_alterations thereby activating or silencing aberrantly_expressed diseaserelated genes as a result of dnams role in developmental and disease biology there is great interest in measuring dnam at a comprehensive genomic_scale although next_generation offer several promising new approaches currently illumina_infinium arrays are the most widely used technology for this purpose for example the cancer_genome tcga project is using this array and has already processed samples as of and made the data publicly_available http cancergenome nih gov furthermore large_cohort are becoming interested in measuring methylation and are expected to use cost_effective arrays with some studies already published this work introduces a software_development framework for the analysis of illumina_infinium methylation arrays although the design is general the current version of our software focuses on the illumina_infinium humanmethylation bead_array the k array their most recent product this array has been extensively described but we include a to whom correspondence should be addressed short description here for completeness the two color array interrogates the methylation status of methylation loci mostly cpg_sites but a small number of cytosines outside of the cpg context are also present using bisulfite_converted for each methylation locus two signals of interest are recorded one signal measures the amount of methylated_dna meth and the other signal measures the amount of unmethylated dna unmeth in principle the proportion meth unmeth meth is the methylation ratio referred to as beta value by illuminas software in the population of cells from which we extract dna the methylation ratio or its logit transform is the quantity used in downstream_analysis in the scientific_literature related to the k platform logittransformed beta values are referred to as m values the meth and unmeth signals do not relate to the green and red channels in a straightforward way the k platform includes two different methylation assay designs referred to as infinium i and infinium ii or type_i each methylation locus is interrogated by one of these designs for a type i locus the meth and unmeth signals are measured by two paired probes with a given locus using either the red or green signal from these probes type_ii loci are assayed using a single_probe with meth and unmeth signals derived from the green and red channels respectively in addition to the methylation loci the array contains a small number of control probes and probes measuring common single_nucleotide snps intended for sample tracking the reasoning behind using two different probe designs is simple but illuminating for potential developers type_ii probes use only one probe per methylation locus and hence allow more loci on the array at a fixed array size however owing to the chemistry used by the type_ii probe design type_ii probes can only tolerate up to three cpgs within the bp probe the type i design tolerates more cpgs within the bp probe but assumes that all methylation loci in the probed sequence are in the same state i e the probe measuring meth assumes all cpgs within the probed sequence to be methylated and the probe measuring unmeth assumes all cpgs in the probed sequence are unmethylated the ability to tolerate more cpgs in the probe allows type i probes to be used in regions of high cpg density such as cpg islands cgi until recently studies of dnam have focused largely on cgi for example the illumina products that preceded the k included the widely used infinium k array exclusively targeted cgi primarily at gene_promoters however using a noncgi centric array design referred to as comprehensive arrays for relative methylation charm demonstrated that greater_variability is present in regions outside cgi and coined the term cgi shores for regions within kb of cgi the k array design includes a set of regions identified as tissue or cancer specific using charm data including cgis and cgi shores as well as probes in other regions which illumina refers to as shelf and open sea here we present a software_suite containing an assortment of new functionality for the analysis of this array but also containing an infrastructure useful as a development platform for the research_community we note that subset quantile within array normalization swan one of the first alternative preprocessing methods was developed by another group using our infrastructure among the tools developed by our group we specifically describe bump hunting and block finding capabilities although current data analyses for these arrays have relied on single_probe analysis we have previously pointed_out the advantages of borrowing strength across neighboring loci furthermore a recent_finding related to cancer was the observation of large_genomic kb hypomethylated blocks we introduce an approach that permits the discovery of hypo and hypermethylated blocks with k data we illustrate the advantages of our software with publicly_available data we have demonstrated several downstream advantages of using the minfi package several preprocessing algorithms are available and the infrastructure provides a convenient way for developers to easily implement their techniques as bioconductor tools in our experience of samples are of unusable quality and visualization utilities provided by minfi permit users to identify these samples at the earliest stage of the analysis by making snp annotation available users can choose to be cautious about probes that may behave unexpectedly due to the inclusion of a snp in the probe sequence we have demonstrated that degs are more likely to be located near dmrs than cpgs identified by single_probe analysis existing_methods for identifying dmrs typically use fixed size or dynamic windows to group individually significant dmps into regions http www cancer ucl ac uk medicalgenomics champ our software is unique in that it provides both bump hunting and block finding capabilities and the assessment of statistical_significance for the identified regions finally because the package is implemented in bioconductor it gives users access to the countless analysis and visualization_tools available in r 
