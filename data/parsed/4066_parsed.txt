genetics_and robust relationship inference in genome_wide genome_wide gwass have been widely used to map loci contributing to variation in complex_traits and risk of diseases in humans accurate specification of familial relationships is crucial for family based gwas as well as in population_based gwas with unknown or unrecognized family_structure the family_structure in a gwas should be routinely investigated using the snp data prior to the analysis of population_structure or phenotype existing algorithms for relationship inference have a major weakness of estimating allele_frequencies at each snp from the entire_sample under a strong assumption of homogeneous population_structure this assumption is often untenable results here we present a rapid algorithm for relationship inference using high_throughput genotype data typical of gwas that allows the presence of unknown population_substructure the relationship of any pair of individuals can be precisely inferred by robust estimation of their kinship coefficient independent of sample_composition or population_structure sample invariance we present simulation_experiments to demonstrate that the algorithm has sufficient power to provide reliable inference on millions of unrelated pairs and thousands of relative pairs up to rd degree relationships application of our robust algorithm to hapmap and gwas datasets demonstrates that it performs properly even under extreme population_stratification while algorithms assuming a homogeneous_population give systematically biased results our extremely efficient implementation performs relationship inference on millions of pairs of individuals in a matter of minutes dozens of times_faster than the most efficient existing algorithm known to us genome_wide gwass have been widely used to identify common_variants that contribute to variation in complex to whom correspondence should be addressed human phenotypes and diseases pedigree integrity is crucial to the performance of family based gwa as well as in population_based data with unknown family_structure high_throughput performed in a gwas presents new opportunities for pedigree error_detection using millions of snps to assess the degree of relationship between a pair of individuals with these opportunities come the challenges of accounting for linkage_disequilibrium among typed markers while managing computational_resources to analyze the large amount of genotype data compared to linkage_studies association studies also require consideration of population_substructure misreported race and ethnicity and unreported familial relationships among samples recruited as unrelated_individuals one well developed approach for relationship inference in linkage_studies offers fully parametric methods for sib pairs and extensions to general pedigrees using hidden_markov hmm to calculate multipoint marker probabilities incorporated into a likelihood framework to assess evidence in support of particular pair_wise relationships in considering full multipoint marker probabilities computational_demands increase with the number of markers genotyped making analysis of gwas snps for all pairs of individuals prohibitive a simple method known as grr graphical_representation of relationship errors uses clustering of readily available non parametric estimates for mean and standard_deviation sd of identical by state ibs statistics at a series of markers for each pair of relatives grr identifies outliers of clusters as relationship errors performance of the clustering_algorithm used to classify relative pairs depends on the panel of genetic_markers the underlying allele_frequencies of genetic_markers for different individuals and the number of individuals genotyped if certain pairs of individuals do not clustereither due to limitations in sample_size or due to the different underlying allele_frequencies between different pairs e g in the presence of population_structure grr fails to detect the pedigree errors one efficient implementation of relationship inference in gwas data is available in a widely used software_package plink the identicalby descent ibd statistics between each pair of individuals are estimated using the average of ibs and the estimation of samplelevel allele_frequencies at each snp according to hardyweinberg equilibrium hwe assumptions all popular algorithms for relationship inference depend on reliable estimates of allele_frequencies at each snp assuming a homogeneous_population without stratification recent gwas analytic advances for association_mapping have incorporated the presence of unknown family and population_structure however algorithms to estimate family_relationships remain based on the assumption of population homogeneity in samples with undetected population_substructure this strong assumption of population homogeneity leads to biased results systematically inflating the degree of relatedness among individuals of the same racial_group current approaches to relationship and population_structure inference are somewhat circular the relationship inference relies on correct specification of a homogeneous subpopulation while the detection of population_structure relies on the correct identification of unrelated_individuals in addition to the non robustness to the population_structure existing_approaches do not apply to small_datasets e g for comparison of a single pair of individuals or relationship inference on a single pedigree we present a novel framework for relationship inference kinshipbased inference for genome_wide king together with a rapid algorithm for relationship inference appropriate for use on samples with thousands of individuals genotyped at millions of snps from autosomes consistent with a scale typically achieved in a gwas within this framework we present two methods i king homo derived under the assumption of population homogeneity and ii king robust that provides robust relationship inference in the presence of population_substructure the estimated pedigree_information provided by king such as kinship coefficients can be used to verify relationships reconstruct pedigrees and conduct genetic_association tests without relying on self_reported pedigree_information our computationally_efficient and flexible_approach allows automated pedigree error_detection and is amenable to datasets involving a very small number of individuals as encountered in forensic dna analysis 
