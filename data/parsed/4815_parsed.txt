using de_novo protein_structure predictions to measure the quality of very large multiple_sequence motivation multiple_sequence msas with large_numbers of sequences are now commonplace however current multiple_alignment benchmarks are ill suited for testing these types of alignments as test cases either contain a very small number of sequences or are based purely on simulation rather than empirical data results we take advantage of recent_developments in protein_structure prediction_methods to create a benchmark conttest for protein msas containing many thousands of sequences in each test case and which is based on empirical biological data we rank popular msa methods using this benchmark and verify a recent result showing that chained_guide increase the accuracy of progressive alignment packages on datasets with thousands of proteins making a multiple_sequence msa of nucleotide or amino_acid is a crucial step needed in a wide_variety of bioinformatics studies to overcome the extreme computational_demands of exact algorithms msa software uses heuristics to find near optimal alignments in a reasonable time different software_packages however use different heuristics and objective_functions and explicitly focus on different aspects of the msa process such as accurate placement of gaps for phylogenetic_reconstruction of small numbers of sequences l ytynoja and or sheer speed for making very large_alignments e g mafft parttree accurate benchmarks are therefore important to allow users of msa software to choose the most appropriate tools and to guide developers in improving algorithms and heuristics as computational_resources and sequence_databases grow and methods for creating msas are improved the practical upper_limit for the size of msas increases currently alignments of tens_of of sequences can be made routinely on a desktop computer it is therefore important that benchmarks can reflect alignment problems on this scale current protein msa benchmarks can be divided_into structure phylogeny simulation and consistency based benchmarks structure and phylogeny based benchmarks in which scores are based on structural superpositions and accurate inference of phylogenetic_trees respectively are strongly grounded in empirical biological data but they focus on alignments of small numbers of sequences and are difficult to scale to larger datasets meanwhile simulation and consistency based benchmarks are based on simulations of protein evolution and simple agreement between different msa methods respectively and can involve alignments of arbitrary size it is unclear however how well simulated sequences model actual biological_sequences while consistency measures only how similar the results of one heuristic_method are to the results of other heuristic methods we developed conttest a benchmark for large protein msas based on the accuracy of de_novo contact_map conttest contains test cases with between and sequences median and an average length of between and residues median see supplementary table s and we used the benchmark to score alignments made by clustal omega kalign mafft katoh and muscle clustal w kalign and hmmt additionally the pfam_database contains msas of all sequences in each protein_family and we used the benchmark to score the full alignments from pfam clustal omega kalign mafft and hmmt were all run with default_parameters to make alignments in a reasonable time kalign was run with the fast heuristic f option muscle was limited to two iterations and clustal w reused the guide_tree generated by clustal omega benchmark scores for these alignment_methods are listed in at the top of the rankings are the hmmt kalign and pfam alignments these results are striking and unexpected since the method by which the pfam alignments are created is not directly applicable to general msa problems the quality of pfam alignments has not previously been assessed in msa benchmark studies similarly neither kalign nor hmmt have to our knowledge been considered in any recent benchmarking studies as kalign is superseded by kalign and hmmt is not included in recent versions of hmmer the pfam alignments are created in two steps first a manually_curated seed alignment is created from a small set of sequences representative of the sequence family this seed alignment is used to train an hmm which is then used to search a sequence database and align matching sequences to the seed alignment we note that this processaligning sequence matches from a database oneby one to a small seed alignmentis effectively performing progressive alignment with an almost perfectly chained guide_tree kalign uses a traditional progressive msa strategy with pairwise sequence distances estimated by approximate k tuple matching however we found that kalign with the fast f option skips pairwise distance calculations and performs alignment with a fully chained guide_tree although this is an undocumented feature meanwhile hmmt produces an msa as a side effect of training an hmm on the input_sequences and does not use a guide_tree as part of this process thus the sequence_clustering step which is characteristic of progressive msa is not performed by any of these alignment_methods the next highest scoring_method is kalign kalign version like version is a progressive aligner but lacks the option of its predecessor to use a fully chained guide_tree however it uses the muth manber algorithm to perform approximate k tuple matching to estimate pairwise sequence_similarities before constructing the guide_tree the pairwise distance_metric used tends to produce_highly chained_guide we find that this is true for our test cases with kalign guide trees having high measures of imbalance when compared with clustal omega mafft or muscle supplementary figs s and s this appears to be related to the length of the sequences aligned with shorter average sequence_lengths resulting in more chained_guide supplementary conttest is the first protein msa benchmark to realistically test alignments of large_numbers of sequences and base scores on empirical biological data although structure based benchmarks may contain alignments with many sequences e g homfam scores are always based on reference alignment of a small subset of sequences_contained in the msa this could allow large errors in non reference_sequences to go unpunished in addition the structure based reference alignment must itself be created and this alignment depends on heuristic structure comparison algorithms meanwhile the phylogeny based speciesdiscordance benchmark of dessimoz and gil in which phylogenetic_trees are inferred from msas and compared with a known reference treeis restricted to testing alignments of six sequences simulation based benchmarks allow for arbitrary numbers of sequences in test alignments but depend on simplified models of evolution and may not realistically model gap placement in real proteins our benchmark method uses information from all sequences in the input alignments test cases must contain a minimum of about sequences so there is sufficient information in the alignment to make contact predictions but there is no practical upper_limit on the number of sequences our benchmark scores confirm the utility of completely chained_guide as described by that result has been controversial but at least for alignments of many sequences from structurally conserved_regions the results appear clear and robust alignments made with fully or even largely chained_guide consistently outscore alignments made with more traditional guide trees each of the alignment packages that accepts user specified guide trees benefitted from using chained_guide and the increase in score due to chained_guide was greater than the increase due to extra iterations of clustal omega or muscle or using a high_quality external hmm with clustal omega our scores also demonstrate the quality of the alignments in the pfam_database which may have previously been neglected as well as suggesting that both kalign and hmmt bemeasuring the quality of large multiple sequence alignmentsrevisited as useful methods for creating alignments of large_numbers of sequences we have shown that the conttest benchmark is in general agreement with structure based benchmarks for large_numbers of sequences however we observe that the methods that produce the most accurate alignments for large_numbers of sequence do not necessarily perform well for small number of sequences as measured by the prefab benchmark supplementary conttest is likely to be most sensitive to alignment errors in regions which are structurally_conserved but without very high levels of sequence_conservation that is regions of the protein in which amino_acid are accepted but must be compensated for at co evolving sites a limitation of this benchmark is that all alignments inherently involve only sequences of a single protein domain without any large_insertions it is likely that certain methods might perform poorly on more general alignment problems involving multiple domains in particular for hmmt alignments it is necessary that a sensible hmm can be trained on the input_sequences which may not be possible in the general_case however these are problems that may be addressed by future benchmarks and alignments of single protein_domains are common and important in many applications finally these results give some clear pointers toward the best methods for making msas intended for use with de_novo structure_prediction and show that choice of alignment_method can have a large influence on the quality of contact predictions even when using the same software_package with different parameters 
