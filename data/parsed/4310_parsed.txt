snpgenie estimating evolutionary_parameters to detect natural_selection using pooled next_generation data new applications of next_generation use pools of dna from multiple_individuals to estimate population_genetic parameters however no publicly_available tools exist to analyse single_nucleotide snp_calling results directly for evolutionary_parameters important in detecting natural_selection including nucleotide_diversity and gene_diversity we have developed snpgenie to fill this gap the user submits a fasta reference_sequence s a gene_transfer format gtf file with cds information and a snp report s in an increasing selection of formats the program estimates nucleotide_diversity distance from the reference and gene_diversity sites are flagged for multiple_overlapping reading frames and are categorized by polymorphism type nonsynonymous synonymous or ambiguous the results allow single nucleotide single codon sliding_window whole gene and whole_genome population analyses that aid in the detection of positive and purifying natural_selection in the source population availability_and snpgenie version is a perl program with no additional dependencies it is free open_source and available for download at https github com hugheslab snpgenie contact next_generation ngs_technologies allow the rapid sequencing of pooled_dna samples containing genetic_material from multiple_individuals the resultant single_nucleotide snp data may be used to reliably estimate population_genetic parameters with more accuracy and less expense than the separate sequencing of multiple_individuals especially when samples are large and coverage is high unfortunately high coverage data also suffer from a substantial false_positive error_rate snp_calling techniques can address_this but the only software currently available for evolutionary_analysis of pooled ngs_data popoolation is inextricable from a problematic snp caller that has an extremely_high false_positive further popoolation relies on large pileup files and problematic simplifications including use of the reference_sequence alone to determine the number of nonsynonymous and synonymous sites ideally software for evolutionary_analyses of these data would allow users to first call snps using any preferred method and then process the results using standard methods for determining the numbers of nonsynonymous and synonymous differences and sites we have developed snpgenie to meet this need using snp_calling results snpgenie estimates i nucleotide_diversity p and its nonsynonymous and synonymous partitions p n and p s for coding circumventing a major_limitation of pooled data for other applications indefinitely large_genomes with multi nucleotide variants may be analysed at speeds exceeding those of popoolations default_settings the results allow users to test evolutionary hypotheses on the roles of negative purifying_selection positive darwinian selection and random genetic_drift in the sampled population in general p n p s indicates neutrality p n p s indicates purifying_selection and p n p s may indicate positive_selection favoring multiple amino_acid changes comparing h o at distinct polymorphic site categories may also address these hypotheses parameter_estimates are available at the nucleotide codon sliding_window whole gene and whole_genome population levels to validate snpgenies execution of themethod we constructed sequences with all non stop_codons and known numbers of differences mega version was used to calculate p n and p s snp reports and gtf files were then constructed to reflect the known variant frequencies and reference_sequence and snpgenie was used to estimate the same parameters all results agreed to the last decimal next both snpgenie and popoolation were used to analyse a pooled h n sample the nonsynonymous and synonymous mean numbers of pairwise_differences per site and numbers of sites the numerator and denominator of p n and p s were then estimated for the hemagglutinin ha supplementary tables s a and s b and neuraminidase na supplementary tables s a and s b genes when popoolation estimates were regressed on those from snpgenie all r values were significant p f test but smaller for differences in na popoolation overestimated differences for ha and underestimated them for na while overestimating the number of nonsynonymous sites p was significantly_lower in ha p for p n p for p s two sample t tests consistent with previous evidence for a population bottleneck upon viral_transmission that is driven by selection for specific ha residues because popoolation overestimated differences in ha this suggests that its false_discovery may be exacerbated in low diversity e g bottlenecked contexts most differences between snpgenie and popoolation can be attributed to i differences in snp_calling ii popoolations treatment of stop_codon variants as nonsynonymous and iii snpgenies use of allele_frequency data in determining the number of sites contrasted to popoolations use of the reference_sequence alone popoolation also reports p s for codons with no synonymous sites where p s should be undefined this could highly inflate the p n p s ratio overestimating the prevalence of positive natural_selection if the false_positive calls are random will be nonsynonymous exacerbating this problem planned future improvements in snpgenie include additional snp report formats e g vcf and weighted mutational pathways 
