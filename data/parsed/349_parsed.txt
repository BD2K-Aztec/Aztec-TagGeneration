gene_expression an improved method for computing q values when the distribution of effect_sizes is asymmetric motivation asymmetry is frequently observed in the empirical distribution of test_statistics that results from the analysis of gene_expression experiments this asymmetry indicates an asymmetry in the distribution of effect_sizes a common method for identifying differentially_expressed de genes in a gene_expression experiment while controlling false_discovery fdr is storeys q value method this method ranks genes based solely on the p values from each gene in the experiment results we propose a method that alters and improves upon the q value method by taking the sign of the test_statistics in addition to the p values into account through two simulation_studies one involving independent normal data and one involving microarray_data we show that the proposed method when compared with the traditional q value method generally provides a better ranking for genes as well as a higher number of truly de genes declared to be de while still adequately controlling fdr we illustrate the proposed method by analyzing two microarray_datasets one from an experiment of thale cress seedlings and the other from an experiment of maize leaves availability_and the r code and data_files for the proposed method and examples are available at bioinformatics online performing tens_of of hypothesis_tests for one experiment has become a commonplace as technologies for producing high_dimensional are becoming more prominent this is especially the case in the field of statistical genomics where technologies such as microarray_and see brown and botstein or metzker for reviews of thesemeasure the abundance of messenger rna_transcripts for thousands of genes in each subject of a gene_expression study oftentimes researchers are interested in comparing the gene_expressions of subjects from two treatment groups a major objective of such experiments is to identify genes that exhibit differential_expression i e a difference in the population treatment mean expression levels meaningful biological results depend on reliable_detection of differentially_expressed de genes hence the power of detecting differential_expression for genes that are truly de should be as high as possible whereas genes that are equivalently expressed ee i e genes that have no difference in the population treatment mean expression levelsshould have a minimal chance of being declared de thus we must find an appropriate method for testing multiple_hypotheses that provides good power while controlling some multiple testing errors when considering a traditional multiple_testing family_wise fwer is often the preferred error_rate used to control multiple testing error the bonferroni method and holms method are commonly used for this purpose these methods however are not appropriate for highdimensional gene_expression data as controlling fwer results in extremely_low power for detection of differential_expression as a consequence an alternative error_rate known as false_discovery fdr is usually used fdr is simply the expected proportion of ee genes among all genes declared to be de where the proportion is defined to be zero if no genes are declared to be de although fdr allows for more type i errors than fwer when controlling these different error_rates at the same numeric level the power for detecting differential_expression is greatly_increased as discussed in storey and tibshirani a common method for identifying de genes while controlling fdr in a gene_expression experiment is the q value method first proposed by the q value for a given gene represents the estimated fdr if the given gene and all genes with smaller q values are declared to be de this method estimates fdr based on a set of p values corresponding to m hypothesis_tests as previously mentioned researchers are often interested in studying gene_expression differences between groups of subjects this is most often accomplished by performing a hypothesis_test for a difference in treatment expression means for each gene converting the p values from the resulting tests to q values and then declaring genes with a q value less than an fdr threshold to be de potentially relevant_information that this method does not take into account is the signs of the test_statistics shows a histogram of t test_statistics from a microarray experiment described in in this experiment gene_expressions from wild_type cells in thale cress seedlings were compared with those from mutant cells shows the distribution of observed test_statistics for gene although it is not visually obvious there is asymmetry in the distribution of test_statistics as more genes have negative test_statistics than positive test_statistics which indicates asymmetry to whom correspondence should be addressed in the distribution of effects sizes i e the true differences in gene_expression treatment means as well we propose a new method for fdr_estimation that alters the traditional q value method by separating the two sided p values from an experiment into two subsets of p values based on the sign of the test_statistics and then computing the q values separately for each subset to create a better ranking of the genes with respect to differential_expression through simulation_studies using both independent normally distributed data and real_gene we demonstrate how the proposed method can result in an improved ranking of genes with respect to differential_expression over the traditional q value method while still adequately controlling fdr the rest of the article is organized as follows section reviews storeys q value method and introduces the proposed method for fdr_estimation section_describes two simulation_studies and uses the results of these studies to compare the performances of the proposed method and traditional q value method by looking at the ranking of genes with respect to differential_expression the number of truly de genes declared to be de and also how well each method controls fdr section_presents analysis of two real microarray_datasets both from two sample studies section_presents an analysis of a threetreatment gene_expression experiment to illustrate how the proposed method can be generalized finally section concludes the article with some discussion tables and as well as supplementary tables s and s provided in the supplementary_materials present the results of the simulation_studies for each setting in each simulation_study the mean based on the simulated_datasets partial area_under roc_curve pauc is given with its corresponding standard_error in parentheses these are partial areas because we considered only the most relevant region of the roc_curve where the false_positive was the method that ranks the genes better with regard to differential_expression will have a higher pauc for each simulation setting a traditional paired_t was performed to test for a difference in the mean paucs of the proposed method and the traditional q value method if this test was significant at then the higher mean pauc is presented in bold font in tables and and the supplementary tables additionally if the higher mean pauc is at least greater than the lower mean pauc then the higher mean pauc is also underlined and this method was considered to outperform the other method the improvement criterion was used to avoid situations where the mean pauc was very similar between the proposed and traditional_methods in some cases equal when rounded to one decimal but the t test indicated a statistically_significant though not practically significant_difference the combination of the two criteria allowed for the identification of simulation_settings where both practical and statistical_significance were present in addition mean s the mean number of de genes that were declared to be de when fdr is nominally controlled at is also given for each setting to observe the number of correctly_identified de genes on average similar to the paucs t tests were used to determine_whether one method produced a larger mean s and whether the higher mean s was at least greater than the lower mean s also to verify that each method adequately controls fdr the empirical approximation of fdr was calculated for each method while nominally controlling fdr at we will call this quantity v r which is the average of the dataset specific fractions defined as the proportion of ee genes among all genes with q values or if no genes have q values regardless of data type both mean pauc and mean s increase as the sample_size increases as well as when the mean effect_size increases for both the proposed and traditional q value methods this is unsurprising as increasing the sample_size or the mean effect_size increases the power for detecting differential_expression for the simulations involving normally distributed data with see the proposed method performed better in of simulation_settings with regard to mean pauc includingsettings with n in regard to mean s the proposed method performed better in of simulation_settings including of settings with n the traditional method did not perform better than the proposed method in any simulation setting in terms of mean pauc or mean s when the mean effect_size is increased to see supplementaryin the supplementary_materials the proposed_method the traditional method with regard to pauc in of settings all of which are in simulation_settings with n for mean s the proposed_method the traditional method in of settings including of settings with n as with the traditional method did not outperform the proposed method in terms of mean pauc or mean s in any simulation setting for simulations involving microarray_data with the proposed method performed better than the traditional_methods in of of settings with n and of of settings with n simulation_settings in regard to mean pauc and mean s respectively the traditional method did not perform better than the proposed method in any simulation setting in terms of mean pauc or mean s when see supplementaryin the supplementary_materials the proposed_method the traditional method in mean pauc in only of simulation_settings all when n in terms of mean s the proposed_method the traditional method in of settings of which when n the traditional method did not outperform the proposed method in any simulation_settings in terms of mean pauc or mean s when taking_into all simulation_settings with normally distributed data all of the simulation_settings in which the proposed_method the traditional method in terms of mean pauc were with a for mean s of the simulation_settings in which the proposed method performed better had a among all simulation_settings involving microarray_data of the simulation_settings in which the proposed_method the tradition method in terms of pauc occurred when a for mean s this occurred in of settings additionally among the simulation_settings across all simulations in which the proposed_method the traditional method in terms of pauc occurred in simulation_settings with n among the simulation_settings where the proposed_method the traditional method in terms of mean s occurred in simulation_settings with n the proposed method never outperformed the traditional method in simulation_settings with n with regard to either mean pauc or mean s the traditional method did not outperform the proposed method in any simulation setting as shown in the last two columns of tables and and supplementary tables s and s both the proposed and traditional_methods adequately controlled fdr near the level across all simulation_settings and data types the proposed method for estimating fdr by first estimating using all p values and then analyzing two subsets of p values separately based on the sign of the test_statistics has advantages over the traditional q value method when effect_sizes are asymmetric the proposed method was never outperformed by the traditional method in terms of mean pauc or mean s in the two simulation_studies and ranked genes better with respect to differential_expression in of the simulation_settings while adequately controlling fdr the proposed method performed especially well for simulation_settings with the smallest sample_size n compared with the traditional method the proposed method also declared more truly de genes de on average in of simulation_settings and was never outperformed by the traditional method even in simulation_settings with symmetric effect_sizes similar to the results for pauc the proposed method performed exceptionally well in simulation_settings with n therefore we suggest that the proposed method be used to analyze datasets with small_sample n when the distribution of test_statistics is asymmetric another advantage to the proposed method is that it can be generalized to analyze many gene_expression experiments with more than two treatments especially if the treatments in the experiment can be ordered by factors such as time or dose although the criteria used to partition the p values differs depending to the treatment structure the analysis is very similar once the partitioning has been performed improved q values 
