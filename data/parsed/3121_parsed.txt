genetics_and msms a coalescent_simulation program including recombination demographic structure and selection at a single locus motivation we have implemented a coalescent_simulation program for a structured population with selection at a single diploid locus the program includes the functionality of the simulator ms to model population_structure and demography but adds a model for deme and time dependent selection using forward simulations the program can be used e g to study hard and soft selective_sweeps in structured populations or the genetic footprint of local adaptation the implementation is designed to be easily extendable and widely deployable the interface and output format are compatible with ms performance is comparable even with selection included coalescent simulations are a standard method to generate population samples under various models of evolution the widely used simulator ms is a powerful_tool for genealogies in general structured populations under neutrality with high performance and an easy to use interface however it does not allow for selection on the other hand several programs are available to simulate polymorphism data for a neutral locus linked to a selected site e g but they do not allow for population_structure only the specific scenario of selection in a colony population that has split from a large founder population without subsequent migration has been considered in msms we implement the functionality of hudsons ms in a simulator that allows for selection at a single diploid locus with two alleles for neutral genealogies the programs usage and assumptions are identical to ms in particular msms is compatible with ms in both output format and command_line options this permits the wide_range of tools that work with ms to also work with msms complicated models can now have selection added with only small adjustments and by swapping ms with to whom correspondence should be addressed b the genetic footprint of local adaptation and adaptive gene_flow after population splits extensions beyond previous programs also include the output of joint site frequency_spectra and the possibility of specifying multiple neutral loci the performance of msms is generally comparable to ms see the manual for a detailed runtime comparison complex population demographies can therefore be studied with selection added without imposing additional computation time limitations the name msms refers to the german mach stichprobe mit selektion i e make sample with selection 
