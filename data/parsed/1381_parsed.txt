differential_methylation analysis for bs_seq data under general experimental_design motivation dna_methylation is an epigenetic_modification with important roles in many biological_processes and diseases bisulfite_sequencing bs_seq has emerged recently as the technology of choice to profile dna_methylation because of its accuracy genome_coverage and higher_resolution current statistical_methods to identify differential_methylation mainly focus on comparing two treatment groups with an increasing number of experiments performed under a general and multiple factor design particularly in reduced_representation there is a need to develop more flexible powerful and computationally_efficient methods results we present a novel statistical_model to detect differentially_methylated from bs_seq data under general experimental_design based on a beta_binomial regression_model with arcsine link function parameter_estimation is based on transformed_data with generalized least square approach without relying on iterative algorithm simulation and real_data demonstrate that our method is accurate powerful robust and computationally_efficient dna_methylation is a covalent epigenetic_modification of cytosine that plays_a in gene regulatory_mechanism it has been well characterized to involve in many biological_processes such as cell_differentiation development and aging it often shows abnormality in many diseases such as cancer methylated_cytosines within promoter_regions have been shown to repress gene_expression by interfering with dna_binding that promote transcriptions subsequently leading to phenotypic changes studying the dynamics of dna_methylation and their influence has broadened and enhanced our knowledge on many biological_mechanisms and disease etiologies in additional to the genetic components discovered from studying dna_sequences alone technologies for quantifying dna_methylation have evolved rapidly in recent_years sodium bisulfite_treatment of dna following next_generation bs_seq is a new technology that measures the methylation_levels at single_nucleotide compared to earlier high_throughput such as methylation microarray or capture based sequencing like medip_seq bs_seq has improved accuracy reduced background bias and higher_spatial thus it has quickly become the technology of choice to study dna_methylation one of the most important questions in dna_methylation analysis is to identify genomic_loci or regions with different methylation_levels among distinct biological conditions differentially_methylated dml or regions dmrs can be functionally associated with biological_processes such as protein bindings and gene_expressions to contribute to phenotypic changes the dml dmrs could potentially be used as biomarkers for early_stage disease diagnosis v c the author published_by all_rights for permissions please_e journals permissions_oup com and identifying progression and subtypes of certain disease dml dmrs can also provide information for targeted_therapies in precision_medicine developing methods for dml dmr detection has been and still remains an active epigenomics research_topic over the last several years a number of statistical_methods and software_tools have been developed for identifying dml dmrs from bs_seq data a comprehensive_review of the existing_methods is provided by most of available methods are specifically_designed for comparing dna methylation_levels from two treatment groups partially because most of the existing bs_seq data are generated for two group comparison due to high_cost of the experiment with rapid advances of sequencing_technology and continuous reduction of sequencing cost an increasing number of experiments are now performed under general multi factor design especially from the reduced_representation rrbs technology and enhanced rrbs we expect this trend will continue and data with multiple factors groups and covariates will be common in foreseeable_future even from large_scale population level studies flexible and efficient methods are in great demand to comprehensively decipher biological_processes in current epigenomics research the data from bs_seq can be summarized as numbers of methylated and total reads at each cpg_site the methylated read_counts are often modeled by a beta binomial_distribution which accounts for both the biological and sampling variations a straightforward method to call dml under general design is using a beta_binomial generalized_linear glm at each cpg_site there are currently two methods available for bs_seq under general design radmeth and biseq radmeth directly applies beta_binomial glm with logit link function biseq first performs a local smoothing within each sample and then uses a beta regression with probit link on the smoothed methylation_levels the hierarchical testing procedure used in biseq primarily focuses on identifying dmrs another software methylkit does not explicitly provide any function for multi factor dml calling but it internally uses a binomial glm function for replicated data which can also be used for general experimental_design all these methods are based on glm with or without over dispersion adjustment some drawbacks exist using such approach first it is computationally_intensive because model_fitting is based on iterative procedure to maximize the likelihood given the size of a typical bs_seq dataset millions of cpg_sites such a procedure is very computationally_demanding this is evidenced by the poor computational performance from both radmeth and biseq second the glm procedure is numerically unstable when separation or quasi separation happens in one or more covariates which frequently occurs in many cpg_sites particularly when methylation_levels are close to the boundaries or such limitations sometimes lead to undesirable results from existing_methods in this paper we propose a novel statistical_method to detect dml for bs_seq data under general experimental_design at each cpg_site the count_data are modeled by a beta binomial_regression with arcsine link function model_fitting is based on the transformed methylation_levels by applying generalized least square gls procedure which provides estimates for regression_coefficients and their covariance hypothesis_testing is achieved using a wald_test at each cpg_site and the significance_levels can be used for dml calling we perform extensive_simulation and real_data to show the advantages of our proposed method over existing ones the method termed dss general is now implemented as a part of the bioconductor r package dss considering the large number of tests required developing statistical_method to analyze bs_seq data with multiple factors or covariates is challenging due to complicated model settings and computationally_demanding parameter_estimation procedure beta_binomial model is commonly used for count_data from bs_seq experiment due to the possibility of considering both biological and sampling variations even though beta_binomial glm is a straightforward solution computationally inefficient and numerically unstable estimation procedures are major_obstacles for bs_seq data analysis in practice we developed a novel statistical_method termed dss general to detect dml from bs_seq data under general experimental_design the method is based on transformation and approximation which significantly_improves computational_efficiency dss general characterizes the count_data using a beta binomial_regression with an arcsine link function the regression_coefficients are estimated from transformed methylation_levels using gls where the covariance_matrices are determined by sequencing_depth and biological variances the estimator of covariance_matrix for the parameter estimations is carefully derived a wald_test procedure is then applied for hypothesis_testing to identify dml similar approaches that operate on transformed_data have been developed for other sequencing_data such as rna_seq and chip_seq and provide good performances an important distinction of dss general is the use of arcsine link function instead of the more frequently used logit or probit this is mainly due to the statistical convenience because the stabilization of the variances after transformation makes the least square procedure possible as shown from comparisons of computational performance with existing_methods dss general is and times more efficient than radmeth and biseq respectively along with compatible or better accuracy and statistical property dssgeneral is a more desirable tool for the analyses of bs_seq data under general experimental_design although radmeth also provides similarly good results and computationally more efficient than biseq unlike dss general and biseq users cannot apply continuous covariates or factors with more than two values compared with logit link a disadvantage of the arcsine link is that the coefficient is more difficult_to however since the main goal of dml detection is to detect and rank cpg_sites and the detection rankings are often based on quantities such as test_statistics p values or fdr the magnitudes of the coefficients are often not of interest thus the interpretability of regression_coefficients will not be a major_limitation of the method the algorithm of dss general contains a step for dispersion estimation we evaluated the performance of dispersion estimation on dml detection_accuracy we compared the results from dssgeneral when using the estimated dispersions versus using the true dispersions supplementaryshows the tdr curves from the comparison as expected using true dispersions gives slightly better tdrs particularly when sample_sizes are small however the difference becomes very small when sample_sizes increase to replicates per group indicating good performance of the proposed dispersion estimation procedure it is also important to note that some dispersion estimation methods from other sequencing_data are based on empirical_bayes eb procedure which borrows information across all genes or cpg_sites and achieves a shrinkage effect under our setting the eb type of shrinkage method cannot be easily adopted because of the complicated relationship between the dispersion and data distribution i e it is difficult to express the data likelihood as a function of the dispersion furthermore the shrinkage is often based on maximizing an objective_function such as penalized likelihood the computational_efficiency becomes a major_issue without closed form of shrinkage estimator in dss general the bounded estimation of dispersions can be considered as a type of shrinkage that imposes some biological variance and stabilizes the results although the results shown in this paper are based on cpg_methylation our method can also be applied to cph methylation from whole_genome bs_seq in addition other types of base resolution methylation sequencing_data such as hydroxymethylcytosine hmc formylcytosine fc and carboxylcytosine cac can also be compared using dss general though there is no such dataset under general experimental_design so_far they could become popular with the continuous advances of technologies dss general is specifically developed to test differential_methylation at single cpg_site level it has been reported that the methylation_levels are spatially_correlated across the genome and smoothing based_methods were developed to account for the correlation although we considered spatial_correlation when generating data in simulation_study we did not develop method to take into account this information to improve dml calling this is partly because that all currently available data with general design are from rrbs where the cpg coverage is sparse and spatial_correlation is more difficult to be modeled nonetheless incorporating the spatial_information into our method will be a research_topic in the near future furthermore dss general is designed for data under linear_model with fixed_effects the method cannot be directly applied to analyzing data from more complexed designs such as paired or clustered which has to be modeled by a mixed_effects developing method for analyzing such data is also in our short_term plan 
