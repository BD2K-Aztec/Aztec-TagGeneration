roast rotation gene_set tests for complex microarray_experiments motivation a gene_set test is a differential_expression in which a p value is assigned to a set of genes as a unit gene_set tests are valuable for increasing statistical_power organizing and interpreting_results and for relating expression_patterns across different experiments existing_methods are based on permutation methods that rely on permutation of probes unrealistically assume independence of genes while those that rely on permutation of sample are suitable only for two group comparisons with a good number of replicates in each group results we present roast a statistically_rigorous gene_set test that allows for gene wise correlation while being applicable to almost any experimental_design instead of permutation roast uses rotation a monte_carlo technology for multivariate_regression since the number of rotations does not depend on sample_size roast gives useful results even for experiments with minimal replication roast allows for any experimental_design that can be expressed as a linear_model and can also incorporate array weights and correlated samples roast can be tuned for situations in which only a subset of the genes in the set are actively involved in the molecular_pathway roast can test for uni or bi direction regulation probes can also be weighted to allow for prior importance the power and size of the roast procedure is demonstrated in a simulation_study and compared to that of a representative permutation method finally roast is used to test the degree of transcriptional conservation between human and mouse mammary stems a gene_set test is a differential_expression in which a set of putatively co regulated_genes is treated as a unit a single p value is evaluated for the set rather than evaluating individual p values for individual genes typically the gene_set is chosen to represent to whom correspondence should be addressed a particular molecular_pathway in this way gene_set testing can simplify and organize differential_expression by focusing attention on larger and more biologically_meaningful processes than individual genes gene_set tests are valuable for relating expression_patterns across different studies even across different platforms or species gene_set tests can be statistically more powerful than genewise tests as evidence is accumulated from many genes there are a number of gene_set testing methodologies with different aims this article is concerned with what might be called focused gene_set testing in which interest focuses on one or more gene_sets of special relevant to the experiment at hand this approach contrasts with what might be called battery gene_set testing in which a large database of gene_sets is evaluated on a microarray_dataset to see whether any sets stand out from the others battery gene_set testing was made popular by the gene_set gsea method ofand in focused gene_set testing each set is evaluated on its own terms in battery gene_set testing sets are evaluated relative to the other sets in the database for this reason methods designed for battery testing cannot be applied to individual gene_sets focused gene_set tests can be classified into those which evaluate p values by permuting samples and those which permute genes methods that permute genes are limited by the fact that they treat genes as if statistically independent this assumption is usually suspect particularly when the set is specifically chosen to contain co regulated_genes moreover gene permutation p values are very sensitive to inter gene correlations potentially leading to dangerously over stated statistical_significance this has led some authors to conclude that statistically_rigorous testing is only possible by permuting samples the need to permute samples to obtain p values severely_limits the experimental_designs which can be analysed permutation is basically limited to two group comparisons with a moderate to large number of replicates in each group some authors have adapted permutation to the needs of one or two way anova designs suggested permuting sample labels while holding all covariates fixed except the covariate of interest permuted sample labels within each level of a blocking factor however these stratified permutationroast is the first focused gene_set test that correctly allows for inter gene correlation and gives statistically_rigorous p values for small or complex microarray experimental_designs like we use rotation to evaluate p values but our methodology is for self contained tests with specially targeted gene_sets whereas they considered competitive tests between a large database of gene_sets roast is the only existing software that could have been used for our mammary stem_cell data example the use of rotation offers many advantages over permutation it is computationally much faster it yields exact p values so that roast holds its nominal size correctly even for small samples the number of rotations can be chosen large enough to avoid any problem with granularity of p values considered one or two group t tests whereas we take full advantage of the possibilities of linear_models roast is applicable to any experiment that can be analysed using an linear_model i e to arbitrarily complex experiments the gene_set can be tested in any contrast between the coefficients not necessarily a simple comparison between two groups indeed our development could easily be extended to test gene_sets in two or more contrasts simultaneously in that case we would replace our moderated t statistics with f statistics our implementation allows for correlations between rna samples and for array quality weights assuming that the correlations or weights can be estimated from the entire ensemble of probes on the arrays in all cases the test takes_advantage of all available residual degrees_of our implementation uses empirical_bayes test_statistics which should add additional stability in small samples especially when the gene_set contains only a few genes rotation theoretically depends on multivariate normality but simulations with grossly non normal data shows that roast is page 
