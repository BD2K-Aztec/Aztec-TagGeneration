structurefold genome_wide rna_secondary mapping and reconstruction in vivo downloaded from motivation rnas fold into complex structures that are integral to the diverse mechanisms_underlying rna regulation of gene_expression recent development of transcriptome_wide rna_structure profiling through the application of structure probing enzymes or chemicals combined with high_throughput has opened a new field that greatly expands the amount of in vitro and in vivo rna structural_information available the resultant datasets provide the opportunity to investigate rna structural_information on a global scale however the analysis of high_throughput rna_structure profiling data requires considerable computational effort and expertise results we present a new platform structurefold that provides an integrated computational solution designed specifically for large_scale rna_structure mapping and reconstruction across any transcriptome structurefold automates the processing and analysis of raw high_throughput rna_structure profiling data allowing the seamless incorporation of wet bench structural_information from chemical probes and or ribonucleases to restrain rna_secondary via the rnastructure and viennarna package algorithms structurefold performs reads mapping and alignment normalization and reactivity derivation and rna_structure in a single user_friendly web_interface or via local installation the variation in transcript_abundance and length that prevails in living_cells and consequently causes variation in the counts of structure probing events between transcripts is accounted for accordingly structurefold is applicable to rna structural profiling data obtained in vivo as well as to in vitro or in silico datasets structurefold is deployed via the galaxy platform rna plays vital roles in myriad cellular_functions including regulation of transcription rna_processing and stability and translation the secondary_and of rnas are integral to their biological_functions e g as ligand_binding sensors riboswitches enzymes ribozymes or temperature sensors rna thermometers therefore knowledge of rna_structure especially in vivo is essential for a mechanistic_understanding of rna function understanding of rna_structure has been greatly advanced through the development of computational_approaches for rna secondary_and prediction resultant software_packages include rnastructure viennarna package mc fold mc sym and seqfold each method has its advantages cf including pseudoknot predictions local folding g_quadruplex folding and prediction of d structure nonetheless any purely computational rna_structure method has severe_limitations due to incomplete knowledge of free_energy parameters rna interaction with other molecules ranging from ligands to proteins and kinetically controlled rna_folding to overcome_these rna modifying agents can be used to provide experimental restraints regarding the single and double_stranded regions of the rna for example critical rna structural_information can be provided using nucleases such as rnase v which cleaves double_stranded sites and rnase s which cleaves single_stranded sites however a limitation of such nuclease based structure probing is that it can only be applied in vitro rna_structures in vivo can be very different due to protein binding rnarna_interactions ionic and ph conditions and other aspects of the cellular milieu such as molecular crowding and the influence of metabolites that are impossible to either completely model in silico or reconstitute in vitro as an alternative to nucleases several rna modifying chemicals including dimethyl sulfate dms and selective hydroxyl acylation analyzed by primer_extension shape reagents can be employed to report the presence of single_stranded nucleotides in rna and thus provide experimental information on rna_structure dms methylates the watsoncrick n position of adenine and n position of cytosine when these positions are not engaged in watsoncrick base_pairing or other interactions shape reagents acylate the hydroxyl_group on the sugar of flexible nucleotides of all four nucleotide types an advantage of chemical probing methods is that many can be applied in vivo as well as in vitro nuclease based cleavage truncates the rna template available for reverse_transcriptase rt while the above chemical_modifications of the rna halt the reverse_transcriptase one nucleotide before the modification both of these effects can be read out as stops in reverse transcription using conventional methods based on gel page or capillary_electrophoresis such electrophoresis based_methods however only read out this structural_information for relatively short segments of individual rnas and so are low_throughput and incapable of providing transcriptome_wide data recently genome_wide methods employing high_throughput sequencing_techniques to identify the rt stops resulting from cleavages or chemical_modifications have been developed e g these methods make it possible to obtain structural_information on thousands of rnas in a single experiment to date such studies have been conducted in vitro in yeast mouse drosophila c elegans arabidopsis and human and in vivo in arabidopsis yeast and human cells another method shape map that relies on mutagenesis rather than rt stops has been applied in vitro to the hiv rna_genome we recently reviewed many of these approaches while the combination of rna_structure probing with high_throughput is a major advance in the rna field it viennarna package mc fold mc sym seqfold electrophoresis based versus ngs based rna_structure probing the left side diagrams the standard electrophoresis based method while the right side diagrams the next_generation ngs based_approach as exemplified by structure seq chemical_probe treatment can be in vivo or in vitro nuclease treatment is in vitro chemical_probe treatments usually result in a covalent_modification of the rna that terminates reverse transcription rt nuclease treatment results in cleavage of the rna not explicitly illustrated green lines indicate several copies of a transcript gold indicates p radiolabel black red and purple lines indicate cdna red lines indicate rt products resulting from imperfect rt processivity such rt dropoff products will on average be accounted for by comparison to control data produced without nuclease or chemical_probe treatment in the ngs based readout purple lines indicate runoff rt products although they do not provide information on rt structure stops inclusion of these reads as well as red and black reads in the structure seq method is critical as it allows proper normalization for transcript_abundance requires intensive computational efforts to derive the explicit predicted reactivities and secondary_structures transcriptome_wide from high_throughput rna_structure profiling data some efforts have been made to develop algorithms and implement software_tools and webservers to facilitate the data analysis process for highthroughput rna_structure profiling which includes reads mapping normalization reactivity derivation and rna_structure here we provide a brief overview of these methods and then indicate the advances provided by structurefold spats is a method to derive reactivities from shape seq raw_data based on maximum_likelihood primarily to solve the problem arising from the signal decay that occurs at the end of each cdna read when using a single fixed primer that initiates reverse transcription at the end of the rna mod seeker is a method that identifies significantly enriched_sites of dms modification by cochranmantelhaenszel tests on each transcript and defines structural reactivity as the fold enrichment of rt stops on each nucleotide in the dms treated library relative to a control library with no dms treatment while spats and mod seeker provide methods to derive structural reactivities from high_throughput rna_structure profiling data spats focus on reactivity information for individual rnas while the structural reactivities provided by modseeker are not directly comparable between different rnas in a transcriptome in addition while these programs calculate reactivities they do not include the essential step of actual prediction of rna_structures savor takes rna_sequences and mapped high_throughput rna_structure profiling data as inputs and outputs individual rna_structures from the rnafold program in the viennarna package either including experimental restraints as derived from mapped high_throughput rna_structure profiling data or without any restraints the online savor platform is easy to use but it cannot be downloaded and installed locally and it does not provide an option to output transcriptome_wide rna structural reactivities or structures which is crucial for deriving global principles of rna_folding and function shapemapper and the sm folding pipeline software developed in the shape map approach rely on mutagenesis rather than stops during rt the programs output structural reactivities as well as predicted rna_structures here we describe our development of structurefold a series of software_packages that integrates reads mapping rt stop count calculation reactivity derivation and structure_prediction in a webbased interface the two inputs to structurefold are transcriptome sequence and optional high_throughput rna_structure profiling data the outputs are structural reactivities on each nucleotide transcriptome_wide and the corresponding rna_structures predicted with or without the experimental restraints by taking_into the differential abundances and lengths of rnas in a transcriptome structurefold provides values of in vivo structural reactivities of nucleotides on different rnas that are directly comparable structurefold is provided as a component of the galaxy platform http www galaxyproject org and takes_advantage of the computational_tools available in galaxy such as bowtie and samtools structurefold consists of a series of intuitive modules that are easy to use either online or after local installation spats mod seeker savor shapemapper sm folding pipeline structurefold this study processes and ovals represent outputs outputs of modules that are also inputs for the next module are left as ovals remove a user specified number of nucleotides at the and or end of each read this process is useful for removing adapter sequence from the read users can also use the v option to set the flag for the number of mismatches allowed while mapping if a read cannot be mapped it may be because of internal mismatches between the read and the reference library sequence or because adapter sequence is included in the read accordingly if a read cannot be mapped it is trimmed by a user specified number of nucleotides at the or end and mapping to the reference library is again attempted the process is iterated until the read either properly maps or is less than the minimum_length requirement specified by the user which typically corresponds to the minimum_length required for unique mapping of a read to the reference library each successfully mapped read with its mapping location is collected and the information is stored as a bam_file the second module in structurefold is the get rt stop counts module this module calculates the number of rt stops that map to each nucleotide of each transcript the inputs are a mapped dataset in bam format typically from the preceding iterative mapping module and the reference library that was used to map the reads and the output is an rt stop counts rtsc text_file which contains rt stop counts mapped to each of the four nucleotides a c g u in each transcript to obtain the number count of rt stops for each nucleotide the mapping location of each rt stop is first considered for chemical_modification mapping allows identification of the nucleotide immediately to the rt stop on the rna which is the nucleotide that was modified and so receives the stop count when nucleases are used for structure mapping the nucleotide that will receive the count according to this procedure is the nucleotide on the side of the cleavage_site on the rna the counts of the rt stops of all the nucleotides of each of the rnas in the experimentally queried transcriptome are combined into a rt termination stop count txt file for each type of library control and reagent treated the control library is used to account for background rt stops arising from reverse_transcriptase drop off at non exogenously modified or non nuclease cleaved sites which can result from a number of factors including imperfect processivity of the reverse_transcriptase the presence of endogenous rna modifications or degradation of the rna template the third module of structurefold is the reactivity calculation module this module calculates reactivity based on the rtsc file generated from the preceding get rt stop counts module the reactivity calculation module begins with a two step normalization of the rt stop counts step the rt stop counts on each nucleotide of each mapped transcript in the plus and minus reagent conditions are incremented by and the natural log ln is taken of the resultant value this provides the numerator in equations and these raw_data are typically skewed and taking the ln results in a distribution much closer to gaussian incrementing by avoids an undefined value of the natural_logarithm if there are zero rt stop counts step the ln of rt stop counts on each nucleotide of each mapped transcript in the plus and minus reagent conditions are normalized by the transcripts abundance and length for a transcript suppose p r i and m r i are the raw r numbers of rt stops mapped to nucleotide i all four nucleotides are included on the transcript in the plus p and minus m reagent libraries respectively and l is the length of the transcript p r and m r are the raw numbers of runoff rt reads purple coded reads inon the transcript in the plus and minus reagent libraries respectively the denominators in equations and thus represent the abundance normalized by transcript length equation provides the normalized rt stop count for nucleotide i in the plus reagent library equation provides the normalized rt stop count for nucleotide i in the minus reagent library final structural reactivities fsrs are then calculated from the normalized rt stop counts in equations and in three steps first values of a term denoted raw structural reactivity rsr are defined raw structural reactivities rsrs are calculated by subtracting the normalized rt stop count on each nucleotide in the minus reagent library from the normalized rt stop count on each corresponding nucleotide in the plus reagent library if the value is negative it is set to zero second normalization is applied to the rsrs in normalization the top of the data are initially removed and the average value of the remaining top of the data is then calculated then all the data here all the rsrs are divided by this average value to obtain the normalized structural reactivities nsrs the purpose of this normalization is to convert rsrs into a range that can be used as restraints for rna_structure in rnastructure and viennarna package as with shape data this normalization places most reactivities between and with the few reactivities larger than representing highly_reactive nucleotides third the nsrs are capped by a user specified threshold capping avoids extremely_high structural reactivities which could introduce bias when investigating meta properties of rna structural patterns the resultant values are the final structural reactivities fsrs for each nucleotide in the transcriptome the output from this module txt file which is indicative of the tendency of a nucleotide to be single_stranded can be used as input for the next module or can be used directly i e without the next module to carry out meta_analyses for instance we used fsrs to evaluate periodicity in mrna reactivity and relationships betweenstructurefold rna_structure mapping and reconstruction platformfsrs and alternative_polyadenylation or alternative_splicing quence data alone or with inclusion of restraints from structural reactivities as provided by the first three modules lastly the user has the option of creating bar plots to illustrate the distribution of the fsrs of the nucleotides in any transcript specified by the user the rna_structure module requires one or more transcript ids from the reference library as input these are provided as a txt file with each id on one line structurefold will find the rna_sequence in the reference library corresponding to the id provided if the fsr on each nucleotide of the rna is provided the module can output bar plots that illustrate the distribution of the fsrs generated from the third module of the nucleotides in any transcript specified by the user when the fsrs are provided the module outputs the predicted structures of the rna with these restraints otherwise the module outputs the predicted structures without restraints i e an in silico prediction that does not incorporate any experimental_data explicit inputs and outputs for all four modules in structurefold can be found in the supplementary note structurefold is the first computational platform designed specifically for transcriptome_wide rna_structure mapping and reconstruction in addition to enabling transcriptome_wide prediction of rna_secondary in silico unrestrained structurefold can output fsrs that can then be used for transcriptome_wide prediction of experimentally restrained rna_structures in the future we anticipate structurefold outputs being used to assess and compare the restrained predictions resulting from rna_structure profiling data generated by numerous experimental methods including nuclease shape dms and other chemical probing agents structurefold has several advantages over other software platforms for analysis of rna_structure compared to savor structurefold outputs transcriptome_wide structural reactivities on each nucleotide allowing investigation of global structural patterns compared to spats and mod seeker structurefold predicts rna_structures in addition to deriving structural reactivities in contrast to mod seeker structurefold takes the abundance of transcripts into consideration and thus can be used for comparative_analyses of in vivo as well as in vitro high_throughput rna_structure data within and between transcriptomes compared to shapemapper structurefold provides a user_friendly online platform where high_throughput data probing rna_structures can be analyzed directly structurefold is straightforward to use online or to install for local use on unix systems through incorporation into the galaxy platform structurefold takes_advantage of the computational infrastructure and tools as well as the ongoing curation provided by galaxy for example outputs from read_mapping algorithms in galaxy such as bowtie and bwa directly provide the input to the get rt stop counts module of structurefold in the future structurefold could be extended in several ways i methods for reads trimmingstructurefold employs iterative mapping to remove adapter sequences this method uses the exact biological sequence to identify the presence of adapter sequence but requires more computational time the cutadapt program is commonly used to remove adapter sequence but has difficulty to identify the adapter sequence if only a small portion of the adapter is present iterative mapping and cutadapt could possibly be integrated ii more options to derive reactivities from rt stop count files currently three experimental_approaches have been applied for in vivo transcriptome_wide profiling of rna_structure structure seq mod seq and dms seq each approach has its advantages and limitations for example structurefold takes the transcript_abundance into account and avoids skewness of the raw number of rt stops by ln transformation but it is still susceptible to experimental_noise to some extent especially on low_abundance rnas rnas with low_abundance have fewer rt stops mapped in total and so are proportionately more affected by stops resulting from drop off of the rt primer one way to compensate for this is simply to obtain more reads mod seeker is more resistant to experimental_noise than structurefold because it identifies significantly enriched_sites of dms modification before deriving the final dms reactivity mod seeker and structurefold have very similar performance on deriving structural reactivities of individual rrnas as shown in however dms reactivities derived by mod seeker on different transcripts are not directly comparable because each nucleotide in a library is normalized by the same value which does not take into account differences in transcript_abundance dms seq normalizes rt stops mapped to each position proportionally to the most highly_reactive base within a given structured window nucleotides in length the method avoids local bias of the rt stops on each rna but the length of the window is fairly arbitrary moreover local region normalization assumes independence of the different regions of the transcript which is not always a valid assumption in the future structurefold could be expanded to provide options for users to choose among methods of reactivity calculation 
