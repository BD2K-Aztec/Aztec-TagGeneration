hihmm bayesian non parametric joint inference of chromatin_state maps motivation genome_wide mapping of chromatin_states is essential for defining regulatory_elements and inferring their activities in eukaryotic_genomes a number of hidden_markov hmm based_methods have been developed to infer chromatin_state maps from genome_wide his tone modification data for an individual genome to perform a principled comparison of evolution arily distant epigenomes we must consider species specific_biases such as differences in genome_size strength of signal enrichment and co occurrence patterns of histone_modifications results here we present a new bayesian non parametric method called hierarchically linked infinite hmm hihmm to jointly infer chromatin_state maps in multiple_genomes different species cell_types and developmental_stages using genome_wide histone_modification data this flexible framework provides a new way to learn a consistent definition of chromatin_states across multiple_genomes thus facilitating a direct comparison among them we demonstrate the utility of this method using synthetic data as well as multiple modencode chip_seq conclusion the hierarchical and bayesian non parametric formulation in our approach is an important extension to the current set of methodologies for comparative chromatin landscape analysis availability_and source codes are available at https github com kasohn hihmm readout of genetic_information in eukaryotic_genomes is mediated by the dynamic chromatin environment which regulates dna accessibility for the gene_expression machinery through chromatin compaction associated histone_modifications and incorporation of histone variants chromatin_immunoprecipitation experiments followed by genome_wide microarray chip_chip or sequencing chip_seq have revealed that distinct genomic regulatory_regions are associated with different covalent_modifications of histone_proteins across various organisms for example h_k trimethylation of histone h at residue lysine marks active promoters h_k marks enhancers h_k marks transcribed gene_bodies h_k marks polycombrepressed regions and h_k marks heterochromatin although there are theoretically up to n possible combinations of n histone_modifications at any given locus in the genome in practice we only observe a small number of distinct dominant combinations thus giving rise to the concept of chromatin_states in which each state consists of a combination of histone_modifications a key idea underlying chromatin_state analysis is to computationally identify the number and composition of chromatin_states in the genome based on multiple genome_wide profiles of histone_modifications and to annotate the genome with these chromatin_states these states were found to be strongly correlated with various functional genomic_features such as promoters actively transcribing gene_bodies enhancers and heterochromatins although many chromatin_states are common across different cell_types or organisms there are indeed clear examples of cell_type chromatin_states consisting of unique co occurrence of histone_modifications the h_k h_k bivalent promoter state that is prevalent in embryonic_stem but mostly absent from terminally differentiated_cells is such an example investigating co occurrence of multiple histone_marks facilitates the differentiation of more subtle features in chromatin_state such as identifying tissue_specific strong and weak enhancer regions and changes in co occurrence patterns between evolutionarily distant_species therefore a chromatin_state map is a powerful means to infer potential genome function in a systematic and automated fashion in conjunction with transcriptomic dnase_i and transcription_factor binding data chromatin_state analysis was used to infer putative biochemical_functions to a large fraction of the non coding genomic_regions encode_project various machine_learning such as chromhmm segway treehmm and tiered hmm have been developed to generate such maps to facilitate cell_type genome_annotations in a systematic and automated fashion all of them are based on probabilistic_graphical such as the hidden_markov hmm and dynamic_bayesian one essential task for these algorithms is to learn the prominent combination of histone_modifications similar to any clustering problem it is often difficult to identify a reasonable number of combinations that can adequately capture the major variation in the data one possibility is to estimate the adequate number of states by performing exploratory_analysis such as the principal_component another common approach is to run the hmm learning multiple times with varying state numbers and identify the best fitting model using measures such as the bayesian_information the inferred states do not necessarily have a one to one correspondence with distinct functional_regions in the chromatin but they do give a very good data_driven description of the chromatin that can act as a starting_point for further bioinformatics and experimental analysis therefore it is still of great interest to develop principled methods for identifying chromatin_states within and across multiple_genomes the cross_species chromatin_state comparison problem was motivated by a recent model_organism encyclopedia of dna elements modendcode project that aims to systematically compare chromatin_organization in homo_sapiens human drosophila_melanogaster fly and caenorhabditis_elegans worm a navenave approach to this problem would be to compute the state map for each organism separately and then try to compare them afterward however this causes significant problems for interpretation because what was defined as an enhancer state in one organism is likely not identical with that from another organism in the other extreme we could simply concatenate the three genomes into one and infer states but then the inferred result would be highly biased by the species with the largest genome_size or by other species specific_biases in the chip_seq signals similar problems exist when comparing multiple developmental_stages or cell_types in the same organism in essence we require a method that allows the information of the state definition to be shared across multiple_genomes while retaining the ability for each genome to have its own chromatin_state definition in the context of that project we developed a novel bayesian non parametric method called hierarchically linked infinite hmm hihmm to infer chromatin_state maps across multiple_genomes simultaneously the application of hihmm in the human fly worm cross_species comparison setting indicates that the chromatin_state segmentations in individual_organisms generated by hihmm are highly comparable to the maps generated by chromhmm and segway two widely used chromatin_state segmentation_algorithms furthermore hihmm is designed to address species specific confounding_factors such as variations in chip signal_strength genome_size and co occurrence patterns in this article we will present the method in detail as well as demonstrating the utility of this method using a variety of simulated_and the main innovation of our approach is that it provides a flexible framework to enable information_sharing between multiple hmms the main difficulty of joint analysis of related datasets is how to obtain a consistent state definition or the mapping between a set of states defined in one species and the one in another species if one were to apply ihmm separately on each of the datasets we face the problem of mapping state definitions between species the proposed hihmm solves this problem by assuming a common state_space definition across all the datasets it is one of the main advantages of using the non parametric model based on the so_called hierarchical dp which is the core component of ihmm under a hierarchical dp prior for data from multiple groups each group is associated with a group specific dp and then those dps share a common base measure that is another dp this is the major mechanism how the atoms from each dp can be shared across groups model couples the state definition more loosely than model since in model information is shared via the prior only whereas model explicitly employs a shared emission matrix one distinguishing_feature of hihmm is that we can jointly infer emission values for genomes of differing lengths without the dominating influence of a longer genome on the result or the need to perform compensatory subsampling during training this is a major_limitation of existing_methods that concatenate multiple samples for joint learning that is overcome using hihmm similar to segway or the hmm approach of hihmm directly models continuous chip signal values and therefore alleviate the need of selecting a binary threshold cutoff we observe that this feature is potentially important forf fly w wormdifferentiating within a class of similar states highlighted by the interesting and diverse characteristics we observe in low signal states supplementary both our simulated_and analyses show that the advantages of model become more evident when the data discrepancy across different conditions is large for example in the case of multiple species data in terms of revealing interesting biology the ability to infer sample specific emission matrix parameters as in model allows for intuitive and detailed comparison of chromatin mark combinations between different species or cell_types this is evident from our state analyses in fly versus worm in case study in addition to the finding that fly and worm have different chromatin_modifications compositions in heterochromatin here we observed several previously_unreported differences between the two species as described above most notably the relative depletion of h k ac and enrichment of h_k in fly promoter states as well as multiple differences in the transcription states model was also useful in identifying the unexpected changes in the distribution of h_k during fly development many of these observations were not possible in previous_studies that did not include these marks in their comparison supplementary and they may suggest different mechanisms of genetic_regulation between the two species jointly learned and shared emission matrix parameters as generated by model provide an easily_interpretable platform on which to compare multiple samples from the same genome without the confounding_factor of different state definitions additionally model enjoys better statistical_properties such as faster convergence and shorter running time so model would be a better choice when the discrepancy between genomes is expected to be relatively small as in the case of different developmental_stages or environmental_conditions in a single species by applying hihmm to this newly compiled dataset we were able to identify two previously_uncharacterized chromatin_states that we have named repressed states in the fly development analysis states and in these two states combined constitute roughly of the fly genome and are almost exclusively characterized by marks that were not profiled in previous_studies and so these states were missed although hihmm allows learning the optimal number of states from the data in principle the likelihood surface of the model over chromatin_state characterization and analysis across developmental_stages in fly a chip signal matrix showing the average observed histone_modification profiles for each of states jointly inferred by the hihmm algorithm model for three stages of fly development late embryo el stage larvae l and adult head ah b percentage of genome covered by the state coverage relative enrichment of expressed genes per state expression odds_ratio and the percentage of state annotations that occur between the tss and tes of annotated_genes gene body overlap c chromatin_state co occurrence between two developmental_stages in fly el and ah the observed versus expected fold_change of the co occurrence of each state in el and each state in ah is shown on the basis of this analysis we selected significantly over represented co occurrence regions to investigate and characterize the genes involved through gene_set enrichment_analyses d genome_browser views of representative genes ubx and oamb with three stage chromatin_states these genes were identified through chromatin_state co occurrence analysis as having different chromatin_states in el and ah e the top go biological_processes enriched in the genes that are within regions of the genome that changed from an active_state in el to a repressive state it ah top panel or vice_versa bottom panel hihmm for joint chromatin_state inferencethe used parameter_space is quite flat therefore similar posterior_probability value can be obtained through different parameter value combinations and this makes the recovery of the correct number of states still challenging for systematic analysis of this issue we examined the effect on the accuracy and the number of inferred states of three hyper parameters the initial number of states k and the two variance parameters r in the prior_distribution for the emission matrix and r for generating the observation signal given the hidden state and the emission matrix supplementary figs s and s for model and model respectively the smaller r produced better segmentation accuracy which is expected as the variance in the emission model should be small enough to assign the observation signal to the correct state assuming proper normalization by variance r seems to produce the best result the number of inferred states depended on all the three parameters but most significantly by r we see that r should be large enough to compactly capture the varying signals from enriched marks as the prior mean for the emission matrix is zero for large r the number of inferred states becomes less affected by other parameters the deviation from the initial number of states to the inferred number is also mostly determined by r but not significantly by others it appears to be a good practice to set r to be around the mean signal_strength of the enriched marks the initial number of states should be selected close to the true number of states automatic estimation of these hyper parameters would need further investigation in our future work another important issue is to get a reasonably good initial_state assignment which encourages consistent state definition across species this issue is especially critical with hihmm in which the species specific models are loosely connected our current joint initialization scheme of concatenating different genomes as one and applying k_means works reasonably well but this would be investigated further in our future study in this article we demonstrated a variety of features of hihmm that makes it useful for cross sample joint chromatin_state inference we have devised two models of hihmm each having advantages and limitations of interpretation and inference the flexibility of using both learning models allows for a more comprehensive analysis during different applications and experimental_designs 
