identification and quantification of metabolites in h nmr_spectra by bayesian model_selection motivation nuclear_magnetic nmr_spectroscopy is widely used for high_throughput characterization of metabolites in complex biological mixtures however accurate interpretation of the spectra in terms of identities and abundances of metabolites can be challenging in particular in crowded regions with heavy peak overlap although a number of computational_approaches for this task have recently been proposed they are not entirely satisfactory in either accuracy or extent of automation results we introduce a probabilistic_approach bayesian quantification bquant for fully_automated database based identification and quantification of metabolites in local_regions of h nmr_spectra the approach represents the spectra as mixtures of reference profiles from a database and infers the identities and the abundances of metabolites by bayesian model_selection we show using a simulated dataset a spike in experiment and a metabolomic investigation of plasma_samples that bquant outperforms the available automated alternatives in accuracy for both identification and quantification the field of metabolomics_studies small_molecules such as amino_acids nucleic_acids lipids and carbohydrates called metabolites which are present in cells and extracellular fluids of biological organisms metabolites are the end_products of a variety of cellular_processes and their high_throughput characterization and quantification can provide_important the functioning of living_organisms as a result metabolomics is increasingly_applied to the areas of system biology drug_discovery pharmaceutical_research early disease detection toxicology and food science to whom correspondence should be addressed developments in high_throughput metabolomics are driven by advances in analytical_methods such as nuclear_magnetic nmr_spectroscopy and in mass_spectrometry in particular h nmr_spectroscopy is non destructive and highly_reproducible and is widely used for the identification and quantification of metabolites in biofluids such as plasma and urine the h nmr signal is generated by the motion of magnetic_moments of protons or other nuclei in a magnetic_field after their excitement with a high_frequency pulse fourier_transformation of this time dependent signal yields a chemical_shift a measure that expresses the dependence of nuclear magnetic energy on the electronic and chemical_environment in the molecule an h nmr spectrum displays chemical_shifts in parts_per p p m i e the difference in hertz between a resonance_frequency and that of a reference substance over frequency of magnet field in megahertz versus intensities of the signals typically a metabolite detectable by h nmr contains one or more protons and each of the protons produces one or more peaks the number of peaks generated by a metabolite as well as their location and ratio of heights are reproducible and uniquely determined by the chemical_structure of the molecule illustrates two h nmr_spectra with a dominant signal from metabolite taurine from the spike in experiment in section all three predominant peaks in the spectra correspond to one proton in the taurine chemical_structure the expected ratio of heights of the three peaks is known and fixed to extensive information regarding nmr specific characteristics of a variety of metabolites is currently available several public_databases such as human metabolome database hmdb and biomagresbank bmrb as well as commercial databases such as the one in the chenomx nmr suite store reference nmr_spectra of metabolites the reference spectra can contain observed peak locations and ratios of heights of spectra from pure chemical_compounds or their simulated counterparts therefore in principle researchers can identify metabolites by matching the observed spectra to the reference spectra in the database the area of the peaks from a metabolite is directly related to its abundance as the abundance changes the heights of peaks belonging to the same metabolite vary as shown in the case of taurine in this enables relative quantification of metabolites across samples ofregion from two h nmr_spectra from the spike in experiment in section solid line spectral_region from a sample containing the spiked metabolite taurine in the concentration of mols l dashed_line spectral_region from a sample containing taurine in the concentration of mols l the decrease in metabolite abundance results in a proportional decrease of all three peaks various types e g across samples from patients with various status of a disease in biomarker_discovery investigations however inference of identity and abundance of metabolites from h nmr_spectra is fraught with difficulties first complex biological mixtures contain hundreds of metabolites which vary in abundance substantially and can produce_highly overlapped peaks second the number of candidate metabolites in a database typically exceeds the number of major sources of signals in the spectra and one has to explore a combinatorially large space of candidate metabolites finally due to numerous factors such as potential of ph and ionic_interactions peaks generated by a metabolite can deviate from their expected p p m introducing positional uncertainty the combination of these factors makes the deconvolution and the interpretation of individual metabolite specific signals very challenging in practice automated inferential approaches are needed in order to account for the noise and ambiguity of spectral interpretations and to derive objective accurate and reproducible identifications and quantifications of metabolites this article develops a fully_automated inferential approach that we call bquant for identification and quantification of metabolites in regions of complex h nmr_spectra it takes as input a set of nmr_spectra a range of p p m of interest and a database of reference spectra for candidate compounds it is based on a family of bayesian hierarchical_models for the spectra where the models with the highest posterior_probabilities are selected using a stochastic sampling technique bquant outputs a list of identified metabolites associated with their inclusion probability and their measures of abundances in each spectrum on a continuous scale we compared the performance of bquant to representative instances of three classes of fully_automated methods in section binning is represented by the adaptive intelligent binning ai binning an instance of curve_fitting without a database is the multiplicative update algorithm implemented in the r package non_negative nmf which we abbreviate as mu nmf both ai binning and mu nmf cannot automatically identify the metabolites and cannot be compared to bquant in terms of identification therefore we attempted to identify the bins or the components of the deconvoluted mixtures manually whenever possible to compare the performance of these methods in terms of quantification curve_fitting with a database is represented by least_squares deconvolution ld and enables a simultaneous identification and quantification of metabolites since the original implementation of ld does not account for a baseline this can negatively_affect the performance of the method hence page we also implemented a modified_version of ld which similarly to bquant incorporates a sample specific baseline using penalized b spline this is accomplished by adding a term including the same design matrix s as specified in model and a sample specific coefficient i to the original formulation of ld we refer to this modified_version as ld with baseline ldbl we applied both ld and ldbl to the individual spectra in full resolution since the methods are only applicable to the individual spectra we compared them to bquant according to the list of most frequently identified metabolites to reduce the computational_complexity of bquant we used ldbl for reduction of the size of the database we chose l max since local_regions typically do not contain more than significantly abundant metabolites 
