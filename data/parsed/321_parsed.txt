an empirical_bayes method for genotyping and snp_detection using multi sample next_generation the development of next_generation provides an efficient and powerful approach to rare_variant detection to identify genetic_variations the essential question is how to quantity the sequencing_error in the data because of the advantage of easy implementation and the ability to integrate data from different sources the empirical_bayes method is popularly employed to estimate the sequencing_error for snp_detection results we propose a novel statistical_model to fit the observed non reference allele_frequency data and utilize the empirical_bayes method for both genotyping and snp_detection where an ecm algorithm is implemented to estimate the model_parameters the performance of our proposed method is investigated via simulations and real_data analysis it is shown that our method makes less genotype call errors and with the parameter_estimates from the ecm algorithm it attains high detection_power with fdr being well controlled availability_and the proposed algorithm is wrapped in the r package ebgenotyping which can be downloaded from http cran r project org_web ebgenotyping next_generation ngs_technology produces vast amount of sequencing_data at an unprecedented low_cost which totally changes the landscape of identification of genetic_variations thanks to its high_throughput capability ngs provides a direct and powerful approach to the detection of rare_variants it makes it possible to explore the dna_sequence at nucleotide level and identify mutations through single sample analysis however it is demonstrated that multi sample sequencing can increase the detection_power and has better false_positive control than single sample sequencing therefore multi sample sequencing is more widely used in the genomic_research and the analysis tools for multi sample sequencing_data are always in high_demand as the most common type of sequence_variations the single_nucleotide snp plays an important role in genetic evolution the existence of snps changes the genotypes of sequenced sample different from the reference_genome resulting in the nonreference alleles being observed in the alignment data on the contrary the genomic positions with frequent non reference alleles indicate potential snps nevertheless the ngs_data analysis_pipeline is a complex process many factors during this process may contribute to the non reference alleles including not only the sample_preparation and pcr_amplification during the sequencing_experiment but also the algorithms used for base_calling and alignment all the alleles different from the genotype allele due to these factors are called as sequencing_errors the existence of sequencing_errors makes snp_detection much more challenging than expected the main task of snp_detection is to evaluate the sequencing_error in the data in order to distinguish snps from the sequencing_errors the base_calling quality and mapping quality_scores are widely used to quantity the sequencing_error in the ngs_data for snp_detection such as gatk samtools soapsnp freebayes https github com ekg freebayes atlas snp etc with an arbitrary prior they employ the classical bayes model to call the genotypes according to their posterior_probabilities and then call snps by comparing to the reference_genome although the quality_scores reflect the magnitude of the sequencing_error to a great extent they still have some limitations first the quality_scores may not be able to fully account for the sequencing_error due to the complexity of ngs_data analysis_pipeline propose to incorporate the sample_preparation error in single sample analysis to evaluate the sequencing_error their method as well as the corresponding multi sample method multigems outperforms other snp callers second processing the quality_metrics is computationally_intensive and those algorithms are usually not applicable across different experimental platforms third using the quality_scores to determine the sequencing_error ignores the common information from repeated alleles such as the sequencing_error related to the local dna_content which is shared by the alleles aligned to that dna region from different samples recently more and more snp callers based on the empirical_bayes method were proposed where the sequencing_error is set to be an unknown parameter and empirically estimated from the data assume that different samples have the same sequencing_error at each genomic locus and use the allele_frequency data from all of the samples to estimate it employ a dirichlet mixture_model to fit the frequency vectors of four nucleotides at all the genomic_loci of different samples and combine all the data to estimate the model_parameters decompose the sequencing_error into three types of variations i e sample effect positional effect and finite depth and integrate the data across samples and genomic_locations to estimate them besides zhou andutilize the empirical_bayes method for pooled_sequencing analysis comparing to the classical bayes models the empirical_bayes method can combine the information from different samples at different genomic_sites to improve the estimation for model_parameters in this paper we focus on the multi sample sequencing_data from the diploid organism at each genomic locus only three possible genotypes are considered i e homozygous reference rr which is non snp heterozygous snp rv and homozygous snp vv although this may cause the incorrect genotype_calls at triallelic sites it need not significantly affect the results but highly reduces the computational_burden supplementary_material with this assumption the binomial model is a natural choice to fit the allele_frequency as didassume the independence between different genomic_sites and estimate the sequencing_error site by site whileintroduce the sample effect and integrate the data not only across samples but also genomic_sites to estimate the sequencing_error comparing toimprove the statistical_model to admit heterogeneity among samples however since their model is built to fit the sequencing_error frequency which is not observable they have to incorporate a pregenotyping step besides due to the complexity of the model they estimate the parameter using the median method and approximate the logit normal by beta_distribution to calculate the posterior_distribution we modify the decomposition in muralidharan et_al a and propose a novel statistical_model for both of genotyping and snp_detection the model is established to fit the observed allele_frequency data so we do not need any pre_processing analysis moreover benefitting from the modification instead of the approximation methods we implement an ecm algorithm to estimate the model_parameters and utilize the empirical_bayes method to genotype samples and call snps with false_discovery fdr control the rest of the paper is structured as follows in section the statistical_model and ecm algorithm are introduced their performance is illustrated via simulations in section and two real_datasets in section finally we give a short discussion in section in this paper we propose a novel statistical_method for both of genotyping and snp_detection using multi sample ngs_data instead of pooling the multi sample data as single sample or pooled_sequencing we build the statistical_model to integrate_information across different samples and genomic_sites to make the genotype call and identify snp at each locus for each sample this offers our method high detection_power for both common and rare snps as illustrated in the simulations and real_data analysis in the proposed model the sample effect is a constant across all of the genomic_sites sometimes it may be not feasible since as mentioned previously the sequencing_error may be affected by the local dna_contents repetitive_regions etc we suggest to cut the whole_genome into small pieced regions and analyze them in the piece wise manner this not only can solve the heterogeneity issue in the sample effect but also helps to implement the computation in a parallel way which will greatly reduce the computation duration for huge data analysis 
