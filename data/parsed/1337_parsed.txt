gene_expression destiny diffusion maps for large_scale single_cell data in r diffusion maps are a spectral method for non linear dimension_reduction and have recently been adapted for the visualization of single_cell expression data here we present destiny an efficient r implementation of the diffusion map algorithm our package includes a single_cell specific noise model allowing for missing and censored values in contrast to previous implementations we further present an efficient nearest_neighbour approximation that allows for the processing of hundreds of thousands of cells and a functionality for projecting new data on existing diffusion maps we exemplarily apply destiny to a recent time resolved mass_cytometry dataset of cellular_reprogramming availability_and destiny is an open_source r bioconductor_package bioconductor org_packages destiny also available at www helmholtz muenchen de icb destiny a detailed vignette describing functions and workflows is provided with the package recent_technological allow for the profiling of individual cells using methods such as single_cell single_cell rt_qpcr or cytof these techniques have been used successfully to study stem_cell with timeresolved single_cell experiments where individual cells are collected at different absolute times within the differentiation process and profiled while differentiation is a smooth but nonlinear process involving continuous changes of the overall transcriptional state standard methods for visualizing such data are either based on linear methods such as principal_component see supplementary and independent components analysis or they use clustering techniques not accounting for the smooth nature of the data in contrast diffusion mapsinitially designed byfor dimensionality_reduction in image processingrecover a distance measure between each pair of data_points cells in a low dimensional_space that is based on the transition probability from one cell to the other through several paths of a random_walk diffusion maps are especially suited for analysing single_cell from differentiation experiments such as time course experiments for three reasons first they preserve the global relations between data_points this feature makes it possible to reconstruct developmental traces by re ordering the asynchronously differentiating cells according to their internal differentiation state second the notion of diffusion distance is robust to noise which is ubiquitous in single_cell data third by normalizing for sampling density diffusion maps become insensitive to the distribution of the data_points i e sampling density which aids the detection of rare cell_populations here we present a user_friendly r implementation of diffusion maps including previously_proposed adaptations to single_cell data as well as novel functionality the latter includes approximations allowing for the visualization of large_data and the projection of new data on existing maps we applied destiny to four single_cell datasets of different size hundreds to hundreds of thousands of cells and characteristics qrtpcr rna_seq and mass_cytometry see supplementary we first estimate the optimal r that matches the intrinsic dimensionality of the data and supplementary figs s a and s a using a scree plot and supplementary figs s b s b and s a the relevant diffusion components can be identified however for big datasets as the mass_cytometry data fromwith cells and markers corresponding eigenvalues decrease smoothly although only a part of the intrinsic dimensionality can be represented in a d plot the diffusion map reveals interesting_properties of the reprogramming dynamics and supplementary we compared destinys performance to other implementations including our own in matlab based on maggioni code http www math duke edu mauro code html published with and the diffusionmap r package destiny performs similarly well for small_datasets while outperforming other implementations for large_datasets supplementary 
