genome_analysis efficient clustering of identity by descent between multiple_individuals motivation most existing identity by descent ibd detection methods only consider haplotype pairs less attention has been paid to considering multiple haplotypes simultaneously even though ibd is an equivalence relation on haplotypes that partitions a set of haplo types into ibd clusters multiple haplotype ibd clusters may have advantages over pairwise_ibd in some applications such as ibd mapping existing_methods for detecting multiple haplotype ibd clusters are often computationally_expensive and unable to handle large samples with thousands of haplotypes results we present a clustering method efficient multiple ibd which uses pairwise_ibd segments to infer multiple haplotype ibd clusters it expands clusters from seed haplotypes by adding qualified neighbors and extends clusters across sliding_windows in the genome our method is an order of magnitude faster than existing_methods and has comparable_performance with respect to the quality of clusters it uncovers we further investigate the potential application of multiple haplotype ibd clusters in association studies by testing for association between multiple haplotype ibd clusters and low_density in the northern_finland using our multiple haplotype ibd cluster approach we found an association with a gen_omic interval covering the pcsk gene in these data that is missed by standard single marker association tests previously published_studies confirm association of pcsk with low_density availability_and source_code is available under the gnu public licensein a finite population haplotypes are identity by descent ibd if they are identical and inherited from a common_ancestor tracts of ibd are broken up by recombination during meiosis to be detectable a pairwise_ibd segment must be sufficiently_long and contain a sufficient number of genotyped markers detected ibd segments have several important_applications for example detecting signals of natural_selection inference of population_structure and ibd mapping in association studies the current resolution of ibd detection in single_nucleotide snp_array is cm corresponding to a common_ancestor within the past generations therefore many short segments will be missed in pairwise_ibd detection the missing_information can be partly retrieved by multiple haplotype analysis that identifies clusters of haplotypes that are all identical by descent which we refer to as multiple ibd clusters later in the text because ibd is an equivalence relation on haplotypes if haplotypes a and b are ibd and haplotypes a and c are ibd then haplotypes b and c are also ibd by definition even though their shared segment may be too short to be detected in pairwise_ibd detection within a certain region if we only observe pairwise_ibd segments of a b and a c but not b c we say that there is inconsistency in the pairwise_ibd segments such inconsistency can be resolved by grouping a b and c into a multiple ibd cluster where each member in the cluster is ibd to all the other members there have been several previous attempts to detect multipleibd mcmc ibd finder is a markov_chain approach that considers multiple_individuals simultaneously however it is not computationally_tractable for genome_wide analysis with large_sample the dash method builds on pairwise_ibd segments and applies an iterative minimum cut algorithm to identify densely_connected haplotypes as ibd clusters the method scans the genome through sliding_windows and output subgraphs of desired density the performance of the dash method in terms of speed and accuracy has not been investigated previously ibd groupon is a recently_developed method that also detects group_wise based on pairwise_ibd segments unlike dash which takes the length of windows and density threshold of subgraphs as input_parameters ibd groupon is almost parameter free and it uses a hidden_markov hmm to determine the cliques and the length of group_wise automatically the performance of ibd groupon was evaluated on simulation_data of chromosome with snps based on a real pedigree in hapmap and it shows high power in detecting short ibd_tracts in comparison with dash ibd groupon has a similar execution time with higher accuracy for a sample_size of related individuals however the relative performance of dash and ibd groupon was not evaluated using population data larger samples sizes or multiple parameter_settings to whom correspondence should be addressed in this study we evaluate dash using population samples with thousands of individuals in a range of different parameters settings we do not evaluate ibd groupon v because it required too much memory gb when analyzing the simulated_datasets in this study in this work we present the efficient multiple ibd emi algorithm to search for multiple ibd clusters along sliding_windows in the genome in contrast to dash which builds clusters from a largest connected component and iteratively divides it into smaller clusters by a minimum cut algorithm emi takes an agglomerative approach it builds each cluster from initial seed haplotypes and recursively adds qualifying haplotypes to expand the cluster high computational_efficiency is ensured by the use of priority queues we evaluate our results based on coalescence simulations coalescence simulations allow the investigation of realistic scenarios while enabling determination of the true multiple ibd status we compare the performance of emi and dash with thousands of samples although dash ibd groupon and emi all use graph_based clustering_methods there is an important difference in how clusters are identified ibd groupon uses an hmm to find the most likely maximal cliques within each chunk of genome so as to resolve inconsistencies such a procedure only involves pruning edges an edge is a pairwise_ibd segment even though sometimes adding a few edges can not only resolve inconsistencies but also recover missing pairwise_ibd segments in the input both emi and dash build clusters that are highly_connected and therefore can prune incorrect edges as well as add missing edges missing edges should not be ignored especially for short segments as the state of the art pairwise_ibd detection methods only achieve high power e g for ibd_tracts longer than cm in snp data detected ibd segments have many applications one of which is ibd mapping in association studies one can code the multiple ibd clusters as genetic_markers and use them for association testing in genome_wide gwas gwas have identified many common_variants associated with diseases yet they have explained relatively little of the heritability of complex_diseases rare genetic_variants often defined as variants with minor_allele maf can play_important in complex_diseases it has been suggested that rare_variants may contribute to disease and thus partly explain the missing_heritability ibd mapping falls into the category of focusing mainly on signals from rare_variants because ibd detection methods detect long shared segments that correspond to a relatively short time to the common_ancestor variants arising shortly before the most_recent of a group of ibd haplotypes will be correlated with the ibd group_membership these variants being recent are rare studies have shown that ibd mapping may have higher power than association analysis of snp data when multiple rare causal_variants are clustered within a gene a multiple ibd cluster based association test is essentially a rare_variant test the frequency of each cluster is determined by the number of haplotypes in that cluster which is often small because large ibd groups are rare especially for outbred populations standard methods used in gwas evaluate each variant individually with univariate statistics such as the cochranarmitage test for trend and are underpowered for rare_variants unless sample_sizes or effect_sizes are large over the past_few many group wise association tests have emerged as to overcome_this including burden tests and variance_component tests burden tests are typically based on collapsing or summarizing the rare_variants within a region by a single value which is then tested for association with the trait however a limitation for such methods is that they implicitly assume that all rare_variants influence the phenotype in the same direction which might not be true in real applications alternatively we can cast the problem in the framework of linear_mixed with random_effects and apply a global_score test for the null_hypothesis that all the variance components are this can be conveniently tested with a variance_component score test in the corresponding mixed model which is known to be a locally powerful test because most of our ibd clusters to be tested are rare we chose to use mixed models and test for random_effects of all the variants in a region we chose to use the sequence_kernel skat for our analysis as it provides a supervised flexible regression_model to test for association between genetic_variants common and rare in a region skat allows for adjustment for covariates and has been shown to be powerful for most underlying hypotheses concerning the relationship of variants and complex_traits ibd haplotype_sharing is useful for many applications such as imputation improved accuracy in haplotype_phasing ibd mapping and population_genetic inference most existing_methods for ibd detection only consider pairwise_ibd yet the implementation and applications of multiple ibd have not been fully explored in this study we developed emi to detect ibd segments that are shared by multiple_individuals unlike the existing method dash which searches for a highly_connected graph by dividing the big graph iteratively with a minimum cut algorithm emi is implemented in an agglomerative manner and uses a heuristic approach to greedily build clusters using efficient data_structures emi runs faster than dash in application to genomewide data with comparable_performance the theoretical time complexity is hard to obtain because both dash and emi use methods to reduce computational effort when moving across sliding_windows along the genome however our simulations show that the difference in running time between emi and dash becomes larger in a region with increased pairwise ibd_sharing such as data from isolated populations the accuracy of inferred multiple ibd clusters has not previously been evaluated we used coalescent simulations to evaluate the accuracy of resulting multiple ibd clusters and found the optimal parameters for subsequent analysis although multiple ibd clusters are supposed to be highly_connected a density cutoff as low as has a fairly good performance the best density cutoff may depend on the pairwise_ibd detection program which has to make a trade_off between power and type error for example we used beagle refined ibd for pairwise_ibd detection which has a low type_error but also low power for short ibd segments therefore with beagle refined ibd we use a low_density cutoff so that we favor adding missing edges over cutting existing edges from the pairwise_ibd input if we use germline which has weaker control of type error to detect pairwise_ibd segments a higher_density cutoff may work better the speedup emi achieves might seem to be insignificant in the context of gwas where a lot more time is spent on the upstream analysis we have shown in our study that the simple heuristic performs fairly well but the results are not optimal and can be further improved for example one can combine the information of clusters of all windows into a global probabilistic_framework similar to the idea behind ibd groupon when it requires many iterations to train an hmm computational speed matters therefore our method is suitable for use in more complicated models the concept of ibd mapping is not new yet the approach used here is different from the approaches used previously previousnote window start and window end are the boundaries of sliding_windows skat p is the p value reported by skat showing the significance of random_effects in the mixed model empirical p is obtained based on minimal p values from permutations as detailed in the text to adjust for multiple testing across the autosomes ibd analyses have either used pairwise_ibd and looked for differences in ibd frequency between pairs of cases and pairs of controls or have tested each multiple ibd cluster individually here we use a variance components approach to jointly test the multiple ibd clusters in a region the multipleibd cluster approach is expected to be more powerful when multiple low_frequency causal_variants contribute to a trait 
