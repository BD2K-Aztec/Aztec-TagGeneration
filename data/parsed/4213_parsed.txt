sfa spa a suffix_array based short_peptide assembler for metagenomic_data the determination of protein_sequences from a metagenomic_dataset enables the study of metabolism and functional_roles of the organisms that are present in the sampled microbial_community we had previously_introduced algorithm and software for the accurate reconstruction of protein_sequences from short_peptides identified on nucleotide reads in a metagenomic_dataset here we present significant computational improvements to the short_peptide assembly algorithm that make it practical to reconstruct proteins from large metagenomic_datasets containing several hundred million_reads while maintaining accuracy the improved computational_efficiency is achieved using a suffix_array data_structure that allows for fast querying during the assembly process and a significant redesign of assembly steps that enables multi_threaded execution availability_and the program is available under the gplv_license from source forge net_projects spa assembler next_generation ngs_technologies are used routinely in metagenomics and provide a cost_effective approach to assay microbial_communities at a high sequencing_depth however the computational_analysis of these large_datasets is a challenge and is influenced by the genomic composition and taxonomic divergence of the constituent microbes in the sampled community in particular effective identification of sequence and function of proteins from metagenomic_datasets is hampered by the short_read generated by ngs_technologies and also by the fragmented nature of metagenomic assemblies of nucleotide reads that are attempted to reconstruct genome_sequences to address this problem we had previously_introduced a framework that reconstructs proteins from metagenomic_data by first identifying partial protein_sequences or short_peptides from the nucleotide reads using a gene finder and subsequently assembling these short_peptides into long protein_sequences using a novel algorithm our short_peptide assembler spa algorithm and framework was compared to the alternate strategy of first assembling the nucleotide reads and then identifying proteins on the assembled_contigs several different nucleotide assemblers were evaluated we showed that spa outperforms the alternate strategy under multiple evaluation criteria including specificity sensitivity read assembly rate and chimera rate however while our evaluations_included datasets containing more than million_reads we noted that the computational_efficiency of spa could be improved here we present computational improvements to spa that result in a substantial speedup of the assembly process while maintaining assembly output quality our new assembly algorithm and implementation denoted as sfaspa uses the suffix_array a space efficient data_structure that also allows for the computationally_efficient querying of patterns in a given text the suffix_array is used to speed up the initial path finding step of spa which is a major run time bottleneck in addition several assembly steps were significantly redesigned and re implemented and these improvements now allow due to additional lookups needed to calculate the size of the read support set it is still nearly six fold faster than spa m on these data chimera rates are very low in both implementations and sfa spa achieves similar read assembly rates as spa supplementary s in addition to the effect of the minimum overlap length m the effects of other parameters minimum seed depth s and minimum read support r on the performance of sfa spa were also evaluated supplementary s and s these evaluations highlight the relative importance of the overlap parameter m on the assembly_quality the peak memory_usage for sfa spa is higher than that of spa with sfa spa using gb ram times more than spa for the oral sim dataset supplementary s we note though that the sizes of the suffix_array and its associated data_structures grow linearly with the input size the increased memory_usage for sfa spa is expected given the space versus run time tradeoff in our algorithm redesign however this is not an issue since hardware costs associated with these physical memory size requirements are reasonable finally the run time of sfa spa is comparable to that of other nucleotide_sequence assemblers for metagenomic_data supplementary s 
