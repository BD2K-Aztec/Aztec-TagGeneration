stitching gene_fragments with a network matching algorithm improves gene assembly for metagenomics motivation one of the difficulties in metagenomic assembly is that homologous_genes from evolutionarily closely_related may behave like repeats and confuse assemblers as a result small contigs each representing a short gene_fragment instead of complete genes may be reported by an assembler this further complicates annotation of metagenomic_datasets as annotation tools such as gene predictors or similarity_search tools typically perform poorly on configs encoding short gene_fragments results we present a novel way of using the de_bruijn assembly of metagenomes to improve the assembly of genes a network matching algorithm is proposed for matching the de_bruijn of contigs against reference genes to derive gene paths in the graph sequences of contigs containing gene_fragments that have the highest similarities to known genes allowing gene_fragments contained in multiple contigs to be connected to form more complete or intact genes tests on simulated_and show that our approach_called genestitch is able to significantly improve the assembly of genes from metagenomic_sequences by connecting contigs with the guidance of homologous genesinformation that is orthogonal to the sequencing_reads we note that the improvement of gene assembly can be observed even when only distantly_related genes are available as the reference we further propose to use gene graphs to represent the assembly of reads from homologous_genes and discuss potential applications of gene graphs to improving functional_annotation for metagenomics availability the tools are available as open_source for download atmetagenomics also called environmental sequencing is the study of microbial_genomes sampled directly from the environment we are seeing more metagenomics projects than ever before due to i advances in next_generation ngs_technology such as roche and illumina solexa ii the fact that only a few species can be cultured and studied using conventional microbiological techniques and iii many studies that have shown the impact of the microbiome i e the entire set of genomes in a microbial_community on almost every aspect of life on earth e g microbes residing in the human_body encode far more genes than the genes_encoded by the human_genome metagenomics has been applied to many studies of natural_environments as well as human and animal associated microbiomes to whom correspondence should be addressed providing an unprecedented opportunity to gain knowledge about the vast_majority of uncultured microbial_species one of the first steps to analyzing metagenomic_sequences is to assemble the reads for example reads sequenced from the acid_mine dataset yielded two near complete and three partial genomes this however is a very simple bacterial_community assembling sequences sampled from most whole microbial_communities remains_a since most metagenomic_sequences are obtained using ngs_technology the traditional overlap layout consensusapproach may not be realistic due to the short_reads on the other hand the de_bruijn approach which breaks the reads into k_mers and then constructs a de_bruijn on these k_mers is difficult because of the mixture of genomic_sequences from many species and the higher rate of ngs sequencing_errors as a result it is difficult to assemble complete_genomes from metagenomic_sequences even when the community_structure is simplefor example the acid_mine dataset contains merely five species but yields only two nearly complete_genomes one of the characteristics of de_bruijn graph_based assemblers is that the resulting graph is usually very tangled especially when sequencing_errors exist this greatly impedes the formation of long contigs because the branches cannot be resolved moreover k_mers from different regions or even from different species may be connected together which further complicates the structure of the de_bruijn as a result many short contigs will be reported which are often insufficient for downstream_analysis such as ab_initio gene prediction in these short contigs or homology_searches of the contigs for instance the metahit consortium only considered contigs of length_bp which represented only of the sequencing_reads proposed a gene boosted assembly approach to improve assembly_quality which used proteins from reference_genomes to recruit sequencing_reads to fill in the gaps between contigs combining this approach with several other strategies they successfully_produced contigs from bp reads obtained from pseudomonas_aeruginosa pab with the largest contig being bp they also demonstrated that most of the genes in a newly_sequenced bacterial_strain can be assembled using the genome of another strain of the same species as the reference using gene boosted assembly this approach however was only applied to single genome_assembly problems metagenome_assembly is more difficult because of the presence of homologous_genes from multiple species in the same community that may behave like repeats for assemblers hence the success of the approach relies on the utilization of a closely_related genome e g the genome of thewe present genestitch which is based on a network matching algorithm for inferring gene paths and gene graphs from the tangled de_bruijn that result from assembly of metagenomic_sequences if we have prior_knowledge of the taxonomic_composition of a metagenomic_dataset e g through s rrna gene_profiling or taxonomic_analysis using shotgun sequences we can use genes from the most closely_related available as references for genestitch considering that genestitch benefits more by using the most similar gene sequences as the reference however in principle we can use a general dataset of genes e g microbial genes in the ncbi nr dataset as reference genes in genestitch if we have no prior_knowledge of the taxonomic_composition of a metagenomic sample for all tests that we performed the application of genestitch greatly_improves the assembly of genes resulting in complete or nearly complete genes the assembly of complete gene sequences is important because traditional metagenome sequencing_projects are largely limited by the length of contigs and scaffolds and small contigs are often difficult if not possible to use for subsequent functional analysis we believe that our approach will increase the amount of information that can be gleaned from past and future genome and metagenome projects by providing longer genes for analysis we note that genestitch is able to improve the gene assembly even when only distantly_related are available as references and when sequence depth is modest this capability i is especially important because sequenced bacterial or archaeal genomes are still limited and very closely_related such as different strain of the same species are not always available genestitch greatly broadens the choice of reference species for gene_annotation in metagenomic assemblies our approach can be conceived as a gene predictor that works with de_bruijn for assembly instead of linear sequences in this sense genestitch is fundamentally different from current gene predictors including fraggenescan and glimmer note that gene paths are fundamentally different from the directed_acyclic used to represent exons as nodes and their connectivity the edges in predictors for eukaryotic_genes we have also proposed a novel concept the gene graph to represent a collection of homologous_genes in a metagenomic_dataset a gene graph may not include all similar or homologous_genes in a metagenomic_dataset because we set the identity threshold to a relatively high value e g in the process of constructing gene graphs but it is not our goal to build comprehensive gene graphs instead we want to assemble metagenomic_sequences into separate genes as long as wehave strong evidence the assembled genes contain no misassemblies we note that genestitch cannot help with the assembly of novel genes that lack similarity with known genes although the gene graph is used to represent the cases where gene paths overlap with each othera non conventional way of representing geneswe argue that gene graphs can be considered as single units for downstream functional analysis of metagenomes for example we can attempt to get all real genes from the gene graphs by walking all potential paths in the gene graphs and select those supported by reads this approach is used by the trinity assembler to find all spliced isoforms and transcripts of recently duplicated_genes from transcriptomes another application would be functional prediction we can search an unknown gene against all gene graphs and determine which gene graph is most similar to this gene in order to determine its function notably other strategies have been used to improve metagenome_assembly for examples by merging assemblies from different assemblers or using the same assembler but with various parameter_settings by recruiting reads to fill in gaps between contigs using tblastn searches against reference genes as i we designed an approach to infer gene paths and gene graphs from a de_novo assembled metagenomic_dataset that each represents a gene or a single family of homologous_genes each gene graph also generates a representative sequence that best represents the graph we tested this approach on simulated_datasets consisting of reads from one genome and the results are promisinglonger genes are assembled and more intact genes are retrieved and there are almost no misassembled genes we also tested it with a dataset from an artificial microbial_community and found that we again assembled more complete genes we expect that gene graphs can be used to improve metagenome assemblies and that gene graphs will be a useful resource for the functional_annotation of metagenomic_samples 
