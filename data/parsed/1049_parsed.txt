sequence_analysis comb p software for combining analyzing grouping and correcting spatially_correlated p values comb p is a command_line and a python_library that manipulates bed files of possibly irregularly spaced p values and calculates auto correlation combines adjacent p values performs false discovery adjustment finds regions of enrichment i e series of adjacent low p values and assigns significance to those regions in addition tools are provided for visualization and assessment we provide validation and example uses on bisulfite seq with p values from fishers_exact tiled methylation probes using a linear_model and dam id for chromatin_binding using moderated t statistics because the library accepts input in a simple standardized format and is unaffected by the origin of the p values it can be used for a wide_variety of applications a variety of high_throughput generate genome_wide data used to study processes such as dna_binding methylation status and histone_modifications these technologies including tiling arrays and sequence_based assays generate data that are often auto correlated across the genome making inferences difficult the significance of individual regions may be dampened after multiple_testing on potentially millions of sites in such studies hypotheses tests can be performed at each location to generate p values for evaluating the effects of interest for this purpose developed a method for combining p values in sliding_windows and accounting for spatial correlations across the genome here we build on this approach with software that allows for uneven data_structure across the genome more general auto correlation calculations and multiple testing corrections for peaks i e genomic_regions of enrichment with applications to a variety of different technologies we extend three previously_published analyses to demonstrate the utility and breadth of use of comb p and to validate against the published_data the full set of commands used to run each of these analyses is available in the corresponding subdirectory at https github com brentp combined pvalues tree master examples comprehensive high_throughput array for relative methylation is a tiling_array used to quantify methylation at cpg rich sites adjacent probes are correlated due to the regional nature of methylation and to the overlapping probes on the tiling_array the charm study reported incontains probe data for tumor and normal samples from a variety of tissues using these data we fit a linear_model in r http www r project org to obtain p values for the significance of tumor or tissue_specific effects on methylation status at each probe we then run comb p which finds of the tumor specific differentially_methylated c dmrs reported byand of the tissue_specific t dmrs reported while these overlaps depend on the parameter choice we show that the irizarry dmrs that overlap with the comb p dmrs have significantly t test p e lower fdr values as reported by irizarry than those that do not indicating that comb p is reporting the best regions we also show that our method yields only false_positive dmrs on runs of shuffled of charm data of those come from two of the sets because those shuffles of the clinical data happen to coincide well with the casecontrol status of the original data this gives a fdr rate of for reasonable cutoffs we found that comb p recovers more significant probes than a simple fdr correction on the original p values we also found that the process of segmenting the genome into smaller chunks and calling regions independently in each chunk generates similar regions to those derived using the auto correlation_structure for the entire_genome the default damid technology followed by tiling arrays can be used to map genomic_regions bound by dna_binding van we recreate an analysis of the damid tiling_array data for the ci transcription_factor in drosophila_melanogaster calculated the mean log ratios of intensities between ci experimental and control samples to obtain p values from a one sided moderated t test of the original regions are represented in the comb p predicted peaks to score each peak the authors report log of the smallest raw p value for each peak the published peaks overlapping the comb p regions have a higher score than those that do not t test p e indicating that comb p is finding the best regions among those previously_reported in addition comb p regions also yield a higher target enrichment score based on proximity to known ci genes indicating that comb p is selecting for known targets the corrected p value reported by comb p can be used as a filter to extract regions of interest we calculated the enrichment ratio of the number of observed to expected ci target_genes at various comb p corrected p value cutoffs for a cutoff of the enrichment is this enrichment increases to and for more stringent cutoffs of e and e respectively bisulfite_sequencing bs_seq is also used to measure methylation across the genome as another example of the flexibility of our method we demonstrate a possible analysis on data described infrom arabidopsis_thaliana using methylcoder to map the bisulfite treated reads to the genome at each site we use fishers_exact to obtain p values for the counts of converted and un converted cytosines between endosperm and embryo we find dmrs between these two tissues associated with genes enriched for gene ontologies related to the ribosome p e the comb p software is useful in contexts where auto correlated p values are generated across the genome we have outlined our implementation and demonstrated the utility on data from three different technologies each from a different statistical_test we have also validated our method using previously_published from those studies future work could extend this framework to address applications with a more segmented structure such as dna_copy and chip_seq currently we recommend the use of comb p for technologies with a more regular autocorrelation structure in addition we note that this method will have a sensitivity_and that will depend on each dataset and we recommend that users explore these tradeoffs on shuffled versions of their own data as demonstrated in the charm example 
