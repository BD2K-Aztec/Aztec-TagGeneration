gene_expression proper comprehensive power evaluation for differential_expression using rna_seq motivation rna_seq has become a routine technique in differential_expression de identification scientists face a number of experimental_design decisions including the sample_size the power for detecting differential_expression is affected by several factors including the fraction of de genes distribution of the magnitude of de distribution of gene expression_level sequencing_coverage and the choice of type_i control the complexity and flexibility of rna_seq experiments the high_throughput nature of transcriptome_wide expression measurements and the unique characteristics of rna_seq make the power assessment particularly challenging results we propose prospective power assessment instead of a direct sample_size by making assumptions on all of these factors our power assessment_tool includes two components i a semi_parametric simulation that generates data based on actual rna_seq experiments with flexible choices on baseline expressions biological_variations and patterns of de and ii a power assessment component that provides a comprehensive view of power we introduce the concepts of stratified power and false discovery cost and demonstrate the usefulness of our method in experimental_design such as sample_size and sequencing_depth as well as analysis plan gene filtering rna_sequencing has become a routine technique to study the whole transcriptome in addition to the initial excitements of the extraordinary power of the technology such as being able to detect novel transcripts and alternative_splicing patterns more and more researchers use rna_seq as a replacement of gene_expression to quantify and compare expression levels under distinct biological_contexts for example to identify differentially_expressed de genes it has been well recognized now that technology improvements do not eliminate biological_variability thus replication is still necessary in establishing statistical_significance in the identification of de however the number of replicates needed in rna_seq a key issue in experimental_design remains a challenge owing to the complexities of the experiment and the nature of rna_seq in classical sample_size determination involving a single hypothesis_test one typically starts with a few quantities that one can make reasonable assumptions on the minimum effect_size which is scientifically meaningful the variance which can be estimated from historical_data an acceptable type_i usually in the form of p value etc the statistical_power also has a clear definition the probability of rejecting the null_hypothesis under the alternative model based on these assumptions one can then study the relationship between the statistical_power and the sample_size in high_throughput experiments such as identifying de genes from microarray or rna_seq where many statistical_tests are performed_simultaneously several factors complicate the sample_size the first one is the need to deal with multiple testing false_discovery fdr is often a preferred control of type_i over family_wise for microarray_studies several sample_size calculation_methods have been proposed based on controlling fdr for example liu and hwang built a connection between fdr and power and derived algorithms for power calculation based on t or f test second we note that the power analysis for rna_seq is even more complicated than that in microarray_data the baseline expression_level is not of interest in microarray_data and can often be assumed to be zero without loss of generality as it does not affect type i or ii error in the de detection this is because the preprocessed expression values can be modeled as gaussian_distribution where the mean and variance are unrelated thus the baseline expression_level does not affect the test_statistics in microarray_data however in rna_seq gene_expressions are measured as counts and often modeled as poisson or negative_binomial distributions the variation in gene_expression comes from both the biological_variation and the sequencing counting error the relative importance of the counting error depends on the expression_level for genes with low counts the variation owing to the counting process dominates the variance whereas for genes with high counts it is negligible as a result the power in de detection is affected by expression_level for example there is power bias toward longer genes to whom correspondence should be addressed the author published_by all_rights for permissions please_e journals permissions_oup com because more reads are generated from longer transcripts further as coverage depends on sequencing efficiency as well as expression_level genes with modest counts are not necessarily expressed_at thus these may still be of interest even if we want to focus on genes that are above a certain level of expression another issue often overlooked in existing_methods of sample_size determination for de experiments is the wide_application of empirical_bayes approach in de detection because of the limited sample_size in many experiments the gene specific biological variance is often estimated with some shrinkage by borrowing strength across genes this helps stabilizing the variance estimates and leads to better ranking of true de genes but in the meantime also creates dependency among genes which affects the validity of some error control procedures in multiple testing though all methods report type_i either as p value fdr q value or both the type_i may be computed from a parametric test of which assumptions are not all met and the reported fdr is often obtained via simple conversion from nominal p values using benjaminihochberg methods the resulting nominal error_rate can be rather different from actual error_rate finally the flexibility of sequencing_experiments gives scientists more freedom in experimental_design for the same amount of sequencing one may choose to seek deeper coverage of a small collection of samples or to obtain more samples with modest coverage this is an additional factor not encountered in microarrays there are several methods for calculating the sample_size for rna_seq in recent_literature these include methods for single gene differential_expression based on likelihood_ratio or wald_test or on score test from negative_binomial these methods however are not directly applicable to simultaneously testing thousands of genes profiled from one rna_seq experiment because they do not come with a procedure that deals with multiple_comparisons proposed an analytical_method based on poisson_model to determine sample_size for both single gene and multiple gene comparisons with adjustment for fdr this method has been further extended to negative_binomial in however to make calculations attainable the authors suggested setting a common value for parameters including fold_change dispersion and average read_count for all the genes in reality these parameters vary a lot between genes and this method is not flexible enough to fully capture the complex characteristics of rna_seq although one can choose common conservative values for these parameters it will overestimate the sample_size and increase the cost of the experiments we argue because of the complexities of rna_seq experiments it is no longer feasible to rely on one simple power versus sample_size curve while treating all other factors as fixed input and holding strong assumptions such as exchangeability between genes and equating nominal error_rate as actual error_rate we advocate prospective power evaluation in the context of rna_seq i e evaluating power in a comprehensive manner under various scenarios of sample_size and sequencing_depth we use the word prospective to emphasize our choice to assess and visualize power in multiple forms and maintain its high_dimensional nature instead of specifying a fixed level of one particular form of power to determine the sample_size we demonstrate that in addition to the sample_size and the other usual suspects in power analysis namely effect_size and withingroup variance there are other factors such as the distribution of mean expression_level and other choices such as sequencing_depth and gene filtering that influence the power of de detection we propose a simulation based power evaluation as the accumulation of rna_seq allows us to construct in silico datasets that well resemble real rna_seq and the increasing computing efficiency allows us to evaluate actual error_rate moreover we demonstrate that conditional power i e power stratified by coverage or biological_variation is more informative than overall marginal power in both experimental_design and analysis plan statistical_power and sample_size determination are the most common questions we face in experimental_design in high_throughput experiments that involve a large number of in exchangeable tests statistical_power is not as tractable as in classical hypothesis_testing we demonstrate that in a rna_seq study more factors_affect the sample_size determination in addition to the effect_size and variance including the distribution of the baseline expression_level what proportion of genes have high coverage in the sequencing the distribution of the biological_variation and the proportion of genes having de asking a biologist to provide specific numbers for all the above factors and or to confirm that a particular parametric distribution is reasonable for some parameter seems unrealistic on the other hand assuming the overall behavior of a factor to resemble that in some existing dataset eases the communication thus we prefer semi_parametric simulation_settings as described in section the definition of power itself can vary in rna_seq experiments we may be interested in average marginal power as the proportion of all de genes identified or targeted power as the proportion of de genes identified from a subset of genes or we may be interested in the number instead of proportion of de genes identified for these reasons we advocate sample_size decision based on a comprehensive evaluation of statistical_power as well as actual type_i over a range of sample_sizes based on simulation_studies we refer to this as prospective power evaluation as compared with fixing one set of assumptions on effect_sizes type_i control expression_level sequencing_depth and then compute a minimum sample_size to achieve a certain level of power for a particular type of power the user visualizes the relationship between various types of power and sample_size expression_level and biological_variation and understands the cost of false discovery in different strata of genes the power evaluation thus assist the decision on sequencing_depth analysis plan filtering or not choice of nominal error_rate and then based on these decisions the user can select a sample_size that provides acceptable power filtering certainly comes with sacrifice we discard the power completely on the genes we filter out but the power evaluation allows us an informative decision we would know how much power we give up and make this decision before real_data are analyzed so we reduce the number of tests hence not having to adjust for the tests never performed the fact that statistical_power depends on the baseline expression_level and the dispersion level has several consequences the first consequence is that power for i e j g j is often biased toward highly_expressed sometimes it may be beneficial to filter out genes with counts too low as discussed above the second consequence is that simulation_results based on one rna_seq dataset may not be generalizable to experiments involving another tissue cell_type with a different expression distribution across genes for this reason we provide options using several public rna_seq as simulation sources we also let the user substitute with their choice of baseline expression one way of increasing power is to increase sequencing_depth this is apparent from the stratified power plot when we sequence deeper genes with average counts in lower strata will move to higher strata and be associated with higher sensitivity at the same type_i control however based on there is a sharp_increase of power when the genes average count goes but remains relatively flat thereafter if there are many genes whose expression_level is lower than but near increasing the sequencing_depth may help but there is little gain on de detection sensitivity for those genes that already have high power thus the impact of sequencing_depth also depends on the expression pattern of the transcriptome under study if the transcriptome consists of a smaller fraction of the genes with similar level of expression then with modest depth most of the genes may already reside in middle expression strata with acceptable power 
