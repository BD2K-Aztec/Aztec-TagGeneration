bioimage_informatics fast and robust optical_flow for time lapse microscopy using super voxels motivation optical_flow is a key method used for quantitative motion estimation of biological structures in light_microscopy it has also been used as a key module in segmentation and tracking_systems and is considered a mature technology in the field of computer vision however most of the research focused on d natural_images which are small in size and rich in edges and texture information in contrast d time lapse recordings of biological_specimens comprise up to several terabytes of image data and often exhibit complex object dynamics as well as blurring due to the point_spread of the microscope thus new approaches to optical_flow are required to improve performance for such data results we solve optical_flow in large d time lapse microscopy datasets by defining a markov_random mrf over super voxels in the foreground and applying motion smoothness constraints between super voxels instead of voxel_wise this model is tailored to the specific characteristics of light_microscopy datasets super voxels help registration in textureless areas the mrf over super voxels efficiently propagates motion_information between neighboring_cells and the background_subtraction and super voxels reduce the dimension ality of the problem by an order of magnitude we validate our approach on large d time lapse datasets of drosophila and zebrafish_development by analyzing cell motion_patterns we show that our approach is on average faster than commonly used optical_flow implementations in the insight tool kit itk and reduces the average flow end_point error by in regions with complex dynamic_processes such as cell_divisions availability source_code freely_available in the software section atautomated computational_techniques are essential for the quantitative analysis of cellular_dynamics using time lapse light_microscopy for example to quantitatively reconstruct the development of large multi_cellular organisms such as entire drosophila and zebrafish_embryos tens_of of cells need to be segmented and tracked at high_spatial such analyses are of fundamental_importance to understanding the development of biological_tissues to reconstructing functional_defects in mutants and disease_models and to quantitatively dissecting the mechanisms_underlying the cellular building plan of entire complex organisms however many computational challenges are encountered when performing key tasks such as image_registration cell segmentation and cell_tracking in complex microscopy datasets optical_flow computation is one of the central tasks used to perform quantitative motion estimation of biological structures in time lapse light_microscopy from the subcellular_level to the tissue scale optical_flow is defined as the vector_field capturing the motion of brightness patterns between adjacent volumes in time since our examples are d images we use the term volume to refer to the datasets used in optical_flow computation however our approach and code work also for d images on the cellular_level optical_flow information can theoretically be obtained from single cell_tracking data however comprehensive and accurate cell_tracking in complex multicellular_organisms is currently an open research problem here optical_flow methods can be useful for analyses of group dynamics which do not require single_cell resolution or conversely as the first module in a larger cell_tracking framework in this latter scenario the flow information informs the tracking algorithm and helps improving results for regions exhibiting complex or fast cell dynamics optical_flow computation has been the object of decades of research and it is considered a mature technology in many computer vision applications however most approaches have been tested in relatively small d natural_images which are dense and rich in edges and texture information the middlebury database used as a benchmark in the computer vision community is a good example of these types of images fluorescence_microscopy volumes of biological structures are qualitatively very different from natural_images they are sparse in datasets similar to of voxels are background throughout the text we use the term voxel to generically refer to each intensity value in a dataset independent of the dimensionality of the data and contain relatively textureless objects which typically appear blurred to whom correspondence should be addressed the author published_by this is an open_access the terms of the creative commons attribution license http creativecommons org licenses by which_permits distribution and reproduction in any medium provided the original_work owing to the point_spread of the microscope and the characteristics of commonly used fluorescent_labeling strategies moreover neighboring objects with similar appearance and multiple motions in the same volume are very common finally microscopy volumes tend to be much larger than natural_images which demands computationally_efficient approaches here we present a new algorithm for optical_flow estimation tailored to large fluorescence light_microscopy d time lapse datasets as the one shown in the key idea is to define a model that takes_into the specific characteristics of time lapse microscopy data in particular we define a markov_random mrf over super voxels to improve registration in textureless areas propagate motion_information efficiently between neighboring structures and speed up computations by reducing the complexity of the problem we evaluate our approach in scanned light_sheet datasets light_sheet provides exceptionally_high imaging speeds while minimizing the energy load on thebiological specimen and has thus emerged as an essential tool for life_sciences this combination of capabilities is invaluable for live imaging_applications and enables quantitative_imaging of cellular_dynamics throughout the development of complex organisms such as entire drosophila and zebrafish_embryos in the supplementary_material light_sheet microscopes often produce terabytes of image data per specimen which need to be analyzed with efficient computational_approaches we tested our approach in two different biological model systems using previously_published datasets of drosophila and zebrafish two videos are included in the supplementary_material to show the complete results of the optical_flow estimation and how it allows analyzing different motion_patterns for different groups of cells each volume of the drosophila dataset consists of voxels mb in uint and each pair of time points was processed in min with our method all central_processing cpu running_times reported in this article were determined on a workstation with intel_xeon x cpu with ghz clock rate in total we processed time points gb of data following a cell_division wave in early development each volume of the zebrafish dataset consists of voxels mb in uint and each pair of time points was processed in min with our method in total we processed time points gb of image data to follow epiboly and the formation of the body_axis additional evaluation of the proposed and baseline methods using synthetic data is provided in the supplementary_material we simulate fluorescent nuclei images with different types of motion linear cell_division and brownian different signal_to different cell_densities and different photobleaching settings to show that our method is applicable to different types of fluorescence microscopy_techniques and cell dynamics we developed and tested a new model for optical_flow tailored to microscopy volumes in which a large fraction of the objects are textureless and similar in appearance moreover the information in the volume tends to be sparse because many voxels do not contain any information and cellular_dynamics can be very variable a key idea in our approach is to generate a volume partition graph over the foreground voxels and to perform optical_flow directly on that model instead of computing it at the voxel_level this model is tailored to the specific characteristics of time lapse light_microscopy datasets as it provides the regularization needed to solve optical_flow robustly for these types of volumes at the same time our method reduces the complexity of the problem by an order of magnitude which is an invaluable advantage when working with large d datasets in section we showed that the method might fail in some extreme cases for of the nuclei when neighboring nuclei move in opposite_directions in those scenarios we are left only with the data term to determine the correct flow thus a possible future direction would be to use different features or point descriptors in the volume intensity to increase robustness of the data term it is also possible to constrain the flow_field to a diffeomorphism as two objects cannot originate from the same source point finally if a faster implementation is required it is straightforward to parallelize the computation of the data term in equation for each super voxel using gpu technology at the moment this operation takes of the time for each function evaluation in the quasi newton method and it is thus a primary candidate for code optimization 
