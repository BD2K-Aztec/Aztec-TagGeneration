bionetfit a fitting tool compatible with bionetgen nfsim and distributed computing environments rule_based are analyzed with specialized simulators such as those provided by the bionetgen and nfsim open_source software_packages here we present bionetfit a general_purpose fitting tool that is compatible with bionetgen and nfsim bionetfit is designed to take advantage of distributed computing_resources this feature facilitates fitting i e optimization of parameter_values for consistency with data when simulations are computationally_expensive availability_and bionetfit can be used on stand alone mac windows cygwin and linux platforms and on linux based clusters running slurm torque pbs or sge the bionetfit source_code perl is freely_available http bionetfit nau edu biomolecular_interactions can be represented by formalized rules collections of rules form rule_based which provide concise representations of biomolecular interaction networks and can be analyzed to obtain insights into how system level behavior emerges from biomolecular_interactions rule_based must be analyzed with specialized algorithms and software_tools such as bionetgen which interprets models encoded in the bionetgen language bngl and provides deterministic stochastic and hybrid forward simulation capabilities to date other critical methods of analysis such as fitting parameter_estimation have typically been applied ad_hoc e g by writing problem specific programs as in the study ofor which leads to duplication of effort and hinders the ability to reproduce results although many algorithms and software implementations are available for analysis of models specified in traditional forms such as that of ordinary_differential odes standard techniques are not easily applied to rule_based except for those rule_based that can be recast into a traditional model form translating a set of rules into a reaction_network i e a list of reactions or the corresponding odes for the mass action kinetics of the network a capability provided by bionetgen is expensive and sometimes impracticable in such cases direct simulation_methods which is compatible with bngl specified models expand the range of biomolecular interaction networks that can be studied because the cost of network free simulation scales with the number of rules in a model not the number of reactions implied by the rules software that provides a general_purpose fitting capability and that interfaces with a network free simulator has not hitherto been available here we present bionetfit a general_purpose fitting program for rule_based that is compatible with bionetgen and nfsim because of the potentially high_cost of network free simulation bionetfit has been designed to be used on clusters it can also be used on stand alone computers bionetfit implements a genetic_algorithm below we provide an overview of bionetfit and a demonstration of its capabilities to provide a demonstration of capabilities we used bionetfit together with bionetgen nfsim and experimental_data ofto estimate parameter_values for a published and an extended version of a model for activation of the epidermal_growth egf_receptor egfr each version of the model accounts for egf induced oligomerization of egfr the published model is defined in supplementary_file s which is a bngl file that directs bionetgens ode solver to produce simulation_results the file is derived from the bngl file used by this version of the model limits egfr oligomers to a maximum_size of four receptors per oligomer this limitation was introduced byto avoid the need to use computationally_expensive network free simulation in fitting which was performed using problem specific code the extended model is defined in supplementary_file s which is a bngl file that directs nfsim to produce simulation_results the file is derived from the bngl file used by this version of the model imposes no constraints on the size of linear oligomers it is otherwise identical to the published model of the steady_state dose response and time series data used in each of the two fitting runs are provided in supplementary files s and s which are exp files supplementary files s and s are the bionetfit configuration conf files for the two fitting runs these files complement supplementary files s and s respectively in the fitting procedure bionetfit evaluated the consistency of simulation_results with all available data i e bionetfit found a global fit the chi_square metric was used to determine goodness_of parameter_estimates are summarized in supplementary table s the number of free_parameters was nine which included five physical_parameters e g rate_constants and four scaling_factors parameters of a measurement model which define linear relationships between measured quantities and model predicted quantities the quality of the fit for the original and extended models is illustrated in for best fit parameter_values the extended model_predicts that egfr oligomers larger than tetramers do not form appreciably supplementary this finding justifies the omission of these oligomers in the analysis of bionetfits ability to take advantage of simulation runs performed in parallel on a cluster enabled consideration of the extended model which had to be simulated by calling nfsim the kmc stochastic_simulation method implemented in nfsim tends to be computationally_expensive because in such methods system state is advanced one reaction event at a time use of nfsim was required because the extended model places no constraint on the size of linear egfr oligomers which form via polymerization like reactions network free simulation is typically required to cope with polymerization reactions as expected we found that simulations_performed by nfsim for the extended model were significantly more expensive than simulations_performed by bionetgens ode solver for the original model the cost difference depends on various factors including hardware model parameter_values and algorithmic parameter_settings for a representative cpu in the cluster we used and the parameter_settings of supplementary files s and s an nfsim simulation is fold more expensive than an ode based simulation it should be noted that the cost difference depends sensitively on the value of one particular algorithmic parameter called f in supplementary_file s which scales system size in general the cost of a discrete event stochastic_simulation the type of simulation performed by nfsim depends on the number of reaction events per unit time which in turn depends on system size measured by the number of reactive molecules in the system in supplementary_file s we set f which corresponds to a system size of of a cell this setting reduces the cost of individual simulation runs and memory_requirements at the expense of introducing noise i e fluctuations arising from probabilistic reaction events the noisiness of simulation_results complicates the comparison of predicted and measured population averaged quantities because of this issue in fitting multiple nfsim simulations were performed for each bionetfitgoodness of fit evaluation bionetfit allows a user to cope with the noisiness of stochastic simulation_results in a brute_force manner by repeating simulation runs a user specified number of times and then averaging the results this procedure serves to smooth stochastic simulation_results results from two additional non trivial fitting demonstrations are summarized in supplementary tables s and s which provide bestfit parameter_estimates and supplementary figures s and s which illustrate the quality of fits obtained the files needed to reproduce these results are provided in the example and example subdirectories of the examples directory in the bionetfit distribution the demonstrations each require nfsim the example demonstration concerns a rule_based model for interaction of a trivalent ligand with a bivalent cell_surface and parameter_estimation on the basis of equilibrium data collected via flow_cytometry the example demonstration concerns a rule_based model for early events in t cell receptor_signaling and parameter_estimation on the basis of temporal phosphoproteomic data collected via mass_spectrometry notably because changes in phosphorylation levels were measured relative to basal phosphorylation levels this fitting problem required normalization of model outputs at the basal steady_state which is explained in the bionetfit user_manual 
