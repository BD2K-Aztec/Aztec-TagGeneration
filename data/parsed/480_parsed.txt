a robust approach for identifying differentially_abundant features in metagenomic_samples motivation the analysis of differential abundance for features e g species or genes can provide us with a better understanding of microbial_communities thus increasing our comprehension and understanding of the behaviors of microbial_communities however it could also mislead us about the characteristics of microbial_communities if the abundances or counts of features on different scales are not properly normalized within and between communities prior to the analysis of differential abundance normalization_methods used in the differential analysis typically try to adjust counts on different scales to a common scale using the total sum mean or median of representative features across all samples these methods often yield undesirable results when the difference in total_counts of differentially_abundant features dafs across different conditions is large results we develop a novel method ratio approach for identifying differential abundance raida which utilizes the ratio between features in a modified zero inflated lognormal model raida removes possible problems associated with counts on different scales within and between conditions as a result its performance is not affected by the amount of difference in total abundances of dafs across different conditions through comprehensive simulation_studies the performance of our method is consistently powerful and under some situations raida greatly surpasses other existing_methods we also apply raida on real_datasets of type_ii and find interesting_results consistent_with availability_and an r package for raida can be accessed frommetagenomics is the study of microbes by analyzing the entire genomic_sequences directly obtained from environment samples bypassing the need for prior cloning and culturing of individual microbes this has been a tumultuous obstacle to overcome for the purposes of studying the structural entirety of a microbial_community primarily because more than of microbes cannot be isolated and independently cultured in laboratories the field of metagenomics has attracted researchers of diverse_backgrounds including microbial_ecology biosciences and health and medical_sciences due to the increasing availability of high_throughput an important application of metagenomics is the identification of differentially_abundant features dafs which can be either taxonomic units e g species or functional_units e g genes across different environmental including host associated conditions detection of differentially_abundant microbes across healthy and diseased populations for instance can enable us to identify potential_pathogens or probiotics in the differential analysis normalization is an essential step as demonstrated in many previous_studies on rna_sequencing rnaseq and metagenomic sequencing_data several normalization approaches have been proposed including total_count tc upper_quartile trimmed mean of m values tmm cumulative_sum scaling etc although these methods differ in the choices of representative features used to account for samples on different scales they all implicitly or explicitly adjust counts i e the number of sequence_reads assigned to each feature measured on different scales to a common scale using the total sum mean or median of the counts of the representative features for instance tc uses all features in a sample as representative features and normalizes counts with the total sum tmm uses trimmed features which are the remaining features after removing some upper and lower percentage of the data based on the gene wise log foldchanges and absolute expression levels as representative features to adjust library sizes and normalizes counts with the mean of the adjusted sizes these approaches of rescaling counts are appropriate for either estimating proportions of features for the samples under the same biological environmental condition or comparing overall patterns of compositions of features for the samples under different conditions however they are not conducive for identifying individual dafs across different conditions as an illustration consider two different regions each containing chickens pigs and cows respectively after an avian_influenza outbreak half of the chicken population in region one was eradicated the proportions of these animals in each region or the overall difference in the composition of these animals in the two regions can be well estimated by the approaches of rescaling counts now we wanted to identify which animals are different in their abundances across the two regions the approaches_involving rescaling counts would find that all the animals are different e g versus percent in abundances for chickens pigs and cows in this order however we would reject this result because clearly the change in abundance occurred only in the chicken a similar conclusion should be made in the comparison of microbes even though we cannot directly observe their changes in abundance this by no means disparages the aforementioned methods in fact these methods perform well when the differences in total abundances of dafs across different conditions are small that is the change in proportions of non dafs across different conditions is small which we denote by the balanced conditions however the reliability of their results cannot be assessed unless we have such prior information throughout this article we use the terms balanced conditions and unbalanced conditions where the latter is used to describe a situation whereby the difference in total abundances of dafs across different conditions is large thus affecting proportions of non dafs an example is provided infor illustrative purposes in this example the proportion of the total abundance of non dafs is for both conditions under the balanced case while it is changed from to between two conditions under the unbalanced case to identify dafs consistently without being confounded by the amount of difference in total abundances of dafs across different conditions we propose a new approach called ratio approach for identifying differential abundance raida with the assumption that majority of features are not differentially_abundant this is the same assumption used for genomic studies in deseq and edger in fact this assumption is stronger than necessary in most cases see the proof of proposition in supplementary_file raida utilizes the ratios between the counts of features in each sample eliminating possible problems associated with counts on different scales within and between conditions metagenomic sequencing_data are sparse i e containing a lot of zeros to account for ratios with zeros we use a modified zero inflated lognormal zil model with the assumption that most of the zeros come from undersampling of the microbial_community or insufficient sequencing_depth we evaluated raida through comprehensive simulated studies and compared the results with those of metastats and metagenomeseq which were developed for a metagenomic and a microbial marker gene analysis respectively in the comparison we also included a representative method for rna_seq analysis edger which uses tmm as a default normalization method compared with the other methods raida gives equivalent performance in the balanced conditions and improved_performance in the unbalanced conditions above all raida performs consistently for both the balanced and unbalanced conditions the consistency of the performance should be highly_valued since most of time there is no sufficient prior information about samples available in other words it is unlikely to know ahead that conditions to be compared are balanced or unbalanced we also applied raida on a subset of real_data selected from the original datasets in the metagenomic study of diabetes raida identified two differentially_abundant bacteria clostridium_botulinum and clostridium cellulovorans across fecal dna samples of the type_ii and non diabetic controls at the false_discovery fdr these bacteria appear in the kegg_pathways for type_ii and type i diabetes_mellitus respectively the raida method is developed for the analysis of differential abundance between two conditions of samples such as healthy versus diseased however it can be extended to detect dafs in metagenomic_samples under more than two conditions community false zeros all zeros remain_unchanged after transforming the count_data into ratio data using a common divisor it can be a vector of the counts of a feature consisting of non zeros in all samples or a vector of the sums of a group of features consisting of non zeros in all samples to fit ratios with zeros we use a modified zil note a lognormal distribution has been used as a fundamental distribution for non zero ratios in the compositional data analysis let c ij denote the observed count for feature i and sample j and r ij denote the ratio of c ij to c kj where k represents a feature or a set of features used as a divisor and c kj for all j here i n and j m throughout this article we denote undersampling of the microbial_community or insufficient sequencing_depth by the false zero state assuming a zil model for the ratio r ij we have this model does not account for zero counts from the true zeros since the support for a lognormal distribution is that is r ij is assumed to be in the false zero state if c ij whether or not the zero count comes from the false zero state to accommodate for this insufficiency a small number is added to c ij for all i and j before computing the ratios we denote the ratio computed this way as r ijand we have in this study we use min r ij jr ij for all i and j the parameters h i g i l i r i are estimated by the following expectationmaximization em_algorithm 
