gene_expression gene_set limitations in popular existing_methods and proposed improvements motivation gene_set is the analysis of a set of genes that collectively contribute to a biological_process most popular gene_set are based on empirical p value that requires large number of permutations despite numerous gene_set developed in the past_decade the most popular_methods still suffer from serious limitations results we present a gene_set method mgsz based on gene_set z scoring_function gsz and asymptotic p values asymptotic p value calculation requires fewer permutations and thus speeds up the gene_set process we compare the gsz scoring_function with seven popular gene_set scoring_functions and show that gsz stands out as the best scoring_function in addition we show improved_performance of the gsa method when the max mean statistics is replaced by the gsz scoring_function we demonstrate the importance of both gene and sample permutations by showing the consequences in the absence of one or the other a comparison of asymptotic and empirical methods of p value estimation demonstrates a clear advantage of asymptotic p value over empirical p value we show that mgsz outperforms the state of the art methods based on two different evaluations we compared mgsz results with permutation and rotation tests and show that rotation does not improve our asymptotic p values we also propose well known asymptotic distribution models for three of the compared methods availability_and mgsz is available as r package from cran r project org contact pashupati mishra helsinki fi supplementary_information available atinferring biological_pathways from high_throughput gene_expression that are altered in a biological or a medical test is one of the major challenges in biosciences the analysis of gene_sets instead of individual genes results in significant reduction of noise and dimension and in greater biological interpretability furthermore it enhances the statistical_power of tests of association of phenotype with genetic_variants by pooling signals of a set of genes linked to the same biological_process annotation libraries like gene_ontology kegg_pathways and mips functional_categories are some of the popular sources for gene_sets several methods have been developed for gene_set according to goeman and b uhlmann gene_set can be categorized into two major categories competitive and self contained competitive methods focus on distinguishing the most significant gene_sets among a dataset of gene_sets t or onen et_al whereas selfcontained methods focus on analysis of gene_sets irrespective of other genes in the dataset in this article we focus on competitive gene_set recent research has addressed gene_set problems in datasets with fewer replicates and more than two sample groups however the fundamental problems in p value calculation for gene_set scores remain unaddressed most of the methods are still based on empirical p value that requires a large number of permutations or rotations to be calculated accurately in this article we first evaluate various gene_set scoring_functions for their optimality and then propose improvements to empirical p value calculation we start with a rigorous assessment and evaluation of popular gene_set gene_set gsa gene_set z_score gsz t or onen et_al allez methods based on kolmogorovsmirnov ks and weighted kolmogorovsmirnov wks and methods based on wilcoxon_rank wrs sum of scores sum and sum of squared scores ss based on empirical p value obtained from hundred thousand sample permutations the selection of the methods was based on earlier comparisons we then test whether empirical null_distribution gene_set scores from permuted data obtained from the compared methods can be modeled by suitable asymptotic distribution models we point out major limitations in some of the methods and propose improvements on scoring_functions permutation models and p value estimation we show that the efficiency of gsa can be significantly_improved by replacing the to whom correspondence should be addressed ythe authors wish it to be known that in their opinion the first two authors should be regarded_as max mean statistics with the gsz scoring_function and by implementing asymptotic p value similarly the performance of allez can be significantly_improved by implementing sample permutation and asymptotic p value estimation the improved versions of gsa and allez are called mgsa and mallez respectively we show that gsz outperforms all the compared methods including the improved ones in our evaluation we propose an asymptotic method of p value estimation for gsz mgsa mallez and sum asymptotic p value estimation requires fewer permutations and significantly speeds up the gene_set process similar work that proposes asymptotic method for p value calculation was done by our method is different in that it requires fewer permutations proposed fully parametric gene_set based on normal_approximation of the gene_set scores gene independence_assumption however mgsz is semi_parametric in the sense that we approximated the empirical null distributions of gene_set scores with well known asymptotic distribution models for asymptotic p value estimation the implementation resulted in significant_improvement in efficiency of the methods for gene_set with no known asymptotic model we implement an improved version of p value calculation based on phipson and smyth p value estimation in permutation_based gene_set uses either genes or samples or both as sampling unit despite its popularity gene permutation can lead to flawed biological conclusion because of correlation among genes goeman and b uhlmann for the competitive gene_set however we show that it is crucial to consider the results from gene permutation similar to we show that the absence of gene permutation in competitive gene_set results in type_i we argue in favor of using both gene and sample as sampling unit in competitive gene_set as proposed by efron and and t or onen et_al once significant gene_sets are reported it is useful to evaluate a gene_set in more detail to see the behavior of the gene_set this can be done by visualizing the gene_set score profile across the gene_list as shown in the original gsea article in our opinion it is even more relevant to compare gene_set scores from original and permuted data original data correspond to differential_gene test scores calculated from gene_expression data with correct sample labels and permuted data correspond to differential_gene test scores calculated from gene_expression data with permuted sample labels therefore we represent an improvement on the visualization where we show the gene_set scores from original data and a summary e g percentiles of the gene_set scores from permuted data this allows visualization of separation between gene_set scores from original and permuted data we compared mgsz with program packages of gsa allez and camera we show that mgsz clearly outperforms the other methods roast is a state of the art self contained gene_set method even though in principle self contained methods cannot be compared with competitive methods we compared mgsz with roast to point out the differences in gene_set results from the two different approaches proposed rotation test for estimation of p values for gene_set of datasets with very small_sample we show that asymptotic p values estimated from permutation_test were equally good as that of rotation test with a dataset consisting of only three replicates in each group finally we present a r statistical package mgsz that implements mgsz and the other compared methods gene_set aim to identify a priori defined gene_sets associated with biological_pathways that are altered in a biological or medical test despite the decade long research into the field some of the most popular gene_set still suffer from serious limitations that need to be addressed and rectified in this work we have accessed and evaluated popular gene_set pointed_out limitations in the scoring_functions permutation methods and p value calculation_methods and proposed improvements mgsz and mgsa are the best performers in detection of tf_activity in tf data section however in case of p and gender data mgsz detected the highest number of relevant gene_sets closely followed by ss section overall mgsz stands out as the best performer in detection of relevant gene_sets note that the evaluation tests detection of tf_activity in tf data and relevant gene_sets in p and gender data were based on empirical p values estimated with permutations only the gene_set scoring_functions were varied in the compared methods so the variations in results were direct consequences of the gene_set scoring_functions despite the good performance in detection of relevant gene_sets with p gender and tf data ss as well as sum had significantly high type error with randomized leukemia dataset section ss and sum are the only methods in our comparison that lack gene permutation because of that the methods do not compare the member and non member genes of the analyzed gene_set and thus lose the essence of competitive gsa note that self contained gene_set do not require gene permutations as they calculate gene_set scores with no reference to genes other than member genes of the analyzed gene_sets the remaining six methods have gene permutation included implicitly in their scoring_functions and take into consideration the results from gene permutations implicitly this clearly points to the importance of considering results from gene permutation in competitive gene_set section evd and gevd turned out to be the best fitting models for mgsz data which is quite natural considering that the mgsz score is the highest absolute value in a profile for mgsa evd gevd and gamma turned out to be the best fitting models in case of mallez and sum norm was the best fitting model asymptotic p values_calculated for mgsz mgsa mallez and sum scores with the best fitting models with sample permutations were more accurate than empirical p values_calculated with sample permutations clearly demonstrating the superiority of asymptotic p value over empirical p value section surprisingly despite the poor_performance on the other tests empirical p value estimation method for ks with sample permutations shows exceptionally high_accuracy section comparison of mgsz with the state of the art gene_set showed the best overall performance of mgsz mgsz is the best method among the compared methods based on the results from the detection of relevant gene_sets from p and gender datasets and comparison of resolution of the pvalues assigned to the top gene_sets from p and gender datasets section the comparison of mgsz with roast was included to illustrate the differences between self contained and competitive methods with a suitable dataset in a signal rich dataset like leukemia self contained methods like roast fail to provide biologically conclusive_results randomization of gene_sets in leukemia dataset randomizes the member genes of the gene_sets however as of the individual genes are differentially_expressed in the leukemia data roast identifies a significantly large number of null gene_sets as significant this effect is not seen in competitive methods as competitive methods compare the member genes with non wrs present present implicitly low ss present absent high sum present absent high wks present present implicitly low ks present present implicitly low allez absent present ranked as worstgsa present present ranked lower than mgsz and mgsamember genes of the analyzed gene_sets and thus the results remain stable in datasets with varying level of biological_signals interestingly both mgsa and mallez rank higher than gsa and allez in detection of the relevant gene_sets in p and gender dataset higher rank of mgsa as compared with gsa suggests that replacement of max mean statistics in gsa with gsz scoring_function and implicit implementation of gene permutation improved the performance of the method note that gsa implements gene permutation explicitly whereas higher rank of mallez as compared with allez suggests that implementation of sample permutation in addition to gene permutation in allez improved the performance of the method once again highlighting the importance of implementing both gene and sample permutations in competitive gene_set section negligible difference was observed between the asymptotic p values reported by mgsz with rotation test and mgsz with permutation_test section with simulated gene_expression dataset with three replicates in each sample group in addition both the methods identified same number of positive gene_sets in the simulated dataset the results suggest that mgsz with permutation_test is applicable to gene_expression with sample_size as small as three improved visualization of scoring_function profiles of a gene_set the most significant gene_set reported by wks in the case of mgsz ks and wks revealed a major pitfall in ks based_methods not seen in the original visualization used by section based on the results of our evaluation we therefore propose i use of gsz scoring_function instead of max mean statistics in gsa ii implementation of both gene and sample permutation in competitive gene_set and iii use of asymptotic p values for the methods based on gsz mgsa mallez and sum these improvements are implemented in our r package mgsz mgsz takes about min for a gene_set data with gene_sets and p data with permutations in mac book pro 
