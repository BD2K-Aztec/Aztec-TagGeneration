error filtering pair assembly and error_correction for next_generation reads motivation next_generation produces vast_amounts of data with errors that are difficult to distinguish from true biological_variation when coverage is low results we demonstrate large_reductions in error frequencies especially for high_error reads by three independent means i filtering reads according to their expected number of errors ii assembling overlapping read_pairs and iii for amplicon reads by exploiting unique_sequence abundances to perform error_correction we also show that most published paired_read assemblers calculate incorrect posterior quality_scores availability_and these methods are implemented in the usearch package binaries are freely_available atnext generation sequencing ngs machines produce reads of lengths tens to thousands of bases in an ngs read the base call at position i is assigned an estimated error probability p i represented as an integer rounded phred quality_score q i log p i typical base call error_rates for current machines range from to when coverage is high error_detection and correction can be achieved by aligning_reads to each other de_novo or to a closely_related well known sequence reference based assembly when coverage is low or a complete set of reference_sequences is not available sequencing_error is difficult to distinguish from true biological_variation errors can be reduced by quality filtering i e by discarding or truncating reads with low quality base calls by merging overlapping paired_end and in the case of amplicon reads by clustering quality filtering is often used in data analysis of next generation reads but is rarely regarded as a method in its own right which should be designed and validated as a separate step published_methods for quality filtering typically use ad_hoc criteria such as imposing a maximum on the number of bases with less than a given q score that article focuses on filtering but does not attempt to measure error_rates other articles_describing analysis_pipelines for amplicon reads e g report the mean error_rate but do not consider the tail of the error_distribution which we believe to be important due to the spurious clusters and consequent inflated estimates of diversity spurious rare biosphere obtained when the tail is not adequately controlled when paired_end overlap an improved_prediction of the sequence in the overlapping region can be obtained by aligning the forward and reverse read previously_published paired_read mergers include shera flash pandaseq cope and pear of these only pandaseq included quality filtering in addition to merging error_correction methods for amplicon pyrosequencing reads include pyronoise ampliconnoise and an unnamed method that uses a greedy_algorithm based on an abundance sort these methods all require flowgrams and therefore cannot be applied to other technologies such as illumina single_linkage pre clustering and the pre clustering method of also use abundance differences between closely_related sequences to correct errors in this work we use the expected number of errors in a read as a measure of quality for filtering and show that this method is effective at reducing error_rates especially in the tail of the distribution we show how to calculate the posterior quality_scores when read_pairs are merged and demonstrate that most previous merging methods calculate incorrect scores we also describe and validate unoise a new amplicon error correction_method which can be applied to any type of ngs read we introduced the expected number of errors as measure of read quality we showed that imposing a maximum value on expected errors is an effective quality filter we showed that most current paired_read mergers do not correctly calculate the posterior quality_scores and that pandaseq will align unrelated random pairs potentially causing a high rate of false_positive merges in biological data we suggest that measurements of q score accuracy and the correlation of e with the true error_rate should be a standard step in anyfwd indicates forward reads only method is one of raw_reads no processing unoise qiime f qiime quality filtering only merged merge by usearch only no filtering usearch f usearch filtering by e max usearch mf usearch merge and filtering by e max pandaseq merging and filtering with default_parameters and qiime mf qiime quality filtering of reads merged by usearch reads is the number of reads after any merging and or filtering err rate is the number of measured errors divided by the total number of bases and errs gives the number of reads with at least measured errors unoise assumes amplicon data so is not applicable to phix reads that were predicted to be chimeric by uchime were discarded prior to this analysis because chimera detection is a specialized task and chimeras account for a large majority of the unique amplicon sequences obscuring the underlying biological_diversity the reads contain species plus a few contaminants edgar ab is minimum abundance all reads singletons discarded den is n no denoising or y unoise reads is the number of reads after processing uniques is number of unique read sequences after processing and otus is the number of clusters at identity made by running uclust on the unique_sequences sorted by decreasing abundance next generation read analysis where q scores are used especially when coverage is low this will enable informed setting of parameters such as the e max threshold with illumina amplicon_sequencing a control sample such as a mock community would be ideal but the additional_cost and effort may be prohibitive however a phix spike in is often added to amplicon libraries before illumina_sequencing and our results here show that phix reads can function as an informative control sample for q score analysis we suggest the default value e max as a filtering threshold as the most probable number of errors is zero for the filtered reads more or less stringent thresholds may be appropriate to correct for biases in the q scores or to make trade_offs between sensitivity and error_rate in downstream_analysis we believe that these methods will enable improved accuracy of biological inferences in a broad range of ngs experiments conflict of interest none declared 
