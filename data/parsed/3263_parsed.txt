sequence_analysis nhmmer dna homology_search with profile_hmms sequence database_searches are an essential part of molecular_biology providing information about the function and evolutionary_history of proteins rna_molecules and dna sequence_elements we present a tool for dna dna_sequence comparison that is built on the hmmer framework which applies probabilistic_inference methods based on hidden_markov to the problem of homology_search this tool called nhmmer enables improved detection of remote dna homologs and has been used in combination with dfam and repeatmasker to improve annotation of transposable_elements in the human_genome availability nhmmer is a part of the new hmmer release source_code can be downloaded from http hmmer org hmmer is freely licensed under the gnu gplv and should be portable to any posix compliant operating system including linux and mac os x a widely used general_purpose tool for dna dna_sequence comparison is blastn which heuristically approximates the smithwaterman_algorithm for recognizing local_regions of similarity between two sequences in recent_years most advances in dna dna comparison have related to accelerating search for near exact_matches and to improving wholegenome alignment another area that deserves attention is the development of methods that maximize the power of computational sequence comparison tools to detect remote homologies profile_hidden profile_hmms represent an important advance in terms of sensitivity of sequence searches for remote homology they provide a formal probabilistic_framework for sequence comparison and improve detection of remote_homologs by i enabling position specific residue and gap scoring based on a query profile and ii calculating the signal of homology_based on the more powerful forward_backward hmm algorithm that computes not just one best scoring alignment but a sum of support over all possible alignments in the past this improved_sensitivity came at a significant computational_cost but recent_advances in hmmer have increased speed for protein search by fold reaching blastp like speed through a combination of filtering heuristics and computer engineering tools based on profile_hmms have historically focused on protein search with little concentration on the challenges presented by i chromosome length target_sequences and ii the extreme composition bias often seen in genomic_dna with attention to the details of dna search nhmmer builds upon the speed advances of hmmer bringing the power of profile_hmms to dna homology_search at speeds nearly as fast as blastn with sensitive settings an example of a biological problem requiring sensitive detection of remote dna homologs is the annotation of genomic_sequence derived from ancient transposable_element te expansions a prerelease version of the nhmmer tools has recently been shown to provide increased sensitivity over blastn and other single_sequence search_methods with reduced false_discovery and reasonable runtime in searching for tes for example when nhmmer was used within the recently released repeatmasker an additional mb of the human_genome was reliably annotated as derived from tes the target_sequence with a fast ungapped viterbi alignment using a reduced precision way vector parallel approach windows around high_scoring ungapped alignments are subjected to a full gapped viterbi alignment to the model candidate alignments passing this filter then endure the full rigor of a forward_backward alignment to the query including application of a context dependent null_model to account for composition bias shared by the query and target for more details on the full acceleration pipeline see eddy and wheeler performance inwe consider the performance of nhmmer on a benchmark called rmark that has been used previously to test the rna homology_search tool infernal the benchmark consists of families from rfam that could be divided_into two groups such that no sequence in one group is identical to any sequence in the other group rfam one group was used as the query alignment for the family and sequences from the other group sequences in total were embedded in mb of sequence simulated using a state hmm trained on genomic_sequence from a variety of organisms a positive was defined as an embedded sequence with length covered by a query from the same family a negative was defined as any hit that mostly covers simulated sequence for more details on construction of the benchmark see nawrocki and eddy in this benchmark we begin with an alignment of multiple members of a dna_sequence family and aim to find more instances of the family in the target_sequence database the standard methods for this homology_search problem e g using blastn involve searching the target_database with a single query_sequence either i producing a consensus_sequence to represent the sequence family then using the consensus as query to search the database or ii using the family pairwise fpw search method in which each individual sequence from the family alignment is used as a query the hit lists are merged and overlapping hits are adjudicated by recording the hit with the best e value using both of these single_sequence query approaches on rmark nhmmer achieves better sensitivity than blastn these single_sequence query methods do not however take full advantage of the information contained within the query alignment in nhmmer a profile hmm is built from the alignment and represents the residue and indel distributions for each position modeling the conservation patterns of the family in a way that is not possible with single_sequence queries the benefits of profile search are two fold i search power is much greater than even with fpw and ii search speed is roughly_equivalent to that of searching with a single consensus_sequence as only one search is performed for the entire_family rather than one for each sequence in the query alignment as in fpw in addition to being more sensitive than blastn nhmmer represents a nearly fold increase in speed over previous implementations of dna homology_search with profile_hmms for example using the seed alignment for dfam entry df a position long dna transposon to search against the human_genome with a single thread took nhmmer min to complete whereas hmmer completed in min and sam required min other applications hmmer s nhmmer has recently been adopted as a search_engine within the te annotation tool repeatmasker where in conjunction with dfam it supports a substantial boost in sensitivity in human dna repeat annotation with better speed than the previous most sensitive method the core pipeline of nhmmer has also been incorporated as an acceleration filter for the rna homology_search tool infernal where it supports fast filtering with negligible loss in infernal sensitivity e nawrocki and s r eddy unpublished_data we anticipate that nhmmer will similarly benefit other domains of dna_sequence comparison that depend on discriminative detection of remote_homologs benchmark of search sensitivity_and searches were performed against the rmark benchmark either by constructing a single profile hmm from the query alignment nhmmer profile constructing a consensus_sequence from the query alignment consensus or by using family pairwise search fpw the aborted lines for two nhmmer variants indicate that the list of all hits found by each search variant was exhausted before reaching false_positive per mb per search the nhmmer parameters were default except setting the e value threshold e for profile and consensus variants to extend the hit list higher e values have no effect as further hits true and false are filtered by the default acceleration heuristics many parameters were tested for ncbi blastn with the best performing variant shown here word size penalty reward gapopen gapextend for each combination of program and method hits for all families were collected and ranked by e value and true and false hits were defined as described in the text the y axis is the fraction of true_positives detected with an e value sufficient to achieve the false_positive specified on the x axis runtime was collected on a single thread on a ghz intel gainestown x processor the benchmark can be downloaded from http selab janelia org publications html 
