large_scale machine_learning for metagenomics sequence classification motivation metagenomics characterizes the taxonomic diversity of microbial_communities by sequencing dna directly from an environmental sample one of the main challenges in metage nomics data analysis is the binning step where each sequenced read is assigned to a taxonomic clade because of the large_volume of metagenomics datasets binning methods need fast and accurate algorithms that can operate with reasonable computing requirements while standard alignment_based provide state of the art performance compositional approaches that assign a taxonomic class to a dna read based on the k_mers it contains have the potential to provide faster solutions results we propose a new rank flexible machine_learning compositional approach for taxo nomic assignment of metagenomics reads and show that it benefits from increasing the number of fragments sampled from reference_genome to tune its parameters up to a coverage of about and from increasing the k_mer size to about tuning the method involves training machine_learning on about samples in dimensions which is out of reach of standard softwares but can be done efficiently with modern implementations for large_scale machine_learning the resulting method is competitive in terms of accuracy with well established alignment and composition based tools for problems involving a small to moderate number of candidate species and for reasonable amounts of sequencing_errors we show however that machine_learning compositional approaches are still limited in their ability to deal with problems involving a greater number of species and more sensitive to sequencing_errors we finally show that the new method outperforms the state of the art in its ability to classify reads from species of lineage absent from the reference_database and confirm that compositional approaches achieve faster prediction times with a gain of times with respect to the bwa mem short read_mapper depending on the number of candidate species and the level of sequencing noise availability_and data and codes are available atrecent progress in next_generation allow to access large_amounts of genomic_data within a few hours at a reasonable cost in metagenomics next_generation is used to analyze the genomic content of microbial_communities by sequencing all dna present in an environmental sample it gives access to all organisms present in the sample even if they do not grow on culture_media and allows us to characterize with an unprecedented level of resolution the diversity of the microbial realm the raw output of a metagenomics experiment is a large set of short dna_sequences reads obtained by high_throughput of the dna present in the sample there exist two main approaches to analyze these data corresponding to slightly different goals on the one hand taxonomic_profiling aims to estimate the relative_abundance of the members of the microbial_community without necessarily assigning each read to a taxonomic class recent works like wgsquikr or gasic proved to be very efficient for this purpose taxonomic_binning methods on the other hand explicitly assign each read to a taxonomic clade this process can be unsupervised relying on clustering_methods to assign reads to several bins i e clusters or supervised in which case reads are individually assigned to nodes of the taxonomy while binning is arguably more challenging than profiling it is a necessary step for downstream applications which require draft_genome reconstruction this may notably be the case in a diagnostics context where further analyses could aim to detect pathogen microorganisms or antibiotic resistance_mechanisms in this article we focus on the problem of supervised taxonomic_binning where we wish to assign each read in a metagenomics sample to a node of a pre defined taxonomy two main computational strategies have been proposed for that purpose i alignment based_approaches where the read is searched against a reference_sequence database with sequence_alignment tools like blast or short_read tools e g bwa and ii compositional approaches where a machine_learning model such as a naive_bayes nb classifier or a support_vector svm is trained to label the read based on the set of k_mers it contains recently a very fast compositional approach using long k_mers and not based on machine_learning called kraken has also been proposed since the taxonomic_classification of a sequence by compositional approaches is only based on the set of k_mers it contains they can offer significant gain in terms of classification time over similaritybased approaches training a machine_learning model for taxonomic_binning can however be computationally_challenging indeed compositional approaches must be trained on a set of sequences with known taxonomic labels typically obtained by sampling error_free fragments from reference_genomes in the case of nb classifiers explicit sampling of fragments from reference_genomes is not needed to train the model instead a global profile of k_mer abundance from each reference_genome is sufficient to estimate the parameters of the nb model leading to simple and fast implementations on the other hand in the case of svm and related discriminative methods an explicit sampling of fragments from reference_genomes to train the model based on the k_mer content of each fragment is needed which can be a limitation for standard svm implementations for example sampled approximately fragments from genomes to train a structured svm based on a k_mer representation with k and reported an accuracy competitive with similarity based_approaches increasing the number of fragments sampled to train a svm may improve its accuracy and allow us to investigate larger values of k however it also raises computational challenges as it involves machine learning_problems where a model must be trained from potentially millions or billions of training examples each represented by a vector in dimensions for e g k in this work we investigate the potential of compositional approaches for taxonomic label assignment using modern largescale machine_learning we propose a new rank flexible compositional approach trained with large_scale machine_learning and assess its performance in different situations we show that it provides an interesting trade_off in speed and accuracy compared to the state of the art particularly when confronted to species absent from the reference_database and for a moderate number of candidate species in this work we investigate the potential of modern large_scale machine_learning for taxonomic_binning of metagenomics_data and propose a new rank flexible classification strategy abundance profiles_obtained with vw a and kraken b on the hmp spiked dataset abundance profiles are presented at the genus level with colors corresponding to the different predicted species restricted to species accounting for at least of the samples light gray fractions of the bars correspond to genus level predictionswe extensively evaluate its performance when the scale of the problem increases regarding i the length of the k_mers considered to represent a sequence ii the number of fragments used to learn the model and iii the number of candidate species involved in the reference_database we also investigate in details its robustness to sequencing_errors using simulated reads we consider three baselines for this evaluation a comparative_approach based on the bwa mem sequence aligner and two compositional approaches based on the generative nb classifier and based on kraken we demonstrate in particular that increasing the number of fragments used to train the model has a significant impact on the accuracy of the model and allows to estimate models based on longer k_mers while this could be expected and was already highlighted by previous_studies the resulting configurations are out of reach of standard svm implementations we also show that discriminatively trained compositional models usually offer significantly_higher performances than generative nb classifiers the resulting models are competitive with well established alignment tools and with kraken for problems involving a small to moderate number of candidate species and for realistic amounts of sequencing_errors our results suggest however that machine_learning compositional approaches both discriminative and generative are still limited in their ability to deal with problems involving more than a few hundreds species in this case indeed compositional approaches exhibit lower performance than alignment based_approaches and are much more negatively_impacted by sequencing_errors when confronted with species absent from the training_set we show that our model is more accurate than kraken which has a larger level of rejection due to its use of longer k_mers and affects more reads too specifically to species of the reference dataset finally we confirm that compositional approaches achieve faster prediction times this is indeed systematically the case in the various configurations listed above with predictions obtained times_faster by compositional approaches and interestingly depends on the number of candidate species we note in particular that for problems involving fewer than candidate species which may arise in diagnostic applications involving specific types of specimens vw can achieve faster prediction times than kraken at the extreme for the binary problem aiming to separate bacterial from human reads which is commonly used while analyzing a microbiome sample vw can offer a fold increase in terms of prediction time with respect to kraken we emphasize however that fast predictions can only be obtained provided that the classification_models are loaded in memory hence for a memory_footprint that scales linearly with the number of candidate species and exponentially with the size of the k_mers which can become important for large reference_databases and long k_mers at least three simple extensions could be envisioned to make compositional approaches more competitive in accuracy with the alignment based_approach faster and to limit their memory_footprint first the robustness to sequencing_errors may be improved by learning models from simulated reads instead of fragments this could indeed allow to tune the model to the sequencing_technology producing the reads to be analyzed provided its error_model is properly known and characterized second introducing a sparsity inducing penalty while learning the model would have the effect of reducing the number of features entering the model hence to reduce the memory_footprint required to load the model into memory finally alternative_strategies known as error_correcting tournaments could be straightforwardly considered to reduce the number of models to learn hence to store into memory during prediction to address a multiclass problem our results indeed suggest that addressing these issues is critical to build state of the art compositional classifiers to analyze metagenomics samples that may involve a broad_spectrum of species 
