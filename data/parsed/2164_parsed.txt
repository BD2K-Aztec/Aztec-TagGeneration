haplotype_assembly in polyploid genomes and identical by descent shared tracts motivation genome_wide haplotype reconstruction from sequence_data or haplotype_assembly is at the center of major challenges in molecular_biology and life_sciences for complex eukaryotic_organisms like humans the genome is vast and the population samples are growing so rapidly that algorithms processing high_throughput sequencing_data must scale favorably in terms of both accuracy and computational_efficiency furthermore current models and methodol ogies for haplotype_assembly i do not consider individuals sharing haplotypes jointly which reduces the size and accuracy of assembled haplotypes and ii are unable to model genomes having more than two sets of homologous_chromosomes polyploidy polyploid organisms are increasingly becoming the target of many research groups interested in the genomics of disease phylogenetics botany and evolution but there is an absence of theory and methods for polyploid haplotype reconstruction results in this work we present a number of results extensions and generalizations of compass graphs and our hapcompass framework we prove the theoretical complexity of two haplotype_assembly optimizations thereby motivating the use of heuristics furthermore we present graph theorybased algorithms for the problem of haplotype_assembly using our previously_developed hapcompass framework for i novel implementations of haplotype_assembly optimizations min imum error_correction ii assembly of a pair of individuals sharing a haplotype tract identical by descent and iii assembly of polyploid genomes we evaluate our methods on genomes_project pacific_biosciences and simulated sequence_data the genome_sequence of a human individual can be modeled as pairs of sequences of four nucleotide_bases a c g and t representing the pairs of autosomes and the sex_chromosomes however of any two individuals genome_sequences is shared within a population the of the nucleotide_bases varying within a population range from single_nucleotide snps to more complex structural changes for example deletions or insertions of genomic material a sequence of genomic_variants typically snps with the non varying dna removed is referred to as a haplotype standard genome_sequencing workflows produce contiguous dna_segments of an unknown chromosomal origin de_novo assemblies for genomes with two sets of chromosomes diploid or more polyploid produce consensus_sequences in which the relative haplotype phase between variants is undetermined the set of sequencing_reads can be mapped to the phase ambiguous reference_genome and the diploid chromosome origin can be determined but without knowledge of the haplotype sequences reads cannot be mapped to the particular haploid chromosome sequence as a result reference based genome_assembly algorithms also produce unphased assemblies however sequence_reads are derived from a single haploid fragment and thus provide valuable phase_information when they contain two or more variants the haplotype_assembly aims to compute the haplotype sequences for each chromosome given a set of aligned sequence_reads to the genome and variant information the haplotype phase of variants is inferred from assembling overlapping sequence_reads halldorsson the input to the haplotype_assembly is a matrix m whose rows correspond to aligned read fragments and columns correspond to snps the quality of ms construction depends on the parameters of the sequencing workflow and the accuracy of the read alignment_algorithms misaligned read fragments can introduce erroneous base calls or sampling_biases so the careful alignment of sequence_reads is necessary for highquality haplotype assemblies without read_alignment or sequencing_errors the haplotype_assembly can be solved in time linear in the size of m by partitioning the fragments in two sets whereby no fragments internal to a set share an snp and differ in the allele called to address erroneous base calls or misplaced alignments three primary haplotype_assembly optimizations have been developed minimum error_correction mec minimum snp removal msr and minimum fragment removal mfr the goal is to convert m into a state such that the fragments rows of m can be distributed into two sets corresponding to the two haplotypes all fragments in a set must agree on the allele at each snp site and this is accomplished using the minimum number of snp allele flips to or vice_versa mec snp columns of m removals msr or fragment rows of m removals mfr provide a theoretical_foundation for the mfr and msr optimizations and describe the fundamental snp and fragment conflict graph structures the first widely available haplotype_assembly software_package was presented inin which the authors describe the fast hare algorithm which optimizes the min element removal problem which permits non commercial re use distribution and reproduction in any medium provided the original_work for commercial re use please_contact permissions_oup com a set of likely haplotypes under the mec optimization in a follow_up the authors present a much faster algorithm on a related graph_model that relates maximum cuts to snp allele flips in the mec model still other authors have suggested reductions to the well known maximum satisfiability problem the levy et_al algorithm is a well known heuristic that was used to haplotype assemble the huref genome it assigns fragments to haplotypes in a greedy fashion and iteratively refines the solution by comparing the set of fragments to the assembled haplotypes using majority rule phasings in a recent survey geraci describes thealgorithm as arguably the best performing algorithm tested the first extension of the haplotype_assembly that addressed the simultaneous assembly of multiple diploid chromosomes was presented in however the benefits of multi haplotype_assembly are not clear for a set of unrelated_individuals continued development of this theory by describing methods for assembling individuals who share a haplotype identical by descent ibd using relationships among the reads aguiar and istrail introduced a new graph data_structure algorithmic framework and the minimum weighted edge removal mwer optimization which together have several advantages over existing_methods recall that the rows of m correspond to sequence_read fragments with the non polymorphic bases removed such that only snps remain the hapcompass model defined inis composed of the compass graph g c core data_structure which summarizes the rows of m using edges weights and the mwer optimization that aims to remove a minimum weighted set of edges from g c such that a unique phasing may be constructed the algorithm operates on the spanning tree cycle basis of g c to iteratively remove errors that are manifested through a particular type of simple cycle mac in this work we prove a number of theoretical results for the previously described mwer optimization on compass graphs the main_result proves mwer is np_hard and motivates the use of our heuristic_algorithms further we demonstrate how extensions to the generalized diploid hapcompass model can enable i usage of different optimizations for example mec and mwer to be used in the local optimization step ii simultaneous assembly of two individuals sharing a haplotype tract ibd and iii haplotype_assembly of a single polyploid organism finally we evaluate our methods on genomes_project pacific_biosciences and simulated_data diploid haplotype inference is still a difficult_task in part due to the exponentially many solutions given the input genotype or sequence_reads hapcompass is a proven framework for haplotype_assembly but there are a number of extensions that may improve results for instance we did not mention the usage of base call or read_mapping quality_scores in our computations hapcompass can filter_based on user_defined thresholds but a more elegant solution would be to convert the base call quality_score for a particular allele call into a probability the base was called correctly this probability can then define the contribution of weight to the edges of g c rather than the current weight contribution of for each snp allele called also we demonstrated in the pacific_biosciences experiments that the choice of assembly method should be informed by the sequencing_technology and desired result the levy et_al method mappedmore fragments error_free than hapcompass but contained many more single base changes in fragments required to reproduce the inferred haplotypes considering the pacific_biosciences data has high_error and generating an error_free read is unlikely a solution with the minimum number of corrected errors is likely preferred over a solution that successfully maps more fragments without errors the size of the haplotype_blocks produced and ultimately the quality of the assembled haplotypes is a function of several factors the primary difficulty for obtaining large haplotype_blocks is the small nature and lack of diversity of insert lengths we demonstrated a novel modeling and computational_method that begins to address this difficulty by exploiting shared ibd haplotype_structure in general assembling the haplotypes of related individuals has considerable benefits which help overcome undesirable properties of the sequencing_data the first benefit comes from the extra coverage on the shared haplotype which helps in differentiating actual phasings from sequencing_errors however the most notable advantage is being able to include more snps into the haplotype_assembly which helps extend the assembly past regions of low read_coverage for example but the major advances in block sizes will likely be the result of novel experimental_procedures and technologies for instance not only do the single_molecule sequencers promise larger read_lengths they also enable the inclusion of multiple and large insert lengths organisms having more than two sets of homologous_chromosomes are becoming the target of many research groups interested in studying the genomics of disease phylogenetics and evolution polyploidy occurs in human disease usually due to the duplication of a particular chromosome for example in edwards patau and down syndrome while far fewer mammalian organisms are polyploid specific mammalian_cells may undergo polyploidization for example in human liver hepatocytes in addition polyploid organisms are ubiquitous in the plant and fungi clades present in crops that we ingest convert into bioenergy and feed to livestock understanding the genomics of both the desirablee g increased crop yieldand undesirablee g susceptibility to diseaseproperties of plants may lead to critical advances in many research_areas but requires untangling the polyploid genome and its variation as more polyploid data becomes available our approach may be used to infer haplotypes and begin to understand what effects haplotype variation may influence 
