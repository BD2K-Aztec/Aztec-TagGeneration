resolving complex tandem_repeats with long_reads motivation resolving tandemly_repeated genomic_sequences is a necessary step in improving our understanding of the human_genome short_tandem trs or microsatellites are often used as molecular_markers in genetics and clinically variation in microsatellites can lead to genetic_disorders like huntingtons diseases accurately resolving repeats and in particular trs remains_a in genome alignment assembly and variation calling though tools have been developed for detecting microsatellites in short_read sequencing_data these are limited in the size and types of events they can resolve single_molecule sequencing_technologies may potentially resolve a broader_spectrum of trs given their increased length but require new approaches given their significantly_higher raw error profiles however due to inherent error profiles of the single_molecule technologies these reads presents a unique challenge in terms of accurately identifying and estimating the trs results here we present pacmonstr a reference based probabilistic_approach to identify the tr region and estimate the number of these tr elements in long dna_reads we present a multistep approach that requires as input a reference region and the reference tr element initially the tr region is identified from the long dna_reads via a stage modified smithwaterman approach and then expected number of tr elements is calculated using a pair hidden_markov modelsbased method finally tr based genotype selection or clustering homozygous heterozygous is performed with gaussian_mixture using the akaike information criteria and coverage expectations availability_and https github com alibashir tandem_repeats trs are contiguous regions of dna in which the same or highly_similar dna_sequences are repeated multiple times in order trs can range in size from single nucleotide repeats homopolymers to encompassing entire genes short_tandem trs of bp or microsatellites are often used as molecular_markers in genetics or in forensic applications veselinovic veselinovic clinically variation in microsatellites is observed in many genetic_disorders triplicate cag_repeat expansions have been implicated in a number of neurological_disorders including exonic expansions in huntingtons disease and spinocerebellar_ataxia and non coding expansions in fragile_x microsatellite_instability has also been used as a marker of cancer_progression additionally microsatellites are implicated in regulatory_roles they have been shown to be highly_conserved near transcription_start and are sometimes known to modulate gene_expression despite their importance trs are often ignored because accurate resolution of trs in both variation and assembly settings remains_a with the availability of high_quality genomes a number of tools were developed specifically for tr resolution tools like tandem_repeat finder trf attempt to detect such repeats de_novo trf has a detection phase that looks for statistically_significant k_mer matches within sliding_windows and an analysis phase which determines period size multiplicity and consensus repeats other methods have used clustering based_approaches t reks and local autocorrelation tandemswan respectively to attempt to identify more divergent and complex trs sometimes termed fuzzy tandem_repeats this increased sensitivity comes at the cost of increased runtime and higher false_positive other methods such as repeatmasker can then be used to screen entire genomes using known databases of trs and other repeat elements identified by such de_novo tools tarailo the advent of low_cost sequencing over the past_decade has made cataloguing genomic_variation cost_effective across individuals robust tools have been created for short_read singlenucleotide polymorphism snp and indel detection as well as completely integrated end_to pipelines these methods have proven highly_accurate in calling snps in diverse populations additionally these technologies have been used to enumerate more complex copy_number and copy neutral forms of structural_variation sv similarly a number of excellent tools have become available for detecting microsatellites in short_read sequencing_data some of these methods rely on databases of known trs such as those generated by trf across a genome_sequence or a curated list of known variable tr intervals and look at spanning reads short_reads which span to whom correspondence should be addressed the author published_by all_rights for permissions please email journals permissions_oup com the repeat to call tr alleles for a given individual given the length of the reads being analyzed these methods are limited in the multiplicity and or period size of trs that can be resolved even when they take into account more complex mate pairing information more recently methods have arisen to detect such repeats de_novo using short_read doi et_al s study uses depth of coverage_information on tagged trs to estimate tr multiplicity in repeats longer than the size of a single short_read in the past_few third_generation have arisen that offer substantially improved read_lengths single_molecule real_time smrt_sequencing from pacific_biosciences pacbio creates continuous sequence_reads ranging from several kb to tens of kb in length these reads have been shown to allow dramatic_improvements in genome_assembly haplotype_phasing and sv applications although they are obvious candidates for broadening the scope of detectable trs the unique error profile and higher raw error_rate necessitate new approaches for accurate resolution of tr multiplicities here we present pacmonstr a tool for the detection and resolution of trs specifically optimized for raw single_molecule sequencing_data pacmonstr attempts to build on the ideas of previous reference based_approaches to best capture the idiosyncratic features of single_molecule sequencing_data the method provides the following improved boundaries of spanning trs by performing a more sensitive tr specific dynamic_programming alignment statistical estimates of tr multiplicity using a pair hidden_markov pairhmm predictions of heterozygosity and homozygosity with consensus_sequences when multiple spanning reads exist predictions of boundaries for compound structural_variants within or around a tr interval using simulated and real sequencing_data compared with the hg build of the human_genome we compare the performance of our methods and de_novo approaches in terms of detecting trs and estimating multiplicity clustering performance is assessed using known homozygous and synthetic heterozygous tr sequences lastly we simulate the introduction of sv into tr intervals to show the ability of the tool to flag non tr intervals and apply the sv_detection approach on real_data we have presented an approach for reference based tr detection that is specifically adapted for long_reads with high insertion_deletion error_rates the method substantially outperforms de_novo approaches both in detection and resolution of events additionally the probabilistic pairhmm not only provides an even tighter prediction of tr multiplicities on raw_reads it can also be used to infer structural_variants within or immediately flanking a tr region despite meeting these goals pacmonstr and the simulations used to evaluate it have a number of limitations and areas where further improvements can be made validation of clustering accuracy is an issue that may need to be addressed on a genome by genome or repeat by repeat level we attempted to model this by using real haploid genome_sequences and creating synthetic heterozygous trs from disparate genomic_regions of the genome in real diploid data however one does not know if a region is truly heterozygous an alternative approach for evaluating calls is to identify snvs indels and svs upstream and downstream of a called tr once tr multiplicities are predicted for each read and clustering assignment has occurred one can evaluate concordance of flanking variant alleles with the tr clustering assignment of raw_reads to determine_whether they form a consistent haplotype the high error profile of smrt_sequencing on a per read basis could make accurate snp assignment challenging however as the read_lengths continue to expand it has been shown that multiple_snps and svs captured within a single long_read could create a stronger statistical signal to validate phasing ideally this haplotype_information can be incorporated into the clustering process in addition to the estimated tr multiplicity to more robustly separate tr alleles with small periods or with small multiplicity differences given the quadratic runtime for the pairhmm if read_lengths continue to improve into the hundreds of thousands of base_pairs the runtime of the algorithm may become unwieldy in real_world scenarios however the pairhmm is not required to accurately resolve multiplicity for most trs for largeperiod trs the modified prefix repeat suffix dynamic program provides nearly identical results at substantially faster speeds although the dp runtime grows linearly as the period size increases and may also become prohibitively large faster banded heuristics become viable with large periods many small period trs can be resolved in the clustering phase without requiring the pairhmm if two alleles are highly dissimilar even if read toread variation is high it is likely that they still will form distinct clusters once clusters are identified and consensus_sequences are generated trs can be identified directly from the consensus thus the full pairhmm can be restricted for scenarios where accurate resolution is required on short period repeats for which clear clustering cannot be performed the proposed and related approaches are reliant on predetermined locations of trs in the reference as input this limits the generalizability of the method but can be alleviated by preprocessing the data with other de_novo and structural variant tools showed that trf was often able to detect repeats from the raw_reads in practice the algorithm can be run on all raw_data to seed potential repetitive positions in the queries these positions can be projected back onto the reference to identify candidate intervals for novel tr events reads spanning these positions of interest can then be interrogated by running the full pairhmm on the set of trs predicted in the interval as multiple consensus repeats will likely be identified the one yielding highest probability can be selected for clustering analysis additionally some sv tools like delly allow for detection of novel trs using reference coordinates that can similarly be passed into the method just as we can inform de_novo tr calling by integrating other tools we can similarly use our approach to help inform compound structural events_involving trs inwe demonstrated the methods ability to reliably identify inserted sequence within a tr element sv elements observed on chromosome were often tr expansions such as in these sometimes existed at tr boundaries suggesting potential refinements may be needed to the initial dp algorithm to better distinguish tr intervals from prefix and suffix sequences additionally svs may not always represent a distinct sequence block the predicted consensus periods for a tr within an individual have been shown to diverge from the expected tr consensus especially in the case of compound trs where smaller repetitive units are grouped within a larger repeating_unit although these can be more easily seen once a consensus is generated local fluctuations in pairhmm probabilities can inform when such slight deviations in tr consensus are occurring periodically across a tr interval as alternative sequencing_platforms become available algorithms are needed that are able to harness the unique features of each technology for any technology even as the cost per base decreases one must always make a choice between higher sequencing_depth and larger numbers of samples this decision is tied to the experimental goals of the project as well as the relative precision of a technology at different sequencing_depths in the context of trs our method provides informative guidelines for tr resolution given the type and size of the desired repeat by allowing single_read calls and providing a probabilistic_framework for evaluating these calls the method is immediately applicable even at low depth making it a useful option given the platforms comparatively_higher cost while also enabling potential applications in heterogeneous_cell as observed in cancer integrating raw read tr resolution with robust consensus calling will continue to make the approach applicable for the type of high depth studies that will soon be feasible as these technologies mature and become used by the broader research_community 
