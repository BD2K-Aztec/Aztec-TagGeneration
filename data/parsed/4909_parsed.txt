wemiq an accurate and robust isoform quantification_method for rna_seq motivation the deconvolution of isoform_expression from rna_seq remains_challenging because of non uniform read sampling and subtle differences among isoforms results we present a weighted log_likelihood expectation_maximization method on isoform quan tification wemiq wemiq integrates an effective bias removal with a weighted expectation maxi mization em_algorithm to distribute reads among isoforms efficiently the weight represents the oversampling or undersampling of sequence_reads and is estimated through a generalized poisson_model without any presumption on the bias sources and formats wemiq significantly_improves the quantification of isoform and gene_expression as well as the derived exon_inclusion rates it provides robust expression estimates across different laboratories and protocols which is valuable for the integrative_analysis of rna_seq for the recent single_cell wemiq also provides the opportunity to distinguish bias heterogeneity from true biological_heterogeneity and uncovers smaller cell to cell expression variability availability_and wemiq can be downloaded fromthe rapid advances in high_throughput technologies_provide us an opportunity to dissect transcriptomes with unprecedented_resolution based on rna_seq studies alternative_splicing has become more and more appreciated as a key mechanism in higher_eukaryotes to expand transcriptomes by generating multiple_isoforms from a single gene for example it has been reported that up to of human multi exon genes undergo alternative_splicing therefore an accurate quantification of transcript_isoforms is important to understand gene_regulation through alternative_splicing however the accurate estimation of transcript isoform_expression from rna_seq remains a challenge many state of the art approaches initially assumed that short_sequence in rna_seq were uniformly sampled from each transcript however the position level read_count often demonstrates larger variation than expected under the uniform sampling assumption and shows enormous inter gene and intra gene bias heterogeneity as a result read_counts need to be adjusted in a dynamic way for the abundance quantification add on functions have been introduced to handle the overdispersion in the methods of isoform_expression estimation these methods usually assumed a constant bias factor for each relative_position of genes or simply corrected the sequence specific bias caused by random hexamer priming however the overall bias is complicated and caused by multiple factors including many unknown ones and the bias pattern can vary significantly across different regions and different protocols in light of these facts previously we proposed to use the generalized poisson gp model to estimate the bias in a data adaptive way without any presumption however this has not yet been integrated into the isoform_expression deconvolution in this article we propose a robust isoform_expression quantification_method weighted log_likelihood expectation_maximization isoform quantification wemiq given gene_annotation wemiq can accurately quantify rna products at both the gene and transcript_isoform level from rna_seq wemiq uses the expectation_maximization em strategy to distribute reads among different isoforms and incorporates the fragment length information of paired_end more importantly bias in rna_seq is corrected by assigning different weights to reads from different gene regions when calculating the weighted log_likelihood the weighted loglikelihood approach_enables efficient isoform_expression deconvolution with appropriate bias removal to demonstrate the effectiveness of our method we applied wemiq to both simulated_and sets simulation_studies show that in both transcript_isoform centric and exon centric quantification our approach significantly_outperforms the state of theart software such as cufflinks rsem and splicetrap cufflinks and rsem quantify isoform_expression while splicetrap quantifies exon_inclusion rates in an exon centric way unlike other simulation_studies which generated_reads based on the uniform assumption or based on a pipeline in consideration of only a few bias factors our simulations generated_reads with various bias patterns to mimic the real situation analyses on a variety of real rna_seq data_sets also show that our bias correction is more effective our expression quantification is more accurate and the expression estimates are more robust across different laboratories and different protocols for the application to the recent single_cell interestingly we found that compared with population cell rna_seq single_cell usually exhibits a larger bias variation across different genes or different regions of the same gene and wemiq meets the challenges by separating bias heterogeneity from true biological_heterogeneity by obtaining smaller but still significant cell to cell variability sequencing bias during rna_seq experiments hinders the deconvolution of transcript isoform_expression because the expression heterogeneity caused by multiple_isoforms of the same gene is mixed with that caused by different biases for different regions hence isoform level expression estimation from rna_seq experiments is still a challenging_problem and lines of methods were proposed for more accurate quantification we previously_developed a hierarchical_bayesian basis to identify differentially isoforms without quantifying the absolute isoform_expression for each condition however the estimation of the absolute expression levels of transcript_isoforms requires a more delicate handling of bias in rna_seq our gp based model can effectively separate bias from true expression signals however the simple integration of the gp probability mass function to the isoform deconvolution makes the computation infeasible wemiq targets the challenges of accurate isoform quantification by an efficient weighted log likelihood_based em_algorithm reads from different genomic_regions were assigned with different weights according to the degree of the sequencing bias the bias parameter was estimated in a data adaptive manner without any assumption about the bias source and format the weight assignment can be treated as a weighted sampling scheme to penalize or compensate oversampled or undersampled sequence_reads simulation_studies with simple and real gene structures demonstrated that wemiq significantly_improved the expression estimation from both the isoform centric and the exon centric perspectives under a variety of gene structures wemiq can handle the additional overdispersion caused by missing transcripts and thus provides more robust estimations over cufflinks and rsem when gene_annotation is incomplete besides we compared the overall gene_expression levels with other platforms such as the qrt_pcr results and wemiq showed an improved estimation it is worth mentioning that although qrt_pcr may not perfectly measure gene_expression it represents another independent platform with potentially different bias sources due to the lack of benchmark_dataset it is difficult to directly compare the isoform_expression measurements in addition to the improved estimation accuracy wemiq also provides very robust estimates based on the study of sub sampled reads from a real rna_seq data_set details in section of supplementary text s supplementary figs s and s on the other hand we should note that there may be some extreme gene structures with many isoforms and each of them containing only a few nucleotide_differences the power of isoform quantification for these cases is limited cufflinks and rsem the cv across single_cell is calculated and their empirical cumulative distribution functions are shown for a highly_expressed and b highly_expressed isoforms and waits for more advanced sequencing_technologies with more and longer sequence_reads we also applied our method on a variety of real rna_seq including the encode data from different laboratories and singlecell sequencing_data with very low input genetic materials results demonstrate that wemiq provides more robust expression estimation at both the gene and isoform level therefore wemiq may serve as a powerful_tool to make direct comparison across different experiments we also note that in the cross laboratory comparison the median fold_change was still higher than the ideal value of and could be as large as even for highly_expressed or isoforms since we simply used the total bias corrected reads to perform the normalization across samples additional improvements on the normalization may further help the cross laboratory analysis of rna_seq in addition we observed larger bias heterogeneity from single_cell than the population cell rna_seq which further complicated the exploration of true cell to cell expression variation due to the careful read weighting_scheme wemiq discovered smaller expression variability in single cells wemiq utilizes only reads that are uniquely mapped to the genome for the expression quantification for earlier rna_seq where the read_length is usually nucleotides or less it might be an issue to discard reads_mapped to multiple genomic_locations however with the development of sequencing_technologies for longer_reads the effect of discarding multireads could be small for majority genes in summary we propose wemiq to quantify gene_expression from the rna_seq with the transcript_isoform resolution it separates sequencing bias heterogeneity across different genomic_regions or different laboratories from expression heterogeneity due to different transcript_isoforms or different single cells wemiq can serve as a powerful quantification tool for transcriptomics 
