polytomy refinement for the correction of dubious duplications in gene_trees motivation large_scale methods for inferring gene_trees are error_prone correcting gene_trees for weakly supported features often results in non binary trees i e trees with polytomies thus raising the natural question of refining such polytomies into binary trees a feature pointing toward potential_errors in gene_trees are duplications that are not supported by the presence of multiple gene_copies results we introduce the problem of refining polytomies in a gene_tree while minimizing the number of created non apparent duplications in the resulting tree we show that this problem can be described as a graph_theoretical optimization_problem we provide a bounded heur istic with guaranteed optimality for well characterized instances we apply our algorithm to a set of ray_finned fish gene_trees from the ensembl_database to illustrate its ability to correct dubious duplications availability_and the c source_code for the algorithms and simulations described in the article are available atwith the increasing number of completely_sequenced the task of identifying gene counterparts in different organisms becomes more and more important this is usually done by clustering genes sharing significant_sequence constructing gene_trees and then inferring macro evolutionary_events such as duplications losses or transfers through reconciliation with the phylogenetic_tree of the considered taxa the inference of accurate gene_trees is an important step in this pipeline while gene_trees are traditionally constructed solely from sequence_alignments recent methods incorporate information from species phylogenies gene_order and other genomic footprint a large number of gene_tree databases are now available but constructing accurate gene_trees is still challenging for example a significant number of nodes in the ensembl gene_trees are labelled as dubious in a recent study we have been able to show that of ensembl gene_trees for the genomes of the fishes stickleback medaka tetraodon and zebrafish exhibit at least one gene_order inconsistency and thus are likely to be erroneous moreover owing to various reasons such as insufficient differentiation between gene sequences and alignment ambiguities it is often difficult to support a single gene tree_topology with high_confidence several support measures such as bootstrap values or bayesian posterior_probabilities have been proposed to detect weakly supported edges recently intense efforts have been put towards developing tools for gene_tree correction gorecki and eulenstein a b a natural approach is to remove a weakly supported edge and collapse its two incident vertices into one or to remove dubious nodes and join resulting subtrees under a single root the resulting tree is non binary with polytomies multifurcating nodes representing unresolved parts of the tree a natural question is then to select a binary refinement of each polytomy based on appropriate criteria this has been the purpose of a few theoretical and algorithmic studies conducted in the past_years most of them based on minimizing the mutation i e duplication and loss cost of reconciliation in the present article we consider a different reconciliation criterion for refining a polytomy which consists in minimizing the number of non apparent duplication nad nodes a duplication node x of a gene_tree according to the reconciliation with a given species_tree is a nad if the genome sets of its two subtrees are disjoint in other words the reason x is a duplication is not the presence of paralogs in the same genome but rather an inconsistency with the species_tree such nodes have been flagged as potential_errors in different studies in particular they correspond to the nodes flagged as dubious in ensembl gene_trees we introduce the polytomy refinement problem in section and we show in section how it reduces to a clique decomposition problem in a graph representing speciation and duplication relationships between the leaves of a polytomy we develop a bounded heuristic in section with guaranteed optimality in well characterized instances in section we exhibit a general_methodology using our polytomy refinement algorithm for correcting nad nodes of a gene_tree we then show in section that this approach is in agreement with the observed corrections of ensembl gene_trees from one release to another to whom correspondence should be addressed the author published_by this is an open_access the terms of the creative_commons http creativecommons org_licenses which permits non commercial re use distribution and reproduction in any medium provided the original_work for commercial re use please_contact permissions_oup comsimulated data simulations are performed as follows for a given integer n we generate a species_tree s with a random_number of leaves between n and n we then generate a forest f g g n of cherries by randomly picking for each cherry g i f one node s i s and two leaves one from each of the two subtrees rooted at s i any leaf of s is used at most once possibly by adding leafs to s if required leading to a set of cherries related through joins of type s or nad then for each pair fg i g j g with join type nad we relate them through ad with probability or do nothing with probability by adding a duplicated leaf for each pair s f we compared the number of nads found by algorithm minnadref with the minimum number of nads returned by an exact algorithm exploring all possible binary trees that can be constructed from f we generated a thousand random s and f for each n we stopped at n as the brute_force algorithm is too time costly beyond this point over all the explored datasets simulated as described above algorithm minnadref was able to output an optimal_solution i e a refinement with the minimum number of nads therefore the examples on which the heuristic fails seem to be rare and the algorithm performs well on polytomies of reasonable size we then wanted to assess how the nad minimization criterion differs from the rearrangement cost minimization criterion we generated random instances with forests of sizes ranging between and instances for each n we a b c d s g a gene_tree g and a species_tree s from which we obtain g by pushing x by multifurcation here x is a nad and is pushed by taking the forest of maximal subtrees of g that only have genes from species in the s l subtree green then another forest for the s r subtree red in the same manner both these forests are joined under a polytomy which are then joined under a common parent so the root of g is a speciation i the present work is dedicated to the polytomy refinement problem while the mutation cost of reconciliation has been used previously as an optimization criterion for choosing an appropriate binary tree here we use an alternative criterion which is the minimization of nads the tractability of the minnadref problem remains_open as is the problem to select among all possible solutions those leading to a minimum reconciliation cost although developing a gene_tree correction tool is not the purpose of this article we show how our algorithm for polytomy refinement can be used in this context by developing a simple_algorithm allowing to correct a single nad this algorithm has been applied to trees of a previous ensembl release and the corrected trees have been compared with the trees of the current ensembl release a good correlation between the two sets of trees is observed which tends to support our correction paradigm while minimizing nads cannot be a sufficient criterion for gene_tree correction it should rather be seen as one among others such as statistical syntenic or based on reconciliation with the species_tree that can be integrated in a methodological framework for gene_tree correction 
