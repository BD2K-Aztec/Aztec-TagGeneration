structural_bioinformatics fast alignment and comparison of rna_structures motivation to recognize remote relationships between rna_molecules one must be able to align structures without regard to sequence_similarity we have implemented a method which is swift o n sensitive and tolerant of large gaps and insertions molecules are broken into overlapping fragments which are characterized by their memberships in a probabilistic classification based on local geometry and h bonding descriptors this leads to a probabilistic similarity measure that is used in a conventional dynamic_programming method results examples are given of database_searching the detection of structural_similarities which would not be found using sequence_based and comparisons with a previously_published approach availability_and source_code c and perl and bin aries for linux are freely_available at www zbh uni hamburg de rna has diverse roles ranging from ligand_binding recognition to catalysis these functions depend not just on sequence but more on how a molecule positions groups in space this means that if one wants to detect functional_similarity one must be able to align molecules structurally we present a method for rna_structure alignment which seems to be sensitive reliable and with a running time comparable with sequence alignment_techniques one could also claim that in evolutionary terms structure is more conserved than sequence therefore structural searches and alignments will find relationships that would be missed at the sequence level if one allows for gaps and insertions the problem of structurally aligning two biopolymers is np complete there is however an abundance of methods developed for proteins using various approximations that usually provide reasonable_results typically these methods rely on some structural property specific to proteins for example most proteins can be reasonably characterized by their classic secondary_structure or their sequence of backbone angles or a contact_map based on c atoms in the case of rna there is far less prior art presumably because it is harder to describe and there is little consensus as to what constitutes a characteristic structural_motif in proteins common structures are rather well described by neglecting the backbone dihedral_angle and considering perhaps with additional hydrogen_bond information in rna one could consider six backbone angles and perhaps the dihedral_angle which captures the orientation of the base at the same time not all these descriptors are necessary as some of the angles are significantly correlated duarte and pyle took advantage of this fact and pointed_out that it may be more effective to define dihedral_angles based on atoms such as c and p atoms from successive bases even though they are not covalently connected using these angles as descriptors they defined structural_motifs with which they were able to reconstruct known rna_structures with surprisingly high_accuracy these descriptors also seemed to be sufficient for finding motifs in collections of known structures although there are methods for aligning rna based on secondary_structures there is a distinct paucity of methods that use d properties the approach implemented in arts uses the coordinates of phosphorus atoms and attempts to find and extend sets of atom pairs which can be superimposed below some threshold the alignment calculation relies on the recognition of secondary_structure this means the method implicitly has some thresholds but it has the advantage that the procedure is apparently fast enough to be used for searches of a structure against a database of known structures another approach is to label sites with some structural property or combined sequence structure property sites from different molecules can be compared with each other giving a score which can be used in a conventional dynamic_programming dial uses this approach and bases its score on sequence nine dihedral_angles and a measure to whom correspondence should be addressed of base_pairing sarsa by used four dihedral_angles to define a small structural alphabet this approach was revisited in iparts with a similar structural alphabet limited to the pseudotorsion angles and as defined by duarte and pyle sara follows an approach inspired by the mammoth programme for protein_structure the most recent approach setter divides rna_structures into non overlapping secondary_structure all of these methods are sensitive to the geometry of specific sites rather than larger pieces of structure in this work we have adapted a method from the protein literature but one with little preconception as to what constitutes a structural_motif instead one says that a structure is built from overlapping fragments of some length k in this work each fragment is described by a set of structural_descriptors angles distances and a measure of likelihood to be in a base_pair a large set of fragments from the protein_data pdb was then subjected to a maximally parsimonious bayesian classification yielding classes to use this for alignments one can take a fragment from a new molecule and calculate the probability that it is in class n class this vector of probabilities can be seen as a structural label for the site but more importantly the dot product of two such vectors is a direct measure of their similarity these dot products can be used directly in a score matrix for a dynamic_programming the similarity measure is a continuous property ranging from to therefore no thresholds are necessary calculating an optimal alignment has o n running time albeit with a larger pre factor than in sequence_alignments as we show below the method seems to produce rather high_quality alignments before considering structural_alignments one can look at a few properties of the underlying fragment classification this had classes although the largest classes covered just of the data the relative importance of the classes varied from down to of the original data as one would expect the most populated classes reflect common rna motifs for example the first two classes have similar helical structures and b and within statistical uncertainty they are geometrically indistinguishable they do however differ in the property which cannot be seen in the diagram the second class is distinguished by a much higher probability of being involved in h bonds the next most populated class also shows a common motif a hoogsteen pair in which a base_pairs with two other bases given the machinery for comparison we began with an all against all comparison within the set of chains from the pdb for each structure the alignments were sorted according to rmsd the runtime for a pairwise_comparison varied from less than a second to minutes the runtime for a typical alignment two transfer rnas trna of bases was seconds the most time consuming examples were naturally those between two ribosomal structures of several thousand nucleotides the biggest part of the computation time went into computing the h bond terms the times reflect a typical pc intel dual core ghz processor this number of comparisons produced a mass of data but we can show some interesting examples the most important application is finding homology which would not be detected using sequence_based in the case of proteins there are empirical_studies showing the significance of the degree of sequence_identity for proteins of residues one would require sequence_identity before regarding a pair of sequences as related for nucleotides the value must be higher owing to the smaller alphabet as an example of a structure pair shows the structural_alignment of det chain c and i v there is only sequence_identity but the rmsd difference is only a calculated over the aligned bases shows the best global sequence_alignment of the corresponding sequences a superposition based on this alignment has an rmsd of a essentially the correct alignment based on fries structural_alignment is completely missed with a sequence_based method it was also impossible to find this alignment with blast as the word size cannot be set less than four one can also find examples to show that the method can find small structures which are similar to parts of larger ones shows the example of chain p m and p p with an rmsd of a aligned residues in this and the angles used as descriptors are also labelledcase the sequence_identity is but a sequence_based method will only find the alignment if gap penalties are set low enough to allow a gap of residues as shown in the corresponding sequence_alignment in this work one set of gap penalties was used for all calculations a more targeted application is a classic structure search given some query rna_structure can one find related structures regardless of sequence_homology perhaps the clearest example comes from using a trna because this has been the most frequently solved structural family the results are summarized in the trna used as the query structure was tra and for each alignment one has the alignment_length sequence_identity from the structural_alignment and rmsd alignments fall into two separate sets or clouds in the lower part of the plot are unrelated rna_structures and the increasing deviation of the cloud reflects the way rmsd values grow with optimal alignments of randomly_chosen molecules in the upper part of the plot there is a clear cluster of alignments with a minimum_length of bases and rmsd values ranging from to a a was the cut_off value used for finding matches this cluster comprises related trna molecules and even includes trna chains buried within larger ribosome structures it also includes examples such as the alignment of tra to wz chain d which is an alignment of a phenylalanine trna and a leucyl trna see this alignment would also not be found by classical sequence alignment_methods and had a sequence_identity of only there is often no such thing as a correct structural_alignment but one can make some comparisons between different methods amongst the published_methods only lajolla could be locally installed for comparison an all against all comparison was attempted for each alignment the rmsd and alignment lengthgenerated by fries and the corresponding values generated by lajolla were compared and are shown inf we tested lajolla on three different sets the first one comprising all possible alignments of structures between and nucleotides i e trnas see the second and third sets were not limited to a certain size but to all possible alignments for a sequence_identity of and rmsd a in fries and d and with an rmsd of a with fries several features are clear first lajolla caps rmsd values at a calculated using its selection of atoms thus many alignments found by fries would not be seen with lajolla second lajolla did not return any results for structures larger than nucleotides the plots further show that given the capping lajolla generally produces alignments with a smaller rmsd a c however for all alignments the number of aligned nucleotides was significantly_higher for alignments from fries b d f we also ran a test taking_into only alignments with rmsd values of a in fries this showed that fries could produce alignments with better rmsd values than lajolla but with a significantly_larger number of aligned nucleotides higher rmsd values are obviously acceptable when they reflect longer and more meaningful alignments finally some programs offer web interfaces thus it is possible to show some comparisons with arts sara and sarsa for the alignment of det chain c and i v arts provided an alignment that comprised only residues in comparison with residues for fries but had a smaller rmsd of a the distinctive_features of arts can explain this difference its alignment_method is exclusively based on the comparison of coordinates of phosphate atoms and no further backbone information is taken into account combined with the use of a distance matching error this can lead to entirely different b alignments with an rmsd below a and a sequence_identity of in c and d and alignments with an rmsd below a in both fries and lajolla in e and f alignment of pdb files tra chain a and wz chain d corresponding to the outlier in database_search for pdb id tra the upper group is a set of alignments which includes all trnas in the pdb the structural superposition corresponding to the circled alignment is shown instructural alignments furthermore owing to the lack of an option to choose between local and global alignments in arts it was not possible to reproduce our alignment arts will always find a local_alignment with a much better rmsd value instead of our global one the results for sarsa are similar with an alignment showing many gaps the alignment obtained by sara also contains gaps however these are located mainly in the anticodon region of both trnas given the fact that i v describes a phenylalanine trna and det contains a glutamine trna they are most likely to differ in this area using det chain c as query for the database_search of arts i v will not be found at all this is caused by the nature of the dataset used for database_searches in arts which consists of only representative rna_structures this obviously improves the computation time but misses many results sarsa offers no database_search the alignment of tra and wz chain d gave_similar here the alignments with sarsa and arts are slightly shorter with a correspondingly smaller rmsd value the alignment from sara is similar to the one obtained from fries with two more gaps which also results in a better rmsd value some literature results are based on very few structures but one can also compare against them both setter and r d align were compared on the basis of the alignment of two s rrna structures against arts sara and dial shows little difference between the results from fries and the other approaches in addition to comparing fries against programmes using tertiary_structure we also compared it with two methods that compute alignments using only secondary_structure rnaforester hierarchically ordered multiple_sequence to generate alignments of rna_secondary strings and locarna uses a sankoff style alignment and folding we compared the resulting alignments in terms of two properties i the number of indels insertions_and in the resulting sequence_alignment and ii the structural_alignment implied by the secondary_structure alignment property i shows that for the example of p m and p p there is a big difference in the number of indels for rnaforester and locarna fries the alignment obtained from rnaforester contains indels in gaps whereas the alignments of locarna and fries both show only indels in two gaps considering the implied structural_alignments the large differences between the alignment obtained from rnaforester and the ones from locarna and fries are even more apparent the alignments from fries and locarna are of similar quality with a slightly_lower rmsd for locarna a as compared with a for fries the rmsd for the alignment obtained from rnaforester is a because the structural_alignment of biopolymers is fundamentally np complete all methods use heuristics and approximations the method in this work might be closest to those which rely on some kind of structural alphabet to label fragments however the method here is different in the type of labelling used firstly each site in the chain is influenced by all overlapping fragments this means that each pair of aligned residues reflects a region of nine bases next the labels come from an unsupervised_learning approach thus there are few preconceptions as to what constitutes a structural_element this is a major difference compared with rna_secondary aligners locarna rnaforrester which cannot take advantage of other common structural_motifs most importantly the labels are not discrete as in a typical or the much smaller alphabet paired unpaired used by rna_secondary aligners in this work the product of the probability vectors leads to a smooth measure of similarity therefore the method works when confronted with a completely new structural_element one should also note that the classification of fragments is certainly not optimal and need not be it must only serve to provide a fingerprint for recognizing similarity this can be seen by a simple numerical argument imagine a class in the classification was incorrectly split into two classes and a calculation is then faced with a fragment which fits perfectly into this class the calculated probability vector would have two entries with values of when compared with a similar vector the dot product would still be near these might be technical_aspects only relevant to this method but there is a general technical problem with this kind of approach ultimately most methods are based on some choice of atoms and structural_properties the classic statistical mixture_model used in this work does impose one important restriction it must be possible to approximate the distributions of the descriptors by the sums of simple distributions for example the quasi electrostatic score of equation would not be a good model for physics but it yields relatively well separated sets for h bonded and not h bonded sites similarly the distances and angles used here fit better to gaussian_distributions than examples from the literature it is also worth noting that the choice of descriptors can have a large influence on the kind of alignments generated most of the methods working with rna_structures are dominated or begin with local structural_properties in contrast our method included a contribution from h bonding which is a distinctly non local property in terms of sequence this means that equation will yield a good score for local_similarity but there is a preference to align h bonded sites with h bonded sites and vice_versa one could also say that in an alignment calculation one never requires a perfect match and an optimal alignment may involve many less than optimal local matches the underlying classification is entirely automatic and although not perfect a model for the most important features of rna_structure given a set of descriptors one could for example interpret the most populated classes in structural terms looking at one would say that the single most common motif is a helix with well described angles but one can statistically justify splitting it into two classes based on h bonding probability the third class is also similar but is characterized by one particular distance and a particular value at one site the results in this work highlight the ability to find remote structural_similarities but the comparisons suffer from a typical problem it is often difficult to claim one alignment is better than another method may truncate alignments and return results with a small rmsd value structural_similarity whereas method returns longer alignments which will appear to have a larger rmsd value it is completely arbitrary which method one prefers the results do however suggest that our proposal often finds rather long alignments without a great cost in rmsd values this is also related to a second problem when searching a database for related structures there are several reasonable ways to rank the hits a navenave structural measure such as rmsd will certainly retrieve similar structures but these will penalize longer and more interesting alignments one can invent similarity_measures based on multiple factors although these will entail decisions as to the importance of different properties when comparing methods one can also see some differences in principle if a method tries to optimize rmsd values it will be sensitive to hinge movements within structures in our approach rmsd values are only calculated for comparisons this means that the results are tolerant of hinge movements and in particular one has no problem with alignments in large structures such as ribosomes to make comparison with literature methods easiest the results here were based on smith and waterman style alignments which emphasize core_regions of similarity should one want to force globally optimal alignments it is only a switch to choose needleman and wunsch style alignments if one is interested in extending the method there are a number of possibilities the classification used here was based on fragments of length k it is possible that one would capture more structural_information with longer fragments but the classification time does become prohibitively_expensive one should in principle update the classification as more structures become available this can do no harm but will only make a difference with exotic and uncommon pieces of structure at the moment the largest classes account for most of the probability density if one doubled the amount of data this would lead to a slightly better statistical_model for the less commonly seen fragments one could also say that the dataset used for the classification is biased it includes too many trna structures because there are superposition of p m and p p based on alignment generated by rnaforester rmsd of a a and locarna rmsd of a b the structure alignment obtained from fries is shown inso many structures in the pdb it includes too many bases from ribosomes because ribosome structures are so large if one removed these biases it would change the prior probabilities associated with each class and yield a classification that was in some chemical sense better it would not make a great_deal of difference in this application where the aim is simply to apply unique labels to structural_fragments a more interesting extension would be to combine sequence and structure information statistically this means one uses a multi way bernoulli description for the probability of base types at each site this is technically possible and has been tested on proteins but it does raise a question that is difficult to answer one is usually dealing with cases where sequence_similarity is so small that one has to use structural_alignments in this regime it is not clear as to whether adding sequence_information adds more noise or more information finally one must make the obvious concession structurebased alignments can only complement sequence_based as they can only be applied to the fraction of rnas for which a structure has been determined the method presented here seems to be swift sensitive to remote similarities and capable of producing accurate structural_alignments of rna_structures the code is available for download and should prove useful as more rna_structures enter the databases and one is interested in remote relationships conflict of interest none declared 
