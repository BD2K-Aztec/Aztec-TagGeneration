a robust and accurate binning algorithm for metagenomic_sequences with arbitrary species abundance ratio motivation with the rapid development of next_generation techniques metagenomics also known as environmental genomics has emerged as an exciting research area that enables us to analyze the microbial environment in which we live an important step for metagenomic_data analysis is the identification and taxonomic characterization of dna_fragments reads or contigs resulting from sequencing a sample of mixed species this step is referred to as binning binning algorithms that are based on sequence_similarity and sequence_composition markers rely heavily on the reference_genomes of known microorganisms or phylogenetic markers due to the limited availability of reference_genomes and the bias and low availability of markers these algorithms may not be applicable in all cases unsupervised binning algorithms which can handle fragments from unknown species provide an alternative approach however existing unsupervised binning algorithms only work on datasets either with balanced species abundance ratios or rather different abundance ratios but not both results in this article we present metacluster an integrated binning method based on the unsupervised topdown separation and bottomup merging strategy which can bin metagenomic fragments of species with very balanced abundance ratios say to very different abundance ratios e g with consistently higher accuracy than existing_methods availability metacluster can be downloaded attraditional microbial genomic studies usually focus on one single individual bacterial_strain due to experimental limitations in fact all microorganisms in a habitat have various functional effects on one another and their hosts for example the diversity of microbes in humans is shown to be associated with common diseases such as inflammatory_bowel ibd and gastrointestinal disturbance genomic analysis on the collective genomes of all microorganisms from to whom correspondence should be addressed an environmental sample known as metagenomics environmental genomics or community genomics becomes essential one major_difficulty of metagenomics lies in the fact that most bacteria up to found in environmental_samples are unknown and cannot be cultivated and isolated under laboratory conditions with high_throughput one possible solution is to directly sequence dna_fragments of multiple species obtained from the mixed environmental dna_sample some well known metagenomics projects including the acid_mine biofilm amd project that analyzes dozens of species and the human_gut hgm project that involves thousands of species study fragments obtained from this sequencing approach dna_fragments of a metagenomics project are usually from multiple_genomes and most of the genome_sequences are unknown an important step in metagenomic_analysis is to group dna_fragments from similar species together referred to as binning to obtain the microbe distribution of the sample and identify species including unknown species within the sample depending on different research needs the binning process could be performed on different taxonomic_levels from kingdom the highest level to species the lowest level traditional binning methods can be roughly classified as similarity based and composition based similarity based_methods align each dna_fragment to known reference_genomes based on the alignment results e g blast hits or selected phylogenetic specific marker_genes each fragment is assigned to the taxonomic class of the similar reference_genomes similarity based_methods are usually limited by the availability of known microorganism genomes given that of microorganisms have been cultured and sequenced on the other hand composition based_methods group dna_fragments in a supervised or semi_supervised manner using generic features such as genome_structure or composition structural_features such as composition features of reference_genomes or taxonomic marker regions e g s rrna reca and rpob are commonly_accepted fingerprint genes are extracted and used to construct classifiers for determining dna_fragments from different species or constraints for semi_supervised clustering these composition based_methods usually suffer from the low availability and reliability of taxonomic markers for example studies on the enhanced biological phosphorus removing ebpr sludge sargasso sea and the minnesota soil_samples indicate that only and of the dna_fragments respectively are known to carry s rrna markers and the figures are still even if more markers such as reca and rpob are included moreover the reliability of taxonomic markers has also been challenged as some species may share multiple_markers with other species or multiple kinds of s rrna molecules exist in a single bacterium due to the high mutation and gene exchange ratio of microbes which might lead to incorrect classifications a more promising direction is to use unsupervised binning algorithms based on the occurrence frequencies of l mers short dna substrings of length l of the dna_fragments in these approaches each fragment can be regarded as a vector containing the occurrence frequencies of all possible l mers in the fragment the rationale behind these approaches is based on the observation that the l mer distributions of the fragments in the same genome are more similar than those l mer distributions of two unrelated species based on this feature many algorithms e g tetra metacluster metacluster and likelybin have applied different unsupervised clustering_methods on fragments based on the l mer distributions with great success when the abundance ratios of the species in the sample are almost the same these algorithms tend to cluster fragments into clusters with similar size and the binning performance of these algorithms will significantly be degraded when the abundance ratios of species are very different e g or to tackle this problem another unsupervised_clustering method called abundancebin has been introduced recently which models the distribution of fragments from each species by different poisson distributions fragments from species with high_abundance ratios are usually sampled more while fragments from species with low_abundance ratios are usually sampled less thus fragments from species with different abundance ratios can be separated by their sampling rates however when the species have similar abundance ratios say or the sampling rates of fragments from different species are similar and abundancebin fails to separate the fragments from these species abundancebin also considers the case when the number of species k is unknown and determines k automatically the estimation method seems not very effective and cannot predict the correct value when k in our experiments none of the above algorithms can handle datasets from balanced species abundance ratios to very different species abundance ratios in real situations the abundance ratios are usually unknown and it is desirable to have an algorithm handles datasets with arbitrary abundance ratios abundancebin takes_advantage of the differences in abundance ratio of the species to separate the fragments and it is not obvious how to extend abundancebin to handle datasets with very balanced abundance ratio on the other hand approaches that handle datasets with balanced abundance ratio usually try to cluster fragments into k equal sized clusters by assuming the number of species in the dataset is k thus species with low_abundance ratio are forced to group wrongly with other species in this article we present metacluster an integrated binning algorithm with two phases topdown clustering phase and bottomup merging phase in phase we separate fragments into small groups clusters with similar sizes and try to guarantee that the majority of the fragments belong to the same species after phase it is possible that fragments from the same species are grouped into different clusters so in phase we try to combine these clusters together outlines the two phases of metacluster this two phase strategy relies on the following key observations first the difference we capture this difference using the spearman distance measure between two l mer distributions of fragments from the same species follows a normal_distributions the same is true for the two l mer distributions of fragments from species of different families this observation is supported by an empirical study section second the differences in the two normal_distributions allow us to derive a probabilistic_model to determine how many clusters k we should use in order to guarantee that most of the fragments in the same cluster belong to the same species in phase and when to merge the clusters to make sure that there will not be too many fragments from other species being merged together based on our probabilistic_model if the abundance ratios of the species are more or less the same the value of k will be similar to the number of species if the species have very different abundance ratios k tends to be large and the clusters will be small so that fragments from minority species could be assigned to separate clusters without mixing with fragments from other species although fragments of majority species may then be put in different clusters phase will try to merge them back thus the issue of varying species abundance ratio is handled to summarize metacluster can i determine automatically the number of different species in the sample which is required aspage in this section we analyze the performance of the binning algorithm metacluster based on the simulated metagenomic_datasets we compare the performance of metacluster with abundancebin and our previous version metacluster we have not compared other unsupervised binning algorithms because metacluster outperforms these algorithms in similar experimental_setting we use the default_parameters for abundancebin and metacluster we have conducted three sets of experiments i we fix the number of species to be and vary the abundance ratio from the balanced situation to the unbalanced situation of we assume that the number of species in the dataset is known the performance of metacluster is consistently more accurate for all datasets with different abundance ratios ii we also compare the performance of metacluster with abundancebin based on datasets with more species with different abundance ratios in this set of experiments we also assume that the number of species is known the results show that metacluster outperforms abundancebin in particular the accuracy of metacluster is three times better than that of abundancebin when the species abundance ratio is balanced iii lastly we demonstrate that metacluster works better than abundancebin if the number of species in the dataset is unknown in all the experiments we use the parameters t and we have varied the parameters and the results are similar 
