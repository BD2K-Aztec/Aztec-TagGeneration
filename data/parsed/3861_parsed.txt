sequence_analysis rainbow an integrated tool for efficient clustering and assembling rad_seq reads motivation the innovation of restriction_site sequen_cing rad_seq method_takes full advantage of next_generation by clustering paired_end short_reads into groups with their own unique tags rad_seq assembly problem is divided_into subproblems fast and accurately clustering and assembling millions of rad_seq reads with sequencing_errors different levels of heterozygosity and repetitive_sequences is a challenging question results rainbow is developed to provide an ultra_fast and memory_efficient solution to clustering and assembling short_reads produced by rad_seq first rainbow clusters reads using a spaced seed method then rainbow implements a heterozygote calling like strategy to divide potential groups into haplotypes in a topdown manner and along a guided tree it iteratively merges sibling leaves in a bottomup manner if they are similar enough here the similarity is defined by comparing the nd reads of a rad segment this approach tries to collapse heterozygote while discriminate repetitive_sequences at last rainbow uses a greedy_algorithm to locally assemble merged reads into contigs rainbow not only outputs the optimal but also suboptimal assembly results based on simulation and a real guppy rad_seq data we show that rainbow is more competent than the other tools in dealing with rad_seq data availability source_code in c rainbow is freely_available sourceforge net_projects bio rainbow files contact genetic_markers are polymorphic dna_sequences distributed along the chromosomes they are important for studying population_genetics molecular_evolution and inherited_diseases traditionally genetic_markers include restriction_fragment simple sequence_length polymorphisms amplified fragment length polymorphisms microsatellite polymorphisms single_nucleotide snps short_tandem etc http en wikipedia org wiki genetic_marker the development of these genetic_markers is usually a costly laborious and time consuming work and could not easily be parallelized the advent_of ngs_technology enables sequencing many millions of reads with plummeting cost methods for discovering and genotyping genetic_markers based on ngs are rapidly springing up these include reduced representation libraries complexity reduction of polymorphic sequences crops and restriction_site associated dna_sequencing rad_seq for a good review of these methods see they are very useful for population_genetic genomic studies especially when the reference_genomes are unknown rad_seq could generate a genome_wide density of genetic_markers suggesting a broader application than the other methods rad method was initially invented by michael miller b using microarrays then high_throughput rad_seq was developed as an efficient method to identify genetic_markers rad_seq has been successfully used to discovery snps and study adaptive_evolution in the stickback to resolve genetic_structure and direction of evolution in the pitcher plant mosquitoes to infer phylogenies and to study interesting traits of butterfly the heliconius as illustrated in the protocol of rad_seq can be summarized as first digesting the genomic_dnas using restriction_enzymes res then the digested restriction_fragments are randomly sheared into staggered sequences and sizes suitable for sequencing e g on illumina_genome platform are selected and amplified using pcr and last by sequencing the ends of selected segments rad_seq data are ready for downstream_analysis the sequenced ends near the restriction_site are called rad tags or tagged reads and the other ends are nd ends at a particular restriction_site the tagged reads contain identical information thus by grouping the rad tagged reads and local assembling of the corresponding ends nd reads contiguous sequences of bp limited by the insert_size of library of the sequencing_platform that represent parts of the genome are generated moreover the tagged reads can be barcoded enabling pooled individuals are sequenced in a single reaction for examples to whom correspondence should be addressed y the authors wish it to be known that in their opinion the first two authors should be regarded_as andused an enzyme to digest the genomic_dnas of stickleback and guppy and by locally assembling rad tags they tried to identify snps and define putative haplotypes in populations although these methods show potential application for local_assembly and downstream population genomic and molecular_evolution analysis it lacks an efficient and integrated tool to fulfill the prerequisite clustering the identical tagged reads and local_assembly work we show here that clustering is the most critical and challenging_problem in that the number of reads to be clustered is huge and they may contain sequencing_errors in addition the levels of heterozygosity and or repetitive_sequences may be high a direct hashing method could quickly group the tagged reads but cannot tolerate the inherent sequencing_errors pairwise_alignment for all short_reads could overcome this weakness but the cost of computation is extremely_high to avoid the cost of pairwise_alignments heuristic methods that filter out unnecessary comparison of distant sequences are introduced these methods include cd_hit uclust and dnaclust all these tools employ a similar k_mer based method i e the sequences are represented as a table containing the number of the occurrence of all substrings of length k and insufficient k_mer number between two sequences will not be compared they are developed for general clustering analysis but may not be well suitable for ngs_data recently seed used a block spaced seed approach to fast clustering ngs_reads while tolerating up to three mismatches it demonstrated the potential usefulness of spaced seed method for clustering huge_amounts of next generation short_reads another set of algorithms such as vmatch and bwa using suffix_array to index sequences first and by backtracking in the indexed structure similarity between reads can be obtained developed an exact algorithm slidesort which used a recursive pattern growth method to find chains of k_mers and arbitrary edit_distance could be calculated however these methods may not solve the rad_seq clustering problem properly first the customized similarity threshold is subtle a higher_level of mismatches could collapse too many similar sequences into one cluster which could cause wrong assembly and will overestimate the diversity of the species a lower level of mismatches splits one cluster into many smaller ones which will generate redundant contigs or cannot be correctly assembled because of too few reads could be used one goal in rad_seq is to collapse heterozygote while distinguish repeats second these methods can use the information of only the tagged reads while the nd ends are deserted the tagged reads usually consist of barcode re site and the rad tag barcodes and re sites and or low quality sequence at the tail must be removed before clustering although ngs_reads are evolving longer and longer the total length for clustering is limited given the paired_end of rad_seq should we use both of the ends which indeed uses longer sequence_information third they are either not time efficient or not space efficient and combining with other tools to proceed subsequent analysis might be tough for biologists who are new to bioinformatics to achieve these goals we demonstrate a package called rainbow which uses a spaced seed hashing method for primary clustering a heterozygote calling strategy for further dividing clusters a bottomup merging module using paired_end information of rad_seq and a greedy assembly method for local_assembly all at one time rainbow can quickly and accurately cluster and assemble the tagged reads and their nd ends with a low footprint of memory in this article we present rainbow as an efficient and general tool for rad_seq short_reads clustering and assembling it could quickly group and assemble millions of short_reads with a small memory_footprint in addition it could tolerate a highheterozygous genome in particular by using the topdown dividing and bottomup merging procedures we can collapse heterozygote while distinguish repetitive_sequences we have shown that it performs well both on simulation_data and real_data rad_seq is a developing field and intriguing the interests of more and more people as the evolution of ngs_technology we believe rad_seq will improve a lot and become more important for biological_research in the future we will improve rainbow in the following aspects first to improve the accuracy of clustering base_quality will also be incorporated into the dividing procedure besides to be compatible with more applications we will add a seed shifting strategy that seed proposed to deal with overhanging bases which could rescue reads due to irregular cuts third although rad_seq is mainly performed on the illumina_genome the rapid evolving rad_seq technology might spread to other platforms we will prepare to let rainbow support more platforms 
