genetics_and high_throughput microbial population_genomics using the cortex variation assembler we have developed a software_package cortex designed for the analysis of genetic_variation by de_novo of multiple samples this allows direct comparison of samples without using a reference_genome as intermediate and incorporates discovery and genotyping of single_nucleotide indels and larger events in a single framework we introduce pipelines which simplify the analysis of microbial samples and increase discovery power these also enable the construction of a graph of known sequence and variation in a species against which new samples can be compared rapidly we demonstrate the ease of use and power by reproducing the results of studies using both long and short_reads genome_sequencing of pathogens is of growing value to public_health as a means of distinguishing genetic_variants correlated with drug_resistance or virulence den for tracking of transmission chains and for within host evolution studies at the heart of all these applications is the requirement to be able to compare the genomes of different samples most current_tools are dependent on alignment to a reference_genome and cannot detect differences between genomes directly it is known that alignment introduces a bias towards the reference and has limited_power for indel discovery furthermore using a reference is inherently problematic as microbial_strains can be highly diverged we showed inthat the cortex assembler has power to detect single_nucleotide snps indels and structural_variants by simultaneously de_novo assembling multiple samples each corresponding to a colour in a de_bruijn and detecting variants as graph motifs a limitation of a de_bruijn approach is the use of a single kmer size there is in general no optimal kmer for variant discovery in a given datasetvariants near repeat_sequence will only be discoverable at higher kmers but lower coverage variants will need a lower kmer supplementary_information section onwards we have therefore introduced pipelines to do discovery on many samples at many kmer values and then genotype all samples at all discovered sites discovery can be done jointly in all samples with or without a reference or per sample against a reference we demonstrate by reproducing the results of two published_studies loaded into the graph for discovery genotyping processing staphylococcus_aureus samples would require of the order of gb ram supplementary_information section time complexity of each step is shown in note the nonparallelizable steps scale linearly with number of samples we have shown that the cortex population assembler provides a method for rapid high_quality variant discovery in microbial_genomes and allows comparison of new samples with all previously known strains we believe it will prove valuable in microbial population_genomics cartoon shows two samples red and blue and a diverged reference_genome black in a de_bruijn symbols indicate which workflows call sites brackets indicate flanking_regions cannot be placed on reference so the call is filtered from vcf at snp b the independent workflow would call the red and blue versions of h and would implicitly find b c is only called if the reference is excluded from discovery as it confounds the red allele d is called by workflows that include the reference in discovery 
