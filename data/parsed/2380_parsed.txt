improved transcript_isoform discovery using orf graphs motivation high_throughput of rna in vivo facilitates many applications not the least of which is the cataloging of variant splice_isoforms of protein_coding messenger_rnas although many solutions have been proposed for reconstructing putative isoforms from deep sequencing_data these generally take as their substrate the collective alignment structure of rna_seq and ignore the biological_signals present in the actual nucleotide_sequence the majority of these solutions are graph_theoretic relying on a splice graph representing the splicing patterns and exon expression levels indicated by the spliced alignment process results we show how to augment splice_graphs with additional information reflecting the biology of transcription splicing and translation to produce what we call an orf open_reading graph we then show how orf graphs can be used to produce isoform predictions with higher accuracy than current state of the art approaches availability_and rsvp is available as c source_code under an open_source licence http ohlerlab mdc berlin de software rsvp high_throughput of rna_transcripts facilitates many applications including gene_expression analysis single_nucleotide snp_detection discovery of unannotated genes and cataloging of different splice_isoforms for individual_loci as the cost of sequencing continues to decline rna_transcript assays will become increasingly common and efficient computational_methods for extracting biological_knowledge from the resulting data will become increasingly crucial the cataloging of splice isoform variants of protein_coding remains an especially important goal as the range of possible downstream_effects following the transcription of a gene is constrained by the variety of transcripts that can be produced from that locus various other applications using transcriptomic_data rely on knowing the set of transcripts that can be produced by each gene even if not every transcript from a protein_coding locus results in stable protein production identification of those transcripts that do likely produce proteins and an accurate characterization of the protein isoforms produced remain important_steps in the process of understanding individual transcription_units unfortunately few genomes currently have complete annotations of all splice_variants of all genes although a full_length sequencing of whole transcripts promises to become technologically feasible in the future at present the inference of the whole transcript structure from short_rna sequencing_reads in eukaryotic_organisms depends on computational_methods for assembling exons into complete structures in the case of functional protein_coding transcripts these structures should contain a valid open_reading orf capable of being translated into a functional protein i e beginning with a valid start_codon aug and ending with a valid stop_codon uga uaa or uag in the same period phase current methods for discovering splice_isoforms from short_rna sequencing_reads fall into roughly two categories those that explicitly perform spliced alignment of reads to a reference_genome and those that instead perform de_novo of reads without an explicit reference given the increasing availability of near complete genomic_sequences we have focused on the first category reference based_methods typically use the mapping of spliced reads to induce a structure called splice graph in which each vertex represents an exon and each edge represents an intron paths through the graph represent individual combinations of exons comprising putative transcript_isoforms de_novo methods also use a graph called a de_bruijn in which paths again represent transcripts though vertices now represent k_mers thus graph_theoretic algorithms based on path enumeration are common to most methods of transcript assembly from rna sequencing_data although splice_graphs are highly informative to the transcript assembly process because of their inclusion of information about both splicing patterns and relative exon_inclusion levels they lack any information about underlying nucleotide patterns in particular they provide no immediate means of determining whether a path through the graph corresponds to a transcript with a valid orf for protein_coding this is one of the most important constraints in determining whether a transcript can encode a viable protein as translation occurs only in orfs to whom correspondence should be addressed in this article we show how to augment splice_graphs with additional information reflecting the biology of transcription splicing and translation to produce what we call an orf graph orf graphs contain explicit phase_information allowing efficient enumeration of isoforms containing a valid orf and they permit phase specific scoring of individual transcript elements so that isoforms can be efficiently ordered by their likelihood under some joint sequence model in this way orf graphs provide more than simply an indication of whether a putative transcript contains an orf via the vertex and edge scores they provide information regarding coding potential and splice_site strength and via the phase_information they provide an efficient means of ranking exon combinations without invoking the combinatorial explosion of exhaustive enumeration finally we present an efficient software implementation called rsvp rna_seq variant prediction which achieves higher prediction_accuracy than current state of the art approaches for identifying transcript_isoforms our implementation has the advantage that it does not depend on particular library_preparation protocols e g strand specific libraries paired_end although the orf graph formalism is flexible enough that many such considerations could be accommodated our implementation is made available under an open_source license we assessed the accuracy of rsvp by applying it to librarynormalized rna_seq collected from arabidopsis_thaliana seedlings and flowers see_supplementary for comparisons on human data this model_organism is highly suitable for comparative testing of transcript based_approaches to isoform reconstruction because of its relatively small introns small numbers of exons per gene and large proportion of single_exon genes tair human curated annotations were partitioned into a training_set consisting of all genes on chromosome and a test_set consisting of a subset of the remaining tair genes filtered to be nonredundant with the training_set by ensuring that no test gene and training gene were similar over of their length according to blastn basic_local nucleotides this resulted in training genes and test genes because we wished to test the ability of rsvp to identify alternative splice_isoforms of known genes we reduced the test_set to genes each having multiple splice_isoforms annotated in tair and we applied rsvp to a genomic interval extending from bp_upstream of the most annotated start_codon for the gene to bp downstream of the most annotated stop_codon alignment of reads to the genome was performed by bowtie and tophat and these were processed into pileup files by samtools we further separated the test_set into two subsets a high coverage set for which fpkm fragments per kilobase of sequence per million reads_mapped was at least genes and a low coverage set for which fpkm genes we ran the n best algorithm for values of n ranging from to for comparison we also applied three previously_published tools cufflinks scripture and ireckon because these programs predict transcripts without indicating the reading_frame and the translation start and stop sites we examined all possible orfs and took the longest to be their intended prediction splice_sites were also filtered to include only the most common splice consensuses in tair donor_sites gt gc at acceptor_sites ag ac we also applied the ab_initio gene finder genezilla to serve as a baseline to assess the utility of orf graphs for discriminating coding from non coding loci we applied rsvp to a set of putative lincrnas long_interspersed non coding loci obtained from liu et_al and additionally to a set of transcribed loci of length at least nt identified by cufflinks as having fpkm but not falling within nt of any annotated tair protein_coding for this experiment we disabled rna scoring rna in case of possible confounding biases in expression levels as illustrated in rsvp achieves higher exon and transcript sensitivity than all three competing programs when making roughly the same numbers of predictions on annotated coding_genes exon sensitivity is defined as the proportion of tair exons in the held out test_set that were included in the set of predicted transcripts where an exons begin and end coordinates must be predicted exactly correctly to be counted as a found exon similarly a tair transcript is considered to be found by a predictor if one of the predicted transcripts exactly matches for all exon coordinates including translation start stop_codon coordinates a tair transcript we do not evaluate specificity as the premise for applying tools of this type is that the set of annotations is incomplete and therefore the false_positive cannot be reliably estimated based on existing annotations alone in lieu of specificity we plot the number of predictions x axis which is expected to scale inversely with specificity additionally shows that when using both dna and rna evidence rsvp produces higher exon and transcript sensitivity at roughly_equal prediction counts for both low fpkm and high fpkm genes than when dna scores are omitted as expected the effect was greater for low fpkm genes where the use of dna evidence may compensate for sampling error and gaps in coverage by low rna read_counts this underscores the importance of dna evidence for lowly_expressed genes and or lower_quality libraries in we show that increasingfpkm results in higher sensitivity although with diminishing returns as fpkm approaches the gene inprovides some anecdotal insight into the advantages offered by the orf graph based_approach none of the three cufflinks predictions for this locus matched tair annotations and one was on the opposite strand from the annotations rsvp predictions were on the proper strand all contained valid orfs and rsvp identified several alternative start_codons with non zero read_depth in addition a structural_classification of proteins scop protein domain involved in heavy_metal binding occurs in one rsvp isoform but is excluded by another in agreement with tair annotations suggesting the possibility of differential protein_function based on isoform the gene tair at g is annotated as a heavy_metal transporter note that cufflinks was unable to extend its prediction into the zero depth region from to our use of both dna and rna evidence allowed rsvp to reproduce the annotated isoform extending across this interval provides counts of alternative isoform features for cufflinks and rsvp on the fpkm test_set as compared with tair annotations for all alternative_splicing alternative donor or acceptor splice_sites exon_skipping and intron retentionrsvp agrees more closely with tair than does cufflinks in contrast although prediction of alternative start_codons and stop_codons by cufflinks exceeds those in tair by roughly a factor of three rsvp predicts substantially more of these events than cufflinks particularly in the case of start_codons we suspect the tair annotations are substantially underrepresenting these events as human curators are typically trained to choose the single most upstream start_codon because cufflinks does not identify a reading_frame we were compelled to identify the longest orf in its predictions likely limiting the frequency of alternative translation start sites in its predictions as such the elevated number of start_codons identified by rsvp may better correlate with the true_prevalence of this type of alternative isoform feature finally in we show the receiver_operating roc_curves for the classification task of discriminating annotated coding loci from either putative non coding_genes lincrnas or from unannotated transcribed loci for coding_genes we used tair loci with fpkm not in the training_set classification was performed by thresholding the maximal length normalized exon score of the rsvp prediction rna note that although the lincrnas were filtered by liu et_al based on the longest orf length the rsvp exon scores used for classification are likelihood_ratios and therefore do not example gene tair at g illustrating differences between cufflinks and rsvp predictions none of the three cufflinks predictions matched the tair annotations one was on the opposite strand rsvp predictions identified several alternative start_codons the gene is a known heavy_metal transporter a putative scop domain oval involved in metal transport is differentially included by the predicted rsvp isoforms as well as by the tair annotationsdirectly use orf lengths in the classification the solid curve plots the true_positive as a function of false_positive in discriminating the annotated coding loci from the putative lincrnas this produced an auc value area_under of indicating that orf graphs can be used to reliably discriminate coding from non coding loci the dashed roc_curve is the result of discriminating using rsvp the same set of annotated coding_genes from the unannotated transcribed loci identified by cufflinks auc in contrast discrimination between the two sets of putative non coding loci was poor auc suggesting that the vast_majority of unannotated transcribed loci are non coding and that few coding_genes likely remain to be discovered see_supplementary for additional results in the case of protein_coding isoforms may differ not only in their splicing patterns but also in their reading_frame and length the latter feature being most obviously affected by the choice of translation_start start_codon although human annotators are typically trained to choose the most upstream methionine as the correct start_codon in accordance with the traditional ribosome scanning modele g this is not a biologically absolute rule several plant genes have now been shown to support stable translation from multiple start_codons in some cases resulting in differential protein targeting in the cell translation_initiation will also be constrained by the transcription_initiation so that shortening of transcripts at the end will force the use of more translation start sites the use of alternative translation start sites will obviously affect the encoded_protein and in some instances may cause the differential inclusion of functional protein_domains in particular signal_peptides that influence the subcellular_localization of the resulting protein therefore it is valuable for a predictor to be able to identify isoforms differing based on the use of strong alternative start_codons a prominent feature of our proposed_framework is the ability to exploit the sensitivity_specificity trade_off inherent in choosing the number of predictions to be made although direct measurement of the specificity is generally not possible because of the incomplete state of most genomic annotation efforts to date the eventual sharp falloff in the rate of increase of sensitivity as numbers of predictions continue to rise indicates both a likely concomitant drop in specificity and also that a point of saturation has likely been reached for the expressed genes plots fromsuggest that current methods based only on rna evidence may still be missing a substantial fraction of expressed isoforms the advantage of combining rna and dna evidence for protein_coding transcript prediction should be particularly large in the regime of lowly_expressed genes or in the presence of highly non uniform read_coverage along a gene e g as might result from sequencing or amplification_bias in which low sequencing_coverage over specific parts of genes may leave those exons effectively invisible to conventional transcript assembly algorithms in contrast the use of orf graphs allows one to complete the picture by finding exons with high coding potential and reasonably strong splice_sites that result in a complete orf despite gaps in rna coverage e g the nt interval of zero read_depth within the annotated coding exon in which caused cufflinks to prematurely terminate its prediction the use of a probabilistic_framework such as ours provides a means of doing so in a seamless principled manner there are a number of potential_improvements to our approach that could be investigated most prominent among them being the incorporation of additional information just as we have shown that integration of dna and rna evidence can benefit prediction so the additional integration of yet other forms of evidence such as evolutionary_conservation should prove fruitful previous and ongoing work in the field of gene prediction consistently shows that combining multiple lines of evidence tends to produce higher quality gene structure predictions e g and this very likely extends to the case of predicting multiple_isoforms additional information derived via the use of specialized rna library preparation_techniques such as paired_end could in principle be incorporated via appropriate augmentation of the orf graph these remain promising avenues for future work unlike the approach typically taken in the gene_finding literature where gene_finding programs are monolithic programs with few independently reusable parts the use of orf graphs permits a modular approach to transcript_isoform discovery just as rsvp uses an independent reweighting step to update the scores decorating the edges of the orf graph so as to reflect rna evidence additional graph transformations could be modularly applied to incorporate additional evidence the base orf graph produced by our pipeline may thus be used by other groups to investigate alternative_methods of graph_based prediction finally we believe that orf graphs may prove useful not only as substrates for prediction but also as repositories for later re annotation in the light of additional evidence when that evidence becomes available their ability to be stored annotated and decoded efficiently in both space and time renders them a highly useful substrate for an array of possible downstream_analyses 
