determining the evolutionary_history of gene_families motivation recent large_scale studies of individuals within a population have demonstrated that there is widespread variation in copy_number in many gene_families in addition there is increasing evidence that the variation in gene_copy can give rise to substantial phenotypic_effects in some cases these variations have been shown to be adaptive these observations show that a full understanding of the evolution of biological_function requires an understanding of gene gain and gene loss accurate robust evolutionary_models of gain_and are therefore required results we have developed weighted parsimony and maximum_likelihood methods for inferring gain_and to test these methods we have used markov_models of gain and loss to simulate data with known properties we examine three models a simple birthdeath model a single rate model and a birthdeath innovation model with parameters estimated from drosophila genome data we find that for all simulations maximum_likelihood based_methods are very accurate for reconstructing the number of duplication_events on the phylogenetic_tree and that maximum_likelihood and weighted parsimony have similar accuracy for reconstructing the ancestral state our implementations are robust to different model_parameters and provide accurate inferences of ancestral states and the number of gain_and for ancestral reconstruction we recommend weighted parsimony because it has similar accuracy to maximum_likelihood but is much faster for inferring the number of individual gene loss or gain events maximum_likelihood is noticeably more accurate albeit at greater computational_cost availability www bioinf manchester ac uk dupliphy contact recent large sequencing_projects and development of whole_genome tiling arrays have allowed comparative surveys of copy_number cnv of genes cnvs arise from gene_duplication and loss and play_an in genome_evolution differences in copy_number are often reflected by differences in gene family_size between species as the result of gene gain via duplication and gene loss indeed it has been argued that cnvs represent nascent gene_families variation of copy umber can have enormous functional consequences cnvs have been shown to be related to a range of diseases including developmental defects and autism in other cases cnvs have shown to offer an adaptive advantage in humans an increase in the number of copies of the amylase gene is correlated with high starch diet whereas in plasmodium_falciparum cnvs can lead to drug_resistance cnvs have also been shown to be under selection in drosophila large differences in copy_number have been found within a number of species including human fly mouse and yeast cnvs can also be found between sets of closely_related and within populations of the same species given the importance of the phenotypic_effects of cnv an understanding of the processes of gain and loss is key to understanding functional evolution specifically both duplication and gene loss events must be mapped to the underlying phylogenetic_tree if we are to correlate genotypic change with phenotypic_change or understand the effects of selection moreover mapping of duplications and losses to specific branches of a phylogeny allows us to identify lineage_specific gain and loss giving insight into the ongoing adaptation to particular environments advances in technology have only recently made large_scale resequencing projects and whole_genome tiling_array studies cost_effective and hence it is only recently that the importance of cnvs has been recognized the computational_problem of mapping duplications and losses to a phylogeny has therefore not been tackled extensively many of the analysis tools available to determine duplication histories on phylogenetic_trees use tree_reconciliation techniques these methods infer gene_trees for each gene_family and then reconcile these trees with a known species_tree to infer gain_and this approach_requires the generation of gene_family trees which may be time consuming and may be affected by bias in certain circumstances more recently maximum_likelihood has been used to infer the ancestral copy_number of gene_families given a species_tree and gene_family sizes for each species and for chromosome_number in relation to polyploidy these methods differ in their models of genepage in order to be able to further our understanding of functional evolution we must understand the processes of gene gain and loss here we have developed methods for inferring these events and the ancestral gene_family sizes on a tree we have compared the inferences of these methods with cafe on gene_families identified from drosophila data and on simulated_data we see that on drosophila data all methods perform similarly for internal nodes near the tips of the tree but vary more on longer branches toward to the root over all gene_families we see that the methods produce inferences of gene family_size that are more similar to each other than to cafe even where the average variation in the inferences made by these methods is small it may be important in specific cases particularly for those families with lots of variation between species we use simulated_data to compare the accuracy of our methods on data with a known evolutionary_history and to compare the robustness of these methods on data produced under known conditions the accuracy of three methods for inferring the number of birth and death events across the whole tree weighted parsimony as implemented in dupliphy and maximum_likelihood as implemented in dupliphy ml and dupliphy ml was compared across all three models the maximum_likelihood methods provide an accurate estimate of the number of gainloss events provided rate variation between genes is incorporated in the model the accurate inference for all three simulation schemes suggest that the model may be reasonably robust to minor misspecification when describing the process of gene gain and loss although failure to incorporate events that change gene_family number by greater than one or affect multiple genes may still cause inaccurate inference the failure of parsimony to infer correctly the number of events along a branch is a wellknown shortcoming with the problem being analogous to long branch attraction we conclude that maximum_likelihood with an appropriate probabilistic_model is well suited for inferring the number of gene gain_and along a branch in order to understand the evolution of gene_families through gene_duplication and loss we must be able to map gain_and on a phylogenetic_tree the two methods we have developed allow us to map these events to a tree using gene_family data from nine drosophila species we found that the methods tended to vary more in their inferences of ancestral gene family_size on longer branches near the root of the tree on data simulated under a variety of models maximum_likelihood provides the most accurate and robust method of determining ancestral gene_family sizes and identifying the individual events along a branch however we also see that weighted parsimony performs equally well as maximum_likelihood at ancestral reconstruction on trees with shorter branch_lengths overall we find that the accuracy of maximum_likelihood is dependent on the underlying probabilistic_model used to infer gain and loss and that more work is required to accurately describe the processes of gene_family evolution 
