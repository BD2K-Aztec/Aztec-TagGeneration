genome_analysis probabilistic partitioning methods to find significant patterns in chip_seq motivation we have witnessed an enormous increase in chip_seq for histone_modifications in the past_few discovering significant patterns in these data is an important problem for understanding biological_mechanisms results we propose probabilistic partitioning methods to discover significant patterns in chip_seq our methods take into account signal magnitude shape strand orientation and shifts we compare our methods with some current methods and demonstrate significant improvements especially with sparse_data besides pattern discovery and classification probabilistic partitioning can serve other purposes in chip_seq analysis specifically we exemplify its merits in the context of peak finding and partitioning of nucleosome_positioning patterns in human promoters availability_and the software and code are available in the supplementary_material chip_seq immunoprecipitation combined with high_throughput dna sequencing_experiments allow to characterize in vivo transcription_factor binding_events and local chromatin_organization on a genome_wide scale within the past_few chip_seq has become a widely used and indispensable technology in the study of transcriptional_regulation other epigenetic profiling assays are also starting to have a similar impact on the research field a chip_seq experiment produces a large number of sequence_tags that are mapped to the genome resulting in a genome_wide profile of tag counts a high tag count at a location on the chromosome indicates the presence of a particular protein at that location this protein may be a sequence specific transcription_factor a post_translationally histone or some other chromatin associated protein the regions enriched in chip_seq tags are diverse in terms of magnitude shape and orientation sequence specific transcription_factors typically produce uniform narrow gaussian peaks while regions enriched in histone_modifications tend to show complex multimodal signal distributions the term chromatin signature has been coined to designate recurrent patterns found in chip_seq based histone_modification maps and other types of chromatin profiling data a chromatin signature is usually represented by a vector of average tag counts in bins of certain sizes typically bp in a collection of larger genomic_regions of sizes kb chromatin signatures can be detected by so_called aggregation plots aps if precisely mapped experimentally defined anchor points e g transcription_start tsss are available for selection and delineation of the genomic_regions of interest a basic assumption in chip_seq analysis is that specific chromatin signatures are associated with specific functions for instance human promoters are characterized by a nucleosome free region of bp and a rigidly positioned h_k marked nucleosome centered bp downstream from the tss discovering a chromatin signature is difficult especially when anchor points are not available an effective algorithm must be capable to cope with the following obstacles biological inhomogeneity of the samples the set of analyzed genomic_regions often consists of multiple unknown subclasses in which case a plot derived from all samples shows the superposition of several different chromatin signatures alignment uncertainty precise anchor points are rarely available for delineating genomic_regions selected chromatin_regions first need to be optimally shifted registered with respect to each other before an ap can reveal a highresolution chromatin signature asymmetry chromatin signatures associated with directional molecular_mechanisms such as transcription are usually asymmetrical however the orientation of the genomic_regions is often unknown the input count vectors should then be compared with each other in both orientations sparse count_data certain bins may have very low tag counts leading to high sampling errors the problem of inhomogeneity can be tackled by off_the clustering and partitioning algorithms in fact hierarchical_clustering and k means have been incorporated in several to whom correspondence should be addressed multipurpose computational platforms for chip_seq analysis seqminer offers an in built k means function while chipseeker is interfaced with a third_party hierarchical_clustering software however shifting and flipping are only implemented in specialized programs like chromasig archalign catchprofiles and cagt archalign performs only shifting and flipping and can find only one single signature cagt supports flipping but not shifting the problem of optimal shifting is typically solved by exhaustive comparison of all overlapping subregions of a given size from two genomic_regions possibly in both orientations chromasig archalign and catchprofiles use progressive multiple_alignment strategies to assemble similar tag profiles because these algorithms have to carry out a large number of pairwise_comparisons they tend to be slow to overcome this drawback cagt applies a two step divide_and approach it first uses the k median algorithm a variant of k means to define top level classes and then runs a hierarchical clustering_algorithm on each of these classes in turn the shifting and clustering functions require some type of distance measure all of these programs except chromasig use non probabilistic measures such as the euclidean_distance or the pearson_correlation neither of which does well with low counts per bin chromasig assesses similarity between samples and class_membership assuming position specific gaussian_distributions of the normalized chip_seq signal within a chromatin signature the use of gaussian_distributions which seems unnatural for count_data is explained by the fact that chromasig was originally designed for chip_chip data in this article we propose an alternative approach for finding recurrent patterns in chip_seq by probabilistic partitioning the underlying principle of this general method is to optimize a mixture_model by an expectation_maximization em_algorithm a strategy that has already proved_effective in finding recurrent dna motifs in selected genomic_regions a key difference in this method compared with the other clustering_methods mentioned is that samples are not deterministically assigned to a single class rather their classification status is defined by a vector of class_membership probabilities while em has long been a standard tool in machine_learning it is a general_purpose method whose convergence rates and running_times depend on the exact formulation of the objective_function and the updating formulae the purpose of this article is to demonstrate the merits of em when applied to chip_seq and to explain by examples how it can be applied to classification and motif_discovery problems in research on chromatin structures the probabilistic partitioning approach offers the following advantages the use of probabilistic distance functions naturally takes_into random sampling_variation in low count_data probabilistic class assignment allows accurate characterization of classes even in situations where the classification of individual samples is uncertain probabilistic class assignment is flexible and can combine goals for instance the ranking and prioritizing of chipseq signal enriched regions based on peak shape shifting and flipping can be implemented in the em framework via hidden_variables the implementation of probabilistic partitioning is straightforward with existing programming platforms all algorithms used in this work can be implemented by lines of r code flexibility methods are readily customized to meet the needs of a particular application for instance the switching from a poisson probabilistic_model to a negative_binomial requires only one change in the corresponding r code efficiency in contrast to most existing_methods the em_algorithm does not require exhaustive pairwise_comparisons so that each iteration runs in time linear in the number of samples transparency and reproducibility methods can be accurately described in a research paper by reproducing a few lines of r code for example see the r code given in the supplementary_material section_presents in detail several variants of the probabilistic partitioning algorithms section analyses the performance of these algorithms on carefully_chosen examples based on simulated and real chip_seq and compares its performance with k_means and cagt we presented a probabilistic partitioning method to find significant patterns in chip_seq the corresponding algorithm runs in o n time given a fixed number of classes and em iterations it is capable of processing large_datasets tens_of of samples in minutes the method is conceptually_simple yet flexible and has been implemented in a few lines of r code the basic partitioning algorithm is readily adjusted to handling flips and shifts following standard principles of em with low data coverage the probabilistic partitioning method gives excellent model accuracy superior to k means or cagt when tested on the same data examples we have further shown that probabilistic partitioning can serve other purposes than pattern discovery and classification like partitioning of nucleosome_positioning patterns in human promoters and shape based evaluation and re focusing of chip_seq from published peak lists shape based peak evaluation with shifting the figure illustrates the effects of probabilistic partitioning on a ctcf peak list provided by encode in terms of motif enrichment a probabilistic partitioning with shifting b partitioning based on original p values method details ctcf binding_motifs where identified by scanning the dna_sequence around peak centers with the jaspar matrix ma at a p value threshold of the percentage of sequences containing a ctcf motif is plotted in a sliding_window of bp the numbers in parentheses indicate the sizes of the peak lists for fair comparison the threshold for partitioning with the original p values was chosen such as to match the numbers of good and bad peak obtained with probabilistic partitioning the motif enrichment profile for the complete peak list dotted line is included in both graphs 
