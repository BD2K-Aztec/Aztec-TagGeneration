sufficient statistics and expectation_maximization algorithms in phylogenetic_tree models_motivation measuring evolutionary_conservation is a routine step in the identification of functional_elements in genome_sequences although a number of studies have proposed methods that use the continuous_time models ctmms to find evolutionarily constrained elements their probabilistic structures have been less frequently investigated results in this article we investigate a sufficient statistic for ctmms the statistic is composed of the fractional duration of nucleotide characters over evolutionary time f d and the number of substitutions occurring in phylogenetic_trees n s we first derive basic_properties of the sufficient statistic then we derive an expectation_maximization em_algorithm for estimating the parameters of a phylogenetic model which iteratively computes the expectation values of the sufficient statistic we show that the em_algorithm exhibits much faster convergence than other optimization_methods that use numerical gradient_descent algorithms finally we investigate the genome wide_distribution of fractional duration time f d which unlike the number of substitutions n s has rarely been investigated we show that f d has evolutionary_information that is distinct from that in n s which may be useful for detecting novel types of evolutionary_constraints existing in the human_genome availability the c source_code of the fdur software is available at http www ncrna org software fdur although the number of sequenced_genomes is increasing rapidly the technologies that extract biological_information from them are still in their infancy finding evolutionarily constrained elements in a target genome_sequence is among the most successful uses of those massive genomic_sequences in those studies the researchers estimated the level of the substitution_rate for each genomic_region and tested whether it was significantly_lower or higher than an estimated rate of neutral evolution the substitution_rates were computed from a given species_tree and genome_wide alignments by using variants of continuous_time models ctmms which have been used in the maximum_likelihood ml method of phylogenetic_tree construction while the relations between the likelihoods of ctmms and possible topologies of the phylogenetic_trees have been extensively_studied for many years their probabilistic structures for a fixed tree_topology which are very important for the genome_wide studies mentioned above have been less frequently studied in this article we investigate a sufficient statistic for ctmms that is composed of the fractional duration of each nucleotide over evolutionary time f d and the number of substitutions that have occurred in a phylogenetic_tree n s the sufficient statistic naturally appears in expectation_maximization em algorithms for finding the local maximum of the likelihood_function however previous_studies treated them only as intermediate variables for parameter_optimization and did not investigate their properties or their genome_wide distributions developed a dynamic_programming for computing the null_distribution of n s corresponding to neutral evolution which was then used for computing p values for constrained elements however no investigation of the distribution of f d has appeared in the literature in the following sections we first derive basic_properties of the sufficient statistic such as its behaviors in the limiting cases at the time where the parameter is close to zero or infinity we derive an em_algorithm for estimating the substitution matrix and the branch_lengths which iteratively computes the expectation values of the sufficient statistic then we explain how the branch_lengths used in parsimony methods are related to those in the ml method many previous_studies of the em_algorithm optimized only some of the phylogenetic model_parameters which means that some of the expectation values required for a full parameter_optimization are lacking derived an em_algorithm for substitution matrices but did not optimize branch_lengths consequently the expected durations defined by them are not appropriate expected_values when the branch_lengths are optimized did not optimize the stationary distribution of the general time reversible model and thus missed the expectation n i defined in our article derived a partial em_algorithm for phylogenetic_models but the hidden_variables of their em_algorithm only included the nucleotide states on ancestral nodes instead of considering all the possible substitution histories along tree branches which are the random processes described by the models we have investigated the sufficient statistic composed of the fractional duration time f d and the number of substitutions n s for continuous_time models we have derived em algorithms for the general unrestricted unrest model and the general time reversible gtr model in the case of the gtr model we have derived a stationary equation method for solving the m step optimization_problem both the em_algorithm and the stationary equation method have a property which is not shared by the gradient_descent methods the objective_functions monotonically approach to their optimal values we have also shown that the em_algorithm converges faster than the gradient_descent methods although we did not describe em algorithms for other phylogeny models with discrete gamma rate variations and invariance sites the application of our method to such models is straightforward there is a natural definition of local posterior trees which are derived from the stationary equations and we have discussed the relationships between the branch_lengths in the maximal likelihood method and those in the parsimony method finally we have investigated the genome_wide distributions of the sufficient statistic we have shown that the fractional duration f d has evolutionary_information that is not contained in the expected number of substitutions n s in our experiments on the f d distributions we have focused on only the point that the fractional duration f d contains information different from those contained in the expected substitution count n s which is not obvious from the outset since conserved_regions n s naturally have biased distributions larger d f and thus they are strongly anti correlated in order to establish a novel method for finding novel constrained elements based on statistics n s d f several additional factors should be considered and investigated first we need to explore at least d space n s d f of statistics it means that we have to determine a threshold curve rather than a single threshold value to determine the constrained sites also more precise characterization of the correlations between n s d f and the patterns of aligned species i e the patterns representing whether each species have an aligned nucleotide or not in an alignment column we have touched on this issue in the codon sites experiment but discarding most of the information from the species alignments and keeping only four species for computing statistics is not a satisfactory method it requires the genome wide_distribution of possible patterns of alignment column types to make any statistical statement on the level of constraint computation of the theoretical distribution will be useful we have only analyzed the empirical distributions of the sufficient statistic and have not analyzed the distribution determined by the phylogenetic model there is a dynamic_programming for computing the distribution of n s although it seems difficult to compute the theoretical distribution of f d with similar methods it can be computed by a sampling method as shown in the supplementary_material furthermore we must investigate other nuisance parameters such as the length_scales of the constrained elements in order to decide if a consecutive segment is constrained or not lastly we assumed that the genomescale alignments provided at the ucsc site are completely reliable however there are studies that suggest that the errors contained in the multiz alignments may be considerable it will be interesting to investigate to what extent the computed statistics are sensitive to the errors of the alignments 
