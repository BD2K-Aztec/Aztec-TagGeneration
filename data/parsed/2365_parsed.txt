improved gene_tree error_correction in the presence of horizontal_gene motivation the accurate inference of gene_trees is a necessary step in many evolutionary_studies although the problem of accurate gene tree_inference has_received most existing_methods are only applicable to gene_families unaffected by horizontal_gene as a result the accurate inference of gene_trees affected by horizontal_gene remains a largely unaddressed problem results in this study we introduce a new and highly_effective for gene_tree error_correction in the presence of horizontal_gene our method efficiently models horizontal gene transfers gene_duplications and losses and uses a statistical_hypothesis framework shimodairahasegawa sh test to balance sequence likelihood with topological information from a known species_tree using a thorough simulation_study we show that existing phylogenetic_methods yield inaccurate gene_trees when applied to horizontally transferred gene_families and that our method dramatically improves gene_tree accuracy we apply our method to a dataset of cyanobacterial species and demonstrate the large impact of gene_tree accuracy on downstream evolutionary_analyses availability_and an implementation of our method is available at http compbio gene_trees and species_trees are the two fundamental types of phylogenetic_trees although species_trees represent the evolutionary_history of a set of organisms or taxa gene_trees represent the evolutionary_history of a given gene_family gene_trees play a fundamental role in understanding gene_family evolution and are used for inferring evolutionary_events such as gene_duplication and horizontal_gene inferring orthologs paralogs and xenologs reconstructing ancestral gene content and dating gene birth these powerful applications of gene_trees depend on the ability to infer them accurately however unlike species_tree construction which can benefit from the use of well behaved orthologous gene_families or multi gene species_tree reconstruction methods accurate gene tree_inference is confounded by the fact that most genes lack sufficient information to confidently support one gene tree_topology over another indeed previous_studies that even the most accurate phylogeny reconstruction methods such as neighbor_joining nj or maximum_likelihood ml e g raxml phyml that make use of sequence_information alone often produce erroneous estimates of the gene tree_topology to overcome_this many species_tree aware methods have been developed for gene tree_inference these methods make use of a known species_tree and a reconciliation model that makes it possible to extract topological information from the species_tree and use it to guide gene tree_inference some of these methods such as treebest prime gsr dlrs a kerborg et_al and spimap reconstruct a gene_tree directly from sequence_data but most such as notung tt g recki and eulenstein treefix angst and mowglinni take in previously reconstructed gene_trees and error correct them using the reconciliation model in essence these methods are based on the observation that any deviation of the gene_tree from the species tree_topology is due to the effect of evolutionary phenomena such as gene_duplication gene loss horizontal_gene or simply transfer for short and incomplete_lineage ils in many eukaryotes especially multi_cellular eukaryotes duplication and loss play the dominant role in gene_family evolution this motivates the well studied duplication loss reconciliation model that accounts for any discordance between the gene_tree and species_tree by invoking duplication and loss events almost all existing species_tree aware gene tree_inference methods are based on the duplication loss reconciliation model a however gene_families evolution is often more complex and is driven not just by duplication and loss but also by transfer events this is common for example in microbial gene_families as a result methods based on the duplication loss model perform poorly and cannot be used for gene_trees affected by transfer moreover due to the complexity of the reconciliation model based on duplication transfer and loss dtl reconciliation model there has been little systematic development of species_tree aware methods for handling gene_families with transfer consequently gene_trees affected by transfer are difficult to infer accurately two error_correction methods angst and mowglinni have recently been proposed for gene_families with transfer both work by considering alternative gene tree_topologies reconciling them to the species_tree and choosing the gene_tree that yields the best most parsimonious reconciliation angst accounts for uncertainty in gene tree_topologies by taking as input not a single gene_tree but a set of gene_trees e g bootstrap replicates and creating a new gene_tree that minimizes the reconciliation cost by piecing together clades from the set of input gene_trees mowglinni deals with topological uncertainty by considering alternative gene tree_topologies obtained by performing nearest_neighbor interchange nni operations see e g on branches of the original input gene_tree that have lower support than some user specified threshold and selecting a gene tree_topology with minimum reconciliation cost as the inferred gene_tree although angst and mowglinni are excellent first attempts they have several limitations first they are both based on a simple parsimony criterion that ignores sequence support for the inferred gene_trees making them prone to over fitting the gene_tree to the species tree_topology second both consider only a limited search_space affecting their ability to recover the true gene tree_topology third mowglinni requires the input species_trees be fully dated i e all species_tree nodes must be relatively ordered by time which is notoriously_difficult to do accurately in this study we introduce a principled error_correction based_approach for species_tree aware gene tree_inference of gene_families with transfer our method treefix dtl attempts to find a tree that has the lowest reconciliation cost under the dtl reconciliation model among all gene_trees that have a likelihood that is statistically equivalent to that of the ml tree by balancing sequence likelihood with species divergence information from the species tree_topology treefix dtl avoids the pitfalls of the existing_approaches and finds more accurate gene_trees similar ideas have been successfully used before in the context of gene_tree error_correction under the duplication loss model the idea of statistical equivalence of gene_tree likelihoods has been previously used to define islands of trees and has also been used to study the congruence between species_tree and gene tree_topologies in bacteria to evaluate the performance of treefix dtl we develop a thorough simulation framework that accounts for variations in species_tree sizes rates of gene evolution alignment lengths rates of duplication transfer and loss dtl and species_tree errors we use this framework to compare treefix dtl to angst mowglinni raxml notung and treefix raxml is one of the most widely used phylogeny reconstruction programs while notung and treefix are two well known species_tree aware gene_tree error_correction methods based on the duplication loss model we observe that treefix dtl outperforms all other methods and improves the accuracy of gene_trees across all simulation parameters specifically the contributions of this work are as follows we demonstrate that methods that do not model transfer events do not work well for gene_families with transfer we test the performance of notung and treefix on simulated gene_families with transfer and observe that they show poor_performance even on datasets with low rates of transfer we introduce treefix dtl a statistically founded approach for species_tree aware gene_tree error_correction in the presence of transfer we show that treefix dtl outperforms all other methods at accurate gene tree_inference and achieves a great_improvement in accuracy compared with raxml we show that more accurate gene_trees greatly improve the inference of evolutionary_events we reconcile gene_trees reconstructed using raxml and those inferred using treefix dtl angst and mowglinni with their corresponding species_trees and show that improved topological accuracy translates into a direct improvement in correctly inferring evolutionary_events like duplications transfers and losses dtls we show that treefix dtl leads to an almost fold reduction in the number of inferred transfer events on a dataset of cyanobacterial species we apply treefix dtl to a published dataset of cyanobacterial species that has been previously analyzed for horizontal_gene and ils and demonstrate that strikingly most of the evolutionary inferences drawn using the original dataset change when treefix dtl gene_trees are used throughout the rest of this study all trees are assumed to be binary and unless otherwise stated gene_trees are assumed to be unrooted and species_trees rooted in this study we have shed light on the complications of gene tree_inference in the presence of horizontal_gene and demonstrated that our new method treefix dtl outperforms all existing_methods at accurately inferring gene_trees with transfer treefix dtl builds more accurate gene_trees by addressing the problem of phylogenetic uncertainty several complementary approaches exist to help build more accurate gene_trees these include methods for constructing more accurate sequence_alignments e g more accurate substitution models that can better model the evolutionary_process e g etc treefix dtl can be used in conjunction with these approaches to further improve gene_tree accuracy our results show that even after error_correction with treefixdtl or other methods the inferred gene_trees are often not perfectly correct this is due to the fact that perfect inference requires that each clade in the gene_tree be inferred correctly thus even though gene_tree error_correction greatly_improves the accuracy of the gene_trees we caution against assuming that the inferred gene_trees represent fully accurate evolutionary_histories in our analysis we observed that angst performed quite well on our test datasets delivering consistently good results and even surpassing the accuracy treefix dtl in some cases thus the simple approach used by angst may be worth studying and refining further and could be especially useful when rapid error_correction is desired one of the difficulties with using angst is that users must decide on the number of bootstrap replicates to use as input for angst the number of bootstrap replicates used has a direct impact on the accuracy of the inferred gene_tree using too few bootstraps reduces the search_space but using too many leads to over fitting the accuracy and scalability of treefix dtl can be further improved by making the local_search step more efficient more efficient_search techniques or faster algorithms for local_search would make it possible to efficiently handle larger input instances and to further improve gene_tree accuracy currently if treefix dtl encounters multiple gene_trees with statistically equivalent likelihood and with the same minimum reconciliation cost it outputs the gene_tree with the highest likelihood_score in the future it might be instructive to consider all gene_trees with statistically equivalent likelihood scores and minimum reconciliation costs and to study the similarities and differences in the alternative gene tree_topologies treefix dtl assumes that among all statistically equivalent candidates for the gene_tree the one with minimum reconciliation cost is most likely to be the true tree however the true evolutionary_history of a gene_family need not always be most parsimonious it may therefore help to relax this assumption and to develop such an approach further possibly by incorporating probabilistic_models of dtl reconciliation e g that would allow for integrating over all possible reconciliations for a given gene_tree improved gene_tree error correctionfinally in this study we have focused specifically on gene_trees affected by duplications transfers and losses and do not explicitly_model ils therefore treefix dtl may remove weak but biologically_meaningful signals of deep coalescence since such events are intrinsically orthogonal to the species_tree under the dtl model this could partially account for our finding of low ils rates within cyanobacteria 
