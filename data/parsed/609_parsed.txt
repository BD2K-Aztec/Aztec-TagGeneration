automated target segmentation and real_space fast alignment_methods for high_throughput classification and averaging of crowded cryo_electron subtomograms motivation cryo_electron allows the imaging of macro molecular complexes in near living_conditions to enhance the nominal resolution of a structure it is necessary to align and average individual subtomograms each containing identical complexes however if the sample of complexes is heterogeneous it is necessary to first classify subtomograms into groups of identical complexes this task becomes challenging when tomograms contain mixtures of unknown complexes extracted from a crowded environment two main challenges must be overcomed first classification of subtomograms must be performed without knowledge of template structures however most alignment_methods are too slow to perform reference free classification of a large number of e g tens_of of subtomo grams second subtomograms extracted from crowded cellular environments contain often fragments of other structures besides the target complex however alignment_methods generally assume that each subtomogram only contains one complex automatic_methods are needed to identify the target complexes in a subtomogram even when its shape is unknown results in this article we propose an automatic and systematic method for the isolation and masking of target complexes in subto mograms extracted from crowded environments moreover we also propose a fast alignment_method using fast rotational matching in real_space our experiments show that compared with our previously_proposed fast alignment_method in reciprocal_space our new method significantly_improves the alignment_accuracy for highly distorted and especially crowded subtomograms such improvements are important for achieving successful and unbiased high_throughput reference free structural_classification of complexes inside whole cell tomograms cryo_electron enables the d imaging of macromolecular_complexes at nanometer_scale resolution in near native conditions tomograms of individual cells are essentially d representations of the entire proteome providing a snapshot of the distributions of protein_complexes however comprehensive detection of individual complexes in cell tomograms is challenging because of the inherent low_signal snr missing_data nonisotropic resolution and the fact that individual macromolecules are difficult to recognize in a highly crowded environment most methods for detecting complexes in cell tomograms rely on a template structure which serves as a reference in searching for a similar pattern in the tomogram e g however for an unbiased detection and classification of all the different complexes in a cellular tomogram template free methods are needed such an analysis is challenging and relies on three main steps first the locations of potential complexes are detected by using particle picking methods and a subregion surrounding the potential complex is extracted i e the subtomogram second the subtomogram regions corresponding only to the target complex must be detected which allows masking out all background regions which in turn contain noise and in case of crowded subtomograms also fragments of surrounding structures third reference free structural_classification of the masked subtomograms is performed which is typically based on an iterative process of subtomogram alignments classifications and averaging e g finally the averaging of aligned subtomograms of the same complexes will enhance the nominal resolution of the resulting density maps in this article we address two main challenges in reference free subtomogram classifications first we propose an automatic method for adaptive masking of target_regions in crowded subtomograms without the knowledge of the shape of the complex such a method is particularly important for subtomograms extracted from crowded environments such as the cell cytoplasm in such a case subtomograms will also contain fragmental regions of other complexes owing to the high particle_density in the tomogram masking out these regions is of great_importance in the subsequent classification process unlike automatic masking methods based on voxel weighting or dimension_reduction methods such as principle_component our method is highly scalable because it is independent of the classification process and does not involve iterative processing of a large number of subtomograms second we propose a new method for fast rotational matching of subtomograms in real_space the d subtomogram alignment is computationally the most intensive step in the classification process currently most alignment_methods are based on maximizing the overlap similarity of two subtomograms through exhaustive_search over all rigid transforms rotation and to whom correspondence should be addressed the author published_by this is an open_access the terms of the creative_commons http creativecommons org_licenses which permits non commercial re use distribution and reproduction in any medium provided the original_work for commercial re use please_contact permissions_oup com translation of one subtomogram with respect to the other e g such methods scan exhaustively through each rotational angle and find the best corresponding translation using fast_fourier fft e g these methods are computationally_intensive which limits their applicability in reference free classifications to increase alignment_accuracy local search_methods have been developed to refine initial alignments e g to increase computational efficiencies two approximate alignment_methods have been developed which separate the translational from the rotational subtomogram alignments these methods are based on similarity_scores defined in the reciprocal_space i e fourier space to separate translational and rotational search these methods use an approximate score that introduces translational invariance by eliminating the phase_information of the complex coefficients in the reciprocal_space and use only the magnitude of the fourier coefficients by expressing the structural_information in spherical harmonics sh expansion it is possible to formulate the rotational alignment as a fast rotational matching which simultaneously calculates alignment scores of all rotations using fft this procedure significantly increases the alignment speed for example our previously_published method achieved between hundreds to thousands fold speedup depending on subtomograms size and rotational angle interval compared with the standard scanning based alignment_method forster by using a translational invariance approximation of a similarity_score equivalent to a popular score proposed by forster however formulating the fast rotational matching in reciprocal_space has some limitations in reciprocal_space the majority of informative signals of a complex is usually contained in a relatively small amount of high magnitude fourier coefficients these coefficients are often occupying relatively few voxels in the reciprocal_space located within a small region centered at the origin therefore the sh expansion in the fast rotational matching may be hampered by interpolation errors which reduces the accuracy in the alignment process in contrast in real_space the signal covers a wider area within a subtomogram and the sh expansion is expected to be more accurate it is therefore beneficial to formulate fast rotational matching in real_space in addition real_space fast rotational matching uses the full constrained alignment score instead of a translation invariant approximation when the method is expressed in reciprocal_space here we devise an improved alignment_method which formulates the fast rotational matching of subtomograms in real_space to achieve_this we first identify a keypoint in the target complex whose relative location is invariant to rigid transformations and serves as the center of rotation in the fast rotational matching of the two subtomograms a natural choice is the center of mass of a complex however detection of the center of mass is not trivial and cannot be approximated by the geometrical or mass_density center of the subtomogram the reason for this complication is that tomograms are images of the crowded cellular_environment and a subtomogram contains not necessarily mass_density of only one single complex when a potential complex is detected and its subtomogram extracted as a rectangular cube then this subtomogram typically contains also fragments of other surrounding structures that occupy parts of the subtomogram then the center of mass estimation and subtomogram alignment are affected by the existence of the additional mass_density in the subtomogram it is necessary to focus only on the regions that contain the actual target complex even when a subtomogram does not contain any surrounding structures its mean intensity is often close to background intensity owing to the suppression of low_frequency signal owing to the contrast transfer_function ctf effect which also makes the estimation of the center of mass of the complex inaccurate applying our automatic target complex segmentation_method it is possible to estimate a center of mass based only on the target complex regions in the subtomogram i e the constrained center of mass once the constrained center of mass is detected we design a fast subtomogram alignment_method that uses real_space signals and takes_into missing wedge corrections using reciprocal_space signals moreover the alignment focuses exclusively on the target complex regions in each subtomogram which significantly_decreases the influence of background_noise and surrounding structures to the alignment process our experiments show that our new approach significantly increases the alignment_accuracy compared with our previous proposed fast alignment_method for highly distorted subtomograms most importantly the new method is highly_robust to the influence of surrounding structures inside crowded subtomograms 
