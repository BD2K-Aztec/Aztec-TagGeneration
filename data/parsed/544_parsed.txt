data_and a statistical_framework for biomarker_discovery in metabolomic time course data motivation metabolomics is the study of the complement of small_molecule metabolites in cells biofluids and tissues many metabolomic experiments are designed to compare changes observed over time under two experimental_conditions or groups e g a control and drug treated group with the goal of identifying discriminatory metabolites or biomarkers that characterize each condition a common study_design consists of repeated_measurements taken on each experimental unit thus producing time courses of all metabolites we describe a statistical_framework for estimating time varying metabolic_profiles and their within group variability and for detecting between group differences specifically we propose i a smoothing splines mixed effects sme model that treats each longitudinal measurement as a smooth function of time and ii an associated functional test_statistic statistical_significance is assessed by a non parametric bootstrap procedure results the methodology has been extensively_evaluated using simulated_data and has been applied to real nuclear_magnetic data collected in a preclinical toxicology study as part of a larger project lead by the comet consortium for metabonomic toxicology our findings are compatible with the previously published_studies metabolomics or metabolic_profiling experiments monitor the levels of the myriad of small_molecules in biological_systems and provide a snapshot of the metabolic_state of the organism under study metabolomics is a key part of the systems_biology approach to biological_problems reporting on a different layer of biomolecular organization to that assayed by proteomics and transcriptomics to assay metabolite_levels metabolomics_studies employ spectroscopic or spectrometric methods such as nuclear_magnetic nmr_spectroscopy to whom correspondence should be addressed or mass_spectrometry ms resulting in high_quantities of complex yet information rich data this complexity necessitates sophisticated_statistical and bioinformatic approaches to data analysis both at the level of the raw data_processing e g peak_detection alignment etc and also when investigating clustering classification and other biological_features in the data one of the most common goals in metabolomic experiments is to discover biomarkers metabolites whose concentrations are associated with metabolic_status for example one may search for metabolites that respond to a biological stimulus or which change in concentration between healthy and diseased individuals this goal extends to time series experiments where a common objective is to find metabolites whose time profiles show significant differences between conditions such metabolites may reveal novel insights into the complex regulatory mechanisms_underlying normal_physiology and how they are altered in pathological_conditions shows an example of selected time series for one spectral bin or variable taken from a real toxicology study on rats which provides some insight into the difficulties_encountered see section for more details on this study first the time series are extremely short and it is rare to find metabolomics datasets with more than time points in contrast classical approaches to time series analysis typically require several tens of data_points in order to adequately model the time variation second even within the same experimental_groups there can be a lot of biological_variability for instance the temporal_profiles for the three biological_replicates distinct biological units in this case rats shown inare different although they were all observed under the same experimental_conditions being able to accurately model this variability is therefore critical in order to detect meaningful temporal_patterns third there are missing observations either by design or because they were deemed to be outliers and hence removed or due to errors in the measurement process many classical approaches would be unable to handle these missing observations without resorting to imputation procedures finally the observations are clearly temporally correlated and the response is non linear to date most analyses of time series data in metabolomics do not explicitly include the time ordering in the model that is the same results would be obtained if the time order of the data was permuted an obvious consequence of ignoring the time ordering is that information is lost resulting in less power to discover time related structure a notable_exception is the batch modeling_approach in which the time ordered multivariate_data are regressed against the time variable using partial short individual time series observed for one metabolite creatine ppm for three example rats in the high_dose group of our example dataset shown are the raw observations with fitted individual curves from our sme model dashed lines least_squares this approach however implicitly assumes linear trends with respect to time and does not make use of any temporal autocorrelation structure present in the data other difficulties presented by the data include the high_dimensionality with thousands of spectral bins under study simultaneously strong degree of collinearity between variables and the presence of noise provides a comprehensive_review of methods appropriate for the modelling of metabolomics time course datasets ranging from differential_equations to state_space models while noting that the number of approaches is very limited and that they often fail to correctly take in to account the time ordering many of the methods discussed are motivated by datasets with many more time points than our example case study versus or where the focus is on modelling pre selected metabolites rather than identifying potentially novel biomarkers it is this established gap in the metabolomics_data analysis toolbox that has motivated the development of our proposed statistical_framework our framework is designed for modelling short high_dimensional and heterogenous metabolomic_profiles and detecting significant differences between two biological groups the first part of the framework is our proposed smoothing spline mixed effects sme model which sets out to address the challenges described above the sme model has its roots in functional data analysis fda a rapidly developing area of statistics that has been successfully_applied to longitudinal data arising in genomics experiments that exhibit very similar characteristics to metabolic_profiling data and other authors have noted the importance of taking inspiration from transcriptomics in developing metabolomics_data analysis approaches in the fda paradigm each observed time series is seen as the realization of an underlying stochastic_process or smooth curve that needs to be estimated these estimated curves are then treated as the basic observational unit in subsequent data analysis such as the task of detecting variables that exhibit a significant_difference between two groups that we focus on in this article the second part of our framework therefore is our proposed moderated functional t type statistic for quantifying the difference between two sets of curves that makes full use of the estimated within group variability obtained from the sme model several solutions to this problem have been proposed in the literature such as the use of the functional l distance or the heuristic procedure of cox and lee which discretizes the curves on a fine grid and then carries out point wise t tests our proposed test_statistic builds on these approaches by borrowing strength across all variables in order to increase power this article is structured as follows the suggested methodology based on functional mixed effect models is described in section the experimental_results are presented in section we summarize with some conclusions in section in this article we have presented our complete framework for estimation and testing in metabolomics time course datasets with the goal of identifying significant biomarkers that discriminate between two treatment groups we have focused on the development of a flexible functional model that can accurately describe longitudinal metabolomic_data and a functional t test that fully exploits the model_parameters to increase power to detect significant differences between the two groups we note that while we have demonstrated our approach with nmr the framework can be applied to any kind of longitudinal data including widely used techniques such as mass_spectrometry where its ability to handle inter_subject and inter metabolite heterogeneity can be considered a useful advantage the general functional mixed_effects has appeared in a number of different specific forms in proposed approaches for the analysis of longitudinal data arising from genomics experiments these approaches vary in their ability to handle biological_replicates analysis goalstypically either clustering ma or detecting differentially_expressed model_selection procedures and the representations used for the fixed and random_effects functions despite the wide_range of resulting models the message is clear functional mixed_effects are well suited to handling time series data that is very short noisy and replicated in this work we have set out to improve upon the existing methodology and adapt it to better suit our case study in three key ways first we have modelled the individual_level effects as full curves yielding a flexible model that can more accurately describe the often extremely heterogeneous responses we observe among different biological_replicates than simpler models such as edge second we perform model_selection on a per variable basis avoiding the possibility of overfitting that the more flexible model presents this procedure is made possible by the smoothing spline representation that simplifies the optimization for each variable to a d search of real valued smoothing parameters and avoids having to select knots third we have introduced a moderated functional t statistic that makes full use of the fitted model_parameters by incorporating the replicate level effects and borrows strength across all spectral bins to increase power the results from our simulation_study demonstrate the tangible benefits that the combined use of the sme model and moderated functional t statistic present compared with the most closely_related existing approach furthermore the ability of the model and test_statistic to give biologically_meaningful in the context of the comet study suggests these benefits are equally applicable to real_datasets 
