sequence_analysis soda a hidden_markov approach for identification of immunoglobulin rearrangements motivation the inference of pre mutation immunoglobulin ig rearrangements is essential in the study of the antibody_repertoires produced in response to infection in b cell neoplasms and in autoimmune_disease often there are several rearrangements that are nearly equivalent as candidates for a given ig gene but have different consequences in an analysis our aim in this article is to develop a probabilistic_model of the rearrangement_process and a bayesian_method for estimating posterior_probabilities for the comparison of multiple plausible rearrangements results we have developed soda which is based on a hidden_markov and used to compute the posterior_probabilities of candidate rearrangements and to find those with the highest values among them we validated the software on a set of simulated_data a set of clonally_related sequences and a group of randomly_selected ig heavy_chains from genbank in most tests soda performed better than other available software for the task furthermore the output format has been redesigned in part to facilitate comparison of multiple solutions availability soda is available online at https hippocrates duhs duke edu soda simulated sequences are available upon request b cells express immunoglobulin ig molecules on their outer_surface and secrete them into the extracellular_space secreted ig is known as antibody the genes that encode for antibodies are generated by many diversifying mechanisms including combinatorial rearrangement of gene_segments addition of non templated n nucleotides at the junctions and somatic_hypermutation this circumstance presents the important challenge of inferring the components of the original rearrangement for any observed ig gene because point_mutations cause loss of information regarding the original rearrangement there may be multiple plausible solutions in this article we present a bayesian statistical_method based on a hidden_markov hmm that allows a complete statistical to whom correspondence should be addressed treatment of the problem by providing the posterior_probability of each possible rearrangement antibodies serve as effector_molecules that neutralize microbes by binding to exposed antigens and targeting them to other components of the immune system such as phagocytic_cells and complement that effect clearance ig_genes generate diversity in two stages an antigen independent and an antigen_dependent stage antigenindependent diversity is generated in the bone_marrow where b cells originate by combinatorial rearrangement of gene_segments and junctional diversity combinatorial diversity is created in a number of ways first each antibody molecule comprises one heavy and one light_chain protein both the light and heavy_chain genes are encoded by gene_segments that are genetically rearranged during a process known as v d j recombination heavy_chains are made up of three gene segmentsvariable vh diversity dh and joining jh where as light_chains only have a v and j segment in humans there are known functional vh segments known functional dh segments and six known functional jh segments this arrangement allows for combinations in the heavy_chain alone humans also have two light_chain loci and only one of these loci is expressed per cell so that each antibody either has a light_chain or a light_chain humans have functional v j v genes and j resulting in possible chains and possible chains thus this combinatorial rearrangement alone allows for greater than million antibodies junctional diversity is the result of multiple recombination_site choices for each recombination event and the addition of n nucleotides n nucleotides are sometimes added at the junction by terminal_deoxynucleotidyl tdt between adjoining gene_segments although tdt is believed to be expressed only in pro b cells the stage in which the heavy_chain rearrangement takes_place the presence of n nucleotides in light_chains has also been seen in a few studies antigen_dependent diversity is generated by somatic_hypermutation in the periphery in a manner dependent on activationinduced cytidine_deaminase aid during this process mutations in the ig_genes are accumulated at rate of up to times the normal background rate b cells are subsequently selected for enhanced_affinity for the eliciting antigen it is estimated that these processes of diversification can generate different antibodies making it challenging to correctly identify the underlyingthe problem of inferring the correct rearrangement for antigen_receptors is difficult due to the stochastic_nature of the process but the task is important for an increased understanding of the population somatic genetics of the immune_response in this paper we present a method based on an hmm that provides a statistical basis for identifying rearrangements of ig_genes in addition to providing the posterior_probability of the top rearrangement candidate soda also provides the user with an option to see all rearrangements with sufficiently_high posterior_probabilities thus giving the user a statistically complete picture of the observed sequences origins we tested soda against simulated_datasets that were created using empirically_observed recombination_site choices for each of the gene_segments and numbers of n nucleotides in the junctions we also tested it on two clonally_related datasets as well as a set of ig heavy_chains chosen randomly from genbank our software performed as well as or better than available software on two out of three validation tests the one test where soda did not outperform all of the others involved a single rearrangement on the identical test with a different rearrangement soda did as well as its nearest competitor it is important to realize that the key feature of this article is to provide a tool based entirely on a probability model and that therefore returns results interpretable as posterior_probabilities rather than arbitrary scores as with other inferential procedures it is important to not only identify the optimal_solution but to identify near optimal solutions and have a 
