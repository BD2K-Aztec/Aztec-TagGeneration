genome_analysis gage b an evaluation of genome_assemblers for bacterial_organisms motivation a large and rapidly_growing number of bacterial_organisms have been sequenced by the newest sequencing_technologies cheaper and faster sequencing_technologies make it easy to generate very high coverage of bacterial_genomes but these advances mean that dna preparation costs can exceed the cost of sequencing for small_genomes the need to contain costs often results in the creation of only a single sequencing library which in turn introduces new challenges for genome_assembly methods results we evaluated the ability of multiple genome_assembly programs to assemble bacterial_genomes from a single deep coverage library for our comparison we chose bacterial_species spanning_a of gc_content and measured the contiguity and accuracy of the resulting assemblies we compared the assemblies produced by this very high coverage one library strategy to the best assemblies created by two library sequencing and we found that remarkably good bacterial assemblies are possible with just one library we also measured the effect of read_length and depth of coverage on assembly_quality and determined the values that provide the best results with current_algorithms a high_quality assembly of a bacterial_genome provides the basis for research into a wide_range of questions about prokaryotic biology increasingly in recent_years investigators have turned to rapid whole_genome of bacteria as part of efforts to trace the source of infectious_disease to understand the source of pathogenesis and to understand multidrug_resistance among other questions the human_microbiome which has identified thousands of new microbial_strains and species as it explores the bacteria that live on our bodies has dramatically_increased the number of new bacterial_genomes that are being sequenced on a daily basis for most bacterial genome_projects the first step in analysis is the assembly of the raw read data into larger contiguous sequences that represent the original bacterial chromosomes second and third_generation allow for remarkably fast high_throughput the latest technologies capture longer read_lengths than just a few years_ago which is expected to improve the quality of assemblies the illumina_hiseq machine routinely generates reads of bp and can generate gb in a single run a single lane of a hiseq generates gb which far exceeds what is necessary for a bacterial_genome through multiplexing it is feasible to generate deep sequencing_data for different bacteria in a single lane because the cost of preparing the dna including library_construction can be greater than the cost of sequencing many researchers have begun to adopt a strategy of sequencing just a single library for each of many bacterial_strains however it has long been assumed that whole genome_assembly projects will include data from two or more libraries with different fragment_lengths beginning with the first bacterial genome_project a typical strategy will use one short library with paired_reads from both ends of relatively short fragments e g bp with todays technology as a general rule repeats longer than the library fragment_size cannot be reliably assembled and will create gaps in the assembly thus a second jumping library will use long fragments in the range of bp to jump across these repeats next generation assembly algorithms use these libraries to great advantage and they are particularly important for large_genomes jumping libraries are more difficult to create and small fragment_libraries up to bp on the hiseq and bp on the miseq instrument are the fastest most efficient way to generate deep coverage of a genome today this motivated us to design the current study to evaluate the effectiveness of different genome_assembly software on a single short fragment library across a range of bacterial_species in recent_years various assembly tools have been used to assemble genomes of different sizes some assemblers such as velvet were originally designed for assembling small prokaryotic sized genomes whereas others such as soapdenovo and allpaths were built to assemble large mammalian sized genomes although some assemblers might not be able to handle large_genomes almost all of them have been used in assembling to whom correspondence should be addressed the author published_by all_rights for permissions please_e journals permissions_oup com this is an open_access the terms of the creative commons attribution license http creativecommons org licenses by which_permits distribution and reproduction in any medium provided the original_work bacteria several recent_studies have compared the ability of assemblers with assemble large_genomes to date no comprehensive evaluation has appeared that has considered which of these assemblers performs best although hundreds and probably thousands of bacteria have been assembled from next generation sequence_data following the standards set by the original gage assembly comparison gage b genome_assembly gold_standard evaluation for bacteria evaluates how genome_assemblers compare on a spectrum of bacterial_genomes sequenced by the newest sequencing_technologies as with gage we followed a strict standard of reproducibility which required us to use only freely_available assembly software and our results include the full recipe used for each assembler for each of the genomes our experiments were designed to answer the following questions which assembler generates the best assemblies of bacterial_organisms from a single shotgun library what depth of coverage and which software parameters should be used to produce the optimal assemblies how does high coverage by a single library compare with the use of multiple libraries how do assemblies from the longer bp miseq reads compare with assemblies of bp hiseq reads the statistics presented in tables and and supplementary tables s s support a number of conclusions about the capabilities of the various assembly methods and provide answers to the four questions posed in section first we consider which assembler generates the best assemblies of bacterial_species from a single whole_genome shotgun library although no assembler won on all the various metrics the masurca assembler had the largest contig sizes measured by either n or corrected n values for of the experiments the spades assembler a relatively recent entry into the next generation assembly field came in first or essentially tied for first for of the genomes these results were consistent across both hiseq and bp miseq reads although spades had a larger boost in improvement for the longer_reads when considering the number of errors including local errors abyss and sga consistently produced assemblies with the fewest errors these assemblers also tended to produce smaller contigs than most of the others suggesting that they use a conservative assembly strategy that trades off contig size for accuracy this result is consistent with the results of the original gage evaluation on larger genomes in most cases the number of errors did not greatly reduce the n sizes because of at least in part the distinction made here between local errors which involve insertions deletions and rearrangements kb and larger errors we only split contigs and scaffolds on larger errors for this study in contrast to our earlier gage study where we split on all errors bp we noted that for some assemblers the number of local errors tended to be larger e g soapdenovo had local errors in its assembly of v cholerae from bp reads whereas the other methods had only local errors these errors would further reduce n values if they were used to split assemblies a new quality metric that we computed across all datasets supplementary tables s s was the number of proteins contained fully within contigs this metric is tolerant of divergence between the sequenced strain and the reference because protein_sequences diverge much more slowly than nucleotide_sequences in addition this metric captures a feature of biological interest whether a typical protein is fully contained within a contig for this computation we used all annotated protein_coding from the reference_genome on this metric the spades assemblies performed the best with the largest value for of the genomes for most genomes multiple assemblers performed_similarly and there was no clear winner overall masurca and spades produced the best assemblies across these bacterial_organisms however even these assemblers have some weaknesses that should be pointed_out spades sometimes generated many small contigs that did not align to the reference_genome on inspection we found that most of these had low coverage and because spades provides detailed coverage_information one can easily filter out the low coverage contigs masurca has a different problem it sometimes creates good contigs that it labels degenerate based on internal coverage statistics which can cause it to omit some parts of the genome from the assembly this problem can be solved simply by including degenerate contigs above some minimum_length threshold as part of the assembly one of our primary motivations in gage b was to answer the question of whether deep_sequencing from a single the contigs created by both masurca and spades from a single deep coverage library were considerably larger than those from the two library data which was at lower coverage the number of errors was also slightly_lower although this could be due to improvements in assembly algorithms however the lack of long jumping pairs makes significant_difference in the size of scaffolds a single library of paired_reads from relatively short fragments simply cannot span many of the repetitive_sequences in a genome thus although the biggest scaffold with the two library strategy was over mb in length and spanned more than half of the main chromosome the best scaffolds for the one library assembly were less than onetenth as long we conclude that for gene level questions a singlesequencing library today made from either or bp reads will produce a good de_novo in which over half the genome is contained in contigs kb and in which a large majority of genes are contained within scaffolds if a closely_related genome is available it can be used to aid scaffolding but otherwise a jumping library is still necessary to produce truly large scaffolds we also considered the question of whether bp reads are superior to bp reads at a comparable cost because these reads are more expensive to produce we used fold lower coverage versus for the long_reads we obtained both read_lengths for three species m abscessus r sphaeroides and v cholerae for all of which we had a near identical finished genome tables and and supplementary tables s s show the details of these assemblies for m abscessus and v cholerae the best assemblies for the and bp reads had similar n sizes although for r sphaeroides the best n was larger with bp reads the number of proteins contained in contigs was higher in all bp assemblies except for those built by spades it may be tempting to conclude that coverage in miseq reads is inferior to coverage in hiseq reads but in looking at the details we observed that among all the assemblies of r sphaeroides five had higher contig n values when based on miseq versus hiseq data for v cholerae four assemblers performed better with miseq data and the other four performed better with hiseq data we also observed that masurca always generated better results using hiseq datasets whereas spades always generated better results using miseq data other assemblers did not show such an obvious preference our hypothesis is that many algorithms have not yet had time to adapt to the longer bp reads and once they do lower coverage with longer_reads may be superior as it already is in some cases overall our results support a conclusion that with deep sequence_coverage the latest genome_assemblers can produce good de_novo assemblies from just a single short fragment dna_library today this strategy represents the lowest cost method for capturing the entire_genome of a bacterium or other species with small_genomes the vast_majority of protein_coding will be contained wholly within contigs using this strategy although an important caveat is that large_scale changes in genome_structure particularly large rearrangements will likely not be captured our findings_suggest that multiplexing many genomes in the same sequencing run will provide a highly_effective means for studying hundreds if not thousands of bacterial_strains in the near future 
