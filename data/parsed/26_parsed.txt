bioimage_informatics a bioimage_informatics approach to automatically extract complex fungal networks motivation fungi form extensive interconnected mycelial networks that scavenge efficiently for scarce resources in a heterogeneous environment the architecture of the network is highly responsive to local nutritional cues damage or predation and continuously adapts through growth branching fusion or regression these networks also provide an example of an experimental planar network system that can be subjected to both theoretical_analysis and experimental_manipulation in multiple replicates for high_throughput measurements with hundreds of thousands of branches on each image manual detection is not a realistic option especially if extended time series are captured furthermore branches typically show considerable variation in contrast as the individual cords span several orders_of and the compressed soil substrate is not homogeneous in texture making automated_segmentation challenging results we have developed and evaluated a high_throughput automated_image and processing approach using phase congruency tensors and watershed segmentation to characterize complex fungal networks the performance of the proposed approach is evaluated using complex images of saprotrophic fungal networks with edges the results obtained demonstrate that this approach provides a fast and robust solution for detection and graph_based representation of complex curvilinear networks availability_and the matlab toolbox is freely_available through the oxford e research_centre website http www oerc ox ac uk research bioimage software contacts rapid advances in imaging_technologies have heralded a new era of quantitative_measurements that offer considerable potential to improve our understanding of complex_biological particularly those that need to be considered as integrated functional_units in particular enhanced image_processing have greatly_facilitated characterization of interconnected transport and communication networks in animal systems including vascular systems milk ducts respiratory pathways and neuronal_circuitry e g in contrast there has been remarkably little progress to characterize macroscopic microbial network development for an entire taxonomic_group of organisms namely the fungi unlike other biological_networks which exist within an organism the entire growth form of fungi is as an adaptive network foraging saprotrophic fungi play_a in ecosystem biology as they are the only organisms capable of complete_degradation of wood in temperate forests these fungi form extensive interconnected mycelial networks of multi hyphal cords that forage for scarce resources that are patchily distributed in time and space the architecture of the network responds to local nutritional cues damage or predation and the local structure is continuously remodeled through growth branching fusion or regression of the hyphal cords despite the absence of any centralized control system these organisms exhibit complex foraging and decision_making behavior as a co_ordinated individual unlike animal network models microbial networks also provide an example of an extremely tractable experimental system that can be subjected to both theoretical_analysis and experimental_manipulation in multiple replicates early measures of macroscopic mycelial organisation focussed on fractal_dimension as a useful tool to capture aspects of the network_structure as a metric however a single summary_statistic such as the overall fractal_dimension provides little opportunity to characterize the network_structure and dynamics further or to explore the underlying mechanism leading to network optimisation there has been some progress at the microscopic level to extract the physical network_structure using semi_automated image_analysis however to date delineation of the network architecture from the larger soil based systems has only been possibly manually as basic intensity based_segmentation is not effective in this context m d fricker l boddy and d p bebber unpublished_data as a result the total number of macroscopic fungal networks analysed so_far is relatively low nevertheless graph_theoretic analysis of the digitised networks has provided evidence that these indeterminate de centralized systems yield adaptive networks with both high transport capacity and robustness to damage but at a relatively low_cost through a darwinian process of selective reinforcement of key transport_pathways and recycling of redundant routes furthermore fungal networks dynamically modify link strengths and local connectivity when subject to experimental attack to readjust the balance between transport capacity robustness to damage and resource_allocation resulting in increased resilience as the environment becomes more challenging existing image_processing approaches for semi_automated fungal network extraction work best if the mycelium is grown on a suitable substrate such as cellophane or nitrocellulose to facilitate acquisition of high contrast_images the subsequent processing procedure typically involves noise_reduction using median or band pass filters intensity based thresholding with manual or automated threshold selection followed by morphological processing to achieve an improved skeletonisation of the colony structure e g barry and williams however these methods require rather specific culture_conditions and illumination regimes that cannot readily be adapted for macroscopic networks grown on soil based media which is essential to explore the natural behavioural capability of these organisms and the range of their responses in addition the branches termed cords in these systems are multi hyphal aggregates and show considerable variation in contrast as the individual cords span several orders_of in diameter from m to mm within a single colony furthermore the background from the compressed soil substrate is not homogeneous in texture or reflectivity under these conditions automatic characterization of the fungal network is challenging for conventional image_processing approaches and more advanced solutions are required we have developed a high_throughput automated_image approach to detect and characterize large complex fungal networks grown under realistic conditions we use watershed segmentation to extract the network rapidly with prior curvilinear feature enhancement to highlight the network_structure in noisy or low contrast_images the proposed enhancement method uses a novel brightness and contrast invariant approach based on the concept of local phase called the phase congruency tensor pct the resulting skeleton is then pruned on the basis of local cost functions that incorporate both intensity and tensor direction information a graph_representation of the network is constructed from the pruned skeleton to give the network_topology or a weighted network that includes edge lengths to obtain an estimate of the edge thickness which is important in predicting the physiological performance of the system the skeleton is dilated to capture the approximate dimension at each point and this value is used to set a local sampling region to estimate the reflected cord intensity for comparison with empirically_derived calibration_curves this approach ensures that even sub resolution branches can be analysed correctly an addition procedure is applied to extract the resource region which is then used to redefine a corresponding part of the graph although we apply the method here to fungal networks it has wide applicability to planar networks in any domain highlight curvilinear features and reduce background effects although other alternatives are available here we concentrate on methods based on tensors species such as p impudicus produce densely cross_linked networks with relatively well defined thick cords to summarise the complete extraction_process images of this species collected at high_resolution and high contrast were rapidly segmented using the watershed method with no additional requirement for curvi linear feature enhancement oversegmentation generally considered as a downside of the watershed transform allows in this case a rapid delineation of highdensity networks pruning based on the average_intensity of every branch was then carried_out providing a mechanism to control the overall level of detail of the final network the graphrepresentation of the network was then calculated by defining the branch or fusion points and end_points throughout the network as nodes and then determining the edges that link them the euclidean length of each edge was also calculated from the segmented skeleton and the cord thickness estimated from a sequence of morphological dilations of the skeleton until the threshold criterion was reached combined with filtered pixel intensities to capture the difference in reflectivity for cords of different dimensions the final step for the fungal networks was to identify the initial food resource and then redefine the graph in this region to connect all cords emanating from the resource with a central node the performance of the proposed approach applied to the entire image is presented in when no enhancement was applied the watershed and pruning method was less reliable for low contrast low_resolution images such as those obtained for phanerochaete velutina which has thinner more diffuse cords particularly at the growing margin with varying levels of threshold the network was initially over segmented but rapidly became dis connected as the threshold was raised making the choice of threshold critical e in comparison even these challenging networks were efficiently extracted following intensity independent pct enhancement see section for details to give a very clean network over a broad threshold range j that greatly_facilitated subsequent pruning operations to quantify the performance of our approach five complex regions of interest in the fungal images were selected manual tracing of network centerlines was performed exhaustively by an expert to give a gold_standard gs reference in total in all regions of interest network branches were annotated the gs and extracted network were compared using the network network distance measure d defined as the average distance between each point on the gs network centerline and the corresponding closest point on the extracted network centerline and vice_versa the standard_deviation d of the network network distance measures was also calculated the distance error evaluation for each roi where the network was extracted using the proposed approach based on pct vesselness is presented in for all annotated regions the average distance error was d pixel the recommended setting used to calculate the pct based vesselness can be found in supplementarypresents normalized histograms of distance error values d for all analyzed regions of interest in fungal images additionally traced lines were identified as true false_positives depending on whether a line was found in the gold_standard at a distance smaller than two pixels precision and recall were calculated for a set of comparable approaches and are shown in finally a comparison of the network thickness estimated using optical_microscope and our approach for randomly_selected measurement points is presented in supplementary figures s and s 
