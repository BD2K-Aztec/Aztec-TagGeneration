aligngraph algorithm for secondary de_novo guided by closely_related references motivation de_novo assemblies of genomes remain one of the most challenging applications in next_generation usually their results are incomplete and fragmented into hundreds of contigs repeats in genomes and sequencing_errors are the main reasons for these complications with the rapidly_growing number of sequenced_genomes it is now feasible to improve assemblies by guiding them with genomes from related species results here we introduce aligngraph an algorithm for extending and joining de_novo assembled_contigs or scaffolds guided by closely_related reference_genomes it aligns paired_end pe reads and pre assembled_contigs or scaffolds to a close reference from the obtained alignments it builds a novel data_structure called the pe multipositional de_bruijn the incorporated positional_information from the alignments and pe reads allows us to extend the initial assemblies while avoiding incorrect extensions and early terminations in our performance tests aligngraph was able to substantially_improve the contigs and scaffolds from several assemblers for instance of the contigs of arabidopsis_thaliana and human could be extended resulting in improvements of common assembly metrics such as an increase of the n of the extendable contigs by and respectively in another test aligngraph was able to improve the assembly of a published genome arabidopsis strain landsberg by increasing the n of its extendable scaffolds by these results demonstrate aligngraphs efficiency in improving genome_assemblies by taking_advantage of closely_related references availability_and the aligngraph software can be downloaded for free from this site https github com baoe aligngraph recent_advances ngs have made it possible to sequence new genomes at a fraction of the time and cost required only a few years_ago these improvements now allow experimental scientists to integrate genome sequencing_approaches into their daily research in the absence of a close reference_genome whole_genome shotgun ngs sequencing is the most common approach where a de_novo algorithm is used to join reads into longer continuous contigs and scaffolds most ngs de_novo assemblers create a string or de_bruijn representing the connections among the reads and output the paths in the graph as assembled_contigs examples of these algorithms include edena velvet abyss allpaths_lg soapdenovo masurca cabog euler usr and idba this de_novo approach fundamentally differs from alignment based resequencing approaches where the ngs_reads are not assembled but aligned against a similar reference_genome using a variant tolerant short read_aligner and structural variant detection_algorithms large_parts of the sequence of the target_genome can then be reconstructed from the mismatches indels and rearrangements observed in the alignment results de_novo assemblies tend to be computationally more challenging than alignment based_approaches additional limitations include i the assembly results are often fragmented into large_numbers of contigs ii the genome covered by the assembled_contigs scaffolds is commonly incomplete and iii the frequency of falsely assembled_contigs can be high because of chimeric joins the most important reasons for these complications are usually sequencing_errors repeat sequences in the target_genome non uniform sequencing_depth and limited read_length of ngs_data these error sources result in false_positive incomplete and branched paths in the assembly_graph and thus greatly limit the lengths and completeness of the final contigs combining both de_novo and alignment based_approaches presents a powerful alternative when a closely_related reference genome_sequence is available but its genetic_differences relative to the target_genome are too pronounced to resolve them with an alignment approach alone in this case one can first assemble the reads into contigs and then align them together with the reads to the reference the much longer contigs facilitate the identification of complex rearrangements whereas the read_alignments are useful for detecting smaller variations in regions that are not covered by contigs because of the rapidly increasing number of reference_genomes becoming available for most organism groups this referenceassisted assembly approach will soon become the default option for many genome_sequencing compared with de_novo assemblies reference assisted assemblies have many advantages first the alignments of the contigs and reads against the close reference provide valuable proximity information that can be used to extend contigs with additional reads and to join contigs even if they overlap only by a few nucleotides second the proximity information in the alignment can also be used to orient and order contigs along the reference to build a scaffold map of the entire assembly third the alignment map can be used to evaluate the quality of contigs and pinpoint potential misassemblies to whom correspondence should be addressed the author published_by this is an open_access the terms of the creative_commons http creativecommons org_licenses which permits non commercial re use distribution and reproduction in any medium provided the original_work for commercial re use please_contact permissions_oup comprevious studies on reference assisted assemblies include the amoscmp software an add on tool for the arachne assembler and custom workflows largely based on existing assembly software e g the first two were designed primarily for sanger reads whereas the latter has been used for ngs genome_assembly downstream of the primary assembly scaffolding algorithms such as raca can be used to order and orient preassembled contigs to a connection map by incorporating additional sequence_information from mate_pair or pe reads and or from closely_related genomes the resulting scaffolds often contain gaps which are unresolved sequence areas between the original contigs dedicated gapfilling algorithms can be used to partially fill these gaps more recently components of reference based strategies have also been incorporated into some of the de_novo suites themselves such as the cheat mode option of allpathslg and idba hybrid unpublished this study proposes a novel algorithm called aligngraph for improving the lengths and completeness of contigs or scaffolds by reassembling them with help provided by a reference_genome of a closely_related organism in contrast to existing referenceassisted methods aligngraph is a secondary assembly algorithm that loads the alignment information of pe reads and preassembled contigs scaffolds against the reference into a novel assembly_graph called the pe multipositional de_bruijn that we specifically_designed for facilitating secondary assemblies by traversing this graph the contigs or scaffolds of the primary assembly can be extended and joined aligngraph differs from most scaffolding algorithms by extending contigs exclusively with resolved rather than unresolved bases ns and by acting either upstream and or downstream of them aligngraphs functionalities are unique by solving several challenges in improving assembly results as a de_bruijn graph_based method it solves limitations typical for many heuristic extension methods that are often used in the de_novo area for instance if there are multiple solutions for how to extend a contig then finding the correct one can be challenging with most heuristic methods those ambiguous solutions which correspond to branched paths in the de_bruijn are usually caused by repetitive_sequences in genomes and frequently lead to early terminations of the contig extension process the de_bruijn method is often more efficient than heuristic methods in finding the correct solution here because the contextual_information required for resolving these ambiguities is maintained in the graph this issue is not as pronounced in assemblies with much longer sanger reads as those are more likely to span non repetitive_regions with repetitive_regions in between thus it is particularly important to address this problem in assemblies with short_reads in comparison with the conventional de_bruijn our pe multipositional de_bruijn has several additional advantages first many branched paths can be eliminated directly in the graph with the help of the additional pe read and alignment information this simplifies the identification of correct paths second many false_positive paths caused by sequencing_errors can be eliminated by correcting erroneous reads with correct reads that align to the same position in the reference_genome third guided by the alignment information to the reference_genome the pe multipositional de_bruijn is less affected by regionally low read_coverage that often gives rise to incomplete paths in the conventional de_bruijn as a result many incorrect extensions and early terminations can be avoided 
