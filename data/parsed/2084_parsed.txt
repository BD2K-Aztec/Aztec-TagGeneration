gmcloser closing gaps in assemblies accurately with a likelihood_based selection of contig or long read_alignments motivation genome_assemblies generated with next_generation ngs_reads usually contain a number of gaps several tools have recently been developed to close the gaps in these assemblies with ngs_reads although these gap_closing tools efficiently close the gaps they entail a high rate of misassembly at gap_closing sites results we have found that the assembly error_rates caused by these tools are fold_higher than the rate of errors introduced into contigs by de_novo assemblers we here describe gmcloser a tool that accurately closes these gaps with a preassembled contig set or a long_read set i e error corrected pacbio reads gmcloser uses likelihood based_classifiers calculated from the alignment statistics between scaffolds contigs and paired_end to correctly assign contigs or long_reads to gap regions of scaffolds thereby achieving accurate and efficient gap closure we demonstrate with sequencing_data from various organisms that the gap_closing accuracy of gmcloser is fold_higher than those of other available tools with similar efficiency availability_and gmcloser and an accompanying tool gmvalue for evaluating the assembly and correcting misassemblies except snps and short indels in the assembly are available at https sourceforge net_projects gmcloser next_generation ngs_technologies allow the low_cost and high_speed construction of unknown genome_sequences by de_novo the assembly of reads produces contigs but the extension of these contigs frequently stops at sites with repetitive_regions heterozygous alleles sequencing_errors or low read_coverage causing assembly fragmentation hence for large eukaryotic_genomes with highly repetitive and or polymorphic sequences the lengths of the contigs generated by short_read assembly are generally short contig fragments are then further linked with paired_end pe or mate_pair mp reads which are generated by sequencing both ends of dna_fragments with a range of sizes to form scaffolds scaffolds contain many gaps with a range of sizes which are estimated from the fragment sizes of pe or mp reads closing the gaps in scaffolds is an important finishing process in assembly construction because the gap regions correspond not only to repeat sequences which are often found in intergenic_regions but also to gene_encoding regions which could not be assembled because of low read_coverage or heterologous sites the effectiveness and accuracy of gap_closing significantly_affects downstream_analyses including gene_annotations for the constructed assemblies connecting the contigs non gapped dna_segments split by gaps in scaffolds and hereafter referred to as subcontig encompassing a v c the author published_by all_rights for permissions please_e journals permissions_oup com gap in a scaffold by closing the gaps increases the length of the subcontigs and its capacity to include the encoded_genes to be annotated gap_closing has traditionally been performed by manually or semi automatically sequencing pcr_products generated with primers that encompass the gaps however recently_developed gap_closing tools that use ngs_reads gapcloser b image gapfiller and finis have replaced the laborious manual gap_closing process the former three tools use a similar strategy to close gaps i alignment of pe reads to the contig regions of the scaffolds ii collection of unmapped mates when the other read of a pair is aligned to a region neighboring a gap iii local_assembly of collected unmapped reads based on de_bruijn and iv the iteration of processes iiii image is usually only applicable to assemblies of small_genomes gapcloser is designed for use as a finishing process of a soapdenovo assembler but can be used as an independent tool gapfiller is unique in that it assembles only reads that are partially aligned to span a gap and considers the consistency between the gap lengths and the lengths of the sequences used to fill the gaps to increase the accuracy finis closes gaps by constructing local_assembly graphs using reads that were not used for the assemblies and pre built contig graph information finis can only be applied to assemblies from some specific assemblers i e velvet and soapdenovo another tool to close the gaps in assemblies is pbjelly which use pacbio long_reads instead of short ngs_reads pbjelly closes gaps and corrects errors in the closed sequences that are derived from pacbio reads by adopting consensus_sequences of the multiple reads aligned to the gap regions additionally assembly merging tools pcap rep gam ngs gaa garm cisa fgap maia minimus and mix can potentially close the gaps by merging the assemblies although they are intended for assembly extension rather than gap closure in this study we demonstrated that all the existing gapclosing tools cause a high rate of misassembly at gap_closing sites to develop a gap_closing tool with a lower error_rate we adopted a strategy with which gaps are closed with a set of preassembled contigs or long_reads our strategy involves the selection of the correct alignments between scaffolds and contigs or long_reads by measuring the likelihood_ratios of the true alignments we demonstrate that this likelihood_based method allows the efficient and accurate connection of contigs and is applicable to other technologies that involve the merging or assembly of contigs or long_reads current gap_closing tools display a high rate of misassembly in the gapcurrent gap_closing tools use a strategy that aligns pe reads followed by the k_mer based local_assembly of the reads aligned around the gap regions although this strategy efficiently closes gaps itgap closing in c elegans sspace scaffolds for s cerevisiae s c and c elegans simulated pacbio reads were generated with pbsim and errorcorrection was conducted using pacbiotoca and proovread respectively gap_closing results for gapcloser and gmcloser with a real contig set fm e or sp e are shown for comparison results of successive treatments using gmcloser with a real contig set and pacbio reads are also shown fm e the bars are as in the data are from the assembly results of gmcloser at iteration the minimum alignment overlap identity to measure misassembly events with gmvalue was set to because the pacbio reads could be incompletely error correctedgap closing with gmcloserintroduces a large number of errors the high misassembly rates of the k_mer based gap_closing tools probably arise because the gap_closing process involves assembly at genomic_sites that are difficult to assemble with de_novo assemblers because the current gap_closing tools use only pe reads that are mapped to gap flanking_regions for local_assembly misassembly could occur frequently at repeated regions in which reads can be incorrectly aligned these hardto assemble sites include repetitive_regions and regions of highly_polymorphic sequences that are attributable to sequencing_errors or heterozygosity nevertheless assembly tools are likely to generate many contigs that cover gaps in the scaffolds because the gaps present in scaffolds generated with an assembler can be efficiently closed with a contig set generated with the same assembler therefore our gap_closing strategy based on the alignment of a preassembled contig set allows accurate and efficient gap_closing the assemblies in which the gaps were closed with gmcloser and with an intact contig set still contained a number of errors however most of these errors were derived from misassembly errors contained in the preassembled input contigs thus the use of preassembled contig sets generated with accurate assemblers such as soapdenovo should ensure accurate gap_closing with gmcloser the high_accuracy and high effectiveness of gmcloser for gap_closing are also due to the likelihood_based selection of the correct alignment between a contig and a subcontig of a scaffold this selection method uses likelihood_ratios for three alignment factors the alignment overlap length the alignment overlap identity and the mapping rate of pe reads which are determined statistically from true and false alignment datasets although likelihood based_algorithms or bayesian probabilistic approaches have been adapted to estimate genotypes short read_alignments and assembly errors no likelihood_based method has been developed to select the correct alignment of dna_fragments such as contigs our selection method of contig alignment should be applicable to the development of tools involving the alignment of dna sequence_sets such as assemblers of long_reads or contigs after a successive treatment of different contig sets with gmcloser a number of gap regions are still barely filled and these gap regions seem to correspond to genomic_regions with low read_coverage sequencing_reads generated with the pacbio rs platform have long read_lengths mean kb max kb and relatively constant coverage across the sequenced_genome although the sequencing_error is high the errors in pacbio rs reads can be effectively corrected with short_reads or with a multiple_alignment strategy between the pacbio reads in this study we have demonstrated that the gaps in assemblies can be efficiently and accurately closed with a low coverage of error corrected pacbio reads using gmcloser and that the gap_closing accuracy of gmcloser is better than that of another gap_closing tool with pacbio reads pbjelly this feature of gmcloser should also offer economical benefits especially for assemblies of large_genomes however the accuracy of the gap_closing with pacbio reads is lower than that with preassembled contig sets and many of the misassemblies are attributable to incomplete error_correction of pacbio reads supplementary tables s and s thus the future development of more complete methods for error_correction of pacbio reads would allow a more accurate gap closure with gmcloser 
