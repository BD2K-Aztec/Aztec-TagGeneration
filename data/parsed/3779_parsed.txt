pseudotime estimation deconfounding single_cell time series motivation repeated cross_sectional time series single_cell data confound several sources of variation with contributions from measurement noise stochastic cell to cell variation and cell progression at different rates time series from single_cell assays are particularly susceptible to confounding as the measurements are not averaged over populations of cells when several genes are assayed in parallel these effects can be estimated and corrected for under certain smoothness assumptions on cell progression results we present a principled probabilistic_model with a bayesian_inference scheme to analyse such data we demonstrate our methods utility on public microarray ncounter and rna_seq data_sets from three organisms our method almost perfectly recovers withheld capture times in an arabidopsis dataset it accurately estimates cell_cycle peak times in a human_prostate and it correctly identifies two precocious cells in a study of paracrine signalling in mouse den dritic cells furthermore our method compares favourably with monocle a state of the art technique we also show using held out data that uncertainty in the temporal dimension is a common confounder and should be accounted for in analyses of repeated cross_sectional time series availability_and our method is available on cran in the delorean package many biological_systems involve transitions between cellular_states characterized by gene_expression these systems are typically studied by assaying gene_expression over a time course to investigate which genes regulate the transitions an ideal study of such a system would track individual cells through the transitions between states studies of this form are termed longitudinal however current medium and high_throughput assays used to measure gene_expression destroy cells as part of the protocol this results in repeated cross_sectional data wherein each sample is taken from a different cell this study analyses the problem of variation in the temporal dimension cells do not necessarily transition at a common rate between states even if several cells about to undergo a transition are synchronized by an external signal when samples are taken at a later time point each cell may have reached a different point in the transition this suggests a notion of pseudotime to model these systems pseudotime is a latent unobserved dimension which measures the cells progress through the transition pseudotime is related to but not necessarily the same as laboratory capture time variation in the temporal dimension is a particular problem in repeated cross_sectional studies as each sample must be assigned a pseudotime individually in longitudinal_studies information can be shared across measurements from the same cell at different times inconsistency in the experimental_protocol is another source of variation in the temporal dimension it may not be physically possible to assay several cells at precisely the same time point this leads naturally to the idea that the cells should be ordered by the pseudotime they were assayed the exploration of cell to cell heterogeneity of expression levels has recently been made possible by single_cell assays many authors have investigated various biological_systems using mediumthroughput technologies such as qpcr and ncounter or highthroughput technologies such as rna_seq these studies have shown that cellular_heterogeneity is prevalent in many organisms and regulatory_systems the variation in gene_expression underlying this cellular_heterogeneity has been attributed to several causes both technical and biological while accounting for variation in expression levels none of these studies investigated how much is attributable to uncertainty in the temporal dimension conversely methods such as monocle and wanderlust described below have attempted to place cells in a pseudotemporal ordering but do not explicitly_model variation in the data analyses of medium and high_throughput expression assays often use dimension_reduction techniques anywhere between and several tens_of of gene_expression levels may have been measured in each sample this high_dimensional can often be better analysed after projection into a low two or three_dimensional latent space often this projection results in a natural clustering of cells from different time points or of different cell_types which can then be related to the biology of the system such clusterings may suggest hypotheses about likely transitions between clusters and their relationship in time dimension_reduction has a large literature and there are many available methods here we give a few examples of some that have been used in single_cell expression analyses principal_components pca is prevalent in analyses of expression data pca finds linear transformations of the data that preserve as much of the variance as possible in one example typical of single_cell transcriptomics studied the development of the mouse blastocyst from the one cell stage to the cell stage they projected their dimensional qpcr data into two dimensions using pca projection into these two dimensions clearly separated the three cell_types present in the cell stage multi_dimensional scaling mds is another popular dimension_reduction technique mds aims to place each sample in a lower dimensional_space such that distances between samples are conserved as much as possible used mds to study the differentiation of thp human_myeloid monocytic leukemia_cells into macrophages after stimulation with pma their primary mds axis explained the temporal_progression through the differentiation their secondary mds axis explained the early response of the cells to the stimulation they had undergone independent components analysis ica projects high_dimensional into a latent space that maximizes the statistical independence of the projected axes used ica to investigate the differentiation of primary human myoblasts the latent space serves as a first stage in their pseudotime estimation algorithm monocle see below gaussian_process gp latent_variable gplvms are a dimension_reduction technique related to pca they can be seen as a non linear extension to a probabilistic interpretation of pca and buettner and theis used gplvms to study the differentiation of cells in the mouse blastocyst they used qpcr data fromwho had analysed the expression of genes in cells spanning the to cell stages of blastocyst development buettner et_al were able to uncover subpopulations of cells at the cell stage one stage earlier than guo et_al had identified using pca the latent space in all of the methods above is unstructured there is no direct_physical or biological_interpretation of the space and the methods do not directly relate experimental covariates such as cell_type or capture time to the space the samples are placed in the space only to maximize some relevant statistic although the analysis often reveals some additional structure for example one axis may coincide with the temporal dimension of the data or cell_types may be clearly separated in these cases the structure has been inferred in an unsupervised manner however there is no guarantee that the methods above will uncover any specific structure of interest for example a pseudotime ordering here we propose to impose an a priori structure on the latent space in the model presented in this article the latent space is onedimensional and the structure we impose on the space relates it to the temporal_information of the cell capture times that is the latent space represents the pseudotime a number of methods have been proposed to estimate pseudotimes in gene_expression time series proposed a temporal scaling method dynb to estimate pseudotimes dynb shifts the observed time by a multiplicative factor representing speed of transition through the process it is applicable to longitudinal rather than repeated cross_sectional time series aij et_al modelled rna_seq count_data from human th cell_differentiation using a negative_binomial with a time varying mean for each of three biological_replicates they analysed subpopulations of cells at given time points resulting in three time series of longitudinal data the time varying mean was fit using a gp over the scaled pseudotime space they compared this pseudotime based model favourably with a similar model that only used the capture time points have developed the monocle pseudotime estimation algorithm monocle is a two stage procedure first it uses the ica dimension_reduction algorithm to map gene_expression data into a low dimensional_space second it finds the minimal spanning tree mst over the samples locations in this space this spanning tree is used to assign a pseudotime to each cell trapnell et_al show how monocle can be used to identify pseudotemporal ordering switch like changes in expression novel regulatory_factors and sequential waves of gene_regulation have developed the waterfall pseudotime estimation algorithm that is closely_related to monocle waterfall reduces the dimension of the data to using pca uses k_means in this space to group the data and calculates a mst over the cluster centroids to induce a pseudotime trajectory after estimating the pseudotime waterfall uses a hidden_markov hmm to infer when genes switch on and off campbell et_al have a body of work investigating pseudotime estimation they developed the embeddr r package that uses a similar approach to monocle but with some significant differences they use laplacian eigenmaps for dimensionality_reduction instead of ica and fit pseudotime trajectories using principal curves rather than msts dissatisfied with the point_estimates of pseudotimes such an approach generates they subsequently developed a fully bayesian probabilistic_model using gps wanderlust is a graph_based pseudotime estimation algorithm developed by wanderlust arranges the highdimensional input_data into a nearest_neighbour graph wherein cells that have similar expression_profiles are connected wanderlust then applies a repetitive randomized shortest_path algorithm to assign an average pseudotime to each cell bendall et_al used wanderlust to analyse human b cell lymphopoiesis the monocle waterfall embeddr and wanderlust algorithms do not make a connection between the cell capture times and the estimated pseudotime explicitly this has two effects first in the inference of the pseudotime nonsensical results are possible such as pseudotimes whose order is far from the capture times second the estimated pseudotimes are not on the same scale as the capture times they are quantified in arbitrary temporal units oscope is a method for detecting groups of oscillatory genes when a group is detected oscope uses an extended nearest insertion algorithm to place the cells in pseudotime order we have presented a principled probabilistic_model that accounts for uncertainty in the capture times of repeated cross_sectional time series we have fit our model to three separate datasets each using a different biological assay microarrays single_cell ncounter and single_cell in three organisms human mouse and arabidopsis our model provided plausible estimates of pseudotimes on all the datasets we validated these estimates technically by evaluating the smoothness of the expression_profiles of held out genes in two of the datasets these profiles are significantly smoother than expected under the null_model in addition we validated the estimates biologically using obfuscated capture times inangles these two cells have been placed at a later pseudotime than the other cells captured at h a loess curve has also been plotted through the data the arabidopsis dataset data from separate experiments cell_cycle peak times and independent analyses identification of precocious cells overall these results demonstrate that uncertainty in the temporal dimension should not be ignored in repeated cross_sectional time series of single_cell data and that our method captures and corrects for these effects our method has a number of attractive attributes it explicitly estimates pseudotimes in contrast to methods such as monocle and wanderlust which estimate orderings of cells the pseudotimes are on the same scale as the experimental capture times the orderings estimated by monocle and wanderlust have no scale in our model consecutive cells that have diverse expression_profiles are placed further apart in pseudotime than similar cells thus our pseudotime estimates quantify the rate of change of the system for example in the arabidopsis example we analysed the cells are spread out in pseudotime around the h mark suggesting changes in expression levels in response to the infection are greatest at this time point our method uses gps which are a natural framework to model noisy expression_profiles gps are well established probabilistic_models for time series they provide more than just point_estimates of the profiles they also provide a measure of posterior uncertainty this is useful in downstream_analyses such as regulatory_network a gp model is characterized by its covariance function and associated parameters and the covariance functions in our model have interpretable parameters gene specific temporal_variation and noise we have also demonstrated how a gp framework is suitable for modelling periodic expression_profiles such as cell_cycle expression_profiles the primary limitation of gps for our model is that inference complexity scales cubically in the number of samples for this reason our method is not applicable to data from many hundreds_or of cells like monocle and wanderlust inference in our model is performed using markov_chain this technique provides a full posterior_distribution over the model_parameters however mixing over the pseudotime parameters in our model can be difficult and we found that our model did not mix well when fit to the cell_cycle dataset in this case we analysed expression_profiles from the sample with highest log probability and found they estimated cell_cycle peak times well single_cell assays give us an exciting opportunity to explore heterogeneity in populations of cells as the technology develops and the cost of undertaking such assays drops they are destined to become commonplace in addition high_throughput longitudinal_studies remain impractical and for the foreseeable_future the majority of such time series will be repeated cross_sectional in nature until this changes there will be challenges associated with estimating uncertainty in the capture times and variation in the rate of progress of individual cells through a system our method explicitly_models these effects and is a practical tool for analysis of such repeated crosssectional time series furthermore in contrast to wanderlust our method only depends on open_source and is available under a liberal open_source 
