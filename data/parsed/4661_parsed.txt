sequence_analysis threshold average precision tap k a measure of retrieval designed for bioinformatics motivation since database retrieval is a fundamental operation the measurement of retrieval efficacy is critical to progress in bioinformatics this article points out some issues with current methods of measuring retrieval efficacy and suggests some improvements in particular many studies have used the pooled receiver_operating for n irrelevant records roc n score the area_under auc of a pooled roc_curve truncated at n irrelevant records unfortunately the pooled roc n score does not faithfully reflect actual usage of retrieval algorithms additionally a pooled roc n score can be very sensitive to retrieval results from as little as a single query methods to replace the pooled roc n score we propose the threshold average precision tap k a measure closely_related to the well known average precision in information_retrieval but reflecting the usage of e values in bioinformatics furthermore in addition to conditions previously given in the literature we introduce three new criteria that an ideal measure of retrieval efficacy should satisfy results psi_blast global hmmer and rps blast provided examples of using the tap k and pooled roc n scores to evaluate sequence retrieval algorithms in particular compelling examples using real_data highlight the drawbacks of the pooled roc n score showing that it can produce evaluations skewing far from intuitive expectations in contrast the tap k satisfies most of the criteria desired in an ideal measure of retrieval efficacy availability_and the tap k web_server and downloadable perl script are freely_available atin bioinformatics retrieval from databases is a fundamental operation therefore progress depends on being able to recognize superior retrieval algorithms so the measurement of retrieval efficacy is critical in bioinformatics stated that an ideal to whom correspondence should be addressed measure of retrieval efficacy or more simply a retrieval measure should satisfy four conditions it should concern itself solely with the effectiveness of separating the relevant from the non relevantand not with the efficiency of resource use it should not be dependent on athreshold but should measure the potential output of the method it should be a single number it should have absolute significance as a measure of a single method and should readily allow comparisons of different methods to decide which is best to fix our terms when a user queries a database of r records a retrieval algorithm typically lists up to r records ranked by some score s indicating the probability that the corresponding record has relevance to the query in text retrieval e g google or pubmed results retrieval lists do not indicate the scores producing their list orders in a significant break with the traditions of information_retrieval however bioinformatics retrieval often explicitly presents an e value with the score so users are free to choose an e value threshold e and then ignore the retrieval list beyond e for concreteness we discuss only e values but the methods in this article apply to any score s note that e values and the retrieval ranks increase together in accord with the motivation behind e values modified swets it should be characterized by athreshold but should reflect the quality of retrieval at every rank down to that threshold wilburs modification implicitly respects an overarching principle governing retrieval measures which we call the principle of fidelity a retrieval measure should faithfully reflect the actual usage of the retrieval list if not the measure might be ideal in some abstract sense but would lack a practical meaning the principle of fidelity supports wilburs condition in bioinformatics because an e value threshold e influences the actual usage of a retrieval algorithm since a user rarely examines a retrieval list far beyond the e value threshold e any practical measure of database retrieval in bioinformatics should reflect the users e the rest of this article therefore disregards swets condition in favor of wilburs condition referring to the result as the swetswilbur conditions page in this section we compare the tap k to the pooled roc n score first we examine the effect of using the median epq versus using the mean epq next we show how a single query can skew the pooled roc n score then we present an example of calculating the e value threshold for k median epq finally we show how varying the e value threshold affects the tap k this article is not the first to question the pertinence of roc_analysis to information_retrieval in fact many other researchers have pointed_out the superiority of pr curves over roc_curves in information_retrieval advises that pr graphs are commonly used where the number ofis many orders_of greater than the number of relevant records the common case for database retrieval and most of bioinformatics likewise liu and shriberg suggest that for an imbalanced dataset pr curves generally provide better visualization than do roc_curves for viewing differences among different algorithms similarly davis and goadrich warn that with highly_skewed datasets pr curves give a more informative picture of an algorithms performanceand that by comparing false_positives to true_positives rather than true_negatives captures the effect of the large number of negative_examples on the algorithms performance argue that roc_analysis effectively ignores the minority class of relevant records several bioinformatics studies have relied on roc_analysis as their figure_of for automatic improvement of database retrieval algorithms as a figure_of however the pooled roc n score suffers from defects so obvious that other bioinformatics studies wisely in our opinion have gone so_far as to defend conclusions drawn from the pooled roc n score by checking individual retrieval lists clearly if the defects of the pooled roc n score require human intervention it is inadequate to the task of automated improvement of retrieval algorithms to provide explicit logical foundations for the discussion about the inadequacies of retrieval measures this article also articulated a principle of fidelity a retrieval measure should faithfully reflect the actual usage of the retrieval list in harmony with the principle of fidelity we suggested adding conditions to the swetswilbur conditions for an ideal retrieval measure the section demonstrates that the pooled roc n can violate conditions and condition is common_sense so its failure inis particularly disturbing on the other hand since the tap k is an average over all queries conditions and both follow as rigorous mathematical truths moreover consideration of the geometry of a roc_curve shows that the roc n always increases with the epq or equivalently with the e value threshold in violation of condition on the other hand the tap k sometimes does satisfy condition shows its eventual decrease against an increasing e value threshold e interestingly the peak_values inoccur at values of e a not entirely outside acceptable ranges of the e value thresholds for the corresponding algorithms perhaps leading to the hope that even the selection of threshold e values e might be automated unfortunately the supplementary_material gives an example of retrieval lists where the tap k increases monotonically with the e value threshold although the tap k has many properties desirable to optimizing retrieval algorithms automatically it is currently unable to serve as a basis for automated determination of a best e value threshold e a for concreteness this article has discussed e values but in fact it is pertinent to any score s not just to e values the e value is really just a type of score that retains theoretical meaning across different queries as a surrogate for a records probability of relevance like other scores however e values do not predict the relevancy of records with complete accuracy and the accuracy depends very much on the application thus if a particular algorithm a produces a retrieval list a user willing to tolerate about a median k epq must apparently learn the corresponding 
