gene_expression grape rna_seq analysis_pipeline environment motivation the avalanche of data arriving since the development of ngs_technologies have prompted the need for developing fast accurate and easily automated bioinformatic_tools capable of dealing with massive datasets among the most productive applications of ngs_technologies is the sequencing of cellular rna known as rna_seq although rna_seq provides similar or superior dynamic range than microarrays at similar or lower cost the lack of standard and user_friendly pipelines is a bottleneck preventing rna_seq from becoming the standard for transcriptome_analysis results in this work we present a pipeline for processing and analyzing rna_seq that we have named grape grape rna_seq analysis_pipeline environment grape supports raw sequencing_reads produced by a variety of technologies either in fasta or fastq format or as prealigned reads in sam bam format a minimal grape configuration consists of the file location of the raw sequencing_reads the genome of the species and the corresponding gene and transcript annotation grape first runs a set of quality_control steps and then aligns the reads to the genome a step that is omitted for prealigned read formats grape next estimates gene and transcript_expression calculates exon_inclusion levels and identifies novel transcripts grape can be run on a single computer or in parallel on a computer cluster it is distributed with specific mapping and quantification tools but given its modular design any tool supporting popular data interchange formats can be integrated availability grape can be obtained from the bioinformatics and genomics website at http big crg cat services grape the development of ultrasequencing technologies during the recent_years has started a major revolution in biology the ability to directly survey the cells rna content by applying ngs_technologies to cdna sequencing rna_seq has provided insights of unprecedented depth on the transcription landscape of many species such as homo_sapiens mus_musculus arabidopsis_thaliana saccharomyces_cerevisiae and schizosaccharomyces_pombe rna_seq has proven particularly powerful on tasks such as identifying novel genes and novel splice_forms detecting low_abundance transcripts and finding sequence_variations such as snps it is gradually substituting microarrays as the technology of choice for transcriptome analyses providing access to a greater dynamic range of rna expression levels the throughput of ngs_technologies is continuously accelerating and the cost per sequenced nucleotide is rapidly falling as a consequence an unprecedented amount of data are being produced pressing for the development of fast and efficient methods of analysis as the bottleneck for scientific discovery is gradually shifting from data production to data analysis in the analysis of ngs_data processing efficiency is governed predominantly by two factors first the sheer size of the individual_datasets and second the vast number of datasets to be analyzed the current_generation of sequencing_machines for example illumina highseq can produce the equivalent of the coverage of the human_genome in a single run delivering million_reads with a length of nt this has spawned a new generation of aligners optimized for aligning short_sequences to the genome for example bowtie bwa bfast and gem which are much faster than previous tools such as basic_local fasta or ssearch see for a short review additionally an increasing number of projects involve large_sample to be analyzed often under complex experimental_designs in the specific case of rna_seq mapping of reads is only the first step of a complex data_processing schema the final goal of which is to produce accurate gene and transcript quantifications and to delineate novel transcript structures the lack of easy touse pipelines to perform such a processing out of the box in a transparent and streamlined fashion is actually a bottleneck that prevents the expansion of rna_seq and prompts users with little access to sophisticated bioinformatic resources to prefer microarrays for which standard ready to use processing pipelines and user_friendly bioinformatic_analysis tools exist to address this need specific pipelines have recently been developed for analyzing rna_seq such as the pipeline developed by an analysis_pipeline developed in r within the context of the arrayexpress database these and other tools facilitate the analysis of rna_seq but still require the user to have a significant bioinformatics background specifically when complex experiments with a large number of datasets need to be analyzed to whom correspondence should be addressed the author published_by this is an open_access the terms of the creative commons attribution license http creativecommons org licenses by which_permits distribution and reproduction in any medium provided the original_work here we describe grape a workflow for the analysis of rna_seq that automates all the steps from rna_seq to transcript quantification and discovery its user_friendly interface provides the necessary overview of all the data and is therefore particularly suited for processing numerous files produced in complex experimental_setups the results both intermediate and final are stored in an mysql_database allowing for access through the database interface but can also be visualized through raisin a user_friendly web_application the same html interface that is used for standalone local analysis is easily deployed on a web_server for remote access in collaborative projects or data dissemination grape takes three types of input_files first the read files which may be aligned or not the reference genome_sequence file and the corresponding gene_annotation file alternatively grape can also take read_alignment files as input rather than raw read files grape produces a number of output_files in tabular format so they can be easily loaded into most statistical packages while this is the case for quantifications which are made available individually at the gene transcript and exon level the bam format is used as an output format for alignments more specifically processing of rna_seq by grape involves the following steps i sequence_read evaluation and trimming if required ii mapping to the genome and the transcriptome iii assembly of reads in absence of a reference_genome or before genome_mapping iv identification of novel exons and splice_junctions and modeling of transcript structures and v gene and transcript quantification grape pays special_attention to quality_controls qcs which trace quality_scores and uncalled bases along the reads look for biased nucleotide_composition and inspect the distribution of reads along transcripts these can be used for qc although grape leaves any decision to modify the data such as trimming and filtering to the user grape is based on the pip pipeline management system the current grape distribution uses samtools the gem mapper the flux capacitor and cufflinks but any tool compliant with popular data interchange formats like gff bam sam and bed can be used grape can be run locally or on a computer cluster speed up of the analyses is achieved by parallelizing certain steps and taking_advantage of multithreading where possible the grape implementation conserves a copy of the exact software and configuration used for a given set of analyses guaranteeing forward reproducibility here we presented and discussed grape an architecture for a computational_pipeline for the analysis of millions or billions of short_reads obtained from potentially many high_throughput rna_seq experiments this is a general and flexible pipeline that combines contributions of previous_studies with our own experience dealing with rna_seq grape attempts to address the challenges both from the processing and management standpoints associated to the analysis of sheer amounts of data it automates the processing and analysis steps while at the same 
