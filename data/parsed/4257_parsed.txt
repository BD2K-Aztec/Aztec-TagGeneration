simseq a nonparametric approach to simulation of rna sequence_datasets motivation rna_sequencing analysis methods are often derived by relying on hypothetical paramet ric models for read_counts that are not likely to be precisely satisfied in practice methods are often tested by analyzing data that have been simulated according to the assumed model this testing_strategy can result in an overly optimistic view of the performance of an rna_seq analysis method results we develop a data based simulation algorithm for rna_seq the vector of read_counts simulated for a given experimental unit has a joint_distribution that closely matches the distribution of a source rna_seq dataset provided by the user we conduct simulation_experiments based on the negative_binomial and our proposed nonparametric simulation algorithm we compare performance between the two simulation_experiments over a small subset of statistical_methods for rna_seq analysis available in the literature we use as a benchmark the ability of a method to control the false_discovery not surprisingly methods based on paramet ric modeling assumptions seem to perform better with respect to false_discovery control when data are simulated from parametric_models rather than using our more realistic nonparametric simulation strategy over the past_decade new high_throughput next_generation has become readily available for gene_expression of rna samples the new next_generation has unseated the previous dominance of microarray_technology offering low sequencing_costs more detailed sequencing information and a wider_range of signal_detection a main focus in the statistical_analysis of an rna_seq dataset is the detection of differential_expression a gene is considered to be differentially_expressed de across a set of conditions if the mean gene expression_level as measured by rna_seq read_count differs among any of the conditions otherwise we say the gene is equivalently expressed ee or is a null gene for the sake of exposition we assume that the statistical_analysis under discussion is on the gene level though our comments could apply equally well to count datasets involving other genomic_features for which counts can be reliably obtained the principal differences between the simseq algorithm for simulating rna_seq and the nb simulations are that the simseq algorithm makes no parametric distributional assumptions and preserves the complex gene dependence_structure of the original dataset in contrast the nb method simulates data for each gene independently according to marginal nb distributions thus we should expect methods that are more robust to varying distributional assumptions to behave more similarly between the two simulation_methods conversely methods that are less robust to departures from the parametric distributional assumptions on which they are based should perform worse when applied to the simseq simulated_data under the samseq and voom methods which are not based on nb assumptions there is little difference between the two simulation types in terms of average fdp in contrast we see substantial differences in fdr control properties across simulation types for the other analysis methods that rely on nb assumptions the difference in the results between the two simulation_approaches in terms of fdr control is important to point out some methods that appeared to control fdr or were slightly liberal with respect to fdr control under the nb simulations failed to control fdr under the simseq simulations further the ranking of each of the methods in terms of fdr control sometimes differed depending on whether nb or the simseq simulation was used it is also worth discussing the liberalness of the deseq and edger methods in general although other simulation_studies have already indicated that both of these methods exhibit liberalness in fdr control our simulation_study shows even greater discrepancies between nominal and actual fdr control when these methods are applied to datasets simulated by simseq from the heterogeneous kirc dataset when we repeated the simulation_study using the bottomly et_al dataset as the source dataset for which the nb assumption may be more reasonable the liberalness of the two methods decreased although both methods still remained liberal using the additional cooks distance filtering criteria as implemented in the deseq package reduced the difference in average and supplementary figs s and s is the larger variation in simulation_results for simseq compared with the nb simulation method this larger variation is a consequence of the realistic dependence from gene to gene in data simulated by simseq dependence among genes leads to dependence among p values within each analysis this dependence among p values leads to greater variation in quantities computed from p values such as estimates of fdr and sample quantiles of the p values from null genes results from nb simulations with independent genes may lead researchers to underestimate the uncertainty in simulation based estimates of fdr simseq creates a less optimistic but more accurate picture of the uncertainty that can be expected when analysis methods are applied to real rna_seq we also compared the performance of the four statistical_methods using partial area under_the paurocc paurocc indicates how well an analysis method rank orders genes from most significant to least significant the specific value of paurocc utilized was calculated as the area under_the for specificity values these specificity values_correspond to type_i no larger than paurocc was neither systematically higher nor systematically lower under the nb simulations over the class of statistical_analysis methods studied a factor to consider when using the simseq package is the choice of the source dataset the source datasets used in this article were the kirc dataset from the cancer_genome and the bottomly et_al dataset for the kirc dataset the samples stem from a heterogeneous_population crossing diverse factors such as race gender age and ethnicity this is in contrast to the bottomly et_al dataset that contains homogeneous samples with genetically identical mice the simulation_experiments of section indicate that there are larger differences in average fdp minus target fdr level between the simseq simulations and the nb simulations for our source datasets based on a heterogeneous_population than for the source dataset based on a more homogeneous_population to investigate the performance of analysis methods on relatively homogeneous observational or experimental units more homogeneous source datasets should be used as more large rna_seq become publicly_available the number and variety of source dataset options will increase in conclusion important performance benchmarks such as average fdp relative to nominal fdr can change drastically between the two simulation procedures depending on the statistical_method used the simseq algorithm simulates rna_seq that closely matches the marginal distributions and complex dependence_structure of real rna_seq simulation_studies using this method more accurately_reflect average fdps likely to be obtained in practice simulation_experiments that rely on parametric_models may paint an overly optimistic picture for the efficacy of a given method as such in evaluating current and future statistical methodologies in gene_expression analysis we recommend using the simseq algorithm because it more closely matches the complex structure of rna_seq 
