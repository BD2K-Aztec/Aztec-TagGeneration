genetics_and two novel pathway analysis methods based on a hierarchical_model motivation over the past_few several pathway analysis methods have been proposed for exploring and enhancing the analysis of genome_wide association data hierarchical_models have been advocated as a way to integrate snp and pathway effects in the same model but their computational_complexity has prevented them being applied on a genome_wide scale to date methods we present two novel methods for identifying associated pathways in the proposed hierarchical_model the snp effects are analytically integrated out of the analysis allowing computationally_tractable model_fitting to genome_wide data the first method uses bayes_factors for calculating the effect of the pathways whereas the second method uses a machine_learning algorithm and adaptive lasso for finding a sparse solution of associated pathways results the performance of the proposed methods was explored on both simulated_and the results of the simulation_study showed that the methods outperformed some well established association methods the commonly used fishers method for combining p values and also the recently_published bgsa the methods were applied to two genome_wide datasets that aimed to find the genetic_structure of platelet_function and body_mass respectively the results of the analyses replicated the results of previously_published pathway analysis of these phenotypes but also identified novel pathways that are potentially involved it is increasingly_recognized that pathway analysis can support exploration of genome_wide gwas data by incorporating the available biological_knowledge of genes and pathways pathway analysis has gained great popularity over the past_few and several methods have been proposed one of the first proposed and most popular pathway analysis methods for gwas data is gene_set gsea gsea was originally proposed for pathway analysis of gene_expression microarray_data and later adjusted byfor gwas data gsea tests the null_hypothesis that the pathway genes or snps are no more associated with the studied phenotype than the non pathway genes or snps and is an enrichment method in the terminology of goeman and buhlmann other pathway analysis methods include fishers method fm its test_statistic depends on the product of the pathway gene snp p values in addition proposed the adaptive rank truncated product method artp for pathway analysis of gwas data the artp method is a generalization of fm based on the product of the most significant pathway gene or snp p values the number of the smallest p values multiplied is found through a permutation procedure in addition a number of online bioinformatics_tools have made their appearance over the recent_years that test whether the pathway in question contains more significant genes than expected by chance using either the hypergeometric_test or fishers_exact most of the current pathway analysis methods are frequentist methods that depend on the results of single snp analysis in this article two novel methods are proposed that are based on a hierarchical framework that models both pathway and snp level effects as discussed by hierarchical modelling is another form of pathway association testing pointed_out that hierarchical modelling and shrinkage techniques have not been widely used in pathway analysis on the other hand bayesian_hierarchical modelling is discussed as a powerful technique in decreasing the signal_to in gwas and for handling the problems of multiple_comparisons observed in several statistical applications for example analyzing gwas data few pathway analysis methods have been published that use hierarchical modelling for identifying associated pathways two are the bgsa method suggested byand the method proposed by bgsa is based on a two level hierarchical_model where in the first level the unsquared cochranarmitage statistics of the lead snp of each gene are assumed to follow a normal distribution with mean zero a scaled inverse distribution is assumed for the variance to whom correspondence should be addressed the author published_by this is an open_access the terms of the creative commons attribution license http creativecommons org licenses by which_permits distribution and reproduction in any medium provided the original_work of the snp parameters on the second level a mixture of scaledinverse distributions is assumed for the variance of the gene parameters of each pathway a p value of association between the tested pathway and the phenotype is computed using markov_chain proposed a mixed model that includes a fixed_effects component that represents the mean disease contribution of a tested pathway and a random_effects component that represents how the association of the pathway gene members with the disease varies around the pathway mean as discussed by those authors the proposed model allows information to be borrowed across genes in the same pathway it further corrects for ld between snps and for the presence of overlapping genes in contrast to the methods proposed byand the two methods proposed in this article use the individual genotype data and do not depend on the results of single snp analysis furthermore in contrast to other hierarchical_models that incorporate either the snp pathway membership or the gene pathway membership in the second stage of their multilevel_models our framework models hundreds of snps and pathways instead of a small selection of them furthermore our methods do not depend on markov_chain techniques for identifying associated pathways the two methods differ in the prior_distribution assumed for the pathway parameters the first method assumes a normal distribution for the pathway parameters with mean zero and diagonal variancecovariance matrix with equal entries it uses bayes_factors to test whether the pathways are associated with the phenotype the second method assumes a normal distribution with mean zero and a diagonal variancecovariance matrix whose entries are not necessarily equal this method adapts an iterative algorithm proposed bythat uses an adaptive lasso algorithm that shrinks the diagonal entries towards zero in this article this algorithm is adapted for finding the set of associated pathways that explain the most variation of the studied phenotype first the two proposed methods were applied to simulated_data then we applied the two proposed methods to two different gwas_studies that have been previously described by the first gwas which we refer to as the platelets gwas aims to find the genetic_structure of platelet_function these data were first presented by the second gwas which we refer to as the epicnorfolk gwas aims to find the genetic_structure of body_mass bmi as part of the epic norfolk study in this article a bayesian_hierarchical framework is proposed that incorporates pathway membership of snps through a two level hierarchical_model for identifying pathways associated with a phenotype the phenotype of an individual is modelled to depend on both its genotype and on a common contribution from alleles in each pathway the snp effects over the common contribution from pathways they are members of are assumed to be distributed identically and independently these snp effects are considered nuisance parameters and integrated out of the analysis so that the pathways associated with the disease can be identified intuitively as is typical for random_effects integration over snp effect implies a correlation_structure in the noise that is dependent on genotypes individuals with similar genotypes show similar deviations from expected_values of the regression_model within this hierarchical setting we proposed two methods for selecting pathways as predictor_variables for the phenotype the nbf and the snal methods test the predictive_power of a pathway and hence its association with the phenotype nbf uses the bf of the model that drops the pathway of interest over the full model that includes all pathways see an alternative way to test for association was to compute the bf of the model with no pathways included over the one that includes the pathway of interest which shows similar slightly inferior performance as fm data not shown and has not been further considered here alternatively a full model_selection with a combinatorial search over all possible sets of pathways could be performed but would be computationally_demanding and has also not been considered here on the other hand snal balances sparsity of predictors with explanatory_power the iterative algorithm proposed bythe simulation_study showed that both snal and nbf are able to identify pathways associated with the phenotype further the performance of nbf improves with increasing pathway size whereas that of snal is unaffected by the size of the pathways this can be explained by the fact that some of the smaller pathways are subsets of larger pathways therefore the predictors of the model are correlated and nbf finds sparser solutions with good predictive behaviour by dropping some of these pathways nbf has the advantage over snal to be easily parallelized the computing time of snal crucially depends on the algorithm used for a subroutine solving an l norm regularization problem we used the least angle regression algorithm in this study depending on the number of predictors other algorithms for example based on coordinate descents could perform well the two methods were applied to the data of two gwas on the genetic_structure of platelets function and body_mass through simulation suitable hyper parameters of nbf and snal were found as well as the appropriate bf cut_off and tuning parameter that gave an fpr of as we pointed_out in section the smaller the value of the more shrinkage is applied and the fewer associated pathways are found the shrinkage parameter of snal when applied to the bmi dataset was found to be larger than the one of the platelets gwas of as discussed earlier this is probably due to the variation of the studied phenotype and the number of correlated variables within the model snal identified more pathways for bmi than nbf whereas nbf found more pathways for platelet_function than snal the results of the simulations showed that the methods outperform both fm and bgsa bgsa is one of the recently published_methods for pathway analysis that uses hierarchical modelling for identifying associated pathways compared bgsa with the well known pathway enrichment_methods aligator and gsea the results of their analysis showed that the bgsa outperforms both methods in addition we have recently_published a comparison of current pathway analysis methods three well known association methods were adapted to test the competitive null_hypothesis that the pathway genes are no more associated than the non pathway genes the three adapted association methods tail strength measure fm and artp were compared with competitive methods hypergeometric_test and gsea the results of the analysis suggested that artp and fm should be preferred for both competitive and association testing it should be noted that association methods have in principle better performance than competitive methods as their tested null_hypothesis is more stringent these results led us to compare our new methods with fm and bgsa although the proposed methods are formulated in a bayesian_framework an advantage is their implementation without timeconsuming monte_carlo and their ability to deal with both large_numbers of tested snps and pathways they are also easily adapted to include other functional information on the snps in the design matrix p this is comparable with the work of chen and witte but with the difference that our methods can handle larger numbers of snps and any individual_level covariates this is potentially important when dealing with structured populations or when allowing for environmental_exposures we have considered a two level model with snps assigned to pathways but further levels of grouping snps for example in genes can be easily included potentially improving power by borrowing more information this approach might be useful when dealing with rare_variants that individually contribute little information further extensions of our approach are possible to allow for structure within the pathway database such as the hierarchical organization of the gene_ontology the gene_ontology consortium finally proper modelling of nonlinear responses including ascertained case control status will be an important future direction although we believe that linear modelling yields reasonable power for the small genetic effects typically seen for complex_traits 
