astral genome_scale coalescent_based species_tree motivation species_trees provide insight into basic biology including the mechanisms of evolution and how it modifies biomolecular function and structure biodiversity and co evolution between genes and species yet gene_trees often differ from species_trees creating challenges to species_tree one of the most frequent causes for conflicting topologies between gene_trees and species_trees is incomplete_lineage ils which is modelled by the multi species coalescent while many methods have been developed to estimate species_trees from multiple genes some which have statistical guarantees under the multi species coalescent model existing_methods are too computationally_intensive for use with genome_scale analyses or have been shown to have poor accuracy under some realistic conditions results we present astral a fast method for estimating species_trees from multiple genes astral is statistically consistent can run on datasets with thousands of genes and has outstanding accuracy improving on mp est and the population tree from bucky two statistically consistent leading coalescent based_methods astral is often more accurate than concatenation using maximum_likelihood except when ils levels are low or there are too few gene_trees availability_and astral is available in open_source form at httpsspecies tree estimation is difficult in the presence of gene_tree conflict which can result from incomplete_lineage ils modelled by the multi species coalescent as well as other causes ils is equivalent to deep coalescence which occurs with high_probability whenever the time between speciation_events is short relative to the population_size when ils is present gene_trees can differ from each other and from the species_tree presenting substantial challenges to phylogeny estimation methods for example the standard approach concatenation which concatenates the multiple_sequence for different genes together into one superalignment and then estimates a tree on the super alignment can return incorrect trees with high_confidence furthermore under some conditions even the most probable gene tree_topology may not be identical to the species tree_topology a condition called the anomaly zone however there are no anomalous rooted three taxon species_trees and no anomalous unrooted four taxon species_trees a key fact that underlies the design of some summary_methods and their proofs of statistical consistency while several methods are established to be statistically consistent under the multi species coalescent model mp est and the population tree returned by bucky are among the leading methods bucky pop is more computationally_intensive but can work with unrooted gene_trees while mp est requires rooted gene_trees but easily scales to hundreds of gene_trees and so has been used in many phylogenomic studies other statistically consistent species_tree methods include best and beast which co estimate gene_trees and species_trees from input sequence_alignments however these methods are extremely computationally_intensive on datasets with genes so that only summary_methods are feasible for use on genome_scale datasets however even the best coalescent_based summary_methods have not been reliably more accurate than concatenation and performance on biological_datasets has in some cases resulted in species_trees that were less well resolved and biologically feasible than concatenation hence the choice between coalescent_based estimation and concatenation is highly_controversial we present astral accurate species_tree algorithm a new coalescent_based species_tree method astral provides a statistically consistent estimation of the true species_tree from unrooted gene_trees under the multi species coalescent model furthermore astral runs in polynomial time and can analyse genome_scale datasets in minutes we evaluate astral in comparison with two statistically consistent methods mp est and bucky pop two simple summary_methods and the greedy consensus and concatenation under maximum_likelihood ca ml using raxml on a collection of biological and simulated_datasets we explore genome_scale analyses analysing datasets with hundreds to thousands of genes which are too large for bucky pop and beast to analyse to whom correspondence should be addressed the author published_by this is an open_access the terms of the creative_commons http creativecommons org_licenses which permits non commercial re use distribution and reproduction in any medium provided the original_work for commercial re use please_contact permissions_oup com astral is more accurate than the other summary_methods under all the simulated model conditions we explore as expected the relative accuracy of astral and concatenation depends on the amount of ils with astral having an advantage when ils levels are at least moderate and concatenation having an advantage when ils levels are low thus astral enables highly_accurate large_scale phylogenomic estimation even in the presence of high levels of gene_tree conflict because of ils results on mammalian simulated_datasets the first experiment shows results on the mixed mammalian dataset which most closely_resembles the biological dataset studied in we compare astral mp est greedy mrp bucky pop and ca ml and three types of inputs to summary_methods for mrp mp est and astral using bestml input trees produced more accurate species_trees than using bootstrap replicates either as one input all bs or using mlbs the purpose of using bootstrap replicates is to take gene_tree uncertainty resulting from insufficient sequence_length for example into account but these results indicate that for this model condition these two simple approaches do not improve species_tree however it is possible that other model conditions perhaps smaller numbers of genes as studied inor other ways of addressing gene_tree uncertainty might show some advantage over the bestml approach therefore we use bestml input trees in the remaining experiments for the mixed model condition and using bestml trees astral is the most accurate of these methods mp est the next most accurate followed by the other summary_methods and finally by ca ml astral with any of the three sets of inputs is also more accurate than bucky pop however differences between astral on all bs and bucky pop are relatively small the next experiment explored variants of the basic mammalian simulation exploring the impact of changes to the ils level by scaling the species_tree branch_lengths number of genes and gene sequence_length on the absolute and relative performance of various methods using bestml input astral was generally more accurate than all the other summary_methods however for a few cases astral and one or more summary_methods had similar accuracy for example on true gene_trees from default ils levels all summary_methods except for greedy produced the true species_tree furthermore astral was more accurate than ca ml except when the amount of ils is low the relative performance between astral and ca ml depended on the amount of ils so that ca ml was more accurate than astral under low levels of ils and otherwise astral was more accurate than ca ml some observed trends were expected all summary methods_gave improved accuracy as the sequence_length in each gene increased from to bp using true gene_trees gave the best results species_tree error_rates generally reduced as the number of genes increased and species_tree error_rates increased as ils levels increased however some other observed trends were surprising for example unlike the other methods greedy did not continue to improve with increased numbers of gene_trees but could be more accurate than many other summary_methods including mp est but not astral when the number of gene_trees and gene sequence_lengths were both small in addition we observed that mrp a simple supertree method that is not known to be statistically consistent was in some cases more accurate than mp est for example while mp est was always at least as accurate as mrp on true gene_trees or on estimated gene_trees with high ils there were cases species_tree error on the default mammalian datasets with genes and genes half with bp and half with bp and with mean bs we show the missing branch rates for estimated species_trees computed using summary_methods mrp mp est greedy bucky pop and astral as well as concatenation using raxml results are shown for running summary_methods on maximum_likelihood gene_trees bestml and on the set of all bootstrap replicates from all genes all bs as well as the greedy consensus of running summary_methods on individual bootstrap replicates from all genes mlbs caml is run on the true alignment average and standard_error shown based on replicates i on biological_datasets analysed a dataset with genes across mammalian_species using mp est two of the questions of greatest interest were the placement of bats chiroptera and tree_shrew scandentia where their mp est analysis differed from the concatenated analyses they performed in our analysis of this dataset we noted the distance of estimated gene_trees to other gene_trees this produced a distribution with two clear outliers see supplementary_materials we also identified genes with mislabelled sequences easily confused taxon names subsequently confirmed by the authors of we removed all outliers from the dataset and reanalysed the reduced dataset we used a multi_locus bootstrapping procedure with replicates with both site and gene resampling to be consistent with song et_al we re estimated the gene_trees using raxml on the gene sequence_alignments produced by we recomputed the mp est tree obtaining a tree topologically identical to the mp est tree reported in but with lower bootstrap for the placement of scandentia in our analysis ca ml analyses of the full and reduced datasets were topologically identical and had similar branch support thus the ca ml and mp est trees on the reduced dataset still differed in the placement of both scandentia and chiroptera we compare astral to mp est in both astral and mp est trees placed chiroptera as the sister to all other laurasiatheria except eulipotyphyla whereas ca ml placed chiroptera as the sister to cetartiodactyla the astral tree placed scandentia as sister to glires with support and thus agrees with the ca ml tree but differs from the mp est tree the simulated mammalian datasets we show the missing branch rates for estimated species_trees computed using summary_methods mrp mp est greedy and astral as well as ca ml summary_methods are run on raxml bestml gene_trees we also show performance of summary_methods on the true gene_trees subfigure a shows results under default levels of ils varying the number of genes and gene_tree resolution b shows results under increased ils levels varying the number of genes and on both true gene_trees and estimated gene_trees and c shows results on genes varying the amount of ils from very low species_tree branch_lengths to very high species_tree branch_lengths genes using astral adding bipartitions to x see supplementary_materials the question of greatest interest is the sister_group to land_plants previous_analyses have inferred many different possible sister clades including the following four major hypotheses zygnematales coleochaetales zygnematales coleochaetales and charales used mp est to analyse their data and inferred zygnematales as the sister with bs a reanalysis of the same data using star was performed by springer and gatesy who obtained zygnematales coleochaetales with bs we analysed this dataset using astral and obtained a tree that generally has high bs on the branches i e with the exception of four branches all branches have support at least and most have support however one edge had low support only after collapsing the single branch with low support we obtained a tree see supplementary_materials in which the charales land_plants hypothesis is rejected with moderately_high support however it is not determined whether zygnematales coleochaetales or zygnematales coleochaetales are the sister_group to land_plants the branch that distinguishes between these three hypotheses is the one with support thus astrals analysis of this dataset can be seen as suggesting that this dataset is insufficient to completely resolve the sister relationship to land_plants however the most interesting question is whether charales are sister to land_plants and the astral tree rejects that hypothesis with support amniota dataset assembled a dataset of amniota to resolve the position of turtles relative to birds and crocodiles most recent_studies favour an archosaurus hypotheses that unites birds and crocodiles as sister groups the mp est analyses byresolved this relationship differently when aa and dna gene_trees were used thus aa had support for the archosaurus clade but dna rejected archosaurus with support we analysed the same dataset using the exact version of astral and found that both aa and dna recover archosaurus however while astral on aa gene_trees recovered archosaurus with support astral on dna gene_trees had only support for archosaurus running time comparisons between coalescent based_methods reveal substantial differences in running time for example on the mammalian dataset fromwith taxa and genes mp est run with random starting points used min per bootstrap replicate while astral used s analyses of the simulated mammalian datasets allow us to explore the limits of bucky pop as well as obtain other comparisons we examine running_times under moderate ils gene sequences of length_bp and with and genes and with bestml input trees except for bucky pop bucky pop strictly runs in serial using a bayesian_markov mcmc technique which can take a long time and substantial memory to reach convergence on the taxon mammalian simulated_datasets bucky pop ran to completion for datasets with up to genes where it took h but failed to complete due to memory issues on the gene dataset mp est completed relatively quickly minfor both the gene and gene datasets we ran mp est with random starting points so this time could be reduced by using just one starting_point but with a potential decrease in accuracy astral completed in s on the gene dataset and in s on the gene dataset thus astral is dramatically faster than the other methods and able to run on these phylogenomic datasets in reasonable time frames however bucky is used with bootstrapped gene_trees for each gene and outputs support values running astral and mp est using mlbs to obtain support values would increase their running_times if run in serial but astral would still be much faster than bucky e g min on the gene dataset rather than h in addition parallelizing mlbs is trivial because each bootstrap replicate is independent see supplementary_materials for more information about running_times under different model conditions 
