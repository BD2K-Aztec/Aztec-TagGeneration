faster and more accurate graphical_model identification of tandem_mass using trellises tandem_mass ms_ms is the dominant high_throughput technology for identifying and quantifying proteins in complex biological_samples analysis of the tens_of of fragmentation spectra produced by an ms_ms experiment begins by assigning to each observed spectrum the peptide that is hypothesized to be responsible for generating the spectrum this assignment is typically done by searching each spectrum against a database of peptides to our knowledge all existing ms_ms search_engines compute scores individually between a given observed spectrum and each possible candidate peptide from the database in this work we use a trellis a data_structure capable of jointly representing a large set of candidate peptides to avoid redundantly recomputing common sub computations among different candidates we show how trellises may be used to significantly speed up existing scoring algorithms and we theoretically quantify the expected speedup afforded by trellises furthermore we demonstrate that compact trellis representations of whole sets of peptides enables efficient discriminative learning of a dynamic_bayesian for spectrum identification leading to greatly_improved spectrum identification_accuracy a critical problem in medicine and biology is accurately identifying the proteins in a complex_mixture such as a drop of blood solutions to this problem have many important_applications including the early detection of diseases and congenital_defects the most widely used high_throughput technology to identify proteins in complex_mixtures is tandem_mass ms_ms whose output is a collection of tens_of of fragmentation spectra each of which ideally corresponds to a single generating peptide the core problem in the interpretation of ms_ms data involves identifying the peptide responsible for generating each observed spectrum which we call the spectrum identification problem the most accurate methods to solve the spectrum identification problem employ a database of peptides reviewed in given an observed spectrum peptides in the database are scored and the top scoring peptide is assigned to the spectrum the pair consisting of an observed spectrum and a peptide_sequence is referred to as a peptide spectrum match psm in this work we show how trellises may be used to make this database_search significantly more efficient and accurate a trellis is a data_structure capable of representing an exponential size collection of strings in polynomial space trellises have been used to speed up inference in hidden_markov dynamic_bayesian dbns and dynamic graphical_models dgms in the context of ms_ms we use a trellis to compactly represent the collection of candidate peptides associated with an observed fragmentation spectrum i e peptides whose masses are close to the observed peptide mass associated with the spectrum using the trellis allows for the sharing of computation across candidate peptides we describe how to apply trellises to any scoring_function expressible as a dgm this includes linear scoring_functions such as the sequest xcorr the score functions employed by x tandem morpheus ms gf and omssa as well non linear methods such as our recently_proposed dbn for rapid identification of peptides drip for common ms_ms application settings we prove and quantify the extent to which in expectation determining the top scoring data instance in a trellis is substantially more efficient than scoring each data instance individually we then demonstrate empirically that trellises provide a significant reduction in the computational costs of the xcorr and drip scoring_functions ranging from to fold speedups in the low_resolution and high_resolution datasets examined here next we show that trellises may be used to discriminatively train dbns for ms_ms leading to significantly_improved peptide identification_accuracy in particular we modify the drip model which was originally trained via maximum_likelihood to instead employ discriminative training via maximum mutual_information mmi estimation maximum_likelihood maximizes the log_likelihood given a set of high_confidence psms whereas mmi estimation maximizes the conditional log_likelihood between the highconfidence psms and a large background collection of alternative psms thus mmi estimation encourages learned parameters which both explain the high_confidence labels well and discriminate against the background labels however mmi estimation is costly because it requires computing denominator quantities over whole sets of peptides before being able to take a single gradient step in the parameter_space this is infeasible if considering each peptide in the set individually we demonstrate that using trellises renders the discriminative training_procedure feasible furthermore we present empirical_evidence that this discriminative approach significantly_improves identification_accuracy relative to the generatively trained drip model section resulting in and more correct identifications at a stringent false_discovery fdr of for two datasets the general trellis based discriminative training_procedure used herein is applicable to any dgm for any class of problem but we are unaware of any previous work that does this the article is organized as follows in section we formally define the spectrum identification problem and introduce the two database_search scoring_functions xcorr and drip we then define trellises in section which we utilize to compress the theoretical spectra of candidate peptides to be scored during database_search we show how graphical_models may be used to efficiently traverse elements in a trellis section enabling easy combination with any scoring_function represented as a graphical_model thus in section we show how the vastly different scoring_functions xcorr and drip may be represented as graphical_models the combination of trellises with these graphical_model scoring_functions section allows for significantly_faster database_search section the highly compressed trellises allow feasible discriminative training for drip section providing significantly more accurate peptide identification_accuracy section a significant challenge in evaluating the quality of a spectrum identification algorithm is the absence of a ground_truth dataset where the generating peptide is known for each observed spectrum we therefore follow the standard approach of using decoy peptides which in our case correspond to randomly shuffled versions of each real target peptide to estimate the number of incorrect identifications in a given set of identified spectra in this work targets and decoys are scored separately and used to estimate the number of identified matches at a particular fdr i e the fraction of spectra improperly identified at a given significance threshold we estimate fdr using the target only variant of target_decoy competition ttdc because the fdr is not monotonic with respect to the underlying score we instead use the q value defined to be the minimum fdr threshold at which a given score is deemed to be significant since datasets containing more than incorrect identifications are generally not practically useful we only plot qvalues in the range we have proven that for many practical settings the expected runtime when using a trellis with beam pruning for viterbi decoding is significantly_faster than considering sequences independently we have also empirically shown that trellises may be used to significantly improve the speed and accuracy of peptide_identification in tandem_mass using the drip model and a dbn implementation of xcorr we have shown how to apply trellises to dramatically speed up inference to fold both for lowresolution and high_resolution precursor mass_spectra we further note that the algorithmic speedup afforded by using trellises may in future work be combined with previous work on improving xcorr runtime which focused on constant factor improvements we also note that trellises constructed from peptides with variable modifications can be potentially more efficient as variable modifications produce a lot redundancy among peptides our ms_ms trellises support traversing all subsequences of a data instance allowing jumps over whole subsequences a novel feature in contrast to traditional trellises such as those used for speech_recognition which only allow data instances to be sequentially traversed as in drip where jumps correspond to deletions this feature may be used to model noise or missing_data furthermore the jump feature enriches the hypothesis space representation allowing more sophisticated models to be expressed and evaluated efficiently with this feature and the ability to compactly represent entire sets of peptides we have extended drips learning framework to discriminative training significantly improving its performance relative to previous_training strategies in future work we plan to further explore using trellises for improved ms_ms identification using trellises to efficiently evaluate and score peptides beyond those in the given database we will investigate ways to take thresholds with respect to dbn based scoring_functions to compute p values similar to the p value calculations done via dynamic_programming by ms gf and xcorr p value by improving score calibration we expect this approach to greatly improve drips performance 
