gapped sequence_alignment using artificial_neural application to the mhc_class system motivation many biological_processes are guided by receptor_interactions with linear ligands of variable_length one such receptor is the mhc_class molecule the length preferences vary depending on the mhc allele but are generally limited to peptides of length amino_acids on this relatively simple system we developed a sequence alignment_method based on artificial neu ral networks that allows insertions_and in the alignment results we show that prediction_methods based on alignments that include insertions_and have significantly_higher performance than methods trained on peptides of single lengths also we illustrate how the location of deletions can aid the interpretation of the modes of binding of the peptide mhc as in the case of long peptides bulging out of the mhc groove or protruding at either terminus finally we demonstrate that the method can learn the length profile of different mhc_molecules and quantified the reduction of the experimental effort required to identify potential epitopes using our prediction algorithm availability_and the netmhc method for the prediction of peptide mhc_class binding_affinity using gapped sequence_alignment is publicly_available at a large number of biological_processes are guided by receptor_interactions with linear ligands proteins involved in interactions with a linear component include membrane_receptors e g the mhc_molecules enzymes e g kinases and phosphatases and carriers of peptide recognition domains e g sh pdz ww characterizing the specificity of such interactions is essential for our understanding of the underlying biological_process and for the design of interventions aimed at altering or controlling the behavior of these processes we have previously_proposed an artificial neural networkbased algorithm nnalign for the identification of binding_motifs in large_scale quantitative peptide_datasets however this approach can only generate un gapped sequence_alignments and is therefore limited to the detection of motifs of a fixed_length in many cases experimental_data are derived using libraries of peptides that are longer than the basic receptor_binding core while still a linear problem the number of residues directly involved in the interaction with the same receptor may generally vary for different ligands a prominent example of receptor that interacts with linear ligands of variable_length is the mhc system major_histocompatibility mhc_class bind peptides derived from intracellular_proteins and present them on the cell_surface to cd t cells mhc_molecules exist in numerous allelic_variants with different physicochemical_properties of their binding cleft consequently the peptide repertoire recognized by different mhc_molecules is very diverse with marked allele specific amino_acid preferences the major determinants of such amino_acid preferences are found at the so_called anchor residues generally corresponding to positions p and p of the minimum nine amino_acid binding core in some cases other positions play_a for instance hlab has a strong preference for positively_charged at p and hla a for aspartic_acid at p constraints within peptides and intrapeptide contacts may also to some extent play a role in presentation and t cell recognition mhc_class exhibit preferences also with regard to the length of the peptides they can bind outside of a few exceptions where super bulging peptides of up to amino_acids have been observed to bind to the mhc the closed_conformation of the mhc_class binding cleft limits the length of bound peptides to amino_acids recent elution studies have attempted to quantify the length_distribution of naturally processed and presented peptides and found that generally mer_peptides were optimal however allele specific preferences exist for instance in the relatively high fraction of mer_peptides found in complex with hla b similarly the murine allele h kb is known to have a comparable preference for and mers and hla b a relative tendency toward longer peptides such as and mers considerable efforts have been dedicated to the development of accurate methods for the prediction of peptide binding to mhc_molecules applying many different approaches including similarity matrices linear_regression and artificial_neural among others of these methods netmhc has been shown in several benchmark studies to be a state of the art predictor for peptidemhc binding_affinity netmhc was trained on mhc peptide binding data contained in the immune epitope database iedb the iedb has a large bias toward peptides of length nine of the data are for mers whereas of the data are for peptides of length as the amount of available training data is crucial for the generation of accurate prediction_models the performance of data_driven predictors such as netmhc will in general be limited for lengths different from nine we have previously_suggested a simple approximation approach that uses neural_networks trained on mer data to extrapolate predictions for peptides of lengths other than nine this approximation was used in netmhc to generate predictions for peptides of lengths and for alleles with scarce binding_affinity data a more extreme approach has been taken for the development of the netmhcpan method which was trained only on mer_peptides while these strategies have proven highly_successful they have the great limitation that they simply ignore all available data not conforming to the canonical mer_peptide motif length in this article we extend the nnalign method to overcome_this and generate pan length artificial_neural trained on peptides of variable_length we demonstrate the performance of the method on a large set of mhc_class binding data and show that it outperforms methods trained on single lengths and extrapolations from networks trained on mers only also we addressed how the predicted location of deletions can aid the interpretation of the modes of binding of peptide mhcs as in the case of long peptides bulging out of the mhc groove or extending at either terminus finally we analyzed to what degree the peptide length_distribution of binders of the pan length networks reflect the length preferences of different mhc_class alleles and how such length preferences can potentially reduce the cost burden involved in rational epitope discovery the machine_learning algorithm presented here stems from our previous work on sequence_alignment based on artificial_neural namely the nnalign method by bringing together the training examples onto a common window of fixed_length the nnalign training_procedure effectively generates a multiple_sequence representing the minimal binding core of each peptide the main innovation of the algorithm is the introduction of insertions_and into the nnalign learning framework essentially enabling the creation of gapped sequence_alignments in the context of the mhc_class system where the length of ligands is usually variable insertions_and allow reconciling peptides of different lengths to a binding core of a common size we demonstrated that models trained on all peptide lengths are superior to models made on individual lengths especially for molecules with few measured experimental_data of a given peptide length these models also have higher performance than extrapolations from models constructed on mer_peptides only moreover prediction of the core location can provide insight on the binding_mode of linear_peptides to their receptor such as in the case of binders bulging out from the middle of the mhc groove or non canonical binders protruding at the termini a further advantage of using a single model trained on peptide of all lengths is that the length preferences of the receptor can be learned by the method we observed that for several mhc_class the length_distribution of the top predicted binders follows the known preferences for the different mhc alleles if netmhc is used for a proteome scan in search for potential t cell epitopes peptides of optimal_length for the alleles of interest are therefore inherently prioritized we quantified the experimental effort that can be saved by a bioinformatics based selection of potential epitopes on a set of known ligands contained in the syfpeithi database and found that on average the experimental effort and cost in identifying actual ligands could be reduced by at least when using the prediction_models trained with the pan length algorithm the applications of the proposed machine_learning algorithm are not limited to the mhc_class system the method is equally well suited to the identification of binding_motifs in other peptide_datasets characterized by a linear component and we expect future applications will include mhc_class binding pan specific mhc class_i binding and peptide interactions with pdz sh and sh_domains the netmhc method for the prediction of peptidemhc class i binding_affinity is publicly_available as a webserver at http www cbs dtu dk services netmhc 
