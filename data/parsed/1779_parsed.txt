fast optimized cluster algorithm for localizations focal a spatial cluster_analysis for super resolved microscopy motivation single molecule_localization smlm microscopy provides images of cellular structure at a resolution an order of magnitude below what can be achieved by conventional diffraction limited techniques the concomitantly larger data_sets generated by smlm require increasingly efficient image_analysis density_based algorithms with the most ubiquitous being dbscan are commonly used to quantitatively assess sub cellular assemblies dbscan however is slow scaling with the number of localizations like o n log n at best and its performance is highly dependent upon a subjectively selected choice of parameters results we have developed a grid based clustering_algorithm focal which explicitly accounts for several dominant artifacts arising in smlm image reconstructions focal is fast and efficient scaling like o n and only has one set parameter we assess dbscan and focal on experimental dstorm data of clusters of eukaryotic rnap_ii and palm data of the bacterial protein h ns then provide a detailed comparison via simulation focal performs comparable and often superior to dbscan while yielding a significantly_faster analysis additionally focal provides a novel method for filtering out of focus clusters from complex smlm images availability_and the data and code are available at with the advent of super resolved microscopy images of cellular structure and organization can be acquired with visible_light at a spatial_resolution well surpassing the diffraction_limit a popular family of techniques referred to as single molecule_localization smlm can achieve a lateral resolution down to a few tens of nanometers with only slightly worse axial resolution smlm works by driving a dense population of fluorescent molecules through multiple cycles of photoactivation photoswitching or blinking and bleaching under appropriate conditions its possible to temporally isolate the fluorescence of a single_molecule during each cycle from adjacent molecules within a diffraction limited volume the precise location of each isolated molecule is determined limited primarily by the number of emitted photons and the process is repeated tens_of of times to generate a reconstructed image from the assembled localizations examples of smlm techniques are stochastic optical reconstruction microscopy storm direct storm dstorm photo activated localization microscopy palm bleaching blinkingassisted localization microscopy balm and so on smlm is increasingly being employed in cells to image and quantitatively analyze various protein_complexes forming tens of nm to hundreds of nm assemblies from membrane_receptors to nucleosome bundles however because of the techniques inherent single_molecule sensitivity smlm is prone to a host of artifacts that have little effect on conventional diffraction limited modalities for membrane_proteins or other targets close to the cell_surface illumination via total_internal tirf can considerably improve the image_quality unfortunately it can be much more difficult to employ smlm to image intranuclear structures for example which may reside deep within the cell for abundant proteins or extended structures that fill large portions of the cellular volume alternatives to wide_field illumination such as hilo or dirty tirf can provide course optical_sectioning of course for even more crowded regions it may be necessary to resort to complicated light_sheet illumination schemes consider the imaging artifacts that arise when using immunofluorescence_labeling to target specific molecules within a fixed cell nonspecific interactions of the tagged antibodies with either the growth substrate or cell generate false localizations that add noise to the reconstructed image a static fluorescence background can reduce the precision with which individual target fluorophores can be localized and blurred out of focus blinking flourophores not only increase the local background but if located close to the focal_plane can be imprecisely localized there are a number of approaches to characterizing the spatial_organization and nanoscale morphology of protein assemblies imaged with smlm on the one hand there are ensemble methods that provide spatial statistics such as pair correlation_analysis or ripleys l function on the other are methods that directly group localizations into discrete clusters for smlm density based spatial clustering of applications with noise dbscan is the most commonly_employed method of this type significant analysis can follow cluster identification such as determining the cluster_size radius or the number of proteins within each cluster the ability of dbscan to identify and reject noise is advantageous which to a large extent accounts for its popularity however in addition to the complications of background_noise artifacts appear in smlm images because the localization density is a function of both the number of tagged proteins in an assembly and the photophysics of the fluorescent_labels since most fluorophores blink multiple times and there is some error involved in the localization of each blink a single fluorescent label will result in a cluster of localizations likewise because the duration of each blink is stochastic blinks that last for multiple frames will also generate a cluster therefore a single density threshold as in dbscan may not be sufficient to differentiate between clusters of localizations due to protein assemblies and artifactual pseudo clusters arising for instance from a fluorescently_labeled solitary protein this is a concern for all smlm methods since even with fluorophores referred to as irreversibly photoactivatable photoblinking is commonly observed unfortunately some clusters may also appear as noise due to limitations in the image_reconstruction for instance because of the inherently low photo activation efficiency of the fluorophores multiple clustered proteins will occasionally produce only a single blink during the acquisition period moreover in the presence of significant noise and off target localizations i e localizations not arising from in focus target clusters the performance of dbscan critically depends on a pair of set parameters that specify a density threshold i e the number of points minpts within a search radius e a significant drawback to dbscan is that the appropriate choice for these parameters is often ambiguous in practice clustering_results for various sets of dbscan parameters are typically generated and the optimum choice is iteratively chosen from an inspection of the results beyond the obvious subjectivity of a visual_inspection this procedure may not be practical for localization microscopy when dealing with large_data of hundreds of thousand to millions of localizations to identify neighboring points dbscan calculates all pairwise_distances within an image so the runtime scales with the number of points n as o n for a large smlm data_set this analysis can take several hours region queries such as grid based spatial indexing and tree data_structures have been implemented to restrict the search for neighboring localizations to obtain an average time complexity of o n log n despite this improvement in order to find the algorithms optimum parameters dbscan should be executed multiple times in fact the parameters might vary from image to image due to unavoidable variations in sample_preparation such as labeling specificity and heterogeneity of cells an optimal clustering analysis with dbscan therefore can be extremely time consuming here we present a rapid clustering_algorithm customized for smlm fast optimized cluster algorithm for localizations focal focal is similar in many respects to a gridded version of dbscan and like grid based versions of dbscan at worst scales like o n but while dbscan is an extremely general clustering_algorithm focal incorporates knowledge of artifacts within smlm images to optimize the analysis moreover we present a well defined method for quickly selecting focals optimum parameters which minimizes clustering errors from smlm image_artifacts in both simulations and experiments on immunofluorescently labeled clusters of rnapii via dstorm and fluorescent protein tagged clusters of the histone like nucleosomal protein h ns by palm we compared the performance of focal and dbscan in detecting spatial clusters and in dealing with and filtering out image_noise and off target localizations our results suggest that focal performs comparable and often superior to dbscan while providing a significantly_faster analysis of complex smlm images in addition focal provides a novel method for filtering out of focus clusters from complex smlm images various clustering_methods are used to characterize the organization of nanoscale assemblies in localization microscopy_images unlike statistical_approaches such as ripleys l function and paircorrelation analysis that estimate ensemble parameters dbscan and other derivative densitybased clustering_algorithms are able to identify and quantify individual clusters however dbscan is slow scaling with the number of particles like o n log n at best is acutely sensitive to the algorithms parameters which are typically selected by visual_inspection of the output and is prone to detecting a large number of false clusters in the presence of a significant background of localizations to address these problems we developed focal a rapid o n density_based method that is tailored for localization microscopy focal is a rapid and efficient tool for density_based in super_resolution data in contrast to dbscan focal sets a threshold for a minimum cluster_size based upon the image localization uncertainty to remove pseudo clusters arising from multiple localizations of single fluorophores moreover focal can be rapidly optimized to minimize false clustering and remove diffuse out of focus clusters while maintaining cluster integrity alternatively focal could serve as a method for quickly determining the optimum density threshold for a dbscan based clustering analysis as smlm becomes more commonplace increasingly efficient algorithms will need to be developed to deal with the large_amounts of data generated when imaging at such fine resolution focal can rapidly analyze large smlm data_sets performing at least on par with if not better than dbscan in most situations its efficiency in analyzing_large image data_sets should make focal a suitable replacement to the much slower dbscan derived algorithms and a solid foundation for further clustering analysis 
