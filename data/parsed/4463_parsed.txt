gene_expression subseq determining appropriate sequencing_depth through efficient read subsampling motivation next_generation experiments such as rna_seq play_an in biological_research one complication is that the power and accuracy of such experiments depend substantially on the number of reads sequenced so it is important and challenging to determine the optimal read_depth for an experiment or to verify whether one has adequate depth in an existing experiment results by randomly sampling lower depths from a sequencing_experiment and determining where the saturation of power and accuracy occurs one can determine what the most useful depth should be for future_experiments and furthermore confirm whether an existing experiment had sufficient depth to justify its conclusions we introduce the subseq r package which uses a novel efficient approach to perform this subsampling and to calculate informative metrics at each depth availability_and the subseq r package is available atmany next_generation have been developed to answer important biological_questions one property these technologies have in common is that they depend on read_depth or coverage increasing the number of reads typically increases the power and accuracy for instance in rna_seq greater read_depth is known to increase the power of differential_expression testing and the accuracy of expression estimates the advent of multiplexed sequencing means that researchers should consider their read_depth as a trade_off against cost and replication when designing experiments which means knowing the relationship between read_depth and power is essential to designing sequencing_experiments similarly many researchers need to demonstrate that they have adequate depth in an existing experiment to support their biological conclusions one valuable_approach that multiple studies have used is to randomly subsample reads sometimes called downsampling and perform an identical analysis on each subsample this is in contrast to methods that fit a parametric model to calculate power such as scotty by determining where metrics of power and accuracy saturate with increasing_depth one can both determine recommendations for future_experiments and demonstrate whether an existing experiment has sufficient depth studies have used random subsampling to propose guidelines for future_experiments to perform a survey of different rna_seq analysis methods at varying read_depths or to demonstrate that they had achieved adequate read_depth however all took the approach of randomly subsampling from either the fastq or alignment file and then reperforming the analysis including the computationally_intensive step of matching reads to genes on each file this process is slow demanding of disk_space and requires possessing the original reads or mappings which limits the number of subsamples that can be performed and the ease of performing this analysis on existing experiments we introduce the subseq r package which instead subsamples sequencing_reads with binomial sampling after they have been matched to genes and assembled into a count matrix because the step of matching reads to genes is independent and deterministic this approach is functionally identical to the common approach of subsampling the read_alignment files but requires only the count matrix rather than the read_alignment file it also takes negligible time and computing_resources even on large_datasets as the steps downstream of the read subsampling are much faster than the upstream steps a similar approach is used to generate saturation figures in the noiseq package but subseq is designed to be used with any rna_seq analysis method subseq could be performed immediately on any experiment in the recount resource of analysis ready datasets and on any rnaseq experiment that provides a matrix of read_counts per gene an early version of this software was used in on bar seq measurements of the yeast deletion set to determine the effect of read_depth on detection of differential abundance subseq also streamlines the process of performing a differential_expression on each subsample and of calculating relevant_biological metrics for each to determine how they vary depending on read_depth in particular subseq reports metrics representing i the power to detect differential_expression or abundance ii the accuracy of effect_size estimation and iii to whom correspondence should be addressed the author published_by this is an open_access the terms of the creative_commons http creativecommons org_licenses which permits non commercial re use distribution and reproduction in any medium provided the original_work for commercial re use please_contact permissions_oup com the estimated rate of false_discoveries relative to the full experiment as an illustrative example we show the results of subsampling of an rna_seq dataset from using edger or deseq to normalize and test each subsample for differential_expression to perform these subsamples manually it would have required downloading gb of reads mapping them to the mouse_genome downsampling to produce an additional gb of alignments matching each read to the gene_annotations and only then performing the differential_expression using subseq the subsampling requires only the mb matrix from the recount database can be performed entirely in memory in r and takes a negligible amount of time s to perform the subsamplings minutes to perform the analysis at each step depending on the method chosen after constructing subsamples and performing an analysis on each subseq calculates and visualizes summary metrics about each sequencing_depth these plots aid in determining saturation of depth supplementary as the plots show how read_depth changes the conclusions of the analysis the oracle is defined as the p values and estimates at the full depth to estimate the power subseq determines the number of genes found significant at a given false_discovery to determine_whether the decrease in read_depth affects specificity we also estimate the false discovery proportion fdp at each depth subseq does this by using the qvalue package to estimate the local_false for each gene in the oracle then calculating the average of the oracle local fdr values among the genes found significant at each depth to determine how depth affects the accuracy of effect_size estimation subseq compares the log fold changes estimated at each depth with the oracle estimates reporting the mean squared error and the pearson and spearman_correlations subseq is designed to allow any analysis to be performed on each subsample while the example demonstrated here used rna_seq subseq works equally well on other genomic_approaches such as bar seq or tn_seq as demonstrated in 
