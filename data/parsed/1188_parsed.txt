genome_analysis covariate modulated local_false for genome_wide genome_wide gwas have largely failed to identify most of the genetic_basis of highly_heritable diseases and complex_traits recent work has suggested this could be because many genetic_variants each with individually small effects compose their genetic_architecture limiting the power of gwas given currently obtainable sample_sizes in this scenario bonferroni derived thresholds are severely underpowered to detect the vast_majority of associations local_false fdr methods provide more power to detect non null associations but implicit assumptions about the ex changeability of single_nucleotide snps limit their ability to discover non null loci methods we propose a novel covariate modulated local_false cmfdr that incorporates prior information about gene elementbased functional_annotations of snps so that snps from categories enriched for non null associations have a lower fdr for a given value of a test_statistic than snps in unenriched categories this readjustment of fdr based on functional_annotations is achieved empirically by fitting a covariate modulated parametric two group mixture_model the proposed cmfdr methodology is applied to a large crohns_disease gwas results use of cmfdr dramatically improves power e g increasing the number of loci declared significant at the fdr level by a factor of we also demonstrate that snps were declared significant using cmfdr compared with usual fdr replicate in much higher numbers while maintaining similar replication rates for a given fdr cutoff in de_novo samples using the eight crohns_disease substudies as independent training and test datasets availability an implementation https sites google com site covmo dfdr large_scale hypothesis_testing has emerged as a critical component of genetic_analysis with the advent_of microarrays for example it is now possible to survey a large number of single_nucleotide snps across the entire_genome in an attempt to locate genetic_variations associated with trait variability or disease risk an advantage of large_scale genome_wide gwas is the ability to discover the potential effect of any number of variants across the genome without making strong a priori_hypotheses about the subset of the genome to consider a disadvantage is that a large_number may occur when many hypothesis_tests are conducted simultaneously consequently modern gwas have adopted a stringent bonferroni derived multiple testing threshold of p for declaring individual snp associations significant unfortunately these gwas have largely failed to identify substantial portions of the genetic_basis of highly_heritable diseases and complex_traits recent work has strongly suggested this could be because many genetic_variants each with individually small effects compose their genetic_architecture limiting the power of gwas to detect true associations given currently obtainable sample_sizes this scenario is especially damaging to power if all snps are treated as a priori exchangeable and hence equally likely to be related to the phenotype of interest an implicit assumption of bonferroni thresholds and false_discovery fdr control other work has placed an emphasis on characterizing the biological_function of genetic_variants across the genome typically this work has focused on understanding how differences in the protein coding_region of genes may damage or alter the corresponding protein_structure however recent efforts have attempted to characterize the potential effect of variants within non coding elements which may alter the timing amount or location of gene_expression emerging from this research is a picture of widespread heterogeneity in the potential biological functionality of variants across the genome a number of researchers have suggested that this heterogeneity of function to whom correspondence should be addressed translates to association studies with certain genetic_elements or categories of variants containing more or less trait associated variants given this it is potentially of use to leverage functional_annotations or other locus specific covariates to improve gene_discovery and replication of associations in de_novo samples classical multiple comparison procedures such as the bonferroni_correction control the family_wise fwer or the probability of committing one or more type i errors in a family of hypothesis_tests these procedures tend to be underpowered in large_scale testing paradigms in other words fwer procedures can be excessively conservative when thousands or millions of cases are tested benjamini andproposed an alternative approach to type_i control termed the fdr defined as the expected proportion of errors among the rejected hypotheses variants of their algorithm are applied to p values of test_statistics null_hypothesis tail probabilities from many tests to control fdr to a specified level under various conditions efron anddeveloped an extension of fdr called the local_false fdr from an empirical_bayes point_of defining fdr as the posterior_probability that the null_hypothesis is true given the observed test_statistic the empirical_bayes approach to fdr is closely_related to thealgorithm for fdr control these groundbreaking methodologies for controlling multiplicity under large_scale hypothesis_testing have received widespread attention and development proposed a mixture_model of non central test_statistics where the probability of being associated with a phenotype having a non centrality parameter different from zero depends on multiple covariates proposed an estimator that allows for modulating the fdr of each null_hypothesis based on external covariates if fdr depends on levels of a measured covariate then the exchangeability assumption implicit in the definition of fdr is not optimal and sizeable gains in power can be realized by accounting for this dependence the key technique to account for the dependence of fdr on the covariate x in the approach ofwas to bin the data into b sets according to ordered values of x the assumption was that the influence of x on the posterior_probability is nearly constant in each bin if bins are small enough in practice b to the fdr is then estimated in each bin possibly with smoothing across the bins this approach works best for one covariate and becomes impractical as the number of covariates increases it has been applied to large_scale testing of neuroimaging data in prior work we have developed a scheme to assign gene elementbased functional_annotations for snps genome_wide which takes_into the locuslocus correlations linkage_disequilibrium ld that gwas depend on for whole genome_coverage this ld weighted annotation scheme provides multiple scores for each snp in several genic categories including exon intron untranslated_regions utr and untranslated_region utr scores incorporate not only the category of a given variant but also the categories of all variants for which it is in ld correlated with intergenic snps are defined as having zero scores in all functional_categories and being kb away from a protein_coding providing a hypothesized null collection using these functional_annotations and summary_statistics from large gwas we showed that test_statistics resulting from snps that are in ld with the utr of genes show the largest abundance of associations while snps in ld with exons and the utr are also enriched snps in ld with introns are modestly enriched and intergenic snps show a depletion of associations relative to the average snp a more detailed_description of how the ld weighted genic annotations were produced is given in the supplementary_materials this situation is illustrated in which displays qq plots of log_transformed p values from a gwas of crohns_disease cd of subjects obtained through a publicly_accessible database enrichment for true associations is expressed as a leftward deflection of the qq plots stratified by genic category representing an overabundance of low p values compared with that expected under the global null_hypothesis of no associations leftward deflections are directly related to decreased fdr for a given p value threshold the utr snps are most enriched followed by exons utr and introns intergenic snps are impoverished for true effects these results were consistent across all assessed phenotypes and strongly suggest that all snps should not be treated as a priori exchangeable for purposes of hypothesis_testing but that certain categories are much more likely to show an association the current article leverages the information available in genic annotation categories for large_scale gwas hypothesis testingby presenting a novel fully bayesian_approach for generalized covariate modulated local_false cmfdr estimation implemented using a markov_chain mcmc sampling algorithm through this approach we are able to model the influence of a vector of covariates on the distribution of the test_statistics and hence on the fdr section gives a brief review of fdr and introduces cmfdr constructed from a bayesian two group mixture_model that incorporates covariates section_presents the mcmc_algorithm for fitting the model and drawing inferences and applies cmfdr to examples involving both simulated_and the last section is devoted to a discussion of results and future work methods for large_scale hypothesis_testing that control type_i without being overly conservative are crucial in gwas it has become increasingly evident that many complex phenotypes and diseases have many genetic_determinants each with small effect hence traditional fwer correction is too conservative and severely underpowered fdr and fdr have come to be accepted broadly as routine techniques to control for the rate of false_positive in large_scale hypothesis_testing settings in a number of fields however even these methods do not account for the vast_majority of phenotypic_variance explained by common_variants a problem with these and other multiple testing methods is that all snps are treated as exchangeable in particular each snp is given the same a priori probability of being non null on the contrary we and others have shown that the functional role of snps has a strong impact on the probability of association across a broad array of complex phenotypes and diseases this work proposes a novel bayesian_approach cmfdr to incorporate a set of important covariates into the fdr under a heteroscedastic model where the probability of non null status and the distribution of the test_statistic under the non null_hypothesis are both modulated by covariates the primary advantage of our methodology over traditional fdr methods is that two snps with the same z_score can have different values of cmfdr if one is in a more enriched category than the other hence by using snp annotations to modulate fdr more snps can be discovered for a given level of fdr control in other words methods such as cmfdr that break the exchangeability assumption are potentially more powerful than traditional fdr methods that assume exchangeability in the cd example we discovered times as many snps unpruned using cmfdr compared with usual fdr for an identical cutoff the increase in number of replicated snps in de_novo subsamples from fdr to cmfdr was even more dramatic parameter_estimates of covariates can also be biologically informative about the relative functionality of different biological classifications of variants it is crucial to note that our ld weighted snp annotations were computed independently of the phenotypes investigated thus modifying the fdr based on information from genic categories does not bias results toward rejecting more null_hypotheses moreover the cmfdr methodology is capable of handling any relevant source of information including for example the proposed methodology has some drawbacks first as currently formulated it assumes all hypothesis_tests are independent this is not true for snps in ld and our credible_intervals are probably too small moreover it remains_unclear what impact ld has on fdp control because it may be the case that all or almost all tag_snps are in partial ld with causal_snps but are not themselves causal correlation across snps can be handled for example by repeatedly and randomly pruning snps for independence before running the mcmc_algorithm by using a discrete markov_random formulation or by modeling snps simultaneously using for example a multivariate mixed_effects framework we have implemented a random pruning option available with the r code distribution second it may be the case for some applications that the gamma_distribution does not fit the tail probabilities of the non null_distribution well we have used other distributions e g the skewed generalized normal and are currently developing a non parametric alternative that produces flexible fits to tail probabilities although non parametric estimates of the non null density avoid bias from lack of model_fit parametric alternatives can be more powerful if the fit is adequate finally it appears from simulations that the cmfdr methodology can be overly liberal in scenarios where is close to care must therefore be taken when applying cmfdr in these circumstances 
