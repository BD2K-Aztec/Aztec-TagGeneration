accurate estimation of heritability in genome_wide studies using random_effects models_motivation random_effects have recently been introduced as an approach for analyzing genome_wide gwass which allows estimation of overall heritability of traits without explicitly identifying the genetic_loci responsible using this approach yang et_al have demonstrated that the heritability of height is much higher than the associated with identified genetic_factors however yang et_al relied on a heuristic for performing estimation in this model results we adopt the model framework of yang et_al and develop a method for maximum_likelihood ml estimation in this framework our method is based on monte_carlo expectation_maximization mcem wei et_al an expectation_maximization wherein a markov_chain approach is used in the e step we demonstrate that this method leads to more stable and accurate heritability estimation compared to the approach of yang et_al and it also allows us to find ml estimates of the portion of markers which are causal indicating whether the heritability stems from a small number of powerful genetic_factors or a large number of less powerful ones many complex_traits display a remarkable gap between the overall genetic_variance estimated by population studies such as twin_studies and the variance explained by specific genetic_variants identified by genome_wide gwass this gap has been coined the dark_matter of heritability suggested explanations for this gap include genegene and gene_environment unidentified by the univariate gwas scheme though some of these explanations have been refuted by studies height being a trait that is easy to measure but genetically_complex has attracted special_attention heritability of height defined as the portion of height variability due to genetic_factors was estimated at around while the tens of specific single_nucleotide snps identified by large_scale gwass account for only of the heritability extrapolating from these data under specific statistical assumptions estimated the number of causal_snps affecting height at which is at the high end of reasonable values recently suggested the use of random_effects as a multivariate_approach for estimating the heritability of to whom correspondence should be addressed height directly from gwas data in their model each individuals height is affected by a genetic random effect which is correlated across individuals by virtue of sharing some of the genetic_variants affecting height and an environmental random effect which is uncorrelated across individuals consistent with the common definition they define heritability as the ratio of the variance of the genetic random effect to the total_variance using a straightforward maximum_likelihood approach for estimating heritability in this model requires knowledge of the identity of the causal_snps and hence the covariance_matrix this is of course not available soapproximate the genetic_correlation between every pair of individuals across the set of causal_snps by the genetic_correlation across the set of all genotyped snps using this approximation they estimate the heritability of height at by adding some further assumptions about the nature and distribution of the causative snps they obtain heritability_estimates of and while the random_effects approach proposed byis innovative and appropriate the concept of using an estimated correlation_matrix instead of the actual correlation_matrix is a questionable heuristic the very large number of snps used for estimating the genetic correlationsmost of them likely not causativemight mask out the correlations on the set of causal_snps as we show below this indeed leads to inaccurate and suboptimal estimation of heritability instead we propose here to treat the identity of the causal_snps as missing_data and find true maximum_likelihood of our parameters of interest in this setting towards this end we develop an expectation_maximization em_algorithm for this problem because of the exponentially large data space we employ markov_chain mcmc methods for the estimation of the e step this approach is known as markov_chain expectationmaximization mcem we also develop an efficient optimization approach for the m step based on spectral decomposition of the estimated covariance_matrix the resulting algorithm is computationally_intensive yet tractable for reasonably sized problems as we demonstrate as a by product of our approach we also get maximum_likelihood of the portion of genotyped snps that are causative in the random_effect this represents independently useful information as it indicates whether the estimated heritability is likely due to a small number of large genetic effects or a large number of smaller effects for example this knowledge may be useful in planning further studies to identify these specific factors we empirically demonstrate using simulations that our method in addition to being theoretically sound does indeed lead to significantly more accurate estimation of heritability than the heuristic approach ofwe first study the convergence properties of the mcem algorithm as can be seen in convergence is achieved after a relatively small number of iterations after which the estimators are almost identical independent of their starting points clearly some level of variance is expected due to the stochastic_nature of the mcmc approximation of the e step and could therefore be reduced by either taking more samples or averaging over several consecutive mcem iterations the number of em iterations required for convergence did not vary_greatly even when the proportion of the causal_snps was low data not shown we have also found that the lengths of burn in periods as determined by the geweke algorithm varied_greatly between simulations and between consecutive iterations of the mcem algorithm in general we have found that burn in periods were longer when the proportion of causal_snps was high and shorter when the estimators were closer to their true value the estimators of the proportion of causal_snps converged much slower but did display convergence as can be seen in starting from the starting points that spread uniformly in the range all estimators were in the range within iterations we noticed that the in sample variances and hence the in sample heritability varied_greatly between simulations especially when the number of causal_snps was small thus to compare the methods we first calculated the difference between the in sample heritability as estimated using the actual genetic correlation_matrix g generated in 
