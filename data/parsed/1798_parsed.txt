systems_biology fast thermodynamically constrained flux variability analysis motivation flux variability analysis fva is an important tool to further analyse the results obtained by flux_balance fba on genome_scale for many constraint_based fva identifies unboundedness of the optimal flux space this reveals that optimal flux solutions with net_flux through internal biochemical loops are feasible which violates the second law of thermodynamics such unbounded fluxes may be eliminated by extending fva with thermodynamic_constraints results we present a new algorithm for efficient flux variability and flux_balance with thermodynamic_constraints suitable for analysing genome_scale we first show that fba with thermodynamic_constraints is np_hard then we derive a theoretical tractability result which can be applied to metabolic_networks in practice we use this result to develop a new constraint programming algorithm fast tfva for fast fva with thermodynamic_constraints tfva computational comparisons with previous methods demonstrate the efficiency of the new method for tfva a speed up of factor is achieved in an analysis of genome_scale in the biomodels_database we found that in of networks additional irreversible or fixed reactions could be detected availability_and fast tfva is written in c and published under gpl it uses the open_source scip and libsbml there also exists a matlab interface for easy integration into matlab fast tfva is available from page mi fu berlin de arnem fast tfva html flux_balance fba is a widely used method to analyse the capabilities of a metabolic_network the strength of fba is that it allows predicting growth_rates of cells accurately fba is based on the steady_state assumption i e every metabolite that is produced must also be consumed at the same rate flux through the network is enabled by exchange reactions such as uptake of nutrients and production of biomass usually next to bounds on the fluxes stoichiometric constraints are the only constraints given and optimal production of biomass can be computed by solving a linear_program lp frequently there is not only one optimal flux distribution that achieves optimal biomass_production fba however computes only one such solution elementary_flux or extreme pathways are commonly used tools to analyse the whole flux space but in practice the number of elementary_flux grows exponentially with the number of reactions in the network hence enumeration of elementary_flux becomes infeasible for genome_scale networks in addition we are usually not interested in the raw_data of all elementary_flux resp extreme pathways but only in specific properties therefore sampling methods elementary flux patterns and flux variability analysis fva have been developed fva determines the maximum and minimum values of all the fluxes that will satisfy the constraints and allow for the same optimal objective value for example it is known that fba is unreliable in predicting the flux value of by products in such cases fva can be applied to predict the range of possible by product production_rates under maximal biomass_production which can be linked to gene_expression data variations of fva can also be used to determine blocked or unessential reactions in fva however the following problem arises it can happen that the network contains internal cycles i e there exist non zero steady_state fluxes involving only internal reactions in most metabolic_models only bounds on the flux value of exchange reactions are given in addition to the zero bounds for the irreversible reactions this leads to unbounded fluxes through reactions contained in such internal cycles which is of course not realistic to remove this issue a general form of thermodynamic_constraints can be added to the model to whom correspondence should be addressed the author published_by all_rights for permissions please_e journals permissions_oup com extending the standard non negativity constraints for thermodynamic irreversibility of individual reactions it has been shown that the flux_values computed with thermodynamic_constraints are more consistent for example with respect to gene_expression data in recent_years there has been increasing interest in thermodynamic_constraints as they can also be used to link metabolite_concentrations to flux modes in this article we present a new method for efficient thermodynamically constrained fba and fva we will work with the relaxed form of thermodynamic_constraints as it was introduced by there thermodynamic_constraints are formulated as follows sj steady_state assumption j u flux bounds e g irrev i j i j i i i thermodynamic constraint here s denotes the stoichiometric matrix j the flux vector m the set of metabolites r the set of all reactions e the set of exchange reactions i r n e the set of internal reactions and the chemical_potential of each metabolite gibbs_free of formation the operator t denotes transposition if the concentrations and equilibrium_constants are known it is possible to further constrain however because this information is often not available we will work here without additional constraints on in a thermodynamically constrained flux balance problem we maximize a linear objective_function c t j where c r r with respect to the constraints in thermodynamically constrained flux variability analysis tfva we analyse the flux variability within the feasible respectively optimal solutions of a thermodynamically constrained flux balance problem i e for all i r we solve the optimization_problems maxfaej i j g respectively maxfaej i j c t j optg to simplify notation we do not only use reactions as indices e g j i to denote flux through reaction i but also sets of reactions to index sub vectors for example j i denotes the flux vector on the internal reactions only and s i contains only the columns corresponding to internal reactions definition thermodynamically_feasible flux a flux vector j is called thermodynamically_feasible if there exists a vector such that and are satisfied if additionally holds j will be called a thermodynamically_feasible flux that satisfies bounds and u by multiplying t from the left side with s i the potential differences for internal reactions are obtained this is equivalent to the often found formulation k where k is the null space matrix of s i the motivation behind equation is that normally a chemical_reaction carries flux if and only if it reduces gibbs_free since many reactions are catalysed by enzymes however it can happen that an enzyme is not present for example because of regulatory_control and hence the corresponding reaction is not possible and does not carry flux even if there is a negative potential difference thus zero flux in equation is always allowed as well note that other formulations of thermodynamic_constraints for example the one used by do not have this property hence the different results have to be applied with care using boolean variables a f g i a sufficiently_large constant m and a small constant this formulation can be translated into a mixed integer_linear milp where a i indicates that a forward flux j i on reaction i is not allowed and a i forbids a backward flux j i this is done by replacing with the inequalities and this formulation is used in a similar form byfor the cobra toolbox and many others it can be shown that if s does not contain any zero columns this milp formulation is equivalent to the original one although solving milps is np_hard in general practical tests have shown that current milp solvers are able to optimize flux with respect to the above formulation also on genome_scale networks like the iaf reconstruction of escherichia_coli observed that a steady_state flux vector j i e which satisfies is thermodynamically_feasible if and only if there is no internal cycle contained by j a sketch of the proof using oriented matroids can be found in a detailed version using lp duality is available in muler and was also recently_published by this result is used byto detect reactions that are irreversible due to thermodynamic_constraints in particular one of their methods simply runs tfva this article is organized as follows in section we show that the thermodynamically constrained flux balance problem is np complete and thus milp is an appropriate tool in section we derive a tractability result and analyse how much this applies to current genome_scale models these theoretical results are the backbone of a new algorithm which is described in section in section we apply our new method to study the importance of thermodynamic_constraints in the analysis of genome_scale we presented a new algorithm for thermodynamically constrained fva compared with previous implementations an enormous speed up was obtained tfva can now be performed for a large number of networks and as a subroutine for other methods as shown in our experiments many network reconstructions in particular also well curated models may be improved by executing our algorithm fva was performed on the whole flux space and on the subspace of the fluxes with optimal biomass_production rate the cobra implementation used the gurobi solver the cobra method sometimes failed to produce a solution because gurobi returned infeasible for problems that are actually feasible opt fixed and opt irrev denote the number of additionally fixed resp irreversible reactions in the space of fluxes with optimal biomass_production 
