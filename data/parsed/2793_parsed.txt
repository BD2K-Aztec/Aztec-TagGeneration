sequence_analysis mapdamage testing for damage patterns in ancient dna_sequences ancient_dna extracts consist of a mixture of contaminant dna_molecules most often originating from environmental microbes and endogenous fragments exhibiting substantial levels of dna_damage the latter introduce specific nucleotide misincorporations and dna_fragmentation signatures in sequencing_reads that could be advantageously used to argue for sequence validity mapdamage is a perl script that computes nucleotide misincorporation and fragmentation_patterns using next_generation reads_mapped against a reference_genome the perl script outputs are further automatically processed in embedded r script in order to detect typical_patterns of genuine ancient dna_sequences availability_and the perl script mapdamage is freely_available with documentation and example files atthe field of ancient_dna adna has a colorful history with early claims of dna survival from the cretaceous periods later recognized as the by product of contamination extensive fragmentation and substantial chemical_modifications of nucleotide_bases are introduced post_mortem as a result of dna_damage some of these modifications such as abasic_sites single_strand and interstrand_cross are not replicated by standard taq dna_polymerases hence the relatively better preserved modern contaminant dna_molecules will often outcompete ancient templates during polymerase_chain pcr_amplification for non human species contamination can be controlled by using specific pcr_primers and or human oligonucleotide pcr blockers and by filtering out human related sequences but as long as to whom correspondence should be addressed ancient human fossils are concerned including close_relatives such as neandertals contamination is still a risk several recent methodological improvements have helped improve reliability when sequencing ancient hominids firstly dna libraries are tagged in clean labs with project specific indexes in order to track back downstream contamination sources that could result from library amplification and or sequencing in addition typical sequence_patterns resulting from adna damage have been identified that help distinguish damaged ancient sequences from modern contaminants these include short sequence_length an excess of cytosine to thymine c to t misincorporations at ends of sequences and complementary guanine to adenine g to a misincorporations at termini due to enhanced cytosine deamination in single_stranded overhanging ends and an excess of purines at the genomic coordinate located just before the sequencing start indicative of post_mortem depurination followed by strand fragmentation here we present a perl script that analyzes the size_distribution of next_generation reads and dynamically recovers nucleotide misincorporation patterns in a position dependent_manner in addition the base_composition of the genomic_regions located up and downstream of each read is recorded within windows of user_defined sizes using sam_files as input and corresponding reads_mapped against a reference_genome the script mapdamage provides summary tables required to gauge adna authenticity based on dna_damage patterns script outline the following programs must be installed prior to running mapdamage samtools and the r environment r development core that generates userfriendly tables and graphics using downstream scripts three main commands can be used to run mapdamage map merge and plot the main command map takes as input a sam file if present headers with sq lines will be skipped and the reference_genome used to map next_generation reads as a fasta file corresponding genomic_regions from the reference are retrieved using samtools and aligned to sequencing_reads using the cigar information the merge command compiles in single tables all individual tables generated with the map command for individual chromosomes these tables can be further processed with the plot command that produces graphics without any requirements of r knowledge the global pipeline is described in the supplementary 
