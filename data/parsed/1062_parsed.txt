sequence_analysis comparative_analysis of rna_seq alignment_algorithms and the rna_seq unified mapper rum motivation a critical task in high_throughput is aligning millions of short_reads to a reference_genome alignment is especially complicated for rna_sequencing rna_seq because of rna_splicing a number of rna_seq algorithms are available and claim to align_reads with high_accuracy and efficiency while detecting splice_junctions rna_seq are discrete in nature therefore with reasonable gene models and comparative metrics rna_seq can be simulated to sufficient accuracy to enable meaningful benchmarking of alignment_algorithms the exercise to rigorously compare all viable published rna_seq algorithms has not been performed previously results we developed an rna_seq simulator that models the main impediments to rna alignment including alternative_splicing insertions deletions substitutions sequencing_errors and intron signal we used this simulator to measure the accuracy and robustness of available algorithms at the base and junction levels additionally we used reverse_transcription rtpcr and sanger_sequencing to validate the ability of the algorithms to detect novel transcript features such as novel exons and alternative_splicing in rna_seq from mouse retina a pipeline based on blat was developed to explore the performance of established tools for this problem and to compare it to the recently_developed this pipeline the rna_seq unified mapper rum performs comparably to the best current aligners and provides an advantageous combination of accuracy speed and usability availability the rum pipeline is distributed via the amazon cloud and for computing clusters using the sun grid enginethe ongoing high_throughput hts revolution in biology is placing significant demand on the informatics community being a sequence_based technology alignment_algorithms are critical for most applications genome alignment_algorithms such as bowtie and bwa rely on burrowswheeler indexing for very fast genome alignment but they have difficulties with transcriptome alignment due to splicing rna_editing and variations from the reference such as substitutions insertions_and additional complications arise from poorly_annotated genomes or from samples with significant polymorphisms from the sequenced organism or from aberrant_splicing found in cells with mutations in components of the spliceosome there are a number of programs available for rna_seq alignment gives a breakdown of the alignment_algorithms used in a random_sample of papers listed on pubmed that have rna_seq in the abstract see supplementary table for detailed information the most commonly cited algorithm is eland which is part of the analysis_pipeline bundled by illumina with its sequencing instruments but to be viable for rna_seq an algorithm must satisfy three basic criteria i it must align single reads across splice_junctions de_novo ii it must handle paired_end and iii it must run in a reasonable amount of time currently five algorithms are available that satisfy these three criteria tophat gsnap mapsplice splicemap and soap soapals we further desire algorithms be as robust as possible to polymorphisms and sequencing_error based on our analyses described below only gsnap and mapsplice from this list satisfy this additional criterion further none of the published algorithms attempt to map against both a genome and a transcriptome and to merge the results into one alignment as will be shown below there is an advantage to merging genome and transcriptome alignments to achieve better disambiguation in particular for reads that extend into introns in order to evaluate the accuracy of the various rna_seq alignment_algorithms we developed an rna_seq simulator that produces paired_end sequence_reads with configurable rates for substitutions indels novel splice_forms intron signal and random error including a decrease of the quality in the tails of the reads as is typically observed in illumina data rna_seq datapage are discrete in nature therefore as long as good gene models are available it is possible to simulate rna_seq that is sufficiently realistic to allow for meaningful benchmarking of alignment_algorithms for our purposes we require paired_end with polymorphisms alternative_splice partial retention of introns and which follows an error_model reflective of illumina data we also require there be no bias toward any particular set of gene_annotations as far as we are aware there is no published rna_seq simulation software available however there are a few simulators available online e g flux flux sammeth net useq useq sourceforge net simngs www ebi ac uk goldman srv simngs however none of them satisfy the specific requirements for our benchmarking goals in particular we require strict_control over the sources of polymorphisms indels snps errors and alternate splicing and we require detailed logging neither flux useq nor simngs provide these capabilities to meet the necessary criteria we developed a framework called benchmarker for evaluating the effectiveness of rna_seq software beers the beers simulator uses information from a filtered set of the annotated_genes from different annotation efforts to generate simulated sequence read_pairs with characteristics similar to those observed in illumina sequence_reads the details are given in the section and supplementary_material to evaluate rna_seq alignment we developed a set of metrics to compare an inferred alignment to the true alignment of a beers dataset accuracy is evaluated on the level of the individual bases and splice_junction calls neither metric alone indicates which method is superior and it is not clear how to define a single metric that would for example bfast achieves a very high base wise accuracy because it handles polymorphisms well and therefore rarely fails to align a read however bfast does not make junctionsimulator workflow genes are chosen at random from a master pool polymorphisms and novel splice_forms are introduced and then reads are generated in a six step cycle as shown robustness of the alignment process to novel splice_forms and sequence_polymorphisms is a key to wide_application of rna_seq therefore it is important to test alignment systems with datasets that have varying_degrees of such effects and for which the truth regarding correct alignment is known beers simulates rna_seq with variable levels of polymorphisms alternative_splice partial retention of introns and sequence error of these kinds of effects only sequence error is enabled in the flux simulator the ability to simulate alternate splice_forms means beers can also be used to benchmark the various algorithms that aim to annotate the transcriptome or to reconstruct full splice_forms from rna_seq we used two configurations of the beers parameters referred to as test and test to evaluate alignment_algorithms these simulation analyses indicate that blat offers a powerful_tool for rna_seq alignment that has not been fully explored for rna_seq analysis and as such we have added necessary filters and a paired_end parser to implement this approach in rum the analyses performed using the simulated_data showed that among the appropriate rna_seq alignment_algorithms rum gsnap and mapsplice provide reasonably accurate and robust alignment although computing_resources are expanding compute time is still a relevant issue for the analysis of large rna_seq this is underscored by the dramatic_increase in the number of reads per lane now generated with the illumina hi seq and abi solid instruments all the viable and most accurate alignment_algorithms require significant computing_resources for example none of them can handle a million read dataset on one processor in reasonable time therefore the number of processor hours required for each of the algorithms as shown in tells only part of the story what is more important is the number of real hours required for running analyses using the desired alignment software on a reasonably sized compute cluster or multi processor machine mapsplice as yet cannot be parallelized and therefore is the least convenient for million read datasets we use rum on the highperformance computing facility at the penn genome frontiers institute consisting of a node cluster of bit linux machines each with ghz quad processors and gb of ram managed with the sun_grid using nodes on this cluster rum can process clean mouse or human rna_seq at a rate of million read_pairs per hour the run time however depends on the error and polymorphism rate with blat taking roughly twice as long on the second simulated_data as compared with the first and supplementary for small_genomes such as microorganisms run time is considerably faster since powerful computational_resources may not be available to all investigators we have taken advantage of the availability of cloud_computing to make rum universally available through the amazon elastic compute cloud amazon ec aws amazon com ec more generally rum should run on any unix system and simple installation scripts will place rum on any of the platforms mentioned above further rum is designed to work well with default_settings in all situations when applied to an rna_seq dataset from mouse retina rum detected novel splice_junctions with a read_depth of to explore the reliability of detection for these novel events we used rtpcr and sanger_sequencing to validate of them with a focus on the less abundant cases in order to achieve a lower_bound on the true occurrence of such novel splicing we were able to empirically validate of a subset of selected novel junctions in independent rna samples indicating the accurate identification of novel junctions by rum we believe that the true accuracy of rna_seq and rum are higher than indicated by the rtpcr and sequencing validation_studies we performed due to technical reasons for example it is possible that some transcript variants produced by the novel junctions detected by rum are present at too low a concentration to be detected on agarose_gels following rtpcr further low_abundance transcripts detected by rtpcr are more difficult to isolate for sequencing we have also found that rum works well with rna_seq from other species including human zebrafish and microorganisms data not shown perhaps the most important output of rna_seq analyses is the identification of novel transcript variants and novel transcripts indeed rna_seq are already being used to improve annotation of the human and mouse transcriptomes the ability to accurately detect the complete complement of transcripts expressed in a given cell or tissue type is especially important for identification of genes which harbor mutations that cause inherited_disorders and for accurate genetic diagnostic_testing of patients with these disorders a pertinent example of this is the recent identification of a novel retina specific_isoform of the bardet_biedl bbs gene mutations in bbs typically cause a multi system cilia disorder characterized by cystic renal_disease polydactyly mental_retardation retinal_degeneration page 
