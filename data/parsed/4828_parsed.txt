sequence_analysis using tertiary_structure for the computation of highly_accurate multiple rna alignments with the sara coffee package motivation aligning rnas is useful to search for homologous_genes study evolutionary_relationships detect conserved_regions and identify any patterns that may be of biological_relevance poor levels of conservation among homologs however make it difficult to compare rna_sequences even when considering closely evolutionary related sequences results we describe sara coffee a tertiary_structure based multiple rna aligner which has been validated using bralidarts a new benchmark framework designed for evaluating tertiary_structure based multiple rna aligners we provide two methods to measure the capacity of alignments to match corresponding secondary_and features on this benchmark sara coffee outper forms both regular aligners and those using secondary_structure information furthermore we show that on sequences in which of the nucleotides form base_pairs primary sequence methods usually perform better than secondary_structure aware aligners availability_and the package and the datasets are available from http www tcoffee org projects saracoffee and http recent_reports of a large number of previously_unknown rna genes have prompted a renewed interest in the field of non coding rna analysis this shows well in the growing number of scientific reports uncovering a rapidly_expanding range of new functions and it now appears that non_coding are involved in most parts of the cell machinery including x inactivation genome_integrity maintenance piwi interacting rna transcript knockdown and cell_differentiation mirna as well as nuclear trafficking nron among others from a functional standpoint the main consequence of high_throughput has certainly been the discovery of a large number of long_non lncrnas simultaneously identified as un reported non coding encode transcripts and as conserved genomic_regions with active promoter chromatin signatures the exact function of this new class remains a matter of debate although mounting bodies of evidence suggest their involvement in gene_regulation either through trans or cis_acting mechanisms other reports are also suggesting the potential usage of lncrnas as biomarkers in humans only the latest encode catalog lists lncrna genes and probably more have to come as a wider_range of tissues get deep sequenced it remains a matter of debate whether these lncrnas have evolutionary_conserved secondary_structure a difficulty when looking for such structures is the fast evolutionary pace of these molecules a property that makes it hard to produce structurally informative sequence_alignments this limitation is rather serious as our capacity to make sense of so much new information will significantly depend on our ability to build accurate homology_based models in the present work we borrow some concepts developed for protein_sequence comparison and show that rna structural_information can be used to derive more informative multiple_sequence msa models this approach amounts to defining a perfect rna alignment as the one maximizing the matching of structurally equivalent elements such accurate alignments are critical for various modeling applications including evolutionary reconstruction database_search using improved context free stochastic grammar model and fine grain structural_modeling of novel family_members we show that even a small amount of three_dimensional d or two_dimensional d experimental structure can help improve these models alignment_methods rely on the notion that key features are usually preserved by evolution through purifying_selection multiple comparison models can therefore reveal functional to whom correspondence should be addressed y the authors wish it to be known that in their opinion the first two authors should be regarded_as elements that would otherwise be difficult to identify on a single_sequence this is especially true for structured rna_molecules where compensated mutations are frequent signatures for evolutionarily maintained stem loops this strategy has been extensively used for the successful elucidation of ribosomal_rna secondary_structures unfortunately producing alignments accurate enough to be used for secondary_structure is a challenging_task especially when dealing with distantly_related sequences two main obstacles exist that prevent the computation of informative homology_based models first of all rna_sequences are composed of a four letter alphabet with no higher_order meta alphabet like proteins amino_acid code that would help powering statistical_analysis as a consequence structure similarity becomes hard to infer when sequences have identity second for many rnas sequence_evolution is mostly constrained by the maintenance of secondary_structure stabilized through a combination of canonical and non canonical base_pairings under such constraints it has been shown that sequences can evolve rapidly while exploring so_called neutral networks the combination of a small alphabet with rapid evolution makes_it to use standard alignment tools like basic_local based_approaches to address these limitations one can tap into the evolutionary signal contained in di nucleotides that results from the co evolution of adjacent bases this approach has been recently shown to be effective enough for the improvement of database_search accuracy unfortunately the signal thus uncovered is modest and unlikely to result in significantly_improved alignments a more suitable solution involves the simultaneous estimation of sequence and structural conservation using sankoff algorithm as effective as it may be in theory this approach is hampered by prohibitive memory and cpu requirements a limitation that has prompted the development of a large number of faster approximate heuristics for the inclusion of secondary_structure information when aligning rna some of the most popular tools include r coffee locarna and consan consan combines expectation_maximization with a sophisticated banded dynamic_programming strategy which results in a heuristic approximation of sankoff algorithm the consan algorithm that only aligns two sequences at a time can easily be combined with a consistencybased multiple sequence aligner like t coffee or r coffee to assemble highly_accurate rna msas consistency based aligners rely on the compilation of an exhaustive library of all against all pairwise_alignments this library is extended to derive a position specific scoring_scheme used to compute a standard progressive alignment the main strength of multiple aligners like t coffee is to allow any third_party pairwise aligner to be used for the library generation this property was previously used to generate structure based protein_alignments o by combining structural pairwise aligners like sap we show here how this approach originally developed for proteins can easily be extended to rna sequence_alignments provided suitable pairwise tools are used to build the pairwise library structure based rna alignment_algorithms include sara dial arts lajolla r d align and sarsa these tools belong to a recently described class of aligners that make use of experimentally_derived d structures in this study we chose the sara structural aligner that estimates series of unit vectors between consecutive c atoms shown by the authors to be the most suitable for this task and aligns them using dynamic_programming to minimize the root_mean between superimposed atoms as a stand alone pairwise structural aligner sara is directly usable within the t coffee framework and we describe in this article a framework suitable for validating the effectiveness of combining these two tools for the generation of d structure based rna msas the benchmarking of an rna d structure based method like sara coffee is not an easy task first of all one needs reference datasets of sequences with known d structures when it comes to benchmarking rna alignments bralibase is usually referred to as the reference collection of choice however it cannot be used in the context of this work as of the sequences that make up the datasets match a known d structure identity thus making it an impractical reference dataset for the benchmark of tertiarystructure aligners this limitation prompted us to assemble bralidarts a new reference dataset that only contains darts clusters of structurally homologous_sequences further filtered for their suitability see section the second issue relates to the nature of the reference our goal being the evaluation of a structural aligner any reliance on a structure based reference alignment would have turned our approach into the de facto comparison of two alternative structural_alignment strategies ours and the one used for the reference we therefore decided to do an alignment_free assessment of our method by evaluating sara coffees ability to match structurally equivalent features such as pairs of paired residues or internal structural distances this comparison of internal_structures was carried_out by adapting the nirmsd a method designed to estimate the structural accuracy of protein msas see section to use distances between the c atoms of the aligned rna_sequences sara coffee is heavily dependent on available rna d structure an information_source only available in small quantities for instance the latest pdb release contains chains longer than eight nucleotides a minimum for the sara algorithm with a mere mapping onto the million or so sequences in rfam this shortage severely restricts the scope of a method like sara coffee and we therefore decided to broaden the scope of this work by going beyond a mere pure structure based validation we also tried to estimate the usefulness of d structural_information when computing msas so as to provide the community with guidelines on how these data may be used as efficiently as possible and also to determine when these data are critically needed we were especially interested in determining the usefulness of d data when doing d modeling this question is relevant in a context where it may soon be relatively easy to use next_generation to do massive secondary_structure estimation at minimal cost even though the reliability of such techniques remains to be established our main goal was to estimate the effectiveness of structural_information incorporation when assembling rna msas we were especially interested in quantifying the usefulness of d information and its relative_merits in comparison with inferred secondary_structures to address this problem we focused a large part of this work on the design of bralidarts a structure based benchmark framework aside from its full reliance on d information bralidarts main strength is its total independence from any reference msa this independence makes it possible to avoid any bias toward specific alignment_methods having assembled bralidarts we tested five generic aligners five secondary_structure aware aligners and the three new methods described here on the datasets of bralidarts we then calculated sp and nirmsd the two metrics developed for bralidarts the sp estimates the fraction of base_pairs aligned with a potentially homologous pair this metric merely requires knowing the secondary_structure of the considered sequences the nirmsd is used to estimate the variation of intra_molecular distances across homologous pairs of residue pairs as defined by the msa one evaluates it relies on the notion that in a correct alignment the distance between two residues in a structure should be as similar as possible to the distance between homologous residues in another structure this measure is made local by only considering for any given residue the difference of distances between a residue and its neighborhood across a structure for proteins a sphere of radius a was reported to be an optimal size in the context of this work we tested three values and supplementary data we found the a limit to yield the most informative correlations even though no strong differences were observed between and a cutoffs as our aim was to quantify the importance of structural_information when assembling an rna msa we first calculated the bp index base_pair index for each sequence representing the fraction of paired residues as determined by x dna such score varies_significantly across datasets and ranges from to with a median close to we split the bralidarts accordingly in two subsets one containing datasets made of low_density secondary_structures datasets bp index and a second one containing high_density structures datasets bp index supplementary we then averaged readouts for each alignment_method in both the high and the low_density bin on the low_density dataset we found the sp readouts to behave roughly according to expectations with primary methods delivering results points lower than their secondary counterparts versus tertiary methods like sara coffee were among the best these observations are in stark disagreements with nirmsds readouts that showprimary structure based_methods outperforming those based on secondary_structure versus a the lowest_values being the best ones sara coffee is one of the only method consistently delivering the best nirmsd or close to the best sp readouts the different behavior of the two metrics is reflected well in where no correlation appears to exist between the two measures the lack of secondary_structure in this dataset explains why the sp score fails to properly estimate the d alignment_accuracy by contrast to this first series of results our measures on the other subset of bralidarts the one with highly_connected structures gave different results on this dataset the sp and the nirmsd measures are strongly correlated the differences between primary and secondary or tertiary methods are also much more pronounced we found sara coffee to be points more accurate sp and a nirmsd better than sequence_based on these two metrics five of six secondary_structure based_methods outperform all the sequence_based ones this result confirms that on densely structured sequences one can improve msa accuracy by using secondary or tertiary_structure information with the best results being achieved with d information a possible confounding_factor when observing this correlation might be the effect of low_resolution structures in which the bp index could have been underestimated in that case the correlation might have to do more with structural data_quality than with base_pairing density to rule out this possibility we used bralidarts hq a third reference dataset made of a small number of carefully_selected high_quality and high_density structures and found the correlation to be even stronger we also tried to rule out the possibility that the sara coffee improvement might have resulted from the use of experimental as opposed to predicted secondary_structures rather than tertiary_structure information for that purpose we designed r coffeereal an adaptation of r coffee that explicitly uses experimental secondary_structures results show that on the high structural density dataset r coffeereal manages to improve significantly over r coffee on most datasets regardless of the considered metrics sp or nirmsd the burden of requiring an experimental tertiary_structure for each rna_sequence one wants to align dramatically limits the scope of sara coffee unfortunately such data are scarce for instance of the rna pdb chains longer than eight nucleotides available from the pdb only have a close homolog identity to some of the million sequences reported in rfam to evaluate the effectiveness of sara coffee in a more realistic context we asked whether using only a handful of structures might be enough to significantly improve msa modeling bestpair method the results are not strongly conclusive with bestpair being only slightly more accurate than other structure based_methods nirmsd albeit significantly less than sara coffee and not significantly more accurate with respect to the sp measure than any structure informed methods this result which is rather consistent with similar protein analysis suggests a strong dependence between the final model accuracy and the overall amount of available structural_information all together the results measured on the low and the high_density bralidarts subsets suggest some heterogeneity and a strong sensitivity to datasets structural composition when dealing with highly_structured sequences secondary_and based_methods perform better and result in highly_correlated secondary sp and tertiary nirmsd readouts this correlation seems to disappear when analyzing low_density structures we tested this hypothesis a bit further by taking_advantage of the availability of alternative msas for each single dataset this variety allowed us to estimate a pearson_correlation between the sp and the nirmsd of each single dataset and plot the resulting values against the bp index despite a rather weak correlation the trend shows an increasing correlation above a bp index of with most datasets with bp index having strong correlations this result suggests secondary_structure based_methods to be best suited for datasets having a bp index we tested this hypothesis by measuring on each dataset the difference in nirmsd readouts between primary and secondary_structure based_methods as expected we found that below a bp index of primary methods tend to give better results whereas above this value secondary_structure aware methods often result in an improvement a similar analysis carried_out by comparing primary and tertiary based_approaches shows that sara coffee yields its most significant improvements on datasets with a bp index but rarely degrades the msas below this value we completed our analysis by doing a pairwise_comparison of all the methods considered here and by counting for each metric the number of times any method outperforms any other method supplementary figs s and s such a comparison is important as it makes it possible to estimate the statistical support for the observed differences we found most differences to be statistically_significant on the sp method whereas on the nirmsd sara coffee is the only aligner whose behavior appears to be statistically different from most alternatives on most datasets these comparisons which reflect individual dataset readouts also support the notion of secondary_structure information being more useful when dealing with highly_structured sequences the cpu requirements of sara coffee are significantly_higher than those of sequence_based and we found our method to be times slower than locarna but also times_faster than consan coffee with the number of sequences being the main source of cpu cost supplementary considering the number of available pdb structures this makes sara coffee a realistic option for the computation of all currently available datasets on a standard desktop machine regardless of the fraction of structured nucleotides the easiest explanation for the lack of accuracy of aligners using predicted secondary_structures is probably the tendency of over predicting secondary_structures on these sequences indeed a closer inspection on the low fraction structure shows that these datasets are enriched in heterodimer interactions rna rna or rna proteins a finding that confirms the well known issue of accurately predicting ab_initio structures without taking_into the folding context in the real_world rna tertiary_structure information is rather scarce and we therefore had to ask whether alternative sources of information could be reasonable substitutes for tertiary_structure data for instance it is now possible to do large_scale secondary_structure using high_throughput and the two leading technologies for single_molecule sequencing_techniques pacbio and nanopore have been announcing kits dedicated to large_scale secondary structure_determination it is therefore realistic to consider that a wide amount of secondary_structure information will soon be available although its accuracy still needs to be verified we tested the effect of using this information using a variation of the r coffee method_named r coffeereal our results are encouraging they show that when dealing with highly_structured rnas the use of experimental secondary_structure results in msas significantly better than those obtained with alternative secondary methods even though accuracy does not reach the level of pure tertiary_structure based alignments this result was also supported by the high correlation observed when measured on bralidarts hq the main limitation of our work is probably its reliance on a rather small collection of datasets furthermore sequences making up this dataset are also rather short nucleotides on average at most it is not entirely clear how the behavior of methods relying on secondary_structure can be extrapolated to longer_sequences as it is well known that length tends to impact structure prediction_accuracy by contrast it is likely that the good performances measured on r coffeereal and all methods using experimental_data will hold reasonably well our approach is generic and could easily be extended to any pairwise rna_structure aligner in practical terms t coffee is an open_source package that can be adapted by anyone it has been designed so as to allow the introduction of any third_party package with minimal effort thus making the incorporation of new third_party rna alignment package mostly a benchmarking exercise no ideal substitute seems to exist for experimental_data when modeling rna homology a method like sara coffee could therefore be useful for anyone requiring high_quality msa modeling for sequences having known d structure and it is probably a realistic expectation that its relevance will grow as rna structural databases become more populated start up funds from the department of pathology at the university of alabama birmingham to e c spanish mineco bfu to m a m r it reflects only the authors views and the european community is not liable for any use that may be made of the information contained therein conflict of interest none declared 
