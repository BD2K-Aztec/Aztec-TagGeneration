sequence_analysis a phylogenetic mixture_model for the identification of functionally divergent protein residues motivation to understand the evolution of molecular_function within protein_families it is important to identify those amino_acid responsible for functional_divergence i e those sites in a protein_family that affect cofactor protein or substrate binding_preferences affinity catalysis flexibility or folding type i functional_divergence fd results from changes in conservation evolutionary_rate at a site between protein subfamilies whereas type_ii fd occurs when there has been a shift in preferences for different amino_acid chemical_properties a variety of methods have been developed for identifying both site types in protein subfamilies both from phylogenetic and information_theoretic angles however evaluation of the performance of these methods has typically relied upon a handful of reasonably well characterized biological_datasets or analyses of a single biological example while experimental_validation of many truly functionally divergent sites true_positives can be relatively straightforward determining that particular sites do not contribute to functional_divergence i e false_positives and true_negatives is much more difficult resulting in noisy gold_standard examples results we describe a novel phylogeny based functional_divergence classifier fundi unlike previous_approaches fundi uses a unified mixture_model based_approach to detect type_i fd to assess fundis overall classification_performance relative to other methods we introduce two methods for simulating functionally divergent datasets we find that the fundi method performs better than several other predictors over a wide_variety of simulation conditions functional_divergence in proteins over evolutionary time includes the processes of sub and neo functionalization after gene_duplication as well as specialization or loss of functions of proteins in distinct organismal lineages to whom correspondence should be addressed two main patterns of functional_divergence fd at the amino_acid residue_level have been described in the literature and were classified by as type_i in the case of a protein_family composed of two subgroups type i functional_divergence is characterized by greater conservation at a site in one subfamily versus the other subfamily indicating a difference in evolutionary_rate between them due to fewer selective constraints in the more rapidly_evolving group for type_ii divergence sequence_conservation at a site is observed in both subfamilies but with a marked preference for different amino_acids generally with very different physicochemical_properties in each group accurate prediction of fd residues also known as specificity determining sites in the case where divergence changes the substrate that is bound leads to an enhanced understanding of the mechanisms_underlying functional diversification three main approaches have been used for the prediction of fd protein residues that in broad terms can be classified as primarily phylogenetic information_theoretic or biophysical phylogenetic approaches such as evolutionary trace diverge and various likelihood_ratio rate shift based tests explicitly take into account a phylogenetic_tree that describes the evolutionary_relationships among the sequences in the protein_family under consideration in general phylogenetic_methods for fd prediction correlate observed patterns of amino_acid at a site in a multiple_sequence across subgroups within a phylogenetic_tree local conservation i e within a subgroup on a phylogenetic_tree relative to other sequences reflect probable functional specificity of that subgroup if the degree of conservation is large relative to the overall divergences of the sequences within that subgroup this general_case can be extended to more rigorous statistical_models of functional_divergence such as the type_i specific prediction methods_employed by diverge in contrast information_theoretic approaches do not generally explicitly consider the relationship between sequences only the known or predicted divisions into functional subgroups and perhaps some weighting based on overall sequence distances as in groupsim these approaches contrast informationtheoretic measures of variation of site profiles within a subgroup to those observed at a site across the whole multiple_sequence these profiles may most commonly be represented by some information_theoretic measure of variability among residuespage we investigated and compared the performance of the fundi methods and several other methods for fd site prediction over a range of tree_topologies and sizes identifying particular tree_topologies that may prove problematic for prediction of functional_divergence the impact of taxon sampling recovery of true molecular_diversity length of the branch separating the subtrees and overall tree length was also investigated in order to build a robust picture of the behavior of the various functional_divergence prediction_algorithms and their performance over phylogenetically diverse data several programs were selected based on their performance in previous_studies as well as their ability to be used in a large_scale testing pipeline we tested the performance of our own method fundi using both qmmraxml and raxml for site log_likelihood calculation fundi conswin speer groupsim sequence harmony and multi relief both sequence harmony and multi relief were used as implemented in multi harmony these programs represent the top performing methods as determined by prior studies and include both phylogenetic and informationtheoretic approaches a likelihood_ratio method for fd detection was also evaluated on both the simulated and real_biological however as it had poor_performance in initial tests we did not do a complete set of analyses see supplementary_materials eleven two subfamily biological_datasets were selected fromand performance was evaluated the datasets were selected with the requirement that each subfamily had to be phylogenetically distinct and contain a minimum of four taxa per subfamily the datasets selected feature a broad range in terms of number of taxa and number of fd sites the performance of most classifiers as measured by auc roc was very similar with more variation seen in the auc pr metrics supplementary using the medians of the auc pr distribution to judge the overall performance groupsim appeared to have the overall best performance with fundi conswin and multi relief as the next best performers in the auc pr plots median performance as measured by auc roc is slightly_higher on these biological_datasets than that observed under either of the two simulation conditions examined below but not significantly except in the case of speer in case of simulated dataset we also compared the performance of the real value evolutionary trace and difference et methods here but due to technical constraints were unable to perform those evaluations on our larger simulated_datasets in simulation set across all datasets the performances of fundi using either qmmraxml or raxml were highly_similar outperforming all other methods tested as measured by the area under the precisionrecall curve auc pr the area_under auc roc and the average rank of true_positive fd sites the program groupsim applies a simple windowing method conswin for adjusting page to be between and with high scores reflecting a better functional_divergence score for average rank lower median values show increased performance the methods evaluated in all cases are fundi with qmmraxml fundi with qmmraxml and the conswin windowing method fundi with raxml groupsim multi harmony mr sequence harmony sh and speer the datasets were simulated with varying conditions over randomly_generated tree_topologies scores of functional_divergence based on neighboring residues in the primary sequence described previously we applied this same method to the posterior_probabilities of functional_divergence p fd generated by fundi with qmmraxml to see if it yielded an improvement and to ensure that our simulation_settings were appropriate for group sims prediction strategy fundi conswin displayed an increase in predictive_performance compared with the non windowed p fd scores alone groupsim was the next best classifier after the three fundi based_methods across all datasets surprisingly given previous_studies speer appeared to have the lowest performance for all three scoring metrics the distribution of auc pr values for fundi was significantly different from the other predictors in all pairwise_comparisons by the wilcoxon_signed with a bonferroni_correction for multiple_comparisons p e all other tests were also significantly different from one another with bonferroni_corrected p 
