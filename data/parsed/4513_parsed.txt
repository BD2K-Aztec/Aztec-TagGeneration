systematic inference of highways of horizontal_gene in prokaryotes motivation horizontal_gene hgt plays_a in the evolution of prokaryotic species typically no more than a few genes are horizontally transferred between any two species however several studies identified pairs of species or linages between which many different genes were horizontally transferred such a pair is said to be linked by a highway of gene sharing inferring such highways is crucial to understanding the evolution of prokaryotes and for inferring past symbiotic and ecological associations among different species results we present a new improved method for systematically detecting highways of gene sharing as we demonstrate using a variety of simulated_datasets our method is highly_accurate and efficient and robust to noise and high rates of hgt we further validate our method by applying it to a published dataset of gene_trees from prokaryotic species our method makes it practical for the first time to perform accurate highway analysis quickly and easily even on large_datasets with high rates of hgt availability_and an implementation of the method can be freely downloaded from http acgt cs tau ac il hide horizontal_gene hgt also called lateral_gene is an evolutionary_process in which genes are transferred between two organisms that do not have an ancestordescendant relationship hgt is known to be rampant among prokaryotes and plays an important role in their evolution and survival an important problem in understanding microbial evolution is to infer the hgt_events i e the donor and recipient species of each hgt that occurred during the evolution of a set of species this problem is generally solved in a comparative_genomics framework by using a parsimony criterion based on the observation that the evolutionary_history of horizontally transferred genes does not agree with the evolutionary_history of the corresponding set of species this is illustrated in supplementary more formally given a gene_tree and a species_tree the hgt inference problem is to find the minimum number of hgt_events that can explain the incongruence of the gene_tree with the species_tree the hgt inference problem is known to be np_hard under most formulations and along with some of its variants has been extensively_studied in general one expects only a few genes to have been horizontally transferred between any given pair of species however it has been observed that some pairs of species are connected by a multitude of hgt_events this can happen for example when a pair of species co inhabit the same ecological_niche over a long period of time due to syntrophic or other close symbiotic relationships between partners or because only the acquisition of a complete pathway can provide a selective_advantage to the recipient such pairs of species are said to be connected by a highway of gene sharing point out thatused the term highways in a slightly different way than we do for beiko et_al highways could exist not only between two species but also between two clades of the species_tree i e their highways are formed by a collection of many individual hgts spanning two clades these highways point towards major events in evolutionary_history well corroborated examples are the uptake of endosymbionts into the eukaryotic host and the many genes transferred from the symbiont to the hosts nuclear_genome recent proposals for evolutionary_events that may be reflected in highways are the role of chlamydiae in establishing the primary plastid in the archaeplastida red and green_algae plants and glaucocystophytes the evolution of double_membrane bacteria through an endosymbiosis between clostridia and actinobacteria and the high rate of transfer between marine synechococcus and prochlorococcus in this work we introduce a fast and accurate method for highway inference given a rooted species_tree any two species nodes in it that are not related by an ancestordescendant relationship define a horizontal edge connecting those two nodes any hgt event must take place along a horizontal edge in one of its two directions a horizontal edge along which an unusually large number of hgt_events have taken place will be called a highway of gene sharing or simply a highway although it is hard to give a precise threshold that would designate an edge as a highway any horizontal edge that contains a markedly_higher number of hgts than would be expected by chance for that dataset can be viewed as a highway in our simulation_studies we defined highways to be those horizontal edges that affect at least of the genes with a history of hgt were the first to study the problem of highway inference but see also they used a straightforward approach given a set of gene_trees and a trusted species_tree they computed the history of hgt_events for each gene_tree separately and then combined the results across all gene_trees the horizontal edges that are inferred in the hgt scenarios for a significant fraction of the gene_trees are the postulated highways thus their solution relies on inferring the individual hgt_events by solving the hgt inference problem this is problematic for several reasons first the hgt inference problem itself is np_hard under most formulations and thus difficult to solve exactly second there are often multiple and sometimes exponentially many optimal solutions to the hgt inference problem and third when the gene_tree has only a subset of the taxa present in the species_tree the placement of the inferred hgts on the species_trees becomes ambiguous furthermore when the rate of hgt is relatively high the number of hgt_events need not be parsimonious i e the hgt inference problem even if solved exactly and yielding only one optimal_solution may not infer the actual hgt_events hgt_events can also be inferred using a more sophisticated reconciliation framework that explicitly accounts for gene_duplication and loss events in addition to hgt_events since such a framework is able to explicitly consider duplication and loss events it can handle gene_trees that have multiple gene_copies per species in the approach of as well as in our approach gene_trees are restricted to contain at most one copy of a gene per species however the same drawbacks discussed above that affect the hgt inference problem apply to the more sophisticated framework as well recently we introduced a novel polynomial time algorithm to detecting highways that bypasses the need to infer individual hgt_events the method is based on the observation that highways by definition affect the topologies of many gene_trees thus the idea is to combine the phylogenetic signals for hgt_events from all the gene_trees and use the combined signal to infer the highways this is achieved by using quartet decomposition the method decomposes each gene_tree into its constituent set of quartet trees and combines the quartet trees from all the gene_trees to obtain a single weighted set of quartet trees the combined set of quartet trees is then analysed against the given species_tree to infer the highways the intuition is that quartet trees that disagree with the species_tree may indicate hgt_events and thus the collective evidence from all quartet trees could pinpoint possible highways in this work we propose an alternative method based on quartet decomposition to detect highways which greatly_improves upon the accuracy noise tolerance and applicability of the method of our method differs from the approach ofin many important_ways i we analyse the quartet decomposition of each gene_tree separately before combining the results across all gene_trees ii we propose a new way to assign scores to horizontal edges which is sensitive to the direction of transfer of individual hgt_events and iii we show how to reduce the amount of noise in the computed scores in order to pinpoint highways even more accurately as we demonstrate using extensive simulations compared with the approach of our new method is significantly more accurate much more robust to high rates of hgt and noise and is able to seamlessly handle gene_trees with many missing taxa for example in simulated taxon datasets with genes a highway of genes and random hgts noise the new method identifies the correct highway in of the cases compared with for the old method it is worth mentioning that quartets have been previously used for phylogenetic_analyses in other contexts for example for phylogeny construction supertrees or analysis of hgts two methods eeep and prunier exist for inferring hgt_events on unrooted gene_trees these methods were not designed for inferring highways but can be used indirectly for doing so as in our quartet based_approach offers important_advantages over approaches based on inferring hgt_events i we do not face the problem of dealing with multiple optimal solutions for the hgt inference problem ii we can seamlessly incorporate gene_trees with only a subset of taxa which is difficult to do effectively with hgt inference methods and iii our method is significantly more scalable and time efficient than both eeep and prunier in general inferring highways based on hgt inference methods can be slow and technically complex our method simplifies the process of detecting and inferring highways as our simulation_study shows our method is also accurate we also applied the method to a dataset of taxa and gene_trees from our results are largely consistent with previous_analyses of this dataset and the entire computational_analysis of this large dataset took days using a single_cpu our new method thus makes it possible to easily quickly and accurately infer highways even for large_datasets as well as on datasets with high rates of hgt we have implemented our method into a freely_available software_package called hide short for highway detection hide is to the best of our knowledge the only available software_package designed specifically to address the problem of inferring highways in this work we presented a new and improved method for systematically detecting highways of gene sharing as shown in the simulation_study our method is highly_accurate and robust to noise and high rates of hgt our analysis of the taxa gene_tree dataset ofdemonstrates the utility of our method in identifying potential highways even in large_datasets our simulation parameters correspond well to real_data in the dataset of only hgts including several highways of size are reported on the entire dataset of gene_trees our experiments show see section s in the supplement that by distributing the same number of hgts across more gene_trees the performance of the method is unaffected and may even slightly improve our simulation scenarioshave a comparable or smaller highway size hgts a comparable or higher noise_level random hgts and less gene_trees as the number of taxa that we use is smaller versus the random hgts are less spread in our case which again makes our scenario harder as we observed in section hence the simulations present a scenario that is as difficult or harder than the real_data in each of the parameters the numbers of genes in our highways correspond well to other highways characterized in the literature e g in thermotogales and in aquificales highways represent major shifts from the pattern of vertical inheritance and their detection is crucial for correctly representing the evolutionary_history of prokaryotes indeed a logical first step towards building a comprehensive phylogenetic network for the prokaryotes is to start with the ribosomal tree as backbone and augment it with highways by making it easy to quickly and accurately detect such highways our method represents an important step towards building the prokaryotic net of life as with the method of our new method is based on quartet decomposition however we use quartet decomposition in a different way and as a result of this and other methodological improvements our method achieves far better results and greatly_improves upon its accuracy noise tolerance and applicability still our method has several limitations it makes use of the parsimony principle and if a dataset contains two highways that are closely_related to one another then the method may only detect one of them as many of the inconsistent quartet trees from one highway may also support the other highway formulating the highway detection problem in a probabilistic_framework could help improve the accuracy of highway detection also a statistical_analysis of highway and hgt score distributions could help provide more quantifiable significance of the computed highways which we currently lack our method is unable to detect hgts between two sister species i e two species that have the same parent a limitation shared by all existing phylogenetic_methods for studying hgt but see our analysis of the dataset of beiko et_al suggests that as with all previous methods our method is vulnerable to errors in the species_tree and that such errors can manifest themselves as highways in the analysis extending the method to deal cleanly with uncertainty in the species tree_topology would help to pinpoint highways more accurately it would also be interesting to study how convergent gene losses in unrelated taxa e g species that have independently converged to parasitic lifestyles affect our method finally it may help to distinguish between directed and undirected highways of gene sharing see section s in the supplement 
