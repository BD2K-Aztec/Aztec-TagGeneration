systems_biology metassign probabilistic annotation of metabolites from lc_ms data using a bayesian clustering approach r on motivation the use of liquid_chromatography to mass spec trometry has enabled the high_throughput profiling of the metabolite composition of biological_samples however the large amount of data obtained can be difficult to analyse and often requires computational processing to understand which metabolites are present in a sample this article looks at the dual problem of annotating peaks in a sample with a metabolite together with putatively annotating whether a me tabolite is present in the sample the starting_point of the approach is a bayesian clustering of peaks into groups each corresponding to putative adducts and isotopes of a single metabolite results the bayesian modelling introduced here combines information from the mass to charge ratio retention time and intensity of each peak together with a model of the inter peak dependency_structure to increase the accuracy of peak annotation the results inherently contain a quantitative estimate of confidence in the peak annotations and allow an accurate trade_off between precision and recall extensive validation experiments using authentic chemical standards show that this system is able to produce more accurate putative identifications than other state of the art systems while at the same time giving a probabilistic measure of confidence in the annotations availability_and the software has been implemented as part of the mzmatch metabolomics analysis_pipeline which is available for download at http mzmatch sourceforge net the metabolome being the entire set of metabolites in a biological system is a highly informative descriptor of the physiological_state of an organism and understanding the dynamics of the metabolome is essential for a wide_range of biomedical_applications major advances have been made recently in the development of high_throughput assays to measure the metabolome one of the most popular_methods for this purpose is mass_spectrometry ms coupled to a chromatographic_separation such as liquid_chromatography lc the output of the lcms process is a set of peaks characterized by their mass per unit charge and their chromatographic retention time for almost all subsequent analysis to be undertaken these measured peaks have to be annotated i e matched to the particular metabolites that produced them accurate reliable peak annotation and metabolite_identification is currently the greatest challenge in high_throughput metabolomics in this article the terms identification and annotation are used in the sense specified by the chemical analysis working group of the metabolomics standards initiative where identification means a positive comparison with an authentic standard using two or more measured quantities e g mass and retention time and annotation means a positive comparison with compounds using physicochemical_properties or spectral databases tandem_ms or more generally ms n and comparison with authentic_standards are two common approaches to providing robust metabolite identifications for global untargeted metabolomics comparison of each detected metabolite with an authentic standard rapidly becomes infeasible through cost and availability of standards fragmentation methods including ms_ms and ms n are powerful but rely on libraries of fragmentation_patterns of authentic_standards however fragment patterns are often similar between isomers of the same compound fragmentation prediction_algorithms exist but are limited in similarity to standards derived fragment patterns there are three key_factors that make peak annotation and metabolite_identification difficult first the finite mass accuracy of the ms equipment and the large number of potential formulas results in multiple possible mass matches for each observed peak second each metabolite in the sample being measured may produce many peaks including isotopologues adducts molecular_fragments and multiply charged ions these peaks form a dependency_structure and exacerbate the problem of overlapping database matches accounting for them in some manner is needed to avoid an overwhelming number of false annotations finally many observed peaks will be the result of impurities and contaminants to whom correspondence should be addressed the author published_by this is an open_access the terms of the creative commons attribution license http creativecommons org licenses by which_permits distribution and reproduction in any medium provided the original_work a considerable number of computational_methods have been developed to address the metabolite annotation challenge one of the main differences among existing algorithms is how they treat derivative peaks and their associated dependency_structure some methods ignore these relations altogether and match individual peaks against a database others attempt to annotate metabolites by first grouping peaks in some manner and then assigning a putative annotation to the groups e g additional types of data can also help e g predicted retention_times of molecules have recently been used to help in identification there has also been much work on the use of multistage ms to produce a fragment tree that can be compared against hypothetical fragment trees to contribute to the annotation as well as methods that attempt to improve accuracy by taking_into inter peak dependencies there have also been attempts to incorporate additional information not contained within the spectra to improve annotation for example silva et_al to assess the performance of peak annotations three measures were used precision recall and their harmonic mean the f score as in all classification algorithms there is a trade_off between precision and recall with good procedures trying to maximize both with comprehensive results given in the supplementary_material shows an example of this trade_off in these figures prior means the prior probability of peaks being assigned to metabolites posterior means the raw posterior_probability and metassign means the posterior_probability calculated as described in section as can be seen from these results metassign performs best with the best precision while recalling the majority of peaks the target it was designed to achieve in this circumstance mzmatch struggles to recall half the peaks with a precision of while camera is extremely selective and annotates only a tiny fraction of the input_data albeit with high_precision to see the systematic behaviour of the algorithms shows how the f score changes as the size of the decoy_database is varied for the smallest databases the prior assignment based on the best match of the mass to charge ratio performs best but as the database grows to more and more realistic sizes the metassign algorithm becomes the best performing method for the metabolite annotation task the results are presented in terms of the tpr and fpr an example analysis of this task is shown in the form of a roc_curve in although the metassign output dominates the other methods over most parts of the curve the operating point will be at a level from to fpr and it is here that the behaviour is of interest at this level the number_of returned by an algorithm would bebold values indicate best performance limited while still achieving an acceptable amount of recall of the compounds that are present in the sample shows the performance at an fpr of as can be seen metassign consistently performs much better than the other two algorithms at annotating metabolites for all standard mixtures tested and at all sizes of the decoy_database 
