spaced seeds improve k_mer based metagenomic classification motivation metagenomics is a powerful approach to study genetic content of environmental_samples which has been strongly promoted by next_generation to cope with massive data involved in modern metagenomic_projects recent tools rely on the analysis of k_mers shared between the read to be classified and sampled reference_genomes results within this general framework we show that spaced seeds provide a significant_improvement of classification_accuracy as opposed to traditional contiguous k_mers we support this thesis through a series of different computational_experiments including simulations of large_scale metagenomic_projects availability_and supplementary_information scripts and programs used in this study as well as supplementary_material are available frommetagenomics is a powerful approach to study genetic_material contained in environmental_samples the advent_of sequencing_technologies known as next_generation ngs revolutionized this approach by avoiding the need of cloning the dna and thus greatly facilitating the obtention of metagenomic_samples at the same time drastically decreasing its price presentday metagenomic_studies focus on various bacterial fungal or viral_populations exemplified by the human_microbiome that investigates microbial_communities at different sites of human_body modern metagenomics deals with vast sequence_datasets on the one hand metagenomic_samples metagenomes obtained through ngs are commonly measured by tens of billions of bp these sequences generally come from a number of different species some of which either have a previously_sequenced reference_genome or have a related sequenced species sufficiently close phylogenetically to determine this relationship by sequence comparison other sequences however may come from organisms that have no sufficiently close_relatives with sequenced_genomes or from dna_fragments that show no significant similarity with any available genomic_sequence the metagenomic classification_problem is to assign each sequence of the metagenome to a corresponding taxonomic unit or to classify it as novel a way to improve the accuracy of metagenomic classification is to match the metagenome against as large set of known genomic_sequences as possible this set stored in a working reference_database may contain thousands of full microbial_genomes alignment based_classifiers proceed by aligning metagenome sequences to each of the genomes in the reference_database this can be done with generic blast like alignment programs while this approach can be envisaged for small_datasets both metagenome and database and is actually used in such software_tools as megan or phymmbl see for v c the author published_by all_rights for permissions please_e journals permissions_oup com more it is unfeasible on the scale of modern metagenomic_projects on the other hand there exists a multitude of specialized tools for aligning ngs readsbwa novoalign http www novocraft com gem bowtie just to mention a few popular oneswhich perform alignment at a higher speed and are adjusted to specificities of ngs produced sequences still aligning multimillion read sets against thousands of genomes remains computationally difficult even with optimized tools furthermore read alignment_algorithms are usually designed to compute high_scoring alignments only and are often unable to report low scoring alignments as a result a large fraction of reads may remain unmapped several techniques exist to reduce the computational_complexity of this approach one direction is to pre assemble reads into longer contigs potentially improving the accuracy of assignment assembly of metagenomic_reads has been a subject of many works and remains a fragile approach due to its error proneness and high_computational overall it appears feasible mostly for small_size projects with relatively high read_coverage to cope with increasingly_large metagenomic_projects alignment_free have recently come into use those methods do not compute read_alignments thus do not come with benefits of these such as gene identification alignment_free is in itself an established research area reviewed in a recent dedicated special_issue most of alignment_free comparison methods are based on the analysis of words usually of fixed size k_mers occurring in input_sequences a popular_approach is to compute the distance between frequency vectors of all k_mers in each of the sequences in the context of metagenomics however when one of the sequences is short ngs read the analysis is based on the shared k_mers without taking_into their multiplicities in reference_genomes this is also dictated by the prohibitive computational_cost of computing and storing k_mer multiplicities for metagenomics size data two recently released toolslmat and kraken perform metagenomic classification of ngs_reads based on the analysis of shared k_mers between an input read and each reference_genome given a taxonomic tree involving the species of the database those tools map each read to a node of the tree thus reporting the most specific taxon or clade the read is associated with mapping is done by sliding through all k_mers occurring in the read and determining for each of them the genomes of the database containing the k_mer based on obtained counts and tree_topology lmat and kraken algorithms assign the read to the tree node best explaining the counts further similar tools have been published during last months the goal of this work is to show that the metagenomics classification based on the analysis of shared k_mers can be improved by using spaced k_mers rather than contiguous k_mers the idea of using spaced k_mers goes back to the concept of spaced seeds for seed and extend sequence comparison there the idea is to use as a seed i e local match triggering an alignment a sequence of matches interleaved with joker positions holding either matches or mismatches the pattern specifying the sequence of matches and jokers is called spaced seed remarkably replacing contiguous seeds by spaced seeds in sequence_alignment significantly_improves the sensibility selectivity trade_off with almost no incurred computational_overhead this has been first observed byand then extended and formally analyzed in a series of further works see brown and and references therein recently it has been reported in several works that spaced seeds bring an improvement in alignment_free comparison as well show that comparing frequency vectors of spaced k_mers k_mers obtained by sampling must match positions of one or several spaced seeds as opposed to contiguous k_mers leads to a more accurate estimation of phylogenetic distances and as a consequence to a more accurate phylogenetic_reconstruction study another measurethe number of pairs of matching not necessarily aligned spaced k_mers between the input sequencesand show that it provides an even better estimator of phylogenetic distance in no and martin it is shown that the number of hits of appropriately chosen spaced seeds i e the number of pairs of matching aligned spaced k_mers between the two sequences and their coverage i e the total number of matches covered by all hits provides a much better estimator for the alignment distance than the same measures made with contiguous seeds from a machine_learning perspective and onodera and shibuya show that spaced seeds provide better string kernels for svm based classification confirmed by experiments with protein classification see also no and martin in this work we show that using spaced k_mers significantly_improves the accuracy of metagenomic classification of ngs_reads as well to support this thesis we consider different scenarios as a test case we first study the problem of discriminating a read between two genomes i e determining which of the two genomes is phylogenetically closer to the read we then analyze the correlation between the score of an alignment of a read to a genome and the seed count for this read defined either as the number of hits or as the coverage this analysis provides an insight on how well one can estimate the similarity between a read and a genome out of k_mer occurrences finally we make a series of large_scale metagenomic classification experiments with kraken software extended by the possibility of dealing with spaced seeds these experiments demonstrate an improved classification_accuracy at the genus and family levels caused by the use of spaced seeds instead of contiguous ones through a series of computational_experiments we showed that spaced seeds significantly improve the accuracy of metagenomic classification of short ngs_reads the superiority of spaced seeds for different variants of alignment_free has been recently demonstrated by other authors as well in this work we specifically focused on the metagenomics setting characterized by very large volumes of data both in terms of the number of reads and the size of genomic database this quantity of data precludes using some alignment_free comparison techniques andz leaves room only for highly time and space efficient approaches note also that in our setting we have to compare short_sequences reads with long ones whole genomes which makes an important difference with problems considered inis to use multiple seeds i e several seeds simultaneously instead of a single one this extension is known to bring an advantage in seed and extend sequence_alignment and show that this improvement applies to alignment_free comparison as well however each seed requires building a separate index for database genomic_sequences and therefore it appears computationally difficult to use multiple seeds in metagenomics unless some new indexing techniques are designed for this purpose in our work we studied three estimators hit number coverage and jaccard_index hit number and coverage behave_similarly in classification section but jaccard_index generally improves on them in the case of mapping to real genomes section due to the correction with respect to the k_mer richness considered as an estimator of alignment_quality sections and coverage provides a certain advantage over hit number more subtle estimators can be considered as well e g by taking_into the position of k_mer in the read reflecting the sequencing_error and this provides an issue for further study designing efficient seeds for metagenomic classification is another important issue that goes beyond the present study note that optimal spaced seeds for seed and extend alignment are generally not optimal for alignment_free k_mer based comparison in no and martin the authors designed sub optimal seeds maximizing the pearson_correlation between hit number coverage count and the alignment_quality their solution is implemented in iedera software the latest_version of iedera performs design for spearman_correlation as well http bioinfo lifl fr yass iedera on the other hand recent work introduces quadratic residue seeds qr seeds for seed and extend alignment which present a good performance and have the advantage of easy design avoiding the computationally_expensive enumeration of iedera in our work we used both iedera and qr seeds adapted to our setting we observed that in most cases iedera seeds are superior being designed specifically for our task but in a few cases qr seeds demonstrated equal or even better performance e g best results offor weights were obtained with qr seeds this may be due to their large span cf supplement material for which applying iedera is computationally_costly real_data experiments of sections have been done using snakemake k ster and overall all our experiments corroborate the thesis of better performance of spaced seeds for metagenomic classification experiments with kraken section give a strong evidence that spaced seeds can improve the classification_accuracy in real_life large_scale metagenomic_projects one further improvement would be to implement coverage and jaccard measures that showed in general a better performance compared with the hit number introducing spaced seeds rises new issues such as the construction of an efficient index of the database or adapting the algorithm of computing the most likely node of the taxonomic tree from counts produced by individual_genomes i e leaves of the tree these questions are a subject for future work 
