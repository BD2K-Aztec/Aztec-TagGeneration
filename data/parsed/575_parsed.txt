genome_analysis a two stage statistical_procedure for feature_selection and comparison in functional analysis of metagenomes motivation with the advance of new sequencing_technologies producing massive short_reads data metagenomics is rapidly_growing especially in the fields of environmental biology and medical_science the metagenomic_data are not only high_dimensional with large number of features and limited number of samples but also complex with a large number of zeros and skewed distribution efficient computational and statistical_tools are needed to deal with these unique characteristics of metagenomic sequencing_data in metagenomic_studies one main objective is to assess whether and how multiple microbial_communities differ under various environmental_conditions results we propose a two stage statistical_procedure for selecting informative features and identifying differentially_abundant features between two or more groups of microbial_communities in the functional analysis of metagenomes the features may refer to the pathways subsystems functional_roles and so on in the first stage of the proposed procedure the informative features are selected using elastic_net as reducing the dimension of metagenomic_data in the second stage the differentially_abundant features are detected using generalized_linear with a negative_binomial compared with other available methods the proposed approach demonstrates better performance for most of the comprehensive simulation_studies the new method is also applied to two real metagenomic_datasets related to human_health our findings are consistent with those in previous_reports availability r code and two example datasets are available atrecently next_generation are able to produce high volumes of data at an affordable cost the power of next_generation makes it possible to explore microbial environments opening a new era of genomics study called metagenomics metagenomics is the study of genomic contents of microbial_communities sampled directly from environments e g soil water human_gut without prior culturing to understand the true diversity of microbes their functions cooperation and evolution in different microbial_communities wooley and ye importantly because only of all microbial organisms can be isolated and cultured in a laboratory metagenomic_analysis enables to reveal the genome contents of the majority of microorganisms that cannot be obtained in traditional genomic analysis based on pure_culture metagenomics is broadly_applicable to many areas including ecology and environmental sciences chemical industry and biomedicine in metagenomic_analysis one important aim is to assess whether and how two or more microbial_communities differ to perform metagenomic comparison researchers can conduct an experiment to compare genomic_features based on either taxonomic compositions or functional components obtained from different microbial_communities in this study we focus on comparison of functions in metagenomes under various conditions the applications of this research include detection of biological threats and discovery of new bioenergy and new medicine and so on for example comparing microbial_communities from human_gut corresponding to different phenotypes e g diseased and healthy or different treatments can help us determine the activities of microbes related to the disease resulting in understanding the reactions of microbes that respond to different biochemical products this may lead to drug_development or treatment selection that specifically affects either a particular activity or a group of activities that the disease related microbes might perform statistical_procedures play_a in detecting differentially_abundant features across different microbial conditions the features here may refer to taxa functional_roles pathways or subsystems several statistical_methods or tools have been developed to compare various microbial_communities in terms of detecting differentially_abundant features e g sons xipe totec metastats and megan however all of these methods tools are designed to compare exactly two microbial conditions shotgunfunctionalizer uses a regression_method on comparing multiple samples but it assumes poisson to whom correspondence should be addressed distribution on the count_data it is well known that poisson_model lacks flexibility for over dispersed count_data another method metagenomeseq has been recently_developed to assess differential abundance in sparse high_throughput microbial marker gene survey data even though it can compare multiple conditions metagenomeseq is designated for comparison of taxonomic compositions of different metagenomes rather than functional compositions in this research we focus on statistical_comparison of functions in metagenomes under various conditions statistical_methods developed for rna_seq analysis may be applicable to metagenomic_analysis also as both rna_seq experiments and metagenomic experiments use sequencing_technologies and produce count_data a number of statistical_tools have been developed for rna_seq such as edger and deseq however there are differences between rna_seq and metagenomic_data different from rna_seq one of the common characteristics of metagenomic_data is the presence of many features with zero counts it is because metagenomic_samples consist of a mixture of microbes the species specific functions may only appear in some microbial conditions while in typical rna_seq experiments the genes are the same for different experimental_conditions and only expression levels change thus metagenomic sequencing_data may be more sparse than the rna_seq our research was motivated by i the limitations of existing_methods developed for metagenomic_analysis ii the increasing focus of metagenomic_projects on wide_applications in various areas e g human_microbiome hmp and iii the limitations of applying current methods developed for rna_seq analysis to metagenomic_analysis in this article we propose a two stage statistical algorithm for selecting informative features and detecting differentially_abundant functional features e g pathways subsystems functional_roles between different microbial conditions in the first stage of our algorithm the informative features are selected using elastic_net resulting in dimensional reduction of the metagenomic_dataset in the second stage of our approach we detect differentially_abundant features using generalized_linear glms with a negative_binomial nb distribution in sparse_data elastic_net is a satisfactory variable_selection method in the case that the number of predictors p is much bigger than the number of observations n that is when p n in addition another advantage of elastic_net is that it is well suitable to data containing a grouping effect i e strongly correlated predictors tend to be in or out of the model together the nb distribution is widely used to model count_data the novelty of our two step method is that we take the common characteristics of metagenomic_data into account and combine the feature_selection and feature comparison in metagenomic study to improve the power of feature_detection our method can be directly applied to comparison of more than two microbial conditions therefore our method can be applicable to more general situations e g in clinical_trials where the goal is to compare multiple treatment conditions or in natural environmental studies where multiple conditions are compared and investigated currently there has been an increasing interest in metagenomic_projects with various applications one typical aim is to assess whether and how two or more microbial_communities differ comparing microbial genetic contents on the basis of functional features e g pathways subsystems functional_roles obtained from different microbial_communities with different phenotypes e g diseased and healthy or different treatments enables us to identify the gnomic contents of microbes contributing to human_health and disease which can in turn lead us to understand how the microbes affect human_health we proposed a two stage statistical_procedure for sequentially selecting informative functional features and detecting differentially_abundant functional features between two or more microbial_communities conditions the proposed method accounts for the specific characteristics of metagenomic_data which are highdimensional complex datasets consisting of a large proportion of zeros non negative counts with skewed distribution and a large number of features but limited number of samples from the results of various simulations we showed that our proposed method more effectively selects the informative functional features and therefore more efficiently detects the differentially_abundant functional features between metagenomic_datasets owing to the existence of large proportion of zeros in metagenomic_data we also fitted the zero inflated negative_binomial zinb on the filtered data through elastic_net for the experiment comparing the results from nb and zinb methods nb approach exceeds the zinb fitting for most of the cases according to the auc plots and power plots shown in the supplementary_file supplementary figs s and s otherwise these two methods are comparable however the computational time for zinb is times longer than for nb fitting due to more parameters in the zinb models we also applied the proposed method on two real metagenomic_datasets related to two human_diseases one of them is related to obesity and ibd and the other one is related to cf_lung in the gut data there are four phenotypes groups owing to the combination of the two diseases our method is directly applied to this multiple group comparison and our findings are consistent_with compared with other existing_methods on metagenomic_studies the proposed twostage method is more powerful and flexible 
