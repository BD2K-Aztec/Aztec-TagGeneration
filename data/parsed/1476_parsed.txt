genome_analysis drimm synteny decomposing genomes into evolutionary_conserved segments motivation the rapidly increasing set of sequenced_genomes highlights the importance of identifying the synteny_blocks in multiple and or highly duplicated genomes most synteny block reconstruction algorithms use genes shared over all genomes to construct the synteny_blocks for multiple_genomes however the number of genes shared among all genomes quickly decreases with the increase in the number of genomes results we propose the duplications and rearrangements in multiple mammals drimm synteny algorithm to address this bottleneck and apply it to analyzing genomic architectures of yeast plant and mammalian_genomes we further combine synteny block generation with rearrangement analysis to reconstruct the ancestral preduplicated yeast_genome contact the evidence in favor of the whole_genome wgd in saccharomyces_cerevisiae was discovered by wolfe and shields but was heavily contested e g seeused preduplicated genomes of kluyveromyces waltii and ashbya gossypii to settle this controversy see for a recent study contesting the wgd in yeast starting from wolfe and shields andall wgd studies essentially amounted to constructing synteny_blocks of certain type e g sister blocks in seoighe and wolfe or doubly conserved synteny dcs blocks inand demonstrating that these blocks cover a large portion of the genome remarkably there is still no general_purpose tool that would automate such analysis and reduce various wgd studies to simply computing a duplicativity coverage of the genome for example software fromis not applicable to finding the synteny_blocks from seoighe and wolfe and vice_versa indeed most wgd studies developed new software for wgd analysis instead of using some previously_developed tools to whom correspondence should be addressed we argue that the lack of tools for automated wgd analysis is the result of the lack of tools for synteny block identification in highly duplicated genomes many genomes have undergone extensive duplications followed by gene losses and rearrangements making decoding of genomic architecture synteny block reconstruction in such genomes difficult for example duplications account for of the arabidopsis_thaliana genome making synteny block reconstruction in this and other plant_genomes challenging shows a highly duplicated genome g along with its decomposition into overlapping left and non overlapping right synteny_blocks the nonoverlapping decompositions are more desirable since they are required for the follow_up rearrangement and duplication studies e g the existing genome rearrangement algorithms are unable to analyze overlapping decompositions however constructing nonoverlapping decompositions is more difficult than constructing overlapping decompositions while it may appear that one can simply subpartition the overlapping blocks into the non overlapping ones explained that this partitioning does not work for complex genomes proposed the first algorithm for synteny block generation which was aimed at comparative mapping data and did not take into account micro rearrangements the first algorithms for synteny block reconstruction in sequenced_genomes grimm synteny and chains and nets were developed in when thousands of micro rearrangements in mammalian_genomes were discovered these and many other synteny block generation algorithms proved to be adequate for small sets of genomes but did not address issues that stem from extensive duplications and deletions most previous_efforts to generate synteny_blocks for highly duplicated genomes generated overlapping rather than non overlapping blocks in contrast some recently_developed tools e g enredo tool used in ensembl aim to generate non overlapping synteny_blocks the non overlapping representation has advantages over the traditional pairwise and overlapping representation of duplications indeed the pairwise representation that dominated previous_studies of human segmental_duplications left the question of finding ancestral duplicons in the human_genome unanswered while the non overlapping representation constructed in a human chimpanzee macaque rat mouse opossum cow synteny block in human_chromosome contains genes with only of them shared between all species while of these genes appear to be present only in a single_genome like gene in macaque most of these genes have orthologs in other species these orthologs are not shown since they are located within other synteny_blocks in other species resolved it also an overlapping representation can be easily_obtained from a non overlapping representation but not vice_versa shows an humanchimpanzeemacaqueratmouse opossumcow synteny block and illustrates the challenge of constructing synteny_blocks in multiple_genomes as the number of analyzed genomes increases the number of shared genes may substantially decrease while this block contains genes only of them are shared between all species the existing synteny block generation algorithms such as grimm synteny are likely to miss such a block with only two shared genes or discard it as statistically_insignificant noticed that the problem of constructing non overlapping synteny_blocks is similar to the difficult problem of de_novo repeat classification introduced the a bruijn_graph approach to repeat classification representing all repeats as a mosaic of nonoverlapping subrepeats later the a bruijn graphs were found to be useful in diverse applications such as multiple_alignment de_novo protein sequencing analysis of segmental_duplications and next_generation while diverse applications of a bruijn graphs use the same algorithmic idea each application has unique features that need to be addressed for a new research domain the original a bruijn_graph approach involves some heuristics that may or may not work for a particular application for example the bulge removal heuristic was originally designed for fragment assembly of sanger reads but turned out to work well in various tools for next_generation mass_spectrometry and synteny block reconstruction another important heuristic that is application specific is the threading procedure fromthat reconstructs how the genome traverses the transformed a bruijn_graph while threading was never problematic in sequencing_applications came to the conclusion that it is a major_bottleneck in synteny block reconstruction and wrote optimizing the a bruijn_graph approach for synteny block generation represents the next challenge in analyzing the genomic architectures our article addresses this problem by devising the first a bruijn_graph approach that does not require a threading step and substitutes it with an alternative genome modification step implemented in the duplications and rearrangements in multiple mammals drimm synteny software http bix ucsd edu projects drimm we illustrate applications of drimm synteny to analyzing yeast plant and mammalian_genomes and further combine it with rearrangement analysis to reconstruct the ancestral preduplicated yeast_genome see section of the supplementary_material datasets and parameters the yeast gene orders were extracted from the mammalian gene orders were generated using msoar program the gene_order of a thaliana was extracted from although every synteny block reconstruction algorithm is parameters independent we are not aware of tools for automatic derivation of the optimal parameters the parameters choice for these tools and drimm synteny relies on an expert analysis see supplementary section for parameter choice in drimmsynteny in this article we use the default_parameters girth pathlength thornlength for all datasets synteny_blocks in seven mammalian_genomes to benchmark drimm synteny on multiple but not highly duplicated genomes we analyzed seven mammalian_genomes human h chimpanzee c macaque q rat r mouse m opossum o and cow w as the number of genomes increases the number of genes that are shared between all genomes decreases and methods relying on the genes shared by all genomes e g grimm synteny deteriorate shows a seven way synteny block that would most likely be missed by such tools the concatenation of seven mammalian_genomes results in a virtual genome with genes unique genes the simplified a bruijn_graph of this concatenation with the default_parameters has vertices and edges substituting non branching paths in this graph by single edges results in a graph on vertices and edges drimm synteny still finds many synteny_blocks with good coverage in this highly duplicated virtual genome supplementary table s a and supplementary files enredo an advanced synteny block generation tool used in ensembl generated seven way blocks with a significantly_lower coverage supplementary to further compare enredo and drimmsynteny we ran both program on the dataset initially containing only human and chimpanzee genomes where these tools generated nearly identical results then at each step we added one more genome to the dataset generated k way synteny_blocks k is the number of genomes computed the genome_coverage by these blocks and repeated the process for k shows that as more genomes are added to the dataset drimm synteny continues generating synteny_blocks with high coverage for seven way blocks while the seven way synteny_blocks generated by enredo cover only of the genome synteny_blocks in k waltii and s cerevisiae the concatenation of s cerevisiae s and k waltii k results in a genome with genes unique genes the simplified a bruijn_graph of this concatenation has vertices and edges substituting nonbranching paths in this graph by single edges results in a graph on vertices and edges drimm synteny finds nearly all dcs blocks identified inas well as singly conserved synteny_blocks since most studies of genomic architectures ignore very short synteny_blocks we delete all short synteny_blocks with fewer than genes in each species in an iterative fashion as described in supplementarypresents s cerevisiae and k waltii genomes in the alphabet of large dcs synteny_blocks for and drimm synteny produce blocks with similar coverage for small k the k way synteny_blocks generated by enredo have lower coverage for larger k k s blocks represent blocks of multiplicity that have one instance in k waltii and one instances in s cerevisiae the average size of the k s s and k s blocks is and genes respectively before removing short blocks and b shows the position of dcs blocks on s cerevisiae genome generated by drimm synteny and inand illustrates that they produced nearly identical results the statistics of synteny_blocks generated by drimm synteny is given in enredo on the other hand missed many synteny_blocks found in see section of the supplementary_material this raises a question why a rather sophisticated enredo algorithm failed to reveal synteny_blocks constructed using a simple approach from we emphasize that enredo is a general synteny block generation tool while the approach inhas many limitations it is only applicable to pairs of pre wgd and after wgd genomes with small number of additional segmental_duplications we also ran drimm synteny on the s cerevisiae genome alone with the default_parameters drimm synteny generated synteny_blocks which cover about the genome and reveal a pattern similar to the one shown_inand b this result is consistent with the analysis in seoighe and wolfe blocks with coverage while seoighe and wolfe indeed revealed sister blocks in s cerevisiae we are not aware of any general_purpose synteny block generation tool that can automatically construct synteny_blocks in highly duplicated genomes asillustrates if such a tool was available in when the paperwas published it would provide a solid_evidence for wgd in s cerevisiae even without additional analysis inwould be largely reduced to merely running drimm synteny the rapidly increasing set of sequenced_genomes highlights the importance of identifying the synteny_blocks in multiple and or highly duplicated genomes as the number of analyzed genomes increases the number of shared genes may decrease substantially the synteny block generation algorithms based on pairwise_comparisons are often limited since in some cases the synteny_blocks can only be reconstructed by multi way comparison we proposed the drimm synteny algorithm for identifying the nonoverlapping synteny_blocks and bypassed the difficult threading problem a bottleneck in by developing a new a bruijn_graph approach for solving the smp analyzing enredos results we also thank max alekseyev rustem aydagulov and vladimir dobrynin for their helpful comments we are grateful to max alekseyev kevin byrne tao jiang and qian peng for help with generating gene orders of yeast plant and mammalian_genomes 
