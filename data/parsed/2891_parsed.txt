metabolite_identification through multiple_kernel on fragmentation_trees motivation metabolite_identification from tandem mass_spectrometric is a key task in metabolomics various computational_methods have been proposed for the identification of metabolites from tandem_mass fragmentation tree methods explore the space of possible ways in which the metabolite can fragment and base the me tabolite identification on scoring of these fragmentation_trees machine_learning have been used to map mass_spectra to molecular fingerprints predicted fingerprints in turn can be used to score candidate molecular_structures results here we combine fragmentation tree computations with kernel_based machine_learning to predict molecular fingerprints and identify molecular_structures we introduce a family of kernels capturing the similarity of fragmentation_trees and combine these kernels using recently_proposed multiple_kernel approaches experiments on two large reference datasets show that the new methods significantly improve molecular_fingerprint prediction_accuracy these improvements result in better metabolite_identification doubling the number of metabolites ranked at the top position of the candidates list metabolomics deals with the analysis of small_molecules and their interactions in living_cells a central task in metabolomics experiments is the identification and quantification of the metabolites present in a sample this is mandatory for subsequent analysis steps such as metabolic_pathway and flux analysis mass_spectrometry ms is one of the two predominant analytical technologies for metabolite_identification identification is done by fragmenting the metabolite for example by tandem_ms ms_ms and measuring the massto charge ratios of the resulting fragment_ions the measured mass_spectra contain information about the metabolite but extracting the relevant_information is a highly non trivial task several computational_methods have been suggested to identify the metabolites from ms_ms mass_spectral databases spectral_libraries have been created e g which allow us to search measured mass_spectra unfortunately this approach can only identify known unknowns where a reference measurement is available fragmentation_trees are combinatorial models of the ms_ms process b ocker and rasche suggested fragmentation_trees for identifying the molecular_formula of an unknown compound later fragmentation_trees were shown to contain valuable structural_information about the compound the relation between spectral and structural_similarities has been studied by a kernel_based machine_learning approach for metabolite_identification was recently_introduced by relying on predicting the molecular fingerprints as an intermediate step molecular fingerprints are given as bit vectors with each bit describing the existence of certain molecular property such as substructures in the molecule after the prediction imposing some scoring strategy the predicted molecular fingerprints are used for searching some chemical database and finally the ranked_list of candidates are generated besides these two approaches methods have been suggested for predicting ms_ms from molecular_structures commercial software_packages also exist for this task such simulated spectra can be used to replace the notoriously incomplete spectral_libraries by molecular_structure databases combinatorial fragmentation of molecular_structure serves the same purpose finally we can search spectral_libraries for similar compounds by comparing either ms_ms or fragmentation_trees seefor recent_reviews we propose a joint strategy that combines fragmentation_trees and multiple_kernel mkl to improve molecular_fingerprint prediction and subsequently the metabolite_identification we first outline the metabolite_identification framework and introduce fragmentation_trees and their computation next we introduce a family of kernels for fragmentation_trees consisting of simple node and edge statistics kernels as well as path and subtree kernels that use dynamic_programming dp for efficient computation we then describe state of the art methods for mkl in these experiments we evaluate different mkl algorithms with regards to the fingerprint prediction and the metabolite_identification gives an overview for our metabolite_identification framework through mkl fragmentation_trees are computed first followed by the computation of kernels mkl approaches are used to integrate different kernels for molecular_fingerprint prediction the final step of the framework is to query molecular_structure databases with the predicted molecular_fingerprint using a probabilistic scoring_function to whom correspondence should be addressed the author published_by this is an open_access the terms of the creative_commons http creativecommons org licenses by which permits non commercial re use distribution and reproduction in any medium provided the original_work for commercial re use please_contact permissions_oup com two ms_ms datasets compounds downloaded from metlin and compounds from massbank both measured by qtof ms_ms instruments are tested for each compound mass_spectra recorded at different collision energies were amalgamated before further processing we normalize ms_ms such that intensities sum up to we merge peaks from different collision energies with m z difference at most using the m z of the highest peak and summing up intensities we discard all but the highest peaks as well as peaks with relative_intensity next we compute the fragmentation tree we assume that we can identify the correct molecular_formula from the data limiting candidate molecular formulas to those present in kegg which is used for searching molecular_structures below the best scoring fragmentation tree identified the correct molecular_formula of the compound in of the cases for the metlin massbank dataset integrating other sources of information such as ms isotope patterns b ocker et_al or retention_times would reach even better identification rates to allow for a meaningful comparison of the power of the different kernels we therefore use the best scoring fragmentation tree of the correct compound molecular_formula all fragmentation tree kernels proposed in the previous section were computed along with ppk used incomputed directly from ms_ms resulting in kernels to be evaluated molecular fingerprints were generated using openbabel o which contains four types of fingerprints http openbabel org wiki tutorial fingerprints fp fp and maccs fingerprints bits in total were generated based on the software predefined smarts patterns in our dataset more than half of the fingerprint properties have high class bias rate with a large majority of the dataset belonging to the positive class most compounds match the property or respectively the negative class most compounds do not match the property for such fingerprints the default classifier one that always predicts the majority class has high_accuracy although the model is not meaningful for our performance_comparisons we opted to only include fingerprints with class bias rate for each fingerprint property we separately trained a svm for all properties we used identical training and testing compounds five fold_cross was performed and the svm margin softness parameter c f g was tuned based on the training accuracy the present work combines the combinatorial fragmentation tree approach with machine_learning through a kernel based_approach we suggest several kernels for fragmentation_trees and show how to fuse their information through mkl the result significantly_enhances molecular_fingerprint prediction and metabolite_identification the closest analogs to our fragmentation tree kernels in literature are those defined for parse trees in natural_language our fragmentation_trees can be seen as parses of the ms_ms dp techniques similar to ours are used there for computing kernels between trees however fragmentation_trees have important differences to the trees defined between parses of natural_language and to kernels comparing molecular_structures mah e and vert differently from natural_language parses the node labels have partial order via their molecular_weights and also the edges have labels differently from kernels for molecular graphs the label spaces of both nodes and edges are vast subsets of molecular formulae the comparison with the ppk employed by the fingerid software shows that the fragmentation tree kernels are able to extract more information out of the ms_ms improvements are seen in both the prediction_accuracy and the f score comparing with fingerid ppk the uniform combination of the kernels unimkl improves the molecular_fingerprint prediction significantly in accuracy and f as witnessed by many mkl applications the unimkl algorithm is hard to beat in our result several mkl algorithms such as alignf and norm can give slightly better result than unimkl the improvements in the molecular_fingerprint prediction translate to improved metabolite_identification there are several possible routes forward with the current metabolite_identification framework first post_processing on the candidates list such as the one proposed by is necessary when searching a large compound database such as pubchem because the returned candidates hundreds to thousands may share the same fingerprints and there is no way to differ them based only on molecular fingerprints second training a separate svm for each fingerprint property is clearly an aspect that can be improved upon for example by a multi_label approach a still more tempting yet challenging direction would be to replace the two step identification by an integrated prediction approach such an approach would potentially learn to predict the fingerprint properties that are important for discriminating metabolites from each other 
