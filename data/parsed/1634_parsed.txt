estimating the number and assignment of clock models in analyses of multigene datasets motivation molecular_clock methods can be used to estimate evolutionary_rates and timescales from dna sequence_data however different genes can display different patterns of rate variation across lineages calling for the employment of multiple clock models selecting the optimal clock partitioning scheme for a multigene dataset can be computationally_demanding but clustering_methods provide a feasible alternative we investigated the performance of different clustering_methods using data from chloroplast genomes and data generated by simulation results our results show that mixture_models provide a useful alternative to traditional partitioning algorithms we found only a small number of distinct patterns of among_lineage among chloroplast genes which were consistent across taxonomic scales this suggests that the evolution of chloroplast genes has been governed by a small number of genomic pacemakers our study also demonstrates that clustering_methods provide an efficient means of identifying clock partitioning schemes for genome_scale datasets availability_and the code and data_sets used in this study are available online at https github com sebastianduchene pacemaker clustering_methods evolutionary_rates and timescales can be estimated from nucleotide_sequences using molecular_clock models which describe the pattern of rate variation among lineages the various clock models share a reliance on age calibrations but they differ in their assumptions about the number and distribution of distinct evolutionary_rates reviewed by for example the strict molecular_clock assumes a single rate across all lineages whereas uncorrelated relaxed clocks allow branches to have distinct rates that are drawn from the same distribution there are various model_selection methods for identifying the best fitting clock model for a dataset of interest e g using marginal likelihoods the choice of clock model can have substantial impacts on phylogenetic estimates particularly those of evolutionary_rates and timescales rates of molecular_evolution often vary among lineages but this pattern of variation can differ across sites and across genes therefore when complex sequence_data are being analyzed the use of multiple clock models might provide a better fit e g higher marginal likelihood than a single clock model for example separate clock models might be applied to different genes or codon positions in analyses of multigene datasets there are usually many possible partitioning schemes identifying the best fitting schemes involves two components determining the optimal_number and assigning the genes to these clusters in bayesian analyses this can be done using bayes_factors to compare different clock partitioning schemes however such an approach is impractical when there are many candidate schemes as is often the case for multigene or genome_scale datasets because the statistical fit of every possible scheme would need to be assessed clustering_methods provide a computationally_feasible means of identifying appropriate clock partitioning schemes by grouping subsets of the data according to their pattern of among_lineage similar approaches are available for selecting partitioning schemes for substitution models the software clockstar which was designed to identify the best fitting clock partitioning scheme for multigene datasets employs a k medoids clustering_algorithm known as partitioning around medoids however other clustering_methods such as k means and gaussian mixture modeling have not been tested in the context of clock model_selection one advantage of gaussian_mixture is that they can represent the shapes of clusters flexibly by using covariance_matrices for example they can use a diagonal covariance_matrix to identify clusters with ellipsoidal shapes such that they might have higher accuracy than k medoids here we test the performance of three different clustering_methods for identifying the clusters of patterns of among_lineage in multigene datasets variational inference gaussian_mixture vbgmm dirichlet_process gaussian_mixture dpgmm and partitioning around medoids pam we evaluate these three methods using simulated_data and apply them to chloroplast genome_sequences from angiosperms we find that the optimal_number for these datasets range from one to three our results also reveal that mixture_models such as vbgmm and dpgmm tend to detect a larger number of clusters than methods based on partitioning such as pam mixture_models also appear to be more robust than pam in that they can detect the correct number of clusters in a broader range of simulation conditions in our analyses of five chloroplast datasets the vbgmm with a spherical covariance_matrix had higher fit than the other mixture_models using this method the optimal_number ranged from one to three across the five datasets supplementary the pam algorithm inferred one cluster for poaceae rosids and eudicots and two clusters for asteraceae and angiosperms although the number of clusters inferred by all of the methods was similar vbgmm with a spherical covariance_matrix tended to infer the largest number of clusters the exception was the angiosperm dataset for which vbgmm with a spherical covariance_matrix only identified one cluster whereas the other methods identified two clusters importantly for all datasets there were at least some discrepancies in the number of clusters inferred by the methods the pam algorithm inferred the smallest_number of clusters for almost all of the datasets our analyses of data simulated under mixture_models showed that the algorithms with mixture_models correctly_identified the model used to generate the data and the number of clusters for a majority of the simulations in all cases the vbgmm with a spherical covariance_matrix presented the highest statistical fit for all simulations for the chloroplast data from angiosperms poaceae and eudicots the estimated value of k matched the true value in all simulation replicates for rosids the correct value of k was recovered for of the simulated_datasets the mixture_model fitted to the asteraceae dataset performed the most poorly in this case the correct value of k was recovered for only of the simulated_datasets the fact that the frequency of the optimal k is overall high for the mixture_model also indicates that it is stable yielding similar estimates for data simulated under the same conditions for the simulations based on mixture_models the pam algorithm performed more poorly it only recovered the true value of k for the simulations using the model fitted to the angiosperms for the other simulations it tended to estimate a larger number of clusters from five in the simulations using the model fitted to poaceae to eight for the simulations under the model fitted to the rosids the stability of this algorithm was also much lower than that of the mixture_models for most datasets for example for the asteraceae data the most frequent value of k was present in of the simulated_datasets with many different values of k being inferred for the remaining simulated_datasets this probably occurred because this dataset contains a small number of points such that there is greater variation among simulation replicates the simulations using the model fitted to the angiosperm data had more stable results with a frequency of for k in our analyses of data simulated under conditions consistent with the assumptions of the pam algorithm we found that both mixture_models and pam recovered the correct number of clusters with a frequency of as with the data simulated using mixture_models the vgbmm with a spherical covariance_matrix had the highest statistical fit among the mixture_models collectively ourdatasets were analyzed with the variational inference gaussian_mixture vbgmm dirichlet_process gaussian_mixture dpgmm and partitioning around medoids pam the bayesian_information bic was used to compare the fit of the mixture_models to each dataset with the best fitting model shown in bold illustration of cluster assignment using the model with highest statistical fit for genes shared between the five chloroplast datasets the rows correspond to the five datasets and each column represents a gene colours indicate the cluster assignments of the genes in each dataset analyses of simulated_data show that mixture_models and the pam algorithm perform well when the model used to generate the data matches that used to infer the number of clusters however mixture_models performed well even when the data were simulated using a scenario based on pam such that they provide more robust estimates we investigated the performance of three different clustering_methods for grouping genes according to their pattern among_lineage we have found that the vbgmm with a spherical covariance_matrix provides the best fit among the mixture_models to a range of chloroplast datasets and our simulation_study confirms the stability of this method the pam algorithm failed to recover the simulation conditions under vbgmm in most cases probably because the shape of the clusters is difficult to capture using this method in contrast vbgmm frequently estimated the correct number of clusters irrespective of the simulation method this differs from the results of previous_studies of clustering_methods for branch length patterns which found that the pam algorithm appeared to perform well however we reanalyzed a mammalian_genome dataset from our previous study and found a similar number of clusters supplementary_material the most stable mixture_model dpgmm supported seven clusters compared with using pam in the original study this suggests that in empirical_studies it is important to compare the inferences from different clustering_algorithms in this study for example the estimated numbers of clusters for the empirical data are very similar among clustering_algorithms we find that mixture_models provide a powerful alternative that can flexibly accommodate different cluster shapes the results from these models also appear more stable under different simulation conditions at least for the datasets analyzed here another advantage of these methods is that their parametric nature offers a simple framework for conducting simulations which should be done routinely to assess the robustness of the results importantly the shape of the clusters and choice of covariance_structure do not necessarily have biological_implications rather they provide a convenient mathematical description of the cluster shapes the clusters identified in our analyses represent groups of genes that have similar patterns of among_lineage all of the clustering_algorithms suggest that the evolution of chloroplast genomes in angiosperms and nuclear genomes in mammals has been governed by a small number of pacemakers each of which leads to a distinct_pattern of rate variation among lineages this is consistent_with from prokaryotes drosophila and yeast furthermore comparing the gene_clusters across our five angiosperm datasets reveals that there is some consistency in pacemakers across different taxonomic scales however additional work will be needed to understand the biological bases of these pacemakers identifying genes with similar patterns of among_lineage has important_applications in phylogenetic_analyses notably in molecular_dating studies estimates of divergence times have been shown to be more accurate if a separate relaxed clock model is assigned to each cluster of genes our results indicate that multigene datasets might only exhibit a small number of distinct patterns of rate variation among lineages this has notable implications for analyses of genome_scale datasets for which only a small number of relaxed_clock might be sufficient to capture the key components of evolutionary_rate variation to this end clustering_methods provide a feasible and reliable alternative to more computationally_demanding approaches to selecting clock partitioning schemes for molecular_dating analyses in particular mixture_models might have better performance than the k medoids and k means algorithms for genomic_data because they can model clusters of different shapes increasing the adoption of these methods will help to improve estimates of evolutionary_rates and timescales from genome_scale datasets results are based on analyses of simulations under the model fitted to each of the five chloroplast datasets in all cases the most frequently chosen mixture_model was the vgbmm with a spherical covariance_matrix frequency of k mixture is the most frequent k for analyses of the data simulated using mixture_models k pam is the most frequent k for the analyses using the pam algorithm with its corresponding frequency 
