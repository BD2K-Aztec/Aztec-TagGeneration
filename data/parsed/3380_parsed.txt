sequence_analysis optitype precision hla_typing from next_generation the human_leukocyte hla gene_cluster plays_a in adaptive_immunity and is thus relevant in many bio medical_applications while next_generation data are often available for a patient deducing the hla genotype is difficult because of substantial sequence_similarity within the cluster and exceptionally_high variability of the loci established approaches therefore rely on specific hla enrichment and sequencing_techniques coming at an additional_cost and extra turnaround time result we present optitype a novel hla genotyping algorithm based on integer_linear capable of producing accurate_predictions from ngs_data not specifically enriched for the hla cluster we also present a comprehensive benchmark_dataset consisting of rna exome and whole_genome sequencing_data optitype significantly_outperformed previously_published in silico approaches with an overall accuracy of enabling its use in a broad range of applications the human_leukocyte hla cluster located on chromosome is one of the most polymorphic regions of the human_genome and encodes for several genes involved in functions of the immune system including hla classes i and ii both hla classes comprise three major loci hla i a b c hla ii dp dq dr which are co dominantly expressed hla i ii molecules present intracellular and extracellular peptides respectively and interact with other immune_cells to induce an adaptive_immune thus hla i ii molecules play_an in many medical areas such as vaccinology regenerative and transplantation medicine and autoimmune_diseases over different hla i and hla ii alleles are known to date imgt hla release july in addition to this vast allelic_variation hla_alleles display a high degree of sequence_similarity even across different loci which drastically increases the complexity of uniquely identifying a genotype using short_read sequencing_techniques established hla_typing approaches make use of labor_intensive and time consuming probing techniques such as sequence specific oligonucleotide_probe hybridization pcr_amplification with sequence_specific or serotyping techniques which often lead to ambiguous genotyping_results hla_typing can be done with different degrees of resolution with two digit and four digit types distinguishing hla allele families and distinct hla protein_sequences respectively demonstrated the use of targeted next_generation ngs for hla_typing to overcome the problems mentioned above several new protocols have recently been established based on ngs_technologies these methods are still accompanied by labor_intensive preparations and remain time consuming more recently published an automated protocol based on gs junior sequencing allowing a high_resolution typing with a turnaround time of days to reduce time and cost expense even further in silico approaches have been developed in erlich et_al published an approach based on posterior_probability of allele pairs and integrated it into a gs flx titanium sequencing pipeline common to the above approaches is the dedicated generation of ngs_data for the sole purpose of hla_typing routine sequencing of patient exomes or whole genomes has been established in many larger clinical_centers and it should be possible to determine the hla_type from these data through purely computational means using existing data can save both money and time however because of the high variability of the hla loci the typical read_mapping and variant_calling based analysis of ngs_data is not suitable to determine the hla genotype proposed an algorithm hlaminer based on allele specific scoring for whole_genome exome and to whom correspondence should be addressed y the authors wish it to be known that in their opinion the first three authors should be regarded_as the author published_by this is an open_access the terms of the creative_commons http creativecommons org_licenses which permits non commercial re use distribution and reproduction in any medium provided the original_work for commercial re use please_contact permissions_oup com transcriptome_sequencing to solve this problem it assembles reads de_novo and aligns the resulting contigs against an hla reference_database a score for each hla allele is then calculated based on properties of the aligned contigs and the highest scoring alleles for each locus are selected in boegel et_al suggested a greedy_algorithm seq hla based on read_count maximization for rna_seq after read_mapping in an initial round the algorithm determines the allele with the highest number of mapped_reads for each locus individually after discarding the selected alleles and already assigned reads second alleles are selected accordingly athlates published by uses an hla reference_database to filter for relevant reads which are used for contig construction the reference hla sequences are decomposed into exons and the best mapping contig for each exon is determined for one hla locus at a time each allele is scored based on its overall hamming_distance to all aligned exons a candidate allele list is generated by applying different filtering criteria using this candidate list the most probable hla allele pairs per locus are determined based on the minimal hamming_distance to the variable positions of each exon one of the most recent_approaches published by kim et_al uses a tree based top_down greedy_algorithm hlaforest to predict the hla genotypes based on rna_seq the algorithm generates an hla alignment tree for each read based on the mapping results against an hla reference_database whose leaf nodes indicate four digit alleles and inner nodes represent allele families to which the read could be mapped then alignment probabilities and node weights are distributed in the trees based on the sum of weights of all trees the highest scoring allele family is selected after reweighting the nodes based on the selected allele family the four digit hla allele is selected similarly a different approach byapplies various filtering criteria and optimizes coverage depth and base coverage the first filter criterion enforces certain sequence_coverage of exons and of the hla_alleles as these exons are the most polymorphic regions that also encode for the binding core of the hla molecule additionally reads are filtered based on mismatches and alignment orientation of the paired_reads subsequently alleles are sorted and filtered based on their coverage depth and sequence_coverage of their alignment finally allele pairs are selected such that coverage depth and sequence_coverage are optimized yet these methods do not yield sufficiently accurate_predictions especially in terms of clinical usability boegel et_al s approach is capable of only two digit genotyping kim et_al and warren et_al could achieve only correctly_predicted four digit hla genotypes on rna_seq and for shortread rna_seq and whole_genome wgs_data the accuracy was even lower major et_al could accomplish an accuracy of on exome_sequencing samples that fulfilled all their filtering criteria but out of the samples they have considered only could be fully typed a possible cause for low typing accuracy in the aforementioned approaches might be the independent consideration of each locus sequence_homology between loci can lead to ambiguous read_alignments where reads map to alleles of multiple_loci equally well another reason for suboptimal with its closest neighbor with respect to sequence_similarity from among the complete allele sequences the procedure therefore attempts to reconstruct partial allele sequences based on their closest phylogenetic relatives with known intron sequences using the fact that intronic variability in hla is characterized by highly systematic mutations reflecting the ancestral lineage of the alleles sequence_similarity values were obtained from full distance_matrices computed with clustal omega partial alleles were partitioned into sets according to their exons with known sequences to ensure sequence_similarity calculation using maximal sequence_information available all complete alleles were added to every set followed by computing distance_matrices between set members concatenated exon sequences partial alleles have shown to have ae nearest_neighbors with unique intron sequences on average sequences of partial alleles with multiple nearest_neighbors were reconstructed with each of the nearest_neighbors resulting in reconstructed sequences for partial alleles the quality of sequence reconstruction was validated in a leave oneout fashion introns and for each of the fully_sequenced alleles were discarded and reconstructed using the remaining alleles considering only exon and sequences for nearest_neighbor identification the reconstructed intron sequences were compared with their original counterparts and showed a sequence_similarity of ae corresponding to an average edit_distance error on the three introns combined for comparison sequence_similarity between introns of the same loci was found to be ae corresponding to nt differences on average the used reference_sequences can be found in the supplementary_material s hla_typing with four digit level accuracy is essential for clinical_applications like the development of individualized patientspecific vaccines and transplantation therefore optitype has been optimized to yield correct hla typing_results on four digit resolution i e on the protein_coding level for distinct read_lengths and different types of sequencing_technologies performance of optitype has been evaluated on exome_sequencing wgs and rna_seq 
