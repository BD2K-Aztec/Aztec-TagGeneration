genetics_and viquas an improved reconstruction pipeline for viral_quasispecies spectra generated by next_generation motivation the combined effect of a high replication rate and the low fidelity of the viral polymer ase in most rna_viruses and some dna_viruses results in the formation of a viral_quasispecies uncovering information about quasispecies populations significantly benefits the study of disease_progression antiviral drug_design vaccine_design and viral pathogenesis we present a new analysis_pipeline called viquas for viral_quasispecies spectrum reconstruction using short next_generation reads viquas is based on a novel reference assisted de_novo algorithm for constructing local haplotypes a significantly extended version of an existing global strain reconstruction algorithm is also used results benchmarking results showed that viquas outperformed three other previously_published named shorah qure and predicthaplo with improvements of at least in recall in precision and in f score in terms of strain sequence_assembly and improvements of at least in kl divergence and in root_mean in terms of strain frequency_estimation over the next best algorithm under various simulation_settings we also applied viquas on a real read set derived from an in vitro human_immunodeficiency hiv population two independent datasets of foot_and derived from the same biological_sample and a real hiv dataset and demonstrated better results than other methods available availability_and http sourceforge net_projects viquas inside an infected_host most rna_viruses such as human_immunodeficiency hiv hepatitis c foot_and fmdv and some dna_viruses like hepatitis_b exhibit very high replication rates the low fidelity of the proof reading function of the viral_polymerase coupled with this high replication rate results in the formation of a viralquasispecies population more specifically a quasispecies is a set of genetically_related but non identical viral mutant types which can also be referred to as strains that are able to co exist within the host as anti_viral vaccines and drugs make use of the knowledge on various stages of the host viral interaction process and viral_replication process the presence of different viral_strains in the population affects the natural_host immune_response as well as the antiviral drug_therapy therefore information about these strains or quasispecies spectra is of critical importance to antiviral drug_design and vaccine_design in particular such information would enhance research into viral evolution disease_progression and provide insights into the biology and pathogenesis of viruses during the analysis of quasispecies identifying the co occurrence of nucleotide level mutations is as important as identifying individual mutations as such there are two main challenges in this analysis assembling nucleotide_sequences of each individual strain to identify co occurring mutations and to estimate the relative frequency of each strain within the quasispecies collectively these two challenges constitute quasispecies spectrum reconstruction qsr the most similar problem to qsr is the metagenomic binning problem as applied to bacterial metagenomes butemphasizes the inability of binning methods based on sequence_similarity and sequence_composition to discriminate between strains of the same species due to high nucleotide compositional similarity single_genome de_novo is another similar problem to qsr these algorithms are optimized to overcome technical sequence errors assuming the existence of a single species in the sequenced sample hence given a metagenomic_dataset as input most assemblers work towards generating a single assembly of reads misinterpreting genetic_variability as potential technical sequencing_errors one of the earliest methods for viral_population estimation using next_generation ngs was proposed in it uses a multiple read_alignment and clustering strategy for read_error a combinatorial algorithm for strain reconstruction and a statistical_model based expectation_maximization strategy for strain frequency_estimation the method formulated in named shorah extends the method ofand uses a bayesian_inference algorithm for read_error and a probabilistic clustering_algorithm for strain reconstruction three other interesting approaches to solve the qsr problem are the combinatorial method proposed in which was later published as a software named qure the method proposed innamed vispa and the method proposed in named predicthaplo current methods that address the qsr problem rely on the fact that the ngs_reads of a quasispecies sample can be assigned with a unique alignment position to a known reference_genome or a consensus_sequence this has become possible due to the rarity of repeats in viral_genomes following read_alignment a typical quasispecies analysis_pipeline consists of three major_steps i first the genetic_diversity is determined on either overlapping or non overlapping local windows of the reference_genome by clustering reads within each window together with strategies to eliminate or correct technical sequencing_errors this is also referred to as constructing local haplotypes ii second the global diversity is inferred by connecting the local haplotypes to form the nucleotide_sequences spanning the entire genomic_region of interest i e strain reconstruction iii third is the step of estimating the relative_frequencies of the reconstructed strains comprehensive reviews on different techniques used within these main steps of an analysis_pipeline are found inand beerenwinkel and zagordi the most critical component within this pipeline is global diversity estimation where previous_studies have relied on one of two key_concepts the most popular strategy of inferring global diversity is based on graph based_methods as has been implemented in alternatively the problem has also been approached using probabilistic clustering_methods less common but a very useful third approach for quasispecies identification based on de_novo has been published in even thoughdoes not address the qsr problem from strain assembly to frequency_estimation it provides an interesting initiation point for the total strain assembly problem using short ngs_reads we have further developed the idea of using a de_novo algorithms for quasispecies assembly in this work an analysis of the effects of average read_length depth of coverage and technical sequencing_errors on total strain reconstruction is presented in and it highlights the fact that inferring quasispecies population_diversity of larger genomic_regions using short ngs_reads remains_a in this article we present a new analysis_pipeline named viquas for viral qsr using short ngs_reads our main focus is on inferring quasispecies spectrum within a certain genomic_region of a viral sample using sequence_reads that are several folds shorter in length compared with the region in the presence of a moderate level of technical sequencing_errors the novelty of our method is fold i we propose a novel reference assisted de_novo algorithm for defining local haplotypes ii we propose a significant extension to the global reconstruction algorithm presented in based on relative coverage depths and overlap agreement of local haplotypes moreover we present the first benchmark study of viquas and three other existing_methods named shorah qure and predicthaplo on a broad_spectrum of simulated_data allowing for a thorough comparison of performance between the four methods the correctness of the nucleotide_sequences reconstructed is primarily evaluated based on the measures recall and precision under different simulation conditions the four methods used in the benchmark study outperformed each other in recall and precision without a particular pattern hence the geometric mean of recall and precision termed as f score is used to measure the performance using a single measure on the other hand the accuracy of the estimated relative frequency distribution of the reconstructed strains is measured using kl divergence and root_mean viquas outperformed shorah qure and predicthaplo demonstrating improvements of at least in recall in precision and in f score in terms of strain sequence_assembly and improvements of at least in kl divergence and in root viquasmean squared error over the next best algorithm under various simulation_settings performance evaluation of qsr is fold the performance in terms of total strain reconstruction is evaluated based on the metrics recall precision and f score as defined below the performance in terms of frequency_estimation is evaluated based on kl divergence and root_mean between the input and output relative frequency distributions we compared viquas with three other previously_published software named shorah qure and predicthaplo based on entirely simulated psudo real and real_data a noteworthy factor in performance comparison is the distinction between the objectives of the global spectrum reconstruction algorithms used by these three methods shorah aims to output the most parsimonious set of strains that is consistent with a given set of reads which in general produces a larger number of strains than the actual number of strains present in the population this leads to a better chance of producing true strains while also producing many false in silico recombinants in contrast qure predicthaplo and viquas aim to output a selective set of strains that is likely to be totally covered by the given set of reads minimizing the production of false in silico recombinants our choice to consider only the number of theoretically reconstructible strains n p as the expected number of strains in calculating recall eq and to disregard the number of reconstructed strains having a relative frequency less than f min in calculating precision eq provide_practical and fair grounds to compare the performance in terms of the metrics recall precision and f score also in calculating kldivergence and root_mean we only considered the input and output strains with relative frequency values greater than f min in sections we validate viquas and benchmark it against shorah qure and predicthaplo using the simulated_datasets ss ss using the metrics recall precision f score kldivergence and root_mean in section we validate and benchmark the methods using average pair_wise alignment cost between the known and reconstructed haplotypes finally in sections and we compare the results of the four methods on real_datasets as a result of the fact that the exact nucleotide content of the strains and their relative_frequencies are unknown in these real_datasets we have used other criteria as described under the respective subsections to evaluate the results we present in this article a novel method for qsr named viquas the main novelty is the proposed reference assisted de_novo algorithm constituted by the three consecutive steps de_novo mutation calling and chimeric error_correction the greedy graph_based de_novo algorithm and the subsequent mutation loci guided chimeric error_correction algorithm provide viquas with a significant_advantage over shorah qure and predicthaplo when it is used to analyse short ngs_reads our method clearly outperformed shorah qure and predicthaplo on the simulated_datasets used in the benchmark study demonstrating the capability of reconstructing quasispecies spectra using short ngs read samples bp bp and bp with comparatively less susceptibility to the presence of sequencing_errors and indels given a viral genomic_region of interest the average read_length of the ngs read sample and the diversity of the quasispecies population were identified as the two most critical factors_affecting the performance of viquas provided that the technical sequencing_error is kept at a minimum_level it is evident that strain sequence_assembly gets easier when the diversity of a quasispecies population becomes higher provided that read data are available covering the whole genomic_region of lr bp e both snps and indels are present in strains t p i d n total and f min l r is the mean read_length read_length n lr e is the substitutional error probability of the reads n total is the total number of reads and f min is the theoretically reconstructible minimum relative frequency each point indicates mean value of the measureinterest this pattern of performance was common to all four methods considered in our study under all eight different simulation conditions viquas gave the highest_average recall values demonstrating the best total strain reconstruction capability viquas and shorah performed at comparable levels in terms of strain frequency_estimation while clearly outperforming qure and predicthaplo due to the unavailability of real_datasets with known quasispecies populations the best alternative for validating these methods under_real was to use simulated_datasets such as ss ss that can be assumed to resemble such conditions agreement between the performance patterns of entirely simulated_data ss ss and data resembling real conditions ss ss further confirmed the enhanced_performance of viquas over shorah qure and predicthaplo even though the correctness of the reconstructed strains cannot be evaluated due to the unavailability of exact nucleotide content of the strains in the real fmdv samples err and err and real hiv dataset v the consistency of results produced by viquas on real fmdv samples and the higher degree of biological validity of the strains reconstructed from real hiv data by viquas indicate the applicability of viquas on real sequence_data and better performance over shorah qure and predicthaplo in addition simulated samples with illumina_sequencing parameters further confirmed the superior_performance of viquas in this study we performed a comprehensive comparison of performance between viquas shorah qure and predicthaplo in a broad range of diversity and n s values because of the requirement of vispa to have the diversity of a sample as an input parameter which is impractical for real_data and its poor_performance under read_lengths in the range of bp and bp we did not use it in this study another method found in literature named quasirecomb was also omitted from further analysis due to its poor_performance even on ss on which the other three method used in the analysis showed their best performance two of the most significant observations of the comparison study are the drastic drop of performance of shorah and predicthaplo under the presence of indels refer e and h and of qure under a shorter bp read_length on the contrary viquas was much less susceptible against both indels and reduced read_lengths all four methods handled the sequencing_error of without a significant drop of performance in particular we observed a better performance of shorah and predicthaplo on ss in the presence of indels compared with their poor_performance on ss this observation is due to the fact that some strains in ss do not have insertions but snps and deletions which are correctly reconstructed while every strain in ss has both insertions_and it was not evident that shorah and predicthaplo eliminates all insertion considering them as technical sequencing_errors because some reconstructed strains in ss contain a few but not all correct insertions this also explains the improved_performance of shorah on ss and ss compared with qure supplementary as the real hiv_strains used in ss and ss does not have any mutations in the form of insertions on the other hand qure performed better than shorah and predicthaplo on ss supplementary where some of the simulated hbv strains contain insertions the second significant factor is that shorah qure and predicthaplo define local analysis windows a priori these window boundaries restrict the growth of the read clusters along the nucleotide space of the region of interest in contrast viquas allows the contigs to extend as far as the reads provide information supporting the co occurrence of mutations this unrestricted growth of contigs becomes advantageous in the total strain reconstruction stage in shorah each of the paths in the cover of the read graph contains a number of nodes equal to the number of windows in qure the complexity of the global reconstruction algorithm is proportional to the number of windows the window length is typically set equal to the average read_length in both shorah and qure hence the algorithmic complexity of the global reconstruction methods of both shorah and qure increases in proportionate to the ratio between the genomic_region of interest and the read_length these factors significantly affect the performance of the respective methods as been discussed in takes_advantage of the unrestricted de_novo algorithm and dynamically defines the local haplotype boundaries for each strain at which the decisions for connecting local haplotypes are made this dynamic definition of local haplotype boundaries significantly_reduces the number of heuristic decisions to be made when connecting local haplotypes providing a clear advantage over qure this advantage becomes prominent especially under shorter read_lengths the third source of performance enhancement in viquas is the improvement of estimated strain frequency values demonstrated in terms of kl divergence and root_mean resulted from the second and third major extensions to the algorithm indescribed under the subsection limitations of viquas include the requirement of higher computational_resources when analysing longer read_lengths owing to the use of smithwaterman_algorithm in the pipeline however this computational_complexity does not degrade the performance of the pipeline a shorter read_length compared with the genomic_region of interest reduced coverage depth of the sequences and a higher rate of technical sequencing_errors were identified as the factors_influencing negatively on the performance of viquas in fact these factors were common to all four methods in our study and viquas was observed to be the least susceptible to them also all four methods failed to reconstruct strains with a relative frequency less than f min and the correctly reconstructible minimum relative frequency increased with the presence of technical sequencing_errors we notice that the performance of the methods analyzed vary with different population characteristics and sequencing parameters therefore it is a difficult_task to define parameters within which a certain method performs at an acceptable level in fact the acceptable level of performance varies according to the needs of the individual user hence the decision on choosing the best method of analysis and the appropriate sequencing parameters is left to the end_user furthermore the longest region that can be successfully reconstructed depends on both the read_length and diversity for instance when the region of interest and the diversity are given we observe that the performance increases with increasing read_length this does not imply that we can expect the same levels of performance with the same diversity and read_length over a larger genomic_region a thorough analysis of this fact is presented in we anticipate the use of viquas to extend beyond quasispecies spectra profiling with applications in other omics fields including viquascancer genomics metagenomics and immunogenomics for instance applications such as estimating genetic_diversity of tumour_cells and understanding gene heterogeneity and diversity of microbiomes in various environments such as human_gut or waste treatment plants may benefit from the underlying methodology 
