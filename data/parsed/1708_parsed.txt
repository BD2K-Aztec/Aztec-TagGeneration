genome_analysis exploring variation aware contig graphs for comparative_metagenomics using marygold motivation although many tools are available to study variation and its impact in single genomes there is a lack of algorithms for finding such variation in metagenomes this hampers the interpretation of metagenomics sequencing_datasets which are increasingly acquired in research on the human_microbiome in environmental studies and in the study of processes in the production of foods and beverages existing algorithms often depend on the use of reference_genomes which pose a problem when a metagenome of a priori unknown strain composition is studied in this article we develop a method to perform reference free detection and visual_exploration of genomic_variation both within a single metagenome and between metagenomes results we present the marygold algorithm and its implementation which efficiently detects bubble structures in contig graphs using graph decomposition these bubbles represent variable genomic_regions in closely_related strains in metagenomic_samples the variation found is presented in a condensed circos based visualization which allows for easy exploration and interpretation of the found variation we validated the algorithm on two simulated_datasets containing three respectively seven escherichia_coli genomes and showed that finding allelic_variation in these genomes improves assemblies additionally we applied marygold to publicly_available real metagenomic_datasets enabling us to find within sample genomic_variation in the metagen omes of a kimchi fermentation_process the microbiome of a premature_infant and in microbial_communities living on acid_mine moreover we used marygold for between sample variation detection and exploration by comparing sequencing_data sampled at different time points for both of these datasets availability marygold has been written in c and python and can be downloaded from http bioinformatics tudelft nl software contact d deridder tudelft nlrecently large_scale microbiome analyses such as metahit and the national_institutes human_microbiome have demonstrated the importance and the richness of our second genome the microbes inhabiting many different sites of our bodies to get the complete picture of all dna present its biological_functions and the genetic_variation increasingly whole metagenome sequencing is performed large_scale analysis of variation within and between the resulting metagenomessingle nucleotide variants short insertions_and indels and structural variatonis essential to fully understand their genetic_makeup however relatively few studies have thus far ventured into such analyses combined data obtained from stool_samples in the metahit and hmp projects and a study comparing leanness and obesity taking a read mapping_approach to detect millions of single_nucleotide and other genetic_variation in bacterial metagenomes studied the metagenome of stool_samples of a premature_infant using an assembly approach manual_analysis of the assembly output resulted in a genetic_variation found in citrobacter strains a major reason for this lack of metagenomic variation analysis is a shortage of available tools variation detectors have mainly been developed for the isolated genomes of single individuals and can be roughly divided in two categories reference based and reference free several reference based_methods that map reads to a preconstructed reference_genome are available to detect single_nucleotide and structural_variants as reviewed in respectively however in metagenomics reference_genomes are usually not available for all species moreover many bacterial_species are not cultivable in the laboratory complicating construction of reference_genomes reference free methods in contrast detect variation between sequencing samples directly without resorting to reference_genomes showed that genomic_regions with polymorphisms give rise to bubbles in the fragment assembly_graph and presented an algorithm to find and smooth the bubbles which was implemented in the celera_assembler the cortex assembler was designed to coassemble multiple_genomes and search for such bubbles in the de_bruijn that represent variation between the assembled_genomes decomposition of a de_bruijn into biconnected components followed by bubble detection has been shown to be useful in detecting splicing variants in rna sequencing_data to whom correspondence should be addressed similar to co assembly of individual_genomes metagenome_assembly involves simultaneous assembly of multiple_genomes the presence of two closely_related genomes in a sample leads to similar bubbles the metagenome scaffolder bambus was designed to detect these bubbles and collapse them thereby elongating scaffolds while preserving divergence in the data bambus finds bubbles by looking for subgraphs where multiple paths begin at a source node and collapse to one sink node to keep computation tractable the number of hops considered is limited to two meta idba similarly searches bubbles in a de_bruijn but the search is limited to a maximum of bp here we set out to detect complex bubbles such as presented in i e longer than can currently be detected by bambus and cortex typically found when homologous_sequences closely_related genomes are present in a sample we overcome the computational limitations in the aforementioned methods by developing an efficient way to find genome_variation in assembly graphs by introducing a graph decomposition into bi and triconnected components that allows us to select a subset of the nodes as source nodes for bubble finding identifying bubbles representing multi alleles has three applications first it can be used to detect sequence_variation i e multiple alleles between strains within a single sample metagenome second co assembling multiple metagenomes allows the detection of variation between samples this latter application is particularly novel and is set to become more prominent as more metagenomics datasets will become available over the coming_years third although not the main focus in this article it allows to simplify assemblies generating longer scaffolds and contigs by collapsing bubbles into a single linear sequence instead of breaking into multiple contigs co assembly has previously been used byto calculate global distances between metagenomes but here we aim to find sequence level differences we demonstrate marygold our algorithm to find bubbles and compare them across samples using co assembly by comparing metagenome samples obtained using technology of different time points obtained from the stool sample of a premature_infant and a fermentation_process of the traditional korean food kimchi we also apply the algorithm on sequencing_data of microbial_populations found on acid_mine obtained using both and illumina technologies and compare marygold with bambus marygold exports the variation detected in a format that can be visualized by circos allowing for a rich visual_exploration and interpretation of the genomic_variation in metagenomes we presented marygold a tool to detect and explore genomic_variation within and between metagenomic_sequencing samples not reliant on reference_genomes marygold finds multi allelic regions that reflect sequence_variation and improves the contiguity of assemblies by collapsing these as input it expects a contig graph which makes it generic and applicable to any type of sequencing_data we demonstrated the algorithm both on and illumina data here we generated contig graphs using links from fragment assembly string graphs but the graphs can be extended using edges derived from other sources such as paired_end sequencing_data de_bruijn or even reference_genomes multi allelic regions are efficiently detected by searching for bubble structures in the contig graph enabled by its decomposition into bi and triconnected components although marygold can detect local sequence_variation i e multiple alleles of a genomic locus it ignores variation that not does not result in a detectable bubble such as duplications and translocations i e due to horizontal_gene sequence_variation in metagenomes and in particular between metagenomes i e comparative_metagenomics is still a largely_unexplored field our algorithm not only finds sequence_variation within a single metagenomic sample but also between samples and it allows for convenient visualization and interpretation of variation of even multiple metagenomic_sequencing samples the importance of sequence_variation detection in metagenomes was demonstrated by finding variability in abc_transporters that are involved in resistance to multiple drugs in the kimchi sample and variability in bacterial cell_surface proteins that bind to human ig in the infants microbiome comparing data sampled at different time points in the infants microbiome showed varying relative_abundance during the early colonization of its gut suggesting competition between closely_related strains until a stable composition is reached as sequencing gets cheaper more assembly grade metagenomics sequencing_datasets become available it will soon be possible to compare cohorts of samples and detect sequencelevel difference in microbiomes or other environmental_samples explaining specific phenotypes and link the meta genotypes to disease the development of tools such as marygold that find this sequence_variation and allow further analysis and interpretation is essential for effectively mining the metagenomics sequencing_data note the number of bambus and marygold calls is the number of bubbles that mapped to the k genome 
