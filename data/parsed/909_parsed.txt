data_and cell_population identification using fluorescence minus one controls with a one class classifying algorithm motivation the tried and true approach of flow_cytometry data analysis is to manually gate on each biomarker separately which is feasible for a small number of biomarkers e g less than five however this rapidly becomes confusing as the number of biomarker increases furthermore multivariate structure is not taken into account recently automated gating algorithms have been implemented all of which rely on unsupervised_learning methodology however all unsupervised_learning outputs suffer the same difficulties in validation in the absence of external knowledge regardless of application domain results we present a new semi_automated algorithm for population discovery that is based on comparison to fluorescence minus one controls thus transferring the problem into that of one class classification as opposed to being an unsupervised learning_problem the novel one class classification algorithm is based on common principal_components and can accommodate complex_mixtures of multivariate densities computational time is short and the simple nature of the calculations means the algorithm can easily be adapted to process large_numbers of cells furthermore we are able to find rare cell_populations as well as populations with low biomarker concentration both of which are inherently hard to do in an unsupervised_learning context without prior_knowledge of the samples composition availability_and r scripts are available viathe mainstream method of flow_cytometry data analysis is to manual hierarchical gate in other words given n observations cells of a p dimensional random vector where each i f pg represents a biomarker coupled to a fluorescent marker and f i is the marginal density of each biomarker the cells are sequentially split into groups corresponding to presence absence and possibly discretized biomarker concentration levels following visual_inspection of each f i biomarkers are most typically antibodies however they can also be fluorescent_proteins among others gating order is based on prior_biological e g only a particular cell_type can be positive for certain biomarkers and not others therefore the general_strategy is to gate on highly_specific biomarkers early to separate broad categories of cells following this separate gating strategies may be applied to find the nuances within the broad categories this has been a successful approach over the past three decades where it has typically been applied to experiments comprising less than five biomarkers with increasing numbers of biomarkers and or novel biomarkers manual gating becomes difficult as well as neglecting the multivariate structure compounding these difficulties is the impact of data pre_processing on gating namely compensation each biomarker is coupled to a fluorescent marker that is excited by the appropriate laser and in turn it emits light over a typical range of nm each biomarker is measured with an optical bandpass filter bp tuned to its peak e g the intensity of light between and nm is measured however the spectra of different fluorescent markers overlap thus measurement of total light captured in a bp has contributions from up to p dyes this is known as spectral mixing and its theoretical form is simply a linear transform from biomarker space to spectral space compensation is simply the reverse linear transformation back to the biomarker space where the features have a direct biological meaning as they correspond directly to the biomarkers however compensation is based on the assumption of gaussian distributed error and thus distorts the data owing to the underlying poisson_distribution of the emitted photons additionally it cannot account for autofluorescence af which occurs when a cell falsely appears to have a biomarker concentration above background which is simply because of the cells properties prior_knowledge is required to account for af and if not accounted for can lead to false conclusions in manual gating additionally in the case of antibodies the measurement can be confounded by unspecific binding ub for which there is no correction in fact these are such pervasive problems that a specific type of biological_control has been designed for their detection the fluorescence minus one fmo control for each biomarker i f pg a new sample is measured with all biomarkers minus the i th biomarker the cells that are positive for the i th biomarker shift with magnitude proportional to the original biomarker concentration and no shift occurs to whom correspondence should be addressed when the cells are negative the effects of af and ub are minimized as they should be unchanged between the fully stained sample full staining and the fmo superposing the full staining with each fmo is the multivariate spectral analogue of univariate gating on the biomarker marginal densities while simultaneously taking af and ub into account the use of fmos is the gold_standard in experimental_design however their use has been restricted to visual_inspection thus far to confirm that the results of manual hierarchical gating is unlikely to contain artifacts here we use fmos as training_sets in a one class classifier to systematically identify cell_populations in a semi_automated fashion by definition of the spectral mixing equations the fmos are training_sets of negative_examples for each bm the full staining test_set is compared with the fmos to determine positive cells for each bm as given by those that lie outside the fmos the output of all the one class classifiers is combined to yield the final populations furthermore we can use the physical constraints to improve sensitivity of positive cell detection namely that i cells are not independent events but rather they are correlated ii the composition of cells is preserved between the full staining and fmo and iii the cells that are negative for a given bm have the same covariance in both the full staining and fmo additionally we apply the algorithm iteratively to remove populations that mask others this gives the following statistical and technical advantages populations are found in direct_relation to a biological_control thus avoiding unsupervised_learning as larger_populations are successively removed it becomes easier to find smaller populations even without prior_knowledge furthermore no prior_knowledge is required as to the form of af and ub given that population identification occurs directly in spectral space spectral overlap no longer needs to be minimized to such a great extent giving more flexibility in fluorescent marker selection and experiments that are currently difficult are possible on standard instruments without requiring the purchase of specialized_equipment all flow_cytometry applications suffer from contamination arising from various sources junk e g debris dead cells that were not gated out doublets bubbles in the sheath fluid and unbound fluorescent molecules altered fluorescence e g unspecific staining bleaching and fret or instrumentation e g electronic noise laser fluctuations optical_properties and variation in flow speed among others it can be hard to distinguish rare populations from contamination and in traditional manual hierarchical gating an operator would probably ignore small percentages with the exact threshold depending on the total number of cells collected the experience of the operator and the biological_question at hand in fact if rare cells are indeed the focus of the biological_question then different experimental_approaches would almost certainly have been taken in the first place such as magnet pre enrichment of the rare cell_population for these reasons the full algorithm is quite deliberately only semi_automated in nature and this is based on the fact that successive iterations find increasingly smaller groups of positive cells the issues listed above are too numerous and complex to be solved by an algorithm the approach we therefore take is to let the operator decide the minimum population_size and return a list of putative populations for further human interpretation the article is organized as follows the algorithm is described in section in section the algorithm is tested on simulated_data to demonstrate its increased sensitivity over alternatives selected clustering_methods are also applied to the simulated_data to demonstrate that it is difficult to find the correct clustering in the absence of prior or external knowledge the clustering_methods discussed were evaluated in flowcap and are available via bioconductor finally the algorithm is applied to a four marker staining and the output is confirmed with manual hierarchical gating selected clustering_methods are also applied but they fail to find the small_populations we have demonstrated how fmos can be compared with full stainings with a one class classification approach to systematically discover the samples composition of cell_populations the proposed algorithm requires no tuning of parameters and each full staining fmo comparison cpc proj poly is linear in the number of cells and easily parallelizable the cell_populations found were heterogenous in terms of cell number ranging from to of the total when attempting to discover cell_populations via unsupervised methods the four largest populations masked the smaller ones and it was not possible to find them using the investigated methods without further modification it could be argued that this problem is easily avoided by firstdown sampling as is done in spade to approximate a uniform density however the degree of down sampling requires parameter_tuning to ensure the smallest populations are not missed and it is unclear how to do so without prior_knowledge of the samples composition these difficulties are the manifestation of the general_problem of unsupervised_learning output validation which is not possible in the absence of external_information when widely used biomarkers are applied this problem is not so severe as output can be compared against accumulated knowledge but as novel biomarkers are increasingly used the appropriate post_hoc controls must be made e g cell_sorting and further tests alternatively fmos can be made at the outset additionally it was noted in this data that many populations that we found cd cd all single positive populations are in fact on a continuum with long tails stretching down towards the unstained population in other words there is no distinct cut between stained and unstained and if this is in fact a common_feature of flow_cytometry data it would suggest that it is inherently ill suited to being clustered unspecific contamination is an issue common to all flow_cytometry applications and we do not attempt to solve this here as such the algorithm is presented as being semi_automated the major_problem is to decide whether a rare population is a true population or an artefact caused by contamination as discussed in section this cannot be decided from the data alone but rather further experiments would be necessarily more commonly if rare populations are specifically of interest then alternative experimental_designs would be undertaken from the beginning these issues are widely known and lack a cutand dried solution thus our strategy has been to leave the minimum population_size decision to the operator and return a list of putative populations a future improvement would be to additionally return a measure of scatter for each population to improve the interpretation process this algorithm not only represents a statistical advance in the analysis of flow_cytometry experiments but it also confers significant technical advantages a current limitation of flow_cytometry is the choice of fluorescent markers for optimal compensation they must be chosen so as to have minimal spectral overlap because all calculations are done in spectral space it is no longer crucial that spectral overlap is minimized to such large extent this increases the range of experiments that are technically possible on standard instrumentation already in daily use the introduction of fmos was a major step_forward in the quality_control of flow_cytometry experiments and they remain a gold_standard but their use has largely been confined to visual_inspection we have presented a novel one class classifying algorithm that harnesses the properties of fmos to systematically identify cell_populations by doing so the validation problem of unsupervised_learning is circumvented as all calculations are done in the spectral space new technical possibilities are opened such as a great_deal more flexibility in the choice of fluorescent markers as compensation is not required finally this method is immediately available to any flow_cytometry user as it can be done on completely standard instrumentation without requiring the purchase of specialized_equipment conflict of interest none declared 
