gene_expression vipr hmm a hidden_markov for detecting recombination with microbial detection microarrays motivation current methods in diagnostic microbiology typically focus on the detection of a single genomic locus or protein in a candidate agent the presence of the entire microbe is then inferred from this isolated result problematically the presence of recombination in microbial_genomes would go undetected unless other genomic_loci or protein components were specifically assayed microarrays lend themselves well to the detection of multiple_loci from a given microbe furthermore the inherent nature of microarrays facilitates highly_parallel interrogation of multiple microbes however none of the existing_methods for analyzing diagnostic microarray_data has the capacity to specifically identify recombinant microbes in previous work we developed a novel algorithm vipr for analyzing diagnostic microarray_data results we have expanded upon our previous implementation of vipr by incorporating a hidden_markov hmm to detect recombinant genomes we trained our hmm on a set of non recombinant parental viruses and applied our method to recom binant alphaviruses and recombinant flaviviruses hybridized to a diagnostic microarray in order to evaluate performance of the hmm vipr hmm correctly_identified of the inter_species recombin ation breakpoints in the validation_set and only two false_positive breakpoints were predicted this study represents the first description and validation of an algorithm capable of detecting recombinant_viruses based on diagnostic microarray_hybridization patterns availability vipr hmm is freely_available for academic use and can be downloaded from http ibridgenetwork org wustl vipr recombination constitutes an important source of genetic_variation among viruses as an evolutionary_mechanism recombination leads to new viral genotypes with potentially novel biological_properties and or clinical_manifestations vaccinederived poliovirus is one example of a virus for which recombination may play_an in the progression of disease recombination between vaccine_derived poliovirus and coxsackie virus has been shown to increase neurovirulence of recombinant progeny and may be responsible for the emergence of pathogenic vaccine_derived poliovirus in addition h n influenza and ngari viruses provide examples in which novel genotypes consisting of genomic_segments derived from multiple different parental viruses have led to disease_outbreaks h n the influenza_virus responsible for the outbreak of pandemic flu is thought to have arisen from the successive reassortment of four different strains of influenza a ngari virus a hemorrhagic_fever causing bunyavirus is thought to have resulted from the natural reassortment of two viruses bunyamwera and batai viruses neither of which is known to cause hemorrhagic_fever given that recombination and reassortment can play_important in producing novel variations that are implicated in pathological outcomes the ability for clinicians to identify novel recombinant and reassortant_viruses in diagnostic laboratories is highly_desirable in addition to occurring naturally through evolution recombinant and reassortant_viruses can also be deliberately created in the laboratory in vitro recombination has proven to be a useful tool for engineering novel viruses with properties desirable for the development of vaccines however this also means that recombination and reassortment have the potential to be used maliciously to develop novel agents of bioterrorism such agents could be engineered as highly_pathogenic new viral genotypes consisting of the components of previously described viruses including nonpathogenic viruses anticipating the possible use of recombinant reassortant based bioweapons should guide our efforts in preparing to respond to such attacks in such cases the ability to detect novel agents quickly and accurately would be critical thus it is imperative that any assay used to detect agents of bioterrorism include novel recombinants and reassortants as possible outcomes microarrays are well suited to detecting recombination and reassortment and have an important advantage over traditional diagnostic_methods because they allow for the interrogation of multiple_loci from multiple viruses in parallel traditional_methods for microbial detection such as polymerase_chain to whom correspondence should be addressed pcr and antibody based_methods are generally limited to detecting only one genome segment or one protein per assay the inference is then made that the entire_genome is present given that a small part of the genome or proteome was detected unless other loci are specifically assayed this diagnostic paradigm does not account for the possibility that a recombinant or reassortant virus is present there have been many reports of the efficacy of microarrays as a tool for viral diagnosis and discovery although many different probe design strategies and platforms have been proposed for diagnostic microarrays all approaches require an objective method for interpreting the raw hybridization patterns the method must be able to make diagnostic calls in the presence of technical noise biological noise i e cross_hybridization to host and probe saturation published examples of such methods with downloadable or web accessible software include e predict detectiv phylodetect climax and vipr although these methods have been shown to perform with high_accuracy none of them was designed to be able to identify novel recombinant or reassortant_viruses from a hybridization pattern one feature of vipr which stands for viral identification with a probabilistic algorithm is that it relies on an empirical training_set of positive_and control hybridizations to leverage diagnostic predictions in this article we describe the expansion of vipr to accommodate the possibility of recombination between candidate viruses included in the training_set we accomplished this by incorporating a hidden_markov hmm into our method in order to define recombinant paths when calculating probabilities for candidate viruses shows the details of constructing the hmm the viterbi algorithm was used to determine the optimal path from which recombination breakpoints could be inferred as with vipr our hmm allows us to take advantage of training data consisting of hybridizations of known viruses to a microarray to make predictions for unknown infections the incorporation of an hmm into vipr now provides a probabilistic_framework for assessing the presence of recombination between candidate parental viruses to validate our approach we applied our hmm to a set of recombinant_viruses consisting of members of the alphavirus and flavivirus genera each of which was hybridized in duplicate to a custom microarray a set of microarrays to which non recombinant alphaviruses and flaviviruses were hybridized constituted the training data for the hmm although our test focused on the validation of a set of recombinant alphaviruses and flaviviruses the strategy should be generalizable to detecting recombination among members of a given viral family rna was purified from cell_cultures that were infected with each of the viruses shown in tables and purified rna was subsequently randomly amplified and hybridized to a custom diagnostic microarray sixty five hybridizations representing non recombinant alphavirus and flavivirus parental viruses representing uninfected vero_cells were performed in order to obtain a training_set for the hmm for validation of our algorithm hybridizations representing alphavirus and flavivirus recombinants representing alphavirus and flavivirus overall strategy for using an hmm to identify recombinant and non recombinant_viruses hybridized to a microarray probe intensities indicative of binding can implicate the presence of a single virus left or the presence of different viruses for different loci right this pattern of intensities can be used to identify an optimal path through an hmm whose states represent binding or non binding_events between probes columns and virus_genomes rows non recombinant paths such as the one on the left involve transitions only between states in the same row while paths that move from one row to another are indicative of recombination as exemplified in the path on the right non recombinants representing uninfected vero_cells were performed in order to build the hmm we first needed to establish a framework to define possible recombinant and non recombinant paths based on positional_information inherent to each probe the microarray probes were ordered by their position from to in the global_alignment of candidate virus_genomes this was accomplished by mapping the set of oligonucleotide_probes through local_alignment megablast to each candidate virus genome identifying probes for which the theoretical free_energy associated with its probe genome local_alignment was kcal_mol indicative of binding using previously explained criteria and converting the midpoint of the probe genome local_alignment for each of those probes to its corresponding position in the global_alignment of candidate virus_genomes probes that mapped to multiple_genomes at similar positions but were offset relative to each other by nucleotides or fewer were consolidated to a single position in the global_alignment probes were then sorted by their positions in the global_alignment of candidate virus_genomes once the probes were ordered they were assigned on and off states for each genome these assignments were based on the same theoretical free_energy of binding calculated in the mapping step on and off states emit normalized and log e transformed intensities according to normal_distributions estimated from training data as previously described thus all emission probabilities e state intensity were derived from distributions estimated in a manner identical to the estimation of probe specific on and off distributions in vipr except in the case where there were fewer than eight intensities available in the training_set for a given probe in that case the mean of the distribution was calculated from the available intensities but the standard_deviation was derived from the average standard_deviation over all probes with a similar on or off prediction in addition to the candidate virus_genomes a null genome was included which represented a none of the above genome prediction and was assigned an off state for each probe in the multiple_alignment based on predicted free_energy of binding in order to achieve a universal ordering of probes a state is created for each probe genome combination representing either a predicted binding or non binding event the hmm is subsequently parameterized with emission distributions and transition_probabilities based on probe intensity distributions from the training data and a user_defined probability of recombination parameter p recomb respectivelyfinally the states in the hmm were connected through transitions t state state as depicted in as with hmms that have been developed to detect recombination in sequence probabilities representing recombination transitions could not be estimated directly from the training data as could the other hmm parameters thus a user specified probability of recombination parameter p recomb was introduced to compute transition_probabilities transitions connecting states within the same genome i e t state virusa state virusa represented non recombination_events and had the associated probability p recomb transitions between genomes i e t state virusa state virusb represented recombination_events and had the associated probability p recomb n where n is the number of candidate virus_genomes including the null genome in some cases multiple probes mapped to the same position in the global_alignment of candidate virus_genomes transitions between states whose probes mapped to the same position were only allowed if those states corresponded to the same genome and were assigned a probability of such that recombination_events were not permitted between such states because the next state in the model is dependent only on the current state and because states in the model emit from continuous intensity distributions the model is a first order continuous hmm two models were built and were used to analyze the alphaviruses and the flaviviruses respectively in order to experimentally define a suitable p recomb for computing transition_probabilities we evaluated the performance of vipr hmm on a subset of parental viruses varying p recomb over a range of values we selected the maximum value of p recomb that resulted in zero false_positive recombination breakpoints when viterbi was applied to the parental alphaviruses this value p recomb was subsequently used when applying vipr hmm to the parental flaviviruses as well as to the alphavirus and flavivirus recombinants the viterbi results were compared with expected results based on the known sequences of the recombinant constructs when applied to the five flavivirus non recombinants vipr hmm classified each as the correct species additionally the four uninfected vero samples were accurately classified as null vipr hmm detected no recombination breakpoints for these samples except for one false_positive breakpoint at the end of the dengue_virus genome which bypassed the final nt of the genome in favor of null states vipr hmm results for the non recombinant alphaviruses and flaviviruses are shown in supplementary a total of hybridizations of recombinant_viruses were analyzed by vipr hmm supplementaryshows the results for all recombinant alphaviruses and flaviviruses analyzed by vipr hmm of the hybridizations represented double recombinants between two parent viruses of distinct species and two represented triple recombinants composed of three distinct parental_species thus the total number of expected inter_species recombination breakpoints was vipr hmm correctly_identified breakpoints and the identity of the parental_species for of the total breakpoints in the remaining three instances vipr hmm yielded false_negatives of all the recombinant and non recombinant samples analyzed by vipr hmm only two false_positive breakpoints were predicted one in a non recombinant_virus and one in a double recombinant_virus which was incorrectly identified as a triple recombinant by vipr hmm vipr hmm results for a subset of the recombinant_viruses that were identified unambiguously are shown in in some cases the recombinant_viruses we used included intra species recombination breakpoints of the eight intra species breakpoints two were identified by vipr hmm for those two breakpoints the correct viruses and of the breakpoint were identified both species and strain vipr hmm results for a subset of the recombinant_viruses that gave unexpected_results are shown in vipr hmm was used to estimate the nucleotide positions of each breakpoint in each parental genome the nucleotide positions associated with recombination breakpoints were estimatedbased on the position in the alignment of the probes associated with the recombinant transition in the viterbi path for each such probe its position in the alignment was correlated with a position in the viterbi specified parental virus genome to estimate the nucleotide position of the recombination breakpoint in that genome see spreadsheet in the supplementary_material the differences between the nucleotide positions estimated by vipr and the actual sequence_positions ranged from to nt the ability of dna_microarrays to simultaneously assess the presence of multiple_loci in microbial_genomes is highly advantageous for detecting recombination between virus species in a diagnostic_setting despite this none of the existing_methods for analyzing diagnostic microarrays is designed to accommodate the detection of recombinant_viruses in previous work we developed vipr a method for objectively interpreting diagnostic microarrays one of the advantages of vipr relative to other methods is that it relies on a training_set of empirical hybridizations of virally infected and uninfected samples to leverage diagnostic predictions we anticipated that relying on a training_set of hybridizations from known viral_infections would also help us predict recombination between virus species in this study we developed an hmm parameterized with vipr probability_distributions to detect recombination in unknown infections vipr hmm performed with high_accuracy when identifying recombination breakpoints between viral species such breakpoints were identified and the correct virus species and to the breakpoint were identified in each case of the eight intra species breakpoints in our dataset two were identified by vipr hmm given that a much higher percentage of inter_species breakpoints were detected than were intra species breakpoints versus these results demonstrate that vipr hmm is more effective at detecting recombination between species than between strains belonging to the same species the ability of vipr hmm to distinguish between strains of the same species involved in recombination is likely influenced by the degree of sequence_divergence between the two strains vipr hmm correctly_identified the intra species breakpoint in both hybridizations of r the two strains comprising the intra species breakpoint for r are divergent on the nucleotide level however vipr hmm was not able to identify the intra species breakpoint in either hybridization of r whose recombinant regions and to the intra species breakpoint were similar in size to those of r but whose strains comprising the intra species breakpoint are only divergent on the nucleotide level the ability of vipr hmm to distinguish between strains of the same species may also be influenced by the size of the recombinant segment the four other intra species breakpoints that vipr hmm failed to detect had greater dissimilarity between flanking strains but were proximal to other breakpoints within nt given the cost in probability vipr hmm results for a subset of recombinants tested a vipr hmm results for three recombinants that gave expected results for each recombinant the expected output based on sequence is shown followed by the vipr hmm output for the two hybridizations performed b vipr hmm results for three recombinants that gave unexpected_results r is a double recombinant for which an additional false_positive recombination breakpoint was identified at the end in one hybridization and for which a inter_species recombination breakpoint was not identified in the other hybridization r is a double recombinant for which a inter_species recombination breakpoint was identified in one of the hybridizations but not the other additionally an intra species recombination breakpoint was not identified in either hybridization r is a triple recombinant for which all three inter_species recombination breakpoints were identified in both hybridizations but for which an intra species recombination breakpoint was not identified in either associated with following a recombinant transition in the hmm our results suggest that viterbi may opt to bypass small recombinant regions although we have not specifically tested vipr hmm for higher_order recombinants more than three breakpoints we anticipate that the identification of higher_order recombinants will only be hindered inasmuch as additional recombination_events within a fixed size genome yield smaller recombinant segments to be identified given that vipr hmm was shown to identify recombinant regions as small as nt where there was sufficient divergence between recombining species we expect vipr hmm would be able to detect similar regions in higher_order recombinants since microarray probes are mapped to their position in an alignment of candidate genomes vipr hmm can use the probes located at the boundary of a predicted recombination event to estimate nucleotide positions of recombination breakpoints although it was not expected that using a microarray tiling scheme wherein probes were non overlapping and spaced nt apart would give the precise nucleotide positions of recombination breakpoints we compared the estimates given by vipr hmm with the nucleotide positions known from sequence for the correctly_identified breakpoints inter_species intra species the differences between microarray estimates and actual positions ranged from to nt therefore the maximum distance observed falls within the span of about a two probe tiling i e mer nt spacing mer we expect that using higher_density tiling strategies would result in higher_resolution mapping of the breakpoints only two false_positive recombination breakpoints were predicted by vipr hmm both near the ends of their respective genomes one bypassed the final nt of dengue_virus in favor of null states the other bypassed the final nt of sindbis_virus in favor of veev states from analysis of the training data it was observed that the mean of the on distributions approach the mean of the off distributions for probes near the end of each genome due to lower intensities for on probes in the training_set for that region this trend was observed in the training data universally for all genomes the tendency for on probes to give lower intensities when approaching the end may be attributable to the fact that random pcr_amplification which was used in the preparation of each sample for hybridization is less efficient at the ends of a linear genome this could also explain why vipr failed to detect three inter_species recombination breakpoints all of which are localized near the end of a genome a similar pattern of lower intensities was also observed for on probes approaching the end although there appeared to be more probes in those regions that behaved as expected based on g compared with the end despite the observed decrease in hybridization intensity proximal to the and termini vipr hmm was still able to make accurate_predictions in those regions in most cases although we did not specifically validate vipr hmm for reassortant_viruses we anticipate that viral reassortants would be readily detected reassortment can occur during co infection when virus progeny inherit genome segments from two or more parental viruses with multi segmented genomes the resulting chimeric genotypes associated with reassortment are similar to those generated through recombination except that the exchange of genetic_material occurs at discrete predictable points in the genome i e at the boundary between genome segments vipr hmm could also be applied to the analysis of bacterial_genomes and for the detection of the loss of transposons integrons and plasmids assuming those elements are represented in members of the training_set one challenge in building an hmm for detecting recombination is finding an appropriate value for p recomb a user inputted probability of recombination parameter used to calculate different transition_probabilities in the model our choice of p recomb was based on minimizing false_positive recombinations in non recombinant samples if p recomb is increased by five logs i e p recomb the number of correctly called breakpoints is increased to from to however there are an additional three false_positive breakpoints called near genome ends nonetheless in some cases it may be advantageous to increase p recomb in order to increase detection sensitivity if p recomb is decreased by five logs i e p recomb there is no change in the results vipr hmm relies on a multiple_alignment of candidate genomes to order microarray probes one limitation of this approach is that only recombination between members of the same family will be considered as candidates since it is not generally feasible to globally align members of different families in addition because paths through the hmm follow a specific ordering only recombination at homologous sites is detectible by vipr hmm as currently implemented in future versions of vipr recombinants composed of viruses from different families could be detected by running multiple iterations of viterbi one for each hmm representing a different virus family for a hypothetical recombinant between members of two different virus families we anticipate that the hmm for each family would predict the presence of only a portion of the viral_genome from its family with the rest of the prediction being the null genome with respect to selecting an appropriate p recomb for detecting inter family recombination there are several different approaches that could be taken one would be to use the same p recomb for inter family events as is used for intra family events another would be to lower p recomb for inter family events the choice of strategy would likely depend on what was known a priori about the possibility of certain families recombining the time complexity for the vipr hmm algorithm is n m where n is the number of probes and m is the number of genomes the alphavirus recombinant samples were analyzed in under s on a single processor pc with gb ram thus if the number of candidate genomes were increased to while the number of probes remained the same it would take s or min to analyze one sample on a similar machine 
