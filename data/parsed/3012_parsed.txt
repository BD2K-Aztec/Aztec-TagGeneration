mixed model coexpression calculating gene coexpression while accounting for expression heterogeneity motivation the analysis of gene coexpression is at the core of many types of genetic_analysis the coexpression between two genes can be calculated by using a traditional pearsons_correlation however unobserved confounding_effects may cause inflation of the pearsons_correlation so that uncorrelated genes appear correlated many general methods have been suggested which aim to remove the effects of confounding from gene_expression data however the residual_confounding which is not accounted for by these generic correction procedures has the potential to induce correlation between genes therefore a method that specifically aims to calculate gene coexpression between gene_expression arrays while accounting for confounding_effects is desirable results in this article we present a statistical_model for calculating gene coexpression called mixed model coexpression mmc which models coexpression within a mixed model framework confounding_effects are expected to be encoded in the matrix representing the correlation between arrays the inter sample correlation_matrix by conditioning on the information in the inter sample correlation_matrix mmc is able to produce gene coexpressions that are not influenced by global confounding_effects and thus significantly reduce the number of spurious coexpressions observed we applied mmc to both human and yeast datasets and show it is better able to effectively prioritize strong coexpressions when compared to a traditional pearsons_correlation and a pearsons_correlation applied to data corrected with surrogate_variable sva availability the method is implemented in the r programming_language and may be found atthe analysis of gene coexpression patterns has been of great interest in recent_years due to the widespread availability of microarray_datasets measuring thousands of genes gene coexpressions evaluated by comparing the expression_patterns of pairs of genes have been utilized in order to identify loci responsible for regulating genes to evaluate the significance of known pathways and to identify functionally_related whose relationships have been conserved through evolution unfortunately gene_expression data can be largely affected by technical bias such as a batch_effects or plate effects such nonbiological effects have been shown to induce correlations between to whom correspondence should be addressed genes for example showed that spacial placement of microarray probes affected the correlation between gene_expression causing genes to be more or less correlated depending on the proximity of their respective probes on the array more generally unobserved factors_affecting gene_expression have the potential to cause correlation between genes when these factors are shared between gene_expressions they cause genes to have similar patterns of overall variation since these effects are not directly observed they are not incorporated into statistical_models the shared variation between genes is attributed to biological causes this issue is referred to as expression heterogeneity and has been acknowledged as a general_problem when analyzing expression datasets the detrimental_effects of technical confounding on the results obtained from microarray_analysis are well known while examining the effects of stochastic dependence between arrays on the correlation of test_statistics used in determining differential_expression noted that the correlation_structure of arrays induced through non biological_effects can lead to spurious correlation between genes they note that microarray normalization procedures mitigate such phenomenon but are unable to completely negate them in fact the presence of spurious correlations is a general_problem that arises when analyzing many types of noisy high_dimensional biological_datasets and has been examined in many different contexts in the context of gene coexpression the cause of spurious correlations can be conceptualized by viewing a set of n microarrays measuring m genes as a mn matrix in this matrix we expect that the microarrays represented by the columns are independent and that some of the rows representing the genes will be correlated indicating biological_relationships in the presence of technical confounding_effects such as batch_effects the columns will share characteristics that will cause the overall patterns of expression to be similar and thus the arrays will be statistically_correlated this increased correlation between columns induces correlation between rows as it becomes more likely that two randomly_selected rows will be correlated given that the overall patterns of expression for each array are similar in this way the correlation between arrays or inter sample correlation has the potential to induce correlations between genes many methods have been developed that aim to remove confounding_effects from gene_expression data for example in the case of known batch_effects a method such as combat may be employed combat uses an empirical_bayes approach to estimate_parameters associated with batch and produces corrected gene_expression data this corrected expression data can then be used in subsequent analysis in this article we present a statistical_model for the calculation of gene coexpression called mmc our method calculates gene coexpressions that are robust to confounding_effects we calculate the coexpression between two genes by utilizing a mixed model framework unknown confounding_effects are represented as a random variable in a mixed model formulation of coexpression we use the inter sample correlation to estimate the variance of the random variable representing unknown confounding and incorporate this variance into the model of coexpression we compare the coexpressions obtained with our method with those obtained using the traditional pearson_correlation and those obtained using sva corrected expression data although rank_based correlation methods such as the spearman_correlation have been used to reduce the prevalence of spurious correlations due to deviations from assumptions of normality in expression data we have observed in practice that the spearman_correlation performs similarly to the pearson when comparing with mmc data not shown when probe pairs target the same gene we expect that their coexpressions will be highly ranked when compared with all other pairwise coexpressions for probe pairs of this type mmc is shown to produce coexpressions that are more highly ranked when compared with the other two methods we also show that mmc produces coexpressions that are more concordant across replicate datasets generated by the same lab using the same strains but generated at different times operating under the assumption that biologically and functionally meaningful groups of genes will be highly coexpressed we create a simple statistic which is used to assess the functional significance of groups of genes our method shows increased power to discover sets of genes which are known to be biologically_significant although our method is able to calculate coexpression while removing the effects of confounding it might also remove effects which are biologically_meaningful technical confounding_effects such as a batch_effect typically have a global effect on the data that is these effects will increase the expression variation in a large_number this shared variation within genes causes them to appear to be significantly coexpressed our method estimates global patterns of shared variation through the inter sample correlation and effectively removes the effects causing the variation from the calculation of coexpression a problem arises when we consider the case in which one gene has a large biological effect on hundreds of other genes the effect that master_regulators have on expression data as a whole is indistinguishable from the unwanted global confounding_effects that is the variation in gene_expression caused by master_regulators quite closely_resembles patterns of variation caused by confounding_effects and will therefore be removed by our method in this case mmc may over correct true_biological signal and cause true coexpressions to be lost the drawback to our method may also be seen as a beneficial side effect when master_regulators target many genes traditional coexpression analyses employing clustering will yield many large_sized gene_modules by removing the effects of master_regulators mmc essentially enables coexpression clustering analysis to produce smaller gene_modules conditional on the large modules large gene_modules discovered through the use of standard coexpression analysis may be seen as representative of large_scale cellular functionality small modules discovered through clustering with mmc will be subsets of these large modules by intersecting results it may be possible to more fully understand the detailed circuitry of the cell 
