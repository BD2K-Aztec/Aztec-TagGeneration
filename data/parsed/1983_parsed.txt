gene_expression gene_selection for the reconstruction of stem_cell trees a linear_programming approach_motivation stem_cell is largely guided by master transcriptional_regulators but it also depends on the expression of other types of genes such as cell_cycle genes signaling genes metabolic genes trafficking genes etc traditional approaches to understanding gene_expression across multiple conditions such as principal_components or k_means can group cell_types based on gene_expression but they do so without knowledge of the differentiation hierarchy hierarchical_clustering can organize cell_types into a tree but in general this tree is different from the differentiation hierarchy itself methods given the differentiation hierarchy and gene_expression data at each node we construct a weighted euclidean distance_metric such that the minimum_spanning with respect to that metric is precisely the given differentiation hierarchy we provide a set of linear constraints that are provably sufficient for the desired construction and a linear_programming approach to identify sparse sets of weights effectively identifying genes that are most relevant for discriminating different parts of the tree results we apply our method to microarray_gene data_describing cell_types in the hematopoiesis hierarchy constructing a weighted euclidean metric that uses just genes however we find that there are many alternative sets of weights that satisfy the linear constraints thus in the style of random_forest training we also construct metrics based on random subsets of the genes and compare them to the metric of genes we then report on the selected genes and their biological_functions our approach offers a new way to identify genes that may have important roles in stem_cell the differentiation of stem_cells from a pluripotent_state towards increasingly specialized cell_types has long been conceptualized as a branching process with multi potent cells towards the top and fully differentiated_cells at the bottom layer the discrete cell_types in the differentiation hierarchy have been identified by scientists using a number of means including morphology the study of development lineage_tracing etc in practice the cell_types v c the author published_by all_rights for permissions please_e journals permissions_oup com are often identified based on the expression of certain marker_genes many of these are cell_surface proteins which are fairly easy to assay biochemically however such marker_genes are not necessarily causative of the cell_type in the sense of being master transcriptional_regulators this raises_important about how gene_expression across the whole_genome controls or reflects cell state and in particular differentiation hierarchies since the advent of gene_expression and more recently rna_seq technology expression in various stem_cell has been studied this has prompted some authors to try to reconstruct differentiation hierarchies de_novo based only on expression data used single_linkage hierarchical_clustering on microarray_gene of mature differentiated human blood cells to classify them into nine distinct lineages the resulting tree agreed with the known differentiation tree for blood cells proving that de_novo reconstruction of the tree is possible showed that similar to phylogenetic_tree cellular_differentiation hierarchies of mammalian tissue specifically the hierarchical structures for hematopoietic differentiation neural_differentiation and early endoderm organogenesis can be inferred from gene_expression by parsimonious maximization again confirming the feasibility of de_novo reconstruction principal_component pca has also been used to map expression_profiles of cells onto the principal component space of lower dimension the positions of cells on the trajectories formed in the space of the highest three components seem to reflect the developmental potency of the cells and their differentiation status we became interested in testing reconstruction on the more extensive dataset of this data comprises microarray_gene for genes in distinct cell_types in the hematopoiesis hierarchy each assayed with between and replicate arrays for a total of arrays supplementary the majority of the cell_types were purified with purity from umbilical_cord which is enriched in undifferentiated populations however the terminally_differentiated populations were purified from adult peripheral_blood because exposure to antigens after birth is necessary for these populations the remaining cells were identified by flow_cytometry for labeled antibodies against the marker_genes listed beside each cell_type inand or flow scatter properties all marker_genes that were used for cell_type identification are also shown in supplementary table s more details on cell_populations and their sorting can be found in the experimental_procedures of the hierarchical_clustering approach espoused byand the maximum_parsimony approach of joshi and berthold assume data only at the most differentiated level thus they are not well suited to the novershtern data which includes expression data at both leaves and internal nodes of the differentiation hierarchy nevertheless by taking the unpalatable step the cell_types are hematopoietic_stem hsc common myeloid_progenitor cmp megakaryocyte erythroid progenitor mep erythroid_cells ery cfu_mk mega megakaryocyte mega granulocyte monocyte progenitor gmp cgu g gran neutrophilic metamyelocyte gran neutrophil gran cfu m mono monocyte mono eosinophil eos basophil bas myeloid dendritic_cell mld plasmacytoid_dendritic pld early b cell pre b pre_b pre b navenave b cell b mature b cell class able to switch b mature b cell b mature b cell class switched b mature nk_cells n navenave cd t cell t cd effector_memory ra t cd effector_memory t cd central memory t navenave cd t cell t cd effector_memory t and cd central memory t near each cell_type is a list of the marker_genes whose expression was used by the authors ofto identify that cell_type a plus minus sign following a marker gene name indicates a relatively higher lower expression_level of that gene in a cell_type a list of all marker_genes used for cell_type identification is shown in supplementary table s color version of this figure is available at bioinformatics online of discarding the non fully_differentiated cell_types leaving only the fully_differentiated types we were able to apply both approaches the resulting trees bore substantial resemblance to the correct differentiation hierarchy although there were some errors supplementary figs s and s it occurred to us that we might be able to reconstruct the differentiation hierarchy as a minimum_spanning because this would allow cell_types to be either internal or leaf nodes in the resulting tree we thus tried constructing minimum spanning trees on the expression data using various distance metrics euclidean l cosine correlation chebyshev etc accuracy of these reconstructions varied but none of the trees matched the true differentiation tree supplementary figs s s by performing pca on the expression data of the hematopoietic cell_types we were able to map the expression_profiles of the cell_types onto the space of the principal_components the positions of the cells showed partial agreement with the correct hierarchy supplementary however again when we constructed a minimum_spanning of the cells using euclidean_distance on the cell profiles in the new space of the n highest components for n the resulting trees did not agree with the correct differentiation tree minimum spanning trees constructed using single principal_components also did not agree with the differentiation hierarchy supplementary we concluded that to reconstruct a differentiation hierarchy as a minimum_spanning we need to identify the correct distance_metric distance_metric learning has been studied extensively in the machine_learning literature particularly in the context of classification for instance introduced a convex_optimization method for learning a distance_metric that minimizes the distance between objects of the same class subject to linear constraints that ensure objects from different classes are well separated similar work was done by kwok and tsang and globerson and roweis weinberger and saul and ying and li aim to improve k nearest_neighbor classification by learning a mahalanobis distance_metric from labeled training examples a comprehensive survey of distance_metric learning algorithms can also be found in however all of these methods focus on improving performance in classification tasks usually binary_classification none of these methods is suitable to find a metric consistent with a differentiation hierarchy the main contribution of the present article is to propose a solution to the following problem given a set of objects cell_types with associated feature_vectors gene_expression and given a tree t on those objects identify a weighted euclidean distance_metric such that the minimum_spanning m constructed with that distance_metric is precisely the tree t we propose a set of linear constraints on the weights depending on the tree t and feature_vectors and prove that they are sufficient though not necessary to establish the desired distance_metric we then propose an efficiently solvable linear_program designed to satisfy those constraints while minimizing the l norm of the weights this produces a sparse set of weights for hierarchy reconstruction in essence choosing a subset of genes to participate in the distance_metric we apply this approach to the novershtern data demonstrating successful tree reconstruction and report on genes selected by the optimization our differentiation tree has n nodes and each replicate array in the dataset consists of gene_expression values therefore the matrix a in our linear_program has constraints rows and columns for the purpose of computational accuracy and to be fair with all genes we averaged the expression of each gene across all replicates of a cell so that each cell is represented by one array we then normalized the data so that the mean expression of each gene over all cells is with a standard_deviation of for the inequalities in our linear_program we chose b t any other negative constant produces the same results although attaching different constants to different constraints could produce different results 
