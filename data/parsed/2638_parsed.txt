phylogenetics advance_access kdetrees non parametric estimation of phylogenetic_tree distributions motivation although the majority of gene histories found in a clade of organisms are expected to be generated by a common process e g the coalescent_process it is well known that numerous other coex isting processes e g horizontal gene transfers gene_duplication and subsequent neofunctionalization will cause some genes to exhibit a history distinct from those of the majority of genes such outlying gene_trees are considered to be biologically_interesting and identifying these genes has become an important problem in phylogenetics results we propose and implement kdetrees a non parametric method for estimating distributions of phylogenetic_trees with the goal of identifying trees that are significantly different from the rest of the trees in the sample our method compares_favorably with a similar recently_published method featuring an improvement of one polynomial order of computational_complexity to quadratic in the number of trees analyzed with simulation_studies suggesting only a small penalty to classification_accuracy application of kdetrees to a set of apicomplexa genes identified several unreliable sequence_alignments that had escaped previous detection as well as a gene independently reported as a possible case of horizontal_gene we also analyze a set of epichlo e genes fungi symbiotic with grasses successfully identifying a contrived instance of paralogy availability_and our method for estimating tree distributions and identifying outlying trees is implemented as the r package kdetrees and is available for download from cran a central problem in systematic biology is the reconstruction of the evolutionary_history of populations and species from numerous gene_trees with varying levels of discordance although there is a wellestablished understanding that discordant phylogenetic_relationships will exist among independent gene_trees drawn from a common species_tree phylogenetic_studies have only recently begun to shift away from single gene and concatenated gene estimates of phylogeny in favor of multilocus methods these newer approaches focus on the role of genetic_drift in producing patterns of incomplete_lineage and gene_tree species_tree discordance largely using coalescent_theory these theoretical developments have been used to reconstruct species_trees from samples of estimated gene_trees detecting concordance among gene_trees is also a topic of interest for example an e et_al developed a bayesian_method to estimate concordance among gene_trees using molecular sequence_data from multiple_loci the method can produce estimated gene_trees as well as an estimate of the proportion of the genome that supports a particular clade however a priori assumptions must be made about the degree and structure of concordance present in the gene_trees although there is a tremendous amount of ongoing effort to develop better parametric_models for gene_tree distributions the parametric framework has inherent_limitations although a parametric method typically makes the most efficient use of a given dataset when the model is specified correctly they achieve this efficiency by assuming that the true distribution of gene_trees is one of a relatively small class of distributions this can lead to erroneous inferences when the true distribution does not resemble any of the models in the proposed class given that many questions remain about the proper way to incorporate a number of important processes into a parametric model e g geographic barriers to migration or a population bottleneck the problem of model mis specification is real non parametric methods avoid the majority of these modeling issues enabling unbiased estimation for a much larger class of true tree distributions at a cost of statistical efficiency numerous processes can reduce the correlation among gene_trees negative or balancing_selection on a particular locus is expected to increase the probability that ancestral gene_copies are maintained through speciation_events horizontal_transfer introduces divergent gene_copies into a different species through shuffling gene_copies among species via hybridization the correlation may also be reduced by naive sampling of loci for analysis for example to whom correspondence should be addressed paralogous gene_copies will result in a gene_tree that conflates gene_duplication with speciation similarly sampled sequence_data that span one or more recombination_events will yield gene_trees that are hybrids of two or more genealogical histories these non coalescent processes can strongly influence phylogenetic_inference in addition showed that an analysis of complete_genomes indicated a massive prokaryotic gene_transfer or transfers preceding the formation of the eukaryotic_cell arguing that there is significant genomic evidence for more than one distinct class of genes these examples suggest that the distribution of eukaryotic gene_trees may be more accurately modeled as a mixture of a number of more fundamental distributions in this article we focus on the problem of identifying significant discordance among gene_trees as well as estimating the distribution of gene_trees as a whole this set of gene_trees is assumed to consist mostly of typical or non outlier gene_trees which are assumed to be independently sampled from some distribution f for example gene_trees have evolved neutrally under a coalescent_process in addition there are a smaller number of outlier gene_trees that are sampled from a different distribution f these genes are assumed to arise from less common evolutionary_processes for example paralogy neofunctionalization horizontal_gene or periods of rapid molecular_evolution in addition more mundane errorssuch as incorrect sequencing alignment tree reconstruction or annotationcan also produce outlier trees in a dataset our method_produces a non parametric estimate of the distribution f and also attempts to identify potential outlier gene_trees that are probably not generated by f trees identified as outliers can then be inspected more closely for biologically interesting_properties in particular identifying and removing outliers that violate model_assumptions can improve the accuracy of inferences made from a collection of gene_trees e g note that in this article we use dissimilarity maps geodesic distances and topological dissimilarity maps between trees for simulations and implementation of our software see subsection with these distance measures between trees we implicitly assume a multispecies coalescent model also note that the choice of tree distance measures might change the detected outlying gene_trees for example if the subtree pruning and regrafting spr distance between trees is used the detected outlier gene_trees would be having an excess of recombinations or horizontal gene transfers we present the software_package kdetrees for non parametric estimation of tree distributions and detection of outlier trees the software takes as input a sample of trees in newick format and estimates for each tree a score based on a non parametric estimator of the tree density it can then use these scores to identify putative outlying trees in the sample the tree scores and summary plots are produced as output the kdetrees package is written in r r development core and depends on packages distory ggplot and ape the software is available for download from cran and is compatible with all systems supported by r the ongoing_development of ever cheaper sequencing methods is producing a plethora of data suitable for phylogenomic analysis one of the great promises of modern genomics is that phylogenetics applied at the genomic_scale phylogenomics should be especially powerful for elucidating gene and genome_evolution relationships among species and populations and processes of speciation and molecular_evolution however for genomic_data that can now be generated relatively cheaply and quickly but for which computationally_efficient analytical_tools are lacking there is a major need to explore new approaches to undertake comparative_genomic and phylogenomic studies more rapidly and robustly than existing_tools allow there is a major need to explore new approaches to undertake comparative_genomic and phylogenomic studies more rapidly and robustly than existing_tools allow in simulations and applications to biological data we address particular challenges posed by bioinformatic artifacts as well as interesting biological_phenomena such as gene_duplications and horizontal_gene as we observed in the apicomplexa and fungal datasets our approach also serves as a means of identifying interesting gene_trees that may arise from horizontal_gene paralogy or experimental artifacts such as misannotations or misalignments a further advantage of our method is that it may be applied in a straightforward way to phylogenetic_reconstruction methods which produce a sample of many trees as output rather than a single best fit tree methods that produce only a point_estimate do not represent the full set of possible phylogenies compatible with the gene sequences we can circumvent this issue by building a kernel for each gene based on a collection or sample of reconstructed topologies e g via the estimated posterior_distribution of each gene rather than using only a point_estimate of each gene_tree in future work we intend to extend our method to clustering trees based on similarity in addition to identifying outliers the identification and exclusion of outlier points is an important preliminary step in many clustering_methods the removal of outlier points facilitates better inference at the clustering stage a long_term goal for this project is to develop a phylogenomic pipeline that is convenient and accessible as well as robust to accomplish this aim important problems that need attention are i refinement of gene calls based on comparison among orthologs from multiple_genomes and ii comparing thousands of gene phylogenies across whole genomes therefore our approach is focused on the efficiency of the algorithm in terms of computational_complexity and memory_requirements with less emphasis on achieving the highest classification_accuracy possible such a trade_off makes our approach more attractive candidate for inclusion in a pipeline for genome_wide phylogenetics as an annotation supplement or as a discovery aid for instances where evolutionary_processes deviate significantly from normal 
