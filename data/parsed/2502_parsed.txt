integrating alignment based and alignment_free sequence similarity_measures for biological sequence classification motivation alignment based sequence_similarity while accurate for some type of sequences can produce incorrect results when used on more divergent but functionally_related sequences that have undergone the sequence rearrangements observed in many bacterial and viral_genomes here we propose a classification model that exploits the complementary nature of alignment based and alignment_free similarity_measures with the aim to improve the accuracy with which dna and protein_sequences are characterized results our model classifies sequences using a combined sequence similarity_score calculated by adaptively weighting the contribution of different sequence similarity_measures weights are determined independently for each sequence in the test_set and reflect the discriminatory_ability of individual similarity_measures in the training_set because the similarity between some sequences is determined more accurately with one type of measure rather than another our classifier allows different sets of weights to be associated with different sequences using five different similarity_measures we show that our model significantly_improves the classification_accuracy over the current composition and alignment based models when predicting the taxonomic lineage for both short viral sequence_fragments and complete viral_sequences we also show that our model can be used effectively for the classification of reads from a real metagenome dataset as well as protein_sequences availability_and all the datasets and the code used in this study are freely_available at https collaborators oicr on ca vferretti borozan csss csss html sequence comparison of genetic_material between known and unknown organisms plays_a in metagenomic and phylogenetic_analysis sequence similarity_search is a method of sequence_analysis that is extensively used for characterizing unannotated sequences it consists of aligning a query_sequence to a sequence database with the aim of determining those sequences that have statistically_significant matches to that of the query in this way for example a known biological_function or taxonomic category of the closest match can be assigned to the query for its characterization alignment_based however can produce incorrect results when applied to more divergent but functionally_related sequences that have undergone sequence rearrangements sequence rearrangements such as genetic_recombination and shuffling or horizontal_gene are observed in a variety of organisms including v c the author published_by the evaluation of the classification_performance on datasets i and ii was carried_out using the accuracy classification score defined in equation shown below where y i is the predicted value of the ith sample y i is the corresponding true value n ts is the total number of test_samples and x is the indicator function having a value of when y i y i and when y i y i as explained in section we decided to compare the results obtained in this study on datasets i and ii to six other compositionand alignment based models that were developed for the classification of metagenomic_data with reads or fragments as short as bp in length of these six models phymmbl is the method closest in approach to ours since it combines scores from imms with those of blast resulting in a combined score that achieves_higher than blast scores alone sequence comparison is at the core of many bioinformatics applications such as metagenomic classification protein_sequence and function characterization and phylogenetic_studies to name a few in many of these applications the alignment based sequence comparison is widely used but this does not come without some limitations one important limitation is that the alignment based similarity measure might give erroneous information when used with sequences that have undergone some type of sequence rearrangement alignment_free similarity_measures offer an alternative to the alignment based ones in that they are unaffected by such genetic processes in this study we propose a model that combines similarity_scores obtained with alignment based and alignment_free sequence similarity_measures to gain additional discriminatory information about sequences and to improve their characterization in tables and we present that our approach performs better than most of the other methods used in this study when predicting genera of unknown viral_sequences i e sequences that are not part of the training_set as described in dataset i or when predicting phyla of metagenomic_sequences the main conceptual difference between the csss model and the other classification methods used in this study at the exception of phymmbl is that the csss model combines similarity_scores obtained with both the alignment based and the alignment_free sequence similarity_measures while the other models rely on either one of these two approaches thus nbc raiphy and phylopythias rely on the alignment_free composition based_approaches using k_mer frequencies or k_mer counts and pauda relies on the alignment based_approach and kraken on the exact alignment of k_mers although in some respects our approach is similar to that of phymmbl since both methods combine scores calculated using different types of similarity_measures phymmbl uses blast scores and imms scores there are two main differences that can explain the results obtained with dataset i shown in first the csss model uses four different similarity_measures so that if sufficiently independent one from another their combined additive effect could confer a greater discriminatory_power than the two similarity_scores combined by phymmbl in supplementaryin supplementary data we show the classification_accuracy of individual similarity_measures used by csss and phymmbl models as a function of the viral fragment length although the classification_performance of the ed see equation and jsd measures are very similar the classification_performance of the cb see measure drops rapidly below as the length of viral fragments decreases if however we perform the classification on full_length viral_genomes see section we find that the cb measure improves the performance by as much as when combined with the other three measures ed jsd and blast this shows that the cb measure contains significant additional information only for sequences that are similar in length to those in the training_set that is complementary to the information contained by the other three measures this drop in performance of the cb measure as a function of the fragment length relative to the length of the genomes in the training_set explains also the smaller difference in performances observed between the csss and phymmbl models when classifying longueur reads in dataset ii see section shown in since the ed and jsd measures show similar classification performances we investigated the degree of independence of these two measures by performing a principal_components pca of the similarity_scores obtained using viral_genomes from dataset i we found that the first component i e pca is strongly associated with the ed measure in test_samples while the second component i e pca is strongly associated with the jsd measure a result that is independent of the viral fragment length as shown in supplementaryin supplementary data these results indicate that these two measures can be considered as orthogonal and thus not correlated with the ed measure accounting for most of the variation across viral_genomes in test_samples to further determine the effect of these two measures on the classification_performance we removed each measure from the model one at the time and then recalculated the accuracy scores we found that for full viral_genomes the effect of removing the ed measure reduced the classification_performance significantly by while removing the jsd measure reduced it only slightly however in the case of shorter viral fragments dropping either one of these two measures from the model did not produce any significant change to the performance while removing both produced a significant drop inperformance up to for bp reads in the light of these results we conclude that both of these measures contain complementary information that is useful for characterizing viral_sequences the second important difference between our model and phymmbl is in the weighting_scheme used in the phymmbl model the weights assigned to each similarity measure i e combined score imm log e where imm is the score of the best matching imm and e the smallest e value returned by blast have the same value for all test examples in the csss model weights are determined independently for each test example based on the discriminatory_ability of each measure using the training_set see equation having different sets of weights for different test samples i e test sequences should improve the classification_performance since some sequences will be better characterized with one type of similarity measure than another another important difference between these two methods is in the classification_performance using blast results alone as shown in supplementary tables s s in supplementary data we found that a significant_improvement in classification is obtained when the blastn algorithm is used instead of mega blast the algorithm used by phymmbl blastn is more sensitive than mega blast because it uses a shorter word size default value of that makes it better at finding related nucleotide_sequences between more divergent biologically sequences since the initial exact match can be shorter we found that for very short viral fragments bp in length the csss model performs better than phymmbl and achieves slightly better accuracy but not significant p value using the two sample t test than the nbc model as shown in by examining the individual performance of the sequence similarity_measures used by the csss model we found that the compositionbased and cb similarity_measures are more affected by the shorter fragment_size than the alignment based one as shown in supplementary table s in supplementary data despite this drop in performance of the composition based and the cb similarity_measures for short bp viral fragments by virtue of combining different similarity_measures the csss model still achieves better performance than the alignment based method pauda p value using the two sample t test or the hybrid phymmbl phymm blast p value using the two sample t test and performs equally well as the best composition based model used in this study namely nbc in section we have shown that our approach can also be used effectively for protein_sequence classification in we show that our model outperforms a similar but simpler lzw blast nn model the main differences between these two approaches are the number of similarity_measures used frequency based measures such as those given in equations and were not used in a different method with which similarity_measures are combined and sw scores p values instead of blast scores without using a weighting_scheme the lzw blast method uses a simple multiplication rule to combine the lzw and blast scores we found that the multiplication rule used inperforms significantly better in combination with an svm rather than a nn classifier the model proposed in this study performs better than the svm lzw blast model reported inand slightly better than the nn sw p value as shown in we attribute this smaller gain in classification_performance to the short protein_sequences in dataset iii which pose a greater challenge to the three alignment_free similarity_measures examined in this study as shown in equation our model combines similarity_scores using a linear combination of vectors equivalent to calculating a weighed arithmetic mean of scores obtained with each individual similarity measure we did explore combining similarity_scores using a different multiplicative model which we found to significantly under perform in combination with the nn classifier when used on datasets presented in this study finally our approach can be easily extended to any number of additional similarity_measures such as the imms used by phymmbl that might produce additional gain in discriminatory information about sequences and thus improve the overall classification_performance therefore future work will include assessing the performance of additional similarity_measures that could be integrated into our model 
