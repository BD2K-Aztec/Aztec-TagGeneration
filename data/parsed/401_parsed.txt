a novel statistical_method for quantitative_comparison of multiple chip_seq motivation chip_seq is a powerful technology to measure the protein binding or histone_modification strength in the whole genome_scale although there are a number of methods available for single chip_seq analysis e g peak_detection rigorous statistical_method for quantitative_comparison of multiple chip_seq with the considerations of data from control experiment signal_to biological_variations and multiple factor experimental_designs is underdeveloped results in this work we develop a statistical_method to perform quantitative_comparison of multiple chip_seq and detect genomic_regions showing differential protein binding or histone_modification we first detect peaks from all datasets and then union them to form a single set of candidate_regions the read_counts from ip experiment at the candidate_regions are assumed to follow poisson_distribution the underlying poisson rates are modeled as an experiment specific function of artifacts and biological_signals we then obtain the estimated biological_signals and compare them through the hypothesis_testing procedure in a linear_model framework simulations and real_data demonstrate that the proposed method provides more accurate and robust results compared with existing ones availability_and an r software_package chipcomp is freely_available atcoupling chromatin_immunoprecipitation chip and nextgeneration_sequencing seq chip_seq is a powerful technology for profiling protein bindings or histone_modifications in the whole genome_scale since the introduction of the technology a large number of experiments were conducted to create genome_wide profiles for many dna_binding and different types of histone_modifications under various biological_contexts for example by large national consortiums such as encode and modencod the main goal of analyzing data from a single chip_seq experiment is to detect protein binding or histone_modification regions often referred to as peaks the raw_data produced from chip_seq are many short dna_segments called reads after aligning the reads to the reference_genome genomic_regions with unusually large number of reads clustered are often deemed peaks in recent_years a number of methods and software_tools are developed for peak_detection two benchmark studies have also been conducted to compare different peak_calling methods with the continuous reduction of sequencing_costs and the rapid accumulation of public data it is v c the author published_by all_rights for permissions please_e journals permissions_oup com now a common practice to compare data from different chip_seq for example to compare the binding of certain protein under different biological conditions such analysis provides important information for studying the dynamics of epigenetic regulations results from the analysis can be further associated with other data such as gene_expressions to better understand the gene_regulation mechanisms the comparisons of chip_seq have been widely performed the most straightforward method is the overlapping analysis which is to compare the peaks called from different experiments and defines common_peaks or unique peaks then represents them by venn_diagram this method however is highly dependent on the thresholds used for calling peaks genomic_regions barely over the threshold in one sample but under the threshold in the other will be declared as unique peaks even if the quantitative difference is small moreover it completely ignores the quantitative differences of peaks that is genomic_regions being peaks in both samples will be deemed common_peaks even if the quantitative difference is large due to these reasons quantitative_comparison is more desirable to compare chip_seq the quantitative_comparison of chip_seq can be performed by comparing the read_counts among different experiments which is similar to rna_seq differential_expression de analysis however it is a more complicated problem due to several reasons first the data from the ip experiments are affected by the genomic background such as chromatin structures and dna_sequence these backgrounds are non uniform across the genome and could be highly_variable across different experiments the backgrounds measured by control experiments need to be taken into account in quantitative_comparison of multiple chip_seq another complication arises from the different signal_to snrs of the experiments many technical or biological artifacts contribute to snrs for example sample with less binding_sites will have taller peaks because reads are allocated into narrower genomic_regions moreover different snrs may result from differences of antibody qualities experimental_protocols or lab technician skills etc therefore correctly accounting for snrs is important in quantitative_comparison of chip_seq in addition considerations for biological variance and experimental_designs remain similar to that in de analysis of rna_seq quantitative_comparison of chip_seq often referred to as differential_binding problem has gained some interests recently and several methods have been proposed for two condition comparison there are two methods take the approach to model the differences of normalized read_counts from two ip experiments chipdiff applies hidden_markov on the differences to identify differential histone_modification regions and dime uses a finite exponential normal mixture_model on the differences to detect differential binding_sites however neither the control experiment nor the biological_replicates are considered in these methods moreover these methods do not account for snrs and cannot be easily extended for multiple condition comparison manorm and chipnorm consider different snrs both methods normalize the data before comparison manorm performs normalization based on ma plot and chipnorm uses quantile normalization but again neither considers control data at the normalization step and these methods cannot be easily extended to handle more complicated experimental_designs there are two software_packages provide functionalities to consider the control data dbchip and diffbind both methods directly apply existing_methods and software_package developed for rna_seq de analysis they start from a list of candidate_regions which are unions of peaks called for each individual experiment these regions are then treated like genes and rna_seq de methods are directly applied for comparison to account for the control experiment the software provide option to subtract the normalized control counts from ip counts then round the differences and use them as inputs for the software there are several problems with this approach first the underlying assumption of the methods is that the background_noise and biological_signals are additive which is not always true based on our real_data observation details in later section second these methods dont consider the snrs from different experiments finally most rna_seq de methods are developed based on negative_binomial assumption of the gene counts subtracting control from ip counts then rounding will likely to violate that model assumption which lead to incorrect statistical inferences in this work we develop a comprehensive and rigorous statistical_method named chipcomp to perform quantitative_comparison of multiple chip_seq from experiments with narrow peaks including data for most of the protein binding some histone_modifications if the modification regions are narrow and the dnase_seq experiments chipcomp takes into consideration of i genomic background measured by the control data ii snrs in different experiments iii biological variances from the replicates and iv multiple factor experimental_designs we demonstrate using simulations and real_data that chipcomp provides more accurate and robust results compared with existing_methods in this work we develop a novel statistical_method to perform quantitative comparisons of multiple chip_seq and detect differential protein binding or histone_modification regions statistical_methods of differential analysis for other sequencing_data such as rna_seq have been well developed the comparison of chip_seq however is more complicated because of different background noises and snrs in distinct experiments existing_methods either ignore the data from control experiments such as manorm or dime or directly apply rna_seq methods without proper normalization such as dbchip or diffbind the proposed method describes the data by a rigorous statistical_model with the considerations of control data snrs biological_variations and general experimental_designs statistical_test procedures are developed for detecting differential regions simulation and real_data results demonstrate that chipcomp provides more accurate and robust results compared with existing_methods the essence of the method is to extract biological_signals from different experiments and then compare the process involves estimating and removing biological and technical_artifacts and normalization of the biological_signals to ensure that the estimated biological_signals are comparable across different experiments proper references are needed for normalization and put the biological_signals in a common baseline in that regard the proposed method relies on two important assumptions first the chip_seq in comparison need to have a nontrivial number of common_peaks in fact when there are very few common_peaks among datasets a simple overlapping analysis of the peak will be adequate second it is assumed that theres no global difference in the true biological_signals for the common_peaks across all datasets which is the same assumption used by manorm this assumption provides a common baseline for different datasets for comparison similar assumption has been used in de analysis for many years a majority of the genes show no de the hypothesis_test is performed based on the log biological_signals which is derived based on log counts when the counts at candidate_regions are very small this procedure could bring some biases and high variance to overcome that we added a small constant in the counts to squeeze the lower end of the log count distribution and carefully derived the variances for estimated parameters to take the raw counts into consideration a similar approach has been proposed in a recently_developed rna_seq de method voom and proved to have good performance the proposed method describes the count_data from replicated samples through a lognormal poisson_model more often these data are described by negative_binomial which is a gammapoisson compound distribution in our model the underlying poisson rate is assumed to follow a lognormal instead of gamma_distribution this is mainly motivated by methodological convenience however when the shape parameter in gamma_distribution is reasonably large the gamma and lognormal distributions become very similar simulation_results show that the results from chipcomp is robust and still provides good results when the data are from negative_binomial so we believe that our method will perform well in real_data settings the method is specifically_designed for comparison of chip_seq with short peaks including most of the protein binding data some histone_modification data and dnase_seq for histones modification data with long peaks blocks such as h_k the method is not directly applicable however the problems presented in those data are similar consideration of backgrounds different snrs biological variances etc to design method working for the quantitative_comparison of data with long peaks is our research plan in the near future 
