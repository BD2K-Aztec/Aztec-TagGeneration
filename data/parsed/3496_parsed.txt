genome_analysis pepr a peak_calling prioritization pipeline to identify consistent or differential peaks from replicated chip_seq motivation chip_seq is the standard method to identify genome_wide dna binding_sites tfs and histone_modifications there is a growing need to analyze experiments with biological_replicates especially for epigenomic experiments where variation among biological_samples can be substantial however tools that can perform group comparisons are currently lacking results we present a peak_calling prioritization pipeline pepr for identifying consistent or differential binding_sites in chip_seq with biological_replicates pepr models read_counts across the genome among biological_samples with a negative_binomial and uses a local variance estimation method ranking consistent or differential binding_sites more favorably than sites with greater_variability we compared pepr with commonly used and recently_proposed approaches on eight tf datasets and show that pepr uniquely identifies consistent regions with enriched read_counts high motif occurrence_rate and known characteristics of tf_binding based on visual_inspection for histone_modification data with broadly enriched regions pepr identified differential regions that are consistent within groups and outperformed other methods in scaling false_discovery fdr analysis availability_and chromatin_immunoprecipitation followed by massively_parallel chip_seq is the standard_technique to identify the genome_wide occurrences of transcription_factor tf_binding and histone_modifications in vivo over the past_few there has been tremendous development of analysis methods for chip_seq with tens of peak_finders published over this course several characteristics of chip_seq such as enrichment profile features peak width signal_to and location relative to genomic_features of different types of tfs and histone_modifications sources of artifacts and the commonly observed statistical distributions of read_counts have been gradually revealed as sequencing cost decreases use of biological_replicates is emerging and may eventually become the standard practice for chip_seq studies most of the encyclopedia of dna elements encode consortium data were performed in duplicate furthermore as researchers shift from performing chip_seq that address mechanistic questions to those that hypothesize differential and or contextspecific binding in a disease treatment or epidemiologic setting the use of replicates to account for individual variability becomes crucial we expect that this will lead to more analyses comparing a group of chip samples with a group of controls or two groups of chip samples with or without controls run under different experimental_conditions chip_seq peak_finders that perform direct group comparisons within the peak_calling pipeline are currently lacking when biological_replicates are available researchers may choose to combine the replicates cr in each group and run one chip versusone control analysis to identify all possible peaks alternatively they can pair chip and control samples conduct a separate analysis sa for each pair and then stipulate rules to combine the peak finding results such as requiring the peaks to be found in all pairwise_comparisons the cr approach is often used in tf chip_seq studies to identify all possible binding_sites however if the goal is to find consistent binding among replicates many false_positives may occur where binding is present in only one or a subset of the samples the sa approach is more sophisticated in the sense that it does not lose all information regarding sample tosample variability and is more applicable to experiments that have a natural pairing of samples however because it evaluates peaks for each replicate separately the effects of false_negatives across replicates may become compounded thus the sa approach is more likely to miss moderate yet consistent differences in binding when there is no inherent pairing between test and control samples as often occurs with differential_binding analyses the sa approach may call a peak because in each one versus one analysis one sample has greater enrichment than its paired sample yet if to whom correspondence should be addressed y the authors wish it to be known that in their opinion the first two authors should be regarded_as the pairs were constructed differently some peaks may no longer exist an alternative approach is the irreproducible discovery rate idr approach recommended by encode idr can be considered a sophisticated cr approach which assesses the consistency of peak rankings in replicates to find an optimum significance cutoff for determining the final peak list correctly modeling the variation among samples in gene_expression studies when testing for differential_expression has been shown to be of great_importance for rna_seq analysis several methods for example edger and deseq use a negative_binomial instead of a poisson_distribution to capture the extra variance among replicates these approaches can be used with chip_seq however they do not perform the first several steps of the chip_seq analysis_pipeline nor do they take advantage of local chromosomal information an exact negative binomial_test diffreps was recently_introduced for chip_seq and compared with edger and deseq using two histone_modification datasets other approaches to identify differential_binding with replicates include the r packages diffbind and dbchip although these programs take into account sample variation they rely on other peak callers to generate peak sets for each individual sample first and conduct analysis on the candidate_regions that fall within the peak sets here we introduce a chip_seq peak finding and prioritization pepr pipeline that can analyze either a group of chip_seq samples together with controls or compare two groups of chip_seq samples with or without controls pepr uses a sliding_window approach and models read_counts across replicates and between groups with a local negative_binomial genomic_regions with less variable read_counts across replicates are ranked more favorably than regions with greater_variability thus prioritizing consistently enriched regions we tested pepr on chip_seq for activating_transcription atf seven encode tf datasets and one histone_modification dataset h k tri methylation and compared the performance of pepr to several chip_seq methods representing different statistical_models and using different sources of information macs macs and spp with idr zinba sicer diffreps diffbind and edger we show that pepr performs favorably compared with the other tested approaches prioritizing peaks that reflect stronger enrichment fold and higher consistency among samples currently there is a lack of chip_seq analysis programs that account for biological_variability within the peak finding process we have developed a method and tool pepr which uses a local negative_binomial to identify consistent or differential binding_sites among chip_seq and that additionally estimates the optimal moving window_size and offers postprocessing steps to reduce false_positives and refine peak resolution variation among samples in chip_seq can sometimes be large such that some binding_sites even for tfs are not reproducible inconsistent tf peaks among biological_samples can exist for many reasons including differences in accessibility of chromatin_regions e g because of the histone tail modifications or dna_methylation common sequence_variants competitive or cooperative_binding differences with another tf or technical_artifacts that only occurred in one of the replicates however all but the last of these reasons are not significant concerns for most peak finder programs the goal of which is to identify all potential_binding rather than consistent or differential binding_sites in addition as public datasets from large consortiums such as encode more comprehensively cover known tf_binding in commonly used cell and tissue_types there will be less incentive for individual laboratories to identify all of the potential_binding for a protein as many will be available a more refined hypothesis may be where does this tf or histone_modification bind consistently in this specific context a specific disease developmental_stage exposure or treatment accurately modeling the variation is highly important in population epigenomics studies where substantial variation exists among samples not only among individuals but also between tissue_types developmental time points and during disease_progression we compared pepr with five commonly used single sample peak_finders that use different underlying statistical_models macs macs spp zinba and sicer as well as three programs that were designed for replicates diffreps diffbind and edger and found that pepr performed favorably in terms of consistently enriched read_counts motif occurrence_rate and known characteristics of tf_binding based on visual_inspection for comparison with macs zinba or sicer we either performed separate paired analyses and then called peaks in the overlapping regions sa or combined the reads for the replicates and called peaks from the concatenated lists cr idr was incorporated with macs and spp to determine the peak list cutoff as recommended by the encode consortium visual_inspection of the peak shape and summarizing the read_counts in peaks were extremely_valuable in characterizing the unique tendencies of each approach in particular macs was sensitive to detecting regions that had low_background and tended to miss peaks that had a relatively high background iii visual_inspection of the zinba and diffreps unique peaks revealed that many had similar peak shape in both chip and control samples spp had severe false_negatives for the nrsf data which is possibly because of the removal of true binding_sites that spp mistakenly assumed to be artifacts because of having unexpectedly small shift size i e in the phantom peak as defined in when we compared pepr with spp idr and macs idr we observed pepr unique peaks that are missed by the other two had high read_counts and motif rate although motif occurrence_rate is a useful marker for dna_binding its value as a marker for consistent or differential dna_binding is not as clear for identification of all dna_binding motif analysis is expected to be specific if the motif is found within a peak it is assumed that binding occurs but not necessarily highly_sensitive indirect binding cooperatively with other protein s may not result in a motif occurrence because the percent of binding_sites without a motif is only expected to vary by dna_binding and not by peak caller this is often ignored when comparing peak callers however for consistent or differential binding_experiments we can no longer assume specificity a peak finder that identifies fewer overall peaks with a motif than an alternative may be correct in not calling the additional peaks as consistently bound or differentially bound given these caveats we nonetheless found motif occurrence_rate informative for interpreting our results when used in conjunction with visual_inspection of peaks the large improvement in motif occurrence rates for pepr unique peaks compared with peaks identified by the sa approaches and edger basic suggests that peaks with higher read intensities and the expected smooth peak shape are more likely to contain a motif the cr approaches on the other hand were comparable in motif occurrence_rate with pepr but many of these were only bound in one replicate on visual_inspection and thus are likely false_positives for identification of consistent binding_sites in the biological system under study although pepr and edger use a similar underlying negative_binomial edger lacks initial steps_required for chip_seq peak finding shifting opposite strand reads defining and summarizing reads per window etc does not incorporate information from neighboring windows which especially benefits histone_modification analyses and does not offer post processing_steps to improve peak resolution or reduce false_positives in five of the eight tf datasets pepr performed better in motif rate than edger if the same pepr processing_steps are performed for edger with the histone data pepr was more sensitive than edger owing to estimation of the dispersion parameters locally peprs post processing_steps improved edgers performance when there is a high proportion of pcr duplicate peaks in nrsf in atf and in other datasets diffbind was previously shown to work well with differential_binding in tf data however in h_k data with broad and highly_variable peaks diffbinds edger module had low detection_power whereas its deseq module identified peaks many of which were inconsistent among samples diffreps resulted in unpredictable numbers of peaks across the datasets we tested for example it identified substantially fewer peaks than all other programs for atf and smc supplementary but many more for h_k owing to the lack of benchmarks in histone_modification datasets in this manuscript we mainly relied on tf datasets to compare methods however pepr is adaptable to datasets with either sharp or broad peaks because of its empirical estimation of the optimal sliding window_size and thus is equally relevant for analysis of histone_modification chip_seq as illustrated with our h_k data h_k tends to occur in broad regions several kilobases in length making consistent peak_calling more difficult based on our visual_inspection of peaks and scaling fdr analysis for the approaches compared we showed that pepr identified binding regions consistent between groups without being sensitive to changes in read_coverage one limitation of pepr is that it currently does not perform paired analysis similar to the limitation of multiple rna_seq differential analysis programs thus for example the paired nature of tumor and patient matched normal samples could not be taken into account for experiments requiring covariates we currently recommend edger pepr also makes the assumption that the quality of data for each chip_seq experiment is approximately_equal similar to most methods for other types of high_throughput analysis when this assumption is violated the result may be a high false_negative owing to missing peak regions in the lower_quality sample s this may especially be true for experiments with small_sample in this case users may obtain better performance using a different peak finder on individual samples and a secondary method to explore options to combine results future versions of peak_finders for replicated chip_seq could take into account quality for example by assigning a weight to each sample 
