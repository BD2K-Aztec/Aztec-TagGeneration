systems_biology complete enumeration of elementary_flux through scalable demand based subnetwork definition motivation elementary_flux analysis efma decomposes complex metabolic_network models into tractable biochemical_pathways which have been used for rational_design and analysis of metabolic and regulatory_networks however application of efma has often been limited to targeted or simplified metabolic_network representations due to computational_demands of the method results division of biological_networks into subnetworks enables the complete enumeration of elementary_flux efms for metabolic_models of a broad range of complexities including genome_scale here subnetworks are defined using serial dichotomous suppression and enforcement of flux through model reactions rules for selecting appropriate reactions to generate subnetworks are proposed and tested three test cases including both prokaryotic and eukaryotic network models verify the efficacy of these rules and demonstrate completeness and reproducibility of efm enumeration division of models into subnetworks is demand based and automated computationally_intractable subnetworks are further divided until the entire solution_space is enumerated to demonstrate the strategys scalability the splitting algorithm was implemented using an efma software_package efmtool and windows powershell on a node microsoft high_performance cluster enumeration of the efms in a genome_scale model of a diatom phaeodactylum_tricornutum identified billion efms the output represents an order of magnitude increase in efms computed compared with other published algorithms and demonstrates a scalable framework for efma of most systems availability_and extracting biologically meaningful_information from the continuously expanding omics databases is often limited by bioinformatics_tools stoichiometric modeling is one approach making advances in the quantification of metabolic phenotypes reflected by fluxomic data and inferred from metabolomic proteomic transcriptomic and genomic_data stoichiometric modeling assumes that during appropriate time scales cellular biochemistry can be approximated as a steady_state process with respect to intracellular enzyme and metabolite_concentrations this assumption simplifies the differential_equations describing cellular mass_balances and when coupled with reaction directionality and flux magnitude constraints permits the calculation of physiologically reasonable flux_distributions there are two major stoichiometric modeling_approaches with numerous subvariations one stoichiometric modeling_approach elementary_flux analysis efma enumerates all genetically_distinct indecomposable flux_distributions in a metabolic_network these elementary_flux efms are the minimal set of stoichiometrically balanced flux_distributions representable as unique binary vectors based on participation of every model reaction this set must also represent every steady_state flux distribution in a given network through non negative combinations without cancellation llaneras and pico cancellation refers to removal of reaction participation through combination of fluxes with equal but opposite magnitudes i e genetic distinction another stoichiometric modeling_approach flux_balance fba uses linear programing to identify optimal flux_distributions through a metabolic_network various objective_functions are possible including the maximization of biomass_yield from a substrate e g these two stoichiometric modeling_methods have been used for decades to direct metabolic_engineering efforts and predict physiological and ecological behaviors both stoichiometric modeling_approaches have strengths and limitations a major strength of efma is enumeration of the entire solution_space in an unbiased manner fba generates only a limited number of distinct solutions using a directed objective_function however the directed fba approach reduces computational costs relative to efma permitting examination of complex metabolic reconstructions commonly referred to as genome_scale models complex e g genome_scale and microbial_community metabolic_networks have often been intractable using efma despite to whom correspondence should be addressed algorithmic advances approaches that circumvent the problem of enumerating all efms have been explored one such approach convex basis analysis i e extreme pathway analysis_identifies a subset of efms that still reproduce any feasible steady_state flux distribution but lack the biological interpretability of the complete efm set llaneras and pico pico efforts have also been made to enumerate subsets or patterns of elementary flux vectors that allow genome_scale investigations these efforts include generating the conversion cone a simpler projection of the solution_space considering external fluxes only enumerating only efms containing the largest number of zero fluxes enumerating a set of efms that can explain a given flux distribution applying regulation to minimize computation and identifying elementary flux patterns which are efms for subsystems that consider the constraints imposed by the parent network finally computationally_intractable networks have been divided_into manageable pieces based on biochemical knowledge metabolite connectivity i e the number of reactions involving a particular metabolite path_length between reactions examination of the nullspace of the stoichiometric matrix and random_sampling of the solution_space to calculate eigenvectors that can be rotated to produce distinct reaction sets for many applications the ideal approach is an unbiased investigation of the entire solution_space although this scenario was previously out of computational reach for complex_networks llaneras and pico pico it has been proposed that otherwise infeasible efm enumerations can be performed through the dissection of metabolic_networks into simpler subnetworks via suppression or enforcement of reaction fluxes a technique referred to as splitting suppression of a reaction defines a subnetwork that does not contain the reaction whereas enforcement of a reaction defines a subnetwork that excludes efms that do not use the reaction both of which reduce the computational_burden e g complete coverage of a metabolic_networks solution_space without overlap is ensured at each split by paired suppression and enforcement of a single reaction an additional example of suppressing and enforcing can be found in jevremovict al b which used the efma algorithm elmo comp unfortunately elmo comp lacked enumeration completeness as shown through a disagreement between the presented and published efm counts the primary objective of the current study is to successfully implement a scalable demand based splitting technique for complete enumeration of all network efms the objective is achieved through i the development of rational rules for effectively splitting networks ii the successful use of a network splitting algorithm that continuously divides networks until they are computationally_tractable and iii the use of a workstationbased computational cluster to distribute efm enumeration of genome_scale models the presented work demonstrates efficacy across network models containing efm counts spanning four orders_of this algorithm is the first successful implementation of the splitting technique and establishes a scalable framework for efma of most metabolic_models the complete and reproducible efma of metabolic_networks that were previously computationally_intractable was demonstrated here through the definition of subnetworks based on serial enforcement and suppression of reaction fluxes this is in contrast to other recent attempts to parallelize efm enumeration by splitting which were found to be incomplete at times the presented basic and iterative splitting algorithms are expected to be fully compatible with that groups recent efforts to implement distributed efma computing with shared memory offering additional computing_power for recalcitrant subnetworks when using efmtool the reactions for splitting cannot contain a subset representing all non zero flux reactions in an efm enforcing such a subset causes an error the ability to identify the error by examining all subnetworks at the level of compression indicates the error is caused during preprocessing additionally manual application of the nullspace algorithm did not yield an explanation for the error the error was reproducibly avoided by identifying the subnetworks with the error and eliminating at least one of the reactions in the efm from the set of reactions for splitting this solution is algorithmically inconvenient as one of these reactions must be removed from the set of reactions for splitting and the new combination of reactions reanalyzed however subnetworks enforcing an efm cannot contain more than the defined efm as an efm cannot be represented within another efm due to the decomposability constraint the efm in an enforced reaction set can be identified through efma of the problematic reaction set a negligible computational investment by confirming enforcement of an efm to be the problem rechecking of reactions and empty subnetworks may be avoidable through early completion of the branch enforcing a complete efm and addition of the identified efm to the solution set selection_criteria were established for identifying effective reactions for splitting some of these criteria could be incorporated into a new efma algorithm examples_include i changing the representation of reversible reactions and ii changing when the algorithm networks are compressed recording reversible reactions in the original network model as separate forward and reverse reactions would allow the algorithm to define enforce suppress combinations involving currently unusable reactions thereby eliminating the need for the reversibility rule compressing networks before applying the enforce suppress subroutine would prevent the network from reconfiguring with subnetwork definition removing the need for subnetwork verification however this operational order may reduce effectiveness of subnetwork definition as some suppressed reactions result in additional combinable reactions as shown by the creation of a dead_end reaction when suppressing r inand supplementary although the likelihood of reaction rearrangement as a function of network complexity should be examined the costs of accounting for network compression effects were not prohibitive to the analysis for presented models the presented splitting approaches are subject to the availability of reactions for splitting for instance a hypothetical_model composed exclusively of reversible reactions or a model where every reaction had poorly scaled coefficients could not be analyzed with the presented approach fortunately such models are not typically biologically_relevant although all chemical_reactions are theoretically reversible many are effectively irreversible under physiologically_relevant concentrations and temperatures additionally the scaling of reaction coefficients for a metabolic model is dictated by product substrate stoichiometries of the enzymes which are often in a range that do not cause numerical instability a more practical limit would be a model that does not have enough reactions satisfying the rules into sufficiently divide the network into tractable subnetworks although such a model is theoretically possible it is hypothesized that with computational resource improvements most models will be tractable the basic splitting and iterative splitting algorithms allow for distributed computation of models through division into subnetworks microsoft hpc software permitted enumeration of the nearly billion efms in the diatom model in month using academic computer laboratories during idle hours although the total cpu time is unavoidable the real_time required to run large models can be reduced substantially based on the number and computational power of nodes for instance the most complex subnetwork in the diatom model took days of run time therefore given appropriate resources the efma could have been completed in days if the other subnetworks were concurrently run on additional nodes this highlights the lower_limits of computational time for efma of genome_scale models given current computer capabilities using the splitting algorithm and sufficient computational_resources the presented study substantially expands the applicability of efma 
