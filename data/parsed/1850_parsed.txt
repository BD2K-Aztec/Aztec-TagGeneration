data_and flowai automatic and interactive anomaly discerning tools for flow_cytometry data motivation flow_cytometry fcm is widely used in both clinical and basic_research to characterize cell_phenotypes and functions the latest fcm instruments analyze up to markers of individual cells producing high_dimensional this requires the use of the latest clustering and dimen sionality reduction techniques to automatically segregate cell sub populations in an unbiased manner however automated analyses may lead to false_discoveries due to inter sample differences in quality and properties results we present an r package flowai containing two methods to clean fcm files from un wanted events i an automatic method that adopts algorithms for the detection of anomalies and ii an interactive method with a graphical_user implemented into an r shiny application the general approach behind the two methods consists of three key_steps to check and remove suspected anomalies that derive from i abrupt changes in the flow_rate ii instability of signal acquisition and iii outliers in the lower limit and margin events in the upper_limit of the dynamic range for each file analyzed our software generates a summary of the quality_assessment from the aforementioned steps the software presented is an intuitive solution seeking to improve the results not only of manual but also and in particular of automatic_analysis on fcm data availability_and r source_code available through bioconductor http bioconduc tor org_packages flowai contacts flow_cytometry fcm is a laser based_methodology designed to capture the physical and biochemical characteristics of a cell or a particle in a stream of fluid fluorescence conjugated antibodies are used to target_antigens expressed inside or at the surface of the cells of interest as cells pass through the laser_excitation the fluorochrome will change its state of energy and emit a light_emission that is captured by a series of detectors fcm applications have been developed mainly for both research and clinical_settings in medicine but also for other non biomedical domains such as marine and plant biology the most common application is the immune phenotyping of blood_samples and thus the quantification of the number and frequency of various immune_cell in hematology fcm is the technology of choice as for example it requires only few drops of blood to diagnose leukemia through the detection of the perturbation of normal cell frequencies moreover fcm helped increase our understanding of cellular_functions of the immune system and is widely used in cell_cycle pre_transplant crossmatching cell_sorting apoptosis vaccine_development and other applications that scrutinize cellular properties the data are stored in flow_cytometry standard fcs files that include the fluorescence and scattered_light levels for each cell that passed through the laser_beams nowadays it is possible to analyze up to markers at a time in a single staining panel by using an equal number of different fluorochromes detected in separate channels the common approach used to analyze the data produced by fcm is to visually select cells of interest through or markers known to be highly_specific however to delineate the high_heterogeneity of immune_cell it is necessary to look simultaneously at the whole staining panel principal_component has been used to detect the complexity in cd t cell_populations characterized by intermediate phenotypes that show a continuum of expression of different combinations of cytokines and surface markers another dimensionality_reduction technique called t distributed stochastic neighbor embedding t sne was successfully_applied to identify ambiguous cell_populations including monocytemacrophage intermediates and granulocyte variants in a mass_cytometry experiment based on a antibody panel several computational_tools that aim to automatically characterize cell_populations without losing multi_dimensional information are constantly developed and periodically benchmarked by the flowcap consortium undoubtedly the widest range of tools has been distributed by the bioconductor platform based on the r programming_language the root package for fcm data is flowcore since it defines the container class and it enables to perform essential manipulations such as compensation and transformation in addition a series of complementary packages has been developed for further operations such as visualization quality_assessment statistical_analysis and automated gating to accompany and support the large development of automatic_methods to define populations it is crucial to use high_quality fcm data as input in order to optimize the robustness of the results this is especially true since research is looking deeper into the complexity of cell distribution for instance target cell sub populations may represent as low as of the total cell_population suggesting that minute variation in the quality of the data may lead to false_positive or loss of signal standardization calibration and quality_control guidelines using beads have been defined to ensure that the signal acquired is the most accurate and with the least variation nonetheless these procedures are not always carefully_monitored and even having the fcm instrument at optimal conditions before sample_processing does not exclude electronic drifts or fluidic instability issues at the time of data_recording an r package flowq creates concise reports of quality checks on single and multi panel experiments to highlight issues that can be encountered in data_acquisition the reports indicate the number of cells percentage of boundary events and anomalies on the fluidics and signal acquisition over time another package flowclean determines and marks low quality cells using compositional data analysis in brief it splits the time in equally sized bins and flags the events that are within time frames containing unusual ratios of cell_populations however flowq does not actively detect and remove the anomalies and flowclean is poorly intuitive and thus it does not allow to infer the source of the anomalies we present our package called flowai that provides two solutions one automatic and one interactive to discard cells from fcm data that do not reach appropriate quality_standards our workflow adapts and expands previous ideas with methods never implemented before to provide a more objective efficient and intuitive solution for the quality_control of fcm data over the last few years we have seen increasing efforts in automatizing pipelines of biomedical data analysis through computational algorithms fcm is still one technique that hardly abandons the concept of manual_analysis since usually the data produced has high variability that requires human interpretation often the analysis demands high expertise and the results are still conditioned by a subjective_evaluation our idea was born from the intention of removing the technical variability of fcm data in an objective way thus reducing subjectiveness in interpretations and improving the performance of downstream computational_analyses this is especially the case when a high number of files is analyzed and when anomalies are generated by multiple sources we defined an approach and created an r package flowai to automatically or interactively detect anomalies in fcm data first anomalous patterns and peaks are removed from the flow_rate automatically by a method built upon time series decomposition and the running time of a quality_control analysis with the automatic method of flowai the graphics creation for the full report that is fundamental for an accurate examination takes a considerable amount of time alternatively a mini report containing only the percentages of anomalies is produced without significant running time increase flowaigeneralized esd test second the tool checks the stability of the signal over time for each channel here the automatic method uses a changepoint algorithm to detect durable shifts in the mean or variance of the acquisition values lastly the dynamic range of the values acquired for each channel is refined the upper_limit is cleared of the margin events and the lower limit is cleared of the negative outliers from the use of the flowai package we expect a general improvement in the quality of research that employs fcm instruments removing events with erratic intensity values will facilitate different aspects of fcm analysis such as i more effective compensation since the overlap signal is subtracted only from real values ii more accurate detection of rare cells due to the removal of background_noise iii easier characterization of the nature of an ambiguous cell_population either as undefined cell_type or as technical issue when using the automatic method for the quality_control of a dataset of fcs files it is preferable to infer the optimal settings for a dataset using a sample of few fcs files in fact because of the intuitiveness of the flowai report it is easy to infer the source of recurrent anomalies in a fcm experiment subsequently the automatic method of flowai can be run on the entire dataset with customized settings lastly because the automatic quality_control might still not meet the expectations for certain fcs files the checking of the full reports reveals where it is necessary to intervene manually with the interactive method of flowai or with another method this last point is a limitation of flowai that could be overcome by the dynamic adjustment of the settings of the automatic method but for now it remains_an that warrants_further an additional consideration is that flowai is designed to detect anomalies within a single fcs file hence other tools are necessary to check for anomalies between batches of fcs files also another challenging_task is the designing of a complete automatic pre_processing pipeline in conclusion our quality_control approach produces a comprehensive check of the fcm data implementing algorithms never employed before we recommend the usage of flowai as a first preprocessing_step of the data right after they are obtained from the fcm instrument so that all the downstream_analyses from compensation to detection or rare cells will benefit from it 
