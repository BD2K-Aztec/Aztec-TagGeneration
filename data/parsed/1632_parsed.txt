gene_expression estimating replicate time shifts using gaussian_process motivation time course gene_expression provide_important dynamic aspects of biological_processes such as circadian_rhythms cell_cycle and organ_development in a typical microarray time course experiment measurements are obtained at each time point from multiple replicate samples accurately recovering the gene_expression from experimental_observations is made challenging by both measurement noise and variation among replicates rates of development prior work on this topic has focused on inference of expression_patterns assuming that the replicate times are synchronized we develop a statistical_approach that simultaneously infers both i the underlying hidden expression_profile for each gene as well as ii the biological time for each individual replicate our approach is based on gaussian_process gpr combined with a probabilistic_model that accounts for uncertainty about the biological development time of each replicate results we apply gpr with uncertain measurement times to a microarray_dataset of mrna_expression for the hair growth_cycle in mouse back skin predicting both profile shapes and biological times for each replicate the predicted time shifts show high consistency with independently obtained morphological estimates of relative development we also show that the method systematically reduces prediction_error on out of sample data significantly_reducing the mean squared error in a cross_validation study availability matlab_code for gpr with uncertain time shifts is available ata typical microarray time course expression dataset consists of measurements taken at a relatively small number of time points e g to where at each time point microarray measurements are obtained on a small number e g of replicate samples there has been considerable work in recent_years in bioinformatics on the development of statistical_techniques for accurately inferring expression_profiles from such data in the face of both measurement noise and biological_variation across replicates in this article we focus on a different source of variation that has received_little to date namely uncertainty about the precise biological time at which measurements were taken we are specifically interested in the case where replicates that were measured at the same time point are in fact developing at different rates and correspond to different developmental times the general intuition we pursue is that even though the underlying true expression_profiles for each gene are masked by considerable noise we can nonetheless infer time shifts for each replicate by analyzing all genes simultaneously as a motivating example in this article we use a time series dataset of mrna_expression for the hair growth_cycle in the mouse with microarray measurements for hair cycle related genes from or replicates at each of time points resulting in a total of individual mice see hair_follicles grow in repeated cycles each of which can be coarsely broken down into three phases anagen catagen and telogen these cycles have been well characterized morphologically but are understood incompletely at the molecular level time course microarray_data have been shown to be useful for automated reliable identification of hair cycle associated genes however in addition to the usual measurement noise a significant source of variability arises from the fact that each sample in the time course is taken from a different individual or replicate and since each replicate develops at a slightly different rate we can never obtain truly synchronous time points from morphological observation we find that after a few weeks replicates which are of the same age time since birth may differ in the stage of hair follicle_development by as much as days if the expression_profile is changing rapidly over time these developmental_differences can result in major discrepancies among the replicates observations leading to poor estimates of the underlying expression_patterns moreover if the time interval between successive samples is relatively small it is even possible for two replicates measured at successive time points to be in reverse_order i e the replicate measured at the later time point may be less developed than the earlier measurement illustrates this point with images from two pairs of replicates at histological_sections from the back skin of mice taken at different number of days since birth indicates a mouse that is days old and second in the set of replicates the darker somewhat vertically_oriented parts of the image correspond to hair_follicles for the pair of images in each row the younger mouse left image appears to be developmentally ahead of the older mouse right image i e the mice have reversed orders of morphological_development with respect to calender time a and b show that which is in the anagen i stage is at an earlier stage less follicle_development than in anagen i ii c and d show that the follicles in which is in the catagen i ii stage are less regressed i e are less developed compared with in catagen ii iii successive time points if the estimated profiles are disturbed by such desynchronization analysis tasks such as estimating the underlying expression_profiles and identifying periodically expressed genes become more inherently difficult these desynchronization effects have been previously discussed but not addressed in a systematic manner in existing_literature for datasets measuring multiple_modalities transcriptome and proteome for example or relatively short transient responses we may expect timing and desyncronization effects to be more pronounced and methods of coping with these effects may become critical to analysis in this article we describe a gaussian_process gpr approach that explicitly_models desynchronization effects among replicates gpr is a bayesian non linear_regression technique and has been previously applied in several contexts in bioinformatics rather than specifying predetermined shapes or other parametric assumptions such as linear or polynomial_regression gpr is a semi_parametric method that uses the data themselves to represent the function smoothed by an assumed covariance_structure since we have little if any prior_knowledge to determine what expression_patterns to expect for different genes it is reasonable to use gpr to automatically discover the shapes we note in passing that our general approach for modeling desynchronization among replicates should be generally_applicable to other statistical profile modeling_methods such as splines e g to consider replicate desynchronization we assume that each replicate has an ideal physiological age and that the expression_profile viewed with respect to the physiological age is shared across replicates the observed age is then the ideal physiological age plus a time shift due to developmental drift we model the time shift using a gaussian prior and use a maximum a posteriori map approach to estimate the time shifts and expression_patterns simultaneously we evaluate our method using the aforementioned hair cycle dataset comparing our predicted time shifts with morphological observations and also using crossvalidation to measure the predictive_accuracy of the model our experiments indicate that the time shift estimates from our model both agree with independent morphological_evidence and provide more accurate prediction of expression_profiles for out of sample replicates and genes our approach should be generally useful for reducing uncertainty and improving the quality of inferred profiles for time course microarray_data as well as more specific tasks such as analysis of differential_expression in time course data our method is substantially different from work on aligning time course datasets using techniques such as dynamic timewarping algorithms continuous time modeling of expression data by b splines and discriminative hidden_markov those approaches focus on finding an optimal matching between two sequences by aligning the time points provided that there are enough time points for matching to occur such methods however are not directly applicable to situations where each replicate is measured at only one time point as in the aforementioned hair cycle dataset in contrast the methodology we propose in this article can be applied whether each replicate is observed at a single time or at many like any method of estimating expression_profiles we assume that the signals are sufficiently smooth to be estimated from the measurements furthermore we assume that at least some signals are smooth compared with the temporal uncertainty to allow the direction and magnitude of shifts to be estimated finally we also assume that all genes are affected jointly by the time shift which could be violated if some genes are influenced by external timing effects in theory the model could be extended to include such effects our method is most similar to the general framework of total least_squares tls or error in variables eiv modeling in regression which minimizes the weighted_sum of errors on both dependent and independent_variables our model can be viewed as a gaussian_process gp version of tls or eiv we estimate the time shifts and gp parameters by optimizing equation for the microarray_data described in section and can compute the estimated profiles for each gene using equation when referring to the data we use the notation t i m to represent the m th replicate measured at the i th time point t i for example denotes the first replicate measured on the rd day shows example curves fit with and without time shifts in general the overall curve shapes are similar when estimated with and without time shifting since the remain small however time shifts can refine the pattern decrease random fluctuation and reduce uncertainty c shows three genes fit using gpr without time shifting the curves display considerable random fluctuation and fitting errors it is hard to discern meaningful patterns f fits the same genes but including time shifts the small fluctuations inc are interpreted as arising from the time shifts the estimated curves are smoother highlighting the underlying patterns and the estimated noise n is decreased the changes in estimated parameters are quantified in which shows the estimated_values of as is increased for near zero little or no time shifting occurs as increases the length_scale l also increases suggesting that the random fluctuations are decreased in the shifted data the noise n decreases indicating a better fit to the data and f increases as we explain the variations within each time point as variation across time although this could indicate overfitting we show later that time shifted profiles improve_the in cross_validation suggesting that these changes do in fact reflect the underlying_structure of the data we also see that the parameter_estimates are fairly stable across a wide_range of we can also characterize the stability of our estimate using the laplacian approximation to the posterior characterized by a covariance_matrix around the map estimate we find that the primary direction of uncertainty is an equal shift of all which yields the same expression_profiles and is thus unobservable from the data the second allows for an equal shift of replicates in days which yields very similar profiles due to the large_gap between day and day ignoring these two directions the estimates of are highly certain each with a residual posterior standard_deviation sd between and compared with a minimum day separation between measurement times it is important to note that the time shifts are optimized using the entire set of genes i e they are not optimized individually for each gene for example the circled point inf is not strongly encouraged to shift by the profile in since the expression_profile is relatively flat during that period similarly there is only a slight improvement obtained by the large time shift indicated by the arrow at datum in however if we look at the gene inand f the rightward time shift of greatly_reduces its distance from the profile strongly suggestingthat the time shift of is preferred by these and similarly shaped genes the time shifts integrate the information across all the genes and can thus reflect the relative development stage of the entire system 
