joint amalgamation of most parsimonious reconciled gene_trees motivation traditionally gene phylogenies have been reconstructed solely on the basis of molecular sequences this however often does not provide enough information to distinguish between statistically equivalent relationships to address this problem several recent methods have incorporated information on the species phylogeny in gene_tree reconstruction leading to dramatic_improvements in accuracy although probabilistic methods are able to estimate all model_parameters but are computationally_expensive parsimony methodsgenerally computationally more ef ficientrequire a prior estimate of parameters and of the statistical support results here we present the tree estimation using reconciliation tera algorithm a parsimony based species_tree aware method for gene_tree reconstruction based on a scoring_scheme combining duplication transfer and loss costs with an estimate of the sequence likelihood tera explores all reconciled gene_trees that can be amalgamated from a sample of gene_trees using a large_scale simulated dataset we demonstrate that tera achieves the same accuracy as the corresponding probabilistic_method while being faster and outperforms other parsimony based_methods in both accuracy and speed running tera on a set of homologous gene_families from complete cyanobacterial genomes we find that incorporating knowledge of the species_tree results in a two thirds reduction in the number of apparent transfer events availability_and the algorithm is implemented in our program tera which is freely_available frommolecular phylogenetics infers gene_trees based on the information contained in molecular sequences unfortunately individual sequences may contain limited signal and as a result phylogenetic_reconstruction often involves choosing between statistically equivalent or weakly distinguishable evolutionary_relationships although each homologous gene_family has its own unique story these are all related by a shared species historywhich can be helpful for gene tree_inference in the past_decade several methods have been developed that model the evolutionary_processes that generate gene_trees within the species_tree from an inference perspective these methods attempt to find the optimal way to explain the phylogenetic_signal in extant sequencesrepresented as a gene treegiven the species_tree they explore the set of possible reconciliations i e different ways to draw the gene_tree into the species_tree given some combination of macro evolutionary_events such as gene_duplications gene transfers gene losses and incomplete_lineage studies that incorporate such events into gene tree_inference have shown that information on the species phylogeny significantly_improves the accuracy of gene tree_inference to design such species_tree aware methods for reconstructing gene phylogenies the space of reconciled gene_trees must be explored using information from both a model of sequence_evolution and a reconciliation model in order to optimize a joint sequence reconciliation score such exploration is computationally_expensive with traditional optimization approaches that rely on the local_search of the space of gene_trees to circumvent this problem david and alm introduced the amalgamation algorithm described in detail in section below and illustrated in furthermore sz llo si et_al recently_developed an approach to exhaustively explore all reconciled gene_trees that can be amalgamated from a sample of gene_trees i e obtainable by combining clades observed in the sample additionally their methodale for amalgamated likelihood estimationcombines the amalgamation algorithm of david and alm with conditional clade probabilities ccps introduced by h hna and drummond and reconstructs the gene phylogenies by optimizing a joint sequence reconciliation likelihood_score resulting in gene_trees that are dramatically more accurate than those reconstructed using molecular sequences alone ale overcomes a fundamental limitation of recent parsimony based_methods that improve gene_trees given a putative species_tree unlike those methods it does not require the user to specify a cost for each type of event or a threshold on statistical supports however ale faces the drawbacks associated with probabilistic methods in particular i when computing the reconciliation score ale has an increased computational_cost compared with a parsimony algorithm e g which is due to a potentially large constant factor resulting from the numerical integration of the likelihood ii ales results are contingent on difficult to estimate time like branch_lengths of the species_tree while parsimony methods can reconcile gene_trees relying only on the order of speciations in time e g and even deal with undated species_trees e g parsimony methods in general despite lacking an explicit connection to a generative probabilistic_model and relying on other heuristics have been shown to be highly_accurate comparable to sophisticated probabilistic reconciliation methods with reduced runtime here we present the tera algorithm tree estimation using reconciliation and amalgamation that amalgamates the most parsimonious reconciled gene_tree from a set of gene_trees reconstructed from a unique gene alignment according to a joint sequence reconciliation score although tera like other parsimony based_methods requires the prior specification of the costs associated with duplication transfer and loss dtl events it does not require prior assumptions about a statistical support threshold as it estimates a self consistent support threshold from its input furthermore tera considers explicitly the possibility of transfer from extinct or unsampled branches of the species_tree which is expected to be the case for practically all transfers sz llo si et_al a tera does not however consider incomplete_lineage ccps can be used to estimate the posterior_probability of any tree that can be amalgamated from clades present in a sample of gene_trees conditional clade frequencies can be used to approximate ccps and are computed as the proportion of occurrences of a particular split of a clade according to a tripartition p e g abc j de among all trees in which the clade e g abcde is found estimates based on the sample of trees on the left are shown as fractions for two different gene_trees that can be amalgamated the estimate for a gene_tree is given by the sum of the reconciliation score and the logarithm of the tree ccps based on the sample on the left the tree with the highest posterior_probability is the third tree blue online reconciling it with the species_tree requires one transfer and one loss event it is however possible to combine clades present in the second green online and third blue online trees to produce a gene_tree that is not present in the original_sample but is identical to the species_tree i e it requires no events to draw it into the species_tree depending on the costs of transfer and loss events and the self consistently estimated c a parameter the scenario without transfer might be optimal for the joint scorethe self consistent score estimation scheme used by tera introduced in section should be applicable to other parsimony methods while amalgamation is in theory compatible with any reconciliation algorithm that assumes branches of the gene_tree to be independent to test the accuracy of gene_trees reconstructed using tera we chose a dataset based on homologous gene_families present in cyanobacterial genomes this dataset published in sz llo si et_al b was constructed using homologous families from the hogenom database and contains both real and simulated alignments as well as the gene_trees used to simulate sequences the mean number of genes per family in this dataset is the largest family has genes and the smallest genes the mean number of species in which a family is found is with a minimum of and a maximum of the mean copy_number per genomecounting as zero genomes in which a family is absentis with a minimum of and a maximum of we chose this dataset because i it contains a diverse set of gene_families from a reasonably large and divergent set of species and ii the parametric bootstrap like simulation procedure used attempts to retain as much of the complexity of the underlying biological dataset as possible sz llo si et_al b furthermore to emulate the relative complexity of real_data compared with available models of sequence_evolution we used a complex model of sequence_evolution to simulate sequencesan lg model with across site rate variation and invariant sitesand used phylobayes with a simpler modela poisson_model with no rate variationto produce the sample of gene_trees used by both tera and angst see below for more details we have presented a detailed_description of the tera algorithm a parsimony based species_tree aware method of gene_tree reconstruction we demonstrate that tera reconstructs gene_trees with nearly identical accuracy as the more complex ml based ale method and at least on the simulated_datasets considered here outperforms the other parsimony based species_tree aware methods examining a subset of single_copy universal gene_families we show that tera does not overfit or underfit the species_tree this result lends credibility to teras results on biological data whereby two thirds of apparent gene transfers in gene_trees reconstructed without taking_into the species_tree are not recovered given knowledge of the species phylogeny although parsimony based_methods are fundamentally limited in some aspects compared with model based probabilistic methods in the case of species_tree aware gene_tree reconstruction our results indicate that parsimony based_methods can closely approach their accuracy a further advantage of tera compared with the corresponding probabilistic_method ale is that it is faster if only up to a constant factor does not require explicit time like branch_lengths that are difficult to estimate and due to its relative simplicity in particular the lack of numerical integration is more robust in practice compared with parsimony based_methods that require prior assumptions about statistical support tera is distinguished by its ability to estimate a statistical support threshold from its input in contrast to the methods considered here it does require more elaborate upstream analysis taking as its input a sample of trees from e g an mcmc based tree_inference methods while in contrast mowglinni requires a single tree with branch supports and treefix dtl a multiple_sequence finally while we have shown that it is possible to estimate the c a parameter we have been less successful in estimating all four costs d s k c a simultaneously due to the tendency of the cost estimates to diverge toward a very low transfer cost and a correspondingly large number of transfers we expect that relaxing the in general unrealistic assumption of independence between events could ameliorate this problem 
