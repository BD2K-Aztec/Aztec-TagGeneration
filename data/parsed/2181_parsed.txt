genome_analysis hicnorm removing biases in hi c data via poisson_regression we propose a parametric model hicnorm to remove systematic_biases in the raw hi c contact_maps resulting in a simple fast yet accurate normalization procedure compared with the existing hi c normalization method developed by yaffe and tanay hicnorm has fewer parameters runs times_faster and achieves higher reproducibility understanding how genome is organized in three_dimensional d space inside the nucleus is of great_importance to the study of genome function harnessing the power of the massively_parallel dekker and his colleagues developed a genome_wide approach to characterize the long_range and d organization of chromosomes this technique known as hi c uses proximity ligation and high_throughput to interrogate the spatial distances between pairs of genomic_loci resulting in a matrix of pairwise contact frequencies along the genome which could be used to infer d folding of chromosomes inside the nucleus in hi c experiments the frequency of chromatin_interaction between two genomic_loci is represented by the number of paired_end linking the two genomic_sequences in principle higher read_counts indicate increased frequency of chromatin_interaction and closer spatial distances but many additional factors may also contribute to the actual read_counts observed recently yaffe and tanay reported systematic_biases inherent in these hi c read_counts including the distance between restriction_enzyme cut sites the gc_content of fragment ends and uniqueness or mappability of short_sequence these factors dramatically affect the read_counts in hi c contact_maps to remove these systematic_biases a non parametric probabilistic_model referred to hereafter as the yt approach was proposed that explicitly_models the probability of observing a paired_end spanning two fragment ends this approach can remove the majority of systematic_biases and substantially_improve the reproducibility in hi c contact_maps one limitation of the yt approach is its extremely intensive computation cost because the likelihood_function contains probabilities of observing a paired_end spanning all possible fragment end pairs in the order of the computation cost for any statistical_analysis based on such a model is overwhelming furthermore the yt approach uses step functions with unknown_parameters to approximate the joint_effect of multiple systematic_biases it is very challenging to interpret such step functions if not impossible here we propose hicnorm a greatly_simplified normalization procedure that is much less computationally_intensive hicnorm uses a generalized_linear to correct the systematic_biases in hi c contact_maps we show that in addition to being many orders_of hicnorm achieves a higher reproducibility than the yt approach on published hi c datasets we further calculated the gc_content within a bp region upstream of each fragment end gc_content feature and the mappability score within a bp region next to each fragment end mappability feature the gc_content feature and the mappability feature of each genomic locus are defined as the average of the corresponding features among all fragment ends falling into this locus supplementaryillustrated these three systematic_biases in hi c contact_maps at mb resolution level which share similar patterns to the biases at the fragment end level to remove aforementioned systematic_biases we propose hicnorm a poisson_regression for hi c contact_maps normalization supplementary_material in hicnorm we estimated the bias effects of the effective length feature and the gc_content feature while fixing the mappability feature as a poisson offset we applied hicnorm to the hi c cis_trans contact_map of each chromosome chromosome pair separately and reported the estimated biases in supplementary we observed a positive correlation between the effective length in each locus pair and the number of contacts in both hindiii dataset and ncoi dataset the gc_content feature is negatively associated with the number of contacts in the hindiii dataset and positively associated with that in the ncoi dataset noticeably the magnitude of the estimated effective length biases is significantly_larger than that of the estimated gc_content biases paired_t p value e these results suggest that the effective length is the dominant bias factor at mb resolution level and the bias owing to the gc_content is secondary we further conducted the residual analysis supplementary_material and found that hicnorm fits data well in spite of over dispersion to account for the over dispersion we also implemented a negative_binomial nb regression_model for hi c contact_maps normalization supplementary_material the nb regression_model achieved a slightly better fit to the data than the poisson_regression in terms of the akaike_information but these two models provided very similar bias reductions we therefore focused on the poisson_regression henceforth which is mathematically simpler our r package provides a choice for the user to use either the nb or the poisson_regression we used the residuals of the poisson_regression as the normalized hi c contact_maps supplementary_material for comparison the normalization results of the yt approach were downloaded from yaffes webpage http compgenomics weizmann ac il tanay page id the better normalization method achieves higher reproducibility measured by spearmans rank correlation_coefficient between the hindiii dataset and the ncoi dataset we also reported the reproducibility of raw hi c contact_maps we first calculated the spearman_correlation of the two raw hi c cis contact maps_obtained from the hindiii dataset and the ncoi dataset for each of the chromosomes chromosome and x we found that the yt approach improves the average spearman_correlation across the chromosomes from to whereas hicnorm further improves the correlation_coefficient to supplementary hicnorm achieved significantly_higher reproducibility than raw hi c reads paired_t p value e and the yt approach paired_t p value for the population of chromosomes we further evaluated the reproducibility of hi c trans contact maps_obtained from the hindiii dataset and the ncoi dataset for each chromosome pair chromosome pairs in total as the mb hi c trans contact_maps are sparse instead of measuring the reproducibility of hi c trans contact_maps directly we studied the reproducibility of two one dimensional d coverage vectors which are defined as vectors of row and column summations respectively of each hi c trans contact_map and used in yaffy and tanays study across the total d coverage vectors the average spearman_correlation of raw hi c d coverage vectors obtained from the hindiii dataset and the ncoi dataset was after normalization the correlation_coefficient was increased to highly_significant using the yt approach and further increased to using hicnorm supplementary statistically_insignificant while providing comparable reproducibility of hi c trans contact_maps with respect to the yt approach hicnorm is more robust the standard_deviations of the spearman_correlation of d coverage were and for hicnorm and the yt approach respectively supplementary as an illustrative example the spearman_correlation of the raw d coverage of chromosome using the trans contact between chromosome and chromosome was before normalization and after normalization using the yt approach but it was improved dramatically to using hicnorm supplementary due to the intensive computation requirement it was not feasible to normalize the whole_genome contact_maps with the yt approach on a computer with one single_cpu but with hicnorm it took min to make a feasible and fair comparison of the computation times of the yt approach and hicnorm we used the testing dataset published with the source_code of the yt approach downloaded from http compgenomics weizmann ac il tanay page id which is a subset of the hi c dataset used in this study cis and trans interactions of chromosome and in the ncoi dataset as the benchmark to evaluate the computation time for this testing dataset the yt approach took h s whereas hicnorm only took s i e hicnorm is times_faster than the yt approach in this work we propose hicnorm a novel normalization procedure based on poisson_regression to remove systematic_biases in hi c contact_maps compared with the yt approach hicnorm improves the reproducibility between the hi c datasets obtained from libraries prepared using different restriction_enzymes additionally because hicnorm involves a much smaller number of parameters only three parameters in hicnorm compared with parameters in the yt approach we are able to significantly reduce the computation cost the significant_improvement is made possible due to two reasons first we directly model the frequency of chromatin_interaction in the desired resolution level hi c contact_maps so as to enable sufficient data reduction at an early_stage second the hyperbola shaped contour plot of the effective length bias and the gc_content bias supplementary motivated us to adopt a parametric method to account for multiple systematic_biases which makes the inference much simpler than the non parametric method used in the yt approach we also found that increasing the model_complexity adding more interaction_terms among the features in hicnorm did not lead to further improvement in terms of the reproducibility using real_data our study confirms the critical importance of proper normalization of the hi c read map data with the increased popularity of the hi c technology in the biomedical_field hicnorm has the potential to become a convenient and powerful normalization tool for hi c data analysis 
