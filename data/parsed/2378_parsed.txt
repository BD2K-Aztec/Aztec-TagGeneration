improved synapse detection for mgrasp assisted brain_connectivity mapping motivation a new technique mammalian green_fluorescence gfp reconstitution across synaptic partners mgrasp enables mapping mammalian synaptic_connectivity with light_microscopy to characterize the locations and distribution of synapses in complex neuronal_networks visualized by mgrasp it is essential to detect mgrasp fluorescence signals with high_accuracy results we developed a fully_automatic method for detecting mgrasp labeled synapse puncta by modeling each punctum as a gaussian_distribution our method enables accurate detection even when puncta of varying size_and partially overlap the method consists of three stages blob detection by global thresholding blob separation by watershed and punctum modeling by a variational_bayesian gaussian_mixture extensive testing shows that the three stage method improved detection_accuracy markedly and especially reduces under segmentation the method provides a goodness_of score for each detected punctum allowing efficient error_detection we applied this advantage to also develop an efficient interactive method for correcting errors availability the software is available on http an important challenge in neuroscience is to map the synaptic_connectivity of neuronal_networks in mammalian brains among advanced technologies for mapping connectivity the fluorescencebased mgrasp stands as a markedly powerful_tool for comprehensive studies of synaptic circuits in mammalian brains the mgrasp technique is based on fluorescence that is reconstituted when two non fluorescent split gfp fragments targeted to the synaptic membranes in two separate neuronal_populations are closely opposed across the synaptic_cleft thus fluorescence uniquely indicates a synapse computational_methods including image stitch neuron reconstruction and synapse detection have been applied successfully to investigate the locations and distributions of synapses in dendritic compartments and in neurons labeled with mgrasp in our previous study computational_analysis for synapse detection achieved_accuracy here we introduce optimizations to improve synapse detection and other tasks detecting mgrasp labeled synapses is complicated by the low signal_to of the original images the variety of the sizes and shapes of fluorescent puncta and signal overlap from neighboring puncta to overcome these difficulties we previously applied a method based on gaussian template_matching followed by blob merging but lacking a to whom correspondence should be addressed splitting procedure this method frequently suffered from undersegmentation which is the error of counting multiple puncta as one although no other method had been developed specifically for punctum detection in mgrasp images the problem is closely_related to fluorescent particle detection e g gfp labeled peroxisomes and glut for which several methods have been published however most of these methods are not suitable for mgrasp labeled punctum detection because they cannot accommodate particles featuring a wide_range of sizes irregular shapes and degrees of overlap or they are not readily extended into three dimensions for example evaluated several d particle detection methods and found that multiscale variance stabilizing transform msvst and h dome transform based_methods offered the best performance among unsupervised methods however both these methods assume that the particles are well separated msvst takes any connected foreground feature as a particle without providing any splitting correction and h dome based method treats foreground clusters as noise neither methodwe developed a fully_automated puncta like object_detection algorithm based on distinctive morphological_features of puncta i e a punctum has a convex shape and its center is brighter than surrounding voxels marker controlled watershed is used to detect puncta with clear centers and mean shift modified vbgmms is used to separate puncta by exploiting their convex shapes simple gmms often emphasize the distribution of data the mean shift and merge procedure in post_processing can make sure that fitted gaussians not only have appropriate shapes but also have stable centers our method achieved very high_accuracy from the detection of puncta in real images parameters needed for our algorithm are intuitive and easy to choose only t m used for watershed marker selection needs to change for different application or data it represents the expected center voxel number which is proportional to average puncta size however post_processing of the detected result is necessary since our method may pick up some image_noise this procedure is relatively easy because we can compute many kinds of features for each detected punctum in our experience maximum intensity and radius are good choices for filter conditions we process our detection result by removing punctum with radii smaller than and maximum intensity less than t t is global image threshold we calculated in the binarization stage sigma is an empirical choice based on the visibility of corresponding puncta typically it is chosen from to for an bit image although only rarely we found some cases in which our algorithm did not work as expected based on our analysis of testing data we found under segmentation usually occurs when several small elongated puncta are clustered together like the position marked in since such a feature is elongated and consists of few voxels it tends to be fitted by a gaussian with an axis larger than its actual radius then mean shift uses this overestimated radius value to adjust the gaussian position which can end up in the middle of several small puncta over segmentation occurs when large saturated puncta have unusual shapes our method might separate it into several convex shapes in such cases the actual number of puncta can be hard to determine even by an expert biologist fortunately these saturated big puncta are easy to spot and can be treated_differently our method for calculating the confidence_scores of puncta can readily help us locate these problematic regions 
