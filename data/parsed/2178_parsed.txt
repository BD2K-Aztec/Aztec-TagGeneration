hhalign kbest exploring sub optimal alignments for remote homology comparative modeling motivation the hhsearch algorithm implementing a hidden_markov hmm hmm alignment_method has shown excellent alignment performance in the so_called twilight zone target template sequence_identity with however an optimal alignment by hhsearch may contain small to large errors leading to poor structure_prediction if these errors are located in important structural_elements results hhalign kbest server runs a full pipeline from the generation of suboptimal hmm hmm alignments to the evaluation of the best structural_models in the hhsearch framework it implements a novel algorithm capable of generating k best hmm hmm suboptimal alignments rather than only the optimal one for large proteins a directed_acyclic based implementation reduces drastically the memory_usage improved alignments were systematically generated among the top k suboptimal alignments to recognize them corresponding structural_models were systematically generated and evaluated with qmean score the method was benchmarked over targets from the scop database in the range of hhsearch probability of average quality of the models tm_score raised by and considering the top and top best models respectively availability_and http bioserv rpbs univ paris diderot fr services hhalign kbest source_code and server automated protein_structure has been widely used for biological_research in recent_years hhsearch is among the fastest and most accurate tool for remote_homology and targettemplate alignment by using a hidden_markov hmm pairwise alignment_method despite its high performance an optimal alignment often contains small to large errors especially in the position and length of gaps usually structural biologists correct these errors manually using back_and examination of the alignments and of the resulting structural_models this task becomes particularly tedious when target template sequence_identities are low and hampers the development of fully_automated pipelines able to generate accurate structural_models in this work we present a tool integrating suboptimal technique within the viterbi algorithm of hhsearch program to generate suboptimal alignments this interest of suboptimal exploration has previously been shown for the prediction of membrane_protein topology and in sequence hmm pairwise_alignments we first studied targets from the casp tbm dataset template_based to test the algorithms the scop database sequence_identity in the range of was then used as a benchmark to define the conditions in which the strongest increase in model accuracy could be expected from the use of the hhalignkbest server the viterbi algorithm for pair hmms of hhsearch is a hybrid between standard viterbi and pairwise alignment_algorithms and uses a dynamical programming matrix of three dimensions target hmm length noted as m template hmm length n and the number of pair state types n to obtain k best paths a natural extension is to add another dimension of length k to this three_dimensional matrix this fourth dimension stores an ordered top k scores and can be calculated by an n way merge sort efficiently this matrix based k best viterbi algorithm has both a theoretical space complexity and time complexity of o nkmn since the memory_usage limits the application of the matrixbased method we developed the directed_acyclic based algorithm based on the same principle dynamical allocation of memory is used which gives an opportunity to prune useless paths and nodes this method requires dramatically less memory while taking only slightly longer time supplementary results s and s casp sets were used to evaluate whether suboptimal alignments could correct misaligned segment s in set a targets without degrading the accuracy of nearly perfect alignments of set b we compared sub optimal alignments to a reference structural_alignment calculated from the superimposition between the template and query pdb structures using tm_align qloc score was used to report the accuracy of an alignment from to indicating from wrong to correct see supplementary method s shows an example of suboptimal alignments for a target casp set a see section where the suboptimal n qloc corrected the second beta_sheet red while n qloc corrected the first one blue perfectly in comparison with the viterbi optimal alignment qloc see details in supplementary using a procedure combining modeller to generate models for each suboptimal alignment and qmean zscore to evaluate model quality the suboptimal alignments incould be discriminated supplementary n and n led to better models with tm_score average tm_score of models for each sub optimal alignment and respectively in comparison to viterbi alignment tm_score supplementary no loss of accuracy was observed for set b supplementary to benchmark hhalign kbest pairs of models templates extracted from scop database were randomly_selected in every six ranges of hhsearch probabilities see section pairs could be a posteriori divided_into hard and easy cases depending on the tmscore of the viterbi model below or above respectively tm scores were improved by top and top for hhsearch probabilities in the range the improvements increased up to top and top for the range above there were almost no hard cases and hhalign kbest could still make minor improvements although it is not in the scope of use of the method supplementary more details about scores results analysis and server usage are provided in supplementary figures s s and supplementary discussion as a general algorithm hhalign kbest may be integrated in alternative frameworks for model generation such as m t to consider multiple_templates and with alternative evaluation scores to better recognize the best models from the top all k best suboptimal alignments k 
