benchmarking the next generation of homology inference tools downloaded from motivation over the last decades vast numbers of sequences were deposited in public_databases bioinformatics_tools allow homology and consequently functional inference for these sequences new profile_based homology_search tools have been introduced allowing reliable_detection of remote_homologs but have not been systematically benchmarked to provide such a comparison which can guide bioinformatics workflows we extend and apply our previously_developed benchmark approach to evaluate the next generation of profile based_approaches including cs blast hhsearch and phmmer in comparison with the non profile_based search tools ncbi_blast usearch ublast and fasta method we generated challenging benchmark_datasets based on protein domain_architectures within either the pfam clan scop superfamily or cath gene d domain definition schemes from each dataset homologous and non homologous protein pairs were aligned using each tool and standard performance_metrics calculated we further measured congruence of domain_architecture assignments in the three domain databases results csblast and phmmer had overall highest_accuracy fasta ublast and usearch showed large trade_offs of accuracy for speed optimization conclusion profile methods are superior at inferring remote_homologs but the difference in accuracy between methods is relatively small phmmer and csblast stand out with the highest_accuracy yet still at a reasonable computational_cost additionally we show that less than of swiss_prot protein pairs considered homologous by one database are considered non homologous by another implying that these classifications represent equivalent underlying biological_phenomena differing mostly in coverage and granularity availability_and benchmark_datasets and all scripts are placed at http sonnham mer org download homology benchmark modern_molecular relies on evolutionary_conservation of properties between entities such as genes and proteins that are homologous i e share descent from a common_ancestor as a historical property homology is unobservable but can be inferred from statistically_significant similarity under the proper conditions through homology relationships and within them specifically orthology_relationships where common_ancestry dates back to a species diversification rather than a gene_duplication insights into molecular_function of whole sequences or specific sites d structure or context such as regulation can be transferred such transfer of results from direct experimentation to the components of the vast number of genomes for which only molecular data is available courtesy of next generation nucleotide sequencing_techniques means homology inference forms a mainstay in bioinformatics_research as well as in its applications in organismal clinical and evolutionary_biology these methods started with the smithwaterman_algorithm for exact computation of the minimal number of changes needed to convert one sequence into another gradually more complex probabilistic_models were developed taking implicitly into account the structural constraints and codon properties of nucleic_acid substitutions insertions_and sequence_alignment homology_search homology scoring_methods quickly became overwhelmed by computational_complexity as database sizes increased prompting development of heuristic tools like fasta or ncbi_blast which function fast enough to screen the whole of the known sequence universe for similarity to a novel uncharacterized query with heuristic approaches come increased risk of error and given the potential importance of downstream applications such as function prediction the need becomes clear to properly evaluate the reliability of homology inference tools this is in itself not a trivial problem since such benchmarking ideally should involve a gold_standard where homology statuswhether shared common_ancestry holds or notshould be known with perfect certainty which is in principle never the case the existence of well conserved building_blocks of protein_sequence and structure as in domain gene_families where in many cases subtle sequence_similarity is supported by clearer similarity of the slower evolving protein d structure makes for a potential workaround early on a preferred benchmark was evaluating single domain_sequences from same or different structural superfamilies as a proxy for certain positive_or homology status this disregards the theoretical and practical difficulties which arise when domain rearrangement or other forms of horizontal evolution causes mosaic gene lineages where different regions have different homologs which is a complexity that the approach described here also disregards more tractable difficulties for homology inference arises either when sequences have diverged too far risk of failing to detect homology or are unexpectedly similar due to similar sequence_composition biases and or low complexity region features risk of falsely inferring homology several issues in creating benchmarking datasets have been discussed earlier low complexity regions occur relatively seldom within well characterized single domain_sequences but will occur elsewhere in proteins making single domain benchmarks underestimate the risk of false_positives in genome_scale homology inference applications to remedy this we previously described an approach for generating gold_standard test cases for homology inference by selecting pairs of multi_domain where either all corresponding domains match at the super family clan level positive gold_standard or where none of them do negative gold_standard using this approach we compared different low complexity filter settings for the ncbi_blast homology_search tool and found that compositional adjustment of score matrices allowed minimization of false_positives though sometimes at the price of truncated alignments more recent_developments in homology inference involve profile_based tools for detecting remote homologies using profilespecific score matrices pssms hidden_markov hmms or other techniques these next generation homology_search tools may offer_greater sensitivity and search speed and because of these promises the need for formal evaluation of their reliability arises consequently we expanded on our previous benchmark approach to construct an updated evaluation dataset then tested the latest versions of the next generation homology_search tools for precision accuracy and speed additionally we applied our benchmarking method to all three major domain_family databases superfamily extending scop gene d extending cath lees et_al and pfam where previously only pfam was used this was done with the intent that the similarity of benchmark results derived from different databases would provide a test of to what extent beyond differences in scope or coverage that these resources built from different types of data and using different curation protocols reflect the same underlying evolutionary entities seen through different definition schemes a question which has been raised in some recent_studies details on this set of genomes within this set of sequences for each domain database we considered each distinct protein multi domain_architecture pmda separately in the case of pfam consecutive repeat motif type domains were collapsed to a single instance as in forslund and sonnhammer because repeat numbers are highly_variable protein pairs were sampled to avoid biasing the analysis towards highly populated gene_families for each architecture one if only one exists or two proteins with that architecture were randomly_chosen from each genome in the benchmark and the set of pairs these proteins define were included aiming to ensure both within species and across species homologies at different evolutionary distance was sampled for each architecture negative test cases pairs of non homologous_proteins were sampled by choosing a protein from the architecture in question and another randomly_selected architecture meeting the criterion for non homology i e no domains shared in any order even at clan or superfamily level until there were as many negatives as positives for each pmda see supplementaryfor details on the number of pairs generated for the final benchmark_dataset for each protein pair evaluated each pair was aligned i e one protein used as database one as query using each of the profilebased homology_search tools cs blast hhsearch and phmmer as well as the non profile_based ncbi_blast usearch ublast and fasta for comparison all methods were run with default_parameters where not otherwise noted see supplementaryfor details the recently_developed delta blast was omitted because it relies on a database of sequence families aside from what is provided at runtime via query and search database input similarly tools relying on iterative searches to build intermediate profiles from additional database sequences e g psiblast or csi blast were not included since their performance depends strongly on the number of iterations and the composition of the database relative to the query making their evaluation in the present pairwise context difficult while hhsearch primarily is intended for use with multiplesequence queries here only its performance with single_sequence queries is evaluated in line with the other methods testedperformance thus might be relatively better in a context other than pairwise sequence_comparisons the score of the best high_scoring segment pair hsp reported was used with no attempt to merge together multiple hit fragments which also matches the common use cases for these tools each tool was applied using default_settings except for setting any inclusion reporting thresholds maximally inclusive so as to be able to compare scores also for non homologous pairs even so some very divergent or non homologous_sequence pairs were not reported even as very poorly scoring alignments for these pairs a maximally poor proxy score bit score was assigned when ordering pairs by score for comparisons e g receiver_operating roc in cases of multiple pairs sharing the same score either the not found proxy or otherwise positive_and cases were evenly_distributed within these stretches of pairs so as not to introduce artifacts seefor a schematic of the workflow as a whole given the role of homology inference in genome_scale biology validation and comparative benchmarking of the tools in use is important even where it is difficult in both theory and practice to a b cplots showing cumulative true and false_positive counts as tested protein pairs single_sequence query and search database for each pair are sorted based on the bit scores provided by each method the curves are ranked by corresponding area_under scores computed for the first false_positives auc results are shown based on pfam a superfamily b and gene d c these benchmarks exclude any proteins with aa regions without domain assignments supplementaryc show corresponding plots for a dataset where this constraint is removed leading to the inclusion of many more proteins with disordered_regions the here observed trends were largely replicated 
