measuring the spatial correlations of protein binding_sites motivation understanding the interactions of different dna_binding is a crucial first step toward deciphering gene regulatory_mechanism with advances of high_throughput such as chip_seq the genome_wide binding_sites of many proteins have been profiled under different biological_contexts it is of great interest to quantify the spatial correlations of the binding_sites such as their overlaps to provide information for the interactions of proteins analyses of the overlapping patterns of binding_sites have been widely performed mostly based on ad_hoc methods due to the heterogeneity and the tremendous size of the genome such methods often lead to biased even erroneous_results results in this work we discover a simpsons paradox phenomenon in assessing the genome_wide spatial_correlation of protein binding_sites leveraging information from publicly_available data we propose a testing procedure for evaluating the significance of overlapping from a pair of proteins which accounts for background artifacts and genome heterogeneity real_data demonstrate that the proposed method provide more biologically_meaningful availability_and an r package is available atunderstanding the regulatory_mechanism of gene_expression is an important goal in functional_genomics research it is widely believed that the regulation of transcriptional process involves the combinatory controls of different regulation including protein bindings histone_modification and dna_methylation dnabinding proteins such as transcription_factors tfs bind to the dna and thereby either activate or repress the expressions of nearby genes there are extensive interactions and cooperations among different dna_binding in order to provide precise gene_expression regulation the interactions among proteins can often be inferred from exploring the spatial_correlation of their binding_sites for example if the binding_sites of two proteins significantly overlap it is very likely that they interact in some manner thus exploring the spatial_correlation of binding_sites is an important first step toward understanding the interaction of proteins the genome_wide of protein binding_sites has become an easy procedure thanks to the rapid advances of high_throughput such as chip_seq with the continuous reduction of sequencing cost it has become a common task for a scientist to map the binding_sites of a few proteins under biological conditions of interest and then compare them with each other or with public data these results provide information for potential interactions and co bindings of the proteins tasks like this require methods to assess and quantify the spatial correlations of binding_sites given the binding_sites in the form of genomic_regions of two proteins it is often of interest to know whether the binding_sites significantly overlap a straightforward approach is to perform statistical_test based on a table to do so one would segment the genome into small bins such as a few hundred base paris and use a binary vector to represent the presence absence of binding for a protein then the co occurrence pattern of the two binding_sites can be represented by a table the statistical_significance of the overlaps can be assessed using pearsons v test or fishers_exact and the overlaps can be visualized by a venn diagrams unfortunately such an approach is strongly influenced by the heterogeneity and tremendous size of the genome details provided in next section as a result almost all pair_wise comparisons give significant results although constraining analysis to a smaller subset of the genomic_regions can reduce the overall genome_size and decrease the genome heterogeneity to certain degree implicitly simple procedures such as fishers exact tests targeting at limited regions still lack systematic treatment of the genome heterogeneity and fails to account for the background artifacts approaches based on distance metrics have also been proposed to measure the similarity of two lists of genomic_regions these approaches however dont consider the genome heterogeneity thus also suffering from inflated significance considering the genome heterogeneity bickel et_al developed a subsampling randomization test procedure and a software_package genome_structure correction gsc to assess the overlaps between two region lists the method assumes that the genome is block stationary and the overlapping ratios are different in each block the genome segmentation is estimated from data using a dyadic segmentation approach however the segmentation completely depends on the overlapping of the two given lists of regions and thus could provide unstable results moreover the validity of gsc relies on the assumption that the ratio of the number of segments and the total length of the genome goes to zero that requires the length of each stationary block to be very large thus the genome segmentation is rather coarse and the adjustment of genome heterogeneity is insufficient additional works on analyzing relationships of genomic_regions are available for example using multivariate hidden_markov hmm to characterize the combinatory histone patterns across the genome or assessing the reproducibility of two replicates for a single tf using a copula mixture_model these methods however are not directly applicable in assessing the strength of correlation of two lists of binding_sites in this work taking_advantage of the rich collection of public data we systematically investigate the pairwise overlapping of many protein binding_sites we discover through extensive real_data that many seemingly significant overlaps of binding_sites are actually results of phenomena in a similar flavor as the simpsons paradox we therefore propose a new method to adjust for genome heterogeneity and correct the experimental biases real_data demonstrate that our proposed_method traditional association tests in determining statistical_significance as well as providing more biological relevant ranking we first look at the distribution of the test_statistics and p values from k data a shows the qq plot of t i versus t j the lower part of the t i distribution follows the null very well the heavy tail in the upper part represents the protein pairs that exhibit significant overlaps overall the background correlation with the statistical_test procedures provide reasonable_results b shows the histogram of the resulting p values p t j t i which behave reasonably well with a spike close to and the rest approximately following a uniform_distribution finally we turn p values into q values the minimum false_discovery to call a test significant to control for multiple comparison we further assess the binding_site correlations for proteins from k and gm cell_lines in all analyses we set the cutoff t for choosing small x si as and the number of random_samples to construct the empirical null_distribution n as we apply the above procedure to all pairs of proteins to assess their spatial correlations here we discuss the results for several important proteins we first look at myc c_myc which is an important tf in cell_cycle apoptosis and cellular_transformation we calculate the correlations of myc with all the other proteins with data available from encode using different methods including our proposed method and the traditional pearsons v test we also intended to compare our results with gsc unfortunately gsc is unavailable from encode anymore thus the comparison cannot be performed provides results for all proteins where the proteins are ranked based on their association strengths with c_myc the rankings are based on v test_statistics and the proposed t i statistics respectively first results from v test indicate that all proteins are significantly overlapped with c_myc v p values are not provided since they are all very small from the proposed method however only proteins show significant_overlap with c_myc we believe that the proposed method provides more meaningful_results since it is more plausible that only a few instead of all proteins interact with c_myc we further look at the rankings of the proteins which provide_important for the degree of interactions from v test hey is the top rank tf however from our proposed method it only ranks at the th with q value becoming insignificant on the other hand the top rank tf by our proposed method is max myc associated factor x which is well known to interact with c_myc highlights the hey c_myc and maxc myc pairs in red and blue dots respectively in the scatterplots it can be seen clearly that max has substantial deviations from the adjusted expected overlaps in most segment types in contrast hey is much closer to the adjusted expected overlaps under the independence null assumption these demonstrate that it is more reasonable that max has stronger_correlation with c_myc the figures also show that the most significant correlations between max and c_myc happen at poised promoters and various enhancer regions we further explore the results for c fos results are provided in supplementary table s again v test indicates that all proteins are significantly overlapping c fos whereas the number of significant proteins is from the proposed method looking at the rank of the proteins pol c_myc and hey are ranked among the top from v test from the proposed method they rank and respectively and none of them is significant all four proteins c fos pol c_myc and hey heavily bind to the promoter_regions thus their overlaps are significant on the genome_wide scale however our results indicate that theres no statistical_evidence that these proteins have interaction or co binding we conduct literature_reviews on these proteins even though there are reports on the co appearance on these proteins no conclusive_evidence has been shown for their interactions furthermore we look at the results for ctcf an insulator binding_protein supplementary a q q plot of t i versus t j b histogram of p t j t i in addition we explore the irf protein from gm cell_line irf belongs to the irf family and is well known for combinatorially collaborations with other tfs from supplementary table s we can see that tfs overlaps with irf at false_discovery of in particular the proposed method ranks jund rather high at the third place compared to the v test at the th place and jund is recognized as a crucial_factor for irf mediated_transcription once again the proposed method offers more biologically_plausible results moreover we investigate the robustness of the proposed method to the number of tfs used to train the model for artifacts and genome heterogeneity correction we take the k data randomly sample a subset of the tfs and use these tfs to fit the model for correcting artifacts and genome heterogeneity based on the estimated model we then evaluate correlation strengths for the subsampled tfs as well as for all tfs we repeat such procedure for and tfs we find that even with only tfs the results are very similar to the one from using all tfs comparing supplementary figures s s to the observed versus corrected expected number of overlapped binding_sites and the test_statistics t si s in each segment behave well according to qq plot supplementary figs s s the ranking of tfs in terms of association with c_myc by our proposed method based on and tfs are provided in supplementary tables s and s which are very similar to the ones from using all tfs nevertheless when the number of training tfs drops to the estimation of p values becomes unstable even though the relative ranking of tfs remains similar to the ones from using more tfs supplementary tables s these results demonstrate that our proposed method will work properly even with a reasonable number of tfs on the other hand we acknowledge that more training tfs is always preferred for leveraging additional information to better model the background artifacts for real application we recommend including at least tfs into the database so that in total around tf pairs will be used to train the model the rapid accumulation of chip_seq in the public_repositories will help enhance the power of the proposed method among the chromhmm segmentation some regions such as heterochromatin are known to be less informative for assessing tf_binding because the peaks in such regions are more likely to be artifacts to investigate this we reanalyze the data by excluding the heterochromatin however results are almost identical and the ranks of tfs are exactly the same this indicates that including the less informative regions would not have much impact on the final_result thus we recommend keeping all chromhmm segment types in analysis to avoid any subjective selection of genomic_regions overall by controlling for genome heterogeneity and correcting for background artifacts the new testing procedure allows more accurate assessment of the real interaction and collaborative binding_patterns of proteins compared with traditional method such as v test our results are improved in two aspects first it provides a better ranking for the association strength with a certain protein we acknowledge however that without gold_standard the true ranking of association strengths it is very difficult to comprehensively evaluate and compare the performance of ranking nevertheless the ranks from our proposed method agree with the prior_biological better overall secondly the proposed method provides statistical_significance is more biologically_plausible this will be particularly important in experiments where only a few proteins are profiled and their relationships are evaluated and the scientists really care if the proteins have significant interaction traditional_methods provide statistically_significant results tiny p values for almost all pairs of proteins which is not plausible in this case the ability to draw better statistical_inference from our proposed method will be especially helpful in this work we focus on assessing the significance of binding_sites overlaps existing_methods mostly fail to consider the genome heterogeneity and experimental artifacts thus over estimating the correlations and exaggerate the statistical_significance by carefully exploring the real_data we discover a simpsons paradox phenomenon in the genome_wide overlapping patterns of protein binding_sites and we show that the genome heterogeneity plays an important role in the seemingly significant results from the traditional_methods we propose a new method to correct for genome heterogeneity and background overlaps and then develop a statistical_test procedure by leveraging information from historical_data in large public data repository real_data analysis shows that the proposed method provides more statistically meaningful and biologically interpretable results we want to emphasize that the idea of considering genome heterogeneity in assessing tfbs correlation is not completely_absent in literature the essence of the proposed method is similar to the one proposed in and implemented in gsc that is the genome is assumed to be block stationary and the correlations need to be evaluated at different segments of the genome the difference is that gsc relies on the binding_sites of a pair of proteins to perform genome segmentation whereas our proposed method utilize the genome segmentation provided by chromhmm the chromhmm segmentation leverages information from other data histone_modification chip_seq and provide finer more biological meaningful segments these results subsequently improve the inference in assessing binding_sites overlaps note that our method depends on the availability of chromhmm segmentation which is not always available a very recent paper chromimpute supplements chromhmm by offering an approach to impute epigenomic data and providing genome segmentation based on the imputed data we believe this method will provide a meaningful segmentation as long as there are some epigenomic data available for a given sample for biological_samples without any available epigenomic data we recommend segmenting the genome based on other existing data such as genome_annotations the genome can at least be separated into promoter exonic intronic intergenic_regions other annotations like cpg_island and repetitive_regions can also be used for better segmentation interactions among different regions can be introduced as well for example promoter_regions can be separated into gcrich and gc poor promoters we believe that finer segmentation and more genomically homogeneous segments will provide better results in assessing protein binding interaction another important point is that the data used for genome segmentation must be independent of the protein binding data so that the confounding can be eliminated our software_package provides an option for users to provide their own genome segments the proposed method operates on the peaks detected from chipseq data and the raw read_counts data are not considered we believe the correlations in the presence absence of peaks will be more robust than the correlations in read_count level which is prone to technical_artifacts one concern is that different chip_seq peak caller could potentially_affect the correlation results however we use a rather large window_size bp to define overlaps and expect the results to be robust against the choice of chip_seq peak callers using a relatively larger window_size will also include the closeness relationship because peaks spatially close to each other but not exactly overlapping could fall into the same bin and be counted as overlap the method proposed here is specifically_designed for measuring the overlaps of short peaks for longer peaks or blocks such as the peaks detected from h_k histone_modification data the method might not be directly applicable the method can potentially be applied to assess the spatial_correlation of other short genomic_features such as euchromatin island or dnase_i hypersensitive site to comprehensively reassess the spatially correlation of different genomic_features is our research plan in the near future the assumption of pairwise independence of most pairs of proteins is the fundamental of the proposed method however most is a rather loose term and we believe as long as more than half of the pairs are independent the method will work well even if the assumption is violated the final_result will be on the conservative side under estimate the significance which is more desirable than overly optimistic over estimate the significance moreover with the exponential_growth of next_generation datasets and their publicly availability the null_distribution can be updated and improved with inclusion of new data 
