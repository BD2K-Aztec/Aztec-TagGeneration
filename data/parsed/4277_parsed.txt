site heterogeneous mutation selection models within the phylobayes mpi package motivation in recent_years there has been an increasing interest in the potential of codon_substitution for a variety of applications however the computational_demands of these models have sometimes lead to the adoption of oversimplified assumptions questionable statistical_methods or a limited focus on small data_sets results here we offer a scalable message_passing based bayesian implementation of site heterogeneous codon models in the mutation selection framework our software jointly infers the global mutational parameters at the nucleotide level the branch_lengths of the tree and a dirichlet_process governing across site variation at the amino_acid level we focus on an example estimation of the distribution of selection coefficients from an alignment of several hundred sequences of the influenza pb gene and highlight the site_specific characterization enabled by such a modeling_approach finally we discuss future potential applications of the software for conducting evolutionary inferences availability_and the models are implemented within the phylobayes mpi package available at phylobayes org along with usage details in the accompanying manual there is growing interest for the use of codon_substitution in several contexts including phylogenetic_inference ancestral sequence reconstruction and the characterization of the selective effects of specific nonsynonymous mutations focusing on the latter halpern and bruno first showed how to devise a model that accounts for both global mutational features at the nucleotide level and site_specific selective constraints at the amino_acid level although their approach was directed to the estimation of evolutionary_distances it was later recognized as enabling the estimation of distributions of selection coefficients from phylogenetic data see for a review of these developments however a serious issue with the halpern and bruno model and some of the subsequent re implementations e g lies in the use of site_specific parameters optimized to maximum_likelihood such an approach induces the infinitely many parameters trap in which each additional observation changes the form of the overall model see rodrigue yang and nielsen devised some simpler homogeneous mutation selection models along with a likelihood_ratio aimed at evaluating the significance of codon_usage while statistically well justified the homogeneity of their mutationselection models makes them biologically unsatisfying for the purpose of estimating distributions of selection coefficients subsequently we proposed the use of a nonparametric approach based on the dirichlet_process providing a flexible and statistically well founded method to accommodating across site heterogeneity of amino_acid constraints however our proof_of implementation only allowed for its application on very small data_sets and its rate_limiting markov_chain mcmc updates on the dirichlet_process based on a chinese restaurant approach were not amendable to parallelization working with nucleotide_and level substitution models we recently_developed phylobayes mpi which among other speedup strategies uses message_passing mpi and a truncated stick breaking representation of the dirichlet_process for parallelized updating here we have expanded phylobayes mpi for the implementation of several types of codon_substitution including the dirichlet_process based site heterogeneous mutation selection approach we illustrate how the software can now be used for efficient estimation of distributions of selection coefficients scaled by the effective chromosomal population_size and discuss several future avenues that it enables 
