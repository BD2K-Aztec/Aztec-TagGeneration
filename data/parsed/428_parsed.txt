genetics_and a powerful and efficient set test for genetic_markers that handles confounders motivation approaches for testing sets of variants such as a set of rare or common_variants within a gene or pathway for association with complex_traits are important in particular set tests allow for aggre gation of weak signal within a set can capture interplay among variants and reduce the burden of multiple_hypothesis until now these approaches did not address confounding by family relatedness and population_structure a problem that is becoming more important as larger datasets are used to increase power results we introduce a new approach for set tests that handles confounders our model is based on the linear_mixed and uses two random effectsone to capture the set association_signal and one to capture confounders we also introduce a computational speedup for two random_effects that makes this approach feasible even for extremely_large cohorts using this model with both the likelihood_ratio and score test we find that the former yields more power while controlling type_i application of our approach to richly structured genetic_analysis data demonstrates that our method successfully corrects for population_structure and family relatedness whereas application of our method to a individual crohns_disease casecontrol cohort demonstrates that it additionally recovers genes not recoverable by univariate_analysis availability a python based library implementing our approach is available attraditional genome_wide gwas test one single_nucleotide snp at a time for association with disease overlooking interplay between snps within a gene or pathway missing weak signal that aggregates in sets of related snps and incurring a severe penalty for multiple testing more recently sets of snps have been tested jointly in a gene_set style approach and also in seeking association between rare_variants within a gene and disease as next_generation rapidly becomes the norm these set based tests complementary to single snp tests will become increasingly important however existing_methods for testing sets of snps do not handle confounding such as arises when related individuals or those of diverse ethnic_backgrounds are included in the study such confounders when not accounted for result in loss of power and spurious_associations yet it is precisely these richly structured cohorts that yield the most power for discovery of the genetic_underpinnings of complex_traits moreover such structure typically presents itself as data cohorts become larger and larger to enable the discovery of weak signals in this article we introduce a new powerful and computationally_efficient likelihood_ratio based set test that accounts for rich confounding structure we demonstrate control of type_i as well as improved power over the more traditionally used score test finally we demonstrate application of our approach to two real gwas datasets both datasets showed evidence of spurious association owing to confounders in an uncorrected analysis whereas application of our set test corrected for confounders and uncovered signal not recovered by univariate_analysis finally our test is extremely computationally_efficient owing to development of a new linear_mixed lmm algorithm also presented herein which makes possible for example set analysis of the individual wellcome_trust wtccc data several approaches have been used to jointly test_sets of snps post_hoc gene_set in which univariate p values are aggregated operator based aggregation such as collapsing of snp values multivariate_regression typically penalized and variance_component also called kernel models such as a lmms our approach is based on the lmm which can equivalently be viewed as a multivariate_regression in particular use of a lmm with a specific form of genetic_similarity matrix is equivalent to regressing those snps used to estimate genetic_similarity on the phenotype if one uses only snps to be tested in the similarity matrix as in then one is effectively performing a multivariate_regression test however by also using snps that tag confounders in a separate similarity matrix our model can additionally correct for confounders as has been done in a to whom correspondence should be addressed y the authors wish it to be known that in their opinion the first two authors should be regarded_as the author published_by this is an open_access the terms of the creative commons attribution license http creativecommons org licenses by which_permits distribution and reproduction in any medium provided the original_work single snp test gwas setting finally our approach allows one to condition on other causal_snps by way of the similarity matrix for increased power again as has been done in single snp test setting the use of lmms to correct for confounders in gwas is now widely_accepted because this approach has been shown capable of correcting for several forms of genetic_relatedness such as population_structure and family relatedness independently the use of lmms to jointly test rare_variants has become prevalent in our new approach we marry the aforementioned uses of lmms to perform set tests in the presence of confounders within a single robust and well defined statistical_model because of the aforementioned equivalence our approach can also be viewed as a form of linear_regression with two distinct sets of covariates the first set of covariates consists of snps that correct for confounders and other causal_snps i e those that predict race and relatedness for example inclusion of these snp covariates makes the data for individuals independently and identically distributed i e knowing the value of these snps induces a common distribution from which the individuals are drawn the second set of covariates consists of snps for a given set of interest such as those snps belonging to a gene we call our approach fast lmm set computing the likelihood for our modelan lmm with two random effectsis naively extremely expensive as it scales cubically with the number of individuals e g for example on the individual wtccc dataset we analyse currently available algorithms would need to compute and store in memory genetic_similarity matrices of dimension and repeatedly perform cubic operations on them to test just a single set of snpsa practically infeasible approach however extending our previous work that made lmms with a single random effect linear in the number of individuals to the two variance_component model needed here we bypass this computational bottleneck yielding a new two random_effects algorithm which is linear in the number of individuals this advance enables us to analyse datasets which could not otherwise be practically analysed such as the individual wtccc cohort the wellcome_trust case as a case in point using the navenave cubic approach to test the gene_set il r containing snps took h as compared with min for our new approach all on a single processor demonstrating a speedup factor of and significantly less memory_usage because the genetic_similarity matrix need never be computed with our approach we have developed a novel efficient approach for testing sets of genetic_markers in the presence of confounding structure such as arises from ethnic diversity and family relatedness within a cohort application of this algorithm demonstrated that our method corrects for confounders and uncovers signal not recoverable by univariate_analysis although we did not analyse rare_variant data we have shown elsewhere that the underlying lmm methodology works well to 
