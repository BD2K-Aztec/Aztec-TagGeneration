sequence_analysis comparing clustering and pre_processing in taxonomy analysis motivation massively_parallel allows for rapid sequencing of large_numbers of sequences in just a single run thus s ribo somal rna rrna amplicon_sequencing of complex microbial_communities has become possible the sequenced s rrna fragments reads are clustered into operational_taxonomic and taxo nomic categories are assigned recent_reports suggest that data pre_processing should be performed before clustering we assessed combinations of data pre_processing and clustering_algorithms on cluster accuracy for oral microbial sequence_data results the number of clusters varied up to two orders_of depending on pre_processing pre_processing using both denoising and chimera checking resulted in a number of clusters that was closest to the number of species in the mock dataset versus based on run time purity and normalized_mutual we could not identify a single best clustering_algorithm the differences in clustering accuracy among the algorithms after the same pre_processing were minor compared with the differences in accuracy among different pre_processing recent_developments in massively_parallel allow for rapid characterization of a large number of sequences in a single run s ribosomal_rna rrna amplicon_sequencing can reveal the composition of complex microbial_communities the unprecedented sequencing_depth means that even less abundant species can be detected via their sequences the taxonomic_composition of such samples may be characterized by grouping the sequence_fragments reads into clusters of operational_taxonomic otus for many often uncultivable microbes the s rrna sequences are unknown to avoid the dependency on incomplete databases microbial_community is typically determined by using a taxonomyindependent analysis tia in this approach the s rrna sequences are compared against each other without directly assigning a taxonomy to the sequence the number and size of the clusters otus indicate the diversity of the sample recent benchmark studies have revealed several clustering programs that adequately cluster into otus for this study we selected all commonly used clustering_approaches implemented in quantitative insights into microbial_ecology qiime and we also included esprit tree as it performed well in a recent comparison of clustering_methods and as well as methods that include rrna secondary_structure information recent_reports suggest that before the clustering step several data_cleaning or pre_processing steps should be performed to correct errors introduced during pyro sequencing the two most important pre_processing are denoising which corrects errors within the reads based on raw sequencing output flowgrams and chimera checking which removes chimeric sequences the aim of this study is to identify suitable combinations of pre_processing and clustering_methods for oral microbial sequence_data we used two sets of pyrosequenced reads of s rrna to evaluate cluster accuracies the first set a mock dataset had a known species_composition species supplementary the second set a clinical dataset has reads from samples of human_saliva collected in a study on the influence of candida on the composition of the oral microbiome assessing the performance of the pre_processing and clustering combinations is non trivial since no gold_standard is available for the taxonomic_composition of the samples in this work we use two strategies to assess this performance first we take a simple approach and check whether the number of clusters agrees with the expected number of species in the mock sample the taxonomic_composition of the clinical sample may be approximated by assigning a taxonomic label from a reference rrna database to each read second we assess the clusters based on labelling of sequences therefore we calculate the purity and normalized_mutual nmi scores purity scores reflect the homogeneity of a cluster if the majority of the labels in each cluster are the same the purity score is high however the purity score does not penalize for the creation of multiple clusters that contain the same label s the nmi score in addition reflects the mutual_information between the clusters and the taxonomic labels a high nmi score is achieved when high_purity is reached with a minimum number of clusters to whom correspondence should be addressed the author published_by all_rights for permissions please_e journals permissions_oup comthe accuracy of several clustering_algorithms was assessed using two test_sets of sequence_reads a mock dataset and a clinical dataset the datasets were pre processed in four ways i no cleaning nc the clustering_results were evaluated in two ways a consensus and a unique method see methods section the consensus method merges the assigned lineages to a highest shared taxonomic_level while the unique method only merges the labels here the number of unique labels in the unique set is larger than in the consensus set the clustering accuracy was measured with the purity and the nmi below the results of the clustering evaluation on the mock and clinical datasets are presented we compared different pre_processing and clustering_methods with respect to the clustering of sequences into otus the different pre_processing methods showed_clear in the number of clusters that were formed the denoised and chimera checked data formed the number of clusters that was closest to the number of species in the mock the cluster algorithms formed minimally clusters whereas species were present in the mock community in the clinical dataset we observed around clusters after denoising and chimera checking when using only one of the two pre_processing methods clusters were formed without any pre_processing the number of clusters reached beyond as with the mock community data in the clinical dataset clustering the denoised and chimera checked data performed best if the nmi and purity scores were used as the quality criterion the actual number of valid clusters in the clinical dataset is unknown based on cloning and traditional_sanger currently there are species reported that are associated with the human oral microbiome however the oral microbiome diversity is estimated to be at least an order of magnitude higher based on data from high_throughput sequencing_approaches considering the decreasing number of clusters in the mock set in relation to increasingread pre_processing and a similar trend in the reduction of number of clusters in the clinical set it is likely that the previous_estimates are at the higher end of the actual diversity we observe the same overestimation in microbial_diversity as the authors of pre clustering and denoising algorithms the differences in the nmi and purity scores for the clustering_methods are minor when compared with the differences for the pre_processing methods the uclust reference based_methods generally outperform the other methods based on the nmi score while the purity scores were also high both suggest that the uclust reference_methods are the methods of choice however it is important to note that these methods form a larger number of clusters than expected and larger than the minimal number of clusters found and use the same reference_database on which the taxonomic labels are based making such a statement too bold in general uclust and esprit tree came out top among the non reference based_methods they showed a similar performance based on purity and nmi scores while giving the lowest number of clusters a reference_database is required for chimera checking in reference mode and for uclust in the reference modes here we used a trimmed and non redundant reference which greatly_reduces run times in this study we did not use the trimmed set for training a classifier but it has been found that this improves taxonomic_classification the majority of the mock reads has been labelled with expected lineages although the mock contains species we do not expect clusters the v v regions of streptococcus mitis and streptococcus oralis are almost identical thus the expected number of clusters is at least the different clustering_algorithms returned clusters at best however of these clusters have very few members four are even singletons if we use a relaxed threshold on cluster_size of only members indeed the expected clusters remain given the relatively large number of very small_clusters we do not expect this to generalize to a clinical sample while a threshold on cluster_size is more difficult to determine for a clinical sample very small_clusters e g with less than five members could also be disregarded here o zok et_al though at the risk of underestimating diversity the determination of the microbiome based on a few hypervariable_regions of the s rrna gene makes_it to differentiate between several taxa on species level or even genus level furthermore the sequencer creates errors noise which makes it even more difficult or impossible to differentiate between related species such as streptococcus species in such cases denoising to filter out errors created by the sequencer may regard the small differences between sequences as noise thus pyrosequencing a region of s rrna can distinguish between different genera or species possibly in combination with denoising only when sequences of the related taxa differ enough it is important to note that denoising chimera checking and clustering_methods are context dependent the result for a single_read depends on the entire input_set this is specifically relevant for denoising of data from large studies since it is typically done on several input_files like in this study for example similar sequences in one file can be denoised to sequence a while in another be denoised to sequence b simply because sequence a is more dominant in the one file and sequence b in the other there was a remarkable difference in the number of reads discarded by chimera checking before and after denoising on average there was a decrease in the number of non unique reads when denoising was performed first moreover denoising which can also be seen as a pre clustering step has a huge influence on the number of clusters generated however denoising differs from the other clustering_methods as it takes flowgram data into account this potentially allows denoising to differentiate between true sequence differences and sequencing noise the results of this study and other studies suggest that it remains important to further investigate combinations of pre_processing we find that the number of otus varies between one and two orders_of depending pre_processing methods and clustering_algorithms using a single species reference escherichia_coli it was found that stringent filtering and low clustering thresholds should be applied to prevent overestimation of diversity unfiltered reads overestimated the number of otus by two orders_of with respect to technical variation pre_processing and reduction of error_rate the thorough work of schloss et_al on mock communities is interesting they also report that filtering sliding_window quality filter or denoising combined with chimera removal is required to reduce the number of otus closer to the number of expected otus even after a fold reduction in sequencing_error the number of expected otus and genera was not obtained more recently it was also recommended to remove pyrosequencing errors and chimeras before clustering while we could not identify a single best clustering_algorithm cd_hit esprit tree and uclust perform well in another study uclust also performs well and comparable to cd_hit but is outperformed by an average neighbour algorithm esprit tree an average linkage based the purity and nmi scores for the consensus and unique treatments on the clinical dataset mothur average could not be used for the nc and cc set a consensus purity b consensus nmi c unique purity and d unique nmi hierarchical clustering_algorithm was found to outperform cd_hit uclust and mothur average linkage in another benchmark study in summary we tested four pre_processing methods and multiple clustering_algorithms to cluster sequences into otus by combining these steps we assessed the influence of read filtering on clustering we showed that cleaning influences the number of otus much more when compared with the different clustering_methods the pre_processing method that resulted in the highest nmi the highest purity and the number of clusters closest to the expected number of clusters was the combination of denoising with chimera checking our results give strong evidence that without pre_processing the data contains too many errors in order for any clustering_algorithm to perform well this warrants_further in pre_processing techniques that allow for the correction of such errors as more accurate pre_processing will have a larger effect than improving current clustering techniques alternatively integrated approaches may be investigated 
