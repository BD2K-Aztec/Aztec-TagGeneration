sequence_analysis tipp taxonomic identification and phylogenetic profiling motivation abundance profiling also called phylogenetic profiling is a crucial step in understanding the diversity of a metagenomic sample and one of the basic techniques used for this is taxonomic identification of the metagenomic_reads results we present taxon identification and phylogenetic profiling tipp a new marker based taxon identification and abundance profiling_method tipp combines sate enabled phylogenetic placement a phylogenetic placement method with statistical_techniques to control the classification precision and recall and results in improved abundance profiles tipp is highly_accurate even in the presence of high indel_errors and novel genomes and matches or improves on previous_approaches including nbc motu phymmbl metaphyler and metaphlan availability_and software and supplementary_materials are available atmetagenomic studies of microbial_communities commonly generate millionsto hundreds ofmillionsofsequencingreads theassignment of accurate taxonomic labels to these sequences is a critical componentinmanyanalyses butiscomplicatedbythefactthatthemajority ofthe organisms found in environmental or host associated communities cannot be easily cultured in a laboratory and of the organisms that can be cultured an even smaller number have been sequenced even partially thus these commonly_encountered organisms are largely absent from existing databases of known genomes and genes providing taxonomic labels to metagenomic_sequences requires extrapolating the knowledge contained in sequence_databases to previously_unseen deoxyribonucleic_acid dna strings simple similarity based_approaches e g picking the best database hit as the best guess at the taxonomic label have been shown to be insufficiently accurate leading to the development of new and more sophisticated methods recently_developed improving on the simple similarity based_approaches include a composition based_approaches that rely on various machine_learning support_vector in phylopythia and phylopythias interpolated markov_models in phymm bayesian_models in nbc or neural_networks to classify sequences based on their dna composition usually based on the frequency of short k_mers b more sophisticated analyses of similarity_search results e g using lowest_common aggregation in megan or classifiers built from similarity_search results as done in metaphyler metaphlan and motu or protein_profiles in carma and c combinations of multiple approaches e g composition and similarity based_approaches in phymmbl some of these approaches e g most of the composition based_approaches can be applied to any dna_sequence however others are specific to a reference collection of carefully_selected genes e g metaphyler metaphlan and motu use a collection of universal or cladespecific marker_genes and so are called marker based_methods abundance profiling also called phylogenetic profiling seeks to estimate the relative_abundance of the species or genera or families etc within a sequence_dataset while many methods produce these estimates by characterizing most or all of the sequences in the dataset marker based_methods produce these estimates by characterizing only those sequences that match the marker_genes they rely on the marker_genes used by some of these methods e g metaphyler and motu are supposed to be single_copy and universal thus the estimates produced using such markers can be used for profiling without needing to correct for copy_number or missing_data we present taxon identification and phylogenetic profiling tipp a new marker based method for taxon identification and abundance profiling we explore tipp for abundance profiling using metaphylers collection of marker_genes but tipp can be used with any single_copy gene for which a dense enough sample of full_length sequences is available tipp is implemented in python and can be run on unix and mac experiment easy datasets our first experiment explored datasets with low_error coming from known genomes on the long_read easy datasets motu had generally poor_performance supplementary and also failed to run on some of these datasets terminated with an error message see supplementary section s we therefore omit motu from the long_read results shows the average hellinger distances on the easy datasets figures and tables for individual_datasets can be found in supplementary section s results on the long_read datasets left subfigure show that tipp had the best overall accuracy followed by nbc metaphlan was in third place in terms of overall performance though metaphyler was more accurate than metaphlan at the class level finally phymmbl was theall easy datasets easy short_read datasets excluding metaphlan datasets experiment errors in abundance profile estimates on easy datasets we show average hellinger distance for different methods on simulated metagenome datasets containing known genomes and query_sequences with low rates of sequencing_error seefor list of datasets we omit motu from the long_read results because it failed to complete on the facs hc and webcarma datasets results are shown for a all datasets and b easy short_read datasets after excluding the metaphlan datasets thus on webcarma illumina and facs hc illumina datasets see section s for results on individual_datasets least accurate on these data on the short_read datasets right subfigure results were somewhat different first while motu had poor_performance on the long_read datasets motu had the best overall accuracy of all methods on the short_read datasets at the species level metaphlan tied with motu for first place followed by tipp and then nbc at the genus level motu had the best accuracy but tipp and metaphlan were very close seconds results at the family through class levels showed tipp and motu tying for first with metaphlan in third place finally at the phylum level tipp metaphlan metaphyler and motu tied for first with much better accuracy than nbc or phymmbl because metaphlan was trained on its datasets we removed metaphlans datasets and re evaluated performance on this reduced set metaphlan tied for first at the species level slightly less accurate than motu but equal to tipp but was much less accurate than tipp at all other levels tipp had the best overall performance on these data though it tied for first with motu at the genus level and tied for first with phymmbl at the phylum level experiment datasets with known genomes and high rates of indel_errors shows the average performance of different methods on datasets with known genomes and simulated with high rates of indel_errors we omit results for motu because it terminated with error messages on all these datasets see supplementary section s we also omit results for metaphlan metaphyler and nbc on the long_read datasets as they estimated taxonomic profiles that were completely unclassified on some of the long_read datasets on the long_read datasets left subfigure only tipp and phymmbl successfully ran on all the datasets other methods either terminated early or could not classify fragments on some of the datasets tipp had the best accuracy of all methods at all taxonomic_levels phymmbl was the next best method on the short_read datasets right subfigure metaphlan and tipp had the best results with metaphlan more accurate than tipp at the species level but the two methods generally having indistinguishable performance at the other levels phymmbl had the least accurate results of all methods followed by nbc shows results for datasets with little to no indel_errors and the bottom row shows results for datasets with high rates of indel_errors insertion and deletion errors per base the left column shows results for datasets containing long_reads and the right column shows results for datasets containing short_reads see section s for results on individual_datasets experiment error in abundance profiles for datasets with known genomes and high indel error_rates we show average hellinger distance for different methods on simulated metagenome datasets with known genomes and simulated with indel_errors we omit motu from the results because it failed to complete on any of these datasets we omit metaphlan metaphyler and nbc from the long_read datasets as they could not classify any reads from at least one of the following datasets webcarma metaphlan facs hc nbc and metaphyler and fames lc metaphyler see section s for results on individual_datasets tipp characterized very few reads see supplementary finally phymmbl was clearly more accurate than metaphlan which was more accurate then nbc on the short_read novel genome datasets right column tipp and metaphyler were distinctly more accurate than all other methods for both easy datasets and high indel datasets with tipp slightly more accurate in the presence of high indels and metaphyler slightly more accurate on the easy datasets the performance of motu was interesting on the easy short_read novel genome datasets motu was very close to phymmbl but slightly less accurate however motu failed to complete on the high indel short_read datasets terminated with an error message see supplementary section s the other methods were largely indistinguishable from each other but much less accurate than both tipp and metaphyler the study compared four marker based_methods motu tipp metaphyler and metaphlan and two composition based_methods phymmbl and nbc on a collection of datasets on the easy datasets with only known genomes experiment many methods produced highly_accurate abundance profiles although which method was the best depended on the read_length on the easy short_read datasets the most accurate methods were motu metaphlan and tipp while the most accurate methods on the easy long_read datasets were tipp and nbc with metaphlan a close third however when datasets had novel genomes or high indel error_rates the performance of most methods degraded significantly for example while nbc had excellent accuracy on the easy long_read datasets it had poor accuracy in the presence of high indel rates similarly although motu had excellent accuracy on easy short_read datasets with known genomes it had poor_performance on short_read datasets with novel genomes and terminated with an error message on the datasets with high indel rates we also saw that metaphyler had difficulties on datasets with long_sequences and high indels experiments and tipp did well on the easy datasets known genomes with low sequencing_error where it tied for first with other methods however tipp was the only method that was robust to all the tested model conditions short versus long_reads novel versus known genomes low indel versus high indel error_rates so that it was either first or tied for first under even very difficult conditions novel genomes with high indel rates consequently tipp dominated the other methods in terms of overall performance thus one of the main features of tipp is its relative robustness to sequencing_errors both substitutions and indels and its ability to perform well on novel genomes we conjecture that the hmm family technique within tipp provides this robustness which uses hmms in a divide_and framework and also benefits from the use of local alignment_techniques therefore the high_error commonly_encountered in single_molecule sequencing_technologies up to indel rate for pacific_biosciences technologies that are likely to be increasingly used in the context of metagenomic_data may not be particularly problematic for tipp even when the data contain novel genomes instead our results indicate that tipp may well continue to have good accuracy with new sequencing_technologies that result in reduced data_quality one of the interesting observations in this study is that the marker based_methods tipp metaphlan motu and metaphyler often gave more accurate abundance profiles than the composition based_methods nbc and phymmbl even though marker based_methods estimate abundance profiles by characterizing only those reads that map to their selected marker_genes these results show that accurate profiles can be obtained by taxonomic characterization of only a fraction of the query_sequences however the choice of marker_genes and the technique used to bin the reads to the markers has an impact on the resultant abundance profile thus future_research whether improved_performance can be obtained using a different set of marker_genes and different techniques to map reads to the marker_genes also our abundance profile estimates were based on combining all reads for all markers into one set and using the distribution estimated for that set more sophisticated techniques could be used to combine distributions estimated for each marker 
