structural_bioinformatics automated bond_order assignment as an optimization_problem motivation numerous applications in computational_biology process molecular_structures and hence strongly rely not only on correct atomic_coordinates but also on correct bond_order information for proteins and nucleic_acids bond orders can be easily deduced but this does not hold for other types of molecules like ligands for ligands bond_order information is not always provided in molecular databases and thus a variety of approaches tackling this problem have been developed in this work we extend an ansatz proposed by wang et_al that assigns connectivity based penalty scores and tries to heuristically approximate its optimum in this work we present three efficient and exact solvers for the problem replacing the heuristic approximation scheme of the original approach an a an ilp and an fixed parameter approach fpt approach results we implemented and evaluated the original implementation our a ilp and fpt formulation on the mmff validation suite and the kegg drug database we show the benefit of computing exact solutions of the penalty minimization problem and the additional gain when computing all optimal or even suboptimal solutions we close with a detailed comparison of our methods availability the a and ilp solution are integrated into the open_source c lgpl library ball and the molecular_visualization and modelling tool ballview and can be downloaded from our homepage www ball project org the fpt implementation can be downloaded fromcorrect bond_order information is essential for many algorithms in computational_structural and theoretical chemistry since bonds do not only define the connectivity of atoms in a molecule but also define structural_aspects like rotatability of individual parts however bond_order information can often not be directly inferred from the available experimental_data even important molecular databases like the protein_data pdb and the cambridge structural database are known to contain erroneous data for connectivity and bond to whom correspondence should be addressed order information or to even omit them entirely for proteins and nucleic_acids bond orders can be easily deduced due to their building_block nature but this does not hold for other kinds of molecules like ligands the problem is made much worse by the fact that quite often the bond_order assignment for a given molecule is not unique even when neglecting symmetries in the molecule the chemical reasons for this effect are complex and out of scope of this work here we just want to state that the concept of integer bond orders is only an approximation to a full quantum_chemical treatment and cannot explain all effects occurring in molecules important examples are aromatic or delocalized bonds leading to different resonance structures cf in addition formal charges are often not contained in the input_files but atoms carrying a formal charge will obviously show a different bonding pattern one body of opinion tries to overcome these obstacles by hand curation which clearly provides the highest reliability on the other hand manual data curation does not scale well to large_numbers of molecules and it does not help in conditions where modifications are systematically applied to molecules e g in computational combinatorial_chemistry in the past_decades the problem of assigning bond orders automatically has been addressed by a number of different approaches early methods in the field strongly rely on the correctness of atomic_coordinates and focus on reference bond_lengths and valence angles or additionally consider functional_group detection and further molecular_features like hybridization states and charges the main drawbacks of those approaches are the dependence on correct atomic_coordinates and the algorithms heuristic nature in contrast exact solvers proposed previously represent the bond_order assignment problem as a maximum weighted matching for non bipartite graphs or as an integer_linear problem that generates valid lewis structures electron dot structures with minimal formal charge on each atom recently have presented an elegant novel approach to the problem which is implemented in the established antechamber package a suite of tools used for the preparation of input structures for molecular_mechanics studies in this approach a chemically motivated expert generated penalty function is used to score bond_order assignments this function is then heuristically optimized however this procedure has two drawbacks the score of a resulting assignment is not guaranteed to be optimal and the algorithm provides only one solution while there can be more than one assignment with optimal score exemplarily top different co optimal bond_order assignments in the left structure both nh_groups are connected via a single_bond and thus freely rotatable in the middle and right structure one group is connected via a double_bond bottom heuristic and optimal bond_order assignments the left structure is the solution provided by antechamber with a tps of its ring does not fulfill the aromaticity criterion of am bcc the right structure is the solution computed with our exact solvers its tps is and the ring meets the am bcc aromaticity criterion shows two cases where theses two drawbacks may lead to a wrong interpretation of molecular_properties flexibility and aromaticity unfortunately the optimization_problem introduced byis np_hard in this work we propose three exact approaches that solve the problem to provable global optimality by discrete optimization techniques we give an integer_linear ipl formulation and an a approach and a fixedparameter algorithm for enumerating all optimal or if desired all feasible solutions in addition our approach can easily be extended to e g include structural_information add missing hydrogens or even missing bonds the a and ilp solution are integrated into the opensource c lgpl library ball and the molecular_visualization and modelling tool ballview and can be downloaded from our homepage www ball project org the fpt implementation can be downloaded from http bio informatik unijena de software for proteins and dna bond orders can be simply inferred by matching the given state to a database containing the bond orders for all amino_acids and nucleotides hence we focus the evaluation of our algorithms on small_and molecules for instance drug like molecules such molecules can be found in large_numbers in several established ligand databases such as zinc astex kegg ligand and kegg drug the mmff validation suite or the cambridge structural database but evaluating the correctness of our bond_order algorithms poses certain constraints we need ligand structures that contain not only the connectivity_information but also preassigned bond orders and explicit hydrogens as a further requirement aromatic bonds should be given in kekulized form i e replaced by a suitable pattern of single and double_bonds in contrast to structure based bond assignment approaches however we can use databases that contain d ligand structures as well as those only storing structure diagrams or smiles expressions to provide a diverse test_dataset fulfilling those constraints we chose the mmff validation suite and the kegg drug database to provide our ground_truth the mmff validation suite provides small drug like molecules mainly derived from the cambridge structural database the molecules were thoroughly prepared by the authors of the mmff force_field by assigning bond orders adding hydrogens where valences had to be completed and minimizing the resulting complexes the mmff validation suite was originally designed to test the mmff force_field and thus yields a diverse set of molecules with hand curated connectivity_information hydrogens and bond_order assignment and d positions that we found very reasonable for testing bond_order perception the kegg drug database provided by the kanehisa laboratories offers a remarkable number of drug like molecules for diverse applications in bioinformatics the atoms molecular coordinates are d which is suitable for representation by structure diagrams but is unsuited for structure based bond_order assignment as performed by most of the former approaches it thus represents a perfect test scenario for bond_order assignment from topology alone unfortunately hydrogens are missing in the kegg data bases and were added for our tests using standard rules for completing free valences as performed by openbabel furthermore files of the kegg drug set contain more than one molecule and each molecule may appear in more than one file to prevent a skewed analysis we split up the dataset into unique connected components ignoring molecules with less than four atoms e g water this preparation led to a test_set of molecules from the kegg drug set in section we compare the total penalty score tps of the results of our exact solvers with that of the results of the original antechamber approach in section we compare the results of the different approaches to the expert generated hand crafted reference assignments and study the implications of the ambiguity of two or more co optimal solutions all algorithmsa ilp fpt and antechamberare applied to the two test_sets such as mmff and kegg drug computing all optimal solutions for all molecules of the mmff dataset the total running time was s for the ilp s for the a algorithm and s for the fpt algorithm the antechamber heuristic took s to compute one solution for all molecules cf supplementary_material all reported running_times were averaged over repetitions thus the ability to provide all optimal exact solutions and to use user editable smarts strings for penalty class assignment takes its toll the heuristic antechamber approach is the fastest of the methods about an order of magnitude faster than ilp and a still all running_times are sufficiently small to allow the routine usage in high_throughput applications automated bond_order assignment is an important problem when working with user generated molecules molecular databases or computational combinatorial_chemistry especially fully_automated pipelines in high_throughput applications depend on reliable bond_order assignments the modern and extensible approach realized in antechamber is based on sound chemical principles and has proven to be a very valuable_tool in this work we have shown three different exact solvers as alternatives to the heuristic approach pursued by an a algorithm an ilp formulation and a fixed parameter approach while we found in our evaluations that the heuristic solver works surprisingly wellroughly of all cases in our testsit still can be significantly_improved using exact techniques if we keep in mind that bond_order assignments are in many cases non uniquedifferent resonance structures for instance might have the same probability to occurthe ability to systematically enumerate all solutions becomes an invaluable tool when bond_order assignments are important it might be worthwhile to enumerate all optimal assignments run whatever procedure is supposed to work with the results in the next step and average over the results comparing the three different exact strategies each of them has its advantages_and if computational_efficiency is required the best choice is clearly the fpt where running_times are almost on par with the antechamber heuristic the a algorithm on the other hand is even simpler to implement than the heuristic and can be very easily extended through the heuristic cost_function both approaches can compute co optimal 
