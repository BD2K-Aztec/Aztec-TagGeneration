metabolic_network guided binning of metagenomic sequence_fragments motivation most microbes on earth have never been grown in a laboratory and can only be studied through dna_sequences environmental dna_sequence samples are complex_mixtures of fragments from many different species often unknown there is a pressing need for methods that can reliably reconstruct genomes from complex metagenomic_samples in order to address questions in ecology bioremediation and human_health results we present the sorting by network completion sonec approach for assigning reactions to incomplete metabolic_networks based on a metabolite connectivity score we successfully demonstrate proof_of in a set of genome_scale reconstructions and delineate the variables that impact reaction assignment accuracy we further demonstrate the integration of sonec with existing_approaches such as cross sample scaffold abundance profile clustering on a set of metagenomic_samples from the human_microbiome we show that not only does sonec aid in reconstructing species level genomes but it also improves functional_predictions made with the resulting metabolic_networks availability_and the datasets and code presented in this work are available at https bitbucket org mattbiggs sorting by network completion most microbes cannot be cultured using existing techniques it is possible to interrogate this vast world of unculturables by analysis of dna from environmental_samples metagenomics is a burgeoning field and databases are accumulating trillions of bases of dna_sequence from complex environmental_samples these dna_fragments contain information about new and interesting microbes many approaches for analyzing such complex_mixtures of dna_fragments seek to catalog the families of genes contained in the community metagenome and how those families of genes change over time other approaches seek to assign dna_fragments to known taxonomic_groups what is more difficult is the assignment of dna fragmentsgenes in particularto yet undiscovered parent genomes and as a result discovering the context in which those genes operate the goal is not only to know that a given gene exists within the community but to know also to which species that gene belongs what other genes that species has what metabolic_capacity that species presents the regulatory_network that controls those genes and so on answers to these questions will advance efforts to discover new pathogens industrially relevant microbes and drivers of global geo chemical cycles recent_advances in reconstructing species level genomes from metagenomic_samples have relied on several sources of information nucleotide patterns that differentiate species such as g c content and tetranucleotide frequencies taxonomic_assignment based on similar known genomes and differential scaffold abundance across multiple samples the best approaches to date use all of these sources of information to extract high_quality species or strain specific genomes while the best current approaches have demonstrated the ability to extract hundreds of genomes from a complex community such as the human_gut they still leave a third of the available dna_fragments unassigned we propose a new orthogonal source of information that can be used to further improve species genome reconstruction in conjunction with existing_approaches metabolic_networks are assumed to be effectively complete i e gapless this assumption of network completeness is a physiological equivalent of the law of conservation of mass that is that mass drawn into a cell must eventually leave or be integrated into biomass thus real metabolic_networks do not contain dead_end metabolitesreaction substrates or products that are exclusively consumed or produced this fact can be leveraged in the assignment of metagenomic fragments to species bins given a set of bins containing genetic fragments formed using orthogonal sources of information as described above and a set of unassigned fragments a metabolic_network can be reconstructed based on the gene content of each bin and new fragments assigned to these bins based on a metabolite connectivity metric the underlying assumption driving this approach is that genetic fragments containing metabolic genes will tend to fill gaps in the correct host metabolic_network and will be less likely to fill gaps in a foreign network to which they do not belong we refer to this approach as sorting by network completion sonec we present proof_of results from the successful application of this method using a set of genome_scale reconstructions furthermore we demonstrate the application of this approach to metagenomic_samples from the human_microbiome these computational_experiments highlight the utility of this novel method and delineate the sensitivity to variables that impact practical_applications here we present the sonec approach for the assignment of metabolic_reactions and as an extension metagenomic sequence_fragments annotated with metabolic genes back to a parent metabolic_network this work is motivated by the fact that current approaches are still unable to group complete metagenomic_samples into member genomes leaving in a recent study of metagenomic sequence_fragments unaccounted for we propose that information about the metabolic_network can be used to improve metagenomic fragment binning it is commonly assumed that metabolic_networks are gapless and gap_filling of metabolic_network reconstructions is used regularly as a source of new biological_knowledge krumholz and libourel however by adding them the network_structure changed in such a way as to make some previously essential reactions non essential and vice_versa one possible explanation for this improvement is that sonec assigns reactions in a relatively unbiased way based on metabolite connectivity compared to traditional gap_filling which adds reactions to allow flux through a biomass function future applications which require functional_predictions of the impact of genome_engineering or drug_targeting within microbial_communities can benefit from sonec in the end the goal of sonec is to improve the reconstruction of individual_genomes from metagenomic_data more complete_genomes will improve any downstream_analyses future work may improve assignment accuracy by modifying the metabolite connectivity score the example in supplementalhighlights a weakness of the metabolite connectivity score wherein two models may contain a single dead_end metabolite that overlaps with a reaction but depending on whether it is a substrate or product the final gap score may be different maintaining the ratios in the metabolite connectivity score is prudent from a parsimony standpoint because they ensure that the smallest reaction with the fewest participating metabolites that can fill a gap will be used however future work could explore alternative metabolite connectivity scores that address the weaknesses with the scoring framework presented here one possibility would be to penalize the addition of new metabolites that do not exist in the network which would have improved the outcome for the false_positive example in supplemental this may prohibit filling larger gaps consisting of more than one reaction or filling gaps in less complete networks another approach is to apply a global optimization based gap fill algorithm based on existing_methods we chose not to pursue this approach because it would be sensitive to the choice of optimization function and exchange constraints which are difficult to determine for uncharacterized microbes in complex_environments enrichment_analysis highlights the families of reactions that tend to provide better assignment accuracy supplemental the underlying driver may be that reactions that contain uncommon metabolites are more likely to be assigned to the correct parent network within the selection of prokaryotic reconstructions used here porphyrin and chlorophyll metabolism are uncommon given this hypothesis future work may improve assignment accuracy by selectively weighting reactions that are unique within the environment being studied for example in the anterior nares dataset explored here the rarest pathways include lipoic_acid metabolism inositol metabolism and caprolactam degradation to improve group_assignment accuracy metabolite connectivity scores corresponding to reactions from these rare subsystems would be weighted more heavily as they would be expected to increase accuracy disproportionately to demonstrate how the sonec approach can be applied to real metagenomic_data we analyzed metagenomic_samples sourced from the human anterior nares it is important to note that these samples were not sequenced very deeply and as a result the n we could achieve after assembly was quite low bp as a comparison a recent study assembled dna_fragments from stool_samples to achieve an n of more than bp this observation simply indicates that in applications with deeper sequencing contigs will tend to be much longer knowing that larger group sizewhich is a function of longer contigsimproves sonec performance it is likely that sonec performance will improve with deeper sequencing and more complete assembly while it is clear that the performance of sonec is highly dependent on the existing_tools used to create the initial bins 
