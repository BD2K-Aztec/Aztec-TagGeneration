gene_expression a hierarchical_model of transcriptional dynamics allows robust estimation of transcription_rates in populations of single cells with variable gene_copy motivation cis_regulatory dna sequence_elements such as enhan cers and silencers function to control the spatial and temporal expression of their target_genes although the overall levels of gene_expression in large cell_populations seem to be precisely controlled transcription of individual genes in single cells is extremely variable in real_time it is therefore important to understand how these cis_regulatory function to dynamically control transcription at single_cell resolution recently statistical_methods have been proposed to back calculate the rates involved in mrna_transcription using parameter_estimation of a mathematical_model of transcription and translation however a major_complication in these approaches is that some of the parameters particularly those corresponding to the gene_copy and transcription_rate cannot be distinguished therefore these methods cannot be used when the copy_number is unknown results here we develop a hierarchical_bayesian to estimate biokinetic parameters from live_cell enhancerpromoter reporter measurements performed on a population of single cells this allows us to investigate transcriptional dynamics when the copy_number is variable across the population we validate our method using synthetic data and then apply it to quantify the function of two known developmental enhancers in real_time and in single cells availability supporting_information is submitted with the article the rate of transcription of rna_polymerase transcribed genes is determined by interactions between general transcription_factors assembled at the core_promoter and sequence specific transcription_factors bound to cis_regulatory dna_sequences such as enhancers experiments in cell_populations have suggested that enhancers function either as rheostats by increasing the rate of transcription_initiation from a promoter in a graded manner or as on off switches increasing the proportion of cells transcribing a gene without affecting the rate however recent_studies that even though gene_expression levels seem to be precise when averaged over a large population of cells the process of transcription in individual cells is stochastic a mammalian gene has intermittent random bursts of expression in a single_cell separated by refractory periods of inactivity with the kinetics of this process varying widely between genes this results in variability in protein expression both within individual cells and between cells in a population although the kinetics of transcription has been studied in single cells the ability of enhancers to regulate_transcription at single_cell resolution remains_poorly studies with stable cell_lines containing integrated luminescent and fluorescent reporters have been used to measure fine_scale dynamics of transcription this approach could in theory be used for large_scale analyses of enhancer_function but transient_transfection is more amenable because of the numbers of constructs involved however transient_transfection has a major disadvantage in that the variation in copy_number makes the reliability of any quantification problematic it is therefore of considerable interest to provide a method that can deal with copy_number and estimate transcription_rates using transient_transfection to address this problem we have developed a hierarchical_bayesian to estimate transcriptional dynamics in single cells and we have used it to gain a more detailed understanding of cis_regulatory enhancer_function our hierarchical_model builds on previous_models of gene_transcription and uses the linear noise approximation to establish a likelihood_function that enables us to estimate the model_parameters using markov_chain mcmc this forms the first layer of the hierarchical_structure of the model and incorporates the variation within an to whom correspondence should be addressed we have presented a method of extracting comparable transcription_rates from populations of single cells with variable copy_number and validated it on synthetic datasets previously all single_cell analysis would have been performed on a population of cells with a known copy_number as this unknown variable renders any robust analysis of transcription intractable with our method constructed under the assumption that the rates involved in transcription are drawn from a statistical_distribution we can decouple the processes involved in transcription allowing the estimation of values relative to each other as such this method is especially suited to the analysis of a large number of cells transiently_transfected with a suitable reporter protein this removes the significant overhead of constructing a stable cell_line with fixed copy_number for each construct hence it facilitates large_scale investigations of transcriptional output although in this study the algorithm was run on all the cell data at once the nature of the hierarchical distribution means that the copy_number translation rate and other distributions can be used as a fixed prior in subsequent analysis hence comparison between separate runs will still be valid also if experiments were undertaken to investigate the nature of these distributions the hierarchical_model would provide a framework in which this information could be incorporated into the estimation procedure however care must be taken to ensure that there is no reason to believe that the distributions will be different in the separate experiments another strength of this hierarchical procedure is that it is inherently flexible and could potentially be used to answer a number of other biological_questions such as how certain stimuli affect the transcription of a gene in a population of cells the form of the hierarchical distributions can be chosen to fit the investigation and it would even be possible to incorporate mixtures of distributions or a class allocation methodology if the application warranted it furthermore the model can easily be extended to incorporate oscillatory systems such as the nf b system without requiring a full mathematical_model of the entire network this is because the likelihood for each individual cell is fundamentally based on a changepoint model therefore we can model oscillations by the addition of more changepoints similar to the non hierarchical_model in we applied this method to data gathered from live_cell to investigate how the enhancer_function of two known cis_regulatory affects transcription_rates in cell_populations our results confirmed and extended findings based on bulk cell measurements namely that the presence of these enhancers leads to increased transcription_rates but we were also able to investigate how each individual cell contributes to the output our results indicated a lower fold_change than results obtained using bulk cell measurements with the luciferase_reporter taining the promoter only top left the proximal enhancer top right and the distal enhancer bottom estimated using the full hierarchical_model the coloured bars represent the distribution of the markov_chain estimates for that cell in which a high_probability mass corresponds to a light colour ranging to a dark colour for low_probability mass population level relative transcription_rate mean standard_deviation and coefficient of variation estimated for each promoter constructnote the above the statistic denotes those obtained directly from the hierarchical distribution and the above the statistic denotes that the population statistics are calculated from the mean values of the individual mcmc estimate these values are conditional on the common copy_number distribution and do not represent the absolute transcription_rates all units are arbitrary however these experiments are unlikely to be directly comparable as we use a fluorescent_reporter and specifically measure differences in active_transcription in our algorithm whereas the previous test measured luminescence at a single time point regardless of transcriptional_activity at that time using our method we were able to establish that these enhancers do not engender increased transcription_rates across all cells but act to substantially_increase transcription_rates in a proportion of the population this implies that transcription of a gene is not always affected by the presence of an enhancer but those that are affected transcribe at a higher rate this may be because the transcription_factors that interact with an enhancer may not be present or active in every cell therefore transcription occurs at a similar level as when the enhancer is not present furthermore by analysing the single_cell estimates we can distinguish between a binary and graded_response to the enhancer module and provide a more detailed_description of cis_regulatory function our data show that both the proxenh and distenh increase transcription_rates in a graded fashion in the responding cells i e in the proportion of cells that have a higher transcription_rate than the promoter alone it will be of interest to test using a range of enhancers whether the proportion of responding cells is modulated by enhancer strength these insights into the nature of transcriptional_regulation would be difficult to uncover without recourse to single_cell analysis our hierarchical_model enables studies of systems involving intricate transcriptional dynamics and can easily be extended to large_scale investigations by accounting for uncontrolled reporter_gene copy_numbers inherent in transient_transfections the approach can feasibly be expanded to systematically measure the activity of several hundred cis_regulatory promoter reporter variants in parallel and infer gene regulatory logic undertaking very high_throughput studies similar to 
