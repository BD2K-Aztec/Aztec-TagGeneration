gene_expression fast and efficient qtl mapper for thousands of molecular_phenotypes motivation in order to discover quantitative_trait multi_dimensional genomic_datasets combining dna_seq and chip rna_seq require methods that rapidly correlate tens_of of molecular_phenotypes with millions of genetic_variants while appropriately controlling for multiple testing results we have developed fastqtl a method that implements a popular cis qtl_mapping strategy in a user and cluster friendly tool fastqtl also proposes an efficient permutation procedure to control for multiple testing the outcome of permutations is modeled using beta distributions trained from a few permutations and from which adjusted p values can be estimated at any level of significance with little computational_cost the geuvadis gtex pilot datasets can be now easily analyzed an order of magnitude faster than previous_approaches availability_and source_code binaries and comprehensive documentation of fastqtl are freely_available to download at http fastqtl sourceforge net genome_wide have shown that most common trait associated variants fall into non coding genomic_regions and likely alter gene_regulation this has motivated large_scale studies to catalog candidate regulatory variants quantitative_trait qtls associated with various molecular_phenotypes i e quantitative molecular traits with a genomic location across various populations cell and tissue_types mapping qtls in this context usually consists of finding statistically_significant associations between phenotype quantifications and nearby genetic_variants task commonly undertaken using linear_regressions alternative_approaches have also been developed to increase discovery power by accounting for confounding_factors integrating functional_annotations leveraging allelic_imbalance van_de or aggregating measurements across multiple tissues in practice this requires millions of association tests in order to scan all possible phenotype variant pairs in cis i e variants located within a specific window around a phenotype resulting in millions of nominal p values matrix_eqtl has recently_emerged as a gold_standard for this task by taking_advantage of efficient matrix v c the author published_by to perform a comprehensive evaluation of fastqtl we used rnaseq and genotype data produced by both the geuvadis supplementary_material and the gtex consortia supplementary_material two of the largest eqtl studies performed to date this comprises a total of distinct datasets with between and k quantified genes and m variant sites for samples supplementary in the context of this study the two parameters of the beta_distribution k and n can be interpreted as the rank of the associated variant and the effective number of independent_tests performed in cis respectively we looked at the ml estimate distributions of these parameters across all genes in the geuv eur dataset and find first that parameter k values tend to center around in line with what is expected for the top variant second we find that the parameter n values show high dispersion and are consistently smaller than the actual number of variants being tested in cis both suggesting that the beta_distribution captures well the redundancies between variants a consequence of ld this also highlights the importance of performing permutations instead of using a bonferroni_correction based on the number of variants which would result in a substantial_proportion of false_negative then we checked whether the null p values coming from permutations are beta distributed again in the geuv eur dataset to do so we stored for each phenotype the best p values obtained from permutations as observations estimated k and n by ml from the resulting p values simulated p values from the newly parameterized beta_distribution as expectations and compared both observations and expectations to assess theirbonferroni significance threshold when testing genes goodness_of visually qq plots and statistically one sample kolmogorovsmirnov test overall we find very high degrees of concordance between results both when pooling all genes together and also when looking at each gene individually we only find that the beta_distribution is not a good fit for two genes out of the tested these discrepancies are likely due to the stochastic_nature of the simulations made in step all this shows that the beta_distribution is a good fit for the smallest null p values generated via permutations and therefore a good candidate to model the permutation process outcome we next checked that the adjusted p values produced via beta approximation are well calibrated by comparing them to those directly derived from a large number of permutations we find a very good concordance on the full p value range with some deviations within the expected sampling_variation range supplementary of note the beta approximation provides small adjusted p values that are better calibrated than those provided by the direct method supplementaryand d and sometimes not even accessible i e below the lower_bound implied by the number of permutations the smallest adjusted p value estimated using the geuv eur dataset is in the order of supplementary therefore we subsequently estimated the number of permutations that the direct method needs to reach the same level of calibration as the beta approximation at various significance_levels to do so we binned the adjusted p values obtained from beta approximations and estimated for each bin by exhaustive_search the number of permutations required by the direct method to match the same sampling_variation supplementary_material we find that this number drastically increases as small adjusted p values are targeted for instance beta approximations made from permutations give adjusted p values of as accurately as the direct approach with k permutations then we looked at the downstream impact of the beta approximation on qtl discovery to do so we first generated an optimal fdr eqtl set for geuv eur by running permutations and then measured the sensitivity_specificity ratios of reasonable fastqtl configurations to recover this optimal set specifically we run from to permutations using either the beta approximation or the direct method to compute adjusted p values we find that using permutations allows us to approximate well the optimal set we also find that the beta approximation does consistently better than the direct method for the same number of permutations especially when few permutations are used or as a consequence using permutations with the beta approximation for example has the same accuracy to recover the optimal set as thefast and efficient qtl mapperdirect method using permutations interestingly the beta approximation using only permutations already does very well at recovering the optimal eqtl set finally we investigated the speed and accuracy with which matrix_eqtl direct method and fastqtl beta approximation using and permutations could reproduce the outcome of the pilot_phase of gtex a large_scale eqtl_mapping study of note we run matrix_eqtl in the most highly_effective setting we could achieve in order to fully utilize its matrix based design supplementary_material overall we find that both fastqtl and matrix_eqtl recapitulate the official eqtl set well especially as the number of permutations increases for the same number of permutations we find that the closest eqtl set to the official one is consistently provided by fastqtl again it also performs well even when only permutations are used to fit the beta distributions to process all nine datasets with permutations fastqtl requires cpu hours which is times_faster than running the same number of permutations with matrix_eqtl when using only permutations this is reduced to only cpu hours we present fastqtl a qtl mapper in cis for molecular_phenotypes that implements a new permutation scheme to accurately and rapidly correct for multiple testing at both the genotype and phenotype levels fastqtl has several advantages compared with existing_methods making it the ideal candidate to map qtls for the coming wave of large_scale datasets regrouping many different layers of molecular_phenotypes and near complete collection of variant sites first permutations are modeled with a beta_distribution parameterized from a relatively small number of permutations this results in accurate adjusted p values which could not be feasibly obtained by standard or adaptive permutation analysis for example down to in the geuvadis dataset in practice having well calibrated adjusted p values on the full range is of crucial importance to estimate the number of tests made under the null quantity underlying efficient fdr correction methods and to metaanalyze multiple qtl studies together second the beta approximation behaves well enough with only permutations to rapidly assess the impact on the analysis of important parameters such as cis window_size and covariates like the number of peer factors and finally fastqtl is fast faster than matrix_eqtl for the same number of permutations due to an efficient implementation of linear_regressions optimized c code efficient permutation schemes and rapid data_retrieval from indexed files while remaining user and cluster friendly to summarize fastqtl provides better adjusted p values than the best method so_far matrix_eqtl with a direct permutation scheme while being significantly_faster in addition fastqtl also provides a modular base onto which new functionalities are being implemented such as fine_mapping of causal_variants conditional analysis to discover multiple independent qtls per phenotype and interaction analysis to discover sex or disease specific qtls 
