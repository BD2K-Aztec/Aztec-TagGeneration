prediction of missing sequences and branch_lengths in phylogenomic data motivation the presence of missing_data in large_scale phylogenomic datasets has negative effects on the phylogenetic_inference process one effect that is caused by alignments with missing per gene or per partition sequences is that the inferred phylogenies may exhibit extremely_long branch_lengths we investigate if statistically predicting missing sequences for organisms by using information from genes partitions that have data for these organisms alleviates the problem and improves phylogenetic accuracy results we present several algorithms for correcting excessively long branch_lengths induced by missing_data we also present methods for predicting imputing missing sequence_data we evaluate our algorithms by systematically removing sequence_data from three empirical and simulated alignments we then compare the maximum_likelihood trees inferred from the gappy alignments and on the alignments with predicted sequence_data to the trees inferred from the original complete datasets the datasets with predicted sequences showed one to two orders_of more accurate branch_lengths compared to the branch_lengths of the trees inferred from the alignments with missing_data however prediction did not affect the rf distances between the trees availability_and https github com ddarriba foreseqsat present typical large_scale phylogenomic datasets are assembled by concatenating several genes of the organisms under study such phylogenomic datasets often contain a high proportion of systematically missing_data this is because specific gene sequences might not be available for certain taxa e g pcr_amplification failed for these genes or taxa do not contain the specific gene such phylogenomic datasets are also called patchy or gappy alignments in likelihood_based models the missing per gene sequences are typically represented by undetermined characters throughout this manuscript we refer to user_defined subsets of alignment sites e g genes as partitions we further assume that all relevant likelihood model_parameters gtr rates a branch_lengths are estimated optimized independently also known as unlinked parameters for each partition the presence of missing_data has two notable effects on the phylogenetic_inference process first depending on the structure of the missing_data blocks and under certain model parameter configurations most importantly unlinked branch_lengths gappy datasets can give rise to so_called terraces in tree space v c the author published_by all_rights for permissions please_e journals permissions_oup com a terrace in tree space contains a set of distinct tree_topologies that have exactly the same likelihood_score second entirely missing_data for a subset of taxa in a partition can generate extremely_long branch_lengths this effect is more pronounced when data is systematically instead of randomly throughout the tree missing for an entire subtree here we address the latter problem that is we introduce and evaluate methods for correcting these artificially long branches given a partitioned alignment and a fixed tree e g the best scoring maximum_likelihood tree we present assess and make available two algorithms for this purpose branch length stealing and sequence prediction imputation since there is no data available for inferring branch_lengths in a subtree that only comprises missing_data for a specific partition we first need to estimate or approximate these branch_lengths we can do this by using information present in other partitions that have data for the specific subtree we call this process branch length stealing once we have stolen the branch_lengths for a missing_data subtree in a partition we deploy a stochastic approach to map mutations to branches thereby we can predict the missing sequence_data by using the phylogenetic likelihood model as a predictive generating process based on marginal ancestral probability vectors mapv note that given an ancestral sequence aactcg and a simple jukes cantor model of nucleotide_substitution a descendant sequence attccg has exactly the same distance to the ancestral sequence as tactaa since sequence imputation is a randomized stochastic procedure the simulation should ideally be carried_out several times to obtain a sufficiently_large sample of possible outcomes we can determine the stability of the prediction and also detect potential outliers by comparing the trees inferred from the different predicted replicates to each other we presented a method and a tool for predicting missing_data in partitioned datasets we described two procedures for approximating stealing the branch_lengths of bipartitions with missing_data using empirical and synthetic datasets we designed realistic test scenarios to evaluate our methods the stealing and prediction_methods yield significant improvements in branch length accuracy of ml trees compared to trees inferred from msas with missing_data the bs differences calculated between the trees inferred from the predicted alignments and the reference trees were one to two orders_of smaller than for the trees inferred from the alignments with missing_data we find that branch stealing contributes by far the most to improving branch length estimates by example of the ptp species_delimitation tool we demonstrate that branch stealing can substantially_improve the accuracy of a phylogenetic post analysis sequence prediction can be omitted when one only needs to correct branch_lengths for missing_data as we show sequence prediction can be useful for estimating statistical_properties of the missing sequences such as for instance their gc_content overall for small fractions of missing_data predictions using mapvs yielded slightly better results than predictions based on discrete ancestral sequences nevertheless predictions based on discrete ancestral sequences outperformed the mapv based strategy in most of our tests finally we observed that predicting sequences is generally difficult for alignments that contain a high amount of true alignment gaps that are treated as missing_data in all standard likelihood implementations while we observed an improvement in bs differences when using prediction compared to alignments with missing_data the average and the variance of the bs increased proportionally to the amount of true alignment gaps in the reference alignments also note that prediction cannot correct incorrect topologies that have been inferred from alignments with missing_data however despite the fact that previous_studies that missing_data can strongly bias phylogenetic inferences there is an ongoing_debate regarding the topological impact of missing_data concluded for instance that missing_data might not be an issue for correctly placing taxa with incomplete_data into a given reference tree 
