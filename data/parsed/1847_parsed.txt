gene_expression flexible analysis of rna_seq using mixed_effects motivation most methods for estimating differential_expression from rna_seq are based on statistics that compare normalized read_counts between treatment classes unfortunately reads are in general too short to be mapped unambiguously to features of interest such as genes isoforms or haplotype specific isoforms there are methods for estimating expression levels that account for this source of ambiguity however the uncertainty is not generally accounted for in downstream_analysis of gene_expression experiments moreover at the individual transcript_level it can sometimes be too large to allow useful comparisons between treatment groups results in this article we make two proposals that improve the power specificity and versatility of expression analysis using rna_seq first we present a bayesian_method for model_selection that accounts for read_mapping ambiguities using random_effects this polytomous model_selection approach can be used to identify many interesting patterns of gene_expression and is not confined to detecting differential_expression between two groups for illustration we use our method to detect imprinting different types of regulatory divergence in cis and in trans and differential isoform usage but many other applications are possible second we present a novel collapsing algorithm for grouping transcripts into inferential units that exploits the posterior correlation between transcript_expression the aggregate expression levels of these units can be estimated with useful levels of uncertainty our algorithm can improve the precision of expression estimates when uncertainty is large with only a small reduction in biological resolution availability_and we have implemented our software in the mmdiff and mmcollapse multithreaded c programs as part of the open_source mmseq package available on https github com eturro mmseq high_throughput of rna rna_seq is superseding microarrays as the standard technology for genome_wide of rna samples and for differential_expression rna_seq is a technique for generating millions of short subsequences called reads from a population of rna_transcripts in a biological_sample roughly speaking the number of reads generated by a transcript is proportional to its length and to the number of copies of the transcript in the sample consequently given an accurate mapping of reads back to transcripts e g from sequence_alignments it is possible to quantify transcript_expression from read_counts sequencing offers greater dynamic range than microarrays and by providing direct observations of complementary dna_sequences it allows improved discrimination among isoforms and haplotypes although the methodological literature for gene_expression with microarray_data is mature there remain aspects of rna_seq that require further development in particular the principal approaches currently used for differential_expression with rna_seq make comparisons between treatment classes using statistics derived from sequence_alignment counts such approaches are useful for assessing differential_gene because for most genes an exact read_count can be obtained that is proportional to its expression_level however methods based on read_counts are not robust to variability in the relative expression of isoforms because the length of each isoformnot only its expression levelinfluences the expected number of gene level read_counts it can be more accurate to estimate expression at the gene level by adding up estimates made at the transcript_level than by counting raw alignments as though each gene produced a single transcript of canonical length a distinct advantage of rna_seq is that sequencing along splice_junctions and heterozygous loci facilitates the estimation of expression levels for gene isoforms and even haplotype specific isoforms in polyploid organisms at the isoform level raw counts are not available because the sharing of exons between isoforms of the same gene means that reads may align to multiple_transcripts moreover sequence_homology between genes can result in reads that map to transcripts belonging to different genes for haplotype specific analysis sequence sharing is even more extreme as only reads mapping to heterozygous loci allow transcripts from different haplotypes to be distinguished deconvolution algorithms which account for the read_mapping ambiguity can provide estimates of the expression levels of each transcript and estimates of the associated uncertainties given the large_amounts of to whom correspondence should be addressed sequence sharing between transcripts in mammalian transcriptomes these uncertainties can be considerable and highly_variable consequently it is important to account for differential uncertainty in any statistical_analysis based on expression estimates e g when comparing expression levels between treatment groups this idea has been pursued previously in the context of microarray_analysis e g but has received less attention in the context of rna_seq analysis the cuffdiff software implements frequentist hypothesis_tests to detect differential_expression and regulation the methods rely on a number of distributional approximations are limited to two class comparisons and cannot be used for haplotype specific inference recently a bayesian_model of markov_chain mcmc traces for expression parameters has been proposed that is attractive because it accounts for the shape of the posterior uncertainties in the parameters however it too is limited to a two condition study_design and relies on a computationally_intensive read level algorithm to generate the mcmc traces the work we have presented can be applied to a wide_range of problems in the study of gene_expression thanks to two important features first due to the linear mixed regression_framework we are able to model many different patterns of expression we have shown for example how the framework can be used to detect imprinting in mice second by using posterior summaries of expression as the outcomes in our regression_models rather than alignment counts we are able to apply our methods in cases where counts are not readily available such as haplotype specific and isoform specific analyses we have described earlier in the text how transformation of expression proportion variables to the probit scale allows us to detect differential isoform usage crucially having demonstrated that posterior uncertainty in expression estimates may be large and heteroscedastic we have shown that accounting for this uncertainty can improve precision and sensitivity ordinarily a different method would be applied to comparisons of expression intensities at different levels of granularity for example standard gene_expression might be based on comparisons of genome alignment counts allelespecific expression analyses might compare counts on a heterozygote by heterozygote basis and splicing analyses might compare counts on a splice_junction by splice_junction basis it is difficult to integrate the results of such varied kinds of analyses to make inference returning to the mouse dataset mentioned earlier in the text we have shown how our method can be used to perform a differential_expression between the two strains in the pure strain parents together with a differential_expression between the two strains in the first generation crosses i e between haplotypes our model can straightforwardly accommodate both types of analysis producing comparable posterior_probabilities more generally our model_selection method can be applied universally to any arbitrary collection of features through aggregation of joint posterior distributions analyses could be performed at the gene haplo gene isoform haplo isoform exon and untranslated_region utr level to name a few applying a single method of inference across comparison types to an rna_seq dataset in the latter example it would be possible to detect changes in utr usage between treatment groups simply by collapsing isoforms sharing the same utr start sites finally we have shown how polytomous classification can be performed effectively when more than two models are postulated for the data which is often the case in studies of gene_expression 
