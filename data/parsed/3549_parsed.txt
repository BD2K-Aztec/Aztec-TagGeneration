sequence_analysis phylogeny based classification of microbial_communities motivation next_generation coupled with metagenomics has led to the rapid_growth of sequence_databases and enabled a new branch of microbiology called comparative_metagenomics comparative metagenomic_analysis studies compositional patterns within and between different environments providing a deep insight into the structure and function of complex microbial_communities it is a fast_growing field that requires the development of novel supervised_learning techniques for addressing challenges associated with meta genomic_data e g sensitivity to the choice of sequence_similarity cutoff used to define operational_taxonomic otus high_dimensionality and sparsity of the data and so forth on the other hand the natural properties of microbial_community data may provide useful information about the structure of the data for example similarity between species encoded by a phylogenetic_tree captures the relationship between otus and may be useful for the analysis of complex microbial datasets where the diversity_patterns comprise features at multiple taxonomic_levels even though some of the challenges have been addressed by learning algorithms in the literature none of the available methods take advantage of the inherent_properties of metagenomic_data results we proposed a novel supervised classification_method for microbial_community samples where each sample is represented as a set of otu frequencies which takes_advantage of the natural structure in microbial_community data encoded by a phylogenetic_tree this model allows us to take advantage of environment specific compositional patterns that may contain features at multiple granularity levels our method is based on the multinomial_logistic with a tree guided penalty function additionally we proposed a new simulation framework for generating s ribosomal_rna gene read_counts that may be useful in comparative_metagenomics research our experimental_results on simulated_and show that the phylogenetic_information used in our method improves the classification_accuracy availability_and the diversity of the microbial world had been hidden from the eyes of scientists until the advent of metagenomics despite the vital roles of microbes in our planets ecology evolution and human_health large populations of bacteria remain_poorly because the majority of bacterial_species have not been successfully cultivated the metagenomics approach has offered a remedy bypassing the need for isolation and cultivation all the sequences present in an environmental sample are sequenced simultaneously making it possible to access the genetic_information of otherwise hidden organisms the field of metagenomics has further been advanced by the recent improvements in dna_sequencing that allow millions of reads to be produced at a high_speed and affordable costs deep_sequencing allows for a high_resolution detection of rare_species and provides an insight into phylogenetic composition and functional_diversity of complex microbial_populations with many lowabundance species along with the ability to access the genomes of rare_species next_generation have also led to the rapid increase in the number and sizes of metagenomic sequencing_projects exponential_growth of sequence_data has enabled comparative_analysis of microbial_communities leading to a new branch of microbiology called comparative_metagenomics comparative_analysis extends insights into the structure and function of microbial_communities it may help to identify community specific properties of different environments as well as discriminative properties between different conditions and to determine how microbial_community is affected by specific environmental changes comparative_metagenomics has broad implications for various fields of environmental science and human_biology it may help to address the intriguing question of identifiability of a core human_microbiome to understand the relationship between human_microbiome and health and to study how microbial_composition and function vary between distinct body sites and across the human population comparative_analysis has already led to the discovery of three major enterotypes associated with the human_gut and the differences between lean and obese_individuals microbial_communities can be compared at the levels of sequence_composition taxonomic diversity or functional potential taxonomic diversity provides detailed evolutionary_information regarding the community_composition and therefore has been a focus of many environmental and human studies to access the taxonomic_composition of a microbial_community genomic to whom correspondence should be addressed the author published_by all_rights for permissions please_e journals permissions_oup com sample both single marker gene sequencing and whole community shotgun_sequencing are widely used the s ribosomal_rna gene or s ribosomal_dna rdna is a commonly used marker for bacterial_identification due to its universal distribution among all bacterial_species and a slow_rate of sequence_evolution to reduce the dimensionality of large sequence_datasets generated by high_throughput of s rdnas the reads are clustered into operational_taxonomic otus that roughly represent taxa at phylogenetic levels defined by a user_defined sequence_similarity cutoff the abundance of each otu is defined as the number of sequences in the otu representative sequences from each otu are chosen and used to assign taxonomy to the otus and to construct phylogenetic_trees packages such as qiime and mothur provide integrated pipelines for the analysis described earlier in the text the whole_genome i e metagenomics approach can also be used to study microbial_community it offers a more global view of the community but may not be deep enough to detect rare_species in a sample and is sensitive to the dna_extraction and sequencing protocols even though the two approaches may not always lead to the same conclusions about the community_structure they became standard_tools in microbial_community in this article we will focus on samples based on the sequencing of s rdnas although our proposed method can be easily extended to metagenomic_samples based on whole_genome for s rdna datasets each sample is represented as a list of otus and their frequencies we will refer to these lists as feature_vectors a feature_vector corresponds to one microbial community_sample and the vectors elements features characterize otu frequencies in the sample the evolutionary_relationship between all of the otus is captured by a phylogenetic_tree the downstream_analysis may involve the identification of compositional patterns across samples from similar environments as well as discriminatory features between different communities associations between human bacterial_communities and disease_phenotypes prediction of unknown labels for new samples and so forth these tasks require the development of new supervised_learning techniques that would take into consideration challenges associated with microbial_community data for example features defined by otus do not necessarily represent specific taxonomic units because taxonomic_levels are hard to define due to the fact that only relatively a small number of bacteria have been cultured moreover it is hard to determine which taxonomic resolution level provides features with the best discriminative or predictive properties the environment specific patterns may even comprise different lineages at varying phylogenetic depth finally a low overlap in species between samples results in sparse and high_dimensional feature_vectors the problem of classification of microbial_communities is not well studied even though classification_techniques have been widely used in the field of bioinformatics including classification of microarray cancer samples gene_expression protein_families and so forth classification of metagenomic or s rdna samples may have useful applications enabling efficient organization and search in rapidly_growing metagenomic or s rdna databases detection of disease_phenotypes in clinical samples and forensic identification one of the first applications of supervised_learning techniques to comparative_metagenomics was the classification of soil and sediment_samples according to environment types using support_vector svm and k nearest_neighbors algorithms recently the feasibility of applying standard supervised classification_techniques to metagenomic s rdna data was studied on several benchmark_datasets of human_microbiota metadistance is the first dedicated algorithm for multiclass classification of human_microbiota the algorithm combines the advantages of instance based and model based_methods such as k nearest_neighbors and svm the aforementioned methods proved to be efficient learning techniques and address some of the challenges associated with the properties of metagenomic s rdna data however none of the methods have yet taken advantage of the inherent_properties of metagenomic_data although phylogenetic_information contained in metagenomic_samples has proved to be useful in comparative_metagenomics for example similarity_measures that take into account phylogeny e g unifrac and its generalized versions outperform nonphylogenetic distance in their ability to recover natural clusters of microbial_communities to incorporate phylogeny into the similarity measure unifrac based_methods calculate the degree to which the input samples share branch length on a phylogenetic_tree another example of a phylogeny based similarity measure is the parsimony test which uses fitchs parsimony algorithm to compute the number of minimal changes along the phylogenetic_tree necessary to explain all the labels of the sequences a recursive phylogenetic distance was defined in meta storms for the purpose of fast indexing of metagenomic databases although phylogeny provides important information about the natural hierarchical grouping of features it has not yet been adopted in classification algorithms for microbial_communities to incorporate the underlying structural_information among the features in learning_problems several regularization methods have been proposed for example in the problem of tumor class_prediction from gene_expression functional_groups of genes form the natural structure of data and the combination of l and l norms were used to encode the groups and variables within the groups the group_lasso penalty coupled with logistic_regression lr was applied for classification_problems with feature groupings and proved to be useful in short dna_motif modeling and splice_site detection composite absolute penalty extended the grouping approach to deal with overlapping groups and with hierarchical orderings of the input variables that reflect the order in which the variables should be included in the solution the idea of hierarchical grouping was later used for the multitask regression learning_problem where a tree encodes relationships between the elements of a multidimensional dependent_variable and a balanced weighting_scheme to weight the hierarchically overlapping groups was proposed here we show that the hierarchical grouping ideas can be efficiently applied to the multiclass classification_problem where information about the natural hierarchical grouping of features is available in this article we proposed a new multiclass classification_method for s rdna sequence or metagenomic_samples that takes_advantage of the natural structure of microbial_community data encoded by a phylogenetic_tree the leaf nodes represent features corresponding to individual otus and the internal nodes may be considered as super features the hierarchical_structure captures similarities and differences among the features and allows for the consideration of features at different granularity levels which may be desirable given that the features do not necessarily correspond to specific taxonomic units and only represent groups of similar sequences thereby some environment specific patterns may comprise features at multiple granularity levels we proposed a multinomial lr model with a tree guided penalty that incorporates the hierarchy in the feature_space and presented an efficient optimization_algorithm to learn the model_parameters we applied our algorithm to several real_datasets of s rdna sequences from the human_microbiota we compared the classification_performance of our method with several state of the art learning algorithms and showed that incorporating the natural structure of the microbial data results in a model with a better predictive_power we also performed a comprehensive analysis of the proposed method by applying it to simulated_datasets of different complexity because the problem of classifying s rdna sequence samples is relatively new there are no simulated_data generators that would generate the data appropriate for our goal current comparative_studies use simulations where features are generated independently from each other rather than according to a phylogeny therefore we introduced a new simulation approach that uses the phylogenetic structure of microbial_communities to generate otu count_data and simulate scenarios where community specific patterns may comprise features at multiple levels of granularity we showed that by taking_advantage of the phylogeny our algorithm has a robust performance with respect to the choice of feature resolution which corresponds to the selection of a similarity threshold when defining otus for the real_data we proposed a new classification_method for s rdna sequence samples that uses the natural structure of microbial_community data encoded by a phylogenetic_tree we showed that using the phylogenetic_information leads to an improved classification_accuracy compared with the state of the art classification algorithms unlike many popular classification methods which consider features or otu frequencies in isolation our method takes_advantage of the similarities between otus encoded by the phylogenetic_tree we applied the algorithm to classify samples obtained from s rdna studies but the approach can also be used to classify metagenomic_samples obtained by whole_genome the algorithm only requires frequencies of taxonomic_groups in each sample and a phylogenetic_tree that relates these groups even though our model does take advantage of the natural hierarchical grouping of otus features are still defined as individual otus the leaves of the phylogenetic_tree nevertheless a microbial_community may be characterized by several lineages of varying phylogenetic depth gives an example of a hypothetical disease characterized by concurrent over representation of a particular phylum genus and species therefore rather than defining features as tree leaves a subset of intermediate nodes of the phylogenetic_tree may lead to more powerful classification_models for complex microbial 
