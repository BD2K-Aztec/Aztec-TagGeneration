scaffoldscaffolder solving contig_orientation via bidirected to directed graph reduction motivation the contig_orientation problem which we formally define as the max dir problem has at times been addressed cursorily and at times using various heuristics in setting forth a linear time reduction from the max cut problem to the max dir problem we prove the latter is np complete we compare the relative performance of a novel greedy approach with several other heuristic solutions results our results suggest that our greedy heuristic_algorithm not only works well but also out performs the other algorithms due to the nature of scaffold graphs our results also demonstrate a novel method for identifying inverted_repeats and inversion variants both of which contradict the basic single orientation assumption such inversions have previously been noted as being difficult to detect and are directly involved in the genetic mechanisms of several diseases availability_and http bioresearch accurate and efficient genome_assembly algorithms are essential to unlocking solutions to challenges posed by genetic disease insufficient molecular sampling and repetitive_regions in the dna prevent full chromosomal assembly from next_generation reads causing assembly algorithms to produce a large set of partially reconstructed chromosomes termed contigs contigs must be oriented and positioned to reconstruct full chromosomes using paired_read data to infer positional and orientational relationships between contigs we define a scaffolding of two contigs as the relative positioning and orientation of contigs weighted by the multiplicity of supporting paired_reads the problem of scaffolding is often modeled as a graph where vertices are contigs and weighted edges indicate scaffoldings of contigs the goal in scaffolding is to find a hamiltonian path that incorporates each non repeat contig sequence once as a subtask of scaffolding the contig_orientation problem describes the challenge of assigning each contig a single orientation as per the singleorientation assumption so as to minimize conflicting orientation evidence more specifically the goal is to remove the minimum number of edges from the scaffold graph so that the remaining subgraph suggests a single consistent orientation of all vertices solving the contig_orientation problem is one step to reducing erroneous linking evidence in the scaffold data the contig_orientation problem has been equated to the weighted max cut problem the bipartite_graph problem and the odd cycle transferal problem solutions have included energy_cost minimization a fixed parameter algorithm mixed integer_programming depth first search and greedy bipartite_graph coloring several solutions to the more general_problem of scaffolding do not explicitly solve the contig_orientation problem but provide implicit contig orientationsolutions as a result of completing walks through the scaffold graph formal bidirected graph notation as first laid out by edmonds and has a long history in both computer science and bioinformatics_research but has rarely been employed to represent scaffold graphs commonly used is a notation in which directed nodes are depicted using some sort of biterminal distinction one node terminal represents the biological end of the contig sequence and the other terminal represents the end edges are then connected between the terminals or ends of a node in this notation a valid reconstruction or walk through a node requires entering and exiting the node via opposite terminals the bidirected graph paradigm when applied to scaffold graphs enables new approaches to scaffolding problems as will be shown research on the max cut problem has yielded a number of effective approximation algorithms including a min max cut algorithm a randomized linear time approximation and branch and bound methods goemans and williamson present what is commonly_accepted as the best max cut approximation algorithm a approximation by randomly rounding the solution to a nonlinear programming relaxation demonstrate that if the unique games conjecture is true the goemanswilliamson algorithm is the best possible approximation algorithm for max cut the np completeness of the contig_orientation problem has not hitherto been formally proven we provide such a proof demonstrating the many one polynomial time equivalence of the contig_orientation and weighted max cut problems we present a novel greedy solution and demonstrate its effectiveness compared with several max cut solutions we noted a peculiarity in the subgraph produced using our greedy heuristic on the synthetic genome without errorsthe two excluded edges were both adjacent to contig we also noted that contig has an average sequence depth a value indicative of the number of nucleotides contributing to the assembly at a given locus of roughly twice the normal_diploid depth making it a likely candidate for being a two copy repeat we used blast to find where contig aligned to the known reference we discovered that it aligned perfectly at two locations and that the two matching sequences were inversions see_supplementary this case illustrates that if repeats are not screened they can present exceptions to the contig_orientation problem and more specifically to the single orientation assumption the single orientation assumption will hold only if the contig represents a sequence which repeats in the same orientation in a scaffold e g tandem_repeats inverted_repeats like contig represent identical_sequences with opposite orientations from two distinct places in a scaffold among their several biological_roles inverted_repeats are used to detect the boundaries of transposons and are instrumental in transcriptional_regulation assigning a single orientation to such a contig prevents a viable scaffold reconstruction from occurring prematurely fragmenting the assembly this scenario can be resolved prior to assigning contigorientations by special handling or screening of repeat contigs this example shows that in addition to removing erroneous linkages from a scaffold graph the contig_orientation assignment will remove any viable biological scenario that is an exception to the single orientation assumption thus if the erroneous linkages can be filtered via other means e g minimum support threshold and next generation error_correction the contig_orientation assignment can be used to identify via exclusion biologically viable exceptions to the single orientation assumption one other such exception is the case of inverted haplotypes many genomes exist as diploid or polyploid organisms meaning there are two or more versions termed haplotypes of the genome in each cell an inverted haplotype is a sequence which is identical but oppositely oriented at corresponding locations on analogous chromosomes such inversions are often biologically_significant and have been specifically shown to be associated at times with mental_retardation microdeletion_syndrome renal_cysts and diabetes syndrome epilepsy schizophrenia and autism most assembly algorithms have not been specifically_designed for diploid genome_assembly and assume that where multiple haplotypes do exist they can be readily merged to form a single reference_sequence in doing so inverted haplotype differences are metaphorically swept under the rug which is perhaps why biologists have lamented that unlike other types of structural_variation little is known about inversion variants within normal individuals because such events are typically balanced and are difficult to detect and analyze by standard molecular_approaches just as a contig_orientation solution is able to identify inverted_repeats it is also able to identify inverted haplotypes we developed a module in scaffoldscaffolder to automatically generate a detailed report of potential inverted_repeats and inverted haplotypes in the module candidates are internally identified as any contig i having at least two connecting edges from at least one end and ii which is connected to two or more excluded edges the candidates can be classified as inverted_repeats or inverted haplotypes based on the location of each candidate contig in a probability_density of contig coverage a special_case is a monocontig inversion candidate which requires that each of two adjacent contigs be linked via edges from both ends of the candidate we tested our new predictive module on both synthetic and real_data we first synthesized a diploid_genome heterozygosity_rate containing an inverted haplotype from the zebra_finch chromosome we generated error_free reads for assembly with newbler and a graph was created using scaffoldscaffolder using our greedy heuristic_algorithm we assigned orientations to the contigs which resulted in a subgraph which excluded edges the average_weight of included excluded edges although the average weights of included excluded edges vary as a function of the overall average edge_weight the weight of edges excluded by the greedy_algorithm remains close to this suggests that the greedy_algorithm is excluding primarily erroneous edges violations of the single orientation assumption a in an inverted_repeat a sequence contig a is included in the reconstruction twice in opposite orientations b in a polyploid genome an inverted haplotype is a sequence contig b included in opposite orientations on different haplotypes potential inversion report listed three inversions two with sequencing_depth to suggest inverted_repeats we verified that all three inversions were accurate using blast and verified that the nonrepeat inverted haplotype aligned at the expected location in the reference haplotype sequences see_supplementary to confirm our ability to predict inverted haplotypes in real_data we identified a kb inverted haplotype hsinv from the human polymorphic inversion database martnez that has been found to be heterozygous in human hapmap individual na from this individual we assembled paired illumina_reads mapping to a kb segment of chromosome x in the region of hsinv we created a small graph of the assembled region with scaffoldscaffolder using the same paired_reads the greedy heuristic_algorithm assigned contig orientations excluding two well supported edges the algorithm identified a kb inversion contig that when mapped to the hg reference aligned in the region defined for hsinv in addition the two kb contigs scaffolded on either side of this inversion contigs and were also identified as inverted_repeats this arrangement in the scaffold graph summarized in suggests not only that contig is inverted but that possibly some or all of contigs and are also part of the inversion hence why many inversion breakpoints are reported as ranges we observe that distinguishing between an inverted haplotype and a non inverted sequence flanked by inverted_repeats is impossible by this approach without pairs that span beyond the inverted_repeats which in the case of na were unavailable ongoing_development and testing will help to assess the efficacy of this inversion detection method on a larger scale however both the theory and our small tests confirm that edges which are excluded in solving the contig_orientation problem are suggestive of inverted_repeats and inverted haplotypes in de_novo assemblies particularly when such sequences are adjacent to multiple or heavily supported excluded edges the contig_orientation problem which we have formally framed as the max dir problem has at times been addressed somewhat apologetically only cursorily and at times using various heuristics in setting forth a linear time reduction from the max cut problem to the max dir problem we have proven that the latter is npcomplete we have compared the relative performance of our novel greedy approach with several other heuristic solutions our results suggest that the greedy heuristic_algorithm not only works well but outperforms the other algorithms due to the nature of scaffold graphs in such graphs heavier weighted edges are more likely to be valid and therefore included in the optimal_solution a greedy_algorithm which maximally favors such edges approximates an ideal solution one unanticipated outcome of this study has been the discovery of a novel method for identifying inverted_repeats and inversion variants both of which contradict the basic single orientation assumption such inversions have previously been noted as being difficult to detect and are directly involved in the genetic mechanisms of several diseases thus this method which we have implemented as a module of scaffoldscaffolder has the potential to assist in the automated discovery of biologically_significant features in de_novo 
