gene_expression supervised normalization of microarrays motivation a major_challenge in utilizing microarray_technologies to measure nucleic_acid abundances is normalization the goal of which is to separate biologically_meaningful signal from other confounding sources of signal often due to unavoidable technical_factors it is intuitively clear that true_biological signal and confounding_factors need to be simultaneously considered when performing normalization however the most popular normalization approaches do not utilize what is known about the study both in terms of the biological variables of interest and the known technical_factors in the study such as batch or array processing date results we show here that failing to include all study specific biological and technical variables when performing normalization leads to biased downstream_analyses we propose a general normalization framework that fits a study specific model employing every known variable that is relevant to the expression study the proposed method is generally_applicable to the full range of existing probe designs as well as to both single_channel and dual channel arrays we show through real and simulated examples that the method has favorable operating characteristics in comparison to some of the most highly used normalization_methods availability an r package called snm implementing the methodology will be made available from bioconductor http bioconductor org the microarray_technology measures nucleic_acid abundances such as from mrna in biological_samples by producing fluorescence_intensities that reflect hybridization events between nucleotide_sequences attached to the microarray are single_stranded dna_probes which represent a short_segment of complementary_dna within a gene differences among current microarray_technologies are typically in terms of probe design and the number of fluorescent_dyes applied to any given array regardless of the technology statistical_analysis of these data usually attempts to to whom correspondence should be addressed infer the relationship between nucleic_acid abundance variation and biological phenotype one of the main challenges of this inference process is normalization which addresses the fact that factors not of biological_relevance can influence the observed intensities complicating approaches used to infer relationships from these data the major_contribution of this paper is to provide a general supervised framework for microarray normalization this approach is applicable to all major microarray_technologies and performs the normalization in a manner supervised by all known variables relevant to the study some of the most highly used microarray normalization_methods are what we call unsupervised methods these are normalization procedures that do not utilize the variables describing the study specifically the biological variables of interest for example suppose the goal of a microarray study is to identify genes_differentially with respect to an experimental treatment also suppose that the arrays were processed in two separate batches unsupervised methods ignore the treatment and batch variables when performing the normalization however if the goal of normalization is to separate biologically_meaningful signal from technical confounders then it seems infeasible to do so without taking_into the signal explained by the study specific variables such as treatment and batch in this example while unsupervised methods may show favorable operating characteristics in specialized settingssuch as when biological variables contribute relatively negligible signal to the datait has been shown they make assumptions about data that are commonly invalidated in practice as a simple motivating example meant to illustrate how easily these assumptions are violated we simulated microarray_data extensive details are given in following sections with signal due to a dichotomous biological variable and intensity_dependent array effects we simulated probes of which are differentially_expressed shows the p value histograms corresponding to probes which are not differentially_expressed is the method we propose in this work where the p values are correctly uniform and e show the p values from the same probes when using invariant set normalization isn and quantile normalization qn respectively it can be seen that both sets of p values are anti conservatively biased of the main ideas behind supervised normalization of microarrays a a hypothetical example to demonstrate the differences between supervised and unsupervised normalization strategies the three boxes arranged across the top display different types of potential effects each of these potentially influences the unnormalized observed intensities which are presented as densities in the middle panel the blue and red lines describe the different biological conditions while the dashed and dotted lines describe the different dates the differences among the four arise either from the biology or study_design after normalization with a supervised approach that takes all three effects into account when normalizing the data the differences between the blue and red lines are still present while the differences between the dashed and dotted lines have been removed however for unsupervised approaches such as quantile normalization the resulting data have been transformed so that all arrays have the same distribution a result that clearly violates the biological relationship of interest b an example of the model we fit to the probe level data from a microarray study the model has probe specific terms intensity_dependent terms and may include other terms such as probe composition effects or surface level spatial effects unsupervised normalization_methods make data transformations based on graphical trends visible in diagnostic plots qn transforms the data so that a quantilequantile plot comparing the ordered probe intensities between any two arrays in a study is equal to the line y x isn transforms the data so that a plot comparing the intensities of a selected subset of probes between any two arrays is centered page in this article we described a framework for the normalization of microarray_data the central premise of this work is that the study under investigation should inform the normalization process the framework is intended to be general enough to address most microarray_studies regardless of platform or biological goal the examples we explored were selected as they are commonly occurring in practice and clearly describe the effects on inference of ignoring relevant_information from an analysis we note that the studyspecific models utilized in this paper will not satisfy all studies rather we view this work as a general supervised normalization framework based on a well defined goal namely to remove the effects of adjustment variables without biasing inference and the examples as a means to illustrate the benefit of this approach a researcher would utilize this framework to build a study specific model and then apply the proposed algorithm which is quite general the results presented in this paper demonstrate some of the problems associated with unsupervised normalization_methods for example the simulations show how such approaches can introduce signal in the presence of asymmetric biological_variation similarly the simulations and vascular_development example make clear that unsupervised approaches ignore effects of study_design on expression data finally these approaches make the assumption that few genes are differentially_expressed an assumption that is clearly false in many settings these and other limitations of unsupervised methods are the motivation for this work the framework is designed to handle a variety of study_designs we presented a modeling strategy that is designed to model relevant study specific variables e g probe specific biological_effects probe specific technical effects and intensity_dependent effects the flexibility of our modeling strategy is demonstrated by the fact that it straightforwardly derives previously described supervised normalization models for more specialized experimental_designs and technologies another benefit is that other terms page 
