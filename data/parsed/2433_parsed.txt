inference of markovian properties of molecular sequences from ngs_data and applications to comparative_genomics downloaded from motivation next_generation ngs_technologies generate large_amounts of short_read for many different organisms the fact that ngs_reads are generally short makes it challenging to assemble the reads and reconstruct the original genome_sequence for clustering genomes using such ngs_data word count_based alignment_free is a promising approach but for this approach the underlying expected word counts are essential a plausible model for this underlying distribution of word counts is given through modeling the dna_sequence as a markov_chain mc for single long_sequences efficient statistics are available to estimate the order of mcs and the transition probability matrix for the sequences as ngs_data do not provide a single long sequence inference methods on markovian properties of sequences based on single long_sequences cannot be directly used for ngs short_read results here we derive a normal_approximation for such word counts we also show that the traditional chi_square has an approximate gamma_distribution using the lander waterman model for physical_mapping we propose several methods to estimate the order of the mc based on ngs_reads and evaluate those using simulations we illustrate the applications of our results by clustering genomic_sequences of several vertebrate and tree_species based on ngs_reads using alignment_free sequence dissimilarity measures we find that the estimated order of the mc has a considerable effect on the clustering_results and that the clustering_results that use an mc of the estimated order give a plausible clustering of the species availability_and our implementation of the statistics developed here is available as r package ngs next_generation ngs_technologies generate large_amounts of overlapping short_read for many different organisms for example a read is a subsequence of bps for illumina and bps for sequencing_technologies and can sometimes be much shorter the fact that ngs_reads are generally short makes it challenging to reconstruct the original genome_sequence recently several word count_based alignment_free methods have been applied to infer the relationship among different species and metagenomic_samples based on ngs_reads without assembly our alignment_free sequence dissimilarity measures d and d s and their variants have shown promise these methods require the knowledge about the approximate distribution of word counts in the underlying sequences although a model which assumes that all letters in the sequence are equally likely is relatively straightforward to analyze see a markov_model for the underlying sequences is more realistic markov_chains mcs have been widely used to model molecular sequences with many applications including the study of dependencies between the bases the enrichment and depletion of certain word patterns prediction of occurrences of long word patterns from short patterns and the detection of signals in introns studied the effect of the order of mcs on several biological_problems including phylogenetic_analysis assignment of sequence_fragments to different genomes in metagnomic studies motif_discovery and functional_classification of promoters these applications showed the importance of accurate specification of the order of mcs reliable estimators for the order of the mc and the transition probability matrix based on the sequence_data are crucial suppose a relatively long molecular sequence can be modelled as a general finite_state mc sequence of letters from a finite alphabet a f lg of size l consider testing_the that the long sequence follows a k th order mc with some mild assumptions showed that under this null_hypothesis twice the log likelihood_ratio of the probability of the sequence under a k th order mc versus that under the k th order mc model follows approximately a v distribution with df k l l k degrees_of he also approximated the log likelihood_ratio by the pearson type statisticwhich is also approximately v distributed with the same degrees_of here w w w w k denotes a k word formed of lettersthe count of the word w in the sequence and e w n w n w n w is the estimated expected count of w if the sequence is generated by an mc of order k here k see also avery and henderson for a detailed study billingsley a b for an excellent exposition of statistical issues related to mcs as well as for applications to sequence_analysis the chi_square and the log likelihood_ratio statistics can be used to test the order of an mc using all k words w a k when a particular order of mc is rejected we can identify particular word patterns that are exceptional through the approximate distribution of n w the approximate distributions of n w in long_sequences is well understood see for example in particular suppose that the sequence follows a stationary k th order mc and lettheorem ingives that as sequence_length goes to infinity for all real values x pz w x ux where u denotes the cumulative_distribution of a standard normal variable we also say that z w converges to the standard normal distribution n in distribution this asymptotic result can then be used to find exceptional words in long_sequences given an ngs short_read sample it is tempting to use the test_statistic s k defined in to test the order of an mc by simply counting the number of the occurrences of words in short_read however as the short_reads from ngs_data are sampled randomly from the genome some parts of the genome are possibly not sampled and some parts are possibly sampled extensively the sampling process introduces additional randomness to the statistic and makes s k deviate from its traditional v distribution similarly the approximate distribution of z w given in will be different from the standard normal distribution in this article we study these approximate distributions both theoretically and by simulations first we extend the statistics s k and z w for an mc sequence to s r k and z r w for the ngs read data our underlying model for the distribution of reads along the genome is the potentially inhomogeneous lander waterman model for physical_mapping we discover that for a set of short_reads sampled from a k th order mc sequence the statistic s r k follows approximately a gamma_distribution with shape parameter df k and scale parameter d where d is a factor related to the distribution of the reads along the genome we also show that with the same factor d the distribution of the single_word statistic z r w ffiffiffi d p tends to the standard normal distribution based on the theoretical results we introduce an estimator for the order of the mc using ngs_data for practical purposes we also give an estimator for the factor d when the underlying reads sampling distribution is unknown to the best of our knowledge this is the first study of the markovian properties of molecular sequences based on ngs read data to illustrate our theoretical results and our estimators we first carry out a simulation_study based on transition probability matrices which are estimated from cis_regulatory module crm dna_sequences and insert repeats we simulate different read_lengths numbers of reads inhomogeneous sampling as well as sequencing_errors and we include a regime where the sampling_rate depends on the gc_content if the gc bias is not very strong or the sequencing_depth is not very low then the simulation_results agree with our theoretical_predictions despite the theoretical assumptions being slightly violated next we apply our methods to cluster vertebrate_species using our alignment_free dissimilarity measures d and d s under different mc models which are estimated from ngs read samples the estimated orders based on ngs_data without assembly are found to be consistent with those inferred directly from the long genome_sequences the clustering performs best when using mcs around the estimated order applying the same analysis to tropical tree_species whose genomes are unknown based on their ngs read samples the most plausible clustering is achieved when using an mc model of order close to the one estimated from the ngs_reads the article is organized as follows the methods section contains the probabilistic_models of generating the mc sequence and sampling the short_reads as well as the theorem for the approximate distributions of s r k and z r w for ngs_data this theorem is used to derive our estimators for the order of the mc and for the factor d in the results section we first provide_extensive simulation_studies including the comparison of the theoretical approximate distributions and the simulated results for s r k and z r w the effect of inhomogeneous sampling and sequencing_errors the efficiency of the estimator of the factor d and the evaluations of the methods for estimating the mc order second we estimate the orders of the mcs for vertebrate_species based on the simulated whole_genome ngs samples we then use our dissimilarity measures d and d s to cluster the ngs samples of the species under different mc orders to see the effect on the performance of the clustering the applications show that our new methods are effective for the inference of relationships among sequences based on ngs_reads finally we use our methods to study the relationships among tree_species whose complete genomic_sequences as well as their phylogenetic_relationships are unknown our clustering_results are consistent with the physical_characteristics of the tree_species the article_concludes with some discussion of the study ngs technologies_provide large amount of data in the form of short_reads assembly of the millions of short_reads to recover the long sequence is challenging because the relative short_length of the reads makes_it to resolve the repeat regions not all regions may be covered and assembly is time consuming although multiple_sequence may be prohibitive we can use word count_based dissimilarity measures to cluster the underlying species these measures require an underlying probability model for the sequences mcs are a reasonable model for such sequences although transition_probabilities can be estimated directly from count_data estimating the order of an mc here is not straightforward methods for estimating the order of an mc of a long sequence have been developed since the s but estimating the order of an mc directly from a set of short_reads without assembly has not been studied yet in this article we develop two statistics s r k and z r w and show that both s r k and z r w have surprisingly simple approximate distributions with only two parameters one of them depending on the order of the original long mc sequence and the other one depending on the distribution of the reads along the sequence intriguingly one of these parameters is d c under homogeneous sampling where c is the coverage of the reads along the genome based on the first b k positions of each read on the basis of the property of s r k and z r w we develop an estimator for the order of an mc as well as an estimator for the parameter d based on ngs_data extensive_simulation are carried_out to verify the theorem and evaluate the estimator finally we apply the estimation methods to two ngs_datasets because the real genome_sequences consist of coding non coding and various regulatory_regions single standard mc models do not fit the data well moreover some enriched patterns such as the motif sequences are widespread throughout the genomes and violate the simple mc model for the whole genome_sequence hence studying the fraction of k words whose occurrences can be explained using the statistic z r w d by comparison to a v distribution is a more realistic way to determine the order of the mc for a real genome_sequence the estimated orders are consistent with the orders estimated directly from the full genome_sequences using bic methods our primary motivation for this study is alignment_free genome comparison using ngs_data further we cluster the species based on the ngs_data using mc models with various orders the results show that the clustering performs best and gives stable results when using an mc model with order on and above the estimated order in addition we apply the same analysis to tropical tree_species whose reference_genomes are unknown again the best clustering is achieved under an mc with the order within the estimated range when the sequence_length is short or the sequencing_depth is low the numbers of occurrences of some k words become small or even zero then the assumption of non zero variance for all word counts which underlies the gamma approximation for s r k no longer holds and the gamma approximation may not work well in such a situation an exact test for the order of mcs in the spirit of besag and mondal could be very helpful in this article we have only made a start on the mc modeling of ngs_data an exhaustive study of errors in the data in the form of power studies could help to further understand the application range of our results finally in this work we take the estimation of the transition_probabilities for granted once the order of the mc is determined although the estimation of the transition_probabilities of the mc model of a long sequence has been studied by anderson and goodman and it would be interesting to extend these methods to ngs_data 
