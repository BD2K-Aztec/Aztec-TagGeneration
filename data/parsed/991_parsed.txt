sequence_analysis classification of dna_sequences using bloom filters motivation new generation sequencing_technologies producing increasingly_complex datasets demand new efficient and specialized sequence_analysis algorithms often it is only the novel sequences in a complex dataset that are of interest and the superfluous sequences need to be removed results a novel algorithm fast and accurate classification of sequences facss is introduced that can accurately and rapidly classify sequences as belonging or not belonging to a reference_sequence facs was first optimized and validated using a synthetic metagenome dataset an experimental metagenome dataset was then used to show that facs achieves comparable accuracy as blat and ssaha but is at least times_faster in classifying sequences availability source_code for facs bloom filters and metasim dataset used is available at http facs biotech kth se the bloom faster perl module can be downloaded from cpan at http search cpan org palvaro bloom faster contacts the era of personal_genomics is fast approaching as a result of which whole human_genomes will be obtained on a routine basis currently only a fraction of such sequences contain relevant soughtafter information and the remaining sequences need to be removed more complex datasets are also becoming increasingly available derived from metagenome studies that contain a mixture of genetic_material from different organisms present in environmental or patient samples studies of dynamic methylation pattern profiles and sequencing of re arranged and mutated genomes to handle and analyse this vast amount of data requires fast accurate and specialized methods that can align a large number of sequences onto genomes or reference_sequences the increasing need for to whom correspondence should be addressed faster algorithms has led to the development of software such as megablast ssaha and blast like alignment_tool for longer dna_sequence more recently soap maq shrimp bwa and bowtie have been developed for shorter dna_sequence many of these algorithms can detect single nucleotide changes for most of these existing_methods a hash_table must be built containing either the query blast maq and shrimp or reference ssaha blat and soap sequences this hash_table must then be searched to align_reads one important issue in metagenomic_studies is the classification of sequences as novel or belonging to a known genome i e filtering out data that has been seen before there is a need for a fast preprocessing_step that reduces the complexity of the data before more careful analysis is performed often it is the novel reads that are of interest and the location of other reads in their originating genomes is irrelevant this means that alignment tools such as those mentioned above actually perform more computations than necessary a bloom_filter is a space efficient data_structure with fast lookup times and a manageable risk of producing false_positives it was originally developed by burton bloom in the s to reduce the amount of space required to contain hash coded information in this article an algorithm is described fast and accurate classification of sequence facss which uses a novel scheme to classify sequence_reads as belonging to one of many reference_sequences or being novel the algorithm transforms the reference_sequence into bloom filters and then the bloom filters can be queried for exact_matches this method allows rapid classification of sequences using references as large as the human_genome in this study the facs algorithm was evaluated using a synthetic long_read metagenomic_dataset and was compared to conventional methods blat and sequence_search and alignment by hashing algorithm ssaha with respect to speed sensitivity_and facs was then used to analyse and remove human sequences from an experimental metagenomic_dataset containing sequences generated using a roche flx sequencer this was done in an effort to show that facs can be used to classify sequences to known genomes while reducing the complexity of the dataset and retain novel reads for this task facs was timespage this study used a novel algorithm called facs which utilizes the compact hash based data_structure of bloom filters for fast and accurate classification of sequences the algorithm was optimized using a synthetic metagenome dataset generated by metasim which consisted of reads sampled from microbial_genomes viruses and human_chromosomes facs was then put to the test in removing all human and mitochondrial sequences from a real metagenome dataset containing reads generated using massive parallel pyrosequencing the sample was derived from a molecular exploration of the human_respiratory searching for previously_unknown viral species data to be published elsewhere and see of the experimental metagenome dataset of the sequences could be classified as belonging to either human or mitochondrial references with facs the performance of facs was evaluated by comparing it to blat and ssaha the facs method was and times_faster than blat and ssaha respectively in classifying sequences in the experimental dataset while achieving comparable accuracy this makes the facs method ideal for quickly classifying reads to genomes or large references from a complex dataset as the number of sequences to be analysed increases the advantage of using facs compared to blat or ssaha in terms of speed should be even more pronounced the sensitivity_and of the filter is very dependent on the reference filter size the k_mer size the match cut_off and the bloom_filter false_positive frequency this study has shown that a k_mer of bases and match criterion of sequence_identity is adequate for analysing genomes ranging from microbial to human however the optimal use of the facs method should not use a constant k_mer size but adapt it according to the size of the reference as was the case for the experimental metagenome dataset in this study ultimately the choice of match criterion will depend on the desired k_mer size reference size and the application for which the method is being used furthermore it was also demonstrated that the facs cut_off although low in strict sequence_similarity is stringent and performs equally well as the match cut_off used with blat and ssaha this is an outcome of the different algorithms that make up each method the match cut_offs were chosen based on their effect on the sensitivity_and of each method when trained on the synthetic metagenome dataset this was conducted in an effort to find the best match cut_off possible for each method and reduce the risk_of the results for both the synthetic metasim dataset and the experimental metagenome dataset when using the human_mitochondrial reference showed relatively few unique reads for each method this is due to the reasonably well behaved simulated reads and small reference_genomes making it relatively easy to analyse conversely when using the human_genome as a reference for the experimental metagenome dataset the number of unique reads classified by each method increased substantially this change reflects the complexity of the human_genome and a certain bias of each method of the reads unique to blat occ and ssaha skip were shorter than bases this explains some of the differences between the facs blat and ssaha methods since facs did not consider reads shorter than bases in this study some low complexity reads will not be considered by blat or ssaha while facs does not have any low complexity filter however both ssaha and blat classifies more lowcomplexity reads than facs it was interesting that facs was so insensitive to low complexity reads even though it does not have any low complexity filter furthermore classifying low complexity reads with facs does not take any additional time compared to an ordinary sequence unlike blat that uses a binary help file occ to avoid analysing low complexity reads and ssaha which ignores k_mers that are abundant in the genome in order to increase speed since the reference_genomes in the synthetic metagenome dataset were not repeat masked before metasim sampled them sequences consisted mostly of n s uncalled bases from the genome_assemblies facs will try to classify these sequences but they were excluded from the analysis for blat and ssaha since neither method will try to align them that so many unique reads are found using each method leads to further questions how many methods are needed for complete classification how stringent must match criteria be to make certain that the classified reads belong to the reference_sequence while keeping the fraction of false_negatives low a sequence_similarity of with an alignment spanning over at least of the query was chosen as a match criterion when using page 
