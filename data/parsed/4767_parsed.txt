two pass alignment improves novel splice_junction quantification motivation discovery of novel splicing from rna sequence_data remains a critical and exciting focus of transcriptomics but reduced alignment power impedes expression quantification of novel splice_junctions results here we profile performance characteristics of two pass alignment which separates splice_junction discovery from quantification per sample across a variety of transcriptome_sequencing data_sets two pass alignment improved quantification of at least of simulated novel splice_junctions and provided as much as fold deeper median read_depth over those splice_junctions we further demonstrate that two pass alignment works by increasing alignment of reads to splice_junctions by short lengths and that potential alignment errors are readily_identifiable by simple classification taken together two pass alignment promises to advance quantification and discovery of novel splicing_events contact since the first successful application of short_read to cdna in broad uptake has proven rna_seq an indispensable tool in the arsenal of molecular_biology however for as long as it has existed analysis of rna_seq has been complicated by consequences of the gapped nature of rna briefly when rna is transcribed from dna putative_functional sequences exons are interspersed with sequences which are later removed introns because exons originate from noncontiguous genomic contexts separated by varying distances the primary challenge in ascribing rna_sequences to their genomic origins is gapped_alignment for which many good tools have been developed these aligners typically support the use of annotated gene references which facilitate alignment to known splice_junctions while maintaining the ability to discover novel splice_junctions this approach has the implicit effect of requiring greater evidence for reads spliced over novel splice_junctions compared with known splice_junctions and is implemented either by aligning in multiple_stages as in tophat or by varying alignment scores for different splice_junction classes as in star spliced transcripts alignment to a reference in all such tools preference is given to knownsplice junctions which reduces noise but biases quantification against novel splice_junctions two pass alignment a framework in which splice_junctions are separately discovered and quantified has recently gained traction owing largely to massive speed enhancements achieved by new aligners which make aligning twice computationally_feasible the rationale behind two pass alignment is elegant splice_junctions are discovered in a first alignment pass with high stringency and are used as annotation in a second pass to permit lower stringency alignment and therefore higher sensitivity in the absence of annotation compared to traditional single_pass alignment an independent analysis demonstrated that two pass alignment with star provides comparable mapping rates though more multimapping similar mismatch alignment rates reduced read truncation superior read placement accuracy comparable indel accuracy improved splice_junction recall and better annotated splice_junction detection with comparable discovery of true novel splice_junctions at the cost of more false_positive discoveries while the effects of two pass alignment on transcript assembly and transcript quantification have also been investigated our primary interest is in splice_junction expression quantification which is relevant to ascertaining the validity of discovered splice_junctions and has not yet been thoroughly investigated in light of the evidence that two pass alignment can improve alignment rate and sensitivity we investigated what advantages_and this approach might yield for splice_junction quantification here we describe for the first time several appealing performance characteristics of two pass alignment in an experiment in which known splice_junctions are treated as unannotated twopass alignment provided excellent quantification accuracy and significantly more accurate quantification than single_pass alignment underscoring the wide applicability of the technique these quantification benefits were observed across a variety of rna_seq including arabidopsis samples as a salient takeaway this corresponded to as much as fold median deeper read_coverage over novel splice_junctions we go on to demonstrate that two pass alignment works by permitting alignment of sequence_reads by fewer nucleotides to splice_junctions finally while we find that two pass alignment can introduce alignment errors as previously_suspected we demonstrate that these are relatively simple to detect in summary two pass alignment significantly_improves quantification of novel splice_junctions and we recommend its use in studies concerned with novel splice_junction discovery and quantification two pass alignment flowchart center and right stepwise progression of two pass alignment first the genome is indexed with gene_annotation here gencode basic next novel splice_junctions are discovered from rna sequencing_data at a relatively high stringency nt minimum spanning length third these discovered splice_junctions and expressed annotated splice_junctions are used to re index the genome finally alignment is performed a second time quantifying novel and annotated splice_junctions using the same relatively lower stringency nt minimum spanning length producing splice_junction expression input_files and their associated file_formats are shown on the right left pictorial representation of individual_steps for an individual novel splice_junction exons are illustrated in gray indexed splice_junctions in black individual sequence_reads supporting a known and a novel splice_junction in blue and red and read_counts splice_junction quantification in blue and red boxes alignment parameters are provided in the methods and supplementarytukey boxplots of quantification improvement across splice_junctions per sample are plotted in and the percentage of splice_junctions improved upon are provided in summary_statistics per sample including the median increase in read_depth between two de_novo alignment passes and percentage of splice_junctions improved are depicted in from these analyses we observe that two pass alignment provides much more accurate quantification of novel splice_junctions than single_pass alignment this is depicted qualitatively for one sample the a cell_line inas the blue distributions deviation from compared with the green distribution and quantitatively as boxplots inas deviation from zero as an example the median quantification in a was approximately of the gold_standard green distribution and correspondingly two pass alignment improved that quantification by about a boxplot center across the twelve samples tested two pass alignment achieved to higher_coverage over novel splice_junctions than single_pass alignment similarly two pass alignment improved the quantification of between and of the splice_junctions in each sample over single_pass alignment next we ascertained the absolute_quantification accuracy of de_novo pass alignment again in comparison to from this analysis we observe that regardless of its relative_improvement over one pass alignment two pass alignment provides accurate novel splice_junction quantification across the twelve samples two pass alignment provided correct quantification identical to annotation pass of at least of splice_junctions and provided nearly correct quantification within accuracy of at least of splice_junctions we speculate that variability in the percentage of splice_junctions quantified identically to the standard versus those within was mostly driven by the number of reads per sample samples with twice as many reads were less likely to produce exactly identical counts seefor read_counts instead of normalizing e g read sampling to eliminate this effect here we present the accuracy across unadulterated samples one interesting albeit unfortunate result was that de_novo two pass alignment completely missed between and of splice_junctions per sample these splice_junctions were also completely missed by de_novo one pass alignment a example read_depth ratio meaning they were not lost in the second alignment pass but we were still curious what might introduce difficulty in aligning to these splice_junctions first we recognized that most missed splice_junctions were low expressed covered by only a few reads in the standard quantification see supplementary figs s s b panels but some missed splice_junctions did have high expected quantification we therefore sorted the splice_junctions by their standard quantification in descending order and found a strong enrichment of at ac gc ag and non canonical splice_site motifs at the top of the list supplementary in particular annotated at ac and gc ag splice_site containing splice_junctions were most likely to be missed followed by non canonical splice_sites this result makes qualitative sense given that star penalizes splice_junctions with non canonical splice_sites but the magnitude of the effect was greater than we anticipated we further note that in practice non canonical annotated splice_junctions can still be readily aligned to by use of annotation and arent damaged by two pass alignment alone as evidenced by the annotation pass distribution in which missed very little read_depth ratio 
