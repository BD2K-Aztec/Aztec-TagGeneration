naive binning improves phylogenomic analyses motivation species_tree in the presence of incomplete_lineage ils is a major_challenge for phylogenomic analysis although many methods have been developed for this problem little is understood about the relative performance of these methods when estimated gene_trees are poorly estimated owing to inadequate phylogenetic_signal results we explored the performance of some methods for estimating species_trees from multiple_markers on simulated_datasets in which gene_trees differed from the species_tree owing to ils we included beast concatenated analysis and several summary_methods bucky mp est minimize deep coalescence matrix representation with parsimony and the greedy consensus we found that beast and concatenation gave excellent results often with substantially improved accuracy over the other methods we observed that beasts accuracy is largely due to its ability to co estimate the gene_trees and species_tree however beast is computationally_intensive making it challenging to run on datasets with or more genes or with more than taxa we propose a new approach to species_tree in which the genes are partitioned into sets and the species_tree is estimated from the resultant supergenes we show that this technique improves the scalability of beast without affecting its accuracy and improves the accuracy of the summary_methods thus naive binning can improve phylogenomic analysis in the presence of ils species_tree from multiple genes is often performed using concatenation also called combined analysis alignments are estimated for each gene and concatenated into a supermatrix which is then used to estimate the species_tree when gene_trees are concordant concatenation can give accurate results however this approach to species_tree is potentially problematic when gene_trees differ from the species_tree and hence from each other owing to several biological_factors including gene_duplication and loss horizontal_gene and incomplete_lineage ils the best studied of these problems is species_tree in the presence of ils which is based on the multi species coalescent many methods have been developed to estimate species_trees in the presence of ils beginning with the minimize deep coalescence mdc approach suggested in and now including many different types of methods see degnan and rosenberg for a discussion of some methods some of these new methods for example mp est and the population tree from bucky have been proven to be statistically consistent in the presence of ils in contrast the greedy consensus gc majority consensus the concordance tree from bucky and mdc can be inconsistent in the presence of ils i e there are some parameter_settings under which these methods are inconsistent the bayesian_method beast may produce a statistically consistent point_estimate e g the map tree of the species_tree but a formal proof has not yet been provided which proves the statistical consistency of gene_tree estimation using bayesian mcmc methods simulations suggest that when true gene_trees differ owing to ils concatenated analysis can produce incorrect estimates of the species_tree sometimes with high_confidence leading to the conjecture that concatenated analyses are not statistically consistent however statistical consistency or inconsistency is a mathematical statement about performance in the limit and so requires a formal proof thus while the evidence strongly suggests that under conditions in which gene_trees can differ owing to ils concatenation can be statistically inconsistent but beast will be statistically consistent these are still open questions as a result of these studies and the growing awareness that ils can be present in many phylogenomic datasets there is great interest in using ils based estimation of species_trees instead of concatenated analysis however only a few studies have been published comparing ils based_methods and even fewer have compared concatenated analyses to ils based_methods performance in simulation has been mixed with ils based_methods outperforming concatenation in some cases but not all the performance of ils based_methods on biological_datasets has also been mixed with concatenation often producing trees with high bootstrap support that may not be completely correct but ils based_methods often producing trees with low bootstrap support thus we still do not know much to whom correspondence should be addressed about the relative performance of ils based_methods how they compare with methods such as concatenation that do not take ils into account and what factors impact the absolute and relative performance of methods in this article we report on a simulation_study to evaluate a collection of methods for estimating species_trees and gene_trees in the presence of ils our simulation_study includes datasets generated under three model conditions from prior studies one model condition has taxon datasets that evolve under a strong molecular_clock and the other two model conditions have taxon datasets that do not evolve under a clock the amount of ils varies between the three model conditions ranging from relatively low amounts to high amounts finally estimated gene_trees on these datasets have low average bootstrap support due to insufficient phylogenetic_signal reflecting conditions often encountered when sampling genes from throughout the genome we study a wide_range of methods for estimating species_trees from multiple_markers including beast both the population and concordance trees returned by bucky mp est phylonet mdc gc also called the extended majority consensus matrix representation with parsimony mrp and concatenation using maximum_likelihood ca ml our study revealed that many methods have poor accuracy when the individual gene sequence_alignments have low phylogenetic_signal this vulnerability to poor signal affects all methods but especially those that combine estimated gene_trees by comparison beast and ca ml are relatively less impacted we developed an approach to address the vulnerability of species_tree methods to low phylogenetic_signal we randomly partitioned the genes into subsets which we call supergenes estimated trees from these supergene alignments and then used methods to estimate the species_tree from the supergene trees this approach did not produce statistically_significant changes in accuracy on the taxon datasets but improved the accuracy of the trees estimated by combining estimated gene_trees often substantially on the taxon datasets running beast on the binned supergene alignments did not impact its accuracy but did improve its scalability furthermore when used with binning several methods came close to being as accurate as beast while being orders_of than beast thus this study suggests that highly_accurate largescale phylogenomic analyses may be achievable through a naive binning technique we show results evaluating computational aspects of the different methods and then results of the five basic experiments exploring accuracy see the supplementary_materials for additional details the main purpose of this study was to evaluate methods for estimating species_trees in the presence of ils under realistic conditions because many real_world phylogenomic analyses have to contend with genes with poor phylogenetic_signal we specifically examined conditions in which estimated gene_trees were only partially resolved as expected the number of genes and amount of ils impacted the accuracy of the methods we tested so that all methods returned more accurate trees with increasing numbers of genes and decreasing levels of ils however in addition to these expected results we make the following observations first all the summary_methods we studied were impacted by gene_tree estimation error in contrast although beast and ca ml were also affected by the amount of phylogenetic_signal in the multiple_sequence the impact was generally less second ca ml and beast had similar accuracy and were generally more accurate than the summary_methods we tested third beast produced dramatically more accurate gene_trees than ml analyses on the alignments and summary_methods on these gene_trees produced species_trees as accurate as beast species_trees explaining why beast produces more accurate species_trees than other methods fourth the naive binning technique we tested generally improved coalescent based_methods it improved the scalability of beast without impacting its accuracy making it feasible to use beast on datasets with many genes binning also improved the accuracy of species_trees estimated using the summary_methods we tested on the taxon conditions although the degree of impact depended on the number of genes and the level of ils finally binning had no statistically_significant impact on the taxon conditions the observation that summary_methods are vulnerable to poor phylogenetic_signal in the gene sequences is consistent with the empirical_studies reported by salichos and rokas and and this study would seem to suggest that naive binning would be helpful for species_tree under these circumstances however naive binning could have unforeseen negative_consequences if it puts genes with different histories into the same bin the good performance of naive binning under the taxon strongils condition we explored suggests that it may be somewhat robust in practice even under relatively high rates of ils however because naive binning did not improve the accuracy of summary_methods on the taxon datasets which had the highest rate of ils this suggests that naive binning could reduce accuracy when the amount of ils is large there is also a possibility that binning will only be helpful when concatenation is more accurate than the coalescent based_methods therefore further research is needed to assess the conditions in which binning improves or reduces accuracy see supplementary_materials section for additional discussion about this issue one of the most interesting_results in this article is the observation that ca ml outperformed all the ils based_methods that operate by combining estimated gene_trees this observation would seem to run counter to other simulation_studies that have shown that concatenation can return incorrect trees with high_confidence and can also produce trees that are less accurate than trees estimated by ils based_methods however these studies used simulated_datasets that evolve under a strong molecular_clock a condition that may benefit some coalescent based_methods more than concatenation few taxa and generally had many genes relative to the number of taxa and estimated gene_trees on these alignments may have been fairly accurate in contrast our study had and taxon datasets at most genes and poorly estimated gene_trees thus it seems that there are conditions under which some ils based_methods might outperform ca ml and other conditions under which ca ml might outperform the ils based_methods in particular it is possiblethat the critical issue is the number of genes and that ils based_methods will have better accuracy than concatenation when the number of genes is large enough clearly further research is needed to understand which conditions favor each type of approach see section in supplementary_materials for more discussion of these issues 
