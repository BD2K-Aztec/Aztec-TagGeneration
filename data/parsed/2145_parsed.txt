gene_expression guidance for rna_seq co expression network construction and analysis safety in numbers motivation rna_seq co expression analysis is in its infancy and reasonable practices remain_poorly we assessed a variety of rna_seq expression data to determine factors_affecting functional_connectivity and topology in co expression networks results we examine rna_seq co expression data generated from rna_seq samples using a guilt by association framework in which genes are assessed for the tendency of co expression to reflect shared function minimal experimental criteria to obtain performance on par with microarrays were samples with read_depth m per sample while the aggregate network constructed shows good performance area under the receiver_operator the dependency on number of experiments used is nearly identical to that present in micro arrays suggesting thousands of samples are required to obtain gold_standard co expression we find a major topological difference between rna_seq and microarray co expression in the form of low overlaps between hub like genes from each network due to changes in the correlation of expression noise within each technology while rna_seq offers major_advantages over microarrays including higher dynamic range and whole transcriptome assessment it is not free of technical and biological biases these include dependencies on library_preparation sequencing_depth gene lengths gc_content and transcript lengths as well as other laboratory specific practices in the absence of careful experimental_design distinguishing gene_expression variability due to technical_artifacts and biological signal is challenging in addition the downstream impact of biases in rna_seq analysis will depend on the purpose to which it is being put our focus is on the development of appropriate standards and controls for rna_seq co expression analysis co expression networks use the correlation or related measures of gene_expression across multiple samples to ascertain common regulation and thus common functions co expression network_analysis in microarrays exists in broadly two discrete categories in the first case descended from the first coexpression analyses there are studies which are highly targeted toward conditions of interest with networks derived from relatively small numbers of samples dozens to the low hundreds and often focusing on broad network changes in some condition of interest with increasing data meta_analysis across many datasets became more common with samples numbering in the many hundreds_or typically the quality of co expression networks is measured using some variant of the guilt by association gba principle gba states that genes with similar functional properties will tend to interact or exhibit similar profiles in network data such as co expression even gold_standard expression datasets perform relatively poorly undergba when assessed in benchmarking exercises e g the mousefunc competition for genome_wide gene function predictionpena however meta_analysis across many datasets often improves_performance dramatically very few analyses to date have been performed on co expression networks from rna_seq although see e g with fewer conclusions drawn about their utility nor has their presumed novelty been fully assessed in the following we attempt to provide a better understanding of appropriate standards for rna_seq co expression analysis methodologically we begin with estimating expression from raw_data move to constructing individual networks examining aggregate properties and then finally consider a variety of machine_learning applied to the network at each stage we are concerned with what factors drive variation in constructed coexpression_networks first we are concerned with the functional_connectivity in the networks which we measure as a gba function prediction task using the cross_validation results to assess performance second we wish to assess network_features which may be important but not map to previously_characterized function and for this we focus on node degree node degree is central to network_topology and a major factor in numerous other properties at each stage of our analysis we define methods that yield reasonable_results for the downstream method our intent is not to re characterize e g normalization_methods in rna_seq nor to claim that we have identified an ideal means for future rna_seq coexpression analysis rather we attempt to define a habitable zone of methods which may be reasonably used without introducing major artifacts and which will allow the field to progress as individual researchers interpret their own data or conduct meta_analyses we observe a particularly strong role for number of samples and aggregation sections and in gba assessments while mapping and machine_learning sections and affect primarily topology and not gba we explain the discrepancy by finding topologically important genes vary readily section but primarily due to noise in the data section we analyze co expression from the raw expression data through transcript assembly and normalization to network construction and then on to meta_analysis through aggregation and machine_learning of gene function one difficult point to address is the interplay between method choices at each stage of our analysis to use every expression estimate pipeline in combination with every network construction technique in combination with every machine_learning algorithm and so forth is not practicable in general we use what we consider to be a mainstream method in other stages of analysis and then examine methodological variation within a given stage across a range of possibilities to determine robustness and dependencies as summarized in the appropriate way to assemble and assess rna_seq is still a topic of considerable_controversy while it might seem that these methodological discussions would need to be resolved to put rnaseq_data to use in co expression analysis we suggest that is not so co expression has frequently relied on the aggregation of diverse data and so many of the problems that affect rna_seq as a pure measure of transcriptomic activity may not have downstream importance in co expression use our results give a perhaps surprisingly consistent message simple basic approaches were among the highest performing from measuring network_connectivity spearman_correlation to functional inference neighbor voting similarly a simple rank andsummate aggregation across multiple datasets generates a more robust network capturing known biology with high efficacy in addition we have demonstrated that individual rna_seq networks exhibit a sample_size dependency very similar to microarray_data suggesting that technical issues are not at the heart of the noisiness of co expression data also important is the dependence on readdepth in rna_seq co expression our study suggests that m reads per sample with many samples is sufficient to build a network that is slightly divergent from random and adding such networks has no negative impact on the performance of the aggregate network thus when aggregating data it appears sensible to be extremely lenient in constructing inclusionary criteria recent suggestions for best rnaseq practices in differential_expression highlight a power improvement in adding biological_samples in a tradeoff with read_depth users of co expression data cannot naively apply those recommendations because the minimum number of samples is already relatively high and robustly measuring correlations may require an even greater increase in co expression analysis increasing_depth past m aligned_reads per sample and even thousands of samples continue to add value if our focus is on genome_wide functional inference for a given dataset so profound is the performance difference between aggregate and individual networks that it is difficult to recommend any minimum depth or sample count which is adequate certainly none in our case come close to producing the same apparent performance however more focused uses e g studying changes in expression across brain development may be permitted by more narrowly constructed datasets while our analysis does not find evidence to support the view that such uses will be higher performing in any way this may reflect our reliance on go as a reference even for narrowly defined functions since we have principally been concerned with measuring our network data in ways which generalize broadly our use of the go as a way of defining function is perhaps the most easily critiqued albeit hard to avoid and common while it is very encouraging that many of the methodological variations in rna_seq analysis do not negatively_affect functional inference or render it less robust it is natural to ask whether our measure of function is adequate since our results were virtually_identical using kegg and reactome as references we suggest our results are likely robust to most choice of reference data further to this the machine_learning algorithm selected has little influence on the results which also implies that the features being selected to make predictions determine connectivity and assess the networks are adequate for the task at hand in addition we think it is important to keep in mind that our evaluation of co expression gba is intended to be a proxy for comparative estimates of functional properties within the network in general it would have been relatively easy for us to inflate our performance by incorporating a stronger prior based on semantic data or go itself for example instead we used methods that we think are strongly likely to generalize to novel tasks at some cost to absolute performance disease studies that use a co expression network to derive interaction_partners and likely disease gene_candidates typically do so through measures such as node degree and modularity for instance see our interpretation of the topological shuffling we see between rna_seq and microarray is not that they are robustly different even though the significance is high but rather that the measurements are easily influenced by weak biases e g gene size the question is whether the bias is specific to one technology and if so which one our analysis suggests that the reordering reflects the tendency for low expressing genes to be correlated in microarray_data but that rna_seq allows us to identify which genes are too low to be trusted with much greater specificity further the low impact of variation in node degree on semisupervised learning e g through gba suggests that even without the appropriate filtering many methods adequately identify the absence of learnable features in noisy expression beyond simple read_depth and sample_size cut_offs we suggest a few bright line rules would likely advance network_analysis first any single dataset analysis intended to present targeted biological results should provide comparative_assessment on an aggregate network as a control this would help disentangle data and methodological dependencies when presenting results second the guidelines provided by seqc should be applied as a default for individual_datasets to diminish noise and ensure stability in meta_analyses we suggest using an approximation of the seqc guidelines as a uniform filter e g all transcripts with expression in the bottom third for or more of the samples be removed from the experiment third for smaller sample sized experimental_data more cautious statistical control can help better guard against artifacts we particularly recommend the use of non parametric statistics and resampling as baseline methods when an argument in favor of robustness cannot rest on meta_analysis in summary rna_seq offers unique virtues but is not a technical panacea co expression analyses will still require many samples and a reliable quality reference network as a control and comparative measure because of our reliance on pre_existing knowledge go or data microarray to provide reference knowledge we cannot readily assess rna_seq where its application is likely to prove most novel and exciting e g novel or more diverse transcript assessment unsupervised interpretation of rna_seq connectivity is unlikely to be robust to underlying methodological choices without careful filtering while methods that extract signals using training data supervised or semi_supervised methods appear to safely recover known information we make our networks available as a resource for other researchers at http gillislab labsites cshl edu supplements rna_seq networks 
