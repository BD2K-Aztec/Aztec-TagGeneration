data_and multi profile bayesian alignment model for lc_ms data analysis with integration of internal_standards motivation liquid_chromatography lc_ms has been widely used for profiling expression levels of biomolecules in various omic studies including proteomics metabolomics and gly comics appropriate lc_ms data preprocessing_steps are needed to detect true differences between biological groups retention time rt alignment which is required to ensure that ion intensity_measurements among multiple lc_ms are comparable is one of the most important yet challenging preprocessing_steps current alignment approaches estimate rt variability using either single chromatograms or detected peaks but do not simultaneously take into account the complementary information embedded in the entire lc_ms data results we propose a bayesian alignment model for lc_ms data analysis the alignment model provides estimates of the rt variability along with uncertainty measures the model enables integration of multiple sources of information including internal_standards and clustered chromatograms in a mathematically rigorous framework we apply the model to lc_ms metabolomic proteomic and glycomic data the performance of the model is evaluated based on ground_truth data by measuring correlation of variation rt difference across runs and peak matching_performance we demonstrate that bayesian alignment model improves significantly the rt alignment performance through appropriate integration of relevant_information availability_and matlab_code raw and prepro cessed lc_ms data are available atliquid chromatography mass_spectrometry lc_ms has been an indispensable tool in various omic studies including proteomics metabolomics and glycomics each lc_ms run generates data consisting of thousands of ion intensities characterized by their specific retention time rt and mass to charge ratio m z values thus enabling comprehensive profiling of a variety of biomolecules this high_throughput technique is widely_applied to identify candidate markers whose expression levels change between groups of distinct biological conditions to ensure an unbiased comparison of the ion intensities several preprocessing_steps including peak_detection rt alignment peak matching and normalization need to be appropriately handled typically these preprocessing_steps generate a list of detected peaks with their rts m z values and intensities which are subsequently_analyzed using statistical_tests to identify significant differences in ion intensities one crucial step is the correct matching of unique peaks across multiple lc_ms with the advances in mass_spectrometry technology it is now possible to achieve highly_precise and accurate_mass however controlling the chromatographic variability is still a challenging_task this often results in substantial variation in rt across multiple lc_ms raising significant challenges in the preprocessing pipeline without appropriate correction of rt the peak matching step is error_prone and the subsequent analysis may yield misleading_results alignment_methods can be categorized as i feature based_approaches and ii profile based_approaches most current approaches perform rt alignment and peak matching based on a set of peaks identified upfront the two steps are either carried_out sequentially or combined into a unified module the feature based_approaches rely on the correct identification of a set of consensus peaks across lc_ms however this consensus list cannot be adequately determined based on unaligned data this in turn will affect the alignment results due to erroneously matched peaks in addition the results are highly dependent on the method used for peak_detection the prioritization of the detected peaks based on their quality and the handling of missing peaks moreover estimation of rt variation is limited to only a subset of time points which is usually not as accurate as considering the whole chromatograms as done in the to whom correspondence should be addressed profile based_approaches profile based_approaches accomplish this by considering a prototype function that represents the underlying pattern across the observed chromatograms and estimating a set of mapping_functions that characterize the relationship between the prototype function and the chromatograms appropriate utilization of the whole chromatogram allows improved estimation of the rt variation characterized by the mapping_functions however this requires that a representative prototype function be reliably selected or estimated which is still a challenging_task for the majority of profile based_approaches using pairwise time warping techniques we previously_proposed a profile_based method that uses single ion chromatogram e g base peak chromatogram to estimate both prototype and mapping_functions for rt alignment the method has been shown to have better performance than other profilebased methods however there were unresolved_issues including the following i lack of integration of informative prior_knowledge e g internal_standards and ii implicit assumption of the existence of an underlying pattern based on a single ion chromatogram in the present work we propose a bayesian alignment model bam to address the aforementioned issues bam combines the strength of both feature_based and profile based_approaches by incorporating comprehensive_information such as multiple representative chromatograms and internal_standards the use of multiple chromatograms is considered in a few studies by either binning the lc_ms data or using all the extracted_ion with acceptable_quality however a suitable procedure to use multiple representative chromatograms while retaining computational feasibility is currently not available we propose a clustering approach to identify multiple representative chromatograms from each lc_ms run the chromatograms are simultaneously considered in the profile_based alignment to facilitate the estimation of the prototype and mapping_functions moreover we incorporate gaussian_process gp regression to estimate the rt variation based on the peaks of internal_standards the use of internal_standards enables a high_confidence estimation of rt variations which avoids the ambiguity in identifying consensus peaks encountered in the feature based_approaches the inferred information is used as the prior of the mapping function for profile_based alignment the integration of internal_standards proceeds through weighing uncertainty measures of the regression estimate information on internal_standards affects the posterior estimation via the gp prior rather than just providing an initial estimate of the mapping function this is in contrast to existing_methods that rely on internal_standards merely as landmarks and do not use them for further adjustment we apply bam to lc_ms metabolomic proteomic and glycomic data a consensus list of the ground_truth data is used to evaluate the rt difference across runs the coefficient of variation cv of extracted_ion and the peakmatching performance in terms of precision and recall the simultaneous multiple_alignment sima model which has shown outstanding performance for the benchmark_datasets in is used to perform the peakmatching step the remainder of this article is organized as follows section introduces the proposed profile_based bam including the specification of a gp prior that uses information from internal_standards and the chromatographic clustering approach to perform multi profile alignment section_describes lc_ms datasets from metabolomic proteomic and glycomic studies section demonstrates the application of bam on these datasets finally section concludes the article with a summary and possible extensions in future work we evaluate the alignment results based on the consensus list of the ground_truth data specifically we compare the rt difference across lc_ms the cv of extracted_ion and the peak matching_performance the rt difference measures the difference between the largest and smallest rts for a consensus peak the cv evaluates the variability across chromatograms the peak matching_performance is evaluated through precision and recall of the peak matching results against the ground_truth data as defined inand provided in the supplementary_material the sima model is used for the peak matching step internal_standards are not included in the evaluation as they are directly used in the alignment process for confirmation purpose we provide the alignment result in the supplementary_material as there is no information about internal_standards in the metabolomic dataset the gp prior was not applied in this dataset and only sp alignment was performed the prior of the mapping function coefficients i in this case is specified via a slope value and it is assumed to follow a normal distribution with mean i j and variance truncated below by means standard_deviations of the rt difference and cv values are compared based on the ground_truth peaks where the rt values are in seconds rt differences before and after alignment are and respectively and cv values before and after alignment are and respectively although the rt alignment leads to a reduction of both rt difference and cv values the peakmatching performance evaluated by precision recall is barely improved i e before alignment and after alignment this is partly owing to the fact that rt variation is relatively small in this dataset in addition as the ground_truth data were generated based on ion annotation further examination of the data is needed more details and discussion are provided in the supplementary_material summarizes the results in the lc_ms proteomic and glycomic datasets for the following procedures no alignment performed to adjust the peak lists raw alignment performed using a gp regression as defined in equation sp alignment performed with no information about internal_standards sp alignment performed with a gp prior gpsp and multi profile alignment performed four chromatograms identified by the clustering procedure of section with a gp prior gpmp each procedure was followed by a peak matching step using sima most current lc_ms preprocessing pipelines do not adjust the peak lists detected upfront raw and directly apply a peakmatching procedure sp alignment represents the current profile_based models including our earlier study where a single chromatogram is considered without using any information about internal_standards when chromatographic patterns are well captured by the base peak chromatogram as in the proteomic dataset the sp approach yields reasonable alignment result integration of internal_standards gpsp and a in this article we propose a bam for lc_ms data analysis bam improves on existing alignment_methods by i using gp prior derived from internal_standards and ii considering multiprofile modeling with representative chromatograms identified by a clustering approach application of the method to various lc_ms datasets shows that the proposed alignment approach greatly_facilitates the subsequent peak matching process by appropriate utilization of available information which is often overlooked by current methods although this article focuses on using internal_standards to derive the gp prior it is also possible to specify the gp prior for the mapping relationship based on the identification of ms_ms or targeted compounds the alignment model proposed here considers underlying patterns for lc_ms in samples drawn from the same biological group when samples arise from different biological subgroups the model needs to be extended to account for the heterogeneity across these subgroups future work will focus on developing a unified_approach that allows the simultaneous alignment of samples from multiple biological groups to ensure coherence in the processing step and data comparability the lc_ms raw_data the preprocessed peak lists and the ground_truth data used in this article have all been made publicly_available to serve as a benchmark for the evaluation of new preprocessing methods note precision and recall are compared between cases where g chromatograms g are derived either by binning along m z or using the chromatographic clustering procedure 
