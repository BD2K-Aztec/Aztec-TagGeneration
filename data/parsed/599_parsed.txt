automated cellular annotation for high_resolution images of adult caenorhabditis_elegans motivation advances in high_resolution microscopy have recently made possible the analysis of gene_expression at the level of individual cells the fixed lineage of cells in the adult_worm caenorhabditis_elegans makes this organism an ideal model for studying complex biological_processes like development and aging however annotating individual cells in images of adult c elegans typically requires expertise and significant manual effort automation of this task is therefore critical to enabling high_resolution studies of a large_number results in this article we describe an automated method for annotating a subset of cells including various muscle intestinal and hypodermal cells in high_resolution images of adult c elegans we formulate the task of labeling cells within an image as a combinatorial_optimization where the goal is to minimize a scoring_function that compares cells in a test input image with cells from a training atlas of manually_annotated worms according to various spatial and morphological_characteristics we propose an approach for solving this problem based on reduction to minimum cost maximum flow and apply a cross entropybased learning algorithm to tune the weights of our scoring_function we achieve median accuracy across a set of cell labels in this highly_variable system these results demonstrate the feasibility of the automatic_annotation of microscopy based images in adult c elegans contact comprehensive gene_expression using high_resolution images from in situ_hybridization or fluorescent_reporter experiments has become feasible owing to advances in imaging_technology and the growing availability of genomic resources image_based gene_expression analysis is especially promising for the study of caenorhabditis_elegans as the fixed developmental lineage of all cells in the adult_worm permits at least in principle direct comparison of expression values of reporter_genes in analogous cells from different individuals in practice however the process of identifying the cells in an image of an adult_worm is usually performed_manually which is extremely tedious and time consuming owing to the significant expertise required for accurate cell identification most in situ analyses of gene_expression in adult c elegans to date have been limited to much lower regional resolution a crucial step in making high_resolution global_gene possible in the worm is to develop computational_approaches that can extract expression data from images thereby allowing high_throughput conversion of unstructured image data into well structured gene_expression tables suitable for computational_analysis previous methods for single_cell gene_expression analysis in model_organisms have largely relied on time series information and region markers to map the locations of individual cells in c elegans however tracking cell_lineages is extremely_difficult after the embryonic_stage owing to the amount of time required for monitoring the development of each individual worm and the large morphological changes that take place during development therefore techniques that allow mapping of single cells without the assistance of time series information are needed for worms in the first larval_stage l following embryonic_development the absolute and relative spatial_locations of individual cells are highly constrained based on this insight a marker guided spatially constrained bipartite matching algorithm was previously_developed for labeling cells in d images of l worms this method was shown to achieve high_accuracy for annotating out of the cells present in the l developmental_stage for adult c elegans however the cell_labeling task is substantially more difficult in addition to a near doubling of the number of somatic_cells from to thousands of germ_line cells are also present in the adult_worm resulting in total cells the additional germ_line cells occupy locations near somatic_cells of interest throughout the trunk of the worm which poses a substantial difficulty for annotation approaches that rely on location based features alone moreover the number of somatic_cells is variable in the adult_worm unlike worms at the l stage further decreasing the effectiveness of spatial cues for cell identification methods have been proposed that combine the segmentation of cells from the d images and their label annotation into a single step for the l worm to improve the overall accuracy on the set of muscle cells this method requires cell specific markers to be consistently expressed in a subset of cells and again relies on an invariable cell_lineage to whom correspondence should be addressed the author published_by this is an open_access the terms of the creative_commons http creativecommons org_licenses which permits non commercial re use distribution and reproduction in any medium provided the original_work for commercial re use please_contact permissions_oup commore concretely although the adult c elegans is post_mitotic meaning no additional somatic cell_divisions take place once development is complete not every individual produces precisely the same number of cells in our data we have observed a high_degree in a set of four intestinal cells which may each undergo one additional division to give rise to two daughter_cells to accurately assign labels to the cells in an individual it is crucial to recognize whether the parent intestinal cell or the two daughter_cells are present in this article we formulate the problem of labeling cells in d images of adult c elegans as a combinatorial_optimization our method builds on prior work by using a rich scoring_function that incorporates additional features beyond spatial_location such as cell size intensity of a muscle marker gene and neighborhood density we extend our formulation to accommodate the cell number variation that arises owing to post embryonic cell_division finally we show how to solve the resulting optimization_problem efficiently via reduction to minimum cost maximum flow and describe a straightforward cross entropybased algorithm for fitting parameters of the model we test the method on a set of manually_curated images of day adult_worms using our algorithm we achieve median accuracy on a subset of cells in the adult_worm demonstrating the feasibility of automated methods for this task creating automated techniques to annotate individual cells based on their unique cell labels in the organism c elegans makes single_cell studies possible for non experts and provides assistance for experts to perform analyses more rapidly the manual_curation of the automatically segmented cells can be performed in a few hours for which the cells can be rapidly annotated at high_accuracy in contrast manual_segmentation and annotation of the cells in d for a well trained biologist takes on the order of days x liu personal communications to truly enable widespread research of single cells in images high_fidelity labeling of cells must be possible this work demonstrates the potential of automatic techniques to succeed in the adult organism in c elegans existing_approaches creating digital atlases in the developing embryo and larvae l proved to be poorly suited for the challenges of the adult_worm as described earlier in particular the previousin black we show the accuracy using an untrained model considering location alone the gray histogram gives the per cell accuracy counts of the untrained model incorporating additional features in white we show the model with weights learned for these set of features and estimated means and variance for all cell labels including other cellsnote the model included the scoring of unlabeled cells the per worm accuracy is computed for each worm using equation the table reports both the per worm and the per cell label accuracies including their median mean and variance in separate columns across the test worms the use of the same approach instead we created a more complex model in which we learned the weights for a richer set of features including cell characteristics of location and morphology what is more the bipartite matching approach used in the l was prohibitively slow for training a full adult model given the number of cells as a result learning feature weights required a new formulation using network flow enabling the successful training of a more complex cost_function we believe this work demonstrates the utility of using such a rich model to generate these high_confidence labels the improvements in accuracy given in the results section provide evidence of the benefit of including morphological_features in atlasbased modeling of c elegans future work might consider incorporating meta features such as posterior_probabilities of a classifier that identifies tissue_types into the pipeline such an approach can mimic the behavior of the expert annotator who generally first identifies the tissue type of a cell e g intestine then assigns it the lineage_specific label selecting from those available within its tissue type alternatively incorporating such classifier probabilities directly into a cost_function may result in a more flexible model however for the set of cells labeled in this work the most salient_features of the tissue were modeled directly in the scoring_function e g size for intestinal cells in the future training data will include cells from additional tissue_types at this time inclusion of tissue classifiers might prove valuable particularly in the case of neurons these classifiers might distinguish small cells from over segmented cell fragments for example a confounding_factor in the annotation_process is the variability in the number of cells for example we identified a set of intestinal cells where we observed variable cell_divisions that is at times they underwent an additional cell_division resulting in the presence of two daughter_cells rather than the single_parent identified in the known somatic_cells such variability cannot be properly represented by a traditional bipartite matching approach this article_presents a solution that through the construction of a special network_structure for solving the annotation problem enables the selection of either the parent or the two daughters explicitly although achieving good accuracy the current construction requires a post_processing step to identify the presence of a second intestinal like cell future work might include developing a method that does not rely on the identification of a single additional cell in the division but rather identifies either one large parent cell or simultaneously both daughter_cells we also observed an anterior intestinal cell ventral that divided just once in the worms used in this work this was not modeled owing to the infrequency of the cell_division however this observation indicates that there is likely further variability that has not yet been observed with increasing amounts of data additional variability can be modeled explicitly to further improve cell annotation what is more it may be possible to model the co occurrence of these cell_divisions some weak evidence_exists in this dataset indicating that two intestinal cells might be correlated in their division patterns however the relatively small amount of data makes_it to obtain statistical_significance and therefore a model that takes into consideration the co occurring cell_divisions is left for future work finally extending the annotator to include labels for more of the total known cells will be most valuable in addition to creating a more complete model of the worm it will also improve overall annotation accuracy we believe this work has provided evidence for such potential gains in the fidelity of automated cell_labeling through the inclusion of more cell labels in this work we achieved an improvement in accuracy by modeling the cells that did not receive a unique cell_lineage label which we call the dud label yet even the models including the duds could be further extended there is significant variability within the set of unlabeled cells as it comprises many eggs sperm_cells neurons hypodermal cells and pharyngeal cells just to name a few it is possible to create a larger set of dud labels with more homogeneous features representing the different subclasses within the unlabeled cells e g the oocytes in the germ_line therefore the groups of duds can be mapped to their correct subtype in summary we believe future work must focus on extending the annotation_process by using more labels or by identifying additional subgroups to further improve accuracy with more data richer models can be built to account for cell_division variability and inclusion of additional features the ultimate_goal is a larger model that labels a large proportion of all cells that are uniquely and reproducibly identifiable in the adult_worm this work represents the first step toward such a goal and provides a rich modeling_approach capable of scaling with such extensions in this article we present a method capable of annotating a set of single cells in images of adult c elegans at a median accuracy of the work develops a novel framework for producing labels for cells that is able to handle the additional challenges present in the adult_worm that previous methods created for earlier_stages in the worms development are not able to handle these challenges include the increase in the number of cells and variability in cell location and cell_divisions we address these challenges through training a rich model that incorporates morphological and spatial features constructing a special network_structure and explicitly modeling cells that receive nonunique labels by reducing the computational_complexity in using a minimum cost maximum flow algorithm we make feasible a cross entropybased learning algorithm to tune the weights of the features in our scoring_function and ultimately train a more accurate model that is capable of handling the variable cell_divisions as a result we demonstrate that the inclusion of additional features and the reformulation of the traditional approach to the label assignment make possible the training of a richer model to improve accuracy furthermore we also demonstrate that inclusion of more cells in addition to more features leads to gains in accuracy for all cell label assignments 
