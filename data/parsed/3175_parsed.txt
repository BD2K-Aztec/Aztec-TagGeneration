genome_analysis multivariate welch t test on distances motivation permutational non euclidean analysis_of permanova is routinely used in exploratory_analysis of multivariate datasets to draw_conclusions about the significance of patterns visualized through dimension_reduction this method recognizes that pairwise distance_matrix between observations is sufficient to compute within and between group sums of squares necessary to form the pseudo f statistic moreover not only euclidean but arbitrary distances can be used this method however suffers from loss of power and type_i inflation in the presence of heter oscedasticity and sample_size imbalances results we develop a solution in the form of a distance based welch t test t w for two sample potentially unbalanced and heteroscedastic data we demonstrate empirically the desirable type_i and power characteristics of the new test we compare the performance of permanova and t w in reanalysis of two existing microbiome datasets where the methodology has originated availability_and the source_code for methods and analysis of this article is available at https github com alekseyenko tw further guidance on application of these methods can be obtained from the author the permanova test has been proposed for use in numerical ecology to test for the location differences in microbial_communities the relationships between these communities are typically described by ecological distance metrics e g jaccard chisquared bray curtis and visualized through dimension_reduction also referred to as ordination in numerical ecology literature the permanova permutation_test based on pseudo f statistic computed directly from distances is a widely_accepted means of establishing statistical_significance for observed patterns this test and the extension of this paper are related to the multivariate behrensfisher problem of testing the difference in multivariate means of samples from several populations the underlying statistics for both distance based tests are related to the hotelling t statistic the permanova is more general in allowing for more than two populations to be compared simultaneously the distance based geometric approach however forgoes the need to estimate the covariance_matrices the cost of these geometric approaches is that they only provide omnibus tests which are unable to make inferences about individual components of the multivariate random vectors tested with the revived interest in numerical ecology fueled by the availability of dna_sequencing based high_throughput microbial_community profiling i e microbiomics the permanova test is enjoying a new wave of popularity several cautionary articles have been published noting the undesired behavior of the test in heteroscedastic conditions a definitive principled solution to this issue is still lacking however the consensus is to ascertain the presence of heteroscedasticity using an additional test e g permdisp in case of positive permanova results and to report both with a disclaimer that the attribution of positive permanova test to location or dispersion differences cannot be made whenever both tests yield positive results in reality the exactly matching multivariate spread between factor levels can rarely be assumed and the robustness of permanova to violations of homoscedasticity has not been characterized empirically by derivation t w inherits the characteristics of the univariate unequal variance welch t test that test is recommended as a replacement for pooled variance t test in all circumstances testing for unequal variances by methods such as permdisp is not recommended before a choice of the primary test is made the main disadvantage of the welchs t test compared with anova is potential loss of robustness when violations of normality are present this issue however rests on the limiting distributions of the tests in our case the inference is obtained by permutation_testing which alleviates this concern thus t w should also become a first line replacement for permanova in simple two sample case two sample scenario is a common experimental_design but a general solution for k level factors is still desirable the behavior of permanova under heteroscedastic conditions with k level factors have not been examined but is suspected to suffer from similar shortcomings as in the two sample case when heteroscedasticity is suspected several remedial strategies can be implemented first a variance stabilizing transformation can be applied to the data to remove heteroscedasticity if transformation of the data is not desirable for any reason other strategies could include developing specialized sub sampling and permutationbased strategies for example the data could be re sampled m times at balanced sample_sizes and an average permanova statisticthis statistic could then be compared with the null_distribution generated by permuting the sample labels rtimes and computing the re sampled f a f a r wherethe significance can be determined by using regular permutation_testing approach to compare the number of times the obtained statistic is more extreme than those observed under the null i e p r p r j f a f a j this method ensures that the groups are balanced in each comparison but may still lead to loss of power due to decreased effective_sample in each sub sampled comparison this approach is reported here as a suggestion that needs further development and evaluation before in can be implemented in practice the final strategy for analysis of data with arbitrary number of levels could involve the application of t w to only relevant pairwise_comparisons with appropriate multiple comparison controls in place 
