bioimage_informatics graph_based peak alignment_algorithms for multiple liquid_chromatography datasets liquid_chromatography to mass_spectrometry lc_ms is the dominant technological platform for proteomics an lc_ms analysis of a complex biological_sample can be visualized as a map of which the positional coordinates are the mass to charge ratio m z and chroma tographic retention time rt of the chemical_species profiled label_free quantitative_proteomics requires the alignment and comparison of multiple lc_ms maps to ascertain the reproducibility of experiments or reveal proteome changes under different conditions the main_challenge in this task lies in correcting inevitable rt shifts similar but not identical lc instruments and settings can cause pep tides to elute at very different times and sometimes in a different order violating the assumptions of many state of the art alignment tools to meet this challenge we developed lwbmatch a new algorithm based on weighted bipartite matching unlike existing_tools which search for accurate warping functions to correct rt shifts we directly seek a peak to peak mapping by maximizing a global similarity function between two lc_ms maps for alignment tasks with large rt shifts s an approximate warping function is determined by locally weighted scatterplot smoothing of potential matched features detected using a novel voting scheme based on co elution for validation we defined the ground_truth for alignment success based on tandem_mass identifications from sequence searching we showed that our method outperforms several existing_tools in terms of precision and recall and is capable of aligning maps from different instruments and settings availability available at https sourceforge net_projects rt alignment liquid_chromatography lc_ms is the dominant technological platform in proteomics capable of profiling thousands of proteins in the biological_sample in a high_throughput and sensitive_manner in the most popular workflow of shotgun_proteomics proteins in a complex_mixture are first digested into small_peptides which are then separated_by and eluted through an electrospray ion_source into the mass_spectrometer in the mass_spectrometer the peptide ions are separated by their massto charge ratios m z and converted to an electrical signal the intensity of which is a measure of abundance of the peptide ion taken together lc_ms data are three_dimensional with each peptide ion represented by three coordinates its chromatographic retention time rt its m z and its signal_intensity in some instruments an additional step of tandem_mass ms_ms or ms can be taken to fragment each peptide yielding fragment_ion ms spectra from which the peptide can be identified by computational_methods an lc_ms map can therefore be viewed as a comprehensive and quantitative profile of the proteome being analyzed many proteomics experiments rely on comparisons of lc_ms maps of different samples for these experiments it is necessary to match the peak originating from the same peptide in different lc_ms maps this task can be easily accomplished if the m z and the rt coordinates of the same peptide stay constant in many lc_ms the m z values usually vary within a limited and predictable range which depends on the mass resolution of the mass_spectrometer however the rt of a specific peptide heavily depends on the instrument conditions and the composition of the mixtures for many technical reasons even the same sample analyzed by the same instrument with the same settings can generate different lc_ms maps with shifts and distortions in the rt dimension this fact makes the association of the same peptides across lc_ms maps difficult because the shift of any two lc_ms maps cannot be known in advance to find the corresponding peptides in the different lc_ms maps time alignment must be conducted the ultimate_goal of time alignment is to match peaks that belong to the same peptides across different lc_ms maps based on the type of input_data on which the alignment algorithm operates lc_ms alignment_methods can be categorized into profile based_methods and feature based_methods profilebased methods directly process the raw_data obtained in the lc_ms experiment aiming to avoid errors introduced by a feature finding algorithm the early profile based_methods compare only the difference in total ion chromatograms tic which is the sequence of the sum of all signals at each time point typical methods used in aligning tic include dynamic time warping dtw correction optimized warping cow parametric time warping ptw and continuous hidden_markov hmm tic based_methods make little use of to whom correspondence should be addressed the whole lc_ms map disregarding most of the useful information at the m z dimension that can help alignment therefore recent_approaches tried to use more information available in the lc_ms maps by applying these time warping methods to many isolated ion chromatograms at different m z values or by defining the spectral similarity of corresponding mass_spectra as the objective_function to be maximized in general profile based_methods can produce more accurate alignment results but they are computationally_expensive and may require more resources in terms of computer cycles and memory especially for multiple_alignments another limitation of the aforementioned methods is that they only allow shifting stretching or shrinking of the time axis and cannot deal with the reversal of elution order a recent_publication suggested that elution order reversals are not rare especially at fine timescales and when the lc_ms maps are acquired in slightly different settings feature based_approaches operate on features in the lc_ms map detected by a feature finding algorithm which tries to distinguish between peptide features and irrelevant noise in the lc_ms experiment the resulting feature list which condenses the raw_data into m z rt coordinates of interest are used in the subsequent alignment many feature_based alignment_algorithms have been developed either implemented as stand alone tools or as a part of software platforms for label_free quantitative_proteomics examples are mzmine katajamaa and oresic oresicoresic mapaligner in openms superhirn xcms specarray and xalign except mzmine which simply attempts to find peak matches within a tolerance window all of these methods attempt to estimate a linear mapaligner xalign or nonlinear warping function others to correct the rt axis more recently zhang has proposed a divide_and algorithm that can handle both low_resolution and high_resolution lc_ms maps propose a novel feature matching algorithm using a robust nonparametric kernel type regression_model to detect a nonlinear alignment and a wavelet_based method to incorporate peak shape_information for resolving ambiguous matches in contrast to profile based_methods feature based_approaches typically rely on high_resolution data for effective feature finding whereas profile based_methods are generally able to work well on low_resolution lc_ms data time alignment_methods for lc_ms data are reviewed in a berg et_al in amt methods the objective is to associate each peptide with the m z and rt coordinates at which it is expected to be found such that peaks detected in future lc_ms can be identified to the originating peptides without the help of ms_ms to correct for potential rt shifts caused by instrument noise or changes in experimental_conditions amt methods also need to perform time alignment but in a different manner given the peptide_identifications amt methods typically attempt to associate the raw rt with a predicted hydrophobicity measure of the peptide and store these in an amt database usually specialized to each biological_sample then subsequent lc_ms maps from the same sample are analyzed by first converting raw rt into a hydrophobicity measure usually using information of the elution gradient program and then searching the coordinates in the amt database to find the closest matched peptide amt methods are therefore theoretically capable of aligning lc_ms maps across vastly different conditions as time alignment is assisted by the knowledge of the peptide_identification and the elution gradient potentially large rt shifts caused by differences in elution conditions can be corrected however amt methods depend on the availability of peptide_identifications and the accuracy of hydrophobicity predictions and may not be generally_applicable to all types of lc_ms data in this article we propose a feature_based lc_ms alignment_method called lwbmatch based on maximum weighted bipartite matching lwbmatch is a multiple alignment_method that is capable of aligning maps with large systematic and nonlinear rt shifts similar to other feature based_methods an optional preliminary step first extracts likely matching features in the lc_ms maps to detect potential large rt shifts a warping function is then fitted by locally weighted scatterplot smoothing lowess however unlike existing_methods that try to determine the warping function accurately on a fine timescale our warping function needs only to be approximate and mainly serves to bring matching features into proximity the key innovation of our method is the subsequent step that relies on a global maximization algorithm based on weighted bipartite matching to match features exhaustively producing an optimal feature to feature mapping that maximizes the similarity between two lc_ms maps as a result small elution order changes of the peptides and other rt variations caused by instrument noise will have minor effects on the performance we demonstrate that our method can align lcms maps generated from the same conditions even without the warping step and can also handle maps generated from different instruments and settings after approximate warping we also show that our method outperforms three existing feature_based alignment_methods 
