mettailor dynamic block summary and intensity normalization for robust analysis of mass_spectrometry data in metabolomics downloaded from motivation accurate cross sample peak alignment and reliable intensity normalization is a critical step for robust quantitative analysis in untargetted metabolomics since tandem_mass ms_ms is rarely used for compound identification therefore shortcomings in the data processing_steps can easily introduce false_positives due to misalignments and erroneous normalization adjustments in large sample studies results in this work we developed a software_package mettailor featuring two novel data preprocess ing steps to remedy drawbacks in the existing processing_tools first we propose a novel dynamic block summarization dbs method for correcting misalignments from peak alignment_algorithms which alleviates missing_data problem due to misalignments for the purpose of verifying correct realignments we propose to use the cross sample consistency in isotopic intensity ratios as a quality metric second we developed a flexible intensity normalization procedure that adjusts normalizing factors against the temporal variations in total ion chromatogram tic along the chromatographic retention time rt we first evaluated the dbs algorithm using a curated metabolomics dataset illustrating that the algorithm identifies misaligned peaks and correctly realigns them with good sensitivity we next demonstrated the dbs algorithm and the rt based normalization procedure in a large_scale data_set featuring sera_samples in primary dengue infection study although the initial alignment was successful for the majority of peaks the dbs algorithm still corrected misaligned peaks in this data and many recovered peaks showed consistent isotopic patterns with the peaks they were realigned to in addition the rt based normalization algorithm efficiently removed visible local_variations in tic along the rt without sacrificing the sensitivity of detecting differentially_expressed metabolites availability_and the r package mettailor is freely_available at the sourceforge website_http mettailor sourceforge net mass_spectrometry ms coupled with gas or liquid_chromatography gc_ms or lc_ms is already the technology of choice in the metabolomics literature in the experiment hundreds to thousands of compounds elute through the chromatography column at varying_rates resulting in separation of compounds across the retention time rt the compounds are then ionized and analysed by the ms in which the mass to charge ratio m z and the intensity of ions are determined in the untargeted setting compound identification is typically achieved by searching the mono isotopic mass of each peak against a large_scale database of compounds by exact mass values such as the hmdb massbank and metlin to name a few quantitative data analysis is then performed using the corresponding peak_intensity or integrated peak_area in each sample despite conceptual similarity extraction of peak features with precise compound identification has proved to be a challenging_task in untargeted metabolomics in particular the lack of the identification step via global scale ms_ms makes cross sample matching of peak feature data so_called alignment as the most crucial data_extraction step this is because multiple compounds of a similar or identical mass with slightly different chemical_structure isomers and different elemental_composition can co elute and they are simultaneously analysed creating mixed signals without the ms_ms evidence the intensity signals for such molecules will be aligned together being treated as the same compound on the other hand when thousands of features are processed across a large number of samples it is also possible that the same compound can be misaligned across the samples and subsequently treated as different compounds in the statistical_analysis stage hence accurate data_extraction and robust preprocessing_steps are prerequisite for successful untargeted metabolomics analysis the general workflow for ms data preprocessing consists of several steps first peak_picking algorithms are applied to identify the ion chromatograms with robust isotopic patterns and each of them is reported as a peak feature with three_dimensional coordinates m z value retention time and peak_areas intensities often aggregated over isotopes and adducts into a major_peak feature next the peak alignment step removes the variations in both rt and m z axes for the same compounds across the samples aligning the extracted peaks to the same m z and rt grid to a single identifier the aligned peak_intensity data are then further processed by a normalization procedure prior to statistical_analysis to remove the systematic_bias introduced during sample_preparation and the variation in the ionization efficiency and instrumental_analysis common choices for normalizing metabolomics ms data include total intensity sum tis internal_standard calibration isc or a statistical_model that combines standards and tis although the existing open_source software_packages such as mzmine and xcms perform peak_picking and alignment there is room for further improvement in our observations for example even the most sophisticated multi sample alignment_algorithms have been prone to misalignment error at the individual compound level especially for less abundant compounds or multiply charged compounds misalignment tends to happen when i signal detection_algorithms fail to separate co eluting compounds ii peak_picking algorithms identify incorrect major isotopic peaks or iii minor temporal_variation outlasts the alignment step by a few seconds of rt or a few decimals in the m z beyond the tolerance level specified in those algorithms besides the misalignment issue the existing_methods for data_normalization also have limitations for example the internal_standard measurements can be inaccurate in some samples or mixed with co eluting compounds the tis method may fluctuate due to poor chromatographic_separation or the influence of a few dominantly abundant compounds and it can also be inapplicable when the detected compounds are genuinely heterogeneous between comparison groups most importantly the procedures mentioned above are corrections by a single constant which adjusts all intensity values for global bias only and does not account for temporal or local_variations along the rt axis across different samples to address these two key limitations in the current data_processing pipeline we developed a software_package mettailor which implements two post extraction processing_steps including a method for block wise quantitative summary and a novel rt based local normalization procedure overall our contribution in this work is to provide an open_source software_package implementing two data processing_steps as a complimentary tool to remedy some gaps unaddressed by the popular data_extraction tools in the context of large sample experiments there are a number of experimental factors that are unique to ms platforms and the two proposed methods are different from the existing alternatives that had been developed for other omics platforms such as gene_expression we provide these tools in a popular r programming environment and will continue to adapt the tools for constantly_evolving instrumentation in the future 
