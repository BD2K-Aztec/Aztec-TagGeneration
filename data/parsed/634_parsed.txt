sequence_analysis a web_application for sample_size and power calculation in case control microbiome_studies when designing a case_control to investigate differences in microbial_composition it is fundamental to assess the sample_sizes needed to detect an hypothesized difference with sufficient_statistical our application includes power calculation for i a recoded version of the two sample generalized wald_test of the hmp r package for comparing community_composition and ii the wilcoxon mann_whitney for comparing operational_taxonomic specific abundances between two samples optional the simulation based power calculations make use of the dirichlet multinomial model to describe and generate abundances the web_interface allows for easy specification of sample and effect_sizes as an illustration of our application we compared the statistical_power of the two tests with and without stratification of samples we observed that statistical_power increases considerably when stratification is employed meaning that less samples are needed to detect the same effect_size with the same power availability_and the web_interface is written in r code using shiny rstudio inc and it is available at https fedematt shinyapps io shinymb the r code for the recoded generalized wald_test can be found at https github com mafed mswaldhmp a pivotal aspect of planning a case_control is the calculation of sample_sizes which is typically based on the costs of data_collection and on the need to have sufficient_statistical for detecting a relevant difference between cases and controls power can only be computed if the researchers can specify i the smallest relevant deviation from the null_hypothesis that is to be detected at some specified significance_level and ii a realistic guess of the variability in the sample we model microbiome data with the dirichlet multinomial dm distribution it is described by two parameters the overdispersion parameter h which measures the within sample excess of variability w r t a multinomial distribution and the vector of relative_abundances p depending on the research_question each element of p refers to a single operational_taxonomic otu or to a species genus or any other rank in the microbial taxonomy in many microbiome_studies the null_hypothesis can be expressed as h p p where the indices and refer respectively to the controls and cases the null_hypothesis thus expresses equality of community_composition proposed to test this null_hypothesis with the generalized wald_test of koehler and wilson for other applications researchers are interested in differential abundance for k specific otus the null_hypotheses of interest are then h p j p j j k where the index j refers as well as the non parametric wilcoxon mann_whitney wmw test but correcting for multiple testing is required it is usually hard to specify the smallest relevant deviation from h particularly when the p vectors are large in the web_application p controls is specified by the user in an interactive way with several possible choices while p cases is based on p with some user selected otus showing a modified relative_abundance referred to as the requested otus for the other otus referred to as the unrequested otus the relative_abundances are altered to make the entries in p add up to it is also possible to estimate p and h from user uploaded data for ease of presentation both vectors p and p are ordered according to the decreasing order of relative_abundances in p our application allows the simulation based statistical_power to be computed either for a specific pair of sample_sizes balanced or not named power option in the application or for a range of sample_sizes only balanced named power option in the application powers for both the generalized wald_test for comparing community_composition and the wmw test for comparing relative_abundances of specific otus are implemented sometimes biological_samples can be classified into strata a multicenter_trial is a typical example but stratification may also arise when age gender or any other baseline information is used in the design stage to account for population heterogeneity power calculation for stratified designs is also implemented in the web_application and we illustrate its use with enterotypes as strata enterotypes can be described as microbiome profiles to which a sample can be said to belong more details on the topic can be found in although enterotypes have to be used with care as a stratification factor they can only be identified after sequencing power calculations are still correct as long as differences between cases and controls are not confounded by the enterotype moreover over sampling may be needed to ensure that the required number of subjects is acquired in the least frequent stratum or when accounting for drop out during the study using hmp stool_samples data we compared the powers of the generalized wald_test a with and without stratification by enterotype the sample_size was set to in both groups the four most abundant otus of p were set and higher than those in p the resulting power was much larger for the stratified wald_test going from without to with stratification the power of the wmw test went up from to these results were based on monte_carlo we developed a web_interface that allows exploring the power sample_sizes behaviour in microbiome case_control with or without stratification we demonstrated that our application can estimate power when stratified tests are applied funding we acknowledge support of iap research network grant p from the belgian government belgian science policy and of ghent university multidisciplinary_research partnership bioinformatics from nucleotides to networks we also want to thank doris vandeputte who ran the enterotype detection pipeline on the hmp stool data conflict of interest none declared 
