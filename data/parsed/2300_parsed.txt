identification of novel transcripts in annotated genomes using rna_seq we describe a new reference annotation based transcript assembly problem for rna_seq that involves assembling novel transcripts in the context of an existing annotation this problem arises in the analysis of expression in model_organisms where it is desirable to leverage existing annotations for discovering novel transcripts we present an algorithm for reference annotation based transcript assembly and show how it can be used to rapidly investigate novel transcripts revealed by rna_seq in comparison with a reference annotation whole transcriptome_sequencing known as rna_seq leverages high_throughput to investigate the rna content from a sample via the sequencing of cdna this technology has been the focus of numerous recent_studies that demonstrate high_resolution and accuracy in transcript_abundance estimation and it is being heralded as a possible replacement for microarray_based gene_expression technology this exciting development has partially eclipsed another important application of rna_seq the improvement of existing genome_annotations and even the possibility of complete de_novo genome_annotation based on multiple experiments as is being demonstrated by the rgasp consortium http www gencodegenes org rgasp in the context of genome_annotation rna_seq can be viewed as next generation expressed_sequence ests rna_seq offers the promise of rapid comprehensive discovery of novel genes and transcripts in considerably less time and at lower cost than ests from conventional sanger_sequencing to whom correspondence should be addressed histogram showing the percent of bases covered in annotated reference transcripts the low coverage transcripts would not be properly assembled using sequencing_reads alone in genomes with extensive annotations there is clearly room for improvement by taking_advantage of the information contained in the annotated transcripts when assembling and calculating expression values however a problem with using rna_seq for annotation is that genes that are expressed at a low_level will be represented by few reads and may be only partially covered to illustrate this point we show inthe coverage of refseq annotated transcripts in a typical rna_seq experiment see section for details of the experiment the histogram shows that of the transcripts are not covered at all which will happen because they are not expressed or are at levels undetectable in the experiment the remaining transcripts have varying levels of coverage based on their expression_level and length and although many transcripts are completely covered we found that of the transcripts with partial coverage are incompletely covered coverage this means that nave assembly methods will fail to reconstruct the majority of full_length transcripts one approach to predicting complete transcripts from partial coverage is to incorporate rnaseq_data in a gene_finding system such approaches have been successful but they rely on models of genes structures that may limit predictions based on prior biases other approaches such as scripture may be able to close gaps in coverage but fail to incorporate existing annotation informationare mapped to the genome using a spliced read_mapper that can map reads across junctions shown in dotted lines the reference annotation blue is used to generate faux read_alignments that tile the transcripts green the faux read_alignments are used together with the spliced read_alignments to generate a reference_genome based assembly black this assembly is merged with the reference annotation and noisy read mappings are filtered resulting in all reference annotation transcripts in the output blue as well as novel transcripts light blue during prediction in the case of model_organisms where gene_annotations are based on years of effort large consortia have combined state of the art computational predictions with careful human curated annotations we have organized existing assembly strategies into three categories and as far as we are aware none of the programs in any of these categories can explicitly use existing annotations during assembly bullet de_novo transcript assemblythe direct assembly of sequenced_reads into transcripts without mapping to a reference_genome examples_include bullet genome reference based transcript assemblyassembly of transcripts by first mapping to a reference_genome these methods build on previous work using ests or mapped pyrosequencing reads we address the need for a reference annotation based assembler by developing a novel approach through modification of an existing assembler that we term reference annotation based transcript assembly rabt assembly we adopt the approach of which is to identify transcripts only based on read_alignments i e without regard to prior information about protein_coding structure and we employ the parsimony approach to find the fewest number of transcripts explaining the data in this case the aligned sequenced_reads together with the reference annotation a key feature of our approach is that it rapidly identifies novel transcripts with respect to the reference annotation we ran our rabt assembler on a human rna_seq dataset sequenced from the ambion human_brain reference by illumina accession no sra and compared it to a reference genome_assembly produced with cufflinks on the same data the reference annotation used was ncbi hg refgene downloaded from the ucsc_genome database http genome ucsc edu the reads were mapped using tophat with the splice_junctions in the annotation provided both assembly algorithms required h on an core ghz computer we focus our analysis on novel transcripts within annotated_genes all other transcripts are purely a product of the original cufflinks assembler and their properties validation is described in that article furthermore we do not validate splice_junctions as these are found by tophat and validated in it is important to note that although we employed those tools the rabt approach could be used with other mappers assemblers shows the comparison of the cufflinks assembler with the rabt assembler an average of transfrags output by the cufflinks assembler were found to be partial reference transcripts according to the filtering method described above furthermore the transfrags assembled by rabt are bp longer than those output by the cufflinks assembler this difference is due not only to the discarding of transfrags made from portions of known transcripts but also to the use of faux reads generated from the reference annotation to predict complete novel isoforms of existing genes for an example see we investigated the extent of novel isoform discovery in known genes and found an average of new isoforms per gene such new annotated isoforms include novel junctions found by tophat or novel combinations of junctions discovered by sequencing_reads to validate these novel transcripts we calculated the phastcons way conservation track in the ucsc_genome we calculated that the novel transcripts actually had higher average conservation probability than the reference transcripts versus finally we note that the use of faux reads led us to slightly increase the number of novel assembled transcripts output by the rabt assembler than we see after filtering the original cufflinks method for partial reference transcripts see this is likely due to rare cases where a single novel feature led to multiple transfrags being assembled in combination with pieces of reference transcripts to test the extent of such false_positives we ran the rabt assembler excluding the actual sequenced_reads i e using only faux reads using this method transcripts were assembled and falsely labeled novel thus we estimate that of the transcripts defined as novel by the rabt assembler in the experiment above are false_positives to show that our method is applicable to different organisms we also repeated these experiments on drosophila_melanogaster using rna_seq from the first embryo time point of the comparison of assembler output for an example gene lack of sequencing_coverage in the utr and across one splice_junction caused the cufflinks assembler teal to output three transfrags that match the reference blue and a fourth that contains a novel splice_junction the rabt assembler output red includes both the reference transcript nm and a novel isoform nm that is assembled from a combination of sequencing_reads which reveal the novel junction and faux reads which connect the three sections to form a single transcript note that even with the addition of the reference transcript the total number of transfrags output by the assembler has been reduced for this locus and the transfrag lengths have increased the categories can be interpreted in the same manner as these results show that the method also produces improved assemblies in fly modencode dataset our reference was the r annotation from flybase http flybase org which did not make use of this data again we found that the novel transfrags had average conservation probabilities similar to known transcripts versus further results for this experiment are found in rna_seq is being increasingly adopted as the technology of choice for gene_expression studies and with large_numbers of experiments producing partial transcripts of genes it is expected that there will be rapid progress in the coming_years in annotating genomes as more complete genome_annotations are produced it is increasingly desirable to include them in analyses rather than assembling transcripts from scratch with every new experiment the reference annotation based transcript assembly approach we have introduced addresses this problem and allows for the incremental improvement of annotations with rna_seq experiments it is also convenient in that novel genes and transcripts with respect to an existing annotation are easily extracted from the output of our assembler it is important to note that accurate genome_annotation is crucial for accurate gene_expression estimation in previous work it has been shown that incomplete annotations can bias gene_expression estimates the current_practice of using rna_seq to estimate expression using known annotations when they are available is therefore liable to yield inaccurate results especially in cases where genes have multiple_isoforms some of which may not yet be annotated we therefore believe that rabt assembly is essential until annotations are improved and completed a key feature of rabt is that it is a pure assembler this means that it does not utilize information about the structure and content of coding_genes or other external input e g ests during the assembly we believe this is a feature rather than a weakness of the method because it means that rabt can assemble non coding rna_transcripts it is an interesting problem to extend rabt to allow for other external input and we believe that similar approaches based on faux reads may be fruitful along with this method we present several open problems in rabt assembly for example deciding the optimal_length and spacing of tiling reads that will connect transfrags while minimizing reorganizations of annotated transcripts is non trivial and will vary depending on the properties of the experiment as well as the organism under investigation the same is true for the parameters used in matching assembled transcripts with those in the annotation for filtering while we believe we have chosen good parameters for this experiment we do not believe there to be a one size fits all approach and it should be interesting to develop a statistically sound approach to automatically_determine the best tiling method we also note that using more complete annotations as references with rabt can lead to a larger number_of as portions of annotated transcripts can be re assembled in new combinations for example we estimate through faux read only assembly that using the more complete ucsc annotation as opposed to the refseq annotation would lead to times the number_of therefore we recommend this method for use on organisms where deep annotations do not already exist continuing improvements in rna_seq technology will eventually result in the ability to sequence complete transcripts using long_reads and fragments furthermore large_scale surveys of transcripts in multiple developmental_stages and tissues should be able to yield complete annotations of genomes solely based on rna_seq however until that time it is imperative that genome 
