simultaneous gene_finding in multiple_genomes motivation as the tree of life is populated with sequenced_genomes ever more densely the new challenge is the accurate and consistent annotation of entire clades of genomes we address this problem with a new approach to comparative gene_finding that takes a multiple genome alignment of closely_related and simultaneously predicts the location and structure of protein_coding in all input genomes thereby exploiting negative_selection and sequence_conservation the model prefers potential gene structures in the different genomes that are in agreement with each other orif notwhere the exon gains_and are plausible given the species_tree we formulate the multi species gene_finding problem as a binary labeling problem on a graph the resulting optimization_problem is np_hard but can be efficiently approximated using a subgradient based dual decomposition approach results the proposed method was tested on whole_genome alignments of vertebrate and drosophila species the accuracy was evaluated for human mouse and drosophila_melanogaster and compared to competing_methods results suggest that our method is well suited for annotation of a large number of genomes of closely_related within a clade in particular when rna_seq are available for many of the genomes the transfer of existing annotations from one genome to another via the genome alignment is more accurate than previous_approaches that are based on protein spliced alignments when the genomes are at close to medium distances availability_and the method is implemented in c as part of augustus and available open_source atwith recent technologies in whole_genome the sequencing of entire clades of genomes is in progress for example the genome k project launched in has taken on the task of sequencing the genomes of vertebrate_species genome k community of other examples_include the insect genome_project i k and the fungal genomes_project of the jgi the annotation of genomes in turn is a rather slow_process an important step is the identification of protein_coding although many automatic tools for gene_finding are available none of them is able to predict genes genome_wide without a substantial rate of wrong gene structures or missing genes for instance a survey from suggests that even the most accurate tools are merely predicting of the genes at least one splice form in drosophila_melanogaster correctly when using only rna_seq as evidence for a recent review on the subject see another evidence source besides transcriptome sequence is homology one class of methods that exploit homology uses previously_identified protein_sequences from related species or from a database and performs a spliced alignment against a target_genome examples are exonerate and genomethreader that align single protein_sequences to the target_genome and genewise and augustus ppx that take entire protein_families represented as sequence_profiles as input these approaches depend on the correctness of the input proteins their similarity to the target clade and the overlap of the respective proteomes they are usually suited only as one component of a whole_genome annotation_pipeline the ensembl pipeline for example uses amongst other tools genewise and exonerate for protein sequence_based gene prediction a second class of methods that exploit homology are comparative gene_finders these methods take two or more genome_sequences as input and exploit that homolog genes have often a very similar gene structure by aligning the genomes of related species conserved_regions become visible that are enriched in protein coding_exons but also other functional dna initial comparative_approaches to gene_finding such as twinscan simultaneously predict genes in exactly two input genomes e g of human and mouse but are rather proofs ofconcept and seem to play no substantial role in current genome_annotation to take advantage of a multiple genome alignment alternative_approaches restrict gene_finding to a single target_genome and use an alignment between the target and multiple related genomes to inform gene_finding in the target examples are contrast and n scan in particular contrast achieved striking results sensitivity and specificity for human on gene level despite the very good performance of comparative gene_finding and the potential to combine homology evidence with evidence from transcriptome_sequencing contrast and n scan are rarely used for whole genome_annotation reasons may include the fact that both require an elaborate parameter training specific to the set of informant genomes that has to be repeated for every genome in the clade that should be annotated which even if automated leads to a running time quadratic in the number of genomes a methodical disadvantage is further the restriction of gene_finding to a single target_genome this has the drawback that likely gene structures in the informant genomes are not taken into consideration when choosing a gene structure in the target_genome we present a novel approach to comparative gene_finding that simultaneously identifies genes in k genomes and that is suitable for the annotation of entire clades of genomes e g the runtime is linear in the number of genomes k we introduce a graph theoretical_framework and formulate the problem as a binary labeling problem on a graph in general exact inference in this model is not tractable however we can take advantage of the special structure of the graph that allows decomposition into two tractable sub problems finding longest paths in directed_acyclic dags and maximum a posteriori probability map inference on trees a subgradientbased dual decomposition approach is derived for approximate inference guaranteeing an upper_bound on the approximation error dual decomposition and more generally lagrangian relaxation has already been applied to a variety of inference problems e g for the multiple_sequence problem computer vision and natural_language more recently dual decomposition was adopted for integrating rna_seq evidence into hmm_based gene structure_prediction the proposed method is implemented as an extension to the gene finder augustus and in the following referred to as augustus cgp the required inputs are the genomes of two or more species as well as an alignment and a phylogenetic_tree of the genomes with no further information augustus cgp infers gene structures de_novo by only making use of the raw genomes and alignment information augustus cgp incorporates evidence for negative_selection by computing an estimate for the ratio of non synonymous and synonymous_substitutions x dn_ds for all considered candidate coding_exons furthermore augustus cgp can incorporate additional evidence e g from rna_seq and existing annotations the latter is used for the special application of transferring a trusted annotation from a known genome to newly_sequenced the performance of augustus cgp for all three tasksde novo evidence_based gene_finding and cross_species annotation transferis evaluated on two data_sets a vertebrate and a drosophila subclade of species each and discussed in the results section training the parameters of augustus cgp is not more expensive than hitherto for a single_genome the species specific parameters are only learned for one representative in the clade e g human in a mammalian clade with no need for retraining when more genomes are added to the clade or removed apart from the species specific parameters there are only few extra cross_species parameters to adjust such as rates for exon gain and loss in this article we presented a novel approach to comparative gene_finding that is suitable for gene structure annotation of entire clades its novelty is that it simultaneously identifies genes in multiple_genomes previous gene_finding systems were either limited to exactly two genomes or restricted the prediction and gene structure model to a single target_genome unlike the target informant approach that requires a repetitive training of parameters for each and every genome to be annotated parameters only have to be trained for a single representative in the clade beside the cds of a gene our approach can also predict utrs this is particularly useful when incorporating rna_seq evidence that gives unspecific hints about both coding and non coding parts of genes as a tendency our approach favors gene structures that are in agreement across the genomes thus it is likely to produce more consistent gene_sets than the ones obtained from the individual annotation of each genome this is particularly important when the objective of study is to investigate the genomic differences of several species within a clade the results show that the new multi species version of augustus is more accurate than the standard single species version in the de_novo category where only genome evidence is used it compares_favorably with n scan on exon level it is even competitive with contrast although contrast still achieves the most accurate de_novo predictions for human and fly it appears to have no practical relevance for current whole genome_annotation augustus cgp in turn is developed specifically for the increasingly important clade annotation problem with an eye towards practical aspects e g efficient scalability for a large number of genomes in the clade as few clade specific parameters as possible etc in evidence_based gene_finding our findings are that the effectiveness of rna_seq evidence decreases with an increasing distance of the source species to the target species when having rna_seq evidence for the target species itself there is only modest benefit from rna_seq evidence from other species in the clade this may however be different for other clades and libraries annotation can be transferred using augustus cgp from one genome to another via the multiple genome alignment a previously existing option to do this is the alignment of the source proteins or transcripts to the target_genome genome alignments however have the advantage that the context around the exons and genes is also used to identify what is homolog for example initial coding_exons can be very short and therefore very difficult to align correctly in a protein alignment even if the genomes are similar whereas a genome alignment may have no difficulty when the neighboring utr or intron is also alignable at very large_distances however where genome alignments are hardly or not at all possible protein_family homology_searches are still useful at least to identify_conserved domains of the gene the dual decomposition approach has proven to be a well suited framework to efficiently obtain good approximate and even mostly exact solutions to the formal optimization_problem of comparative gene_finding a common weakness of gene predictors is to distinguish between correct candidate exons and partly correct candidate exons that only differ from each other by a few base_pairs when for example classifying all exons in d mel as correctly_predicted that overlap a truescores harmonic mean of sensitivity_and on exon level for transferring the annotation from a non mouse vertebrate genome source to the mouse_genome target values are given for different source genomes with an increasing distance to the target horizontal axis the rightmost data_points are the accuracies when using the combined annotations of all source genomes e g rat human cow and chicken augustus cgp uses a whole_genome alignment between mouse and other vertebrates as well as annotation evidence cds and intron hints for the source genome s simultaneous gene_finding in multiple_genomes 
