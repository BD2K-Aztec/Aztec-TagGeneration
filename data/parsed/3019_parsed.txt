mmr a tool for read multi mapper resolution motivation mapping high_throughput sequencing_data to a reference_genome is an essential step for most analysis_pipelines aiming at the computational_analysis of genome and transcriptome sequencing_data breaking ties between equally well mapping locations poses a severe problem not only during the alignment phase but also has significant impact on the results of downstream_analyses we present the multi mapper resolution mmr tool that infers optimal mapping locations from the coverage density of other mapped_reads results filtering alignments with mmr can significantly improve the performance of downstream_analyses like transcript quantitation and differential testing we illustrate that the accuracy spearman_correlation of transcript quantification increases by when using reads of length in addition mmr decreases the alignment file sizes by more than and this leads to a reduced running time of the quantification tool our efficient implementation of the mmr algorithm is easily applicable as a post_processing step to existing alignment files in bam format its complexity scales linearly with the number of alignments and requires no further inputs availability_and open source_code are available for down load at http github com ratschlab mmr comprehensive testing results and further information can be found ataddressing the increasing need for fast and accurate mapping of highthroughput sequencing_data to a reference_sequence many different software_tools have been developed over the past_years many of which are frequently updated and improved while numerous challenges have been addressed by the developers e g the consideration of gaps and mismatches or the spliced alignment of rna sequencing_data the problem of ambiguous read_mapping still remains_unresolved for many of the most popular alignment tools depending on factors like read_length alignment sensitivity and repetitiveness of the target_genome a large fraction of reads aligns uniquely to the target and exactly one mapping location is reported however for the remaining still significantly large fraction of reads depending on alignment sensitivity several possible mapping locations exist currently different strategies are employed to deal with these reads in downstream_analyses most of which have unfavorable side_effects discarding reads with ambiguous alignments from the alignment result leads to a systematic underestimation of abundance in genomic_regions with multi mapper ambiguities whereas picking a random alignment or distributing weight across all alignments uniformly does not have a proper biological justification we provide a brief review of related approaches in supplementary section a here we present a simple yet powerful_tool called the multimapper resolution mmr tool that assigns each read to a unique mapping location in a way that the overall read_coverage across the genome is as uniform as possible mmr makes use of the criticalas a proof_of we tiled the a thaliana genome with overlapping mers and aligned these nt reads back to the genome this resulted in a non uniform coverage in particular near repetitive_regions see supplementary using mmr we could fully resolve mapping ambiguities resulting in the expected uniform coverage of almost everywhere although mmr has been successfully used in several studies we wanted to rigorously test our approach on a set of million artificial rna_seq that were generated with fluxsimulator based on a subset of genes randomly drawn from the human gencode annotation v we simulated read sets of length nt nt nt and nt resulting in average coverages between and the reads were then mutated using an empirical error_model that led to a native error_rate of three levels of random noise were applied in addition we aligned the reads with tophat v and palmapper v allowing for up to edit operations with no annotation provided further information is provided in supplementary section b to investigate the effect of mmr on downstream_analyses we performed transcript quantification using cufflinks v and rquant unfiltered best mmr mmr results on simulated read data quantification results on million simulated nt reads aligned with tophat using rquant and cufflinks accuracy was measured as spearman_correlation to ground_truth unfiltered read sets are shown in dark best_hit read sets in medium and mmr filtered in light gray native error_rate is noise levels mmr a tool for read multi mapper resolutionmmr filtered alignments the best alignments only the alignment ranked highest by the aligner and on completely unfiltered alignments for tophat and palmapper the quantifications based on the mmr filtered alignments showed a consistently better correlation to the ground_truth than both the best_hit and unfiltered alignments sets the shorter reads of length nt showed larger improvements compared to unfiltered cufflinks rquant and best_hit set cufflinks rquant than the longer_reads of length nt that showed consistent but smaller improvements supplementary figs s s we presented mmr a post processor for bam_files resolving ambiguous alignment locations we showed its easy applicability to the output of different alignment_methods and illustrated that mmr can greatly improve accuracy of downstream quantification_methods although the improvements seem moderate on a global scale the effect on single genes can be much larger given its lean implementation and the short running time mmr is very well suited for large_scale genome exomeand rna sequencing_efforts its good performance on short_reads also suggests an application to ribosome footprinting data mmr may also be useful for post_processing alignments in meta genome_projects for improved selection of taxa 
