data_and advance_access maximal conditional chi_square importance in random_forests motivation high_dimensional are frequently generated in genome_wide gwas and other studies it is important to identify features such as single_nucleotide snps in gwas that are associated with a disease random_forests represent a very useful approach for this purpose using a variable_importance score this importance score has several shortcomings we propose an alternative importance measure to overcome those shortcomings results we characterized the effect of multiple_snps under various models using our proposed importance measure in random_forests which uses maximal conditional chi_square mcc as a measure of association between a snp and the trait conditional on other snps based on this importance measure we employed a permutation_test to estimate empirical p values of snps our method was compared to a univariate test and the permutation_test using the gini and permutation importance in simulation the proposed method performed consistently superior to the other methods in identifying of risk snps in a gwas of age_related the proposed method confirmed two significant snps at the genome_wide adjusted level of further analysis showed that these two snps conformed with a heterogeneity model compared with the existing importance measures the mcc importance measure is more sensitive to complex effects of risk snps by utilizing conditional information on different snps the permutation_test with the mcc importance measure provides an efficient way to identify candidate snps in gwas and facilitates the understanding of the etiology between genetic_variants and complex_diseases successes of genome_wide gwas have demonstrated that single_nucleotide snps can be used to identify genetic_variants underlying complex_diseases such as age_related amd and coronary_artery cad gwas has emerged as the most effective study_design for identifying candidate_genes in the scenario of common to whom correspondence should be addressed disease common_variant cdcv with the advance of genotyping technology the number of available snps in one assay has soared from hundreds of thousand to more than million in the past_few leading to an outburst of high_dimensional on the contrary statistical_methods available for gwas remain_limited single marker univariate tests such as the chi_square or likelihood_ratio are commonly used while simple the univariate tests have produced many successes in identifying genetic_variants for complex_diseases which some may regard as low hanging fruits in reality biological_systems are more complex than single variants acting independently and most likely multiple genes may work together in a complex system for example in the case of cdcv multiple_loci and environment factors may be involved and the individual effects may not be large enough to be detectable with thousands of study subjects some approaches have been proposed for gwas to consider the effects of multiple_snps but there are practical limitations in those approaches for example snps interactions can be examined only under very limited configurations moreover genetic_variants may manifest different effects such as multiplicative and heterogeneity effects b further complicating the analysis to meet the growing computational demand of the analytic_methods machine_learning have attracted more attention in detecting significant snps in gwas for example classification trees and forest based_methods are powerful_tools for identifying complex relationships between a trait and a large number of predictors and these methods also have been found useful in the analysis of gene_expression data a random_forest consists of many classification trees and at each node of the trees a small subset of randomly_selected predictors instead all predictors are considered to split on the node within a random_forest the effect of a predictor is measured by either the permutation importance or gini importance the gini importance of a specific predictor directly sums the improvement of weighted gini index when this variable is used for splitting a node among all trees in the forest the permutation importance of a predictor calculates the increase of the out of bag errors as a result of permuting the values of the predictor because the permutation destroys any potential predictive_power of the predictor on the trait previous_studies that the random_forest based_approach is feasible and efficient for gwas although two major_issues hamper further applications of random_forests firstly although large importance scores are often indicative of snps associated with the trait it is usually not clear how large is large and the importance score is not coupled with the rigorous statistical_significance of the investigated snps secondly both the permutation and gini importance scores measure the average effect of a predictor in a random_forest and can be easily altered by the presence of the other snps to overcome the problems stated above we introduce an alternative importance score using maximal conditional chi_square mcc statistic to assess the conditional significance of snps in gwas for example with two snps a and b if snp b confounds the effect of snp a on the trait failure to control the effects of snp b may lead to inefficient tests for snp a like the mantelhaenszel test a test by stratifying by snp b is an effective approach to adjusting for the confounding_effect of snp b we make use of the hierarchical tree_structure to assess the effect of snp a through stratification of the snps that precede snp a in splitting the nodes in a tree a conditional chi_square for snp a can be calculated whenever it is used to split a node of any tree in a random_forest the maximal value among all these chisquares calculated for snp a is obtained after the construction of the random_forest this maximum indicates the relationship between the trait and the snp given its preceding snps in the random_forest and can serve as an importance measure the reason we select the largest chi_square instead of the average as used in the gini and permutation importance is that disease associated snps are usually very rare in the data and therefore most of the conditional chi_square statistics come from the snps that are not associated with the trait thus averaging all chi_square values limits the sensitivity of the permutation_test based on the mcc importance score we developed a permutation procedure to estimate the significance of each snp simulated_data based on various multiplicative and heterogeneity genetic_models were generated to evaluate the performance of the proposed approach we compared the results among gini permutation and mcc importance scores finally the proposed method was applied to a real data_set for gwas random_forests as a powerful machine_learning has been successfully_applied in many classification_problems especially with a large number of predictors the permutation and gini importance scores are commonly computed for random_forests to evaluate the overall contribution of a predictor in classification the reason for the reduced power they exhibited in identification of risk snps in gwas is probably that the risk snps are extremely sparse in the data and they usually cooperate as a complex system associated with the phenotype therefore averaging over all scores may significantly reduce its sensitivity in the permutation_test moreover there are other practical issues with the permutation importance for example highly_correlated snps due to link age disequilibrium act as surrogates to each other causing an underestimation of the permutation importance when they appear in one tree during the calculation of permutation importance the permutation of one snp will break its intrinsic relationship with other snps which leads to inaccurate estimation of permutation importance some approaches have been proposed to address_these but they are too computationally_intensive for ultra high_throughput data therefore a powerful and yet simple statistic is very important to detect subtle_effects between casual snps in this article we proposed and studied the maximal chi_square as a new importance measurement in random_forests and its application in the permutation_test for gwas we first evaluated the performance of the mcc importance in detecting risk snps using empirical p values under null_hypothesis and discovered that there is no association between snps and a trait we also compared this method with the permutation_tests using different importance scores in random_forests and single marker analysis we further modified the genetic_models in simulation by including ld reflecting real_data in gwas the results indicated that the permutation_test using the mcc importance was consistently the best moreover we showed that it is possible to make inference on risk snps from the preceding list of snps while deriving the mcc importance finally we applied this method to a gwas data for amd two amd related snps rs and rs were successfully identified with the genome_wide significance_level our analysis suggested that these two snps belong to a heterogeneity model involved in etiology 
