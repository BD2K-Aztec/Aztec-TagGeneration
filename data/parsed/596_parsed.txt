automated band annotation for rna_structure probing experiments with numerous capillary_electrophoresis profiles downloaded from motivation capillary_electrophoresis ce is a powerful approach for structural analysis of nucleic_acids with recent high_throughput variants enabling three_dimensional rna modeling and the discovery of new rules for rna_structure design among the steps composing ce analysis the process of finding each band in an electrophoretic trace and mapping it to a position in the nucleic_acid sequence has required significant manual_inspection and remains the most time consuming and error_prone step the few available tools seeking to automate this band annotation have achieved limited accuracy and have not taken advantage of information across dozens of profiles routinely acquired in high_throughput measurements results we present a dynamic_programming based_approach to automate band annotation for high_throughput capillary_electrophoresis the approach is uniquely able to define and optimize a robust target function that takes_into multiple ce profiles sequencing ladders different chemical probes different mutants collected for the rna over a large benchmark of multi profile datasets for biological rnas and designed rnas from the eterna project the method outper forms prior tools qushape and fast significantly in terms of accuracy compared with gold_standard manual annotations the amount of computation required is reasonable at a few seconds per dataset we also introduce an e score metric to automatically assess the reliability of the band annotation and show it to be practically useful in flagging uncertainties in band annotation for further inspection availability_and the implementation of the proposed algorithm is included in the hitrace software freely_available as an online server and for download at http rna_molecules play_diverse in encoding and regulating genetic_information and much of this versatility can be traced to the formation of intricate rna_structures to this end chemical probing methodologies provide a general and rapid means to mapping rna secondary_and at single_nucleotide there exist many chemical probing techniques most of which have common experimental_procedures as follows given an rna of interest folded in solution a chemical reagent modifies the rna either cleaving it or forming a covalent adduct with it at a rate correlated with the accessibility of particular moieties at each nucleotide or the frequency at which each nucleotide fluctuates into a conformation activated for chemical_reaction examples of such chemical reagents all with distinct mechanisms include hydroxyl_radicals oh acylating chemicals shape dimethyl sulfate dms and cyclohexyl morpholinoethyl carbodiimide metho p toluenesulfonate cmct subsequent reverse transcription detects the modification_sites as stops to primer_extension at nucleotide_resolution the resulting complementary dna_fragments are resolved in sequencing gels followed by individually quantifying band intensities prior to the mid s the bottlenecks were the final steps gel running and band quantification to resolve fragments in a more high_throughput fashion capillary_electrophoresis ce was developed and is reaching wide use ce based chemical probing can produce hundreds of electrophoretic profiles exhibiting tens_of of individual electrophoretic bands from a single experiment leading to recent_developments in two_dimensional mapping of complex rna_structures and their excited_states and extension to large complexes such as entire viruses and to rna design_problems further developments in next_generation readouts are promising but still show biases compared with ce measurements analyzing a large number of electrophoretic traces from a highthroughput structure mapping experiment is time consuming and poses a significant informatic challenge requiring a set of robust signal_processing for accurate quantification of the bands embedded in these traces software methods for ce analysis include capillary automated footprinting analysis cafa shapefinder high_throughput robust analysis for ce fast analysis of shape traces fast and qushape a typical high_throughput ce analysis_pipeline consists of the following steps preprocessing such as normalization and baseline adjustment alignment peak_detection band annotation and peak fitting among these band annotation refers to the process of mapping each band in an electrophoretic trace to a position in the nucleic_acid sequence for verification visual_inspection in this phase is inevitable to some extent however in practice this band annotation step often takes significant manual efforts in cafa and shapefinder for they were designed to focus more on alignment and peak fitting hitrace qushape and fast have provided improved levels of band annotation support but band annotation remains still the most time consuming and error_prone step for large_datasets this article_describes a dynamic_programming based_approach to automated band annotation for large ce datasets these datasets involve at least four and up to hundreds of multiple traces that are aligned for each rna based on sequencing ladders for the four different nucleotide types different chemical modifiers and or chemical_modification under different solution_conditions or with different mutations the central innovations herein are i an accurate and well tested procedure to integrate_information across these multiple traces into a single consensus band annotation with accuracy approaching that of manual_annotation and ii a reliability estimator for this procedure shows the overview of the proposed methodology the proposed method for band annotation is unique in its ability to take into account all available ce profiles prior methods such as those available in qushape and fast have focused on a single profile at a time with a reference profile if needed the distinctive robustness of the proposed method is primarily attributed to this capability to integrate_information across profiles the method does require an accurate alignment of all profiles prior to band annotation our prior work described a different dynamic_programming to accomplish this preceding alignment based on standards co loaded with each sample in well over datasets analyzed here we saw only one case where interprofile alignment was problematic tetrahymena ribozyme and required manual intervention therefore our alignment and annotation results herein confirm that all steps including alignment and annotation of rna_structure mapping ce analysis can now be routinely achieved through automated algorithms to flag cases with uncertain automated band annotation we have introduced the e score for reliability estimation according to our results given any dataset for ce analysis the band annotations with e are almost always reliable and can be safely adopted for final steps of band quantitation whereas the results with e are less likely to reliable informally we have encountered datasets in which even expert annotation is ambiguous and has required special additional experiments such as co loading sequencing ladders in the same color as the sample to resolve this suggests that automated band annotation cannot improve much further a valuable development would be reliability estimates for specific_subsets of bands rather than a global number an additional useful development would be use of known band intensities based on prior experiments or on base_pair probability estimates rather than coarse predictions for profiles based on sequence modifier and a single secondary_structure the proposed algorithm has order of nk time and space complexity and the practical time demand of band annotation was reasonable in our experiments the proposed method was implemented in the matlab programming environment the mathworks http www mathworks com and under the experimental_setup used sequential execution on a intel core i processor with gb main_memory the total time demand of annotating bands in all the datasets did not exceed min for each dataset mean s median s in the analysis of ce profiles band annotation has remained the most time consuming and error_prone step due to the lack of robust computational_tools for automating the process using a dynamicprogramming approach the proposed algorithm can find an optimal arrangement of bands in a given ce profile under a scoring schemesuitable for high_throughput ce experiments with multiple profiles on over ce datasets including designed and biological rnas the proposed method identified the band positions matching the reference positions with accuracy sufficiently_high as to obviate or significantly reduce manual correction finally the quality of the band positions are well predicted by e score flagging unreliable annotations to the user 
