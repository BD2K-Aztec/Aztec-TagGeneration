sequence_analysis consensus genotyper for exome_sequencing cges improving the quality of exome variant genotypes motivation the development of cost_effective next_generation methods has spurred the development of high_throughput bioinformatics_tools for detection of sequence_variation with many disparate variant_calling available investigators must ask which method is best for my data machine_learning research has shown that so_called ensemble methods that combine the output of multiple models can dramatically improve classifier performance here we describe a novel variant_calling approach based on an ensemble of variant_calling which we term the consensus genotyper for exome_sequencing cges cges uses a two stage voting scheme among four algorithm implementations while our ensemble_method can accept variants generated by any variant_calling algorithm we used gatk samtools freebayes and atlas snp in building cges because of their performance widespread_adoption and diverse but complementary algorithms results we apply cges to samples sequenced at the hudson alpha institute for biotechnology haib huntsville al using the nimblegen exome_capture and illumina sequencing_technology our sample set consisted of complete trios two families of four one parentchild duo and two unrelated_individuals cges yielded the fewest total variant_calls n cges the highest ts tv ratio the lowest mendelian error_rate across all genotypes the highest rediscovery rate from the exome variant server evs and genomes kg and the highest positive_predictive ppv for a random_sample of previously validated de_novo variants we describe these and other quality_control qc metrics from consensus data and explain how the cges pipeline can be used to generate call sets of varying quality stringency including consensus calls present across all four algorithms calls that are consistent across any three out of four algorithms calls that are consistent across any two out of four algorithms or a more liberal set of all calls made by any algorithm availability_and to enable accessible efficient and reproducible analysis we implement cges both as a stand alone command_line available for download in github and as a set of galaxy tools and workflows configured to execute on parallel computers whole_exome wes has quickly become an affordable approach to identifying rare_variants contributing to disease over the past_years the number of published_papers that were indexed in pubmed with the key_words exome_sequencing has increased fold representing a clear trend in human_genetics the utility of wes for revealing biological_mechanisms depends on the genetic_architecture of the phenotype in question the quality of the sequencing_technology and to a significant extent the analytic_methods used to identify and genotype variations in sequence in recent_years several methods have been developed to analyze raw wes data including atlassnp gatk seqem freebayes samtools dindel soapsnp and varscan among others these methods represent substantial effort and expertise in the analysis of next_generation ngs_data including both whole exome and whole_genome here we present a natural extension of these individual algorithms that integrates their relative strengths into a consensus calling approach which we call cges this algorithm developed as a collaborative_effort between the department of medicine and the computation institute at the university of chicago takes_advantage of the diverse variant_calling strategies of four existing algorithms gatkv atlas snp samtools and freebayes in an open_source freely_available and user_friendly analysis platform while all variant_calling programs seek to optimize performance relative to some core properties of sequencing_data such as read_depth and allele count they often differ along other dimensions we chose to base our consensus based pipeline on gatkv samtools altas snp and freebayes as these to whom correspondence should be addressed the author published_by all_rights for permissions please_e journals permissions_oup com four algorithms use complementary approaches for example all algorithms include genotype and indel likelihood models but the models themselves differ with respect to information used and weights given to such information see oand yu and sun for complete comparison furthermore freebayes allows explicit parameterization if there are known copy_number in a sample while gatkv provides sophisticated filtering options that can be trained on a given dataset together these programs constitute a suite of algorithms that attempt to integrate as much information as possible including prior variant observations linkage_disequilibrium structure and structural_variation to reduce both type_i errors in brief cges first runs each algorithm separately and then combines the resulting four collections of genotype_calls to create three possible output sets typically of increasing size but lower average quality consensus calls i e calls made by all four algorithms partial consensus calls e g those made by three or more algorithms and the union of all calls calls made by one or more algorithms cges also harmonizes quality_scores from each algorithm to provide qc reports and publication quality plots cges qc tool cges and cges qc together form a multi_step pipeline and must perform multiple program invocations as shown in we use the galaxy platform to combine implementations for each branch of the pipeline and for cges itself our use of galaxy has the benefit of democratizing ngs_data analysis as galaxy reduces the computational expertise needed to run an ngs pipeline and can run on public clouds such as those operated by amazon_web google and microsoft the links to the galaxy workflows can be found in supplementary table s we have applied the cges consensus calling approach to real_world exome data collected on subjects with autism and their family_members we use the results of this study to demonstrate the power of the cges approach and provide project level variant level sample level and family based quality_metrics across all algorithms additionally we provide known rare_variant rediscovery rates and an estimate of the ppv of each algorithm based on previously_identified and lab validated de_novo variation we have presented a novel variant_calling approach based on an ensemble of variant_calling which we call cges cges uses a two stage voting scheme among four algorithm implementations to identify variant sites and determine genotypes in addition to presenting the consensus approach we have described its application to real_world exome data collected on a sample of autism trios and singletons we provide projectbased sample based and variant based quality_metrics across all algorithms as well as an estimate of the ppv of each algorithm and cges finally we provide a galaxy based implementation of cges and its constituent parts taken together the results show that galaxy cges provides a robust flexible and userfriendly approach to exome sequence variant_calling additionally these results provide_a for further development of ensemble methodology in the analysis of ngs_data cges is not limited to exome data and could in principle be used for whole_genome although this application has not yet been tested the full cges consensus calling algorithm produced the highest quality output but the smallest_number of genotypes snvs in total in our example data leveraging the strengths of all callers produced a dataset with the highest ts tv ratio the lowest vmer the lowest gmer the highest evs rediscovery percentage the highest kg rediscovery percentage the highest giab rediscovery rate and the highest de_novo ppv consensus approaches for ngs variant detection can be particularly useful when the downstream_analysis i e rare_variant transmission distortion test tdt pathway analysis or de_novo filtering is reliant on a low false_positive however there may be scenarios in which the preferred strategy is to maximize the rate of true_positives even at the expense of a higher false_positive for example when performing segregation_analysis in large extended families in that case it may be more fruitful to use the union of all calls from all branches additionally when identifying de_novo variants one may wish to use the consensus of all calls in probands and the union of all calls in parents as an added stringency filter to reduce false_positives it is important to stress that there is no one size fits all approach to sequencing analysis the shift in the balance between type_i errors is inherent in the stringency with which a consensus dataset is created therefore investigators are given the option of requiring any level of caller overlap i e union of all calls two caller consensus three caller consensus or full consensus simultaneously providing the lowest possible false_positive and lowest possible false_negative datasets the best approach for variant_calling depends entirely on the type of data and the downstream analytic plans as new methods are continually being developed it is our hope that this report in conjunction with other consensus efforts will help set the tone for an open discussion on the importance of unifying different approaches it is important to note the limitations of the analyses presented here one important limitation is that the quality_metrics from each branch are not directly comparable as their optimization strategies differed we optimized calling for each branch of cges to reflect reasonable real_world parameter decisions and not for the sake of a comparison among methods which has been recently_published o for example freebayes allowed us to set many parameters supplementary methods based on the raw_data descriptive_statistics and our previous sequencing experience atlas snp on the other hand offered relatively fewer parameter options supplementary methods as best practices have been published for gatkv we used these guidelines verbatim ultimately the performance of each branch can differ dramatically based on parameters set by the user of course the better the branch calls the higher quality the final consensus calls will be additionally it may be possible to use concordance between callers as a guiding metric when iterating to the optimal parameters for each branch in addition to providing the description of the pipeline and the resultant data we have provided multiple accessibility modalities the code for the cges and cges qc algorithms is open_source and available through github supplementary for investigators who do not wish to invoke the command_line we have provided cges and its constituent branches in a user_friendly galaxy environment finally for researchers without institutional computational infrastructure or simply for those who wish to outsource the computing but retain control over the scientific aspects of analysis the pipeline is available and will be sustained through globus genomics http www globus org genomics of illinois chicago the authors also wish to thank steve guter uic for assistance with data management bo lui for early work on galaxy wrappers kelley moore uic and kathleen hennessy uic for expert technical_assistance braden boone haib jack wimbish haib and shawn levey hai for sequencing and expert advice the authors are grateful to erik garrison for intellectual contributions on review of this manuscript and for technical advice pertaining to freebayes l k d also wishes to posthumously thank george stephen karatheodoris for intellectual contributions to this work the content is solely the responsibility of the authors and does not necessarily represent the official views of the national_institute the authors are grateful to amazon_web inc for an award of amazon_web time that facilitated early experiments 
