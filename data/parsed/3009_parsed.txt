genome_analysis mitie simultaneous rna_seq based transcript identification and quantification in multiple samples motivation high_throughput of mrna rna_seq has led to tremendous improvements in the detection of expressed genes and reconstruction of rna_transcripts however the extensive dynamic range of gene_expression technical_limitations and biases as well as the observed complexity of the transcriptional landscape pose profound computational challenges for transcriptome reconstruction results we present the novel framework mitie mixed integer transcript identification for simultaneous transcript reconstruction and quantification we define a likelihood_function based on the negative_binomial use a regularization approach to select a few transcripts collectively explaining the observed read data and show how to find the optimal_solution using mixed integer_programming mitie can i take advantage of known transcripts ii reconstruct and quantify transcripts simultaneously in multiple samples and iii resolve the location of multi mapping reads it is designed for genome and assembly based transcriptome reconstruction we present an extensive study based on realistic simulated rna_seq when compared with state of the art approaches mitie proves to be significantly more sensitive and overall more accurate moreover mitie yields substantial performance gains when used with multiple samples we applied our system to drosophila melanoga ster modencode rna_seq libraries and estimated the sensitivity of reconstructing omitted transcript annotations and the specificity with respect to annotated transcripts our results corroborate that a well motivated objective paired with appropriate optimization techniques lead to significant improvements over the state of the art in transcrip tome reconstruction availability mitie is implemented in c and is available frommost of the complexity of higher eukaryotic transcriptomes can be attributed to the encoding of multiple_transcripts at a single genic locus by means of alternative_splicing transcription start and termination e g a comprehensive catalog of all transcripts encoded by a genomic locus is essential for downstream_analyses that aim at a more detailed understanding of gene_expression and rna_processing regulation rna_seq is a method for parallel sequencing of a large number of rna_molecules based on high_throughput encode_project currently available sequencing_platforms typically provide several millions of sequence_fragments reads with a typical length of bases by mapping these reads back to the genome one can determine where gene_products are encoded in the genome e g and collect evidence of rna_processing such as splicing or rna_editing in many cases the rna_seq are first aligned to a reference_genome using an alignment_tool that identifies possible read origins within the genome contiguous regions covered with read_alignments possibly with small gaps are candidates for exonic segments alignment tools for rna_seq such as palmapper tophat mapsplice star or gsnap are typically able to identify new exonexon junctions which are candidates for introns this information can be compiled into a segment or splicing graph a directed_acyclic where the nodes correspond to exonic segments and the edges correspond to intron candidates cf for an illustration assuming complete coverage an expressed transcript corresponds to a path in the graph similar graphs are produced during de_novo transcript assembly with the difference that the graph can potentially be cyclic and the segments are not explicitly associated with a genomic location in genome and assembly based transcript reconstruction tools such as scripture cufflinks trans abyss trinity and oases select a subset of paths through the graph as transcript predictions for simplicity we will focus on genome based transcript reconstruction when describing the approach and discuss de_novo whenever necessary the author published_by this is an open_access the terms of the creative commons attribution license http creativecommons org licenses by which_permits distribution and reproduction in any medium provided the original_work owing to the nature of the rna_seq the information obtained from the alignments is of local nature only even when considering paired_end e g the splicing graph_representation implicitly assumes independence of local events hence it will typically contain more paths than expressed transcripts this is also true in the ideal case when the graph is i complete in the sense that it contains all vertexes and edges and ii accurate in the sense that it only contains expressed exonic segments as vertexes and edges that correspond to introns of expressed transcripts for instance the splice_variants annotated in any of the four human genome_annotations ensembl havanna encode vega see define splicing graphs that encode paths with of the loci contribute of the paths thus we encounter a few particularly complex cases that contribute most to transcriptome complexity defining splicing graphs based on rna_seq entails the additional difficulty that inaccurate or ambiguous read_alignments can substantially_increase the size of these graphs although this problem can be addressed by filtering the read_alignments we find that strict filtering often leads to a reduced sensitivity of transcript prediction and introduces artifacts for instance in the presence of unknown genomic_variations based on a detailed analysis of the problem and of previous work we identified three important requirements that a transcript inference algorithm based on rna_seq should meet first following the arguments in we note that it is important to simultaneously identify and quantify transcripts to resolve long_range dependencies in section we illustrate how quantitative information can perfectly deconvolve contributions from multiple_transcripts whereas ignoring quantitative information leads to inaccurate predictions second enumeration of all paths defined by a splicing graph is often not tractable for instance for and of human genes the number of paths in splicing graphs generated from the annotation and rna_seq see section supplementary section c is greater than and respectively see supplementary this large number is the result of a combinatorial explosion of possible combinations of alternative segments and edges this is even larger in case of de_novo where several loci are merged into cluster of connected segments if sequence is repeated therefore a generally_applicable approach should avoid explicit enumeration ideally still guaranteeing optimality third we show that multiple rnaseq samples help to solve the ill posed problem of transcript identification see e g by sharing_information between samples while still considering them separately we can often exactly determine the correct set of expressed transcripts we provide illustrative_examples where neither merging data of multiple samples nor the independent analysis of data from each sample can solve the problem we describe an approach_called mitie mixed integer transcript identification that meets the aforementioned requirements the main idea of mitie is to report a small optimal set of transcripts that can well explain the observed rna_seq in multiple samples it does not require an explicit enumeration of all paths to find the optimal set of transcripts this is achieved by using branch and bound algorithms that prune parts of the combinatorial search tree that cannot yield the optimal_solution mitie consists of two main parts a data_processing part generates a splicing graph from rna_seq alignments in binary sequence_alignment bam format the annotation in gene_transfer format gtf format or both section the second part solves the core optimization_problem and starts with the graph decorated with quantitative information section the design enables the flexible use of mitie in existing rnaseq pipelines for example we can use the output of trinitys inchworm tool as input to the second part of mitie and thereby solve the transcript reconstruction task also solved by trinitys butterfly tool in the following section we relate mitie with previous work and illustrate the idea of combining multiple samples in a simulation_study in section we then apply mitie to a larger set of simulated rna_seq generated from the human genome_annotation in section finally in section we analyze the performance of mitie on a large set of rna_seq for drosophila_melanogaster generated within the modencode project the transcript prediction_problem is typically under determined one important consequence of this observation is that deeper sequencing only helps to reduce the variance of abundance estimation and to close gaps in the splicing graph but it does not solve the transcript identification problem as such the proposed method reduces the set of solutions by leveraging quantitative information and multiple rna_seq samples combined with mild biologically_plausible assumptions furthermore prior information can be taken into account in a direct way within a single optimization_problem which we think will turn out particularly advantageous for integrating long_reads from third generation sequencing_platforms with rna_seq our results highlight the importance of a well motivated loss function to penalize the read_count deviation the application of the g nb loss significantly_improved our quantification and transcript recognition results while it comes at nearly zero additional computational_cost the underlying assumption of previously_published transcript calling strategies like cufflinks and trinity is correctness and completeness of the graphs achieving both at the same time is challenging and typically not possible this results in either wrong transcript predictions that have to be filtered out heuristically or in fragmented transcript predictions mitie assumes completeness of the graph but not correctness completeness can often be achieved by not filtering the input alignments or not pruning the assembly_graph the decision of filtering can be deferred to the optimization_problem that may choose to discard information in a context dependent way this is conceptually more attractive than global and uninformed filtering as a preprocessing_step mitie finds a solution that is compatible to the overall observed read data as observed on simulated and real_world rna_seq mitie pushes the boundaries of what can be observed from rna_seq toward more complex_mixtures of transcripts by leveraging variability between samples these improvements come with the downside of higher computational costs however the vast_majority of cases can be optimally computed within seconds and our implementation provides options for approximations in cases where exact computations are too expensive furthermore our experiments clearly show that we can obtain the same performance as competing_methods with only a fraction of the data which in turn can save the time money and storage capacity of deeper sequencing mitie allows us to pool information from different samples in an effective way this conceptual improvement will further future rna_seq studies rather than spending efforts into deep_sequencing of a few samples future_studies will have the choice to investigate a larger variety of samples at a lower depth the combination of these samples allows us to obtain more confident transcript predictions in each sample and more insights into the biological_questions at the same time 
