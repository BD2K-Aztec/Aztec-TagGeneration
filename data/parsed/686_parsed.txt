genetics_and bayesian parentage analysis with systematic accountability of genotyping error missing_data and false matching motivation the goal of any parentage analysis is to identify as many parentoffspring relationships as possible while minimizing incorrect assignments existing_methods can achieve these ends but they require additional information in the form of demographic_data thousands of markers and or estimates of genotyping error_rates for many non model systems it is simply not practical cost_effective or logistically feasible to obtain this information here we develop a bayesian parentage method that only requires the sampled genotypes to account for genotyping error missing_data and false matches results extensive testing with microsatellite and snp datasets reveals that our bayesian parentage method reliably controls for the number of false assignments irrespective of the genotyping error_rate when the number of loci is limiting our approach maximizes the number of correct assignments by accounting for the frequencies of shared alleles comparisons with exclusion and likelihood based_methods on an empirical salmon dataset revealed that our bayesian_method had the highest ratio of correct to incorrect assignments availability our program solomon is available as an r package from the cran website solomon comes with a fully_functional graphical_user requiring no user knowledge about the r programming environment in addition to performing bayesian parent age analysis solomon includes mendelian exclusion and a priori power analysis modules further information and user support can be found at https sites google com site parentagemethods accurate parentage assignment and pedigree reconstruction are required to make correct inferences for a broad array of study questions parentage methods span a vast gamut of theoretical approaches from fractional to categorical allocation and simple exclusion to sophisticated likelihood based_approaches one area of parentage analysis that has been largely overlooked is a general bayesian_method for categorical allocation this void is unfortunate as additional sampling or field information can be elegantly incorporated as priors into a bayesian_framework furthermore the information present within the genotypic data itself can be used to calculate a prior analogous to a false_discovery which can be useful for the challenges associated with parentage analysis as an illustrative example consider a typical kinship dataset consisting of seven microsatellite_loci and individuals in this dataset a parent and an offspring would share at least one allele across all loci following mendelian_inheritance however the probability of two unrelated_individuals sharing alleles by chance at all loci is not trivial considering that hundreds of thousands of pairwise_comparisons are required thus a primary challenge of parentage analysis in natural_populations is to correctly identify the true parentoffspring pairs within a dataset while simultaneously excluding any pairs that share alleles by chance the challenge of parentage analysis is further exacerbated by missing_data and genotyping_errors which can erode the parent_offspring signal of sharing at least one allele at all loci because errors can create an incorrect record of genotypes true parentoffspring pairs in an empirical dataset may not share an allele at all loci despite that being the mendelian expectation here we address the challenges associated with parentage analysis by first calculating the prior probability of a dyad sharing an allele across all numbers of mismatching loci the calculation of this prior analogous to a false_discovery creates a systematic framework for determining how many loci to let mismatch and does not require any estimates of genotyping error for each putative pair we next use bayes theorem to calculate the posterior_probability of a parentoffspring pair being false given the frequencies of shared alleles because the probability of sharing_common rather than rare alleles is much greater for unrelated pairs we can compare the frequencies of observed shared alleles to a distribution of alleles shared by unrelated_individuals by combining this information with bayes theorem we can maximize the identification of true parents and offspring in a dataset while minimizing the number of false assignments here we overhaul the approach of christie to i account for genotyping error and missing_data ii reduce the computational time by up to three orders_of as measured in minutes and iii allow for one known parent or for known parent pairs i e known matings which can substantially_increase assignment power we extensively test this methodology with data drawn from three empirical_studies and use an empirical salmon dataset to make comparisons with commonly implemented exclusion and likelihood based_methods to whom correspondence should be addressed the author published_by all_rights for permissions please_e journals permissions_oup comaccurate parentage assignments are necessary to appropriately address a wide_range of research_questions here we provide a bayesian_method that can account for genotyping error missing_data and false matches without requiring estimates of any non genetic parameters i e all analyses simply use the provided genotypic data these methods can be applied to a broad array of datasets ranging from samples of large wild_populations with unknown numbers of sampled parents to carefully controlled crosses with detailed pedigree records to our knowledge this is the first parentage program that does not require direct estimates of genotyping error this solution represents a significant advance because choosing the appropriate method for estimating genotyping error_rates can be ambiguous and is further obfuscated by the different types of genotyping_errors that can occur furthermore the estimation of error_rates typically involves the genotyping of additional or duplicate samples which is costly from both a time and monetary standpoint because this method was designed with a null_hypothesis of no relationship it may not be ideally_suited for datasets with large_numbers of related individuals e g full sibs future improvements could include specifying different null_hypotheses of relationship and evaluating them in a likelihood_based framework our analyses revealed that for a given dataset the bayesian_approach appropriately minimizes false assignments while maximizing the number of correct assignments the number of true parentoffspring relationships correctly_identified depends on the sample_sizes the number of loci the allele_frequencies and the genotyping error_rate for a given marker set larger_sample rapidly increase the number of pairs that share alleles by chance and increases in genotyping error can diminish power furthermore the number and frequency distribution of alleles at each locus contribute to the rate of false matching uniform allele_frequencies result in the greatest power for parentage analysis but they are rarely observed in genetic_markers on the other hand snps with a minor_allele will contribute little information to the elucidation of parentoffspring pairs given the multitude of factors that contribute to false matching and reduced power we suggest that researchers conduct a priori power analyses before designing a study that involves parentage analysis such power analyses can dictate precisely how many loci would be required for given sample_sizes we provide a module for a priori power analysis as part of our program solomon which is available as a freely distributable r package r development core from the cran website http cran r project org_web solomon is run with a graphical_user written with the tcl tk package provided by r solomon performs the described bayesian parentage analysis for datasets with no known parents one known parent or known parent pairs using an intel core i tm processor with gb of random_access the average run time was min for the beech datasets min for the steelhead dataset and min for the retriever dataset with larger_sample resulting in increased run times furthermore the program performs exclusion for the three types of parentage analysis and the exclusion interfaces allow for user_defined numbers of loci to mismatch in summary the bayesian_approach implemented in solomon can be applied to a wide_variety of datasets resulting in robust parentage assignment 
