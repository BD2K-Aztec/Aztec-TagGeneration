data_and improving peak_detection in high_resolution lc_ms metabolomics_data using preexisting knowledge and machine_learning approach_motivation peak_detection is a key_step in the preprocessing of untargeted metabolomics_data generated from high_resolution liquid_chromatography lc_ms the common practice is to use filters with predetermined parameters to select peaks in the lc_ms profile this rigid approach can cause suboptimal performance when the choice of peak model and parameters do not suit the data characteristics results here we present a method that learns directly from various data features of the extracted_ion eics to differentiate between true peak regions from noise regions in the lc_ms profile it utilizes the knowledge of known metabolites as well as robust machine_learning unlike currently available methods this new approach does not assume a parametric peak shape model and allows maximum flexibility we demonstrate the superiority of the new approach using real_data because matching to known me tabolites entails uncertainties and cannot be considered a gold_standard we also developed a probabilistic receiver_operating proc approach that can incorporate uncertainties metabolomics is becoming a major area of interest in highthroughput biology measuring thousands of metabolites at a time untargeted metabolomics using liquid_chromatography coupled_with lc_ms helps to unravel systematic response to drugs detect pollutants in humans find gene_functions and discover disease markers and mechanisms high_resolution lc_ms platforms generate highly accurate_mass to charge ratio m z measurements facilitating metabolite_identification at the same time the raw_data are large and noisy complex preprocessing routines are necessary to ensure high_quality peak_detection quantification and alignment across profiles critical to the success of data analysis is the detection of peaks from the raw_data a number of methods have been developed each assuming certain characteristics can differentiate peaks from noise as examples the xcms package uses a matched filter_based on the second derivative of the gaussian function and the aplcms package uses a run filter_based on point distribution_patterns currently peak_detection in high_resolution lc_ms data is still less than satisfactory especially for peaks of lower_intensity a wealth of knowledge exists about common metabolites some of them are documented in openly available databases such as the human metabolome database hmdb madison metabolomics consortium database mmcd and metlin we have previously_developed a hybrid_approach utilizing existing knowledge to improve peak_detection while greatly improving the detection rate of known metabolites as well as peaks consistently detected in historical_data it does not help peaks derived from metabolites that are not yet documented in the database in this study we ask the question can we learn patterns from the part of data that match to known metabolites such that the knowledge can improve the detection of unknown metabolites moreover each dataset may have different characteristics because of changes in experimental_conditions such as peak width and signal_to can the method find the best criterion driven by the data characteristics to this end we consider machine_learning that are effective in high_dimensional as well as resistant to high collinearity in the data we first separate the data into extracted_ion eics using adaptive binning we use eic to refer to the data slices after binning each eic contains some raw data_points which may or may not be a real peak we then take a large number of data feature measurements from every eic in this article we shall use data feature to refer to the characteristics of the eic data instead of metabolic_features detected in the data given the data our ultimate_goal is to find a scoring system that best separates eics that contain real peaks from those that do not contain real peaks certainly such a scoring system cannot be obtained because we do not have the knowledge as to which eics contain real peaks however some of the eics have m z values closely_matched to known metabolites those matched are likely to contain real peaks whereas those to whom correspondence should be addressed unmatched have much lower chances to contain real peaks we hypothesize that by finding a scoring system that best separates the matched unmatched eics we have a good proxy to the ultimate_goal of differentiating peak regions from noise we use machine_learning to find the optimal rule to discriminate matched eics from unmatched eics using classification_models such as logistic_regression boosting support_vector svm and random_forest rf after the best model is selected by cross_validation all the unmatched eics are given scores based on this model higher scores will signify the eic is more likely to contain a real peak in this proof_of study we compared the performance of the new machine_learning based_approach with existing_methods xcms and aplcms although aplcms does have a hybrid_approach that involves targeted search of known metabolites we did not use this option because our purpose was to find whether the new method brought improvement on the detection of previously_unknown peaks on which the hybrid aplcms does not help among the three methods only the new method requires a list of known metabolites we first found the unique m z values of hmdb metabolites and split them in half randomly the m h ions of half of the hmdb data were used as the known m z values for the new method to avoid the impact of parameter choices we tried our best to tune the methods and allowed each method a number of parameter_settings the parameters were specific to the datasets they are described in detail below to assess the performance of peak_detection we based our judgment on the matching of detected peaks to known metabolites first from the results of all three methods we removed peaks matched to the the former was a more stringent set and the latter was a more relaxed set the number of peaks detected together with the percentage of detected peaks matched to the known metabolites gave us measurements of the quality of the peak_detection 
