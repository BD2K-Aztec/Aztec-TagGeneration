an algorithm for computing the gene_tree probability under the multispecies coalescent and its application in the inference of population tree motivation gene_tree represents the evolutionary_history of gene lineages that originate from multiple related populations under the multispecies coalescent model lineages may coalesce outside the species population boundary given a species_tree with branch_lengths the gene_tree probability is the probability of observing a specific gene tree_topology under the multispecies coales cent model there are two existing algorithms for computing the exact gene_tree probability the first algorithm is due to degnan and salter where they enumerate all the so_called coalescent histories for the given species_tree and the gene tree_topology their algorithm runs in exponential time in the number of gene lineages in general the second algorithm is the stells algorithm which is usually faster but also runs in exponential time in almost all the cases results in this article we present a new algorithm called compactch for computing the exact gene_tree probability this new algorithm is based on the notion of compact coalescent histories multiple coalescent histories are represented by a single compact coalescent history the key_advantage of our new algorithm is that it runs in polynomial time in the number of gene lineages if the number of populations is fixed to be a constant the new algorithm is more efficient than the stells algorithm both in theory and in practice when the number of populations is small and there are multiple gene lineages from each population as an application we show that compactch can be applied in the inference of population tree i e the population divergence history from population haplotypes simulation_results show that the compactch algorithm enables efficient and accurate inference of population trees with much more haplotypes than a previous approach availability the compactch algorithm is implemented in the stells software_package which is available for download atconsider n gene lineages sampled from one population when we trace these lineages backward in time sooner or later two of these lineages will find a common_ancestor when this occurs we say these two lineages coalesce or the coalescent of these two lineages occurs gene lineages coalesce in a stochastic way which is influenced by multiple population_genetic parameters such as population_sizes therefore coalescents may potentially reveal important aspects of population evolution introduced the coalescent_theory which provides the analytical foundation for the study of coalescents since then coalescent_theory has quickly become a very active research subject in population_genetics there are numerous theoretical results in coalescent_theory along with many coalescent_based software_tools see wakeley andfor an overview of the growing field of coalescent_theory while mathematically appealing coalescent is known to be challenging computationally one of the most important problems on coalescents is computing the coalescent likelihood that is we want to compute the probability of observing some population variation v c the author published_by we have implemented our new compactch algorithm as part of the stells program http www engr uconn edu ywu stells html we compare with the stells algorithm which is currently the best algorithm for computing the gene_tree probability we first show that compactch outperforms the original stells when the number of species is small and there are multiple gene lineages per species then as an application we show that compactch allows fast and accurate inference of population trees from haplotypes when there are multiple haplotypes from each population 
