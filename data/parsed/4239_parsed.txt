genome_analysis sigma strain level inference of genomes from metagenomic_analysis for biosurveillance motivation metagenomic_sequencing of clinical samples provides a promising technique for direct pathogen_detection and characterization in biosurveillance taxonomic_analysis at the strain level can be used to resolve serotypes of a pathogen in biosurveillance sigma was developed for strain level identification and quantification of pathogens using their reference_genomes based on metagenomic_analysis results sigma provides not only accurate strain level inferences but also three unique capabilities i sigma quantifies the statistical uncertainty of its inferences which includes hypothesis_testing of identified genomes and confidence_interval estimation of their relative_abundances ii sigma enables strain variant_calling by assigning metage nomic reads to their most likely reference_genomes and iii sigma supports parallel_computing for fast analysis of large_datasets the algorithm performance was evaluated using simulated mock communities and fecal_samples with spike in pathogen strains availability_and sigma was implemented in c with source codes and binaries freely_available atit is a public_health and national security imperative to prepare for a broad range of biological threats including infectious_diseases and food_borne illnesses biosurveillance will provide early detection of disease_outbreaks and rapid characterization of pathogens conventional methods for biosurveillance include laboratory culture immunoassays and genotyping metagenomic_sequencing developed in environmental microbiology is a promising new method for biosurveillance for example fecal_samples of suspected patients in food_borne disease_outbreaks can be sequenced directly to identify responsible pathogens bypassing the steps of strain isolation and culturing for pathogen identification in the german shiga_toxin producing e coli stec o h outbreak the pathogen was identified by the standard epidemiology procedure of isolation culturing and genotyping multiple isolate cultures of this pathogen from different patients were subsequently sequenced which generated whole genome_sequences for pathophysiology analysis in the future metagenomics could be used to sequence fecal_samples of patients in the early_stage of such an outbreak potentially allowing more rapid and unambiguous_identification of the pathogen it is a computational challenge to achieve sensitive and specific identification of pathogens in a complex metagenome background many algorithms have been developed to infer the taxonomic_composition of a microbial_community using metagenomic sequencing_data the algorithms generally used the following three approaches i the k_mer statistics approach compares k_mer frequency profiles of metagenomic_reads with those of organisms representing a wide_range of clades this approach is used by na ve bayes classifier phymmbl and phylopythias in the marker gene approach metagenomic_reads are aligned with a set of preselected clade specific marker_genes and taxonomic_classification is inferred from phylogenetic distances to these marker_genes this approach is used by metaphlan and amphora both of the two approaches can produce high_quality classification results at the species level or above without using a significant amount of computation however these two approaches may not be adequate for taxonomic_classification at the strain level genome identification for metagenomic biosurveillance needs to resolve different strains or serotypes of the same species for example pathogenic e coli_strains need to be unambiguously differentiated from coexisting non pathogenic e coli_strains in the metagenome alternatively iii the read mapping_approach infers the taxonomic_composition of a community by searching metagenomic_reads against a database of reference_genomes this approach is used by megan sort items metaphyler grammy gasic and pathoscope this approach can provide accurate highresolution taxonomic_classification for clades well represented by reference_genomes it is suitable for metagenomic biosurveillance of known pathogens which generally have reference_genomes available for a variety of strains however it is difficult for this approach to detect novel pathogens when a new strain is present in a sample its closely_related strains in a reference genome_database need to be identified and their sequence_variations be determined here we present the sigma algorithm strain level inference of genomes from metagenomic_analysis for metagenomic biosurveillance a novel probabilistic_model was developed to identify and quantify genomes using the read mapping_approach our benchmarks showed that sigma provided more accurate to whom correspondence should be addressed the author published_by this is an open_access the terms of the creative commons attribution license http creativecommons org licenses by which_permits distribution and reproduction in any medium provided the original_work strain level and species level classification than an established read_mapping algorithmmegan a representative marker gene algorithmmetaphlan and a recent pathogen_detection algorithmpathoscope sigma was scaled from desktops to supercomputers to achieve a short turnaround time for large metagenomic_datasets this allows a prompt response of a metagenomic biosurveillance network to disease_outbreaks using supercomputers the existing taxonomic_analysis algorithms generally do not provide statistical confidence assessment of their results it is difficult to make a biosurveillance decision based on the inference of an algorithm on a pathogens presence without knowing the uncertainty on such inferences or to use the estimated relative_abundance of a genome without knowing the confidence_intervals of such estimates after the identification and quantification of genomes sigma can rigorously evaluate the statistical confidence of its findings hypothesis_testing based on the likelihood_ratio was used to calculate p values for the detection of relevant genomes bootstrapping was used to estimate the confidence_intervals of the relative_abundances of identified genomes when an outbreak spreads or a pathogen re emerges it is important to determine the sequence_variations between the genomes of this pathogen in the field collected_samples and its reference_genomes in the database this allows accurate reconstruction of the transmission sources of the outbreak and the evolutionary_history of the pathogen thus biosurveillance further requires information on the single_nucleotide snps of a detected pathogen to distinguish different variant populations identification of variants is straightforward for isolate genome_sequencing by mapping all reads to a reference_genome however in metagenome sequencing one cannot simply map all metagenomic_reads to a reference_genome because some of the aligned_reads may originate from different microorganisms which could introduce false variations sigma solves this problem by assigning each read to its most likely originating genome based on the sigma probabilistic_model which allows subsequent variant_calling by variants calling software such as samtools shows an overview of the sigma algorithm sigma starts with mapping all reads in a metagenomic_dataset onto a userdefined database of reference_genomes a parallelization wrapper is provided as an option for users to speedup the read_alignment using computer clusters a read can be aligned to many genomes with up to a given number of mismatches the foundation of all statistical inferences in sigma is a simple probabilistic_model for sampling reads with mismatches from genomes at unknown abundances the sigma probabilistic_model permits maximum_likelihood mle of the relative_abundances of all genomes measured by the percentages of reads sampled from these genomes importantly we proved the convexity of the objective_function of the mle so that sigma can guarantee to attain a global optimum solution using interior point non linear_programming nlp provided in the ipopt library the sigma probabilistic_model further provides the statistical_framework for hypothesis_testing and confidence_interval estimation sigma calculates the p value for identification of a genome using a likelihood_ratio of the null_hypothesis that this genome is not present in the sample to account for the quantification uncertainty from the stochastic sampling process of metagenomic_sequencing bootstrapping is used to estimate confidence_intervals of relative_abundances of identified genomes as both bootstrapping and likelihood_ratio entail solving the nontrivial nlp optimization_problem for many times the nlp solver of sigma is multithreaded and parallelized to computer clusters finally given the mle of genome relative_abundances sigma can calculate the probabilities of sampling a read from its mapped genomes which allows assigning metagenomic_reads to their most likely originating genomes for variant_calling for a selected genome sigma provides the alignment of its assigned reads on the genome_sequence as the input for variant_calling with samtools sigma filters the variant_calling output to identify high_confidence sequence_variations a number of taxonomic_classification algorithms have been developed for metagenomic_data with different advantages for example the lca algorithm used by megan can provide classification at a higher taxonomic rank for a novel microorganism without a reference_genome from a closely_related strain or species in the database the marker gene approach used by metaphlan only requires a small amount of computing_resources for large metagenomic_datasets the general_purpose taxonomic_classification algorithms typically providecomprehensive phylogenetic coverage and identifications at proper taxonomic ranks for complex microbial_communities which is important for many microbial_ecology studies conversely pathoscope and sigma both are designed for detecting pathogens in metagenomic_samples however pathoscope did not provide accurate resolution of different strains in a sample which is required for biosurveillance to distinguish pathogenic strains from non pathogenic strains and to pinpoint the serotype of a pathogen from a complex metagenome background this is probably because the em_algorithm used by pathoscope can only provide a local optimum solution for genome abundance estimation the local optimum solution may deviate significantly from the global optimum solution for metagenomes that are complicated by multiple different strains however the nlp algorithm used by sigma mathematically guarantee a global optimum solution for genome abundance estimation due to the convexity of the objective_function for the mle furthermore sigma provides three unique capabilities needed for metagenomic biosurveillance first sigma can evaluate the statistical confidence of genome identification and quantification with hypothesis_testing and confidence_interval estimation the uncertainty quantification will support more informed_decision in biosurveillance second sigma can determine the divergence of the actual genomes in the sample from the reference_genomes in the database by variant_calling by assigning metagenomic_reads to their most likely originating genomes sigma makes the metagenomic snp analysis amenable to the existing variant_calling designed for isolate genomes strain variations can be used to track the divergence of a pathogen during its spread finally sigma users can optionally use high_performance to achieve fast analysis with short turnaround time the computation is scalable to very large metagenomic_datasets 
