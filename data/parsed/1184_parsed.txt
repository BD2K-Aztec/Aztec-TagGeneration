genetics_and cosi an efficient simulator of exact and approximate coalescent with selection motivation efficient_simulation of population_genetic samples under a given demographic model is a prerequisite for many analyses coalescent_theory provides an efficient framework for such simulations but simulating longer regions and higher recombination_rates remains_challenging simulators based on a markovian approximation to the coalescent scale well but do not support simulation of selection gene_conversion is not supported by any published coalescent simulators that support selection results we describe cosi an efficient simulator that supports both exact and approximate coalescent_simulation with positive_selection cosi improves on the speed of existing exact simulators and permits further speedup in approximate mode while retaining support for selection cosi supports a wide_range of demographic scenarios including recombination hot_spots gene_conversion population_size changes population_structure and migration cosi implements coalescent machinery efficiently by tracking only a small subset of the ancestral recombination graph sampling only relevant recombination_events and using augmented skip lists to represent tracked genetic segments to preserve support for selection in approximate mode the markov approximation is implemented not by moving along the chromosome but by performing a standard backwards in time coalescent_simulation while restricting coalescence to node pairs with overlapping or near overlapping genetic_material we describe the algorithms used by cosi and present comparisons with existing selection simulators availability_and a free c implementation of cosi is available ata wide_variety of population_genetic depend on efficient_simulation of samples under a demographic model the most efficient_simulation method works backwards in time from the sample first simulating the samples genealogy according to coalescent_theory and then placing mutations on that genealogy because of crossing over and gene_conversion the overall genealogy for a simulated region is not a tree but a directed_acyclic whose size grows quickly with region length and with recombination_rate to address this simulation bottleneck a markovian approximation was proposed and implemented however the markovian approximation does not readily allow for the modeling of positive_selection simulators that do support positive_selection e g suffer from the performance limitations of the traditional coalescent and do not support all commonly needed features variable genetic_maps gene_conversion structured populations within a single framework here we describe the simulator cosi which implements the standard coalescent_simulation algorithm but which does so using several optimizations that greatly reduce memory and cpu requirements the use of the original coalescent allows cosi to support simulation of positive_selection using the standard structured_coalescent approach for additional efficiency the markovian approximation can be enabled while retaining support for simulating selection cosi supports population_structure population_size changes bottlenecks and migrations recombination_rate can be varied along the simulated region and the program includes a utility to generate genetic_maps with recombination_hotspots cosi also supports a simple model of gene_conversion 
