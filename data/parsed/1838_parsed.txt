genome_analysis fishical an r package for iterative fish based calibration of hi c data the fluorescence_in fish method has been providing valuable information on physical distances between loci via image_analysis for several decades recently high_throughput data on nearby chemical contacts between and within chromosomes became available with the hi c method here we present fishical an r package for an iterative fish based hi c calibration that exploits in full the information coming from these methods we describe here our calibration_model and present d inference methods that we have developed for increasing its usability namely d reconstruction through local stress minimization and detection of spatial inconsistencies we next confirm our calibration across three human cell_lines and explain how the output of our methods could inform our model defining an iterative calibration pipeline with applications for quality_assessment and meta_analysis availability_and fishical v is available from http cran r project org with molecular_biologists getting a closer look at the spatial_organization of the nucleus important methodologies currently used enlist hi c fish and electron_microscopy em in many ways these methods offer complementary information hi c data provide a genome_wide capture of chromatin contacts with the advantages of high_throughput and scale however their spatial interpretation is complicated fish data on the other hand are usually limited in scale but offer a direct measure for physical distance through image_analysis they can be obtained regardless of range or physical obstacles that affect the chemical capture of contacts in hi c between far away or inaccessible loci and with a distinction between homologs which is absent in hi c data previously_suggested an exponential model to convert yeast hi c frequencies to fish distance approximations and used them to reconstruct a d model for the yeast_genome however it was not clear whether the same model could be used for higher_order organisms with larger genomes where hi c limitations are likely to be more prominent and given that previous_studies a power_law model to relate physical distances and contact frequencies whether the same parameters are appropriate across short medium and long ranges or for different chromosomes and cell_types also remained an open question more recently trieu and cheng used fish data for parameterizing an objective_function that will reconstruct the d configuration from human hi c data although innovative this approach did not exploit in full the relationship between hi c and fish data and lacked a model to study their discrepancies here we present fishical an r package for integrating hi c and fish data which offers a modular and easy to use tool for chromosomal spatial analysis with fishical researchers can prepare and apply fish based hi c calibration which converts contact frequencies into distances while taking_into range limitations in hi c data to make our calibration especially useful fishical also includes d inference methods that we have developed that can in turn iteratively refine the calibration_model we confirm our calibration across three human cell_lines and show that our methods can provide_valuable for hi c fish calibration refinement meta_analysis and quality_assessment to the best of our knowledge fishical is the only tool available for performing these tasks the following function usually termed stress in a multidimensional_scaling setting p i j w i j i j d i j y where w i j are the weights we assign according to the reliability of i j as we mostly rely on local information we can use here a local stress function where missing i j are replaced with a constant d inf d inf known i j and w i j take the value of d inf for missing distances and otherwise for d inf weights of missing distances should be set to a small constant as w i j define an irreducible matrix the stress minimization could be performed through scaling by majorizing a complicated function smacof a well established strategy for this task which guarantees convergence the calibrated hi c distances i j further define a weighted undirected graph gv e where v is the set of loci and e is the set of edges v i v j j i j i j with weights i j here we distinguish between immediate neighbors from the same chromosome cis and from different chromosomes trans and detect a spatial inconsistency for a node v in g if the subgraph g of all immediate trans neighbors of v is not connected further identifying the connected components in g can highlight the cause of inconsistency and the underlying spatial division an inconsistency represents an event where several loci that are in an accessible range from another locus in trans are not in an accessible range themselves which may occur for example owing to homology or noise the iterative calibration_process starts with measuring the discrepancies between hi c and fish data which could aid in reproducibility assessment and point to functionally meaningful events supplementary_information section the output of the calibration is then used for d inference applications as described above and for other applications section finally studying the resulting spatial models for example across chromosomes or different tissues provides the input for the next iteration to further refine the calibration_model 
