sequence_analysis quantifying tumor_heterogeneity in whole_genome and whole exome sequencing_data most tumor_samples are a heterogeneous mixture of cells including admixture by normal non cancerous_cells and sub populations of cancerous_cells with different complements of somatic aberrations this intra_tumor complicates the analysis of somatic aberrations in dna sequencing_data from tumor_samples results we describe an algorithm called theta that infers the composition of a tumor sampleincluding not only tumor_purity but also the number and content of tumor subpopulationsdirectly from both whole_genome wgs and whole exome wxs high_throughput dna sequencing_data this algorithm builds on our earlier tumor_heterogeneity analysis theta algorithm in several important directions these include improved ability to analyze highly rearranged gen omes using a variety of data types both wgs sequencing including low coverage and wxs sequencing we apply our improved theta algorithm to wgs including low pass and wxs sequence_data from samples from the cancer_genome tcga we find that the improved algorithm is substantially faster and identifies numerous tumor_samples containing subclonal populations in the tcga data including in one highly rearranged sample for which other tumor_purity estimation algorithms were unable to estimate tumor_purity availability_and an implementation of theta is available atseveral recent_studies indicate that most tumor_samples are a heterogeneous mixture of cells including admixture by normal non cancerous_cells and subpopulations of cancerous_cells with different complements of somatic aberrations characterizing this intra_tumor is essential for several reasons first an estimate of tumor_purity the fraction of cancerous_cells in a tumor is necessary for accurate identification of somatic aberrations of all types in the sample most cancer_genome studies use a re sequencing approach to detect somatic aberrations reads from a tumor sample and usually a matched normal sample are aligned to the human_reference differences in the sequence of aligned_reads the number of aligned_reads or the configuration of aligned_reads e g split_reads or discordant pairs are used to infer the presence of single nucleotide or other small variants copy_number or structural aberrations respectively however the presence of intra_tumor can dilute the signals required to identify somatic aberrations second estimates of the composition of a tumor sample including not only the tumor_purity but also the number and fractions of subpopulations of tumor cellsprovide useful for understanding tumor_progression and determining possible treatment_strategies in particular clonal somatic aberrations that exist in all tumor_cells are likely early mutational_events and their identification sheds light on the early_stages of cancer conversely subclonal somatic aberrations might reveal properties shared by a subset of tumor_cells such as drug_resistance or ability to metastasize identification of such aberrations and subpopulations of tumor_cells might inform treatment_strategies and or help predict metastasis relapse in the past_few several methods to infer tumor_purity and or tumor composition have been developed these methods generally fall into two categories i methods that use somatic single_nucleotide snvs and ii methods that use somatic copy_number snv based_methods such as expands pyclone and many others use clustering of variant allele_frequencies to determine tumor populations and frequencies while these types of methods are able to derive multiple tumor subpopulations they often require estimates of copy_number for each region containing snvs deriving such estimates for highly rearranged aneuploid tumors is as difficult as the estimation of intra_tumor itself moreover these approaches require high_coverage to overcome the high variance in read_counts at individual snvs for example both pyclone and phylosub explicitly require deeply sequenced data thus less expensive low coverage sequence_data as generated in tcga is not amenable to these approaches copy_number based_methods such as absolute and cnanorm use observed shifts in read_depth due to copy_number to predict to whom correspondence should be addressed y the authors wish it to be known that in their opinion the first two authors should be regarded_as tumor_purity but do not explicitly consider multiple tumor subpopulations and therefore may return purity estimates that only reflect a single subpopulation of tumor_cells in a sample in we introduced the tumor_heterogeneity analysis theta algorithm to infer the composition of a tumor sampleincluding both the percentage of normal admixture and the fraction and content of one or more tumor subpopulations that differ by copy_number in this article we present theta which extends the theta algorithm in several important directions first we substantially_improve the computation for the case of multiple distinct tumor subpopulations in a sample second we extend theta to infer tumor composition for highly rearranged genomes using a twostep procedure where initial estimates are made using highconfidence regions of the genome and then are extended to the entire_genome third we devise a probabilistic_model of b allele_frequencies bafs which can be used to solve the identifiability issue when read_depth alone is consistent with multiple possible tumor compositions finally we extend theta to analyze whole exome wxs sequencing_data we apply our new algorithm to both whole_genome wgs including low pass and wxs sequence_data from samples from the cancer_genome tcga we find that the improved algorithm is substantially faster and able to analyze highly rearranged genomesidentifying numerous tumors with subclonal tumor populations in the tcga data where available we compare our purity estimates to published_values for absolute while the purity estimates are largely in agreement for higher purity samples we find cases where absolute fails or underestimates purity but theta identifies multiple tumor subpopulations these improvements greatly expand the range of sequencing_data and tumors for which we can infer tumor composition we ran theta on simulated_data wgs including low pass data coverage and wxs data from breast_carcinoma ovarian_carcinoma glioblastoma_multiforme kidney renal clear_cell and lung squamous_cell carcinoma_samples from tcga supplementary where available we compare our estimates of tumor_purity to the estimates reported by the absolute algorithm that estimates purity from snp_array the rest of this section is organized as follows first we discuss results on simulated_data second we demonstrate theta s performance on wxs data including comparison of results for samples for which both wgs and wxs data were available next we present in depth analysis of several wgs samples to demonstrate the efficacy of theta on highly rearranged genomes using both low pass and moderate coverage sequence_data finally we apply our probabilistic_model of bafs to one sample and disambiguate between two equally likely solutions we introduced an algorithm to infer tumor composition of highly rearranged genomes from wgs high or low coverage or wxs dna sequencing_data these are implemented as improvements to our theta algorithm the theta algorithm is able to analyze highly rearranged aneuploid samples that are beyond the scope of existing algorithms that infer tumor_heterogeneity a recently_published comparison of algorithms for inferring tumor_purity showed that our original theta algorithm performed well but sometimes underestimated tumor_purity when run to only consider normal cells and one tumor subpopulation we argue that this purity underestimation is likely a result of not directly considering all tumor subpopulations in the sample in every sample that we analyzed with the new algorithm tumor_purity was higher when considering multiple tumor subpopulations although the improved theta presented here is useful on a wide_range of sequencing_data from different tumors some limitations remain first theta is unable to distinguish tumor subpopulations that are not differentiated by copy_number as copy_number are ubiquitous in most solid_tumors we expect that theta will be applicable to many genomes however for some diploid tumors snv analysis is preferable incorporation of additionaljiwgs j jiwxs j where i wgs and i wxs are the interval partitions for the wgs and whole exome data respectively and i is the set of intervals longer than kb contained in both i wgs and i wxs cna sim is the fraction of i where the copy_number estimates are the same between the two data types indicates that the sample did not pass the criteria to be considered for multiple tumor populations see supplemental material a for sample tcga wgs_data were aligned to hg and wxs data aligned to hg see supplementaryfor purity estimates across all genomes analyzed and results using an additional similarity_metric bolding indicates the sample for which theta can estimate purity but absolute reports as highly non clonal and is unable to estimate purity information such as bafs for somatic and germ_line snps into the model may also increase the scope of samples for which theta is applicable second while the improvements presented here greatly decrease the computational_burden of the algorithm when considering multiple tumor populations the algorithm remains exponential in the size of the interval partition of the reference genomemaking it impractical to infer tumor composition with more than a handful of subpopulations in many cases identification of further mathematical restrictions to the domain of interval count matrices or use of sampling_techniques in place of complete enumeration are future avenues of investigation which may prove useful in this respect additionally when considering multiple tumor subpopulations the quality of the results is limited by features of the data including the presence of copy_number that distinguish subpopulations as well as the number of sequence_reads available to identify these aberrations the later is a function of sequencing_coverage aberration length and proportion of cells that have the aberration while the limited number of tumor subpopulations that theta analyzes may not be sufficient to fully analyze tumor_progression theta s ability to recover subpopulations with relatively low_coverage data can provide some insight into tumor subpopulations in cases where methods that rely on high coverage data cannot combining theta s output with other methods that do explicitly consider the phylogenetic history of a tumor such asmay prove a useful avenue of exploration the two step procedure introduced here allows us to infer subclonal copy_number at much smaller scales however some care is required to avoid_overfitting the data particularly for small subclonal copy_number where gc bias or other sequencing artifacts may lead to incorrect inferences incorporating more sophisticated segmentation procedures that account for such effects and appropriately scale read_counts are useful directions_for finally this work focuses on the important first step of quantifying intra_tumor from a single mixed_tumor sample downstream_analysis including the clinical and functional impact of the inferred tumor composition is an important area for future work we present a new algorithm theta to infer the composition of a tumor sampleincluding both the percentage of normal admixture and the fraction and content of one or more of tumor subpopulations that differ by copy_number the new algorithm builds on our theta algorithm and includes several improvements that allow us to analyze highly rearranged genomes from wgs high and low coverage or wxs sequencing_data in addition the new algorithm is orders_of and allows us to use bafs to distinguish between different reconstructions 
