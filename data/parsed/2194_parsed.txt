high_quality sequence_clustering guided by network_topology and multiple_alignment likelihood motivation proteins can be naturally classified into families of homologous_sequences that derive from a common_ancestor the comparison of homologous_sequences and the analysis of their phylogenetic_relationships provide useful information regarding the function and evolution of genes one important difficulty of clustering_methods is to distinguish highly_divergent homologous_sequences from sequences that only share partial homology due to evolution by protein domain rearrangements existing clustering_methods require parameters that have to be set a priori given the variability in the evolution pattern among proteins these parameters cannot be optimal for all gene_families results we propose a strategy that aims at clustering sequences homologous over their entire length and that takes_into the pattern of substitution specific to each gene_family sequences are first all compared with each other and clustered into pre families based on pairwise similarity criteria with permissive parameters to optimize sensitivity pre families are then divided_into homogeneous clusters based on the topology of the similarity network finally clusters are progressively merged into families for which we compute multiple_alignments and we use a model_selection technique to find the optimal tradeoff between the number of families and multiple_alignment likelihood to evaluate this method called hifix we analyzed simulated sequences and manually_curated datasets these tests showed that hifix is the only method robust to both sequence_divergence and domain rearrangements hifix is fast enough to be used on very large_datasets availability_and the python software hifix is freely_available lbbe univgenomes are the result of a long evolutionary_process that began billion_years reconstructing the evolutionary_history of genes contained within these genomes is of major interest not only to uncover the phylogeny of organisms but also to understand to whom correspondence should be addressed the functioning of living_systems thanks to the progress of genome_sequencing millions of protein_coding from thousands of species are now available in sequence_databases several specialized databases have been developed with the aim of providing systematic information about the homology relationships between these sequences either at the level of protein_domains such as prodom or pfam or among entire proteins considered as a whole such as cog treefam ensembl compara or hogenom the systematic analysis of homology relationships among sequences typically involves two steps i pairwise_comparison of all proteins to detect homology e g with blast and ii clustering of homologous_proteins or protein_domains into families the choice of the clustering strategy is crucial for all subsequent analyses and depends on the purpose of the study here we will discuss specifically clustering strategies that aim at describing homology relationships between entire proteins not protein_domains by definition a family of homologous_sequences is a set of sequences that derive from a common_ancestor hence in principle modular proteins containing domains with distinct evolutionary_histories should not be included in the same family the main_problem is that the detection of homology by sequence similarity_search is subject both to false_positive fp and false_negative fn errors typically homology cannot be detected by sequence_similarity when proteins have diverged too much given that the rate of evolution often varies along proteins some sequences that are homologous over their entire length may be only locally alignable such cases would be erroneously considered as partially homologous and will lead to fns conversely it has been shown that similarity_search programs such as blast sometimes tend to extend the local_alignment beyond the actual homologous domain thus in some cases modular proteins_sharing only partial homology can be aligned over their entire length and hence be classified in the same family fps see the rate of fps can be decreased by using more stringent sequence_similarity criteria but this necessarily leads to an increase in the rate of fns all clustering_methods have some parameters that can be tuned to optimize the tradeoff between sensitivity_and however the choice of these parameters is totally empirical and the default_parameters that are proposed by the authors generally reflect the result of trial and error on a limited benchmark set of sequences one other problem example of over extension of blast local_alignment the two protein_sequences query and sbjct were obtained by simulation of sequence_evolution performed with indelible each protein consists of two domains of equal size the n_terminal domain plain line which is homologous between both proteins and a specific nonhomologous c terminal domain in dotted and dashed_line respectively although these proteins share homology only in the n_terminal domain the blast alignment extends over the entire length of both proteins such an overextension can also be found with natural protein_sequences is that the tempo of sequence_evolution is highly_variable among proteins and hence optimal parameters may vary among families moreover the optimal parameters may also vary according to the size of the sequence_dataset for example we recently_developed a clustering software based on a sophisticated divide_and procedure which presents the advantage of being extremely fast and memory_efficient and hence can be used on very large sequence_datasets contrarily to most other existing_methods benchmark tests showed that on average silix performs as well or even better than other methods in term of clustering quality however given that silix is based on transitive clustering this method is expected to lead to fps among large protein_families because the risk of illegitimately grouping gene_families increases with the number of sequences to circumvent these problems we propose here a new clustering strategy the main idea is that the decision to include or not a protein in a given family should be based on the examination of multiple_sequence not simply on the analysis of pairwise sequence_similarities indeed a multiple_alignment contains information about the mode and tempo of evolution at each aminoacid position of a given protein_family which can be used to decide whether or not a new sequence belongs to that family the strategy we propose consists in three steps to evaluate the results of hifix and compare them to those of other methods we used several benchmark sets of known homologous protein_families on each set of sequences we first compared all proteins against all with blastp the blast results were then analyzed with different clustering_methods for each method each reference family of the benchmark set was compared with the results of the clustering to identify the cluster with the highest number of corresponding sequences target cluster each sequence of the reference family that was absent from the target cluster was counted as a fn each sequence of the target cluster that was present or absent from the reference family was counted as a true_positive tp or a fp respectively we computed sensitivity tp tp fn and specificity tp tp fp for each cluster and report their values averaged over all reference families we also report f measure ii a weighted harmonic mean between sensitivityand specificity that was introduced in see details in supplementary_material and also this procedure was used to evaluate silix used alone or followed by the two additional hifix steps step decomposition of pre families into communities with louvain step hierarchical_clustering into meta communities that are the final families to quantify the gain due to the third step we also analyzed the results of the first two steps i e silix followed by louvain assuming that the found communities are the protein_families for a comparison we also performed the clustering with several other methods that were recently evaluated among the best currently available mcl hcluster sg and transclust we first tested these methods on sets of homologous protein_families that have been manually analyzed by experts unfortunately there are only a limited number of such benchmark sets and they tend to be biased toward relatively small families furthermore even expert analyses cannot fully guarantee the absence of fp or fn in the reference_set to circumvent these limitations we also performed tests on sets of simulated sequences for which by construction homology relationships are perfectly known proteins are the result of an evolutionary_process and can therefore naturally be classified into families of homologous_sequences we propose here a clustering method hifix that relies on three steps i permissive clustering of sequences in pre families ii sub clustering of pre families into homogeneous clusters and iii progressive merging of clusters into families with evaluation of the quality of the multiple_alignment at each step the goal of this strategy is to maximize sensitivity i e families should be as exhaustive as possible while preserving the quality of the final multiple_alignment i e two clusters can be merged as long as they are homologous over their entire length the logics behind this strategy is to cluster all homologous_sequences that are similar enough to obtain a reliable multiple_alignment from which it will be possible to construct a phylogenetic_tree we evaluated the quality of the clustering with several manually_curated or simulated benchmark_datasets as expected the clustering obtained after step louvain shows a higher specificity but lower sensitivity than after step silix 
