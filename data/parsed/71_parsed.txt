gene_expression a clustering a novel method for the detection of co regulated methylation regions and regions associated with exposure motivation dna_methylation is a heritable modifiable chemical process that affects gene_transcription and is associated with other molecular_markers e g gene_expression and biomarkers e g cancer or other diseases current_technology measures methylation in hundred of thousands or millions of cpg_sites throughout the genome it is evident that neighboring cpg_sites are often highly_correlated with each other and current_literature suggests that clusters of adjacent cpg_sites are co regulated results we develop the adjacent site clustering a clustering_algorithm to detect sets of neighboring cpg_sites that are correlated with each other to detect methylation regions associated with exposure we propose an analysis_pipeline for high_dimensional methylation data in which cpg_sites within regions identified by a clustering are mod eled as multivariate responses to environmental_exposure using a generalized_estimating approach that assumes exposure equally affects all sites in the cluster we develop a correlation preserving simulation scheme and study the proposed methodology via simulations we study the clusters detected by the algorithm on high_dimensional dataset of peripheral_blood methylation of pesticide applicators availability we provide the r package aclust that efficiently implements the a clustering and the analysis_pipeline and produces analysis reports the package is found onmethylation is a heritable and modifiable chemical process by which most often a methyl_group attaches to a cytosine base that is followed by guanine on the same dna_strand cpg_dinucleotide or cpg_site it is sensitive to environmental_exposure such as smoking air_pollution and chemicals modern arraybased platforms measure methylation in hundreds of thousands of cpg_sites and sequencing methods measure methylation in millions of sites methylation is often measured as a continuous variable known as a value representing the proportion of methylated cpg_sites out of the total in the measured tissue interestingly sets of related by location cpg_sites whether associated with a gene or not may be jointly affected by environmental_exposure it is of interest to identify such sets of cpg_sites that are affected by an exposure in a computationally_efficient and quick manner methylation occurs throughout the genome and it differs between tissues and cell_types although it is known that methylation is associated with the control of genes the mechanisms are still debated the distribution of cpg_sites varies across the genome areas densely populated with cpg_sites are called cpg islands cgis are often found in the promoter area of genes and they exhibit low methylation higher cgi methylation is associated with gene_silencing within gene_bodies cpg_sites are usually hypermethylated and are found in lower_density however there are many exceptions to these general rules such as cgis within gene_bodies or promoter areas without cgis there are other predefined regions associated with cgis in addition to the island itself there are north and south shores and shelves located upand downstream from the island respectively and are defined according to their distance in base_pairs from the island shores are up to kb of the island and shelves are within kb of the islands we term the collection of shelves shores and island associated with a single cgi by a resort to eliminate confusion the definition of these regions is independent of any actual observed behavior of the sets of associated cpg_sites further report finding clusters of methylated cpg_sites within specific_cell these clusters are not related to cgis in other words these regions do not necessarily correspond to regions that are co regulated therefore it is useful to employ computational_tools for discovery of regions with cpg_sites to whom correspondence should be addressed exhibiting common behavior that are not necessarily restricted to the known predefined methylation domains this article has three aspects i automated identification of methylation regions based on the correlation between methylation_sites and independently of any exposure data ii analysis of these regions to identify those affected by exposure and iii development of a realistic correlation preserving simulation scheme for methylation data proposed a method to identify regions that are associated with exposure our proposed method differs from their work in that we perform general region detection pose different modeling assumptions on the exposure effect on a region and as a result provide a simpler testing procedure others used the correlation for analysis of genetic data more specifically data from tiling arrays in which adjacent probes target overlapping sequences for instance developed a software_package to correct the p values associated with a probe using the estimated correlation between the probe and neighboring probes developed a software_package applying methods to combine adjacent correlated p values and detect regions of low p value these methods identify differentially methylation regions dmrs after testing for the exposure effect on the methylation_sites while we first cluster sites and then test for the exposure effect on the clusters proposed a method to detect cgis using a hidden_markov however their work focuses on redefining cgis to alleviate limitations of the traditional definition based on cpg content in an interval rather than on identifying regions of common behavior of cpg_sites in terms of simulation did perform some simulations but our proposed simulation scheme better imitates the reality by preserving the correlation_structure and methylation patterns of a real_dataset in what follows we present an adjacent sites clustering method dubbed a clustering to discover methylation regions by clustering together neighboring cpg_sites according to their correlation and under possible restrictions on their distance from each other on the dna the clustering can be preceded by a dbp merge step an algorithm that merges a set of methylation_sites wedged between two highly_correlated cpg_sites that are physically located close enough to each other along a chromosome this combination of the dbp merge and a clustering detects regions of co regulated cpg_sites we further provide a pipeline for analysis after normalization and batch correction are performed that first includes clustering cpg_sites and then tests the effect of exposure on each cluster for testing we assume that the exposure equally affects all cpg_sites while each site has its own baseline methylation_level we perform this analysis using generalized_estimating gees that are robust to the specification of data distribution the clustering method and the following gee analysis are implemented in the r package aclust the article is organized as follows in section we present the model at the basis of this work section_describes the a clustering and dbp merge algorithms the proposed analysis_pipeline and an abbreviated description of the correlation preserving simulation scheme complete details may be found in the supplementary_material in section we first study the performance of the proposed analysis_pipeline for finding regions associated with the exposure via an extensive simulation_study with different implementations of the a clustering_algorithm and a subsequent sensitivity analysis we then compare the analysis_pipeline with the bump hunting method ofas well as briefly_review single site analysis results we then compare clustering_results between two implementation options of the a clustering and dbp merge on a dataset of peripheral_blood methylation of pesticide applicators we conclude with discussion in section we present the a clustering_algorithm that clusters together adjacent methylation_sites according to their distance usually derived from the correlation between them and provide a pipeline for analysis of methylation data when they are treated as outcomes the clustering is used both to detect regions of sites that are co regulated and also to reduce dimension by forming a smaller set of analysis units we demonstrated the use of the algorithm on a methylation dataset in which methylation was measured using the illumina infimum k beadchip the proposed method is also appropriate for sequencing_data possibly even more so than for array data which tend to be sparser the clustering and analysis methods are efficient and they do not require resampling methods to compute the p values it is still an open question regarding what is the right unit of analysis and for which purposes e g cgis shores recent work bysuggests that the unit of analysis differs by regions e g in promoter or intragenic areas and possibly by cell_type as well a clustering is useful tool in studying such units of differentially_methylated and loci clusters of methylation_sites will often have higher p values then individual methylation_sites for instance the cluster will likely have a smaller effect estimate and a larger p value than the site within the cluster with the largest effect however there is a considerable dimension_reduction when clusters are considered and further we believe that the fact that multiple sites exhibit similar behavior increases our certainty that the effect is real rather than a fp discovery because the probability to detect multiple adjacent sites is lower than the probability of detecting at least one single site a clustering uses correlation as the basis for clustering of cpg_sites this raises a few issues that are important to consider when analyzing data first the type of correlation to use we explored the use of pearson_correlation as well as the spearman_correlation which is more robust to non linearities in the association between two variables in the dataset we used for data analysis as well as the simulated_data we had observations a relatively low number and as was determined by simulations spearman_correlation was slightly more appropriate for the detection of differentially_methylated when the number of observations is higher it may be beneficial to use the pearson_correlation especially because it reduces computation time compared with spearman_correlation second one should consider redundant correlation due to covariates and batch_effects we recommend performing the entire analysis after normalization and batch_effect removal but one should also consider correcting for the effects of important covariates before a clustering by implementing aclust on the partial residuals of the methylation measures after regressing them on covariates note however that in our dataset clustering_results were nearly identical when we used the methylation_values and when we used the partial residuals third one can apply a clustering based on a subset of the subjects for instance one can use only the highexposure group to define the clusters rather than all subjects this would be useful if one expects that high exposure will activate a region say so that the signal is completely driven by the high exposure group as another example it may be advantageous to cluster methylation_sites based on the controls in a casecontrol study if one expects that cases will exhibit an aberrant_methylation pattern we provide two options to extend and restrict the clustering_algorithm first the dbp merge that allows one to cluster a set of sites that are wedged between two correlated sites and are close enough to each other in terms of both correlation based and physical distance we also consider restricting adjacent cpg_sites from clusters if the base_pair distance between them and without any cpg_site measured between them is smaller than a predetermined threshold in the data analysis we used bp for the dbp merge and bp for the base_pair distance restriction it is not entirely clear if these are the best numbers the best distances would be such that the signal is maximized and yet not too much noise is added more complex rules for merging and restrictions could also be devised but that can lead to more complicated computation and less clear interpretation another possible extension to the clustering_algorithm is the use of clustering indicators based on prior_knowledge for instance one can decide that an island necessarily belongs to a certain cluster also in validating the results of one study on a different dataset one can use the clustering assignments from the first study another tuning parameter is the type of distance between clusters to be used in the simulations mimicking the sample_size and two exposure groups design of our dataset we found that the average distance is most appropriate for the goal of detecting differentially_methylated we use gees for the analysis of clusters as they use marginal mean models that are robust to mis specification of correlation_structure we use exchangeable working correlation but other types of correlation can be explored also we assumed that the exposure effect is constant across all sites in the cluster although it is likely that the direction of exposure effect increases decrease methylation is the same across the cluster it is not clear that the constant effect is correct and therefore it may not be the most advantageous assumption for instance it may be that even after allowing for single site intercept i e we allowed for a different baseline level of methylation for each site some sites may be more quickly modified by exposure than others it is a topic for future work to extend the method using other assumptions on the effect of exposure on methylation in sites e g increasing as the site is closer to the transcriptional_start a drawback of the proposed gee based analysis is limited detection of large_clusters e g sites when the sample_size is small allowing for different intercept for each site in a cluster may yield high standard_errors for the exposure effect thus in the case of a large cluster and small_sample it is possible that methods such as bump hunting or analysis of the mean methylation measure of probes in the cluster may be more powerful 
