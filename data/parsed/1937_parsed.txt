gaussian_process test for high_throughput time series application to experimental_evolution downloaded from motivation recent_advances in high_throughput hts have made it possible to monitor genomes in great detail new experiments not only use hts to measure genomic_features at one time point but also monitor them changing over time with the aim of identifying significant changes in their abundance in population_genetics for example allele_frequencies are monitored over time to detect significant frequency changes that indicate selection_pressures previous attempts at analyzing data from hts experiments have been limited as they could not simultaneously include data at intermediate time points replicate experiments and sources of uncertainty specific to hts such as sequencing_depth results we present the beta_binomial gaussian_process model for ranking features with significant non random variation in abundance over time the features are assumed to represent proportions such as proportion of an alternative allele in a population we use the beta_binomial model to capture the uncertainty arising from finite sequencing_depth and combine it with a gaussian_process model over the time series in simulations that mimic the features of experimental_evolution data the proposed method clearly outperforms classical testing in average precision of finding selected alleles we also present simulations exploring different experimental_design choices and results on real_data from drosophila experimental_evolution experiment in temperature adaptation most biological_processes are dynamic and analysis of time series data is necessary to understand them recent_advances in highthroughput_sequencing hts technologies have provided new experimental_approaches to collect genome_wide time series for example experimental_evolution now uses a new evolve and resequencing er approach to understand which genes are targeted by selection and how such experiments enable phenotypic divergence to be forced in response to changes in only few environmental_conditions in the laboratory while other conditions are kept constant the evolved populations are then subjected to hts experimental_evolution in microorganisms has focused on the fate new mutations for example in escherichia_coli and saccharomyces cerevisae new mutations were studied in contrast er experiments with sexually reproducing multicellular_organisms address selection on standing variation and allele_frequency changes afcs in small_populations where drift plays an important role for example for drosophila_melanogaster dmel several phenotypic_traits such as accelerated development body_size variation hypoxia tolerance and temperature adaptation have been investigated motivated by these experimental_studies we believe that experimental_evolution combined with hts supplies a good basis for studying afc through time series molecular data to perform allele_frequency comparisons pairwise statistical_tests between base and evolved populations were typically carried_out combined fishers exact tests with a slidingwindow approach to identify genomic_regions that show allele_frequency differences between populations selected for accelerated development and controls without direct selection developed a pairwise summary_statistic called diff stat to estimate the observed distribution of allele_frequency differences and compared this to the expected distribution without selection identify single_nucleotide snps with a consistent afc among replicates by performing a cochran mantel_haenszel test cmh the latter is an extension of the fishers_exact to multiple replicates all aforementioned statistical_methods are based on pairwise_comparisons between the base and evolved populations and they do not take full advantage of the time series data now available developed a method to analyze time series data based on population genetic_models and estimated the effective_population n e of a bacteriophage from a single locus derived a model for time series data from large populations of microorganisms n e where drift can be ignored and the population allele_frequencies evolve quasi deterministically here we propose an alternative gaussian_process gp based_approach to study afcs over the entire time series experiment genome_wide for small_populations n e gp is a non parametric statistical_model that is extremely well suited for modelling hts time series data which usually have relatively few time points that may be irregularly sampled recently there have been some works applying gp models with parameters describing the process of evolution e g jones and moriarty account for phylogenetic_relationships palacios and minin for effective_population gps have also recently been applied to gene_expression time series by a number of authors a in differential analysis gps have been applied to detect differences in gene_expression time series in a two sample setting byand for detecting significant changes by kalaitzis and lawrence although these methods provide a sensible basis for detecting the changing alleles they fail to properly take into account all aspects of the available hts_data such as differences in sequencing_depth between different alleles and time points these differences can have a huge impact in the reliability of different measured allele_frequencies and taking them into account is vital for achieving good accuracy with the available short time series our results in detecting snps that are evolving under selection using a gp model clearly demonstrate the importance of careful modelling of the measurement uncertainty through a good noise model in our case using the beta_binomial model of sequencing_data especially when data are scarce the bbgp approach leads to much higher accuracy than standard maximum_likelihood of noise variances incorporating the non gaussian likelihood directly to the gp would also be possible but it would lead to computationally more demanding inference in terms of experimental_design the most effective way to improve performance is to use a larger_population n and a larger number of founder haplotypes h as expected alleles under moderate to strong_selection s are easier to detect than alleles changing under weak selection s however for very strong_selection s it is again hard to detect the causal_snps in a real experiment the strength of selection might also not be known and often cannot be changed for the trait of interest adding more replicates can also help improve performance up to some point compared with the cmh test the bbgp is clearly superior in utilizing additional replicates we suspect this is because cmh assumes all replicates should have similar odds_ratios between the two time points and this is not sufficiently satisfied by the noisy_data longer experiments can help significantly supplementary but the benefit of adding more intermediate time points seems smaller this may be because the shape of selected trajectories is a simple sigmoid and adding more points provides limited help in estimating them the presented gp based test is sensitive to snps with a consistent time varying profile a statistically more accurate model could be derived by assuming each replicate to follow an independent gp but this would require different kind of constraints to differentiate between selection and drift which may be difficult to formulate for multiple interacting snps exploring hierarchical gp models to capture the correct dependence_structure is an interesting avenue of future_research in a whole_genome experiment ld between nearby markers and interactions between nearby selected snps are important confounders in identifying the selected markers especially for moderate sized populations the interactions can be problematic leading to very large segments in the genome raising together in frequency supplementary the issue does not appear when simulating only a single selected snp supplementary which strongly suggests it is caused by the interactions the issue can be most effectively mitigated by using larger_populations supplementary an artificially high recombination_rate supplementaryand b could also break the interactions working with larger fixed window sizes might not improve the performance as a substantial number of hitchhikers can still be found hundreds of kilobases from the selected snps see supplementary the removal of nearby hitchhikers did not improve the ap noticeably it is possible to extend the gp models for joint analysis of multiple_snps and this is clearly an important avenue of future_research this is potentially a further advantage of the gp because it is much more difficult to similarly extend the frequentist tests 
